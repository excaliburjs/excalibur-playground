const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/javascript-8Itubqs8.js","assets/typescript-6KArqQOB.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();function Zo(o,e=0){return o[o.length-(1+e)]}function kY(o){if(o.length===0)throw new Error("Invalid tail call");return[o.slice(0,o.length-1),o[o.length-1]]}function ei(o,e,t=(i,n)=>i===n){if(o===e)return!0;if(!o||!e||o.length!==e.length)return!1;for(let i=0,n=o.length;i<n;i++)if(!t(o[i],e[i]))return!1;return!0}function EY(o,e){const t=o.length-1;e<t&&(o[e]=o[t]),o.pop()}function BC(o,e,t){return TY(o.length,i=>t(o[i],e))}function TY(o,e){let t=0,i=o-1;for(;t<=i;){const n=(t+i)/2|0,s=e(n);if(s<0)t=n+1;else if(s>0)i=n-1;else return n}return-(t+1)}function $N(o,e,t){if(o=o|0,o>=e.length)throw new TypeError("invalid index");const i=e[Math.floor(e.length*Math.random())],n=[],s=[],r=[];for(const a of e){const l=t(a,i);l<0?n.push(a):l>0?s.push(a):r.push(a)}return o<n.length?$N(o,n,t):o<n.length+r.length?r[0]:$N(o-(n.length+r.length),s,t)}function f3(o,e){const t=[];let i;for(const n of o.slice(0).sort(e))!i||e(i[0],n)!==0?(i=[n],t.push(i)):i.push(n);return t}function*m4(o,e){let t,i;for(const n of o)i!==void 0&&e(i,n)?t.push(n):(t&&(yield t),t=[n]),i=n;t&&(yield t)}function z6(o,e){for(let t=0;t<=o.length;t++)e(t===0?void 0:o[t-1],t===o.length?void 0:o[t])}function DY(o,e){for(let t=0;t<o.length;t++)e(t===0?void 0:o[t-1],o[t],t+1===o.length?void 0:o[t+1])}function Vr(o){return o.filter(e=>!!e)}function p3(o){let e=0;for(let t=0;t<o.length;t++)o[t]&&(o[e]=o[t],e+=1);o.length=e}function U6(o){return!Array.isArray(o)||o.length===0}function Yn(o){return Array.isArray(o)&&o.length>0}function Uc(o,e=t=>t){const t=new Set;return o.filter(i=>{const n=e(i);return t.has(n)?!1:(t.add(n),!0)})}function _4(o,e){return o.length>0?o[0]:e}function Ss(o,e){let t=typeof e=="number"?o:0;typeof e=="number"?t=o:(t=0,e=o);const i=[];if(t<=e)for(let n=t;n<e;n++)i.push(n);else for(let n=t;n>e;n--)i.push(n);return i}function YE(o,e,t){const i=o.slice(0,e),n=o.slice(e);return i.concat(t,n)}function WD(o,e){const t=o.indexOf(e);t>-1&&(o.splice(t,1),o.unshift(e))}function uS(o,e){const t=o.indexOf(e);t>-1&&(o.splice(t,1),o.push(e))}function KN(o,e){for(const t of e)o.push(t)}function b4(o){return Array.isArray(o)?o:[o]}function IY(o,e,t){const i=G6(o,e),n=o.length,s=t.length;o.length=n+s;for(let r=n-1;r>=i;r--)o[r+s]=o[r];for(let r=0;r<s;r++)o[r+i]=t[r]}function m3(o,e,t,i){const n=G6(o,e);let s=o.splice(n,t);return s===void 0&&(s=[]),IY(o,n,i),s}function G6(o,e){return e<0?Math.max(e+o.length,0):Math.min(e,o.length)}var WC;(function(o){function e(s){return s<0}o.isLessThan=e;function t(s){return s<=0}o.isLessThanOrEqual=t;function i(s){return s>0}o.isGreaterThan=i;function n(s){return s===0}o.isNeitherLessOrGreaterThan=n,o.greaterThan=1,o.lessThan=-1,o.neitherLessOrGreaterThan=0})(WC||(WC={}));function cs(o,e){return(t,i)=>e(o(t),o(i))}function NY(...o){return(e,t)=>{for(const i of o){const n=i(e,t);if(!WC.isNeitherLessOrGreaterThan(n))return n}return WC.neitherLessOrGreaterThan}}const Br=(o,e)=>o-e,RY=(o,e)=>Br(o?1:0,e?1:0);function $6(o){return(e,t)=>-o(e,t)}class Gc{constructor(e){this.items=e,this.firstIdx=0,this.lastIdx=this.items.length-1}get length(){return this.lastIdx-this.firstIdx+1}takeWhile(e){let t=this.firstIdx;for(;t<this.items.length&&e(this.items[t]);)t++;const i=t===this.firstIdx?null:this.items.slice(this.firstIdx,t);return this.firstIdx=t,i}takeFromEndWhile(e){let t=this.lastIdx;for(;t>=0&&e(this.items[t]);)t--;const i=t===this.lastIdx?null:this.items.slice(t+1,this.lastIdx+1);return this.lastIdx=t,i}peek(){if(this.length!==0)return this.items[this.firstIdx]}dequeue(){const e=this.items[this.firstIdx];return this.firstIdx++,e}takeCount(e){const t=this.items.slice(this.firstIdx,this.firstIdx+e);return this.firstIdx+=e,t}}const gm=class gm{constructor(e){this.iterate=e}toArray(){const e=[];return this.iterate(t=>(e.push(t),!0)),e}filter(e){return new gm(t=>this.iterate(i=>e(i)?t(i):!0))}map(e){return new gm(t=>this.iterate(i=>t(e(i))))}findLast(e){let t;return this.iterate(i=>(e(i)&&(t=i),!0)),t}findLastMaxBy(e){let t,i=!0;return this.iterate(n=>((i||WC.isGreaterThan(e(n,t)))&&(i=!1,t=n),!0)),t}};gm.empty=new gm(e=>{});let sg=gm;class f0{constructor(e){this._indexMap=e}static createSortPermutation(e,t){const i=Array.from(e.keys()).sort((n,s)=>t(e[n],e[s]));return new f0(i)}apply(e){return e.map((t,i)=>e[this._indexMap[i]])}inverse(){const e=this._indexMap.slice();for(let t=0;t<this._indexMap.length;t++)e[this._indexMap[t]]=t;return new f0(e)}}function Ds(o){return typeof o=="string"}function nn(o){return typeof o=="object"&&o!==null&&!Array.isArray(o)&&!(o instanceof RegExp)&&!(o instanceof Date)}function PY(o){const e=Object.getPrototypeOf(Uint8Array);return typeof o=="object"&&o instanceof e}function Lh(o){return typeof o=="number"&&!isNaN(o)}function _3(o){return!!o&&typeof o[Symbol.iterator]=="function"}function K6(o){return o===!0||o===!1}function Zn(o){return typeof o>"u"}function Sl(o){return!ko(o)}function ko(o){return Zn(o)||o===null}function ut(o,e){if(!o)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Vd(o){if(ko(o))throw new Error("Assertion Failed: argument is undefined or null");return o}function VC(o){return typeof o=="function"}function AY(o,e){const t=Math.min(o.length,e.length);for(let i=0;i<t;i++)MY(o[i],e[i])}function MY(o,e){if(Ds(e)){if(typeof o!==e)throw new Error(`argument does not match constraint: typeof ${e}`)}else if(VC(e)){try{if(o instanceof e)return}catch{}if(!ko(o)&&o.constructor===e||e.length===1&&e.call(void 0,o)===!0)return;throw new Error("argument does not match one of these constraints: arg instanceof constraint, arg.constructor === constraint, nor constraint(arg) === true")}}function gc(o){if(!o||typeof o!="object"||o instanceof RegExp)return o;const e=Array.isArray(o)?[]:{};return Object.entries(o).forEach(([t,i])=>{e[t]=i&&typeof i=="object"?gc(i):i}),e}function OY(o){if(!o||typeof o!="object")return o;const e=[o];for(;e.length>0;){const t=e.shift();Object.freeze(t);for(const i in t)if(j6.call(t,i)){const n=t[i];typeof n=="object"&&!Object.isFrozen(n)&&!PY(n)&&e.push(n)}}return o}const j6=Object.prototype.hasOwnProperty;function q6(o,e){return jN(o,e,new Set)}function jN(o,e,t){if(ko(o))return o;const i=e(o);if(typeof i<"u")return i;if(Array.isArray(o)){const n=[];for(const s of o)n.push(jN(s,e,t));return n}if(nn(o)){if(t.has(o))throw new Error("Cannot clone recursive data-structure");t.add(o);const n={};for(const s in o)j6.call(o,s)&&(n[s]=jN(o[s],e,t));return t.delete(o),n}return o}function XE(o,e,t=!0){return nn(o)?(nn(e)&&Object.keys(e).forEach(i=>{i in o?t&&(nn(o[i])&&nn(e[i])?XE(o[i],e[i],t):o[i]=e[i]):o[i]=e[i]}),o):e}function eo(o,e){if(o===e)return!0;if(o==null||e===null||e===void 0||typeof o!=typeof e||typeof o!="object"||Array.isArray(o)!==Array.isArray(e))return!1;let t,i;if(Array.isArray(o)){if(o.length!==e.length)return!1;for(t=0;t<o.length;t++)if(!eo(o[t],e[t]))return!1}else{const n=[];for(i in o)n.push(i);n.sort();const s=[];for(i in e)s.push(i);if(s.sort(),!eo(n,s))return!1;for(t=0;t<n.length;t++)if(!eo(o[n[t]],e[n[t]]))return!1}return!0}function FY(o){let e=[];for(;Object.prototype!==o;)e=e.concat(Object.getOwnPropertyNames(o)),o=Object.getPrototypeOf(o);return e}function qN(o){const e=[];for(const t of FY(o))typeof o[t]=="function"&&e.push(t);return e}function BY(o,e){const t=n=>function(){const s=Array.prototype.slice.call(arguments,0);return e(n,s)},i={};for(const n of o)i[n]=t(n);return i}function Z6(){return globalThis._VSCODE_NLS_MESSAGES}function v4(){return globalThis._VSCODE_NLS_LANGUAGE}const WY=v4()==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function p0(o,e){let t;return e.length===0?t=o:t=o.replace(/\{(\d+)\}/g,(i,n)=>{const s=n[0],r=e[s];let a=i;return typeof r=="string"?a=r:(typeof r=="number"||typeof r=="boolean"||r===void 0||r===null)&&(a=String(r)),a}),WY&&(t="［"+t.replace(/[aouei]/g,"$&$&")+"］"),t}function p(o,e,...t){return p0(typeof o=="number"?Y6(o,e):e,t)}function Y6(o,e){const t=Z6()?.[o];if(typeof t!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${o} !!!`)}return t}function De(o,e,...t){let i;typeof o=="number"?i=Y6(o,e):i=e;const n=p0(i,t);return{value:n,original:e===i?n:p0(e,t)}}const zp="en";let m0=!1,_0=!1,k1=!1,X6=!1,C4=!1,y4=!1,Q6=!1,gS,E1=zp,b3=zp,VY,ec;const Fc=globalThis;let Qo;typeof Fc.vscode<"u"&&typeof Fc.vscode.process<"u"?Qo=Fc.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Qo=process);const HY=typeof Qo?.versions?.electron=="string",zY=HY&&Qo?.type==="renderer";if(typeof Qo=="object"){m0=Qo.platform==="win32",_0=Qo.platform==="darwin",k1=Qo.platform==="linux",k1&&Qo.env.SNAP&&Qo.env.SNAP_REVISION,Qo.env.CI||Qo.env.BUILD_ARTIFACTSTAGINGDIRECTORY,gS=zp,E1=zp;const o=Qo.env.VSCODE_NLS_CONFIG;if(o)try{const e=JSON.parse(o);gS=e.userLocale,b3=e.osLocale,E1=e.resolvedLanguage||zp,VY=e.languagePack?.translationsConfigFile}catch{}X6=!0}else typeof navigator=="object"&&!zY?(ec=navigator.userAgent,m0=ec.indexOf("Windows")>=0,_0=ec.indexOf("Macintosh")>=0,y4=(ec.indexOf("Macintosh")>=0||ec.indexOf("iPad")>=0||ec.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,k1=ec.indexOf("Linux")>=0,Q6=ec?.indexOf("Mobi")>=0,C4=!0,E1=v4()||zp,gS=navigator.language.toLowerCase(),b3=gS):console.error("Unable to resolve platform.");const En=m0,Qe=_0,us=k1,El=X6,Uf=C4,UY=C4&&typeof Fc.importScripts=="function",GY=UY?Fc.origin:void 0,Ta=y4,J6=Q6,Tl=ec,$Y=E1,KY=typeof Fc.postMessage=="function"&&!Fc.importScripts,ez=(()=>{if(KY){const o=[];Fc.addEventListener("message",t=>{if(t.data&&t.data.vscodeScheduleAsyncWork)for(let i=0,n=o.length;i<n;i++){const s=o[i];if(s.id===t.data.vscodeScheduleAsyncWork){o.splice(i,1),s.callback();return}}});let e=0;return t=>{const i=++e;o.push({id:i,callback:t}),Fc.postMessage({vscodeScheduleAsyncWork:i},"*")}}return o=>setTimeout(o)})(),Js=_0||y4?2:m0?1:3;let v3=!0,C3=!1;function tz(){if(!C3){C3=!0;const o=new Uint8Array(2);o[0]=1,o[1]=2,v3=new Uint16Array(o.buffer)[0]===513}return v3}const iz=!!(Tl&&Tl.indexOf("Chrome")>=0),jY=!!(Tl&&Tl.indexOf("Firefox")>=0),qY=!!(!iz&&Tl&&Tl.indexOf("Safari")>=0),ZY=!!(Tl&&Tl.indexOf("Edg/")>=0),YY=!!(Tl&&Tl.indexOf("Android")>=0),Rn={tabSize:4,indentSize:4,insertSpaces:!0,detectIndentation:!0,trimAutoWhitespace:!0,largeFileOptimizations:!0,bracketPairColorizationOptions:{enabled:!0,independentColorPoolPerBracketType:!1}};var nt;(function(o){function e(C){return C&&typeof C=="object"&&typeof C[Symbol.iterator]=="function"}o.is=e;const t=Object.freeze([]);function i(){return t}o.empty=i;function*n(C){yield C}o.single=n;function s(C){return e(C)?C:n(C)}o.wrap=s;function r(C){return C||t}o.from=r;function*a(C){for(let w=C.length-1;w>=0;w--)yield C[w]}o.reverse=a;function l(C){return!C||C[Symbol.iterator]().next().done===!0}o.isEmpty=l;function c(C){return C[Symbol.iterator]().next().value}o.first=c;function d(C,w){let x=0;for(const k of C)if(w(k,x++))return!0;return!1}o.some=d;function h(C,w){for(const x of C)if(w(x))return x}o.find=h;function*u(C,w){for(const x of C)w(x)&&(yield x)}o.filter=u;function*g(C,w){let x=0;for(const k of C)yield w(k,x++)}o.map=g;function*f(C,w){let x=0;for(const k of C)yield*w(k,x++)}o.flatMap=f;function*m(...C){for(const w of C)yield*w}o.concat=m;function _(C,w,x){let k=x;for(const E of C)k=w(k,E);return k}o.reduce=_;function*b(C,w,x=C.length){for(w<0&&(w+=C.length),x<0?x+=C.length:x>C.length&&(x=C.length);w<x;w++)yield C[w]}o.slice=b;function v(C,w=Number.POSITIVE_INFINITY){const x=[];if(w===0)return[x,C];const k=C[Symbol.iterator]();for(let E=0;E<w;E++){const N=k.next();if(N.done)return[x,o.empty()];x.push(N.value)}return[x,{[Symbol.iterator](){return k}}]}o.consume=v;async function y(C){const w=[];for await(const x of C)w.push(x);return Promise.resolve(w)}o.asyncToArray=y})(nt||(nt={}));var Nc;let Ui=(Nc=class{constructor(e){this.element=e,this.next=Nc.Undefined,this.prev=Nc.Undefined}},Nc.Undefined=new Nc(void 0),Nc);class os{constructor(){this._first=Ui.Undefined,this._last=Ui.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===Ui.Undefined}clear(){let e=this._first;for(;e!==Ui.Undefined;){const t=e.next;e.prev=Ui.Undefined,e.next=Ui.Undefined,e=t}this._first=Ui.Undefined,this._last=Ui.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){const i=new Ui(e);if(this._first===Ui.Undefined)this._first=i,this._last=i;else if(t){const s=this._last;this._last=i,i.prev=s,s.next=i}else{const s=this._first;this._first=i,i.next=s,s.prev=i}this._size+=1;let n=!1;return()=>{n||(n=!0,this._remove(i))}}shift(){if(this._first!==Ui.Undefined){const e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Ui.Undefined){const e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Ui.Undefined&&e.next!==Ui.Undefined){const t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===Ui.Undefined&&e.next===Ui.Undefined?(this._first=Ui.Undefined,this._last=Ui.Undefined):e.next===Ui.Undefined?(this._last=this._last.prev,this._last.next=Ui.Undefined):e.prev===Ui.Undefined&&(this._first=this._first.next,this._first.prev=Ui.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Ui.Undefined;)yield e.element,e=e.next}}const b0="`~!@#$%^&*()-=+[{]}\\|;:'\",.<>/?";function XY(o=""){let e="(-?\\d*\\.\\d\\w*)|([^";for(const t of b0)o.indexOf(t)>=0||(e+="\\"+t);return e+="\\s]+)",new RegExp(e,"g")}const w4=XY();function S4(o){let e=w4;if(o&&o instanceof RegExp)if(o.global)e=o;else{let t="g";o.ignoreCase&&(t+="i"),o.multiline&&(t+="m"),o.unicode&&(t+="u"),e=new RegExp(o.source,t)}return e.lastIndex=0,e}const nz=new os;nz.unshift({maxLen:1e3,windowSize:15,timeBudget:150});function HC(o,e,t,i,n){if(e=S4(e),n||(n=nt.first(nz)),t.length>n.maxLen){let c=o-n.maxLen/2;return c<0?c=0:i+=c,t=t.substring(c,o+n.maxLen/2),HC(o,e,t,i,n)}const s=Date.now(),r=o-1-i;let a=-1,l=null;for(let c=1;!(Date.now()-s>=n.timeBudget);c++){const d=r-n.windowSize*c;e.lastIndex=Math.max(0,d);const h=QY(e,t,r,a);if(!h&&l||(l=h,d<=0))break;a=d}if(l){const c={word:l[0],startColumn:i+1+l.index,endColumn:i+1+l.index+l[0].length};return e.lastIndex=0,c}return null}function QY(o,e,t,i){let n;for(;n=o.exec(e);){const s=n.index||0;if(s<=t&&o.lastIndex>=t)return n;if(i>0&&s>i)return null}return null}const Ya=8;class sz{constructor(e){this._values=e}hasChanged(e){return this._values[e]}}class oz{constructor(){this.stableMinimapLayoutInput=null,this.stableFitMaxMinimapScale=0,this.stableFitRemainingWidth=0}}class Yt{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return QE(e,t)}compute(e,t,i){return i}}class Pv{constructor(e,t){this.newValue=e,this.didChange=t}}function QE(o,e){if(typeof o!="object"||typeof e!="object"||!o||!e)return new Pv(e,o!==e);if(Array.isArray(o)||Array.isArray(e)){const i=Array.isArray(o)&&Array.isArray(e)&&ei(o,e);return new Pv(e,!i)}let t=!1;for(const i in e)if(e.hasOwnProperty(i)){const n=QE(o[i],e[i]);n.didChange&&(o[i]=n.newValue,t=!0)}return new Pv(o,t)}class vw{constructor(e){this.schema=void 0,this.id=e,this.name="_never_",this.defaultValue=void 0}applyUpdate(e,t){return QE(e,t)}validate(e){return this.defaultValue}}class eb{constructor(e,t,i,n){this.id=e,this.name=t,this.defaultValue=i,this.schema=n}applyUpdate(e,t){return QE(e,t)}validate(e){return typeof e>"u"?this.defaultValue:e}compute(e,t,i){return i}}function be(o,e){return typeof o>"u"?e:o==="false"?!1:!!o}class dt extends eb{constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="boolean",n.default=i),super(e,t,i,n)}validate(e){return be(e,this.defaultValue)}}function Cu(o,e,t,i){if(typeof o>"u")return e;let n=parseInt(o,10);return isNaN(n)?e:(n=Math.max(t,n),n=Math.min(i,n),n|0)}class Rt extends eb{static clampedInt(e,t,i,n){return Cu(e,t,i,n)}constructor(e,t,i,n,s,r=void 0){typeof r<"u"&&(r.type="integer",r.default=i,r.minimum=n,r.maximum=s),super(e,t,i,r),this.minimum=n,this.maximum=s}validate(e){return Rt.clampedInt(e,this.defaultValue,this.minimum,this.maximum)}}function JY(o,e,t,i){if(typeof o>"u")return e;const n=Io.float(o,e);return Io.clamp(n,t,i)}class Io extends eb{static clamp(e,t,i){return e<t?t:e>i?i:e}static float(e,t){if(typeof e=="number")return e;if(typeof e>"u")return t;const i=parseFloat(e);return isNaN(i)?t:i}constructor(e,t,i,n,s){typeof s<"u"&&(s.type="number",s.default=i),super(e,t,i,s),this.validationFn=n}validate(e){return this.validationFn(Io.float(e,this.defaultValue))}}class jn extends eb{static string(e,t){return typeof e!="string"?t:e}constructor(e,t,i,n=void 0){typeof n<"u"&&(n.type="string",n.default=i),super(e,t,i,n)}validate(e){return jn.string(e,this.defaultValue)}}function ui(o,e,t,i){return typeof o!="string"?e:i&&o in i?i[o]:t.indexOf(o)===-1?e:o}class hi extends eb{constructor(e,t,i,n,s=void 0){typeof s<"u"&&(s.type="string",s.enum=n,s.default=i),super(e,t,i,s),this._allowedValues=n}validate(e){return ui(e,this.defaultValue,this._allowedValues)}}class fS extends Yt{constructor(e,t,i,n,s,r,a=void 0){typeof a<"u"&&(a.type="string",a.enum=s,a.default=n),super(e,t,i,a),this._allowedValues=s,this._convert=r}validate(e){return typeof e!="string"?this.defaultValue:this._allowedValues.indexOf(e)===-1?this.defaultValue:this._convert(e)}}function eX(o){switch(o){case"none":return 0;case"keep":return 1;case"brackets":return 2;case"advanced":return 3;case"full":return 4}}class tX extends Yt{constructor(){super(2,"accessibilitySupport",0,{type:"string",enum:["auto","on","off"],enumDescriptions:[p("accessibilitySupport.auto","Use platform APIs to detect when a Screen Reader is attached."),p("accessibilitySupport.on","Optimize for usage with a Screen Reader."),p("accessibilitySupport.off","Assume a screen reader is not attached.")],default:"auto",tags:["accessibility"],description:p("accessibilitySupport","Controls if the UI should run in a mode where it is optimized for screen readers.")})}validate(e){switch(e){case"auto":return 0;case"off":return 1;case"on":return 2}return this.defaultValue}compute(e,t,i){return i===0?e.accessibilitySupport:i}}class iX extends Yt{constructor(){const e={insertSpace:!0,ignoreEmptyLines:!0};super(23,"comments",e,{"editor.comments.insertSpace":{type:"boolean",default:e.insertSpace,description:p("comments.insertSpace","Controls whether a space character is inserted when commenting.")},"editor.comments.ignoreEmptyLines":{type:"boolean",default:e.ignoreEmptyLines,description:p("comments.ignoreEmptyLines","Controls if empty lines should be ignored with toggle, add or remove actions for line comments.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertSpace:be(t.insertSpace,this.defaultValue.insertSpace),ignoreEmptyLines:be(t.ignoreEmptyLines,this.defaultValue.ignoreEmptyLines)}}}function nX(o){switch(o){case"blink":return 1;case"smooth":return 2;case"phase":return 3;case"expand":return 4;case"solid":return 5}}var un;(function(o){o[o.Line=1]="Line",o[o.Block=2]="Block",o[o.Underline=3]="Underline",o[o.LineThin=4]="LineThin",o[o.BlockOutline=5]="BlockOutline",o[o.UnderlineThin=6]="UnderlineThin"})(un||(un={}));function sX(o){switch(o){case"line":return un.Line;case"block":return un.Block;case"underline":return un.Underline;case"line-thin":return un.LineThin;case"block-outline":return un.BlockOutline;case"underline-thin":return un.UnderlineThin}}class oX extends vw{constructor(){super(143)}compute(e,t,i){const n=["monaco-editor"];return t.get(39)&&n.push(t.get(39)),e.extraEditorClassName&&n.push(e.extraEditorClassName),t.get(74)==="default"?n.push("mouse-default"):t.get(74)==="copy"&&n.push("mouse-copy"),t.get(112)&&n.push("showUnused"),t.get(141)&&n.push("showDeprecated"),n.join(" ")}}class rX extends dt{constructor(){super(37,"emptySelectionClipboard",!0,{description:p("emptySelectionClipboard","Controls whether copying without a selection copies the current line.")})}compute(e,t,i){return i&&e.emptySelectionClipboard}}class aX extends Yt{constructor(){const e={cursorMoveOnType:!0,seedSearchStringFromSelection:"always",autoFindInSelection:"never",globalFindClipboard:!1,addExtraSpaceOnTop:!0,loop:!0};super(41,"find",e,{"editor.find.cursorMoveOnType":{type:"boolean",default:e.cursorMoveOnType,description:p("find.cursorMoveOnType","Controls whether the cursor should jump to find matches while typing.")},"editor.find.seedSearchStringFromSelection":{type:"string",enum:["never","always","selection"],default:e.seedSearchStringFromSelection,enumDescriptions:[p("editor.find.seedSearchStringFromSelection.never","Never seed search string from the editor selection."),p("editor.find.seedSearchStringFromSelection.always","Always seed search string from the editor selection, including word at cursor position."),p("editor.find.seedSearchStringFromSelection.selection","Only seed search string from the editor selection.")],description:p("find.seedSearchStringFromSelection","Controls whether the search string in the Find Widget is seeded from the editor selection.")},"editor.find.autoFindInSelection":{type:"string",enum:["never","always","multiline"],default:e.autoFindInSelection,enumDescriptions:[p("editor.find.autoFindInSelection.never","Never turn on Find in Selection automatically (default)."),p("editor.find.autoFindInSelection.always","Always turn on Find in Selection automatically."),p("editor.find.autoFindInSelection.multiline","Turn on Find in Selection automatically when multiple lines of content are selected.")],description:p("find.autoFindInSelection","Controls the condition for turning on Find in Selection automatically.")},"editor.find.globalFindClipboard":{type:"boolean",default:e.globalFindClipboard,description:p("find.globalFindClipboard","Controls whether the Find Widget should read or modify the shared find clipboard on macOS."),included:Qe},"editor.find.addExtraSpaceOnTop":{type:"boolean",default:e.addExtraSpaceOnTop,description:p("find.addExtraSpaceOnTop","Controls whether the Find Widget should add extra lines on top of the editor. When true, you can scroll beyond the first line when the Find Widget is visible.")},"editor.find.loop":{type:"boolean",default:e.loop,description:p("find.loop","Controls whether the search automatically restarts from the beginning (or the end) when no further matches can be found.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{cursorMoveOnType:be(t.cursorMoveOnType,this.defaultValue.cursorMoveOnType),seedSearchStringFromSelection:typeof e.seedSearchStringFromSelection=="boolean"?e.seedSearchStringFromSelection?"always":"never":ui(t.seedSearchStringFromSelection,this.defaultValue.seedSearchStringFromSelection,["never","always","selection"]),autoFindInSelection:typeof e.autoFindInSelection=="boolean"?e.autoFindInSelection?"always":"never":ui(t.autoFindInSelection,this.defaultValue.autoFindInSelection,["never","always","multiline"]),globalFindClipboard:be(t.globalFindClipboard,this.defaultValue.globalFindClipboard),addExtraSpaceOnTop:be(t.addExtraSpaceOnTop,this.defaultValue.addExtraSpaceOnTop),loop:be(t.loop,this.defaultValue.loop)}}}const lc=class lc extends Yt{constructor(){super(51,"fontLigatures",lc.OFF,{anyOf:[{type:"boolean",description:p("fontLigatures","Enables/Disables font ligatures ('calt' and 'liga' font features). Change this to a string for fine-grained control of the 'font-feature-settings' CSS property.")},{type:"string",description:p("fontFeatureSettings","Explicit 'font-feature-settings' CSS property. A boolean can be passed instead if one only needs to turn on/off ligatures.")}],description:p("fontLigaturesGeneral","Configures font ligatures or font features. Can be either a boolean to enable/disable ligatures or a string for the value of the CSS 'font-feature-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"||e.length===0?lc.OFF:e==="true"?lc.ON:e:e?lc.ON:lc.OFF}};lc.OFF='"liga" off, "calt" off',lc.ON='"liga" on, "calt" on';let kh=lc;const cc=class cc extends Yt{constructor(){super(54,"fontVariations",cc.OFF,{anyOf:[{type:"boolean",description:p("fontVariations","Enables/Disables the translation from font-weight to font-variation-settings. Change this to a string for fine-grained control of the 'font-variation-settings' CSS property.")},{type:"string",description:p("fontVariationSettings","Explicit 'font-variation-settings' CSS property. A boolean can be passed instead if one only needs to translate font-weight to font-variation-settings.")}],description:p("fontVariationsGeneral","Configures font variations. Can be either a boolean to enable/disable the translation from font-weight to font-variation-settings or a string for the value of the CSS 'font-variation-settings' property."),default:!1})}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e==="false"?cc.OFF:e==="true"?cc.TRANSLATE:e:e?cc.TRANSLATE:cc.OFF}compute(e,t,i){return e.fontInfo.fontVariationSettings}};cc.OFF="normal",cc.TRANSLATE="translate";let zC=cc;class lX extends vw{constructor(){super(50)}compute(e,t,i){return e.fontInfo}}class cX extends eb{constructor(){super(52,"fontSize",ds.fontSize,{type:"number",minimum:6,maximum:100,default:ds.fontSize,description:p("fontSize","Controls the font size in pixels.")})}validate(e){const t=Io.float(e,this.defaultValue);return t===0?ds.fontSize:Io.clamp(t,6,100)}compute(e,t,i){return e.fontInfo.fontSize}}const tl=class tl extends Yt{constructor(){super(53,"fontWeight",ds.fontWeight,{anyOf:[{type:"number",minimum:tl.MINIMUM_VALUE,maximum:tl.MAXIMUM_VALUE,errorMessage:p("fontWeightErrorMessage",'Only "normal" and "bold" keywords or numbers between 1 and 1000 are allowed.')},{type:"string",pattern:"^(normal|bold|1000|[1-9][0-9]{0,2})$"},{enum:tl.SUGGESTION_VALUES}],default:ds.fontWeight,description:p("fontWeight",'Controls the font weight. Accepts "normal" and "bold" keywords or numbers between 1 and 1000.')})}validate(e){return e==="normal"||e==="bold"?e:String(Rt.clampedInt(e,ds.fontWeight,tl.MINIMUM_VALUE,tl.MAXIMUM_VALUE))}};tl.SUGGESTION_VALUES=["normal","bold","100","200","300","400","500","600","700","800","900"],tl.MINIMUM_VALUE=1,tl.MAXIMUM_VALUE=1e3;let ZN=tl;class dX extends Yt{constructor(){const e={multiple:"peek",multipleDefinitions:"peek",multipleTypeDefinitions:"peek",multipleDeclarations:"peek",multipleImplementations:"peek",multipleReferences:"peek",multipleTests:"peek",alternativeDefinitionCommand:"editor.action.goToReferences",alternativeTypeDefinitionCommand:"editor.action.goToReferences",alternativeDeclarationCommand:"editor.action.goToReferences",alternativeImplementationCommand:"",alternativeReferenceCommand:"",alternativeTestsCommand:""},t={type:"string",enum:["peek","gotoAndPeek","goto"],default:e.multiple,enumDescriptions:[p("editor.gotoLocation.multiple.peek","Show Peek view of the results (default)"),p("editor.gotoLocation.multiple.gotoAndPeek","Go to the primary result and show a Peek view"),p("editor.gotoLocation.multiple.goto","Go to the primary result and enable Peek-less navigation to others")]},i=["","editor.action.referenceSearch.trigger","editor.action.goToReferences","editor.action.peekImplementation","editor.action.goToImplementation","editor.action.peekTypeDefinition","editor.action.goToTypeDefinition","editor.action.peekDeclaration","editor.action.revealDeclaration","editor.action.peekDefinition","editor.action.revealDefinitionAside","editor.action.revealDefinition"];super(58,"gotoLocation",e,{"editor.gotoLocation.multiple":{deprecationMessage:p("editor.gotoLocation.multiple.deprecated","This setting is deprecated, please use separate settings like 'editor.editor.gotoLocation.multipleDefinitions' or 'editor.editor.gotoLocation.multipleImplementations' instead.")},"editor.gotoLocation.multipleDefinitions":{description:p("editor.editor.gotoLocation.multipleDefinitions","Controls the behavior the 'Go to Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleTypeDefinitions":{description:p("editor.editor.gotoLocation.multipleTypeDefinitions","Controls the behavior the 'Go to Type Definition'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleDeclarations":{description:p("editor.editor.gotoLocation.multipleDeclarations","Controls the behavior the 'Go to Declaration'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleImplementations":{description:p("editor.editor.gotoLocation.multipleImplemenattions","Controls the behavior the 'Go to Implementations'-command when multiple target locations exist."),...t},"editor.gotoLocation.multipleReferences":{description:p("editor.editor.gotoLocation.multipleReferences","Controls the behavior the 'Go to References'-command when multiple target locations exist."),...t},"editor.gotoLocation.alternativeDefinitionCommand":{type:"string",default:e.alternativeDefinitionCommand,enum:i,description:p("alternativeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Definition' is the current location.")},"editor.gotoLocation.alternativeTypeDefinitionCommand":{type:"string",default:e.alternativeTypeDefinitionCommand,enum:i,description:p("alternativeTypeDefinitionCommand","Alternative command id that is being executed when the result of 'Go to Type Definition' is the current location.")},"editor.gotoLocation.alternativeDeclarationCommand":{type:"string",default:e.alternativeDeclarationCommand,enum:i,description:p("alternativeDeclarationCommand","Alternative command id that is being executed when the result of 'Go to Declaration' is the current location.")},"editor.gotoLocation.alternativeImplementationCommand":{type:"string",default:e.alternativeImplementationCommand,enum:i,description:p("alternativeImplementationCommand","Alternative command id that is being executed when the result of 'Go to Implementation' is the current location.")},"editor.gotoLocation.alternativeReferenceCommand":{type:"string",default:e.alternativeReferenceCommand,enum:i,description:p("alternativeReferenceCommand","Alternative command id that is being executed when the result of 'Go to Reference' is the current location.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{multiple:ui(t.multiple,this.defaultValue.multiple,["peek","gotoAndPeek","goto"]),multipleDefinitions:t.multipleDefinitions??ui(t.multipleDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleTypeDefinitions:t.multipleTypeDefinitions??ui(t.multipleTypeDefinitions,"peek",["peek","gotoAndPeek","goto"]),multipleDeclarations:t.multipleDeclarations??ui(t.multipleDeclarations,"peek",["peek","gotoAndPeek","goto"]),multipleImplementations:t.multipleImplementations??ui(t.multipleImplementations,"peek",["peek","gotoAndPeek","goto"]),multipleReferences:t.multipleReferences??ui(t.multipleReferences,"peek",["peek","gotoAndPeek","goto"]),multipleTests:t.multipleTests??ui(t.multipleTests,"peek",["peek","gotoAndPeek","goto"]),alternativeDefinitionCommand:jn.string(t.alternativeDefinitionCommand,this.defaultValue.alternativeDefinitionCommand),alternativeTypeDefinitionCommand:jn.string(t.alternativeTypeDefinitionCommand,this.defaultValue.alternativeTypeDefinitionCommand),alternativeDeclarationCommand:jn.string(t.alternativeDeclarationCommand,this.defaultValue.alternativeDeclarationCommand),alternativeImplementationCommand:jn.string(t.alternativeImplementationCommand,this.defaultValue.alternativeImplementationCommand),alternativeReferenceCommand:jn.string(t.alternativeReferenceCommand,this.defaultValue.alternativeReferenceCommand),alternativeTestsCommand:jn.string(t.alternativeTestsCommand,this.defaultValue.alternativeTestsCommand)}}}class hX extends Yt{constructor(){const e={enabled:!0,delay:300,hidingDelay:300,sticky:!0,above:!0};super(60,"hover",e,{"editor.hover.enabled":{type:"boolean",default:e.enabled,description:p("hover.enabled","Controls whether the hover is shown.")},"editor.hover.delay":{type:"number",default:e.delay,minimum:0,maximum:1e4,description:p("hover.delay","Controls the delay in milliseconds after which the hover is shown.")},"editor.hover.sticky":{type:"boolean",default:e.sticky,description:p("hover.sticky","Controls whether the hover should remain visible when mouse is moved over it.")},"editor.hover.hidingDelay":{type:"integer",minimum:0,default:e.hidingDelay,description:p("hover.hidingDelay","Controls the delay in milliseconds after which the hover is hidden. Requires `editor.hover.sticky` to be enabled.")},"editor.hover.above":{type:"boolean",default:e.above,description:p("hover.above","Prefer showing hovers above the line, if there's space.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),delay:Rt.clampedInt(t.delay,this.defaultValue.delay,0,1e4),sticky:be(t.sticky,this.defaultValue.sticky),hidingDelay:Rt.clampedInt(t.hidingDelay,this.defaultValue.hidingDelay,0,6e5),above:be(t.above,this.defaultValue.above)}}}class Dm extends vw{constructor(){super(146)}compute(e,t,i){return Dm.computeLayout(t,{memory:e.memory,outerWidth:e.outerWidth,outerHeight:e.outerHeight,isDominatedByLongLines:e.isDominatedByLongLines,lineHeight:e.fontInfo.lineHeight,viewLineCount:e.viewLineCount,lineNumbersDigitCount:e.lineNumbersDigitCount,typicalHalfwidthCharacterWidth:e.fontInfo.typicalHalfwidthCharacterWidth,maxDigitWidth:e.fontInfo.maxDigitWidth,pixelRatio:e.pixelRatio,glyphMarginDecorationLaneCount:e.glyphMarginDecorationLaneCount})}static computeContainedMinimapLineCount(e){const t=e.height/e.lineHeight,i=Math.floor(e.paddingTop/e.lineHeight);let n=Math.floor(e.paddingBottom/e.lineHeight);e.scrollBeyondLastLine&&(n=Math.max(n,t-1));const s=(i+e.viewLineCount+n)/(e.pixelRatio*e.height),r=Math.floor(e.viewLineCount/s);return{typicalViewportLineCount:t,extraLinesBeforeFirstLine:i,extraLinesBeyondLastLine:n,desiredRatio:s,minimapLineCount:r}}static _computeMinimapLayout(e,t){const i=e.outerWidth,n=e.outerHeight,s=e.pixelRatio;if(!e.minimap.enabled)return{renderMinimap:0,minimapLeft:0,minimapWidth:0,minimapHeightIsEditorHeight:!1,minimapIsSampling:!1,minimapScale:1,minimapLineHeight:1,minimapCanvasInnerWidth:0,minimapCanvasInnerHeight:Math.floor(s*n),minimapCanvasOuterWidth:0,minimapCanvasOuterHeight:n};const r=t.stableMinimapLayoutInput,a=r&&e.outerHeight===r.outerHeight&&e.lineHeight===r.lineHeight&&e.typicalHalfwidthCharacterWidth===r.typicalHalfwidthCharacterWidth&&e.pixelRatio===r.pixelRatio&&e.scrollBeyondLastLine===r.scrollBeyondLastLine&&e.paddingTop===r.paddingTop&&e.paddingBottom===r.paddingBottom&&e.minimap.enabled===r.minimap.enabled&&e.minimap.side===r.minimap.side&&e.minimap.size===r.minimap.size&&e.minimap.showSlider===r.minimap.showSlider&&e.minimap.renderCharacters===r.minimap.renderCharacters&&e.minimap.maxColumn===r.minimap.maxColumn&&e.minimap.scale===r.minimap.scale&&e.verticalScrollbarWidth===r.verticalScrollbarWidth&&e.isViewportWrapping===r.isViewportWrapping,l=e.lineHeight,c=e.typicalHalfwidthCharacterWidth,d=e.scrollBeyondLastLine,h=e.minimap.renderCharacters;let u=s>=2?Math.round(e.minimap.scale*2):e.minimap.scale;const g=e.minimap.maxColumn,f=e.minimap.size,m=e.minimap.side,_=e.verticalScrollbarWidth,b=e.viewLineCount,v=e.remainingWidth,y=e.isViewportWrapping,C=h?2:3;let w=Math.floor(s*n);const x=w/s;let k=!1,E=!1,N=C*u,z=u/s,B=1;if(f==="fill"||f==="fit"){const{typicalViewportLineCount:_e,extraLinesBeforeFirstLine:he,extraLinesBeyondLastLine:Ne,desiredRatio:Pe,minimapLineCount:Xt}=Dm.computeContainedMinimapLineCount({viewLineCount:b,scrollBeyondLastLine:d,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:n,lineHeight:l,pixelRatio:s});if(b/Xt>1)k=!0,E=!0,u=1,N=1,z=u/s;else{let di=!1,kt=u+1;if(f==="fit"){const Di=Math.ceil((he+b+Ne)*N);y&&a&&v<=t.stableFitRemainingWidth?(di=!0,kt=t.stableFitMaxMinimapScale):di=Di>w}if(f==="fill"||di){k=!0;const Di=u;N=Math.min(l*s,Math.max(1,Math.floor(1/Pe))),y&&a&&v<=t.stableFitRemainingWidth&&(kt=t.stableFitMaxMinimapScale),u=Math.min(kt,Math.max(1,Math.floor(N/C))),u>Di&&(B=Math.min(2,u/Di)),z=u/s/B,w=Math.ceil(Math.max(_e,he+b+Ne)*N),y?(t.stableMinimapLayoutInput=e,t.stableFitRemainingWidth=v,t.stableFitMaxMinimapScale=u):(t.stableMinimapLayoutInput=null,t.stableFitRemainingWidth=0)}}}const U=Math.floor(g*z),Z=Math.min(U,Math.max(0,Math.floor((v-_-2)*z/(c+z)))+Ya);let V=Math.floor(s*Z);const Q=V/s;V=Math.floor(V*B);const le=h?1:2,ge=m==="left"?0:i-Z-_;return{renderMinimap:le,minimapLeft:ge,minimapWidth:Z,minimapHeightIsEditorHeight:k,minimapIsSampling:E,minimapScale:u,minimapLineHeight:N,minimapCanvasInnerWidth:V,minimapCanvasInnerHeight:w,minimapCanvasOuterWidth:Q,minimapCanvasOuterHeight:x}}static computeLayout(e,t){const i=t.outerWidth|0,n=t.outerHeight|0,s=t.lineHeight|0,r=t.lineNumbersDigitCount|0,a=t.typicalHalfwidthCharacterWidth,l=t.maxDigitWidth,c=t.pixelRatio,d=t.viewLineCount,h=e.get(138),u=h==="inherit"?e.get(137):h,g=u==="inherit"?e.get(133):u,f=e.get(136),m=t.isDominatedByLongLines,_=e.get(57),b=e.get(68).renderType!==0,v=e.get(69),y=e.get(106),C=e.get(84),w=e.get(73),x=e.get(104),k=x.verticalScrollbarSize,E=x.verticalHasArrows,N=x.arrowSize,z=x.horizontalScrollbarSize,B=e.get(43),U=e.get(111)!=="never";let Z=e.get(66);B&&U&&(Z+=16);let V=0;if(b){const Bi=Math.max(r,v);V=Math.round(Bi*l)}let Q=0;_&&(Q=s*t.glyphMarginDecorationLaneCount);let le=0,ge=le+Q,_e=ge+V,he=_e+Z;const Ne=i-Q-V-Z;let Pe=!1,Xt=!1,Lt=-1;u==="inherit"&&m?(Pe=!0,Xt=!0):g==="on"||g==="bounded"?Xt=!0:g==="wordWrapColumn"&&(Lt=f);const di=Dm._computeMinimapLayout({outerWidth:i,outerHeight:n,lineHeight:s,typicalHalfwidthCharacterWidth:a,pixelRatio:c,scrollBeyondLastLine:y,paddingTop:C.top,paddingBottom:C.bottom,minimap:w,verticalScrollbarWidth:k,viewLineCount:d,remainingWidth:Ne,isViewportWrapping:Xt},t.memory||new oz);di.renderMinimap!==0&&di.minimapLeft===0&&(le+=di.minimapWidth,ge+=di.minimapWidth,_e+=di.minimapWidth,he+=di.minimapWidth);const kt=Ne-di.minimapWidth,Di=Math.max(1,Math.floor((kt-k-2)/a)),jo=E?N:0;return Xt&&(Lt=Math.max(1,Di),g==="bounded"&&(Lt=Math.min(Lt,f))),{width:i,height:n,glyphMarginLeft:le,glyphMarginWidth:Q,glyphMarginDecorationLaneCount:t.glyphMarginDecorationLaneCount,lineNumbersLeft:ge,lineNumbersWidth:V,decorationsLeft:_e,decorationsWidth:Z,contentLeft:he,contentWidth:kt,minimap:di,viewportColumn:Di,isWordWrapMinified:Pe,isViewportWrapping:Xt,wrappingColumn:Lt,verticalScrollbarWidth:k,horizontalScrollbarHeight:z,overviewRuler:{top:jo,width:k,height:n-2*jo,right:0}}}}class uX extends Yt{constructor(){super(140,"wrappingStrategy","simple",{"editor.wrappingStrategy":{enumDescriptions:[p("wrappingStrategy.simple","Assumes that all characters are of the same width. This is a fast algorithm that works correctly for monospace fonts and certain scripts (like Latin characters) where glyphs are of equal width."),p("wrappingStrategy.advanced","Delegates wrapping points computation to the browser. This is a slow algorithm, that might cause freezes for large files, but it works correctly in all cases.")],type:"string",enum:["simple","advanced"],default:"simple",description:p("wrappingStrategy","Controls the algorithm that computes wrapping points. Note that when in accessibility mode, advanced will be used for the best experience.")}})}validate(e){return ui(e,"simple",["simple","advanced"])}compute(e,t,i){return t.get(2)===2?"advanced":i}}var Ir;(function(o){o.Off="off",o.OnCode="onCode",o.On="on"})(Ir||(Ir={}));class gX extends Yt{constructor(){const e={enabled:Ir.OnCode};super(65,"lightbulb",e,{"editor.lightbulb.enabled":{type:"string",tags:["experimental"],enum:[Ir.Off,Ir.OnCode,Ir.On],default:e.enabled,enumDescriptions:[p("editor.lightbulb.enabled.off","Disable the code action menu."),p("editor.lightbulb.enabled.onCode","Show the code action menu when the cursor is on lines with code."),p("editor.lightbulb.enabled.on","Show the code action menu when the cursor is on lines with code or on empty lines.")],description:p("enabled","Enables the Code Action lightbulb in the editor.")}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{enabled:ui(e.enabled,this.defaultValue.enabled,[Ir.Off,Ir.OnCode,Ir.On])}}}class fX extends Yt{constructor(){const e={enabled:!0,maxLineCount:5,defaultModel:"outlineModel",scrollWithEditor:!0};super(116,"stickyScroll",e,{"editor.stickyScroll.enabled":{type:"boolean",default:e.enabled,description:p("editor.stickyScroll.enabled","Shows the nested current scopes during the scroll at the top of the editor."),tags:["experimental"]},"editor.stickyScroll.maxLineCount":{type:"number",default:e.maxLineCount,minimum:1,maximum:20,description:p("editor.stickyScroll.maxLineCount","Defines the maximum number of sticky lines to show.")},"editor.stickyScroll.defaultModel":{type:"string",enum:["outlineModel","foldingProviderModel","indentationModel"],default:e.defaultModel,description:p("editor.stickyScroll.defaultModel","Defines the model to use for determining which lines to stick. If the outline model does not exist, it will fall back on the folding provider model which falls back on the indentation model. This order is respected in all three cases.")},"editor.stickyScroll.scrollWithEditor":{type:"boolean",default:e.scrollWithEditor,description:p("editor.stickyScroll.scrollWithEditor","Enable scrolling of Sticky Scroll with the editor's horizontal scrollbar.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),maxLineCount:Rt.clampedInt(t.maxLineCount,this.defaultValue.maxLineCount,1,20),defaultModel:ui(t.defaultModel,this.defaultValue.defaultModel,["outlineModel","foldingProviderModel","indentationModel"]),scrollWithEditor:be(t.scrollWithEditor,this.defaultValue.scrollWithEditor)}}}class pX extends Yt{constructor(){const e={enabled:"on",fontSize:0,fontFamily:"",padding:!1};super(142,"inlayHints",e,{"editor.inlayHints.enabled":{type:"string",default:e.enabled,description:p("inlayHints.enable","Enables the inlay hints in the editor."),enum:["on","onUnlessPressed","offUnlessPressed","off"],markdownEnumDescriptions:[p("editor.inlayHints.on","Inlay hints are enabled"),p("editor.inlayHints.onUnlessPressed","Inlay hints are showing by default and hide when holding {0}",Qe?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.offUnlessPressed","Inlay hints are hidden by default and show when holding {0}",Qe?"Ctrl+Option":"Ctrl+Alt"),p("editor.inlayHints.off","Inlay hints are disabled")]},"editor.inlayHints.fontSize":{type:"number",default:e.fontSize,markdownDescription:p("inlayHints.fontSize","Controls font size of inlay hints in the editor. As default the {0} is used when the configured value is less than {1} or greater than the editor font size.","`#editor.fontSize#`","`5`")},"editor.inlayHints.fontFamily":{type:"string",default:e.fontFamily,markdownDescription:p("inlayHints.fontFamily","Controls font family of inlay hints in the editor. When set to empty, the {0} is used.","`#editor.fontFamily#`")},"editor.inlayHints.padding":{type:"boolean",default:e.padding,description:p("inlayHints.padding","Enables the padding around the inlay hints in the editor.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return typeof t.enabled=="boolean"&&(t.enabled=t.enabled?"on":"off"),{enabled:ui(t.enabled,this.defaultValue.enabled,["on","off","offUnlessPressed","onUnlessPressed"]),fontSize:Rt.clampedInt(t.fontSize,this.defaultValue.fontSize,0,100),fontFamily:jn.string(t.fontFamily,this.defaultValue.fontFamily),padding:be(t.padding,this.defaultValue.padding)}}}class mX extends Yt{constructor(){super(66,"lineDecorationsWidth",10)}validate(e){return typeof e=="string"&&/^\d+(\.\d+)?ch$/.test(e)?-parseFloat(e.substring(0,e.length-2)):Rt.clampedInt(e,this.defaultValue,0,1e3)}compute(e,t,i){return i<0?Rt.clampedInt(-i*e.fontInfo.typicalHalfwidthCharacterWidth,this.defaultValue,0,1e3):i}}class _X extends Io{constructor(){super(67,"lineHeight",ds.lineHeight,e=>Io.clamp(e,0,150),{markdownDescription:p("lineHeight",`Controls the line height. 
 - Use 0 to automatically compute the line height from the font size.
 - Values between 0 and 8 will be used as a multiplier with the font size.
 - Values greater than or equal to 8 will be used as effective values.`)})}compute(e,t,i){return e.fontInfo.lineHeight}}class bX extends Yt{constructor(){const e={enabled:!0,size:"proportional",side:"right",showSlider:"mouseover",autohide:!1,renderCharacters:!0,maxColumn:120,scale:1,showRegionSectionHeaders:!0,showMarkSectionHeaders:!0,sectionHeaderFontSize:9,sectionHeaderLetterSpacing:1};super(73,"minimap",e,{"editor.minimap.enabled":{type:"boolean",default:e.enabled,description:p("minimap.enabled","Controls whether the minimap is shown.")},"editor.minimap.autohide":{type:"boolean",default:e.autohide,description:p("minimap.autohide","Controls whether the minimap is hidden automatically.")},"editor.minimap.size":{type:"string",enum:["proportional","fill","fit"],enumDescriptions:[p("minimap.size.proportional","The minimap has the same size as the editor contents (and might scroll)."),p("minimap.size.fill","The minimap will stretch or shrink as necessary to fill the height of the editor (no scrolling)."),p("minimap.size.fit","The minimap will shrink as necessary to never be larger than the editor (no scrolling).")],default:e.size,description:p("minimap.size","Controls the size of the minimap.")},"editor.minimap.side":{type:"string",enum:["left","right"],default:e.side,description:p("minimap.side","Controls the side where to render the minimap.")},"editor.minimap.showSlider":{type:"string",enum:["always","mouseover"],default:e.showSlider,description:p("minimap.showSlider","Controls when the minimap slider is shown.")},"editor.minimap.scale":{type:"number",default:e.scale,minimum:1,maximum:3,enum:[1,2,3],description:p("minimap.scale","Scale of content drawn in the minimap: 1, 2 or 3.")},"editor.minimap.renderCharacters":{type:"boolean",default:e.renderCharacters,description:p("minimap.renderCharacters","Render the actual characters on a line as opposed to color blocks.")},"editor.minimap.maxColumn":{type:"number",default:e.maxColumn,description:p("minimap.maxColumn","Limit the width of the minimap to render at most a certain number of columns.")},"editor.minimap.showRegionSectionHeaders":{type:"boolean",default:e.showRegionSectionHeaders,description:p("minimap.showRegionSectionHeaders","Controls whether named regions are shown as section headers in the minimap.")},"editor.minimap.showMarkSectionHeaders":{type:"boolean",default:e.showMarkSectionHeaders,description:p("minimap.showMarkSectionHeaders","Controls whether MARK: comments are shown as section headers in the minimap.")},"editor.minimap.sectionHeaderFontSize":{type:"number",default:e.sectionHeaderFontSize,description:p("minimap.sectionHeaderFontSize","Controls the font size of section headers in the minimap.")},"editor.minimap.sectionHeaderLetterSpacing":{type:"number",default:e.sectionHeaderLetterSpacing,description:p("minimap.sectionHeaderLetterSpacing","Controls the amount of space (in pixels) between characters of section header. This helps the readability of the header in small font sizes.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),autohide:be(t.autohide,this.defaultValue.autohide),size:ui(t.size,this.defaultValue.size,["proportional","fill","fit"]),side:ui(t.side,this.defaultValue.side,["right","left"]),showSlider:ui(t.showSlider,this.defaultValue.showSlider,["always","mouseover"]),renderCharacters:be(t.renderCharacters,this.defaultValue.renderCharacters),scale:Rt.clampedInt(t.scale,1,1,3),maxColumn:Rt.clampedInt(t.maxColumn,this.defaultValue.maxColumn,1,1e4),showRegionSectionHeaders:be(t.showRegionSectionHeaders,this.defaultValue.showRegionSectionHeaders),showMarkSectionHeaders:be(t.showMarkSectionHeaders,this.defaultValue.showMarkSectionHeaders),sectionHeaderFontSize:Io.clamp(t.sectionHeaderFontSize??this.defaultValue.sectionHeaderFontSize,4,32),sectionHeaderLetterSpacing:Io.clamp(t.sectionHeaderLetterSpacing??this.defaultValue.sectionHeaderLetterSpacing,0,5)}}}function vX(o){return o==="ctrlCmd"?Qe?"metaKey":"ctrlKey":"altKey"}class CX extends Yt{constructor(){super(84,"padding",{top:0,bottom:0},{"editor.padding.top":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.top","Controls the amount of space between the top edge of the editor and the first line.")},"editor.padding.bottom":{type:"number",default:0,minimum:0,maximum:1e3,description:p("padding.bottom","Controls the amount of space between the bottom edge of the editor and the last line.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{top:Rt.clampedInt(t.top,0,0,1e3),bottom:Rt.clampedInt(t.bottom,0,0,1e3)}}}class yX extends Yt{constructor(){const e={enabled:!0,cycle:!0};super(86,"parameterHints",e,{"editor.parameterHints.enabled":{type:"boolean",default:e.enabled,description:p("parameterHints.enabled","Enables a pop-up that shows parameter documentation and type information as you type.")},"editor.parameterHints.cycle":{type:"boolean",default:e.cycle,description:p("parameterHints.cycle","Controls whether the parameter hints menu cycles or closes when reaching the end of the list.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),cycle:be(t.cycle,this.defaultValue.cycle)}}}class wX extends vw{constructor(){super(144)}compute(e,t,i){return e.pixelRatio}}class SX extends Yt{constructor(){super(88,"placeholder",void 0)}validate(e){return typeof e>"u"?this.defaultValue:typeof e=="string"?e:this.defaultValue}}class xX extends Yt{constructor(){const e={other:"on",comments:"off",strings:"off"},t=[{type:"boolean"},{type:"string",enum:["on","inline","off"],enumDescriptions:[p("on","Quick suggestions show inside the suggest widget"),p("inline","Quick suggestions show as ghost text"),p("off","Quick suggestions are disabled")]}];super(90,"quickSuggestions",e,{type:"object",additionalProperties:!1,properties:{strings:{anyOf:t,default:e.strings,description:p("quickSuggestions.strings","Enable quick suggestions inside strings.")},comments:{anyOf:t,default:e.comments,description:p("quickSuggestions.comments","Enable quick suggestions inside comments.")},other:{anyOf:t,default:e.other,description:p("quickSuggestions.other","Enable quick suggestions outside of strings and comments.")}},default:e,markdownDescription:p("quickSuggestions","Controls whether suggestions should automatically show up while typing. This can be controlled for typing in comments, strings, and other code. Quick suggestion can be configured to show as ghost text or with the suggest widget. Also be aware of the {0}-setting which controls if suggestions are triggered by special characters.","`#editor.suggestOnTriggerCharacters#`")}),this.defaultValue=e}validate(e){if(typeof e=="boolean"){const c=e?"on":"off";return{comments:c,strings:c,other:c}}if(!e||typeof e!="object")return this.defaultValue;const{other:t,comments:i,strings:n}=e,s=["on","inline","off"];let r,a,l;return typeof t=="boolean"?r=t?"on":"off":r=ui(t,this.defaultValue.other,s),typeof i=="boolean"?a=i?"on":"off":a=ui(i,this.defaultValue.comments,s),typeof n=="boolean"?l=n?"on":"off":l=ui(n,this.defaultValue.strings,s),{other:r,comments:a,strings:l}}}class LX extends Yt{constructor(){super(68,"lineNumbers",{renderType:1,renderFn:null},{type:"string",enum:["off","on","relative","interval"],enumDescriptions:[p("lineNumbers.off","Line numbers are not rendered."),p("lineNumbers.on","Line numbers are rendered as absolute number."),p("lineNumbers.relative","Line numbers are rendered as distance in lines to cursor position."),p("lineNumbers.interval","Line numbers are rendered every 10 lines.")],default:"on",description:p("lineNumbers","Controls the display of line numbers.")})}validate(e){let t=this.defaultValue.renderType,i=this.defaultValue.renderFn;return typeof e<"u"&&(typeof e=="function"?(t=4,i=e):e==="interval"?t=3:e==="relative"?t=2:e==="on"?t=1:t=0),{renderType:t,renderFn:i}}}function v0(o){const e=o.get(99);return e==="editable"?o.get(92):e!=="on"}class kX extends Yt{constructor(){const e=[],t={type:"number",description:p("rulers.size","Number of monospace characters at which this editor ruler will render.")};super(103,"rulers",e,{type:"array",items:{anyOf:[t,{type:["object"],properties:{column:t,color:{type:"string",description:p("rulers.color","Color of this editor ruler."),format:"color-hex"}}}]},default:e,description:p("rulers","Render vertical rulers after a certain number of monospace characters. Use multiple values for multiple rulers. No rulers are drawn if array is empty.")})}validate(e){if(Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="number")t.push({column:Rt.clampedInt(i,0,0,1e4),color:null});else if(i&&typeof i=="object"){const n=i;t.push({column:Rt.clampedInt(n.column,0,0,1e4),color:n.color})}return t.sort((i,n)=>i.column-n.column),t}return this.defaultValue}}class EX extends Yt{constructor(){super(93,"readOnlyMessage",void 0)}validate(e){return!e||typeof e!="object"?this.defaultValue:e}}function y3(o,e){if(typeof o!="string")return e;switch(o){case"hidden":return 2;case"visible":return 3;default:return 1}}let TX=class extends Yt{constructor(){const e={vertical:1,horizontal:1,arrowSize:11,useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,horizontalScrollbarSize:12,horizontalSliderSize:12,verticalScrollbarSize:14,verticalSliderSize:14,handleMouseWheel:!0,alwaysConsumeMouseWheel:!0,scrollByPage:!1,ignoreHorizontalScrollbarInContentHeight:!1};super(104,"scrollbar",e,{"editor.scrollbar.vertical":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.vertical.auto","The vertical scrollbar will be visible only when necessary."),p("scrollbar.vertical.visible","The vertical scrollbar will always be visible."),p("scrollbar.vertical.fit","The vertical scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.vertical","Controls the visibility of the vertical scrollbar.")},"editor.scrollbar.horizontal":{type:"string",enum:["auto","visible","hidden"],enumDescriptions:[p("scrollbar.horizontal.auto","The horizontal scrollbar will be visible only when necessary."),p("scrollbar.horizontal.visible","The horizontal scrollbar will always be visible."),p("scrollbar.horizontal.fit","The horizontal scrollbar will always be hidden.")],default:"auto",description:p("scrollbar.horizontal","Controls the visibility of the horizontal scrollbar.")},"editor.scrollbar.verticalScrollbarSize":{type:"number",default:e.verticalScrollbarSize,description:p("scrollbar.verticalScrollbarSize","The width of the vertical scrollbar.")},"editor.scrollbar.horizontalScrollbarSize":{type:"number",default:e.horizontalScrollbarSize,description:p("scrollbar.horizontalScrollbarSize","The height of the horizontal scrollbar.")},"editor.scrollbar.scrollByPage":{type:"boolean",default:e.scrollByPage,description:p("scrollbar.scrollByPage","Controls whether clicks scroll by page or jump to click position.")},"editor.scrollbar.ignoreHorizontalScrollbarInContentHeight":{type:"boolean",default:e.ignoreHorizontalScrollbarInContentHeight,description:p("scrollbar.ignoreHorizontalScrollbarInContentHeight","When set, the horizontal scrollbar will not increase the size of the editor's content.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e,i=Rt.clampedInt(t.horizontalScrollbarSize,this.defaultValue.horizontalScrollbarSize,0,1e3),n=Rt.clampedInt(t.verticalScrollbarSize,this.defaultValue.verticalScrollbarSize,0,1e3);return{arrowSize:Rt.clampedInt(t.arrowSize,this.defaultValue.arrowSize,0,1e3),vertical:y3(t.vertical,this.defaultValue.vertical),horizontal:y3(t.horizontal,this.defaultValue.horizontal),useShadows:be(t.useShadows,this.defaultValue.useShadows),verticalHasArrows:be(t.verticalHasArrows,this.defaultValue.verticalHasArrows),horizontalHasArrows:be(t.horizontalHasArrows,this.defaultValue.horizontalHasArrows),handleMouseWheel:be(t.handleMouseWheel,this.defaultValue.handleMouseWheel),alwaysConsumeMouseWheel:be(t.alwaysConsumeMouseWheel,this.defaultValue.alwaysConsumeMouseWheel),horizontalScrollbarSize:i,horizontalSliderSize:Rt.clampedInt(t.horizontalSliderSize,i,0,1e3),verticalScrollbarSize:n,verticalSliderSize:Rt.clampedInt(t.verticalSliderSize,n,0,1e3),scrollByPage:be(t.scrollByPage,this.defaultValue.scrollByPage),ignoreHorizontalScrollbarInContentHeight:be(t.ignoreHorizontalScrollbarInContentHeight,this.defaultValue.ignoreHorizontalScrollbarInContentHeight)}}};const vo="inUntrustedWorkspace",xs={allowedCharacters:"editor.unicodeHighlight.allowedCharacters",invisibleCharacters:"editor.unicodeHighlight.invisibleCharacters",nonBasicASCII:"editor.unicodeHighlight.nonBasicASCII",ambiguousCharacters:"editor.unicodeHighlight.ambiguousCharacters",includeComments:"editor.unicodeHighlight.includeComments",includeStrings:"editor.unicodeHighlight.includeStrings",allowedLocales:"editor.unicodeHighlight.allowedLocales"};class DX extends Yt{constructor(){const e={nonBasicASCII:vo,invisibleCharacters:!0,ambiguousCharacters:!0,includeComments:vo,includeStrings:!0,allowedCharacters:{},allowedLocales:{_os:!0,_vscode:!0}};super(126,"unicodeHighlight",e,{[xs.nonBasicASCII]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,vo],default:e.nonBasicASCII,description:p("unicodeHighlight.nonBasicASCII","Controls whether all non-basic ASCII characters are highlighted. Only characters between U+0020 and U+007E, tab, line-feed and carriage-return are considered basic ASCII.")},[xs.invisibleCharacters]:{restricted:!0,type:"boolean",default:e.invisibleCharacters,description:p("unicodeHighlight.invisibleCharacters","Controls whether characters that just reserve space or have no width at all are highlighted.")},[xs.ambiguousCharacters]:{restricted:!0,type:"boolean",default:e.ambiguousCharacters,description:p("unicodeHighlight.ambiguousCharacters","Controls whether characters are highlighted that can be confused with basic ASCII characters, except those that are common in the current user locale.")},[xs.includeComments]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,vo],default:e.includeComments,description:p("unicodeHighlight.includeComments","Controls whether characters in comments should also be subject to Unicode highlighting.")},[xs.includeStrings]:{restricted:!0,type:["boolean","string"],enum:[!0,!1,vo],default:e.includeStrings,description:p("unicodeHighlight.includeStrings","Controls whether characters in strings should also be subject to Unicode highlighting.")},[xs.allowedCharacters]:{restricted:!0,type:"object",default:e.allowedCharacters,description:p("unicodeHighlight.allowedCharacters","Defines allowed characters that are not being highlighted."),additionalProperties:{type:"boolean"}},[xs.allowedLocales]:{restricted:!0,type:"object",additionalProperties:{type:"boolean"},default:e.allowedLocales,description:p("unicodeHighlight.allowedLocales","Unicode characters that are common in allowed locales are not being highlighted.")}})}applyUpdate(e,t){let i=!1;t.allowedCharacters&&e&&(eo(e.allowedCharacters,t.allowedCharacters)||(e={...e,allowedCharacters:t.allowedCharacters},i=!0)),t.allowedLocales&&e&&(eo(e.allowedLocales,t.allowedLocales)||(e={...e,allowedLocales:t.allowedLocales},i=!0));const n=super.applyUpdate(e,t);return i?new Pv(n.newValue,!0):n}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{nonBasicASCII:Im(t.nonBasicASCII,vo,[!0,!1,vo]),invisibleCharacters:be(t.invisibleCharacters,this.defaultValue.invisibleCharacters),ambiguousCharacters:be(t.ambiguousCharacters,this.defaultValue.ambiguousCharacters),includeComments:Im(t.includeComments,vo,[!0,!1,vo]),includeStrings:Im(t.includeStrings,vo,[!0,!1,vo]),allowedCharacters:this.validateBooleanMap(e.allowedCharacters,this.defaultValue.allowedCharacters),allowedLocales:this.validateBooleanMap(e.allowedLocales,this.defaultValue.allowedLocales)}}validateBooleanMap(e,t){if(typeof e!="object"||!e)return t;const i={};for(const[n,s]of Object.entries(e))s===!0&&(i[n]=!0);return i}}class IX extends Yt{constructor(){const e={enabled:!0,mode:"subwordSmart",showToolbar:"onHover",suppressSuggestions:!1,keepOnBlur:!1,fontFamily:"default"};super(62,"inlineSuggest",e,{"editor.inlineSuggest.enabled":{type:"boolean",default:e.enabled,description:p("inlineSuggest.enabled","Controls whether to automatically show inline suggestions in the editor.")},"editor.inlineSuggest.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineSuggest.showToolbar.always","Show the inline suggestion toolbar whenever an inline suggestion is shown."),p("inlineSuggest.showToolbar.onHover","Show the inline suggestion toolbar when hovering over an inline suggestion."),p("inlineSuggest.showToolbar.never","Never show the inline suggestion toolbar.")],description:p("inlineSuggest.showToolbar","Controls when to show the inline suggestion toolbar.")},"editor.inlineSuggest.suppressSuggestions":{type:"boolean",default:e.suppressSuggestions,description:p("inlineSuggest.suppressSuggestions","Controls how inline suggestions interact with the suggest widget. If enabled, the suggest widget is not shown automatically when inline suggestions are available.")},"editor.inlineSuggest.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineSuggest.fontFamily","Controls the font family of the inline suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),mode:ui(t.mode,this.defaultValue.mode,["prefix","subword","subwordSmart"]),showToolbar:ui(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),suppressSuggestions:be(t.suppressSuggestions,this.defaultValue.suppressSuggestions),keepOnBlur:be(t.keepOnBlur,this.defaultValue.keepOnBlur),fontFamily:jn.string(t.fontFamily,this.defaultValue.fontFamily)}}}class NX extends Yt{constructor(){const e={enabled:!1,showToolbar:"onHover",fontFamily:"default",keepOnBlur:!1};super(63,"experimentalInlineEdit",e,{"editor.experimentalInlineEdit.enabled":{type:"boolean",default:e.enabled,description:p("inlineEdit.enabled","Controls whether to show inline edits in the editor.")},"editor.experimentalInlineEdit.showToolbar":{type:"string",default:e.showToolbar,enum:["always","onHover","never"],enumDescriptions:[p("inlineEdit.showToolbar.always","Show the inline edit toolbar whenever an inline suggestion is shown."),p("inlineEdit.showToolbar.onHover","Show the inline edit toolbar when hovering over an inline suggestion."),p("inlineEdit.showToolbar.never","Never show the inline edit toolbar.")],description:p("inlineEdit.showToolbar","Controls when to show the inline edit toolbar.")},"editor.experimentalInlineEdit.fontFamily":{type:"string",default:e.fontFamily,description:p("inlineEdit.fontFamily","Controls the font family of the inline edit.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showToolbar:ui(t.showToolbar,this.defaultValue.showToolbar,["always","onHover","never"]),fontFamily:jn.string(t.fontFamily,this.defaultValue.fontFamily),keepOnBlur:be(t.keepOnBlur,this.defaultValue.keepOnBlur)}}}class RX extends Yt{constructor(){const e={enabled:Rn.bracketPairColorizationOptions.enabled,independentColorPoolPerBracketType:Rn.bracketPairColorizationOptions.independentColorPoolPerBracketType};super(15,"bracketPairColorization",e,{"editor.bracketPairColorization.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("bracketPairColorization.enabled","Controls whether bracket pair colorization is enabled or not. Use {0} to override the bracket highlight colors.","`#workbench.colorCustomizations#`")},"editor.bracketPairColorization.independentColorPoolPerBracketType":{type:"boolean",default:e.independentColorPoolPerBracketType,description:p("bracketPairColorization.independentColorPoolPerBracketType","Controls whether each bracket type has its own independent color pool.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),independentColorPoolPerBracketType:be(t.independentColorPoolPerBracketType,this.defaultValue.independentColorPoolPerBracketType)}}}class PX extends Yt{constructor(){const e={bracketPairs:!1,bracketPairsHorizontal:"active",highlightActiveBracketPair:!0,indentation:!0,highlightActiveIndentation:!0};super(16,"guides",e,{"editor.guides.bracketPairs":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairs.true","Enables bracket pair guides."),p("editor.guides.bracketPairs.active","Enables bracket pair guides only for the active bracket pair."),p("editor.guides.bracketPairs.false","Disables bracket pair guides.")],default:e.bracketPairs,description:p("editor.guides.bracketPairs","Controls whether bracket pair guides are enabled or not.")},"editor.guides.bracketPairsHorizontal":{type:["boolean","string"],enum:[!0,"active",!1],enumDescriptions:[p("editor.guides.bracketPairsHorizontal.true","Enables horizontal guides as addition to vertical bracket pair guides."),p("editor.guides.bracketPairsHorizontal.active","Enables horizontal guides only for the active bracket pair."),p("editor.guides.bracketPairsHorizontal.false","Disables horizontal bracket pair guides.")],default:e.bracketPairsHorizontal,description:p("editor.guides.bracketPairsHorizontal","Controls whether horizontal bracket pair guides are enabled or not.")},"editor.guides.highlightActiveBracketPair":{type:"boolean",default:e.highlightActiveBracketPair,description:p("editor.guides.highlightActiveBracketPair","Controls whether the editor should highlight the active bracket pair.")},"editor.guides.indentation":{type:"boolean",default:e.indentation,description:p("editor.guides.indentation","Controls whether the editor should render indent guides.")},"editor.guides.highlightActiveIndentation":{type:["boolean","string"],enum:[!0,"always",!1],enumDescriptions:[p("editor.guides.highlightActiveIndentation.true","Highlights the active indent guide."),p("editor.guides.highlightActiveIndentation.always","Highlights the active indent guide even if bracket guides are highlighted."),p("editor.guides.highlightActiveIndentation.false","Do not highlight the active indent guide.")],default:e.highlightActiveIndentation,description:p("editor.guides.highlightActiveIndentation","Controls whether the editor should highlight the active indent guide.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{bracketPairs:Im(t.bracketPairs,this.defaultValue.bracketPairs,[!0,!1,"active"]),bracketPairsHorizontal:Im(t.bracketPairsHorizontal,this.defaultValue.bracketPairsHorizontal,[!0,!1,"active"]),highlightActiveBracketPair:be(t.highlightActiveBracketPair,this.defaultValue.highlightActiveBracketPair),indentation:be(t.indentation,this.defaultValue.indentation),highlightActiveIndentation:Im(t.highlightActiveIndentation,this.defaultValue.highlightActiveIndentation,[!0,!1,"always"])}}}function Im(o,e,t){const i=t.indexOf(o);return i===-1?e:t[i]}class AX extends Yt{constructor(){const e={insertMode:"insert",filterGraceful:!0,snippetsPreventQuickSuggestions:!1,localityBonus:!1,shareSuggestSelections:!1,selectionMode:"always",showIcons:!0,showStatusBar:!1,preview:!1,previewMode:"subwordSmart",showInlineDetails:!0,showMethods:!0,showFunctions:!0,showConstructors:!0,showDeprecated:!0,matchOnWordStartOnly:!0,showFields:!0,showVariables:!0,showClasses:!0,showStructs:!0,showInterfaces:!0,showModules:!0,showProperties:!0,showEvents:!0,showOperators:!0,showUnits:!0,showValues:!0,showConstants:!0,showEnums:!0,showEnumMembers:!0,showKeywords:!0,showWords:!0,showColors:!0,showFiles:!0,showReferences:!0,showFolders:!0,showTypeParameters:!0,showSnippets:!0,showUsers:!0,showIssues:!0};super(119,"suggest",e,{"editor.suggest.insertMode":{type:"string",enum:["insert","replace"],enumDescriptions:[p("suggest.insertMode.insert","Insert suggestion without overwriting text right of the cursor."),p("suggest.insertMode.replace","Insert suggestion and overwrite text right of the cursor.")],default:e.insertMode,description:p("suggest.insertMode","Controls whether words are overwritten when accepting completions. Note that this depends on extensions opting into this feature.")},"editor.suggest.filterGraceful":{type:"boolean",default:e.filterGraceful,description:p("suggest.filterGraceful","Controls whether filtering and sorting suggestions accounts for small typos.")},"editor.suggest.localityBonus":{type:"boolean",default:e.localityBonus,description:p("suggest.localityBonus","Controls whether sorting favors words that appear close to the cursor.")},"editor.suggest.shareSuggestSelections":{type:"boolean",default:e.shareSuggestSelections,markdownDescription:p("suggest.shareSuggestSelections","Controls whether remembered suggestion selections are shared between multiple workspaces and windows (needs `#editor.suggestSelection#`).")},"editor.suggest.selectionMode":{type:"string",enum:["always","never","whenTriggerCharacter","whenQuickSuggestion"],enumDescriptions:[p("suggest.insertMode.always","Always select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.never","Never select a suggestion when automatically triggering IntelliSense."),p("suggest.insertMode.whenTriggerCharacter","Select a suggestion only when triggering IntelliSense from a trigger character."),p("suggest.insertMode.whenQuickSuggestion","Select a suggestion only when triggering IntelliSense as you type.")],default:e.selectionMode,markdownDescription:p("suggest.selectionMode","Controls whether a suggestion is selected when the widget shows. Note that this only applies to automatically triggered suggestions ({0} and {1}) and that a suggestion is always selected when explicitly invoked, e.g via `Ctrl+Space`.","`#editor.quickSuggestions#`","`#editor.suggestOnTriggerCharacters#`")},"editor.suggest.snippetsPreventQuickSuggestions":{type:"boolean",default:e.snippetsPreventQuickSuggestions,description:p("suggest.snippetsPreventQuickSuggestions","Controls whether an active snippet prevents quick suggestions.")},"editor.suggest.showIcons":{type:"boolean",default:e.showIcons,description:p("suggest.showIcons","Controls whether to show or hide icons in suggestions.")},"editor.suggest.showStatusBar":{type:"boolean",default:e.showStatusBar,description:p("suggest.showStatusBar","Controls the visibility of the status bar at the bottom of the suggest widget.")},"editor.suggest.preview":{type:"boolean",default:e.preview,description:p("suggest.preview","Controls whether to preview the suggestion outcome in the editor.")},"editor.suggest.showInlineDetails":{type:"boolean",default:e.showInlineDetails,description:p("suggest.showInlineDetails","Controls whether suggest details show inline with the label or only in the details widget.")},"editor.suggest.maxVisibleSuggestions":{type:"number",deprecationMessage:p("suggest.maxVisibleSuggestions.dep","This setting is deprecated. The suggest widget can now be resized.")},"editor.suggest.filteredTypes":{type:"object",deprecationMessage:p("deprecated","This setting is deprecated, please use separate settings like 'editor.suggest.showKeywords' or 'editor.suggest.showSnippets' instead.")},"editor.suggest.showMethods":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showMethods","When enabled IntelliSense shows `method`-suggestions.")},"editor.suggest.showFunctions":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFunctions","When enabled IntelliSense shows `function`-suggestions.")},"editor.suggest.showConstructors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstructors","When enabled IntelliSense shows `constructor`-suggestions.")},"editor.suggest.showDeprecated":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showDeprecated","When enabled IntelliSense shows `deprecated`-suggestions.")},"editor.suggest.matchOnWordStartOnly":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.matchOnWordStartOnly","When enabled IntelliSense filtering requires that the first character matches on a word start. For example, `c` on `Console` or `WebContext` but _not_ on `description`. When disabled IntelliSense will show more results but still sorts them by match quality.")},"editor.suggest.showFields":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFields","When enabled IntelliSense shows `field`-suggestions.")},"editor.suggest.showVariables":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showVariables","When enabled IntelliSense shows `variable`-suggestions.")},"editor.suggest.showClasses":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showClasss","When enabled IntelliSense shows `class`-suggestions.")},"editor.suggest.showStructs":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showStructs","When enabled IntelliSense shows `struct`-suggestions.")},"editor.suggest.showInterfaces":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showInterfaces","When enabled IntelliSense shows `interface`-suggestions.")},"editor.suggest.showModules":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showModules","When enabled IntelliSense shows `module`-suggestions.")},"editor.suggest.showProperties":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showPropertys","When enabled IntelliSense shows `property`-suggestions.")},"editor.suggest.showEvents":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEvents","When enabled IntelliSense shows `event`-suggestions.")},"editor.suggest.showOperators":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showOperators","When enabled IntelliSense shows `operator`-suggestions.")},"editor.suggest.showUnits":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUnits","When enabled IntelliSense shows `unit`-suggestions.")},"editor.suggest.showValues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showValues","When enabled IntelliSense shows `value`-suggestions.")},"editor.suggest.showConstants":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showConstants","When enabled IntelliSense shows `constant`-suggestions.")},"editor.suggest.showEnums":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnums","When enabled IntelliSense shows `enum`-suggestions.")},"editor.suggest.showEnumMembers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showEnumMembers","When enabled IntelliSense shows `enumMember`-suggestions.")},"editor.suggest.showKeywords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showKeywords","When enabled IntelliSense shows `keyword`-suggestions.")},"editor.suggest.showWords":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTexts","When enabled IntelliSense shows `text`-suggestions.")},"editor.suggest.showColors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showColors","When enabled IntelliSense shows `color`-suggestions.")},"editor.suggest.showFiles":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFiles","When enabled IntelliSense shows `file`-suggestions.")},"editor.suggest.showReferences":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showReferences","When enabled IntelliSense shows `reference`-suggestions.")},"editor.suggest.showCustomcolors":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showCustomcolors","When enabled IntelliSense shows `customcolor`-suggestions.")},"editor.suggest.showFolders":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showFolders","When enabled IntelliSense shows `folder`-suggestions.")},"editor.suggest.showTypeParameters":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showTypeParameters","When enabled IntelliSense shows `typeParameter`-suggestions.")},"editor.suggest.showSnippets":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showSnippets","When enabled IntelliSense shows `snippet`-suggestions.")},"editor.suggest.showUsers":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showUsers","When enabled IntelliSense shows `user`-suggestions.")},"editor.suggest.showIssues":{type:"boolean",default:!0,markdownDescription:p("editor.suggest.showIssues","When enabled IntelliSense shows `issues`-suggestions.")}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{insertMode:ui(t.insertMode,this.defaultValue.insertMode,["insert","replace"]),filterGraceful:be(t.filterGraceful,this.defaultValue.filterGraceful),snippetsPreventQuickSuggestions:be(t.snippetsPreventQuickSuggestions,this.defaultValue.filterGraceful),localityBonus:be(t.localityBonus,this.defaultValue.localityBonus),shareSuggestSelections:be(t.shareSuggestSelections,this.defaultValue.shareSuggestSelections),selectionMode:ui(t.selectionMode,this.defaultValue.selectionMode,["always","never","whenQuickSuggestion","whenTriggerCharacter"]),showIcons:be(t.showIcons,this.defaultValue.showIcons),showStatusBar:be(t.showStatusBar,this.defaultValue.showStatusBar),preview:be(t.preview,this.defaultValue.preview),previewMode:ui(t.previewMode,this.defaultValue.previewMode,["prefix","subword","subwordSmart"]),showInlineDetails:be(t.showInlineDetails,this.defaultValue.showInlineDetails),showMethods:be(t.showMethods,this.defaultValue.showMethods),showFunctions:be(t.showFunctions,this.defaultValue.showFunctions),showConstructors:be(t.showConstructors,this.defaultValue.showConstructors),showDeprecated:be(t.showDeprecated,this.defaultValue.showDeprecated),matchOnWordStartOnly:be(t.matchOnWordStartOnly,this.defaultValue.matchOnWordStartOnly),showFields:be(t.showFields,this.defaultValue.showFields),showVariables:be(t.showVariables,this.defaultValue.showVariables),showClasses:be(t.showClasses,this.defaultValue.showClasses),showStructs:be(t.showStructs,this.defaultValue.showStructs),showInterfaces:be(t.showInterfaces,this.defaultValue.showInterfaces),showModules:be(t.showModules,this.defaultValue.showModules),showProperties:be(t.showProperties,this.defaultValue.showProperties),showEvents:be(t.showEvents,this.defaultValue.showEvents),showOperators:be(t.showOperators,this.defaultValue.showOperators),showUnits:be(t.showUnits,this.defaultValue.showUnits),showValues:be(t.showValues,this.defaultValue.showValues),showConstants:be(t.showConstants,this.defaultValue.showConstants),showEnums:be(t.showEnums,this.defaultValue.showEnums),showEnumMembers:be(t.showEnumMembers,this.defaultValue.showEnumMembers),showKeywords:be(t.showKeywords,this.defaultValue.showKeywords),showWords:be(t.showWords,this.defaultValue.showWords),showColors:be(t.showColors,this.defaultValue.showColors),showFiles:be(t.showFiles,this.defaultValue.showFiles),showReferences:be(t.showReferences,this.defaultValue.showReferences),showFolders:be(t.showFolders,this.defaultValue.showFolders),showTypeParameters:be(t.showTypeParameters,this.defaultValue.showTypeParameters),showSnippets:be(t.showSnippets,this.defaultValue.showSnippets),showUsers:be(t.showUsers,this.defaultValue.showUsers),showIssues:be(t.showIssues,this.defaultValue.showIssues)}}}class MX extends Yt{constructor(){super(114,"smartSelect",{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},{"editor.smartSelect.selectLeadingAndTrailingWhitespace":{description:p("selectLeadingAndTrailingWhitespace","Whether leading and trailing whitespace should always be selected."),default:!0,type:"boolean"},"editor.smartSelect.selectSubwords":{description:p("selectSubwords","Whether subwords (like 'foo' in 'fooBar' or 'foo_bar') should be selected."),default:!0,type:"boolean"}})}validate(e){return!e||typeof e!="object"?this.defaultValue:{selectLeadingAndTrailingWhitespace:be(e.selectLeadingAndTrailingWhitespace,this.defaultValue.selectLeadingAndTrailingWhitespace),selectSubwords:be(e.selectSubwords,this.defaultValue.selectSubwords)}}}class OX extends Yt{constructor(){const e=[];super(131,"wordSegmenterLocales",e,{anyOf:[{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"string"},{description:p("wordSegmenterLocales","Locales to be used for word segmentation when doing word related navigations or operations. Specify the BCP 47 language tag of the word you wish to recognize (e.g., ja, zh-CN, zh-Hant-TW, etc.)."),type:"array",items:{type:"string"}}]})}validate(e){if(typeof e=="string"&&(e=[e]),Array.isArray(e)){const t=[];for(const i of e)if(typeof i=="string")try{Intl.Segmenter.supportedLocalesOf(i).length>0&&t.push(i)}catch{}return t}return this.defaultValue}}class FX extends Yt{constructor(){super(139,"wrappingIndent",1,{"editor.wrappingIndent":{type:"string",enum:["none","same","indent","deepIndent"],enumDescriptions:[p("wrappingIndent.none","No indentation. Wrapped lines begin at column 1."),p("wrappingIndent.same","Wrapped lines get the same indentation as the parent."),p("wrappingIndent.indent","Wrapped lines get +1 indentation toward the parent."),p("wrappingIndent.deepIndent","Wrapped lines get +2 indentation toward the parent.")],description:p("wrappingIndent","Controls the indentation of wrapped lines."),default:"same"}})}validate(e){switch(e){case"none":return 0;case"same":return 1;case"indent":return 2;case"deepIndent":return 3}return 1}compute(e,t,i){return t.get(2)===2?0:i}}class BX extends vw{constructor(){super(147)}compute(e,t,i){const n=t.get(146);return{isDominatedByLongLines:e.isDominatedByLongLines,isWordWrapMinified:n.isWordWrapMinified,isViewportWrapping:n.isViewportWrapping,wrappingColumn:n.wrappingColumn}}}class WX extends Yt{constructor(){const e={enabled:!0,showDropSelector:"afterDrop"};super(36,"dropIntoEditor",e,{"editor.dropIntoEditor.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("dropIntoEditor.enabled","Controls whether you can drag and drop a file into a text editor by holding down the `Shift` key (instead of opening the file in an editor).")},"editor.dropIntoEditor.showDropSelector":{type:"string",markdownDescription:p("dropIntoEditor.showDropSelector","Controls if a widget is shown when dropping files into the editor. This widget lets you control how the file is dropped."),enum:["afterDrop","never"],enumDescriptions:[p("dropIntoEditor.showDropSelector.afterDrop","Show the drop selector widget after a file is dropped into the editor."),p("dropIntoEditor.showDropSelector.never","Never show the drop selector widget. Instead the default drop provider is always used.")],default:"afterDrop"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showDropSelector:ui(t.showDropSelector,this.defaultValue.showDropSelector,["afterDrop","never"])}}}class VX extends Yt{constructor(){const e={enabled:!0,showPasteSelector:"afterPaste"};super(85,"pasteAs",e,{"editor.pasteAs.enabled":{type:"boolean",default:e.enabled,markdownDescription:p("pasteAs.enabled","Controls whether you can paste content in different ways.")},"editor.pasteAs.showPasteSelector":{type:"string",markdownDescription:p("pasteAs.showPasteSelector","Controls if a widget is shown when pasting content in to the editor. This widget lets you control how the file is pasted."),enum:["afterPaste","never"],enumDescriptions:[p("pasteAs.showPasteSelector.afterPaste","Show the paste selector widget after content is pasted into the editor."),p("pasteAs.showPasteSelector.never","Never show the paste selector widget. Instead the default pasting behavior is always used.")],default:"afterPaste"}})}validate(e){if(!e||typeof e!="object")return this.defaultValue;const t=e;return{enabled:be(t.enabled,this.defaultValue.enabled),showPasteSelector:ui(t.showPasteSelector,this.defaultValue.showPasteSelector,["afterPaste","never"])}}}const HX="Consolas, 'Courier New', monospace",zX="Menlo, Monaco, 'Courier New', monospace",UX="'Droid Sans Mono', 'monospace', monospace",ds={fontFamily:Qe?zX:us?UX:HX,fontWeight:"normal",fontSize:Qe?12:14,lineHeight:0,letterSpacing:0},Up=[];function ne(o){return Up[o.id]=o,o}const Oa={acceptSuggestionOnCommitCharacter:ne(new dt(0,"acceptSuggestionOnCommitCharacter",!0,{markdownDescription:p("acceptSuggestionOnCommitCharacter","Controls whether suggestions should be accepted on commit characters. For example, in JavaScript, the semi-colon (`;`) can be a commit character that accepts a suggestion and types that character.")})),acceptSuggestionOnEnter:ne(new hi(1,"acceptSuggestionOnEnter","on",["on","smart","off"],{markdownEnumDescriptions:["",p("acceptSuggestionOnEnterSmart","Only accept a suggestion with `Enter` when it makes a textual change."),""],markdownDescription:p("acceptSuggestionOnEnter","Controls whether suggestions should be accepted on `Enter`, in addition to `Tab`. Helps to avoid ambiguity between inserting new lines or accepting suggestions.")})),accessibilitySupport:ne(new tX),accessibilityPageSize:ne(new Rt(3,"accessibilityPageSize",10,1,1073741824,{description:p("accessibilityPageSize","Controls the number of lines in the editor that can be read out by a screen reader at once. When we detect a screen reader we automatically set the default to be 500. Warning: this has a performance implication for numbers larger than the default."),tags:["accessibility"]})),ariaLabel:ne(new jn(4,"ariaLabel",p("editorViewAccessibleLabel","Editor content"))),ariaRequired:ne(new dt(5,"ariaRequired",!1,void 0)),screenReaderAnnounceInlineSuggestion:ne(new dt(8,"screenReaderAnnounceInlineSuggestion",!0,{description:p("screenReaderAnnounceInlineSuggestion","Control whether inline suggestions are announced by a screen reader."),tags:["accessibility"]})),autoClosingBrackets:ne(new hi(6,"autoClosingBrackets","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingBrackets.languageDefined","Use language configurations to determine when to autoclose brackets."),p("editor.autoClosingBrackets.beforeWhitespace","Autoclose brackets only when the cursor is to the left of whitespace."),""],description:p("autoClosingBrackets","Controls whether the editor should automatically close brackets after the user adds an opening bracket.")})),autoClosingComments:ne(new hi(7,"autoClosingComments","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingComments.languageDefined","Use language configurations to determine when to autoclose comments."),p("editor.autoClosingComments.beforeWhitespace","Autoclose comments only when the cursor is to the left of whitespace."),""],description:p("autoClosingComments","Controls whether the editor should automatically close comments after the user adds an opening comment.")})),autoClosingDelete:ne(new hi(9,"autoClosingDelete","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingDelete.auto","Remove adjacent closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingDelete","Controls whether the editor should remove adjacent closing quotes or brackets when deleting.")})),autoClosingOvertype:ne(new hi(10,"autoClosingOvertype","auto",["always","auto","never"],{enumDescriptions:["",p("editor.autoClosingOvertype.auto","Type over closing quotes or brackets only if they were automatically inserted."),""],description:p("autoClosingOvertype","Controls whether the editor should type over closing quotes or brackets.")})),autoClosingQuotes:ne(new hi(11,"autoClosingQuotes","languageDefined",["always","languageDefined","beforeWhitespace","never"],{enumDescriptions:["",p("editor.autoClosingQuotes.languageDefined","Use language configurations to determine when to autoclose quotes."),p("editor.autoClosingQuotes.beforeWhitespace","Autoclose quotes only when the cursor is to the left of whitespace."),""],description:p("autoClosingQuotes","Controls whether the editor should automatically close quotes after the user adds an opening quote.")})),autoIndent:ne(new fS(12,"autoIndent",4,"full",["none","keep","brackets","advanced","full"],eX,{enumDescriptions:[p("editor.autoIndent.none","The editor will not insert indentation automatically."),p("editor.autoIndent.keep","The editor will keep the current line's indentation."),p("editor.autoIndent.brackets","The editor will keep the current line's indentation and honor language defined brackets."),p("editor.autoIndent.advanced","The editor will keep the current line's indentation, honor language defined brackets and invoke special onEnterRules defined by languages."),p("editor.autoIndent.full","The editor will keep the current line's indentation, honor language defined brackets, invoke special onEnterRules defined by languages, and honor indentationRules defined by languages.")],description:p("autoIndent","Controls whether the editor should automatically adjust the indentation when users type, paste, move or indent lines.")})),automaticLayout:ne(new dt(13,"automaticLayout",!1)),autoSurround:ne(new hi(14,"autoSurround","languageDefined",["languageDefined","quotes","brackets","never"],{enumDescriptions:[p("editor.autoSurround.languageDefined","Use language configurations to determine when to automatically surround selections."),p("editor.autoSurround.quotes","Surround with quotes but not brackets."),p("editor.autoSurround.brackets","Surround with brackets but not quotes."),""],description:p("autoSurround","Controls whether the editor should automatically surround selections when typing quotes or brackets.")})),bracketPairColorization:ne(new RX),bracketPairGuides:ne(new PX),stickyTabStops:ne(new dt(117,"stickyTabStops",!1,{description:p("stickyTabStops","Emulate selection behavior of tab characters when using spaces for indentation. Selection will stick to tab stops.")})),codeLens:ne(new dt(17,"codeLens",!0,{description:p("codeLens","Controls whether the editor shows CodeLens.")})),codeLensFontFamily:ne(new jn(18,"codeLensFontFamily","",{description:p("codeLensFontFamily","Controls the font family for CodeLens.")})),codeLensFontSize:ne(new Rt(19,"codeLensFontSize",0,0,100,{type:"number",default:0,minimum:0,maximum:100,markdownDescription:p("codeLensFontSize","Controls the font size in pixels for CodeLens. When set to 0, 90% of `#editor.fontSize#` is used.")})),colorDecorators:ne(new dt(20,"colorDecorators",!0,{description:p("colorDecorators","Controls whether the editor should render the inline color decorators and color picker.")})),colorDecoratorActivatedOn:ne(new hi(149,"colorDecoratorsActivatedOn","clickAndHover",["clickAndHover","hover","click"],{enumDescriptions:[p("editor.colorDecoratorActivatedOn.clickAndHover","Make the color picker appear both on click and hover of the color decorator"),p("editor.colorDecoratorActivatedOn.hover","Make the color picker appear on hover of the color decorator"),p("editor.colorDecoratorActivatedOn.click","Make the color picker appear on click of the color decorator")],description:p("colorDecoratorActivatedOn","Controls the condition to make a color picker appear from a color decorator")})),colorDecoratorsLimit:ne(new Rt(21,"colorDecoratorsLimit",500,1,1e6,{markdownDescription:p("colorDecoratorsLimit","Controls the max number of color decorators that can be rendered in an editor at once.")})),columnSelection:ne(new dt(22,"columnSelection",!1,{description:p("columnSelection","Enable that the selection with the mouse and keys is doing column selection.")})),comments:ne(new iX),contextmenu:ne(new dt(24,"contextmenu",!0)),copyWithSyntaxHighlighting:ne(new dt(25,"copyWithSyntaxHighlighting",!0,{description:p("copyWithSyntaxHighlighting","Controls whether syntax highlighting should be copied into the clipboard.")})),cursorBlinking:ne(new fS(26,"cursorBlinking",1,"blink",["blink","smooth","phase","expand","solid"],nX,{description:p("cursorBlinking","Control the cursor animation style.")})),cursorSmoothCaretAnimation:ne(new hi(27,"cursorSmoothCaretAnimation","off",["off","explicit","on"],{enumDescriptions:[p("cursorSmoothCaretAnimation.off","Smooth caret animation is disabled."),p("cursorSmoothCaretAnimation.explicit","Smooth caret animation is enabled only when the user moves the cursor with an explicit gesture."),p("cursorSmoothCaretAnimation.on","Smooth caret animation is always enabled.")],description:p("cursorSmoothCaretAnimation","Controls whether the smooth caret animation should be enabled.")})),cursorStyle:ne(new fS(28,"cursorStyle",un.Line,"line",["line","block","underline","line-thin","block-outline","underline-thin"],sX,{description:p("cursorStyle","Controls the cursor style.")})),cursorSurroundingLines:ne(new Rt(29,"cursorSurroundingLines",0,0,1073741824,{description:p("cursorSurroundingLines","Controls the minimal number of visible leading lines (minimum 0) and trailing lines (minimum 1) surrounding the cursor. Known as 'scrollOff' or 'scrollOffset' in some other editors.")})),cursorSurroundingLinesStyle:ne(new hi(30,"cursorSurroundingLinesStyle","default",["default","all"],{enumDescriptions:[p("cursorSurroundingLinesStyle.default","`cursorSurroundingLines` is enforced only when triggered via the keyboard or API."),p("cursorSurroundingLinesStyle.all","`cursorSurroundingLines` is enforced always.")],markdownDescription:p("cursorSurroundingLinesStyle","Controls when `#editor.cursorSurroundingLines#` should be enforced.")})),cursorWidth:ne(new Rt(31,"cursorWidth",0,0,1073741824,{markdownDescription:p("cursorWidth","Controls the width of the cursor when `#editor.cursorStyle#` is set to `line`.")})),disableLayerHinting:ne(new dt(32,"disableLayerHinting",!1)),disableMonospaceOptimizations:ne(new dt(33,"disableMonospaceOptimizations",!1)),domReadOnly:ne(new dt(34,"domReadOnly",!1)),dragAndDrop:ne(new dt(35,"dragAndDrop",!0,{description:p("dragAndDrop","Controls whether the editor should allow moving selections via drag and drop.")})),emptySelectionClipboard:ne(new rX),dropIntoEditor:ne(new WX),stickyScroll:ne(new fX),experimentalWhitespaceRendering:ne(new hi(38,"experimentalWhitespaceRendering","svg",["svg","font","off"],{enumDescriptions:[p("experimentalWhitespaceRendering.svg","Use a new rendering method with svgs."),p("experimentalWhitespaceRendering.font","Use a new rendering method with font characters."),p("experimentalWhitespaceRendering.off","Use the stable rendering method.")],description:p("experimentalWhitespaceRendering","Controls whether whitespace is rendered with a new, experimental method.")})),extraEditorClassName:ne(new jn(39,"extraEditorClassName","")),fastScrollSensitivity:ne(new Io(40,"fastScrollSensitivity",5,o=>o<=0?5:o,{markdownDescription:p("fastScrollSensitivity","Scrolling speed multiplier when pressing `Alt`.")})),find:ne(new aX),fixedOverflowWidgets:ne(new dt(42,"fixedOverflowWidgets",!1)),folding:ne(new dt(43,"folding",!0,{description:p("folding","Controls whether the editor has code folding enabled.")})),foldingStrategy:ne(new hi(44,"foldingStrategy","auto",["auto","indentation"],{enumDescriptions:[p("foldingStrategy.auto","Use a language-specific folding strategy if available, else the indentation-based one."),p("foldingStrategy.indentation","Use the indentation-based folding strategy.")],description:p("foldingStrategy","Controls the strategy for computing folding ranges.")})),foldingHighlight:ne(new dt(45,"foldingHighlight",!0,{description:p("foldingHighlight","Controls whether the editor should highlight folded ranges.")})),foldingImportsByDefault:ne(new dt(46,"foldingImportsByDefault",!1,{description:p("foldingImportsByDefault","Controls whether the editor automatically collapses import ranges.")})),foldingMaximumRegions:ne(new Rt(47,"foldingMaximumRegions",5e3,10,65e3,{description:p("foldingMaximumRegions","The maximum number of foldable regions. Increasing this value may result in the editor becoming less responsive when the current source has a large number of foldable regions.")})),unfoldOnClickAfterEndOfLine:ne(new dt(48,"unfoldOnClickAfterEndOfLine",!1,{description:p("unfoldOnClickAfterEndOfLine","Controls whether clicking on the empty content after a folded line will unfold the line.")})),fontFamily:ne(new jn(49,"fontFamily",ds.fontFamily,{description:p("fontFamily","Controls the font family.")})),fontInfo:ne(new lX),fontLigatures2:ne(new kh),fontSize:ne(new cX),fontWeight:ne(new ZN),fontVariations:ne(new zC),formatOnPaste:ne(new dt(55,"formatOnPaste",!1,{description:p("formatOnPaste","Controls whether the editor should automatically format the pasted content. A formatter must be available and the formatter should be able to format a range in a document.")})),formatOnType:ne(new dt(56,"formatOnType",!1,{description:p("formatOnType","Controls whether the editor should automatically format the line after typing.")})),glyphMargin:ne(new dt(57,"glyphMargin",!0,{description:p("glyphMargin","Controls whether the editor should render the vertical glyph margin. Glyph margin is mostly used for debugging.")})),gotoLocation:ne(new dX),hideCursorInOverviewRuler:ne(new dt(59,"hideCursorInOverviewRuler",!1,{description:p("hideCursorInOverviewRuler","Controls whether the cursor should be hidden in the overview ruler.")})),hover:ne(new hX),inDiffEditor:ne(new dt(61,"inDiffEditor",!1)),letterSpacing:ne(new Io(64,"letterSpacing",ds.letterSpacing,o=>Io.clamp(o,-5,20),{description:p("letterSpacing","Controls the letter spacing in pixels.")})),lightbulb:ne(new gX),lineDecorationsWidth:ne(new mX),lineHeight:ne(new _X),lineNumbers:ne(new LX),lineNumbersMinChars:ne(new Rt(69,"lineNumbersMinChars",5,1,300)),linkedEditing:ne(new dt(70,"linkedEditing",!1,{description:p("linkedEditing","Controls whether the editor has linked editing enabled. Depending on the language, related symbols such as HTML tags, are updated while editing.")})),links:ne(new dt(71,"links",!0,{description:p("links","Controls whether the editor should detect links and make them clickable.")})),matchBrackets:ne(new hi(72,"matchBrackets","always",["always","near","never"],{description:p("matchBrackets","Highlight matching brackets.")})),minimap:ne(new bX),mouseStyle:ne(new hi(74,"mouseStyle","text",["text","default","copy"])),mouseWheelScrollSensitivity:ne(new Io(75,"mouseWheelScrollSensitivity",1,o=>o===0?1:o,{markdownDescription:p("mouseWheelScrollSensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")})),mouseWheelZoom:ne(new dt(76,"mouseWheelZoom",!1,{markdownDescription:Qe?p("mouseWheelZoom.mac","Zoom the font of the editor when using mouse wheel and holding `Cmd`."):p("mouseWheelZoom","Zoom the font of the editor when using mouse wheel and holding `Ctrl`.")})),multiCursorMergeOverlapping:ne(new dt(77,"multiCursorMergeOverlapping",!0,{description:p("multiCursorMergeOverlapping","Merge multiple cursors when they are overlapping.")})),multiCursorModifier:ne(new fS(78,"multiCursorModifier","altKey","alt",["ctrlCmd","alt"],vX,{markdownEnumDescriptions:[p("multiCursorModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),p("multiCursorModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],markdownDescription:p({key:"multiCursorModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add multiple cursors with the mouse. The Go to Definition and Open Link mouse gestures will adapt such that they do not conflict with the [multicursor modifier](https://code.visualstudio.com/docs/editor/codebasics#_multicursor-modifier).")})),multiCursorPaste:ne(new hi(79,"multiCursorPaste","spread",["spread","full"],{markdownEnumDescriptions:[p("multiCursorPaste.spread","Each cursor pastes a single line of the text."),p("multiCursorPaste.full","Each cursor pastes the full text.")],markdownDescription:p("multiCursorPaste","Controls pasting when the line count of the pasted text matches the cursor count.")})),multiCursorLimit:ne(new Rt(80,"multiCursorLimit",1e4,1,1e5,{markdownDescription:p("multiCursorLimit","Controls the max number of cursors that can be in an active editor at once.")})),occurrencesHighlight:ne(new hi(81,"occurrencesHighlight","singleFile",["off","singleFile","multiFile"],{markdownEnumDescriptions:[p("occurrencesHighlight.off","Does not highlight occurrences."),p("occurrencesHighlight.singleFile","Highlights occurrences only in the current file."),p("occurrencesHighlight.multiFile","Experimental: Highlights occurrences across all valid open files.")],markdownDescription:p("occurrencesHighlight","Controls whether occurrences should be highlighted across open files.")})),overviewRulerBorder:ne(new dt(82,"overviewRulerBorder",!0,{description:p("overviewRulerBorder","Controls whether a border should be drawn around the overview ruler.")})),overviewRulerLanes:ne(new Rt(83,"overviewRulerLanes",3,0,3)),padding:ne(new CX),pasteAs:ne(new VX),parameterHints:ne(new yX),peekWidgetDefaultFocus:ne(new hi(87,"peekWidgetDefaultFocus","tree",["tree","editor"],{enumDescriptions:[p("peekWidgetDefaultFocus.tree","Focus the tree when opening peek"),p("peekWidgetDefaultFocus.editor","Focus the editor when opening peek")],description:p("peekWidgetDefaultFocus","Controls whether to focus the inline editor or the tree in the peek widget.")})),placeholder:ne(new SX),definitionLinkOpensInPeek:ne(new dt(89,"definitionLinkOpensInPeek",!1,{description:p("definitionLinkOpensInPeek","Controls whether the Go to Definition mouse gesture always opens the peek widget.")})),quickSuggestions:ne(new xX),quickSuggestionsDelay:ne(new Rt(91,"quickSuggestionsDelay",10,0,1073741824,{description:p("quickSuggestionsDelay","Controls the delay in milliseconds after which quick suggestions will show up.")})),readOnly:ne(new dt(92,"readOnly",!1)),readOnlyMessage:ne(new EX),renameOnType:ne(new dt(94,"renameOnType",!1,{description:p("renameOnType","Controls whether the editor auto renames on type."),markdownDeprecationMessage:p("renameOnTypeDeprecate","Deprecated, use `editor.linkedEditing` instead.")})),renderControlCharacters:ne(new dt(95,"renderControlCharacters",!0,{description:p("renderControlCharacters","Controls whether the editor should render control characters."),restricted:!0})),renderFinalNewline:ne(new hi(96,"renderFinalNewline",us?"dimmed":"on",["off","on","dimmed"],{description:p("renderFinalNewline","Render last line number when the file ends with a newline.")})),renderLineHighlight:ne(new hi(97,"renderLineHighlight","line",["none","gutter","line","all"],{enumDescriptions:["","","",p("renderLineHighlight.all","Highlights both the gutter and the current line.")],description:p("renderLineHighlight","Controls how the editor should render the current line highlight.")})),renderLineHighlightOnlyWhenFocus:ne(new dt(98,"renderLineHighlightOnlyWhenFocus",!1,{description:p("renderLineHighlightOnlyWhenFocus","Controls if the editor should render the current line highlight only when the editor is focused.")})),renderValidationDecorations:ne(new hi(99,"renderValidationDecorations","editable",["editable","on","off"])),renderWhitespace:ne(new hi(100,"renderWhitespace","selection",["none","boundary","selection","trailing","all"],{enumDescriptions:["",p("renderWhitespace.boundary","Render whitespace characters except for single spaces between words."),p("renderWhitespace.selection","Render whitespace characters only on selected text."),p("renderWhitespace.trailing","Render only trailing whitespace characters."),""],description:p("renderWhitespace","Controls how the editor should render whitespace characters.")})),revealHorizontalRightPadding:ne(new Rt(101,"revealHorizontalRightPadding",15,0,1e3)),roundedSelection:ne(new dt(102,"roundedSelection",!0,{description:p("roundedSelection","Controls whether selections should have rounded corners.")})),rulers:ne(new kX),scrollbar:ne(new TX),scrollBeyondLastColumn:ne(new Rt(105,"scrollBeyondLastColumn",4,0,1073741824,{description:p("scrollBeyondLastColumn","Controls the number of extra characters beyond which the editor will scroll horizontally.")})),scrollBeyondLastLine:ne(new dt(106,"scrollBeyondLastLine",!0,{description:p("scrollBeyondLastLine","Controls whether the editor will scroll beyond the last line.")})),scrollPredominantAxis:ne(new dt(107,"scrollPredominantAxis",!0,{description:p("scrollPredominantAxis","Scroll only along the predominant axis when scrolling both vertically and horizontally at the same time. Prevents horizontal drift when scrolling vertically on a trackpad.")})),selectionClipboard:ne(new dt(108,"selectionClipboard",!0,{description:p("selectionClipboard","Controls whether the Linux primary clipboard should be supported."),included:us})),selectionHighlight:ne(new dt(109,"selectionHighlight",!0,{description:p("selectionHighlight","Controls whether the editor should highlight matches similar to the selection.")})),selectOnLineNumbers:ne(new dt(110,"selectOnLineNumbers",!0)),showFoldingControls:ne(new hi(111,"showFoldingControls","mouseover",["always","never","mouseover"],{enumDescriptions:[p("showFoldingControls.always","Always show the folding controls."),p("showFoldingControls.never","Never show the folding controls and reduce the gutter size."),p("showFoldingControls.mouseover","Only show the folding controls when the mouse is over the gutter.")],description:p("showFoldingControls","Controls when the folding controls on the gutter are shown.")})),showUnused:ne(new dt(112,"showUnused",!0,{description:p("showUnused","Controls fading out of unused code.")})),showDeprecated:ne(new dt(141,"showDeprecated",!0,{description:p("showDeprecated","Controls strikethrough deprecated variables.")})),inlayHints:ne(new pX),snippetSuggestions:ne(new hi(113,"snippetSuggestions","inline",["top","bottom","inline","none"],{enumDescriptions:[p("snippetSuggestions.top","Show snippet suggestions on top of other suggestions."),p("snippetSuggestions.bottom","Show snippet suggestions below other suggestions."),p("snippetSuggestions.inline","Show snippets suggestions with other suggestions."),p("snippetSuggestions.none","Do not show snippet suggestions.")],description:p("snippetSuggestions","Controls whether snippets are shown with other suggestions and how they are sorted.")})),smartSelect:ne(new MX),smoothScrolling:ne(new dt(115,"smoothScrolling",!1,{description:p("smoothScrolling","Controls whether the editor will scroll using an animation.")})),stopRenderingLineAfter:ne(new Rt(118,"stopRenderingLineAfter",1e4,-1,1073741824)),suggest:ne(new AX),inlineSuggest:ne(new IX),inlineEdit:ne(new NX),inlineCompletionsAccessibilityVerbose:ne(new dt(150,"inlineCompletionsAccessibilityVerbose",!1,{description:p("inlineCompletionsAccessibilityVerbose","Controls whether the accessibility hint should be provided to screen reader users when an inline completion is shown.")})),suggestFontSize:ne(new Rt(120,"suggestFontSize",0,0,1e3,{markdownDescription:p("suggestFontSize","Font size for the suggest widget. When set to {0}, the value of {1} is used.","`0`","`#editor.fontSize#`")})),suggestLineHeight:ne(new Rt(121,"suggestLineHeight",0,0,1e3,{markdownDescription:p("suggestLineHeight","Line height for the suggest widget. When set to {0}, the value of {1} is used. The minimum value is 8.","`0`","`#editor.lineHeight#`")})),suggestOnTriggerCharacters:ne(new dt(122,"suggestOnTriggerCharacters",!0,{description:p("suggestOnTriggerCharacters","Controls whether suggestions should automatically show up when typing trigger characters.")})),suggestSelection:ne(new hi(123,"suggestSelection","first",["first","recentlyUsed","recentlyUsedByPrefix"],{markdownEnumDescriptions:[p("suggestSelection.first","Always select the first suggestion."),p("suggestSelection.recentlyUsed","Select recent suggestions unless further typing selects one, e.g. `console.| -> console.log` because `log` has been completed recently."),p("suggestSelection.recentlyUsedByPrefix","Select suggestions based on previous prefixes that have completed those suggestions, e.g. `co -> console` and `con -> const`.")],description:p("suggestSelection","Controls how suggestions are pre-selected when showing the suggest list.")})),tabCompletion:ne(new hi(124,"tabCompletion","off",["on","off","onlySnippets"],{enumDescriptions:[p("tabCompletion.on","Tab complete will insert the best matching suggestion when pressing tab."),p("tabCompletion.off","Disable tab completions."),p("tabCompletion.onlySnippets","Tab complete snippets when their prefix match. Works best when 'quickSuggestions' aren't enabled.")],description:p("tabCompletion","Enables tab completions.")})),tabIndex:ne(new Rt(125,"tabIndex",0,-1,1073741824)),unicodeHighlight:ne(new DX),unusualLineTerminators:ne(new hi(127,"unusualLineTerminators","prompt",["auto","off","prompt"],{enumDescriptions:[p("unusualLineTerminators.auto","Unusual line terminators are automatically removed."),p("unusualLineTerminators.off","Unusual line terminators are ignored."),p("unusualLineTerminators.prompt","Unusual line terminators prompt to be removed.")],description:p("unusualLineTerminators","Remove unusual line terminators that might cause problems.")})),useShadowDOM:ne(new dt(128,"useShadowDOM",!0)),useTabStops:ne(new dt(129,"useTabStops",!0,{description:p("useTabStops","Spaces and tabs are inserted and deleted in alignment with tab stops.")})),wordBreak:ne(new hi(130,"wordBreak","normal",["normal","keepAll"],{markdownEnumDescriptions:[p("wordBreak.normal","Use the default line break rule."),p("wordBreak.keepAll","Word breaks should not be used for Chinese/Japanese/Korean (CJK) text. Non-CJK text behavior is the same as for normal.")],description:p("wordBreak","Controls the word break rules used for Chinese/Japanese/Korean (CJK) text.")})),wordSegmenterLocales:ne(new OX),wordSeparators:ne(new jn(132,"wordSeparators",b0,{description:p("wordSeparators","Characters that will be used as word separators when doing word related navigations or operations.")})),wordWrap:ne(new hi(133,"wordWrap","off",["off","on","wordWrapColumn","bounded"],{markdownEnumDescriptions:[p("wordWrap.off","Lines will never wrap."),p("wordWrap.on","Lines will wrap at the viewport width."),p({key:"wordWrap.wordWrapColumn",comment:["- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at `#editor.wordWrapColumn#`."),p({key:"wordWrap.bounded",comment:["- viewport means the edge of the visible window size.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Lines will wrap at the minimum of viewport and `#editor.wordWrapColumn#`.")],description:p({key:"wordWrap",comment:["- 'off', 'on', 'wordWrapColumn' and 'bounded' refer to values the setting can take and should not be localized.","- `editor.wordWrapColumn` refers to a different setting and should not be localized."]},"Controls how lines should wrap.")})),wordWrapBreakAfterCharacters:ne(new jn(134,"wordWrapBreakAfterCharacters"," 	})]?|/&.,;¢°′″‰℃、。｡､￠，．：；？！％・･ゝゞヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻ｧｨｩｪｫｬｭｮｯｰ”〉》」』】〕）］｝｣")),wordWrapBreakBeforeCharacters:ne(new jn(135,"wordWrapBreakBeforeCharacters","([{‘“〈《「『【〔（［｛｢£¥＄￡￥+＋")),wordWrapColumn:ne(new Rt(136,"wordWrapColumn",80,1,1073741824,{markdownDescription:p({key:"wordWrapColumn",comment:["- `editor.wordWrap` refers to a different setting and should not be localized.","- 'wordWrapColumn' and 'bounded' refer to values the different setting can take and should not be localized."]},"Controls the wrapping column of the editor when `#editor.wordWrap#` is `wordWrapColumn` or `bounded`.")})),wordWrapOverride1:ne(new hi(137,"wordWrapOverride1","inherit",["off","on","inherit"])),wordWrapOverride2:ne(new hi(138,"wordWrapOverride2","inherit",["off","on","inherit"])),editorClassName:ne(new oX),defaultColorDecorators:ne(new dt(148,"defaultColorDecorators",!1,{markdownDescription:p("defaultColorDecorators","Controls whether inline color decorations should be shown using the default document color provider")})),pixelRatio:ne(new wX),tabFocusMode:ne(new dt(145,"tabFocusMode",!1,{markdownDescription:p("tabFocusMode","Controls whether the editor receives tabs or defers them to the workbench for navigation.")})),layoutInfo:ne(new Dm),wrappingInfo:ne(new BX),wrappingIndent:ne(new FX),wrappingStrategy:ne(new uX)};class GX{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?g_.isErrorNoTelemetry(e)?new g_(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}emit(e){this.listeners.forEach(t=>{t(e)})}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}}const rz=new GX;function Ae(o){_r(o)||rz.onUnexpectedError(o)}function yi(o){_r(o)||rz.onUnexpectedExternalError(o)}function w3(o){if(o instanceof Error){const{name:e,message:t}=o,i=o.stacktrace||o.stack;return{$isError:!0,name:e,message:t,stack:i,noTelemetry:g_.isErrorNoTelemetry(o)}}return o}const C0="Canceled";function _r(o){return o instanceof Hr?!0:o instanceof Error&&o.name===C0&&o.message===C0}class Hr extends Error{constructor(){super(C0),this.name=this.message}}function $X(){const o=new Error(C0);return o.name=o.message,o}function ar(o){return o?new Error(`Illegal argument: ${o}`):new Error("Illegal argument")}function x4(o){return o?new Error(`Illegal state: ${o}`):new Error("Illegal state")}class KX extends Error{constructor(e){super("NotSupported"),e&&(this.message=e)}}class g_ extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof g_)return e;const t=new g_;return t.message=e.message,t.stack=e.stack,t}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}}class pt extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,pt.prototype)}}function Eh(o,e){const t=this;let i=!1,n;return function(){return i||(i=!0,n=o.apply(t,arguments)),n}}function JE(o){return typeof o=="object"&&o!==null&&typeof o.dispose=="function"&&o.dispose.length===0}function Dt(o){if(nt.is(o)){const e=[];for(const t of o)if(t)try{t.dispose()}catch(i){e.push(i)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(o)?[]:o}else if(o)return o.dispose(),o}function Wr(...o){return ve(()=>Dt(o))}function ve(o){return{dispose:Eh(()=>{o()})}}const pk=class pk{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Dt(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?pk.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}deleteAndLeak(e){e&&this._toDispose.has(e)&&this._toDispose.delete(e)}};pk.DISABLE_DISPOSED_WARNING=!1;let $=pk;const n3=class n3{constructor(){this._store=new $,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};n3.None=Object.freeze({dispose(){}});let F=n3;class Yi{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}}class jX{constructor(e){this._disposable=e,this._counter=1}acquire(){return this._counter++,this}release(){return--this._counter===0&&this._disposable.dispose(),this}}class qX{constructor(e){this.object=e}dispose(){}}class L4{constructor(){this._store=new Map,this._isDisposed=!1}dispose(){this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Dt(this._store.values())}finally{this._store.clear()}}get(e){return this._store.get(e)}set(e,t,i=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),i||this._store.get(e)?.dispose(),this._store.set(e,t)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}[Symbol.iterator](){return this._store[Symbol.iterator]()}}const ZX=globalThis.performance&&typeof globalThis.performance.now=="function";class rn{static create(e){return new rn(e)}constructor(e){this._now=ZX&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}}var se;(function(o){o.None=()=>F.None;function e(Z,V){return u(Z,()=>{},0,void 0,!0,void 0,V)}o.defer=e;function t(Z){return(V,Q=null,le)=>{let ge=!1,_e;return _e=Z(he=>{if(!ge)return _e?_e.dispose():ge=!0,V.call(Q,he)},null,le),ge&&_e.dispose(),_e}}o.once=t;function i(Z,V){return o.once(o.filter(Z,V))}o.onceIf=i;function n(Z,V,Q){return d((le,ge=null,_e)=>Z(he=>le.call(ge,V(he)),null,_e),Q)}o.map=n;function s(Z,V,Q){return d((le,ge=null,_e)=>Z(he=>{V(he),le.call(ge,he)},null,_e),Q)}o.forEach=s;function r(Z,V,Q){return d((le,ge=null,_e)=>Z(he=>V(he)&&le.call(ge,he),null,_e),Q)}o.filter=r;function a(Z){return Z}o.signal=a;function l(...Z){return(V,Q=null,le)=>{const ge=Wr(...Z.map(_e=>_e(he=>V.call(Q,he))));return h(ge,le)}}o.any=l;function c(Z,V,Q,le){let ge=Q;return n(Z,_e=>(ge=V(ge,_e),ge),le)}o.reduce=c;function d(Z,V){let Q;const le={onWillAddFirstListener(){Q=Z(ge.fire,ge)},onDidRemoveLastListener(){Q?.dispose()}},ge=new O(le);return V?.add(ge),ge.event}function h(Z,V){return V instanceof Array?V.push(Z):V&&V.add(Z),Z}function u(Z,V,Q=100,le=!1,ge=!1,_e,he){let Ne,Pe,Xt,Lt=0,di;const kt={leakWarningThreshold:_e,onWillAddFirstListener(){Ne=Z(jo=>{Lt++,Pe=V(Pe,jo),le&&!Xt&&(Di.fire(Pe),Pe=void 0),di=()=>{const Bi=Pe;Pe=void 0,Xt=void 0,(!le||Lt>1)&&Di.fire(Bi),Lt=0},typeof Q=="number"?(clearTimeout(Xt),Xt=setTimeout(di,Q)):Xt===void 0&&(Xt=0,queueMicrotask(di))})},onWillRemoveListener(){ge&&Lt>0&&di?.()},onDidRemoveLastListener(){di=void 0,Ne.dispose()}},Di=new O(kt);return he?.add(Di),Di.event}o.debounce=u;function g(Z,V=0,Q){return o.debounce(Z,(le,ge)=>le?(le.push(ge),le):[ge],V,void 0,!0,void 0,Q)}o.accumulate=g;function f(Z,V=(le,ge)=>le===ge,Q){let le=!0,ge;return r(Z,_e=>{const he=le||!V(_e,ge);return le=!1,ge=_e,he},Q)}o.latch=f;function m(Z,V,Q){return[o.filter(Z,V,Q),o.filter(Z,le=>!V(le),Q)]}o.split=m;function _(Z,V=!1,Q=[],le){let ge=Q.slice(),_e=Z(Pe=>{ge?ge.push(Pe):Ne.fire(Pe)});le&&le.add(_e);const he=()=>{ge?.forEach(Pe=>Ne.fire(Pe)),ge=null},Ne=new O({onWillAddFirstListener(){_e||(_e=Z(Pe=>Ne.fire(Pe)),le&&le.add(_e))},onDidAddFirstListener(){ge&&(V?setTimeout(he):he())},onDidRemoveLastListener(){_e&&_e.dispose(),_e=null}});return le&&le.add(Ne),Ne.event}o.buffer=_;function b(Z,V){return(le,ge,_e)=>{const he=V(new y);return Z(function(Ne){const Pe=he.evaluate(Ne);Pe!==v&&le.call(ge,Pe)},void 0,_e)}}o.chain=b;const v=Symbol("HaltChainable");class y{constructor(){this.steps=[]}map(V){return this.steps.push(V),this}forEach(V){return this.steps.push(Q=>(V(Q),Q)),this}filter(V){return this.steps.push(Q=>V(Q)?Q:v),this}reduce(V,Q){let le=Q;return this.steps.push(ge=>(le=V(le,ge),le)),this}latch(V=(Q,le)=>Q===le){let Q=!0,le;return this.steps.push(ge=>{const _e=Q||!V(ge,le);return Q=!1,le=ge,_e?ge:v}),this}evaluate(V){for(const Q of this.steps)if(V=Q(V),V===v)break;return V}}function C(Z,V,Q=le=>le){const le=(...Ne)=>he.fire(Q(...Ne)),ge=()=>Z.on(V,le),_e=()=>Z.removeListener(V,le),he=new O({onWillAddFirstListener:ge,onDidRemoveLastListener:_e});return he.event}o.fromNodeEventEmitter=C;function w(Z,V,Q=le=>le){const le=(...Ne)=>he.fire(Q(...Ne)),ge=()=>Z.addEventListener(V,le),_e=()=>Z.removeEventListener(V,le),he=new O({onWillAddFirstListener:ge,onDidRemoveLastListener:_e});return he.event}o.fromDOMEventEmitter=w;function x(Z){return new Promise(V=>t(Z)(V))}o.toPromise=x;function k(Z){const V=new O;return Z.then(Q=>{V.fire(Q)},()=>{V.fire(void 0)}).finally(()=>{V.dispose()}),V.event}o.fromPromise=k;function E(Z,V){return Z(Q=>V.fire(Q))}o.forward=E;function N(Z,V,Q){return V(Q),Z(le=>V(le))}o.runAndSubscribe=N;class z{constructor(V,Q){this._observable=V,this._counter=0,this._hasChanged=!1;const le={onWillAddFirstListener:()=>{V.addObserver(this),this._observable.reportChanges()},onDidRemoveLastListener:()=>{V.removeObserver(this)}};this.emitter=new O(le),Q&&Q.add(this.emitter)}beginUpdate(V){this._counter++}handlePossibleChange(V){}handleChange(V,Q){this._hasChanged=!0}endUpdate(V){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function B(Z,V){return new z(Z,V).emitter.event}o.fromObservable=B;function U(Z){return(V,Q,le)=>{let ge=0,_e=!1;const he={beginUpdate(){ge++},endUpdate(){ge--,ge===0&&(Z.reportChanges(),_e&&(_e=!1,V.call(Q)))},handlePossibleChange(){},handleChange(){_e=!0}};Z.addObserver(he),Z.reportChanges();const Ne={dispose(){Z.removeObserver(he)}};return le instanceof $?le.add(Ne):Array.isArray(le)&&le.push(Ne),Ne}}o.fromObservableLight=U})(se||(se={}));const fm=class fm{constructor(e){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${e}_${fm._idPool++}`,fm.all.add(this)}start(e){this._stopWatch=new rn,this.listenerCount=e}stop(){if(this._stopWatch){const e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}};fm.all=new Set,fm._idPool=0;let YN=fm,YX=-1;const mk=class mk{constructor(e,t,i=(mk._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e,this.threshold=t,this.name=i,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(e,t){const i=this.threshold;if(i<=0||t<i)return;this._stacks||(this._stacks=new Map);const n=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,n+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=i*.5;const[s,r]=this.getMostFrequentStack(),a=`[${this.name}] potential listener LEAK detected, having ${t} listeners already. MOST frequent listener (${r}):`;console.warn(a),console.warn(s);const l=new XX(a,s);this._errorHandler(l)}return()=>{const s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,t=0;for(const[i,n]of this._stacks)(!e||t<n)&&(e=[i,n],t=n);return e}};mk._idPool=1;let XN=mk;class k4{static create(){const e=new Error;return new k4(e.stack??"")}constructor(e){this.value=e}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}}class XX extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}}class QX extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}}class VD{constructor(e){this.value=e}}const JX=2;let O=class{constructor(e){this._size=0,this._options=e,this._leakageMon=this._options?.leakWarningThreshold?new XN(e?.onListenerError??Ae,this._options?.leakWarningThreshold??YX):void 0,this._perfMon=this._options?._profName?new YN(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(e,t,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){const a=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(a);const l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],c=new QX(`${a}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);return(this._options?.onListenerError||Ae)(c),F.None}if(this._disposed)return F.None;t&&(e=e.bind(t));const n=new VD(e);let s;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(n.stack=k4.create(),s=this._leakageMon.check(n.stack,this._size+1)),this._listeners?this._listeners instanceof VD?(this._deliveryQueue??=new az,this._listeners=[this._listeners,n]):this._listeners.push(n):(this._options?.onWillAddFirstListener?.(this),this._listeners=n,this._options?.onDidAddFirstListener?.(this)),this._size++;const r=ve(()=>{s?.(),this._removeListener(n)});return i instanceof $?i.add(r):Array.isArray(i)&&i.push(r),r},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}const t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;const n=this._deliveryQueue.current===this;if(this._size*JX<=t.length){let s=0;for(let r=0;r<t.length;r++)t[r]?t[s++]=t[r]:n&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=s}}_deliver(e,t){if(!e)return;const i=this._options?.onListenerError||Ae;if(!i){e.value(t);return}try{e.value(t)}catch(n){i(n)}}_deliverQueue(e){const t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof VD)this._deliver(this._listeners,e);else{const t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}};const eQ=()=>new az;class az{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}}class pf extends O{constructor(e){super(e),this._isPaused=0,this._eventQueue=new os,this._mergeFn=e?.merge}pause(){this._isPaused++}resume(){if(this._isPaused!==0&&--this._isPaused===0)if(this._mergeFn){if(this._eventQueue.size>0){const e=Array.from(this._eventQueue);this._eventQueue.clear(),super.fire(this._mergeFn(e))}}else for(;!this._isPaused&&this._eventQueue.size!==0;)super.fire(this._eventQueue.shift())}fire(e){this._size&&(this._isPaused!==0?this._eventQueue.push(e):super.fire(e))}}class lz extends pf{constructor(e){super(e),this._delay=e.delay??100}fire(e){this._handle||(this.pause(),this._handle=setTimeout(()=>{this._handle=void 0,this.resume()},this._delay)),super.fire(e)}}class tQ extends O{constructor(e){super(e),this._queuedEvents=[],this._mergeFn=e?.merge}fire(e){this.hasListeners()&&(this._queuedEvents.push(e),this._queuedEvents.length===1&&queueMicrotask(()=>{this._mergeFn?super.fire(this._mergeFn(this._queuedEvents)):this._queuedEvents.forEach(t=>super.fire(t)),this._queuedEvents=[]}))}}class iQ{constructor(){this.hasListeners=!1,this.events=[],this.emitter=new O({onWillAddFirstListener:()=>this.onFirstListenerAdd(),onDidRemoveLastListener:()=>this.onLastListenerRemove()})}get event(){return this.emitter.event}add(e){const t={event:e,listener:null};return this.events.push(t),this.hasListeners&&this.hook(t),ve(Eh(()=>{this.hasListeners&&this.unhook(t);const n=this.events.indexOf(t);this.events.splice(n,1)}))}onFirstListenerAdd(){this.hasListeners=!0,this.events.forEach(e=>this.hook(e))}onLastListenerRemove(){this.hasListeners=!1,this.events.forEach(e=>this.unhook(e))}hook(e){e.listener=e.event(t=>this.emitter.fire(t))}unhook(e){e.listener?.dispose(),e.listener=null}dispose(){this.emitter.dispose();for(const e of this.events)e.listener?.dispose();this.events=[]}}class Cw{constructor(){this.data=[]}wrapEvent(e,t,i){return(n,s,r)=>e(a=>{const l=this.data[this.data.length-1];if(!t){l?l.buffers.push(()=>n.call(s,a)):n.call(s,a);return}const c=l;if(!c){n.call(s,t(i,a));return}c.items??=[],c.items.push(a),c.buffers.length===0&&l.buffers.push(()=>{c.reducedResult??=i?c.items.reduce(t,i):c.items.reduce(t),n.call(s,c.reducedResult)})},void 0,r)}bufferEvents(e){const t={buffers:new Array};this.data.push(t);const i=e();return this.data.pop(),t.buffers.forEach(n=>n()),i}}class S3{constructor(){this.listening=!1,this.inputEvent=se.None,this.inputEventListener=F.None,this.emitter=new O({onDidAddFirstListener:()=>{this.listening=!0,this.inputEventListener=this.inputEvent(this.emitter.fire,this.emitter)},onDidRemoveLastListener:()=>{this.listening=!1,this.inputEventListener.dispose()}}),this.event=this.emitter.event}set input(e){this.inputEvent=e,this.listening&&(this.inputEventListener.dispose(),this.inputEventListener=e(this.emitter.fire,this.emitter))}dispose(){this.inputEventListener.dispose(),this.emitter.dispose()}}const cz=Object.freeze(function(o,e){const t=setTimeout(o.bind(e),0);return{dispose(){clearTimeout(t)}}});var He;(function(o){function e(t){return t===o.None||t===o.Cancelled||t instanceof T1?!0:!t||typeof t!="object"?!1:typeof t.isCancellationRequested=="boolean"&&typeof t.onCancellationRequested=="function"}o.isCancellationToken=e,o.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:se.None}),o.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:cz})})(He||(He={}));class T1{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?cz:(this._emitter||(this._emitter=new O),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}}let ri=class{constructor(e){this._token=void 0,this._parentListener=void 0,this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new T1),this._token}cancel(){this._token?this._token instanceof T1&&this._token.cancel():this._token=He.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof T1&&this._token.dispose():this._token=He.None}};function QN(o){const e=new ri;return o.add({dispose(){e.cancel()}}),e.token}class E4{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}}const D1=new E4,JN=new E4,eR=new E4,dz=new Array(230),nQ=Object.create(null),sQ=Object.create(null),T4=[];for(let o=0;o<=193;o++)T4[o]=-1;(function(){const o="",e=[[1,0,"None",0,"unknown",0,"VK_UNKNOWN",o,o],[1,1,"Hyper",0,o,0,o,o,o],[1,2,"Super",0,o,0,o,o,o],[1,3,"Fn",0,o,0,o,o,o],[1,4,"FnLock",0,o,0,o,o,o],[1,5,"Suspend",0,o,0,o,o,o],[1,6,"Resume",0,o,0,o,o,o],[1,7,"Turbo",0,o,0,o,o,o],[1,8,"Sleep",0,o,0,"VK_SLEEP",o,o],[1,9,"WakeUp",0,o,0,o,o,o],[0,10,"KeyA",31,"A",65,"VK_A",o,o],[0,11,"KeyB",32,"B",66,"VK_B",o,o],[0,12,"KeyC",33,"C",67,"VK_C",o,o],[0,13,"KeyD",34,"D",68,"VK_D",o,o],[0,14,"KeyE",35,"E",69,"VK_E",o,o],[0,15,"KeyF",36,"F",70,"VK_F",o,o],[0,16,"KeyG",37,"G",71,"VK_G",o,o],[0,17,"KeyH",38,"H",72,"VK_H",o,o],[0,18,"KeyI",39,"I",73,"VK_I",o,o],[0,19,"KeyJ",40,"J",74,"VK_J",o,o],[0,20,"KeyK",41,"K",75,"VK_K",o,o],[0,21,"KeyL",42,"L",76,"VK_L",o,o],[0,22,"KeyM",43,"M",77,"VK_M",o,o],[0,23,"KeyN",44,"N",78,"VK_N",o,o],[0,24,"KeyO",45,"O",79,"VK_O",o,o],[0,25,"KeyP",46,"P",80,"VK_P",o,o],[0,26,"KeyQ",47,"Q",81,"VK_Q",o,o],[0,27,"KeyR",48,"R",82,"VK_R",o,o],[0,28,"KeyS",49,"S",83,"VK_S",o,o],[0,29,"KeyT",50,"T",84,"VK_T",o,o],[0,30,"KeyU",51,"U",85,"VK_U",o,o],[0,31,"KeyV",52,"V",86,"VK_V",o,o],[0,32,"KeyW",53,"W",87,"VK_W",o,o],[0,33,"KeyX",54,"X",88,"VK_X",o,o],[0,34,"KeyY",55,"Y",89,"VK_Y",o,o],[0,35,"KeyZ",56,"Z",90,"VK_Z",o,o],[0,36,"Digit1",22,"1",49,"VK_1",o,o],[0,37,"Digit2",23,"2",50,"VK_2",o,o],[0,38,"Digit3",24,"3",51,"VK_3",o,o],[0,39,"Digit4",25,"4",52,"VK_4",o,o],[0,40,"Digit5",26,"5",53,"VK_5",o,o],[0,41,"Digit6",27,"6",54,"VK_6",o,o],[0,42,"Digit7",28,"7",55,"VK_7",o,o],[0,43,"Digit8",29,"8",56,"VK_8",o,o],[0,44,"Digit9",30,"9",57,"VK_9",o,o],[0,45,"Digit0",21,"0",48,"VK_0",o,o],[1,46,"Enter",3,"Enter",13,"VK_RETURN",o,o],[1,47,"Escape",9,"Escape",27,"VK_ESCAPE",o,o],[1,48,"Backspace",1,"Backspace",8,"VK_BACK",o,o],[1,49,"Tab",2,"Tab",9,"VK_TAB",o,o],[1,50,"Space",10,"Space",32,"VK_SPACE",o,o],[0,51,"Minus",88,"-",189,"VK_OEM_MINUS","-","OEM_MINUS"],[0,52,"Equal",86,"=",187,"VK_OEM_PLUS","=","OEM_PLUS"],[0,53,"BracketLeft",92,"[",219,"VK_OEM_4","[","OEM_4"],[0,54,"BracketRight",94,"]",221,"VK_OEM_6","]","OEM_6"],[0,55,"Backslash",93,"\\",220,"VK_OEM_5","\\","OEM_5"],[0,56,"IntlHash",0,o,0,o,o,o],[0,57,"Semicolon",85,";",186,"VK_OEM_1",";","OEM_1"],[0,58,"Quote",95,"'",222,"VK_OEM_7","'","OEM_7"],[0,59,"Backquote",91,"`",192,"VK_OEM_3","`","OEM_3"],[0,60,"Comma",87,",",188,"VK_OEM_COMMA",",","OEM_COMMA"],[0,61,"Period",89,".",190,"VK_OEM_PERIOD",".","OEM_PERIOD"],[0,62,"Slash",90,"/",191,"VK_OEM_2","/","OEM_2"],[1,63,"CapsLock",8,"CapsLock",20,"VK_CAPITAL",o,o],[1,64,"F1",59,"F1",112,"VK_F1",o,o],[1,65,"F2",60,"F2",113,"VK_F2",o,o],[1,66,"F3",61,"F3",114,"VK_F3",o,o],[1,67,"F4",62,"F4",115,"VK_F4",o,o],[1,68,"F5",63,"F5",116,"VK_F5",o,o],[1,69,"F6",64,"F6",117,"VK_F6",o,o],[1,70,"F7",65,"F7",118,"VK_F7",o,o],[1,71,"F8",66,"F8",119,"VK_F8",o,o],[1,72,"F9",67,"F9",120,"VK_F9",o,o],[1,73,"F10",68,"F10",121,"VK_F10",o,o],[1,74,"F11",69,"F11",122,"VK_F11",o,o],[1,75,"F12",70,"F12",123,"VK_F12",o,o],[1,76,"PrintScreen",0,o,0,o,o,o],[1,77,"ScrollLock",84,"ScrollLock",145,"VK_SCROLL",o,o],[1,78,"Pause",7,"PauseBreak",19,"VK_PAUSE",o,o],[1,79,"Insert",19,"Insert",45,"VK_INSERT",o,o],[1,80,"Home",14,"Home",36,"VK_HOME",o,o],[1,81,"PageUp",11,"PageUp",33,"VK_PRIOR",o,o],[1,82,"Delete",20,"Delete",46,"VK_DELETE",o,o],[1,83,"End",13,"End",35,"VK_END",o,o],[1,84,"PageDown",12,"PageDown",34,"VK_NEXT",o,o],[1,85,"ArrowRight",17,"RightArrow",39,"VK_RIGHT","Right",o],[1,86,"ArrowLeft",15,"LeftArrow",37,"VK_LEFT","Left",o],[1,87,"ArrowDown",18,"DownArrow",40,"VK_DOWN","Down",o],[1,88,"ArrowUp",16,"UpArrow",38,"VK_UP","Up",o],[1,89,"NumLock",83,"NumLock",144,"VK_NUMLOCK",o,o],[1,90,"NumpadDivide",113,"NumPad_Divide",111,"VK_DIVIDE",o,o],[1,91,"NumpadMultiply",108,"NumPad_Multiply",106,"VK_MULTIPLY",o,o],[1,92,"NumpadSubtract",111,"NumPad_Subtract",109,"VK_SUBTRACT",o,o],[1,93,"NumpadAdd",109,"NumPad_Add",107,"VK_ADD",o,o],[1,94,"NumpadEnter",3,o,0,o,o,o],[1,95,"Numpad1",99,"NumPad1",97,"VK_NUMPAD1",o,o],[1,96,"Numpad2",100,"NumPad2",98,"VK_NUMPAD2",o,o],[1,97,"Numpad3",101,"NumPad3",99,"VK_NUMPAD3",o,o],[1,98,"Numpad4",102,"NumPad4",100,"VK_NUMPAD4",o,o],[1,99,"Numpad5",103,"NumPad5",101,"VK_NUMPAD5",o,o],[1,100,"Numpad6",104,"NumPad6",102,"VK_NUMPAD6",o,o],[1,101,"Numpad7",105,"NumPad7",103,"VK_NUMPAD7",o,o],[1,102,"Numpad8",106,"NumPad8",104,"VK_NUMPAD8",o,o],[1,103,"Numpad9",107,"NumPad9",105,"VK_NUMPAD9",o,o],[1,104,"Numpad0",98,"NumPad0",96,"VK_NUMPAD0",o,o],[1,105,"NumpadDecimal",112,"NumPad_Decimal",110,"VK_DECIMAL",o,o],[0,106,"IntlBackslash",97,"OEM_102",226,"VK_OEM_102",o,o],[1,107,"ContextMenu",58,"ContextMenu",93,o,o,o],[1,108,"Power",0,o,0,o,o,o],[1,109,"NumpadEqual",0,o,0,o,o,o],[1,110,"F13",71,"F13",124,"VK_F13",o,o],[1,111,"F14",72,"F14",125,"VK_F14",o,o],[1,112,"F15",73,"F15",126,"VK_F15",o,o],[1,113,"F16",74,"F16",127,"VK_F16",o,o],[1,114,"F17",75,"F17",128,"VK_F17",o,o],[1,115,"F18",76,"F18",129,"VK_F18",o,o],[1,116,"F19",77,"F19",130,"VK_F19",o,o],[1,117,"F20",78,"F20",131,"VK_F20",o,o],[1,118,"F21",79,"F21",132,"VK_F21",o,o],[1,119,"F22",80,"F22",133,"VK_F22",o,o],[1,120,"F23",81,"F23",134,"VK_F23",o,o],[1,121,"F24",82,"F24",135,"VK_F24",o,o],[1,122,"Open",0,o,0,o,o,o],[1,123,"Help",0,o,0,o,o,o],[1,124,"Select",0,o,0,o,o,o],[1,125,"Again",0,o,0,o,o,o],[1,126,"Undo",0,o,0,o,o,o],[1,127,"Cut",0,o,0,o,o,o],[1,128,"Copy",0,o,0,o,o,o],[1,129,"Paste",0,o,0,o,o,o],[1,130,"Find",0,o,0,o,o,o],[1,131,"AudioVolumeMute",117,"AudioVolumeMute",173,"VK_VOLUME_MUTE",o,o],[1,132,"AudioVolumeUp",118,"AudioVolumeUp",175,"VK_VOLUME_UP",o,o],[1,133,"AudioVolumeDown",119,"AudioVolumeDown",174,"VK_VOLUME_DOWN",o,o],[1,134,"NumpadComma",110,"NumPad_Separator",108,"VK_SEPARATOR",o,o],[0,135,"IntlRo",115,"ABNT_C1",193,"VK_ABNT_C1",o,o],[1,136,"KanaMode",0,o,0,o,o,o],[0,137,"IntlYen",0,o,0,o,o,o],[1,138,"Convert",0,o,0,o,o,o],[1,139,"NonConvert",0,o,0,o,o,o],[1,140,"Lang1",0,o,0,o,o,o],[1,141,"Lang2",0,o,0,o,o,o],[1,142,"Lang3",0,o,0,o,o,o],[1,143,"Lang4",0,o,0,o,o,o],[1,144,"Lang5",0,o,0,o,o,o],[1,145,"Abort",0,o,0,o,o,o],[1,146,"Props",0,o,0,o,o,o],[1,147,"NumpadParenLeft",0,o,0,o,o,o],[1,148,"NumpadParenRight",0,o,0,o,o,o],[1,149,"NumpadBackspace",0,o,0,o,o,o],[1,150,"NumpadMemoryStore",0,o,0,o,o,o],[1,151,"NumpadMemoryRecall",0,o,0,o,o,o],[1,152,"NumpadMemoryClear",0,o,0,o,o,o],[1,153,"NumpadMemoryAdd",0,o,0,o,o,o],[1,154,"NumpadMemorySubtract",0,o,0,o,o,o],[1,155,"NumpadClear",131,"Clear",12,"VK_CLEAR",o,o],[1,156,"NumpadClearEntry",0,o,0,o,o,o],[1,0,o,5,"Ctrl",17,"VK_CONTROL",o,o],[1,0,o,4,"Shift",16,"VK_SHIFT",o,o],[1,0,o,6,"Alt",18,"VK_MENU",o,o],[1,0,o,57,"Meta",91,"VK_COMMAND",o,o],[1,157,"ControlLeft",5,o,0,"VK_LCONTROL",o,o],[1,158,"ShiftLeft",4,o,0,"VK_LSHIFT",o,o],[1,159,"AltLeft",6,o,0,"VK_LMENU",o,o],[1,160,"MetaLeft",57,o,0,"VK_LWIN",o,o],[1,161,"ControlRight",5,o,0,"VK_RCONTROL",o,o],[1,162,"ShiftRight",4,o,0,"VK_RSHIFT",o,o],[1,163,"AltRight",6,o,0,"VK_RMENU",o,o],[1,164,"MetaRight",57,o,0,"VK_RWIN",o,o],[1,165,"BrightnessUp",0,o,0,o,o,o],[1,166,"BrightnessDown",0,o,0,o,o,o],[1,167,"MediaPlay",0,o,0,o,o,o],[1,168,"MediaRecord",0,o,0,o,o,o],[1,169,"MediaFastForward",0,o,0,o,o,o],[1,170,"MediaRewind",0,o,0,o,o,o],[1,171,"MediaTrackNext",124,"MediaTrackNext",176,"VK_MEDIA_NEXT_TRACK",o,o],[1,172,"MediaTrackPrevious",125,"MediaTrackPrevious",177,"VK_MEDIA_PREV_TRACK",o,o],[1,173,"MediaStop",126,"MediaStop",178,"VK_MEDIA_STOP",o,o],[1,174,"Eject",0,o,0,o,o,o],[1,175,"MediaPlayPause",127,"MediaPlayPause",179,"VK_MEDIA_PLAY_PAUSE",o,o],[1,176,"MediaSelect",128,"LaunchMediaPlayer",181,"VK_MEDIA_LAUNCH_MEDIA_SELECT",o,o],[1,177,"LaunchMail",129,"LaunchMail",180,"VK_MEDIA_LAUNCH_MAIL",o,o],[1,178,"LaunchApp2",130,"LaunchApp2",183,"VK_MEDIA_LAUNCH_APP2",o,o],[1,179,"LaunchApp1",0,o,0,"VK_MEDIA_LAUNCH_APP1",o,o],[1,180,"SelectTask",0,o,0,o,o,o],[1,181,"LaunchScreenSaver",0,o,0,o,o,o],[1,182,"BrowserSearch",120,"BrowserSearch",170,"VK_BROWSER_SEARCH",o,o],[1,183,"BrowserHome",121,"BrowserHome",172,"VK_BROWSER_HOME",o,o],[1,184,"BrowserBack",122,"BrowserBack",166,"VK_BROWSER_BACK",o,o],[1,185,"BrowserForward",123,"BrowserForward",167,"VK_BROWSER_FORWARD",o,o],[1,186,"BrowserStop",0,o,0,"VK_BROWSER_STOP",o,o],[1,187,"BrowserRefresh",0,o,0,"VK_BROWSER_REFRESH",o,o],[1,188,"BrowserFavorites",0,o,0,"VK_BROWSER_FAVORITES",o,o],[1,189,"ZoomToggle",0,o,0,o,o,o],[1,190,"MailReply",0,o,0,o,o,o],[1,191,"MailForward",0,o,0,o,o,o],[1,192,"MailSend",0,o,0,o,o,o],[1,0,o,114,"KeyInComposition",229,o,o,o],[1,0,o,116,"ABNT_C2",194,"VK_ABNT_C2",o,o],[1,0,o,96,"OEM_8",223,"VK_OEM_8",o,o],[1,0,o,0,o,0,"VK_KANA",o,o],[1,0,o,0,o,0,"VK_HANGUL",o,o],[1,0,o,0,o,0,"VK_JUNJA",o,o],[1,0,o,0,o,0,"VK_FINAL",o,o],[1,0,o,0,o,0,"VK_HANJA",o,o],[1,0,o,0,o,0,"VK_KANJI",o,o],[1,0,o,0,o,0,"VK_CONVERT",o,o],[1,0,o,0,o,0,"VK_NONCONVERT",o,o],[1,0,o,0,o,0,"VK_ACCEPT",o,o],[1,0,o,0,o,0,"VK_MODECHANGE",o,o],[1,0,o,0,o,0,"VK_SELECT",o,o],[1,0,o,0,o,0,"VK_PRINT",o,o],[1,0,o,0,o,0,"VK_EXECUTE",o,o],[1,0,o,0,o,0,"VK_SNAPSHOT",o,o],[1,0,o,0,o,0,"VK_HELP",o,o],[1,0,o,0,o,0,"VK_APPS",o,o],[1,0,o,0,o,0,"VK_PROCESSKEY",o,o],[1,0,o,0,o,0,"VK_PACKET",o,o],[1,0,o,0,o,0,"VK_DBE_SBCSCHAR",o,o],[1,0,o,0,o,0,"VK_DBE_DBCSCHAR",o,o],[1,0,o,0,o,0,"VK_ATTN",o,o],[1,0,o,0,o,0,"VK_CRSEL",o,o],[1,0,o,0,o,0,"VK_EXSEL",o,o],[1,0,o,0,o,0,"VK_EREOF",o,o],[1,0,o,0,o,0,"VK_PLAY",o,o],[1,0,o,0,o,0,"VK_ZOOM",o,o],[1,0,o,0,o,0,"VK_NONAME",o,o],[1,0,o,0,o,0,"VK_PA1",o,o],[1,0,o,0,o,0,"VK_OEM_CLEAR",o,o]],t=[],i=[];for(const n of e){const[s,r,a,l,c,d,h,u,g]=n;if(i[r]||(i[r]=!0,nQ[a]=r,sQ[a.toLowerCase()]=r,s&&(T4[r]=l)),!t[l]){if(t[l]=!0,!c)throw new Error(`String representation missing for key code ${l} around scan code ${a}`);D1.define(l,c),JN.define(l,u||c),eR.define(l,g||u||c)}d&&(dz[d]=l)}})();var bc;(function(o){function e(a){return D1.keyCodeToStr(a)}o.toString=e;function t(a){return D1.strToKeyCode(a)}o.fromString=t;function i(a){return JN.keyCodeToStr(a)}o.toUserSettingsUS=i;function n(a){return eR.keyCodeToStr(a)}o.toUserSettingsGeneral=n;function s(a){return JN.strToKeyCode(a)||eR.strToKeyCode(a)}o.fromUserSettings=s;function r(a){if(a>=98&&a<=113)return null;switch(a){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return D1.keyCodeToStr(a)}o.toElectronAccelerator=r})(bc||(bc={}));function Fi(o,e){const t=(e&65535)<<16>>>0;return(o|t)>>>0}var x3={};let Nm;const HD=globalThis.vscode;if(typeof HD<"u"&&typeof HD.process<"u"){const o=HD.process;Nm={get platform(){return o.platform},get arch(){return o.arch},get env(){return o.env},cwd(){return o.cwd()}}}else typeof process<"u"&&typeof process?.versions?.node=="string"?Nm={get platform(){return process.platform},get arch(){return process.arch},get env(){return x3},cwd(){return x3.VSCODE_CWD||process.cwd()}}:Nm={get platform(){return En?"win32":Qe?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};const y0=Nm.cwd,tR=Nm.env,oQ=Nm.platform,rQ=65,aQ=97,lQ=90,cQ=122,eh=46,zn=47,_o=92,fd=58,dQ=63;class hz extends Error{constructor(e,t,i){let n;typeof t=="string"&&t.indexOf("not ")===0?(n="must not be",t=t.replace(/^not /,"")):n="must be";const s=e.indexOf(".")!==-1?"property":"argument";let r=`The "${e}" ${s} ${n} of type ${t}`;r+=`. Received type ${typeof i}`,super(r),this.code="ERR_INVALID_ARG_TYPE"}}function hQ(o,e){if(o===null||typeof o!="object")throw new hz(e,"Object",o)}function en(o,e){if(typeof o!="string")throw new hz(e,"string",o)}const id=oQ==="win32";function St(o){return o===zn||o===_o}function iR(o){return o===zn}function pd(o){return o>=rQ&&o<=lQ||o>=aQ&&o<=cQ}function w0(o,e,t,i){let n="",s=0,r=-1,a=0,l=0;for(let c=0;c<=o.length;++c){if(c<o.length)l=o.charCodeAt(c);else{if(i(l))break;l=zn}if(i(l)){if(!(r===c-1||a===1))if(a===2){if(n.length<2||s!==2||n.charCodeAt(n.length-1)!==eh||n.charCodeAt(n.length-2)!==eh){if(n.length>2){const d=n.lastIndexOf(t);d===-1?(n="",s=0):(n=n.slice(0,d),s=n.length-1-n.lastIndexOf(t)),r=c,a=0;continue}else if(n.length!==0){n="",s=0,r=c,a=0;continue}}e&&(n+=n.length>0?`${t}..`:"..",s=2)}else n.length>0?n+=`${t}${o.slice(r+1,c)}`:n=o.slice(r+1,c),s=c-r-1;r=c,a=0}else l===eh&&a!==-1?++a:a=-1}return n}function uQ(o){return o?`${o[0]==="."?"":"."}${o}`:""}function uz(o,e){hQ(e,"pathObject");const t=e.dir||e.root,i=e.base||`${e.name||""}${uQ(e.ext)}`;return t?t===e.root?`${t}${i}`:`${t}${o}${i}`:i}const Ts={resolve(...o){let e="",t="",i=!1;for(let n=o.length-1;n>=-1;n--){let s;if(n>=0){if(s=o[n],en(s,`paths[${n}]`),s.length===0)continue}else e.length===0?s=y0():(s=tR[`=${e}`]||y0(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===_o)&&(s=`${e}\\`));const r=s.length;let a=0,l="",c=!1;const d=s.charCodeAt(0);if(r===1)St(d)&&(a=1,c=!0);else if(St(d))if(c=!0,St(s.charCodeAt(1))){let h=2,u=h;for(;h<r&&!St(s.charCodeAt(h));)h++;if(h<r&&h!==u){const g=s.slice(u,h);for(u=h;h<r&&St(s.charCodeAt(h));)h++;if(h<r&&h!==u){for(u=h;h<r&&!St(s.charCodeAt(h));)h++;(h===r||h!==u)&&(l=`\\\\${g}\\${s.slice(u,h)}`,a=h)}}}else a=1;else pd(d)&&s.charCodeAt(1)===fd&&(l=s.slice(0,2),a=2,r>2&&St(s.charCodeAt(2))&&(c=!0,a=3));if(l.length>0)if(e.length>0){if(l.toLowerCase()!==e.toLowerCase())continue}else e=l;if(i){if(e.length>0)break}else if(t=`${s.slice(a)}\\${t}`,i=c,c&&e.length>0)break}return t=w0(t,!i,"\\",St),i?`${e}\\${t}`:`${e}${t}`||"."},normalize(o){en(o,"path");const e=o.length;if(e===0)return".";let t=0,i,n=!1;const s=o.charCodeAt(0);if(e===1)return iR(s)?"\\":o;if(St(s))if(n=!0,St(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!St(o.charCodeAt(a));)a++;if(a<e&&a!==l){const c=o.slice(l,a);for(l=a;a<e&&St(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!St(o.charCodeAt(a));)a++;if(a===e)return`\\\\${c}\\${o.slice(l)}\\`;a!==l&&(i=`\\\\${c}\\${o.slice(l,a)}`,t=a)}}}else t=1;else pd(s)&&o.charCodeAt(1)===fd&&(i=o.slice(0,2),t=2,e>2&&St(o.charCodeAt(2))&&(n=!0,t=3));let r=t<e?w0(o.slice(t),!n,"\\",St):"";return r.length===0&&!n&&(r="."),r.length>0&&St(o.charCodeAt(e-1))&&(r+="\\"),i===void 0?n?`\\${r}`:r:n?`${i}\\${r}`:`${i}${r}`},isAbsolute(o){en(o,"path");const e=o.length;if(e===0)return!1;const t=o.charCodeAt(0);return St(t)||e>2&&pd(t)&&o.charCodeAt(1)===fd&&St(o.charCodeAt(2))},join(...o){if(o.length===0)return".";let e,t;for(let s=0;s<o.length;++s){const r=o[s];en(r,"path"),r.length>0&&(e===void 0?e=t=r:e+=`\\${r}`)}if(e===void 0)return".";let i=!0,n=0;if(typeof t=="string"&&St(t.charCodeAt(0))){++n;const s=t.length;s>1&&St(t.charCodeAt(1))&&(++n,s>2&&(St(t.charCodeAt(2))?++n:i=!1))}if(i){for(;n<e.length&&St(e.charCodeAt(n));)n++;n>=2&&(e=`\\${e.slice(n)}`)}return Ts.normalize(e)},relative(o,e){if(en(o,"from"),en(e,"to"),o===e)return"";const t=Ts.resolve(o),i=Ts.resolve(e);if(t===i||(o=t.toLowerCase(),e=i.toLowerCase(),o===e))return"";let n=0;for(;n<o.length&&o.charCodeAt(n)===_o;)n++;let s=o.length;for(;s-1>n&&o.charCodeAt(s-1)===_o;)s--;const r=s-n;let a=0;for(;a<e.length&&e.charCodeAt(a)===_o;)a++;let l=e.length;for(;l-1>a&&e.charCodeAt(l-1)===_o;)l--;const c=l-a,d=r<c?r:c;let h=-1,u=0;for(;u<d;u++){const f=o.charCodeAt(n+u);if(f!==e.charCodeAt(a+u))break;f===_o&&(h=u)}if(u!==d){if(h===-1)return i}else{if(c>d){if(e.charCodeAt(a+u)===_o)return i.slice(a+u+1);if(u===2)return i.slice(a+u)}r>d&&(o.charCodeAt(n+u)===_o?h=u:u===2&&(h=3)),h===-1&&(h=0)}let g="";for(u=n+h+1;u<=s;++u)(u===s||o.charCodeAt(u)===_o)&&(g+=g.length===0?"..":"\\..");return a+=h,g.length>0?`${g}${i.slice(a,l)}`:(i.charCodeAt(a)===_o&&++a,i.slice(a,l))},toNamespacedPath(o){if(typeof o!="string"||o.length===0)return o;const e=Ts.resolve(o);if(e.length<=2)return o;if(e.charCodeAt(0)===_o){if(e.charCodeAt(1)===_o){const t=e.charCodeAt(2);if(t!==dQ&&t!==eh)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(pd(e.charCodeAt(0))&&e.charCodeAt(1)===fd&&e.charCodeAt(2)===_o)return`\\\\?\\${e}`;return o},dirname(o){en(o,"path");const e=o.length;if(e===0)return".";let t=-1,i=0;const n=o.charCodeAt(0);if(e===1)return St(n)?o:".";if(St(n)){if(t=i=1,St(o.charCodeAt(1))){let a=2,l=a;for(;a<e&&!St(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&St(o.charCodeAt(a));)a++;if(a<e&&a!==l){for(l=a;a<e&&!St(o.charCodeAt(a));)a++;if(a===e)return o;a!==l&&(t=i=a+1)}}}}else pd(n)&&o.charCodeAt(1)===fd&&(t=e>2&&St(o.charCodeAt(2))?3:2,i=t);let s=-1,r=!0;for(let a=e-1;a>=i;--a)if(St(o.charCodeAt(a))){if(!r){s=a;break}}else r=!1;if(s===-1){if(t===-1)return".";s=t}return o.slice(0,s)},basename(o,e){e!==void 0&&en(e,"suffix"),en(o,"path");let t=0,i=-1,n=!0,s;if(o.length>=2&&pd(o.charCodeAt(0))&&o.charCodeAt(1)===fd&&(t=2),e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let r=e.length-1,a=-1;for(s=o.length-1;s>=t;--s){const l=o.charCodeAt(s);if(St(l)){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=s):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=o.length),o.slice(t,i)}for(s=o.length-1;s>=t;--s)if(St(o.charCodeAt(s))){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":o.slice(t,i)},extname(o){en(o,"path");let e=0,t=-1,i=0,n=-1,s=!0,r=0;o.length>=2&&o.charCodeAt(1)===fd&&pd(o.charCodeAt(0))&&(e=i=2);for(let a=o.length-1;a>=e;--a){const l=o.charCodeAt(a);if(St(l)){if(!s){i=a+1;break}continue}n===-1&&(s=!1,n=a+1),l===eh?t===-1?t=a:r!==1&&(r=1):t!==-1&&(r=-1)}return t===-1||n===-1||r===0||r===1&&t===n-1&&t===i+1?"":o.slice(t,n)},format:uz.bind(null,"\\"),parse(o){en(o,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;const t=o.length;let i=0,n=o.charCodeAt(0);if(t===1)return St(n)?(e.root=e.dir=o,e):(e.base=e.name=o,e);if(St(n)){if(i=1,St(o.charCodeAt(1))){let h=2,u=h;for(;h<t&&!St(o.charCodeAt(h));)h++;if(h<t&&h!==u){for(u=h;h<t&&St(o.charCodeAt(h));)h++;if(h<t&&h!==u){for(u=h;h<t&&!St(o.charCodeAt(h));)h++;h===t?i=h:h!==u&&(i=h+1)}}}}else if(pd(n)&&o.charCodeAt(1)===fd){if(t<=2)return e.root=e.dir=o,e;if(i=2,St(o.charCodeAt(2))){if(t===3)return e.root=e.dir=o,e;i=3}}i>0&&(e.root=o.slice(0,i));let s=-1,r=i,a=-1,l=!0,c=o.length-1,d=0;for(;c>=i;--c){if(n=o.charCodeAt(c),St(n)){if(!l){r=c+1;break}continue}a===-1&&(l=!1,a=c+1),n===eh?s===-1?s=c:d!==1&&(d=1):s!==-1&&(d=-1)}return a!==-1&&(s===-1||d===0||d===1&&s===a-1&&s===r+1?e.base=e.name=o.slice(r,a):(e.name=o.slice(r,s),e.base=o.slice(r,a),e.ext=o.slice(s,a))),r>0&&r!==i?e.dir=o.slice(0,r-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},gQ=(()=>{if(id){const o=/\\/g;return()=>{const e=y0().replace(o,"/");return e.slice(e.indexOf("/"))}}return()=>y0()})(),Ri={resolve(...o){let e="",t=!1;for(let i=o.length-1;i>=-1&&!t;i--){const n=i>=0?o[i]:gQ();en(n,`paths[${i}]`),n.length!==0&&(e=`${n}/${e}`,t=n.charCodeAt(0)===zn)}return e=w0(e,!t,"/",iR),t?`/${e}`:e.length>0?e:"."},normalize(o){if(en(o,"path"),o.length===0)return".";const e=o.charCodeAt(0)===zn,t=o.charCodeAt(o.length-1)===zn;return o=w0(o,!e,"/",iR),o.length===0?e?"/":t?"./":".":(t&&(o+="/"),e?`/${o}`:o)},isAbsolute(o){return en(o,"path"),o.length>0&&o.charCodeAt(0)===zn},join(...o){if(o.length===0)return".";let e;for(let t=0;t<o.length;++t){const i=o[t];en(i,"path"),i.length>0&&(e===void 0?e=i:e+=`/${i}`)}return e===void 0?".":Ri.normalize(e)},relative(o,e){if(en(o,"from"),en(e,"to"),o===e||(o=Ri.resolve(o),e=Ri.resolve(e),o===e))return"";const t=1,i=o.length,n=i-t,s=1,r=e.length-s,a=n<r?n:r;let l=-1,c=0;for(;c<a;c++){const h=o.charCodeAt(t+c);if(h!==e.charCodeAt(s+c))break;h===zn&&(l=c)}if(c===a)if(r>a){if(e.charCodeAt(s+c)===zn)return e.slice(s+c+1);if(c===0)return e.slice(s+c)}else n>a&&(o.charCodeAt(t+c)===zn?l=c:c===0&&(l=0));let d="";for(c=t+l+1;c<=i;++c)(c===i||o.charCodeAt(c)===zn)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+l)}`},toNamespacedPath(o){return o},dirname(o){if(en(o,"path"),o.length===0)return".";const e=o.charCodeAt(0)===zn;let t=-1,i=!0;for(let n=o.length-1;n>=1;--n)if(o.charCodeAt(n)===zn){if(!i){t=n;break}}else i=!1;return t===-1?e?"/":".":e&&t===1?"//":o.slice(0,t)},basename(o,e){e!==void 0&&en(e,"ext"),en(o,"path");let t=0,i=-1,n=!0,s;if(e!==void 0&&e.length>0&&e.length<=o.length){if(e===o)return"";let r=e.length-1,a=-1;for(s=o.length-1;s>=0;--s){const l=o.charCodeAt(s);if(l===zn){if(!n){t=s+1;break}}else a===-1&&(n=!1,a=s+1),r>=0&&(l===e.charCodeAt(r)?--r===-1&&(i=s):(r=-1,i=a))}return t===i?i=a:i===-1&&(i=o.length),o.slice(t,i)}for(s=o.length-1;s>=0;--s)if(o.charCodeAt(s)===zn){if(!n){t=s+1;break}}else i===-1&&(n=!1,i=s+1);return i===-1?"":o.slice(t,i)},extname(o){en(o,"path");let e=-1,t=0,i=-1,n=!0,s=0;for(let r=o.length-1;r>=0;--r){const a=o.charCodeAt(r);if(a===zn){if(!n){t=r+1;break}continue}i===-1&&(n=!1,i=r+1),a===eh?e===-1?e=r:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||i===-1||s===0||s===1&&e===i-1&&e===t+1?"":o.slice(e,i)},format:uz.bind(null,"/"),parse(o){en(o,"path");const e={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return e;const t=o.charCodeAt(0)===zn;let i;t?(e.root="/",i=1):i=0;let n=-1,s=0,r=-1,a=!0,l=o.length-1,c=0;for(;l>=i;--l){const d=o.charCodeAt(l);if(d===zn){if(!a){s=l+1;break}continue}r===-1&&(a=!1,r=l+1),d===eh?n===-1?n=l:c!==1&&(c=1):n!==-1&&(c=-1)}if(r!==-1){const d=s===0&&t?1:s;n===-1||c===0||c===1&&n===r-1&&n===s+1?e.base=e.name=o.slice(d,r):(e.name=o.slice(d,n),e.base=o.slice(d,r),e.ext=o.slice(n,r))}return s>0?e.dir=o.slice(0,s-1):t&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};Ri.win32=Ts.win32=Ts;Ri.posix=Ts.posix=Ri;const gz=id?Ts.normalize:Ri.normalize,fQ=id?Ts.join:Ri.join,pQ=id?Ts.resolve:Ri.resolve,mQ=id?Ts.relative:Ri.relative,fz=id?Ts.dirname:Ri.dirname,th=id?Ts.basename:Ri.basename,_Q=id?Ts.extname:Ri.extname,ya=id?Ts.sep:Ri.sep,bQ=/^\w[\w\d+.-]*$/,vQ=/^\//,CQ=/^\/\//;function yQ(o,e){if(!o.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${o.authority}", path: "${o.path}", query: "${o.query}", fragment: "${o.fragment}"}`);if(o.scheme&&!bQ.test(o.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(o.path){if(o.authority){if(!vQ.test(o.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(CQ.test(o.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function wQ(o,e){return!o&&!e?"file":o}function SQ(o,e){switch(o){case"https":case"http":case"file":e?e[0]!==ua&&(e=ua+e):e=ua;break}return e}const Ii="",ua="/",xQ=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/;class ye{static isUri(e){return e instanceof ye?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,t,i,n,s,r=!1){typeof e=="object"?(this.scheme=e.scheme||Ii,this.authority=e.authority||Ii,this.path=e.path||Ii,this.query=e.query||Ii,this.fragment=e.fragment||Ii):(this.scheme=wQ(e,r),this.authority=t||Ii,this.path=SQ(this.scheme,i||Ii),this.query=n||Ii,this.fragment=s||Ii,yQ(this,r))}get fsPath(){return S0(this,!1)}with(e){if(!e)return this;let{scheme:t,authority:i,path:n,query:s,fragment:r}=e;return t===void 0?t=this.scheme:t===null&&(t=Ii),i===void 0?i=this.authority:i===null&&(i=Ii),n===void 0?n=this.path:n===null&&(n=Ii),s===void 0?s=this.query:s===null&&(s=Ii),r===void 0?r=this.fragment:r===null&&(r=Ii),t===this.scheme&&i===this.authority&&n===this.path&&s===this.query&&r===this.fragment?this:new up(t,i,n,s,r)}static parse(e,t=!1){const i=xQ.exec(e);return i?new up(i[2]||Ii,pS(i[4]||Ii),pS(i[5]||Ii),pS(i[7]||Ii),pS(i[9]||Ii),t):new up(Ii,Ii,Ii,Ii,Ii)}static file(e){let t=Ii;if(En&&(e=e.replace(/\\/g,ua)),e[0]===ua&&e[1]===ua){const i=e.indexOf(ua,2);i===-1?(t=e.substring(2),e=ua):(t=e.substring(2,i),e=e.substring(i)||ua)}return new up("file",t,e,Ii,Ii)}static from(e,t){return new up(e.scheme,e.authority,e.path,e.query,e.fragment,t)}static joinPath(e,...t){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let i;return En&&e.scheme==="file"?i=ye.file(Ts.join(S0(e,!0),...t)).path:i=Ri.join(e.path,...t),e.with({path:i})}toString(e=!1){return nR(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof ye)return e;{const t=new up(e);return t._formatted=e.external??null,t._fsPath=e._sep===pz?e.fsPath??null:null,t}}else return e}}const pz=En?1:void 0;let up=class extends ye{constructor(){super(...arguments),this._formatted=null,this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=S0(this,!1)),this._fsPath}toString(e=!1){return e?nR(this,!0):(this._formatted||(this._formatted=nR(this,!1)),this._formatted)}toJSON(){const e={$mid:1};return this._fsPath&&(e.fsPath=this._fsPath,e._sep=pz),this._formatted&&(e.external=this._formatted),this.path&&(e.path=this.path),this.scheme&&(e.scheme=this.scheme),this.authority&&(e.authority=this.authority),this.query&&(e.query=this.query),this.fragment&&(e.fragment=this.fragment),e}};const mz={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function L3(o,e,t){let i,n=-1;for(let s=0;s<o.length;s++){const r=o.charCodeAt(s);if(r>=97&&r<=122||r>=65&&r<=90||r>=48&&r<=57||r===45||r===46||r===95||r===126||e&&r===47||t&&r===91||t&&r===93||t&&r===58)n!==-1&&(i+=encodeURIComponent(o.substring(n,s)),n=-1),i!==void 0&&(i+=o.charAt(s));else{i===void 0&&(i=o.substr(0,s));const a=mz[r];a!==void 0?(n!==-1&&(i+=encodeURIComponent(o.substring(n,s)),n=-1),i+=a):n===-1&&(n=s)}}return n!==-1&&(i+=encodeURIComponent(o.substring(n))),i!==void 0?i:o}function LQ(o){let e;for(let t=0;t<o.length;t++){const i=o.charCodeAt(t);i===35||i===63?(e===void 0&&(e=o.substr(0,t)),e+=mz[i]):e!==void 0&&(e+=o[t])}return e!==void 0?e:o}function S0(o,e){let t;return o.authority&&o.path.length>1&&o.scheme==="file"?t=`//${o.authority}${o.path}`:o.path.charCodeAt(0)===47&&(o.path.charCodeAt(1)>=65&&o.path.charCodeAt(1)<=90||o.path.charCodeAt(1)>=97&&o.path.charCodeAt(1)<=122)&&o.path.charCodeAt(2)===58?e?t=o.path.substr(1):t=o.path[1].toLowerCase()+o.path.substr(2):t=o.path,En&&(t=t.replace(/\//g,"\\")),t}function nR(o,e){const t=e?LQ:L3;let i="",{scheme:n,authority:s,path:r,query:a,fragment:l}=o;if(n&&(i+=n,i+=":"),(s||n==="file")&&(i+=ua,i+=ua),s){let c=s.indexOf("@");if(c!==-1){const d=s.substr(0,c);s=s.substr(c+1),c=d.lastIndexOf(":"),c===-1?i+=t(d,!1,!1):(i+=t(d.substr(0,c),!1,!1),i+=":",i+=t(d.substr(c+1),!1,!0)),i+="@"}s=s.toLowerCase(),c=s.lastIndexOf(":"),c===-1?i+=t(s,!1,!0):(i+=t(s.substr(0,c),!1,!0),i+=s.substr(c))}if(r){if(r.length>=3&&r.charCodeAt(0)===47&&r.charCodeAt(2)===58){const c=r.charCodeAt(1);c>=65&&c<=90&&(r=`/${String.fromCharCode(c+32)}:${r.substr(3)}`)}else if(r.length>=2&&r.charCodeAt(1)===58){const c=r.charCodeAt(0);c>=65&&c<=90&&(r=`${String.fromCharCode(c+32)}:${r.substr(2)}`)}i+=t(r,!0,!1)}return a&&(i+="?",i+=t(a,!1,!1)),l&&(i+="#",i+=e?l:L3(l,!1,!1)),i}function _z(o){try{return decodeURIComponent(o)}catch{return o.length>3?o.substr(0,3)+_z(o.substr(3)):o}}const k3=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function pS(o){return o.match(k3)?o.replace(k3,e=>_z(e)):o}let A=class yu{constructor(e,t){this.lineNumber=e,this.column=t}with(e=this.lineNumber,t=this.column){return e===this.lineNumber&&t===this.column?this:new yu(e,t)}delta(e=0,t=0){return this.with(this.lineNumber+e,this.column+t)}equals(e){return yu.equals(this,e)}static equals(e,t){return!e&&!t?!0:!!e&&!!t&&e.lineNumber===t.lineNumber&&e.column===t.column}isBefore(e){return yu.isBefore(this,e)}static isBefore(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<t.column}isBeforeOrEqual(e){return yu.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,t){return e.lineNumber<t.lineNumber?!0:t.lineNumber<e.lineNumber?!1:e.column<=t.column}static compare(e,t){const i=e.lineNumber|0,n=t.lineNumber|0;if(i===n){const s=e.column|0,r=t.column|0;return s-r}return i-n}clone(){return new yu(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new yu(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}},L=class cn{constructor(e,t,i,n){e>i||e===i&&t>n?(this.startLineNumber=i,this.startColumn=n,this.endLineNumber=e,this.endColumn=t):(this.startLineNumber=e,this.startColumn=t,this.endLineNumber=i,this.endColumn=n)}isEmpty(){return cn.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return cn.containsPosition(this,e)}static containsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<e.startColumn||t.lineNumber===e.endLineNumber&&t.column>e.endColumn)}static strictContainsPosition(e,t){return!(t.lineNumber<e.startLineNumber||t.lineNumber>e.endLineNumber||t.lineNumber===e.startLineNumber&&t.column<=e.startColumn||t.lineNumber===e.endLineNumber&&t.column>=e.endColumn)}containsRange(e){return cn.containsRange(this,e)}static containsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>e.endColumn)}strictContainsRange(e){return cn.strictContainsRange(this,e)}static strictContainsRange(e,t){return!(t.startLineNumber<e.startLineNumber||t.endLineNumber<e.startLineNumber||t.startLineNumber>e.endLineNumber||t.endLineNumber>e.endLineNumber||t.startLineNumber===e.startLineNumber&&t.startColumn<=e.startColumn||t.endLineNumber===e.endLineNumber&&t.endColumn>=e.endColumn)}plusRange(e){return cn.plusRange(this,e)}static plusRange(e,t){let i,n,s,r;return t.startLineNumber<e.startLineNumber?(i=t.startLineNumber,n=t.startColumn):t.startLineNumber===e.startLineNumber?(i=t.startLineNumber,n=Math.min(t.startColumn,e.startColumn)):(i=e.startLineNumber,n=e.startColumn),t.endLineNumber>e.endLineNumber?(s=t.endLineNumber,r=t.endColumn):t.endLineNumber===e.endLineNumber?(s=t.endLineNumber,r=Math.max(t.endColumn,e.endColumn)):(s=e.endLineNumber,r=e.endColumn),new cn(i,n,s,r)}intersectRanges(e){return cn.intersectRanges(this,e)}static intersectRanges(e,t){let i=e.startLineNumber,n=e.startColumn,s=e.endLineNumber,r=e.endColumn;const a=t.startLineNumber,l=t.startColumn,c=t.endLineNumber,d=t.endColumn;return i<a?(i=a,n=l):i===a&&(n=Math.max(n,l)),s>c?(s=c,r=d):s===c&&(r=Math.min(r,d)),i>s||i===s&&n>r?null:new cn(i,n,s,r)}equalsRange(e){return cn.equalsRange(this,e)}static equalsRange(e,t){return!e&&!t?!0:!!e&&!!t&&e.startLineNumber===t.startLineNumber&&e.startColumn===t.startColumn&&e.endLineNumber===t.endLineNumber&&e.endColumn===t.endColumn}getEndPosition(){return cn.getEndPosition(this)}static getEndPosition(e){return new A(e.endLineNumber,e.endColumn)}getStartPosition(){return cn.getStartPosition(this)}static getStartPosition(e){return new A(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,t){return new cn(this.startLineNumber,this.startColumn,e,t)}setStartPosition(e,t){return new cn(e,t,this.endLineNumber,this.endColumn)}collapseToStart(){return cn.collapseToStart(this)}static collapseToStart(e){return new cn(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return cn.collapseToEnd(this)}static collapseToEnd(e){return new cn(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new cn(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,t=e){return new cn(e.lineNumber,e.column,t.lineNumber,t.column)}static lift(e){return e?new cn(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<e.startColumn)}static areIntersecting(e,t){return!(e.endLineNumber<t.startLineNumber||e.endLineNumber===t.startLineNumber&&e.endColumn<=t.startColumn||t.endLineNumber<e.startLineNumber||t.endLineNumber===e.startLineNumber&&t.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,t){if(e&&t){const s=e.startLineNumber|0,r=t.startLineNumber|0;if(s===r){const a=e.startColumn|0,l=t.startColumn|0;if(a===l){const c=e.endLineNumber|0,d=t.endLineNumber|0;if(c===d){const h=e.endColumn|0,u=t.endColumn|0;return h-u}return c-d}return a-l}return s-r}return(e?1:0)-(t?1:0)}static compareRangesUsingEnds(e,t){return e.endLineNumber===t.endLineNumber?e.endColumn===t.endColumn?e.startLineNumber===t.startLineNumber?e.startColumn-t.startColumn:e.startLineNumber-t.startLineNumber:e.endColumn-t.endColumn:e.endLineNumber-t.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}},pe=class xr extends L{constructor(e,t,i,n){super(e,t,i,n),this.selectionStartLineNumber=e,this.selectionStartColumn=t,this.positionLineNumber=i,this.positionColumn=n}toString(){return"["+this.selectionStartLineNumber+","+this.selectionStartColumn+" -> "+this.positionLineNumber+","+this.positionColumn+"]"}equalsSelection(e){return xr.selectionsEqual(this,e)}static selectionsEqual(e,t){return e.selectionStartLineNumber===t.selectionStartLineNumber&&e.selectionStartColumn===t.selectionStartColumn&&e.positionLineNumber===t.positionLineNumber&&e.positionColumn===t.positionColumn}getDirection(){return this.selectionStartLineNumber===this.startLineNumber&&this.selectionStartColumn===this.startColumn?0:1}setEndPosition(e,t){return this.getDirection()===0?new xr(this.startLineNumber,this.startColumn,e,t):new xr(e,t,this.startLineNumber,this.startColumn)}getPosition(){return new A(this.positionLineNumber,this.positionColumn)}getSelectionStart(){return new A(this.selectionStartLineNumber,this.selectionStartColumn)}setStartPosition(e,t){return this.getDirection()===0?new xr(e,t,this.endLineNumber,this.endColumn):new xr(this.endLineNumber,this.endColumn,e,t)}static fromPositions(e,t=e){return new xr(e.lineNumber,e.column,t.lineNumber,t.column)}static fromRange(e,t){return t===0?new xr(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):new xr(e.endLineNumber,e.endColumn,e.startLineNumber,e.startColumn)}static liftSelection(e){return new xr(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn)}static selectionsArrEqual(e,t){if(e&&!t||!e&&t)return!1;if(!e&&!t)return!0;if(e.length!==t.length)return!1;for(let i=0,n=e.length;i<n;i++)if(!this.selectionsEqual(e[i],t[i]))return!1;return!0}static isISelection(e){return e&&typeof e.selectionStartLineNumber=="number"&&typeof e.selectionStartColumn=="number"&&typeof e.positionLineNumber=="number"&&typeof e.positionColumn=="number"}static createWithDirection(e,t,i,n,s){return s===0?new xr(e,t,i,n):new xr(i,n,e,t)}};const sR=Object.create(null);function S(o,e){if(Ds(e)){const t=sR[e];if(t===void 0)throw new Error(`${o} references an unknown codicon: ${e}`);e=t}return sR[o]=e,{id:o}}function bz(){return sR}const kQ={add:S("add",6e4),plus:S("plus",6e4),gistNew:S("gist-new",6e4),repoCreate:S("repo-create",6e4),lightbulb:S("lightbulb",60001),lightBulb:S("light-bulb",60001),repo:S("repo",60002),repoDelete:S("repo-delete",60002),gistFork:S("gist-fork",60003),repoForked:S("repo-forked",60003),gitPullRequest:S("git-pull-request",60004),gitPullRequestAbandoned:S("git-pull-request-abandoned",60004),recordKeys:S("record-keys",60005),keyboard:S("keyboard",60005),tag:S("tag",60006),gitPullRequestLabel:S("git-pull-request-label",60006),tagAdd:S("tag-add",60006),tagRemove:S("tag-remove",60006),person:S("person",60007),personFollow:S("person-follow",60007),personOutline:S("person-outline",60007),personFilled:S("person-filled",60007),gitBranch:S("git-branch",60008),gitBranchCreate:S("git-branch-create",60008),gitBranchDelete:S("git-branch-delete",60008),sourceControl:S("source-control",60008),mirror:S("mirror",60009),mirrorPublic:S("mirror-public",60009),star:S("star",60010),starAdd:S("star-add",60010),starDelete:S("star-delete",60010),starEmpty:S("star-empty",60010),comment:S("comment",60011),commentAdd:S("comment-add",60011),alert:S("alert",60012),warning:S("warning",60012),search:S("search",60013),searchSave:S("search-save",60013),logOut:S("log-out",60014),signOut:S("sign-out",60014),logIn:S("log-in",60015),signIn:S("sign-in",60015),eye:S("eye",60016),eyeUnwatch:S("eye-unwatch",60016),eyeWatch:S("eye-watch",60016),circleFilled:S("circle-filled",60017),primitiveDot:S("primitive-dot",60017),closeDirty:S("close-dirty",60017),debugBreakpoint:S("debug-breakpoint",60017),debugBreakpointDisabled:S("debug-breakpoint-disabled",60017),debugHint:S("debug-hint",60017),terminalDecorationSuccess:S("terminal-decoration-success",60017),primitiveSquare:S("primitive-square",60018),edit:S("edit",60019),pencil:S("pencil",60019),info:S("info",60020),issueOpened:S("issue-opened",60020),gistPrivate:S("gist-private",60021),gitForkPrivate:S("git-fork-private",60021),lock:S("lock",60021),mirrorPrivate:S("mirror-private",60021),close:S("close",60022),removeClose:S("remove-close",60022),x:S("x",60022),repoSync:S("repo-sync",60023),sync:S("sync",60023),clone:S("clone",60024),desktopDownload:S("desktop-download",60024),beaker:S("beaker",60025),microscope:S("microscope",60025),vm:S("vm",60026),deviceDesktop:S("device-desktop",60026),file:S("file",60027),fileText:S("file-text",60027),more:S("more",60028),ellipsis:S("ellipsis",60028),kebabHorizontal:S("kebab-horizontal",60028),mailReply:S("mail-reply",60029),reply:S("reply",60029),organization:S("organization",60030),organizationFilled:S("organization-filled",60030),organizationOutline:S("organization-outline",60030),newFile:S("new-file",60031),fileAdd:S("file-add",60031),newFolder:S("new-folder",60032),fileDirectoryCreate:S("file-directory-create",60032),trash:S("trash",60033),trashcan:S("trashcan",60033),history:S("history",60034),clock:S("clock",60034),folder:S("folder",60035),fileDirectory:S("file-directory",60035),symbolFolder:S("symbol-folder",60035),logoGithub:S("logo-github",60036),markGithub:S("mark-github",60036),github:S("github",60036),terminal:S("terminal",60037),console:S("console",60037),repl:S("repl",60037),zap:S("zap",60038),symbolEvent:S("symbol-event",60038),error:S("error",60039),stop:S("stop",60039),variable:S("variable",60040),symbolVariable:S("symbol-variable",60040),array:S("array",60042),symbolArray:S("symbol-array",60042),symbolModule:S("symbol-module",60043),symbolPackage:S("symbol-package",60043),symbolNamespace:S("symbol-namespace",60043),symbolObject:S("symbol-object",60043),symbolMethod:S("symbol-method",60044),symbolFunction:S("symbol-function",60044),symbolConstructor:S("symbol-constructor",60044),symbolBoolean:S("symbol-boolean",60047),symbolNull:S("symbol-null",60047),symbolNumeric:S("symbol-numeric",60048),symbolNumber:S("symbol-number",60048),symbolStructure:S("symbol-structure",60049),symbolStruct:S("symbol-struct",60049),symbolParameter:S("symbol-parameter",60050),symbolTypeParameter:S("symbol-type-parameter",60050),symbolKey:S("symbol-key",60051),symbolText:S("symbol-text",60051),symbolReference:S("symbol-reference",60052),goToFile:S("go-to-file",60052),symbolEnum:S("symbol-enum",60053),symbolValue:S("symbol-value",60053),symbolRuler:S("symbol-ruler",60054),symbolUnit:S("symbol-unit",60054),activateBreakpoints:S("activate-breakpoints",60055),archive:S("archive",60056),arrowBoth:S("arrow-both",60057),arrowDown:S("arrow-down",60058),arrowLeft:S("arrow-left",60059),arrowRight:S("arrow-right",60060),arrowSmallDown:S("arrow-small-down",60061),arrowSmallLeft:S("arrow-small-left",60062),arrowSmallRight:S("arrow-small-right",60063),arrowSmallUp:S("arrow-small-up",60064),arrowUp:S("arrow-up",60065),bell:S("bell",60066),bold:S("bold",60067),book:S("book",60068),bookmark:S("bookmark",60069),debugBreakpointConditionalUnverified:S("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:S("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:S("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:S("debug-breakpoint-data-unverified",60072),debugBreakpointData:S("debug-breakpoint-data",60073),debugBreakpointDataDisabled:S("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:S("debug-breakpoint-log-unverified",60074),debugBreakpointLog:S("debug-breakpoint-log",60075),debugBreakpointLogDisabled:S("debug-breakpoint-log-disabled",60075),briefcase:S("briefcase",60076),broadcast:S("broadcast",60077),browser:S("browser",60078),bug:S("bug",60079),calendar:S("calendar",60080),caseSensitive:S("case-sensitive",60081),check:S("check",60082),checklist:S("checklist",60083),chevronDown:S("chevron-down",60084),chevronLeft:S("chevron-left",60085),chevronRight:S("chevron-right",60086),chevronUp:S("chevron-up",60087),chromeClose:S("chrome-close",60088),chromeMaximize:S("chrome-maximize",60089),chromeMinimize:S("chrome-minimize",60090),chromeRestore:S("chrome-restore",60091),circleOutline:S("circle-outline",60092),circle:S("circle",60092),debugBreakpointUnverified:S("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:S("terminal-decoration-incomplete",60092),circleSlash:S("circle-slash",60093),circuitBoard:S("circuit-board",60094),clearAll:S("clear-all",60095),clippy:S("clippy",60096),closeAll:S("close-all",60097),cloudDownload:S("cloud-download",60098),cloudUpload:S("cloud-upload",60099),code:S("code",60100),collapseAll:S("collapse-all",60101),colorMode:S("color-mode",60102),commentDiscussion:S("comment-discussion",60103),creditCard:S("credit-card",60105),dash:S("dash",60108),dashboard:S("dashboard",60109),database:S("database",60110),debugContinue:S("debug-continue",60111),debugDisconnect:S("debug-disconnect",60112),debugPause:S("debug-pause",60113),debugRestart:S("debug-restart",60114),debugStart:S("debug-start",60115),debugStepInto:S("debug-step-into",60116),debugStepOut:S("debug-step-out",60117),debugStepOver:S("debug-step-over",60118),debugStop:S("debug-stop",60119),debug:S("debug",60120),deviceCameraVideo:S("device-camera-video",60121),deviceCamera:S("device-camera",60122),deviceMobile:S("device-mobile",60123),diffAdded:S("diff-added",60124),diffIgnored:S("diff-ignored",60125),diffModified:S("diff-modified",60126),diffRemoved:S("diff-removed",60127),diffRenamed:S("diff-renamed",60128),diff:S("diff",60129),diffSidebyside:S("diff-sidebyside",60129),discard:S("discard",60130),editorLayout:S("editor-layout",60131),emptyWindow:S("empty-window",60132),exclude:S("exclude",60133),extensions:S("extensions",60134),eyeClosed:S("eye-closed",60135),fileBinary:S("file-binary",60136),fileCode:S("file-code",60137),fileMedia:S("file-media",60138),filePdf:S("file-pdf",60139),fileSubmodule:S("file-submodule",60140),fileSymlinkDirectory:S("file-symlink-directory",60141),fileSymlinkFile:S("file-symlink-file",60142),fileZip:S("file-zip",60143),files:S("files",60144),filter:S("filter",60145),flame:S("flame",60146),foldDown:S("fold-down",60147),foldUp:S("fold-up",60148),fold:S("fold",60149),folderActive:S("folder-active",60150),folderOpened:S("folder-opened",60151),gear:S("gear",60152),gift:S("gift",60153),gistSecret:S("gist-secret",60154),gist:S("gist",60155),gitCommit:S("git-commit",60156),gitCompare:S("git-compare",60157),compareChanges:S("compare-changes",60157),gitMerge:S("git-merge",60158),githubAction:S("github-action",60159),githubAlt:S("github-alt",60160),globe:S("globe",60161),grabber:S("grabber",60162),graph:S("graph",60163),gripper:S("gripper",60164),heart:S("heart",60165),home:S("home",60166),horizontalRule:S("horizontal-rule",60167),hubot:S("hubot",60168),inbox:S("inbox",60169),issueReopened:S("issue-reopened",60171),issues:S("issues",60172),italic:S("italic",60173),jersey:S("jersey",60174),json:S("json",60175),kebabVertical:S("kebab-vertical",60176),key:S("key",60177),law:S("law",60178),lightbulbAutofix:S("lightbulb-autofix",60179),linkExternal:S("link-external",60180),link:S("link",60181),listOrdered:S("list-ordered",60182),listUnordered:S("list-unordered",60183),liveShare:S("live-share",60184),loading:S("loading",60185),location:S("location",60186),mailRead:S("mail-read",60187),mail:S("mail",60188),markdown:S("markdown",60189),megaphone:S("megaphone",60190),mention:S("mention",60191),milestone:S("milestone",60192),gitPullRequestMilestone:S("git-pull-request-milestone",60192),mortarBoard:S("mortar-board",60193),move:S("move",60194),multipleWindows:S("multiple-windows",60195),mute:S("mute",60196),noNewline:S("no-newline",60197),note:S("note",60198),octoface:S("octoface",60199),openPreview:S("open-preview",60200),package:S("package",60201),paintcan:S("paintcan",60202),pin:S("pin",60203),play:S("play",60204),run:S("run",60204),plug:S("plug",60205),preserveCase:S("preserve-case",60206),preview:S("preview",60207),project:S("project",60208),pulse:S("pulse",60209),question:S("question",60210),quote:S("quote",60211),radioTower:S("radio-tower",60212),reactions:S("reactions",60213),references:S("references",60214),refresh:S("refresh",60215),regex:S("regex",60216),remoteExplorer:S("remote-explorer",60217),remote:S("remote",60218),remove:S("remove",60219),replaceAll:S("replace-all",60220),replace:S("replace",60221),repoClone:S("repo-clone",60222),repoForcePush:S("repo-force-push",60223),repoPull:S("repo-pull",60224),repoPush:S("repo-push",60225),report:S("report",60226),requestChanges:S("request-changes",60227),rocket:S("rocket",60228),rootFolderOpened:S("root-folder-opened",60229),rootFolder:S("root-folder",60230),rss:S("rss",60231),ruby:S("ruby",60232),saveAll:S("save-all",60233),saveAs:S("save-as",60234),save:S("save",60235),screenFull:S("screen-full",60236),screenNormal:S("screen-normal",60237),searchStop:S("search-stop",60238),server:S("server",60240),settingsGear:S("settings-gear",60241),settings:S("settings",60242),shield:S("shield",60243),smiley:S("smiley",60244),sortPrecedence:S("sort-precedence",60245),splitHorizontal:S("split-horizontal",60246),splitVertical:S("split-vertical",60247),squirrel:S("squirrel",60248),starFull:S("star-full",60249),starHalf:S("star-half",60250),symbolClass:S("symbol-class",60251),symbolColor:S("symbol-color",60252),symbolConstant:S("symbol-constant",60253),symbolEnumMember:S("symbol-enum-member",60254),symbolField:S("symbol-field",60255),symbolFile:S("symbol-file",60256),symbolInterface:S("symbol-interface",60257),symbolKeyword:S("symbol-keyword",60258),symbolMisc:S("symbol-misc",60259),symbolOperator:S("symbol-operator",60260),symbolProperty:S("symbol-property",60261),wrench:S("wrench",60261),wrenchSubaction:S("wrench-subaction",60261),symbolSnippet:S("symbol-snippet",60262),tasklist:S("tasklist",60263),telescope:S("telescope",60264),textSize:S("text-size",60265),threeBars:S("three-bars",60266),thumbsdown:S("thumbsdown",60267),thumbsup:S("thumbsup",60268),tools:S("tools",60269),triangleDown:S("triangle-down",60270),triangleLeft:S("triangle-left",60271),triangleRight:S("triangle-right",60272),triangleUp:S("triangle-up",60273),twitter:S("twitter",60274),unfold:S("unfold",60275),unlock:S("unlock",60276),unmute:S("unmute",60277),unverified:S("unverified",60278),verified:S("verified",60279),versions:S("versions",60280),vmActive:S("vm-active",60281),vmOutline:S("vm-outline",60282),vmRunning:S("vm-running",60283),watch:S("watch",60284),whitespace:S("whitespace",60285),wholeWord:S("whole-word",60286),window:S("window",60287),wordWrap:S("word-wrap",60288),zoomIn:S("zoom-in",60289),zoomOut:S("zoom-out",60290),listFilter:S("list-filter",60291),listFlat:S("list-flat",60292),listSelection:S("list-selection",60293),selection:S("selection",60293),listTree:S("list-tree",60294),debugBreakpointFunctionUnverified:S("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:S("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:S("debug-breakpoint-function-disabled",60296),debugStackframeActive:S("debug-stackframe-active",60297),circleSmallFilled:S("circle-small-filled",60298),debugStackframeDot:S("debug-stackframe-dot",60298),terminalDecorationMark:S("terminal-decoration-mark",60298),debugStackframe:S("debug-stackframe",60299),debugStackframeFocused:S("debug-stackframe-focused",60299),debugBreakpointUnsupported:S("debug-breakpoint-unsupported",60300),symbolString:S("symbol-string",60301),debugReverseContinue:S("debug-reverse-continue",60302),debugStepBack:S("debug-step-back",60303),debugRestartFrame:S("debug-restart-frame",60304),debugAlt:S("debug-alt",60305),callIncoming:S("call-incoming",60306),callOutgoing:S("call-outgoing",60307),menu:S("menu",60308),expandAll:S("expand-all",60309),feedback:S("feedback",60310),gitPullRequestReviewer:S("git-pull-request-reviewer",60310),groupByRefType:S("group-by-ref-type",60311),ungroupByRefType:S("ungroup-by-ref-type",60312),account:S("account",60313),gitPullRequestAssignee:S("git-pull-request-assignee",60313),bellDot:S("bell-dot",60314),debugConsole:S("debug-console",60315),library:S("library",60316),output:S("output",60317),runAll:S("run-all",60318),syncIgnored:S("sync-ignored",60319),pinned:S("pinned",60320),githubInverted:S("github-inverted",60321),serverProcess:S("server-process",60322),serverEnvironment:S("server-environment",60323),pass:S("pass",60324),issueClosed:S("issue-closed",60324),stopCircle:S("stop-circle",60325),playCircle:S("play-circle",60326),record:S("record",60327),debugAltSmall:S("debug-alt-small",60328),vmConnect:S("vm-connect",60329),cloud:S("cloud",60330),merge:S("merge",60331),export:S("export",60332),graphLeft:S("graph-left",60333),magnet:S("magnet",60334),notebook:S("notebook",60335),redo:S("redo",60336),checkAll:S("check-all",60337),pinnedDirty:S("pinned-dirty",60338),passFilled:S("pass-filled",60339),circleLargeFilled:S("circle-large-filled",60340),circleLarge:S("circle-large",60341),circleLargeOutline:S("circle-large-outline",60341),combine:S("combine",60342),gather:S("gather",60342),table:S("table",60343),variableGroup:S("variable-group",60344),typeHierarchy:S("type-hierarchy",60345),typeHierarchySub:S("type-hierarchy-sub",60346),typeHierarchySuper:S("type-hierarchy-super",60347),gitPullRequestCreate:S("git-pull-request-create",60348),runAbove:S("run-above",60349),runBelow:S("run-below",60350),notebookTemplate:S("notebook-template",60351),debugRerun:S("debug-rerun",60352),workspaceTrusted:S("workspace-trusted",60353),workspaceUntrusted:S("workspace-untrusted",60354),workspaceUnknown:S("workspace-unknown",60355),terminalCmd:S("terminal-cmd",60356),terminalDebian:S("terminal-debian",60357),terminalLinux:S("terminal-linux",60358),terminalPowershell:S("terminal-powershell",60359),terminalTmux:S("terminal-tmux",60360),terminalUbuntu:S("terminal-ubuntu",60361),terminalBash:S("terminal-bash",60362),arrowSwap:S("arrow-swap",60363),copy:S("copy",60364),personAdd:S("person-add",60365),filterFilled:S("filter-filled",60366),wand:S("wand",60367),debugLineByLine:S("debug-line-by-line",60368),inspect:S("inspect",60369),layers:S("layers",60370),layersDot:S("layers-dot",60371),layersActive:S("layers-active",60372),compass:S("compass",60373),compassDot:S("compass-dot",60374),compassActive:S("compass-active",60375),azure:S("azure",60376),issueDraft:S("issue-draft",60377),gitPullRequestClosed:S("git-pull-request-closed",60378),gitPullRequestDraft:S("git-pull-request-draft",60379),debugAll:S("debug-all",60380),debugCoverage:S("debug-coverage",60381),runErrors:S("run-errors",60382),folderLibrary:S("folder-library",60383),debugContinueSmall:S("debug-continue-small",60384),beakerStop:S("beaker-stop",60385),graphLine:S("graph-line",60386),graphScatter:S("graph-scatter",60387),pieChart:S("pie-chart",60388),bracket:S("bracket",60175),bracketDot:S("bracket-dot",60389),bracketError:S("bracket-error",60390),lockSmall:S("lock-small",60391),azureDevops:S("azure-devops",60392),verifiedFilled:S("verified-filled",60393),newline:S("newline",60394),layout:S("layout",60395),layoutActivitybarLeft:S("layout-activitybar-left",60396),layoutActivitybarRight:S("layout-activitybar-right",60397),layoutPanelLeft:S("layout-panel-left",60398),layoutPanelCenter:S("layout-panel-center",60399),layoutPanelJustify:S("layout-panel-justify",60400),layoutPanelRight:S("layout-panel-right",60401),layoutPanel:S("layout-panel",60402),layoutSidebarLeft:S("layout-sidebar-left",60403),layoutSidebarRight:S("layout-sidebar-right",60404),layoutStatusbar:S("layout-statusbar",60405),layoutMenubar:S("layout-menubar",60406),layoutCentered:S("layout-centered",60407),target:S("target",60408),indent:S("indent",60409),recordSmall:S("record-small",60410),errorSmall:S("error-small",60411),terminalDecorationError:S("terminal-decoration-error",60411),arrowCircleDown:S("arrow-circle-down",60412),arrowCircleLeft:S("arrow-circle-left",60413),arrowCircleRight:S("arrow-circle-right",60414),arrowCircleUp:S("arrow-circle-up",60415),layoutSidebarRightOff:S("layout-sidebar-right-off",60416),layoutPanelOff:S("layout-panel-off",60417),layoutSidebarLeftOff:S("layout-sidebar-left-off",60418),blank:S("blank",60419),heartFilled:S("heart-filled",60420),map:S("map",60421),mapHorizontal:S("map-horizontal",60421),foldHorizontal:S("fold-horizontal",60421),mapFilled:S("map-filled",60422),mapHorizontalFilled:S("map-horizontal-filled",60422),foldHorizontalFilled:S("fold-horizontal-filled",60422),circleSmall:S("circle-small",60423),bellSlash:S("bell-slash",60424),bellSlashDot:S("bell-slash-dot",60425),commentUnresolved:S("comment-unresolved",60426),gitPullRequestGoToChanges:S("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:S("git-pull-request-new-changes",60428),searchFuzzy:S("search-fuzzy",60429),commentDraft:S("comment-draft",60430),send:S("send",60431),sparkle:S("sparkle",60432),insert:S("insert",60433),mic:S("mic",60434),thumbsdownFilled:S("thumbsdown-filled",60435),thumbsupFilled:S("thumbsup-filled",60436),coffee:S("coffee",60437),snake:S("snake",60438),game:S("game",60439),vr:S("vr",60440),chip:S("chip",60441),piano:S("piano",60442),music:S("music",60443),micFilled:S("mic-filled",60444),repoFetch:S("repo-fetch",60445),copilot:S("copilot",60446),lightbulbSparkle:S("lightbulb-sparkle",60447),robot:S("robot",60448),sparkleFilled:S("sparkle-filled",60449),diffSingle:S("diff-single",60450),diffMultiple:S("diff-multiple",60451),surroundWith:S("surround-with",60452),share:S("share",60453),gitStash:S("git-stash",60454),gitStashApply:S("git-stash-apply",60455),gitStashPop:S("git-stash-pop",60456),vscode:S("vscode",60457),vscodeInsiders:S("vscode-insiders",60458),codeOss:S("code-oss",60459),runCoverage:S("run-coverage",60460),runAllCoverage:S("run-all-coverage",60461),coverage:S("coverage",60462),githubProject:S("github-project",60463),mapVertical:S("map-vertical",60464),foldVertical:S("fold-vertical",60464),mapVerticalFilled:S("map-vertical-filled",60465),foldVerticalFilled:S("fold-vertical-filled",60465),goToSearch:S("go-to-search",60466),percentage:S("percentage",60467),sortPercentage:S("sort-percentage",60467),attach:S("attach",60468)},EQ={dialogError:S("dialog-error","error"),dialogWarning:S("dialog-warning","warning"),dialogInfo:S("dialog-info","info"),dialogClose:S("dialog-close","close"),treeItemExpanded:S("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:S("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:S("tree-filter-on-type-off","list-selection"),treeFilterClear:S("tree-filter-clear","close"),treeItemLoading:S("tree-item-loading","loading"),menuSelection:S("menu-selection","check"),menuSubmenu:S("menu-submenu","chevron-right"),menuBarMore:S("menubar-more","more"),scrollbarButtonLeft:S("scrollbar-button-left","triangle-left"),scrollbarButtonRight:S("scrollbar-button-right","triangle-right"),scrollbarButtonUp:S("scrollbar-button-up","triangle-up"),scrollbarButtonDown:S("scrollbar-button-down","triangle-down"),toolBarMore:S("toolbar-more","more"),quickInputBack:S("quick-input-back","arrow-left"),dropDownButton:S("drop-down-button",60084),symbolCustomColor:S("symbol-customcolor",60252),exportIcon:S("export",60332),workspaceUnspecified:S("workspace-unspecified",60355),newLine:S("newline",60394),thumbsDownFilled:S("thumbsdown-filled",60435),thumbsUpFilled:S("thumbsup-filled",60436),gitFetch:S("git-fetch",60445),lightbulbSparkleAutofix:S("lightbulb-sparkle-autofix",60447),debugBreakpointPending:S("debug-breakpoint-pending",60377)},J={...kQ,...EQ};let vz=class{constructor(){this._tokenizationSupports=new Map,this._factories=new Map,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._colorMap=null}handleChange(e){this._onDidChange.fire({changedLanguages:e,changedColorMap:!1})}register(e,t){return this._tokenizationSupports.set(e,t),this.handleChange([e]),ve(()=>{this._tokenizationSupports.get(e)===t&&(this._tokenizationSupports.delete(e),this.handleChange([e]))})}get(e){return this._tokenizationSupports.get(e)||null}registerFactory(e,t){this._factories.get(e)?.dispose();const i=new TQ(this,e,t);return this._factories.set(e,i),ve(()=>{const n=this._factories.get(e);!n||n!==i||(this._factories.delete(e),n.dispose())})}async getOrCreate(e){const t=this.get(e);if(t)return t;const i=this._factories.get(e);return!i||i.isResolved?null:(await i.resolve(),this.get(e))}isResolved(e){if(this.get(e))return!0;const i=this._factories.get(e);return!!(!i||i.isResolved)}setColorMap(e){this._colorMap=e,this._onDidChange.fire({changedLanguages:Array.from(this._tokenizationSupports.keys()),changedColorMap:!0})}getColorMap(){return this._colorMap}getDefaultBackground(){return this._colorMap&&this._colorMap.length>2?this._colorMap[2]:null}};class TQ extends F{get isResolved(){return this._isResolved}constructor(e,t,i){super(),this._registry=e,this._languageId=t,this._factory=i,this._isDisposed=!1,this._resolvePromise=null,this._isResolved=!1}dispose(){this._isDisposed=!0,super.dispose()}async resolve(){return this._resolvePromise||(this._resolvePromise=this._create()),this._resolvePromise}async _create(){const e=await this._factory.tokenizationSupport;this._isResolved=!0,e&&!this._isDisposed&&this._register(this._registry.register(this._languageId,e))}}let UC=class{constructor(e,t,i){this.offset=e,this.type=t,this.language=i,this._tokenBrand=void 0}toString(){return"("+this.offset+", "+this.type+")"}};class D4{constructor(e,t){this.tokens=e,this.endState=t,this._tokenizationResultBrand=void 0}}class eT{constructor(e,t){this.tokens=e,this.endState=t,this._encodedTokenizationResultBrand=void 0}}var Zs;(function(o){o[o.Increase=0]="Increase",o[o.Decrease=1]="Decrease"})(Zs||(Zs={}));var GC;(function(o){const e=new Map;e.set(0,J.symbolMethod),e.set(1,J.symbolFunction),e.set(2,J.symbolConstructor),e.set(3,J.symbolField),e.set(4,J.symbolVariable),e.set(5,J.symbolClass),e.set(6,J.symbolStruct),e.set(7,J.symbolInterface),e.set(8,J.symbolModule),e.set(9,J.symbolProperty),e.set(10,J.symbolEvent),e.set(11,J.symbolOperator),e.set(12,J.symbolUnit),e.set(13,J.symbolValue),e.set(15,J.symbolEnum),e.set(14,J.symbolConstant),e.set(15,J.symbolEnum),e.set(16,J.symbolEnumMember),e.set(17,J.symbolKeyword),e.set(27,J.symbolSnippet),e.set(18,J.symbolText),e.set(19,J.symbolColor),e.set(20,J.symbolFile),e.set(21,J.symbolReference),e.set(22,J.symbolCustomColor),e.set(23,J.symbolFolder),e.set(24,J.symbolTypeParameter),e.set(25,J.account),e.set(26,J.issues);function t(s){let r=e.get(s);return r||(console.info("No codicon found for CompletionItemKind "+s),r=J.symbolProperty),r}o.toIcon=t;const i=new Map;i.set("method",0),i.set("function",1),i.set("constructor",2),i.set("field",3),i.set("variable",4),i.set("class",5),i.set("struct",6),i.set("interface",7),i.set("module",8),i.set("property",9),i.set("event",10),i.set("operator",11),i.set("unit",12),i.set("value",13),i.set("constant",14),i.set("enum",15),i.set("enum-member",16),i.set("enumMember",16),i.set("keyword",17),i.set("snippet",27),i.set("text",18),i.set("color",19),i.set("file",20),i.set("reference",21),i.set("customcolor",22),i.set("folder",23),i.set("type-parameter",24),i.set("typeParameter",24),i.set("account",25),i.set("issue",26);function n(s,r){let a=i.get(s);return typeof a>"u"&&!r&&(a=9),a}o.fromString=n})(GC||(GC={}));var wa;(function(o){o[o.Automatic=0]="Automatic",o[o.Explicit=1]="Explicit"})(wa||(wa={}));class Cz{constructor(e,t,i,n){this.range=e,this.text=t,this.completionKind=i,this.isSnippetText=n}equals(e){return L.lift(this.range).equalsRange(e.range)&&this.text===e.text&&this.completionKind===e.completionKind&&this.isSnippetText===e.isSnippetText}}var $C;(function(o){o[o.Automatic=0]="Automatic",o[o.PasteAs=1]="PasteAs"})($C||($C={}));var xl;(function(o){o[o.Invoke=1]="Invoke",o[o.TriggerCharacter=2]="TriggerCharacter",o[o.ContentChange=3]="ContentChange"})(xl||(xl={}));var f_;(function(o){o[o.Text=0]="Text",o[o.Read=1]="Read",o[o.Write=2]="Write"})(f_||(f_={}));function DQ(o){return o&&ye.isUri(o.uri)&&L.isIRange(o.range)&&(L.isIRange(o.originSelectionRange)||L.isIRange(o.targetSelectionRange))}const IQ={17:p("Array","array"),16:p("Boolean","boolean"),4:p("Class","class"),13:p("Constant","constant"),8:p("Constructor","constructor"),9:p("Enum","enumeration"),21:p("EnumMember","enumeration member"),23:p("Event","event"),7:p("Field","field"),0:p("File","file"),11:p("Function","function"),10:p("Interface","interface"),19:p("Key","key"),5:p("Method","method"),1:p("Module","module"),2:p("Namespace","namespace"),20:p("Null","null"),15:p("Number","number"),18:p("Object","object"),24:p("Operator","operator"),3:p("Package","package"),6:p("Property","property"),14:p("String","string"),22:p("Struct","struct"),25:p("TypeParameter","type parameter"),12:p("Variable","variable")};function NQ(o,e){return p("symbolAriaLabel","{0} ({1})",o,IQ[e])}var x0;(function(o){const e=new Map;e.set(0,J.symbolFile),e.set(1,J.symbolModule),e.set(2,J.symbolNamespace),e.set(3,J.symbolPackage),e.set(4,J.symbolClass),e.set(5,J.symbolMethod),e.set(6,J.symbolProperty),e.set(7,J.symbolField),e.set(8,J.symbolConstructor),e.set(9,J.symbolEnum),e.set(10,J.symbolInterface),e.set(11,J.symbolFunction),e.set(12,J.symbolVariable),e.set(13,J.symbolConstant),e.set(14,J.symbolString),e.set(15,J.symbolNumber),e.set(16,J.symbolBoolean),e.set(17,J.symbolArray),e.set(18,J.symbolObject),e.set(19,J.symbolKey),e.set(20,J.symbolNull),e.set(21,J.symbolEnumMember),e.set(22,J.symbolStruct),e.set(23,J.symbolEvent),e.set(24,J.symbolOperator),e.set(25,J.symbolTypeParameter);function t(i){let n=e.get(i);return n||(console.info("No codicon found for SymbolKind "+i),n=J.symbolProperty),n}o.toIcon=t})(x0||(x0={}));const kr=class kr{static fromValue(e){switch(e){case"comment":return kr.Comment;case"imports":return kr.Imports;case"region":return kr.Region}return new kr(e)}constructor(e){this.value=e}};kr.Comment=new kr("comment"),kr.Imports=new kr("imports"),kr.Region=new kr("region");let Th=kr;var oR;(function(o){o[o.AIGenerated=1]="AIGenerated"})(oR||(oR={}));var KC;(function(o){o[o.Invoke=0]="Invoke",o[o.Automatic=1]="Automatic"})(KC||(KC={}));var rR;(function(o){function e(t){return!t||typeof t!="object"?!1:typeof t.id=="string"&&typeof t.title=="string"}o.is=e})(rR||(rR={}));var L0;(function(o){o[o.Type=1]="Type",o[o.Parameter=2]="Parameter"})(L0||(L0={}));class RQ{constructor(e){this.createSupport=e,this._tokenizationSupport=null}dispose(){this._tokenizationSupport&&this._tokenizationSupport.then(e=>{e&&e.dispose()})}get tokenizationSupport(){return this._tokenizationSupport||(this._tokenizationSupport=this.createSupport()),this._tokenizationSupport}}const gi=new vz,aR=new vz;var k0;(function(o){o[o.Invoke=0]="Invoke",o[o.Automatic=1]="Automatic"})(k0||(k0={}));var lR;(function(o){o[o.Unknown=0]="Unknown",o[o.Disabled=1]="Disabled",o[o.Enabled=2]="Enabled"})(lR||(lR={}));var cR;(function(o){o[o.Invoke=1]="Invoke",o[o.Auto=2]="Auto"})(cR||(cR={}));var dR;(function(o){o[o.None=0]="None",o[o.KeepWhitespace=1]="KeepWhitespace",o[o.InsertAsSnippet=4]="InsertAsSnippet"})(dR||(dR={}));var hR;(function(o){o[o.Method=0]="Method",o[o.Function=1]="Function",o[o.Constructor=2]="Constructor",o[o.Field=3]="Field",o[o.Variable=4]="Variable",o[o.Class=5]="Class",o[o.Struct=6]="Struct",o[o.Interface=7]="Interface",o[o.Module=8]="Module",o[o.Property=9]="Property",o[o.Event=10]="Event",o[o.Operator=11]="Operator",o[o.Unit=12]="Unit",o[o.Value=13]="Value",o[o.Constant=14]="Constant",o[o.Enum=15]="Enum",o[o.EnumMember=16]="EnumMember",o[o.Keyword=17]="Keyword",o[o.Text=18]="Text",o[o.Color=19]="Color",o[o.File=20]="File",o[o.Reference=21]="Reference",o[o.Customcolor=22]="Customcolor",o[o.Folder=23]="Folder",o[o.TypeParameter=24]="TypeParameter",o[o.User=25]="User",o[o.Issue=26]="Issue",o[o.Snippet=27]="Snippet"})(hR||(hR={}));var uR;(function(o){o[o.Deprecated=1]="Deprecated"})(uR||(uR={}));var gR;(function(o){o[o.Invoke=0]="Invoke",o[o.TriggerCharacter=1]="TriggerCharacter",o[o.TriggerForIncompleteCompletions=2]="TriggerForIncompleteCompletions"})(gR||(gR={}));var fR;(function(o){o[o.EXACT=0]="EXACT",o[o.ABOVE=1]="ABOVE",o[o.BELOW=2]="BELOW"})(fR||(fR={}));var pR;(function(o){o[o.NotSet=0]="NotSet",o[o.ContentFlush=1]="ContentFlush",o[o.RecoverFromMarkers=2]="RecoverFromMarkers",o[o.Explicit=3]="Explicit",o[o.Paste=4]="Paste",o[o.Undo=5]="Undo",o[o.Redo=6]="Redo"})(pR||(pR={}));var mR;(function(o){o[o.LF=1]="LF",o[o.CRLF=2]="CRLF"})(mR||(mR={}));var _R;(function(o){o[o.Text=0]="Text",o[o.Read=1]="Read",o[o.Write=2]="Write"})(_R||(_R={}));var bR;(function(o){o[o.None=0]="None",o[o.Keep=1]="Keep",o[o.Brackets=2]="Brackets",o[o.Advanced=3]="Advanced",o[o.Full=4]="Full"})(bR||(bR={}));var vR;(function(o){o[o.acceptSuggestionOnCommitCharacter=0]="acceptSuggestionOnCommitCharacter",o[o.acceptSuggestionOnEnter=1]="acceptSuggestionOnEnter",o[o.accessibilitySupport=2]="accessibilitySupport",o[o.accessibilityPageSize=3]="accessibilityPageSize",o[o.ariaLabel=4]="ariaLabel",o[o.ariaRequired=5]="ariaRequired",o[o.autoClosingBrackets=6]="autoClosingBrackets",o[o.autoClosingComments=7]="autoClosingComments",o[o.screenReaderAnnounceInlineSuggestion=8]="screenReaderAnnounceInlineSuggestion",o[o.autoClosingDelete=9]="autoClosingDelete",o[o.autoClosingOvertype=10]="autoClosingOvertype",o[o.autoClosingQuotes=11]="autoClosingQuotes",o[o.autoIndent=12]="autoIndent",o[o.automaticLayout=13]="automaticLayout",o[o.autoSurround=14]="autoSurround",o[o.bracketPairColorization=15]="bracketPairColorization",o[o.guides=16]="guides",o[o.codeLens=17]="codeLens",o[o.codeLensFontFamily=18]="codeLensFontFamily",o[o.codeLensFontSize=19]="codeLensFontSize",o[o.colorDecorators=20]="colorDecorators",o[o.colorDecoratorsLimit=21]="colorDecoratorsLimit",o[o.columnSelection=22]="columnSelection",o[o.comments=23]="comments",o[o.contextmenu=24]="contextmenu",o[o.copyWithSyntaxHighlighting=25]="copyWithSyntaxHighlighting",o[o.cursorBlinking=26]="cursorBlinking",o[o.cursorSmoothCaretAnimation=27]="cursorSmoothCaretAnimation",o[o.cursorStyle=28]="cursorStyle",o[o.cursorSurroundingLines=29]="cursorSurroundingLines",o[o.cursorSurroundingLinesStyle=30]="cursorSurroundingLinesStyle",o[o.cursorWidth=31]="cursorWidth",o[o.disableLayerHinting=32]="disableLayerHinting",o[o.disableMonospaceOptimizations=33]="disableMonospaceOptimizations",o[o.domReadOnly=34]="domReadOnly",o[o.dragAndDrop=35]="dragAndDrop",o[o.dropIntoEditor=36]="dropIntoEditor",o[o.emptySelectionClipboard=37]="emptySelectionClipboard",o[o.experimentalWhitespaceRendering=38]="experimentalWhitespaceRendering",o[o.extraEditorClassName=39]="extraEditorClassName",o[o.fastScrollSensitivity=40]="fastScrollSensitivity",o[o.find=41]="find",o[o.fixedOverflowWidgets=42]="fixedOverflowWidgets",o[o.folding=43]="folding",o[o.foldingStrategy=44]="foldingStrategy",o[o.foldingHighlight=45]="foldingHighlight",o[o.foldingImportsByDefault=46]="foldingImportsByDefault",o[o.foldingMaximumRegions=47]="foldingMaximumRegions",o[o.unfoldOnClickAfterEndOfLine=48]="unfoldOnClickAfterEndOfLine",o[o.fontFamily=49]="fontFamily",o[o.fontInfo=50]="fontInfo",o[o.fontLigatures=51]="fontLigatures",o[o.fontSize=52]="fontSize",o[o.fontWeight=53]="fontWeight",o[o.fontVariations=54]="fontVariations",o[o.formatOnPaste=55]="formatOnPaste",o[o.formatOnType=56]="formatOnType",o[o.glyphMargin=57]="glyphMargin",o[o.gotoLocation=58]="gotoLocation",o[o.hideCursorInOverviewRuler=59]="hideCursorInOverviewRuler",o[o.hover=60]="hover",o[o.inDiffEditor=61]="inDiffEditor",o[o.inlineSuggest=62]="inlineSuggest",o[o.inlineEdit=63]="inlineEdit",o[o.letterSpacing=64]="letterSpacing",o[o.lightbulb=65]="lightbulb",o[o.lineDecorationsWidth=66]="lineDecorationsWidth",o[o.lineHeight=67]="lineHeight",o[o.lineNumbers=68]="lineNumbers",o[o.lineNumbersMinChars=69]="lineNumbersMinChars",o[o.linkedEditing=70]="linkedEditing",o[o.links=71]="links",o[o.matchBrackets=72]="matchBrackets",o[o.minimap=73]="minimap",o[o.mouseStyle=74]="mouseStyle",o[o.mouseWheelScrollSensitivity=75]="mouseWheelScrollSensitivity",o[o.mouseWheelZoom=76]="mouseWheelZoom",o[o.multiCursorMergeOverlapping=77]="multiCursorMergeOverlapping",o[o.multiCursorModifier=78]="multiCursorModifier",o[o.multiCursorPaste=79]="multiCursorPaste",o[o.multiCursorLimit=80]="multiCursorLimit",o[o.occurrencesHighlight=81]="occurrencesHighlight",o[o.overviewRulerBorder=82]="overviewRulerBorder",o[o.overviewRulerLanes=83]="overviewRulerLanes",o[o.padding=84]="padding",o[o.pasteAs=85]="pasteAs",o[o.parameterHints=86]="parameterHints",o[o.peekWidgetDefaultFocus=87]="peekWidgetDefaultFocus",o[o.placeholder=88]="placeholder",o[o.definitionLinkOpensInPeek=89]="definitionLinkOpensInPeek",o[o.quickSuggestions=90]="quickSuggestions",o[o.quickSuggestionsDelay=91]="quickSuggestionsDelay",o[o.readOnly=92]="readOnly",o[o.readOnlyMessage=93]="readOnlyMessage",o[o.renameOnType=94]="renameOnType",o[o.renderControlCharacters=95]="renderControlCharacters",o[o.renderFinalNewline=96]="renderFinalNewline",o[o.renderLineHighlight=97]="renderLineHighlight",o[o.renderLineHighlightOnlyWhenFocus=98]="renderLineHighlightOnlyWhenFocus",o[o.renderValidationDecorations=99]="renderValidationDecorations",o[o.renderWhitespace=100]="renderWhitespace",o[o.revealHorizontalRightPadding=101]="revealHorizontalRightPadding",o[o.roundedSelection=102]="roundedSelection",o[o.rulers=103]="rulers",o[o.scrollbar=104]="scrollbar",o[o.scrollBeyondLastColumn=105]="scrollBeyondLastColumn",o[o.scrollBeyondLastLine=106]="scrollBeyondLastLine",o[o.scrollPredominantAxis=107]="scrollPredominantAxis",o[o.selectionClipboard=108]="selectionClipboard",o[o.selectionHighlight=109]="selectionHighlight",o[o.selectOnLineNumbers=110]="selectOnLineNumbers",o[o.showFoldingControls=111]="showFoldingControls",o[o.showUnused=112]="showUnused",o[o.snippetSuggestions=113]="snippetSuggestions",o[o.smartSelect=114]="smartSelect",o[o.smoothScrolling=115]="smoothScrolling",o[o.stickyScroll=116]="stickyScroll",o[o.stickyTabStops=117]="stickyTabStops",o[o.stopRenderingLineAfter=118]="stopRenderingLineAfter",o[o.suggest=119]="suggest",o[o.suggestFontSize=120]="suggestFontSize",o[o.suggestLineHeight=121]="suggestLineHeight",o[o.suggestOnTriggerCharacters=122]="suggestOnTriggerCharacters",o[o.suggestSelection=123]="suggestSelection",o[o.tabCompletion=124]="tabCompletion",o[o.tabIndex=125]="tabIndex",o[o.unicodeHighlighting=126]="unicodeHighlighting",o[o.unusualLineTerminators=127]="unusualLineTerminators",o[o.useShadowDOM=128]="useShadowDOM",o[o.useTabStops=129]="useTabStops",o[o.wordBreak=130]="wordBreak",o[o.wordSegmenterLocales=131]="wordSegmenterLocales",o[o.wordSeparators=132]="wordSeparators",o[o.wordWrap=133]="wordWrap",o[o.wordWrapBreakAfterCharacters=134]="wordWrapBreakAfterCharacters",o[o.wordWrapBreakBeforeCharacters=135]="wordWrapBreakBeforeCharacters",o[o.wordWrapColumn=136]="wordWrapColumn",o[o.wordWrapOverride1=137]="wordWrapOverride1",o[o.wordWrapOverride2=138]="wordWrapOverride2",o[o.wrappingIndent=139]="wrappingIndent",o[o.wrappingStrategy=140]="wrappingStrategy",o[o.showDeprecated=141]="showDeprecated",o[o.inlayHints=142]="inlayHints",o[o.editorClassName=143]="editorClassName",o[o.pixelRatio=144]="pixelRatio",o[o.tabFocusMode=145]="tabFocusMode",o[o.layoutInfo=146]="layoutInfo",o[o.wrappingInfo=147]="wrappingInfo",o[o.defaultColorDecorators=148]="defaultColorDecorators",o[o.colorDecoratorsActivatedOn=149]="colorDecoratorsActivatedOn",o[o.inlineCompletionsAccessibilityVerbose=150]="inlineCompletionsAccessibilityVerbose"})(vR||(vR={}));var CR;(function(o){o[o.TextDefined=0]="TextDefined",o[o.LF=1]="LF",o[o.CRLF=2]="CRLF"})(CR||(CR={}));var yR;(function(o){o[o.LF=0]="LF",o[o.CRLF=1]="CRLF"})(yR||(yR={}));var wR;(function(o){o[o.Left=1]="Left",o[o.Center=2]="Center",o[o.Right=3]="Right"})(wR||(wR={}));var SR;(function(o){o[o.Increase=0]="Increase",o[o.Decrease=1]="Decrease"})(SR||(SR={}));var xR;(function(o){o[o.None=0]="None",o[o.Indent=1]="Indent",o[o.IndentOutdent=2]="IndentOutdent",o[o.Outdent=3]="Outdent"})(xR||(xR={}));var LR;(function(o){o[o.Both=0]="Both",o[o.Right=1]="Right",o[o.Left=2]="Left",o[o.None=3]="None"})(LR||(LR={}));var kR;(function(o){o[o.Type=1]="Type",o[o.Parameter=2]="Parameter"})(kR||(kR={}));var ER;(function(o){o[o.Automatic=0]="Automatic",o[o.Explicit=1]="Explicit"})(ER||(ER={}));var TR;(function(o){o[o.Invoke=0]="Invoke",o[o.Automatic=1]="Automatic"})(TR||(TR={}));var DR;(function(o){o[o.DependsOnKbLayout=-1]="DependsOnKbLayout",o[o.Unknown=0]="Unknown",o[o.Backspace=1]="Backspace",o[o.Tab=2]="Tab",o[o.Enter=3]="Enter",o[o.Shift=4]="Shift",o[o.Ctrl=5]="Ctrl",o[o.Alt=6]="Alt",o[o.PauseBreak=7]="PauseBreak",o[o.CapsLock=8]="CapsLock",o[o.Escape=9]="Escape",o[o.Space=10]="Space",o[o.PageUp=11]="PageUp",o[o.PageDown=12]="PageDown",o[o.End=13]="End",o[o.Home=14]="Home",o[o.LeftArrow=15]="LeftArrow",o[o.UpArrow=16]="UpArrow",o[o.RightArrow=17]="RightArrow",o[o.DownArrow=18]="DownArrow",o[o.Insert=19]="Insert",o[o.Delete=20]="Delete",o[o.Digit0=21]="Digit0",o[o.Digit1=22]="Digit1",o[o.Digit2=23]="Digit2",o[o.Digit3=24]="Digit3",o[o.Digit4=25]="Digit4",o[o.Digit5=26]="Digit5",o[o.Digit6=27]="Digit6",o[o.Digit7=28]="Digit7",o[o.Digit8=29]="Digit8",o[o.Digit9=30]="Digit9",o[o.KeyA=31]="KeyA",o[o.KeyB=32]="KeyB",o[o.KeyC=33]="KeyC",o[o.KeyD=34]="KeyD",o[o.KeyE=35]="KeyE",o[o.KeyF=36]="KeyF",o[o.KeyG=37]="KeyG",o[o.KeyH=38]="KeyH",o[o.KeyI=39]="KeyI",o[o.KeyJ=40]="KeyJ",o[o.KeyK=41]="KeyK",o[o.KeyL=42]="KeyL",o[o.KeyM=43]="KeyM",o[o.KeyN=44]="KeyN",o[o.KeyO=45]="KeyO",o[o.KeyP=46]="KeyP",o[o.KeyQ=47]="KeyQ",o[o.KeyR=48]="KeyR",o[o.KeyS=49]="KeyS",o[o.KeyT=50]="KeyT",o[o.KeyU=51]="KeyU",o[o.KeyV=52]="KeyV",o[o.KeyW=53]="KeyW",o[o.KeyX=54]="KeyX",o[o.KeyY=55]="KeyY",o[o.KeyZ=56]="KeyZ",o[o.Meta=57]="Meta",o[o.ContextMenu=58]="ContextMenu",o[o.F1=59]="F1",o[o.F2=60]="F2",o[o.F3=61]="F3",o[o.F4=62]="F4",o[o.F5=63]="F5",o[o.F6=64]="F6",o[o.F7=65]="F7",o[o.F8=66]="F8",o[o.F9=67]="F9",o[o.F10=68]="F10",o[o.F11=69]="F11",o[o.F12=70]="F12",o[o.F13=71]="F13",o[o.F14=72]="F14",o[o.F15=73]="F15",o[o.F16=74]="F16",o[o.F17=75]="F17",o[o.F18=76]="F18",o[o.F19=77]="F19",o[o.F20=78]="F20",o[o.F21=79]="F21",o[o.F22=80]="F22",o[o.F23=81]="F23",o[o.F24=82]="F24",o[o.NumLock=83]="NumLock",o[o.ScrollLock=84]="ScrollLock",o[o.Semicolon=85]="Semicolon",o[o.Equal=86]="Equal",o[o.Comma=87]="Comma",o[o.Minus=88]="Minus",o[o.Period=89]="Period",o[o.Slash=90]="Slash",o[o.Backquote=91]="Backquote",o[o.BracketLeft=92]="BracketLeft",o[o.Backslash=93]="Backslash",o[o.BracketRight=94]="BracketRight",o[o.Quote=95]="Quote",o[o.OEM_8=96]="OEM_8",o[o.IntlBackslash=97]="IntlBackslash",o[o.Numpad0=98]="Numpad0",o[o.Numpad1=99]="Numpad1",o[o.Numpad2=100]="Numpad2",o[o.Numpad3=101]="Numpad3",o[o.Numpad4=102]="Numpad4",o[o.Numpad5=103]="Numpad5",o[o.Numpad6=104]="Numpad6",o[o.Numpad7=105]="Numpad7",o[o.Numpad8=106]="Numpad8",o[o.Numpad9=107]="Numpad9",o[o.NumpadMultiply=108]="NumpadMultiply",o[o.NumpadAdd=109]="NumpadAdd",o[o.NUMPAD_SEPARATOR=110]="NUMPAD_SEPARATOR",o[o.NumpadSubtract=111]="NumpadSubtract",o[o.NumpadDecimal=112]="NumpadDecimal",o[o.NumpadDivide=113]="NumpadDivide",o[o.KEY_IN_COMPOSITION=114]="KEY_IN_COMPOSITION",o[o.ABNT_C1=115]="ABNT_C1",o[o.ABNT_C2=116]="ABNT_C2",o[o.AudioVolumeMute=117]="AudioVolumeMute",o[o.AudioVolumeUp=118]="AudioVolumeUp",o[o.AudioVolumeDown=119]="AudioVolumeDown",o[o.BrowserSearch=120]="BrowserSearch",o[o.BrowserHome=121]="BrowserHome",o[o.BrowserBack=122]="BrowserBack",o[o.BrowserForward=123]="BrowserForward",o[o.MediaTrackNext=124]="MediaTrackNext",o[o.MediaTrackPrevious=125]="MediaTrackPrevious",o[o.MediaStop=126]="MediaStop",o[o.MediaPlayPause=127]="MediaPlayPause",o[o.LaunchMediaPlayer=128]="LaunchMediaPlayer",o[o.LaunchMail=129]="LaunchMail",o[o.LaunchApp2=130]="LaunchApp2",o[o.Clear=131]="Clear",o[o.MAX_VALUE=132]="MAX_VALUE"})(DR||(DR={}));var IR;(function(o){o[o.Hint=1]="Hint",o[o.Info=2]="Info",o[o.Warning=4]="Warning",o[o.Error=8]="Error"})(IR||(IR={}));var NR;(function(o){o[o.Unnecessary=1]="Unnecessary",o[o.Deprecated=2]="Deprecated"})(NR||(NR={}));var RR;(function(o){o[o.Inline=1]="Inline",o[o.Gutter=2]="Gutter"})(RR||(RR={}));var PR;(function(o){o[o.Normal=1]="Normal",o[o.Underlined=2]="Underlined"})(PR||(PR={}));var AR;(function(o){o[o.UNKNOWN=0]="UNKNOWN",o[o.TEXTAREA=1]="TEXTAREA",o[o.GUTTER_GLYPH_MARGIN=2]="GUTTER_GLYPH_MARGIN",o[o.GUTTER_LINE_NUMBERS=3]="GUTTER_LINE_NUMBERS",o[o.GUTTER_LINE_DECORATIONS=4]="GUTTER_LINE_DECORATIONS",o[o.GUTTER_VIEW_ZONE=5]="GUTTER_VIEW_ZONE",o[o.CONTENT_TEXT=6]="CONTENT_TEXT",o[o.CONTENT_EMPTY=7]="CONTENT_EMPTY",o[o.CONTENT_VIEW_ZONE=8]="CONTENT_VIEW_ZONE",o[o.CONTENT_WIDGET=9]="CONTENT_WIDGET",o[o.OVERVIEW_RULER=10]="OVERVIEW_RULER",o[o.SCROLLBAR=11]="SCROLLBAR",o[o.OVERLAY_WIDGET=12]="OVERLAY_WIDGET",o[o.OUTSIDE_EDITOR=13]="OUTSIDE_EDITOR"})(AR||(AR={}));var MR;(function(o){o[o.AIGenerated=1]="AIGenerated"})(MR||(MR={}));var OR;(function(o){o[o.Invoke=0]="Invoke",o[o.Automatic=1]="Automatic"})(OR||(OR={}));var FR;(function(o){o[o.TOP_RIGHT_CORNER=0]="TOP_RIGHT_CORNER",o[o.BOTTOM_RIGHT_CORNER=1]="BOTTOM_RIGHT_CORNER",o[o.TOP_CENTER=2]="TOP_CENTER"})(FR||(FR={}));var BR;(function(o){o[o.Left=1]="Left",o[o.Center=2]="Center",o[o.Right=4]="Right",o[o.Full=7]="Full"})(BR||(BR={}));var WR;(function(o){o[o.Word=0]="Word",o[o.Line=1]="Line",o[o.Suggest=2]="Suggest"})(WR||(WR={}));var VR;(function(o){o[o.Left=0]="Left",o[o.Right=1]="Right",o[o.None=2]="None",o[o.LeftOfInjectedText=3]="LeftOfInjectedText",o[o.RightOfInjectedText=4]="RightOfInjectedText"})(VR||(VR={}));var HR;(function(o){o[o.Off=0]="Off",o[o.On=1]="On",o[o.Relative=2]="Relative",o[o.Interval=3]="Interval",o[o.Custom=4]="Custom"})(HR||(HR={}));var zR;(function(o){o[o.None=0]="None",o[o.Text=1]="Text",o[o.Blocks=2]="Blocks"})(zR||(zR={}));var UR;(function(o){o[o.Smooth=0]="Smooth",o[o.Immediate=1]="Immediate"})(UR||(UR={}));var GR;(function(o){o[o.Auto=1]="Auto",o[o.Hidden=2]="Hidden",o[o.Visible=3]="Visible"})(GR||(GR={}));var $R;(function(o){o[o.LTR=0]="LTR",o[o.RTL=1]="RTL"})($R||($R={}));var KR;(function(o){o.Off="off",o.OnCode="onCode",o.On="on"})(KR||(KR={}));var jR;(function(o){o[o.Invoke=1]="Invoke",o[o.TriggerCharacter=2]="TriggerCharacter",o[o.ContentChange=3]="ContentChange"})(jR||(jR={}));var qR;(function(o){o[o.File=0]="File",o[o.Module=1]="Module",o[o.Namespace=2]="Namespace",o[o.Package=3]="Package",o[o.Class=4]="Class",o[o.Method=5]="Method",o[o.Property=6]="Property",o[o.Field=7]="Field",o[o.Constructor=8]="Constructor",o[o.Enum=9]="Enum",o[o.Interface=10]="Interface",o[o.Function=11]="Function",o[o.Variable=12]="Variable",o[o.Constant=13]="Constant",o[o.String=14]="String",o[o.Number=15]="Number",o[o.Boolean=16]="Boolean",o[o.Array=17]="Array",o[o.Object=18]="Object",o[o.Key=19]="Key",o[o.Null=20]="Null",o[o.EnumMember=21]="EnumMember",o[o.Struct=22]="Struct",o[o.Event=23]="Event",o[o.Operator=24]="Operator",o[o.TypeParameter=25]="TypeParameter"})(qR||(qR={}));var ZR;(function(o){o[o.Deprecated=1]="Deprecated"})(ZR||(ZR={}));var YR;(function(o){o[o.Hidden=0]="Hidden",o[o.Blink=1]="Blink",o[o.Smooth=2]="Smooth",o[o.Phase=3]="Phase",o[o.Expand=4]="Expand",o[o.Solid=5]="Solid"})(YR||(YR={}));var XR;(function(o){o[o.Line=1]="Line",o[o.Block=2]="Block",o[o.Underline=3]="Underline",o[o.LineThin=4]="LineThin",o[o.BlockOutline=5]="BlockOutline",o[o.UnderlineThin=6]="UnderlineThin"})(XR||(XR={}));var QR;(function(o){o[o.AlwaysGrowsWhenTypingAtEdges=0]="AlwaysGrowsWhenTypingAtEdges",o[o.NeverGrowsWhenTypingAtEdges=1]="NeverGrowsWhenTypingAtEdges",o[o.GrowsOnlyWhenTypingBefore=2]="GrowsOnlyWhenTypingBefore",o[o.GrowsOnlyWhenTypingAfter=3]="GrowsOnlyWhenTypingAfter"})(QR||(QR={}));var JR;(function(o){o[o.None=0]="None",o[o.Same=1]="Same",o[o.Indent=2]="Indent",o[o.DeepIndent=3]="DeepIndent"})(JR||(JR={}));var Rc;let PQ=(Rc=class{static chord(e,t){return Fi(e,t)}},Rc.CtrlCmd=2048,Rc.Shift=1024,Rc.Alt=512,Rc.WinCtrl=256,Rc);function yz(){return{editor:void 0,languages:void 0,CancellationTokenSource:ri,Emitter:O,KeyCode:DR,KeyMod:PQ,Position:A,Range:L,Selection:pe,SelectionDirection:$R,MarkerSeverity:IR,MarkerTag:NR,Uri:ye,Token:UC}}function AQ(o,e){const t=o;typeof t.vscodeWindowId!="number"&&Object.defineProperty(t,"vscodeWindowId",{get:()=>e})}const It=window;function wz(o){return o}class MQ{constructor(e,t){this.lastCache=void 0,this.lastArgKey=void 0,typeof e=="function"?(this._fn=e,this._computeKey=wz):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);return this.lastArgKey!==t&&(this.lastArgKey=t,this.lastCache=this._fn(e)),this.lastCache}}class E3{get cachedValues(){return this._map}constructor(e,t){this._map=new Map,this._map2=new Map,typeof e=="function"?(this._fn=e,this._computeKey=wz):(this._fn=t,this._computeKey=e.getCacheKey)}get(e){const t=this._computeKey(e);if(this._map2.has(t))return this._map2.get(t);const i=this._fn(e);return this._map.set(e,i),this._map2.set(t,i),i}}class Da{constructor(e){this.executor=e,this._didRun=!1}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}}function Sz(o){return!o||typeof o!="string"?!0:o.trim().length===0}const OQ=/{(\d+)}/g;function mf(o,...e){return e.length===0?o:o.replace(OQ,function(t,i){const n=parseInt(i,10);return isNaN(n)||n<0||n>=e.length?t:e[n]})}function FQ(o){return o.replace(/[<>"'&]/g,e=>{switch(e){case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;";case"&":return"&amp;"}return e})}function Av(o){return o.replace(/[<>&]/g,function(e){switch(e){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return e}})}function Fo(o){return o.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function BQ(o,e=" "){const t=yw(o,e);return xz(t,e)}function yw(o,e){if(!o||!e)return o;const t=e.length;if(t===0||o.length===0)return o;let i=0;for(;o.indexOf(e,i)===i;)i=i+t;return o.substring(i)}function xz(o,e){if(!o||!e)return o;const t=e.length,i=o.length;if(t===0||i===0)return o;let n=i,s=-1;for(;s=o.lastIndexOf(e,n-1),!(s===-1||s+t!==n);){if(s===0)return"";n=s}return o.substring(0,n)}function WQ(o){return o.replace(/[\-\\\{\}\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&").replace(/[\*]/g,".*")}function VQ(o){return o.replace(/\*/g,"")}function Lz(o,e,t={}){if(!o)throw new Error("Cannot create regex from empty string");e||(o=Fo(o)),t.wholeWord&&(/\B/.test(o.charAt(0))||(o="\\b"+o),/\B/.test(o.charAt(o.length-1))||(o=o+"\\b"));let i="";return t.global&&(i+="g"),t.matchCase||(i+="i"),t.multiline&&(i+="m"),t.unicode&&(i+="u"),new RegExp(o,i)}function HQ(o){return o.source==="^"||o.source==="^$"||o.source==="$"||o.source==="^\\s*$"?!1:!!(o.exec("")&&o.lastIndex===0)}function Bl(o){return o.split(/\r\n|\r|\n/)}function zQ(o){const e=[],t=o.split(/(\r\n|\r|\n)/);for(let i=0;i<Math.ceil(t.length/2);i++)e.push(t[2*i]+(t[2*i+1]??""));return e}function Xn(o){for(let e=0,t=o.length;e<t;e++){const i=o.charCodeAt(e);if(i!==32&&i!==9)return e}return-1}function Tt(o,e=0,t=o.length){for(let i=e;i<t;i++){const n=o.charCodeAt(i);if(n!==32&&n!==9)return o.substring(e,i)}return o.substring(e,t)}function Sa(o,e=o.length-1){for(let t=e;t>=0;t--){const i=o.charCodeAt(t);if(i!==32&&i!==9)return t}return-1}function jC(o,e){return o<e?-1:o>e?1:0}function I4(o,e,t=0,i=o.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){const l=o.charCodeAt(t),c=e.charCodeAt(n);if(l<c)return-1;if(l>c)return 1}const r=i-t,a=s-n;return r<a?-1:r>a?1:0}function eP(o,e){return ww(o,e,0,o.length,0,e.length)}function ww(o,e,t=0,i=o.length,n=0,s=e.length){for(;t<i&&n<s;t++,n++){let l=o.charCodeAt(t),c=e.charCodeAt(n);if(l===c)continue;if(l>=128||c>=128)return I4(o.toLowerCase(),e.toLowerCase(),t,i,n,s);Hd(l)&&(l-=32),Hd(c)&&(c-=32);const d=l-c;if(d!==0)return d}const r=i-t,a=s-n;return r<a?-1:r>a?1:0}function mS(o){return o>=48&&o<=57}function Hd(o){return o>=97&&o<=122}function dl(o){return o>=65&&o<=90}function Gp(o,e){return o.length===e.length&&ww(o,e)===0}function N4(o,e){const t=e.length;return e.length>o.length?!1:ww(o,e,0,t)===0}function Dh(o,e){const t=Math.min(o.length,e.length);let i;for(i=0;i<t;i++)if(o.charCodeAt(i)!==e.charCodeAt(i))return i;return t}function E0(o,e){const t=Math.min(o.length,e.length);let i;const n=o.length-1,s=e.length-1;for(i=0;i<t;i++)if(o.charCodeAt(n-i)!==e.charCodeAt(s-i))return i;return t}function $i(o){return 55296<=o&&o<=56319}function _f(o){return 56320<=o&&o<=57343}function R4(o,e){return(o-55296<<10)+(e-56320)+65536}function T0(o,e,t){const i=o.charCodeAt(t);if($i(i)&&t+1<e){const n=o.charCodeAt(t+1);if(_f(n))return R4(i,n)}return i}function UQ(o,e){const t=o.charCodeAt(e-1);if(_f(t)&&e>1){const i=o.charCodeAt(e-2);if($i(i))return R4(i,t)}return t}class P4{get offset(){return this._offset}constructor(e,t=0){this._str=e,this._len=e.length,this._offset=t}setOffset(e){this._offset=e}prevCodePoint(){const e=UQ(this._str,this._offset);return this._offset-=e>=65536?2:1,e}nextCodePoint(){const e=T0(this._str,this._len,this._offset);return this._offset+=e>=65536?2:1,e}eol(){return this._offset>=this._len}}class D0{get offset(){return this._iterator.offset}constructor(e,t=0){this._iterator=new P4(e,t)}nextGraphemeLength(){const e=I0.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.nextCodePoint());for(;!t.eol();){const s=t.offset,r=e.getGraphemeBreakType(t.nextCodePoint());if(T3(n,r)){t.setOffset(s);break}n=r}return t.offset-i}prevGraphemeLength(){const e=I0.getInstance(),t=this._iterator,i=t.offset;let n=e.getGraphemeBreakType(t.prevCodePoint());for(;t.offset>0;){const s=t.offset,r=e.getGraphemeBreakType(t.prevCodePoint());if(T3(r,n)){t.setOffset(s);break}n=r}return i-t.offset}eol(){return this._iterator.eol()}}function A4(o,e){return new D0(o,e).nextGraphemeLength()}function kz(o,e){return new D0(o,e).prevGraphemeLength()}function GQ(o,e){e>0&&_f(o.charCodeAt(e))&&e--;const t=e+A4(o,e);return[t-kz(o,t),t]}let zD;function $Q(){return/(?:[\u05BE\u05C0\u05C3\u05C6\u05D0-\u05F4\u0608\u060B\u060D\u061B-\u064A\u066D-\u066F\u0671-\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u0710\u0712-\u072F\u074D-\u07A5\u07B1-\u07EA\u07F4\u07F5\u07FA\u07FE-\u0815\u081A\u0824\u0828\u0830-\u0858\u085E-\u088E\u08A0-\u08C9\u200F\uFB1D\uFB1F-\uFB28\uFB2A-\uFD3D\uFD50-\uFDC7\uFDF0-\uFDFC\uFE70-\uFEFC]|\uD802[\uDC00-\uDD1B\uDD20-\uDE00\uDE10-\uDE35\uDE40-\uDEE4\uDEEB-\uDF35\uDF40-\uDFFF]|\uD803[\uDC00-\uDD23\uDE80-\uDEA9\uDEAD-\uDF45\uDF51-\uDF81\uDF86-\uDFF6]|\uD83A[\uDC00-\uDCCF\uDD00-\uDD43\uDD4B-\uDFFF]|\uD83B[\uDC00-\uDEBB])/}function p_(o){return zD||(zD=$Q()),zD.test(o)}const KQ=/^[\t\n\r\x20-\x7E]*$/;function Sw(o){return KQ.test(o)}const Ez=/[\u2028\u2029]/;function Tz(o){return Ez.test(o)}function Ih(o){return o>=11904&&o<=55215||o>=63744&&o<=64255||o>=65281&&o<=65374}function M4(o){return o>=127462&&o<=127487||o===8986||o===8987||o===9200||o===9203||o>=9728&&o<=10175||o===11088||o===11093||o>=127744&&o<=128591||o>=128640&&o<=128764||o>=128992&&o<=129008||o>=129280&&o<=129535||o>=129648&&o<=129782}const jQ="\uFEFF";function O4(o){return!!(o&&o.length>0&&o.charCodeAt(0)===65279)}function qQ(o,e=!1){return o?(e&&(o=o.replace(/\\./g,"")),o.toLowerCase()!==o):!1}function Dz(o){return o=o%(2*26),o<26?String.fromCharCode(97+o):String.fromCharCode(65+o-26)}function T3(o,e){return o===0?e!==5&&e!==7:o===2&&e===3?!1:o===4||o===2||o===3||e===4||e===2||e===3?!0:!(o===8&&(e===8||e===9||e===11||e===12)||(o===11||o===9)&&(e===9||e===10)||(o===12||o===10)&&e===10||e===5||e===13||e===7||o===1||o===13&&e===14||o===6&&e===6)}const Gu=class Gu{static getInstance(){return Gu._INSTANCE||(Gu._INSTANCE=new Gu),Gu._INSTANCE}constructor(){this._data=ZQ()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;const t=this._data,i=t.length/3;let n=1;for(;n<=i;)if(e<t[3*n])n=2*n;else if(e>t[3*n+1])n=2*n+1;else return t[3*n+2];return 0}};Gu._INSTANCE=null;let I0=Gu;function ZQ(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}function YQ(o,e){if(o===0)return 0;const t=XQ(o,e);if(t!==void 0)return t;const i=new P4(e,o);return i.prevCodePoint(),i.offset}function XQ(o,e){const t=new P4(e,o);let i=t.prevCodePoint();for(;QQ(i)||i===65039||i===8419;){if(t.offset===0)return;i=t.prevCodePoint()}if(!M4(i))return;let n=t.offset;return n>0&&t.prevCodePoint()===8205&&(n=t.offset),n}function QQ(o){return 127995<=o&&o<=127999}const Iz=" ",il=class il{static getInstance(e){return il.cache.get(Array.from(e))}static getLocales(){return il._locales.value}constructor(e){this.confusableDictionary=e}isAmbiguous(e){return this.confusableDictionary.has(e)}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}};il.ambiguousCharacterData=new Da(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}')),il.cache=new MQ({getCacheKey:JSON.stringify},e=>{function t(d){const h=new Map;for(let u=0;u<d.length;u+=2)h.set(d[u],d[u+1]);return h}function i(d,h){const u=new Map(d);for(const[g,f]of h)u.set(g,f);return u}function n(d,h){if(!d)return h;const u=new Map;for(const[g,f]of d)h.has(g)&&u.set(g,f);return u}const s=il.ambiguousCharacterData.value;let r=e.filter(d=>!d.startsWith("_")&&d in s);r.length===0&&(r=["_default"]);let a;for(const d of r){const h=t(s[d]);a=n(a,h)}const l=t(s._common),c=i(l,a);return new il(c)}),il._locales=new Da(()=>Object.keys(il.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")));let qC=il;const pm=class pm{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static getData(){return this._data||(this._data=new Set(pm.getRawData())),this._data}static isInvisibleCharacter(e){return pm.getData().has(e)}static get codePoints(){return pm.getData()}};pm._data=void 0;let og=pm;const _k=class _k{constructor(){this.mapWindowIdToZoomFactor=new Map}getZoomFactor(e){return this.mapWindowIdToZoomFactor.get(this.getWindowId(e))??1}getWindowId(e){return e.vscodeWindowId}};_k.INSTANCE=new _k;let tP=_k;function Nz(o,e,t){typeof e=="string"&&(e=o.matchMedia(e)),e.addEventListener("change",t)}function JQ(o){return tP.INSTANCE.getZoomFactor(o)}const tb=navigator.userAgent,dr=tb.indexOf("Firefox")>=0,tT=tb.indexOf("AppleWebKit")>=0,xw=tb.indexOf("Chrome")>=0,Nh=!xw&&tb.indexOf("Safari")>=0,Rz=!xw&&!Nh&&tT;tb.indexOf("Electron/")>=0;const D3=tb.indexOf("Android")>=0;let UD=!1;if(typeof It.matchMedia=="function"){const o=It.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),e=It.matchMedia("(display-mode: fullscreen)");UD=o.matches,Nz(It,o,({matches:t})=>{UD&&e.matches||(UD=t)})}const F4={clipboard:{writeText:El||document.queryCommandSupported&&document.queryCommandSupported("copy")||!!(navigator&&navigator.clipboard&&navigator.clipboard.writeText),readText:El||!!(navigator&&navigator.clipboard&&navigator.clipboard.readText)},pointerEvents:It.PointerEvent&&("ontouchstart"in It||navigator.maxTouchPoints>0)};function iP(o,e){if(typeof o=="number"){if(o===0)return null;const t=(o&65535)>>>0,i=(o&4294901760)>>>16;return i!==0?new GD([_S(t,e),_S(i,e)]):new GD([_S(t,e)])}else{const t=[];for(let i=0;i<o.length;i++)t.push(_S(o[i],e));return new GD(t)}}function _S(o,e){const t=!!(o&2048),i=!!(o&256),n=e===2?i:t,s=!!(o&1024),r=!!(o&512),a=e===2?t:i,l=o&255;return new $c(n,s,r,a,l)}class $c{constructor(e,t,i,n,s){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyCode=s}equals(e){return e instanceof $c&&this.ctrlKey===e.ctrlKey&&this.shiftKey===e.shiftKey&&this.altKey===e.altKey&&this.metaKey===e.metaKey&&this.keyCode===e.keyCode}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}}class GD{constructor(e){if(e.length===0)throw ar("chords");this.chords=e}}class eJ{constructor(e,t,i,n,s,r){this.ctrlKey=e,this.shiftKey=t,this.altKey=i,this.metaKey=n,this.keyLabel=s,this.keyAriaLabel=r}}class tJ{}function iJ(o){if(o.charCode){const t=String.fromCharCode(o.charCode).toUpperCase();return bc.fromString(t)}const e=o.keyCode;if(e===3)return 7;if(dr)switch(e){case 59:return 85;case 60:if(us)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(Qe)return 57;break}else if(tT){if(Qe&&e===93)return 57;if(!Qe&&e===92)return 57}return dz[e]||0}const nJ=Qe?256:2048,sJ=512,oJ=1024,rJ=Qe?2048:256;class Pt{constructor(e){this._standardKeyboardEventBrand=!0;const t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=iJ(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=nJ),this.altKey&&(t|=sJ),this.shiftKey&&(t|=oJ),this.metaKey&&(t|=rJ),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new $c(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}}const I3=new WeakMap;function aJ(o){if(!o.parent||o.parent===o)return null;try{const e=o.location,t=o.parent.location;if(e.origin!=="null"&&t.origin!=="null"&&e.origin!==t.origin)return null}catch{return null}return o.parent}class lJ{static getSameOriginWindowChain(e){let t=I3.get(e);if(!t){t=[],I3.set(e,t);let i=e,n;do n=aJ(i),n?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=n;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,n=0;const s=this.getSameOriginWindowChain(e);for(const r of s){const a=r.window.deref();if(i+=a?.scrollY??0,n+=a?.scrollX??0,a===t||!r.iframeElement)break;const l=r.iframeElement.getBoundingClientRect();i+=l.top,n+=l.left}return{top:i,left:n}}}class Mr{constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);const i=lJ.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}}class bf{constructor(e,t=0,i=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let n=!1;if(xw){const s=navigator.userAgent.match(/Chrome\/(\d+)/);n=(s?parseInt(s[1]):123)<=122}if(e){const s=e,r=e,a=e.view?.devicePixelRatio||1;if(typeof s.wheelDeltaY<"u")n?this.deltaY=s.wheelDeltaY/(120*a):this.deltaY=s.wheelDeltaY/120;else if(typeof r.VERTICAL_AXIS<"u"&&r.axis===r.VERTICAL_AXIS)this.deltaY=-r.detail/3;else if(e.type==="wheel"){const l=e;l.deltaMode===l.DOM_DELTA_LINE?dr&&!Qe?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof s.wheelDeltaX<"u")Nh&&En?this.deltaX=-(s.wheelDeltaX/120):n?this.deltaX=s.wheelDeltaX/(120*a):this.deltaX=s.wheelDeltaX/120;else if(typeof r.HORIZONTAL_AXIS<"u"&&r.axis===r.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){const l=e;l.deltaMode===l.DOM_DELTA_LINE?dr&&!Qe?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(n?this.deltaY=e.wheelDelta/(120*a):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}}const Pz=Symbol("MicrotaskDelay");function nP(o){return!!o&&typeof o.then=="function"}function ji(o){const e=new ri,t=o(e.token),i=new Promise((n,s)=>{const r=e.token.onCancellationRequested(()=>{r.dispose(),s(new Hr)});Promise.resolve(t).then(a=>{r.dispose(),e.dispose(),n(a)},a=>{r.dispose(),e.dispose(),s(a)})});return new class{cancel(){e.cancel(),e.dispose()}then(n,s){return i.then(n,s)}catch(n){return this.then(void 0,n)}finally(n){return i.finally(n)}}}function Lw(o,e,t){return new Promise((i,n)=>{const s=e.onCancellationRequested(()=>{s.dispose(),i(t)});o.then(i,n).finally(()=>s.dispose())})}class cJ{constructor(){this.isDisposed=!1,this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){const t=()=>{if(this.queuedPromise=null,this.isDisposed)return;const i=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,i};this.queuedPromise=new Promise(i=>{this.activePromise.then(t,t).then(i)})}return new Promise((t,i)=>{this.queuedPromise.then(t,i)})}return this.activePromise=e(),new Promise((t,i)=>{this.activePromise.then(n=>{this.activePromise=null,t(n)},n=>{this.activePromise=null,i(n)})})}dispose(){this.isDisposed=!0}}const dJ=(o,e)=>{let t=!0;const i=setTimeout(()=>{t=!1,e()},o);return{isTriggered:()=>t,dispose:()=>{clearTimeout(i),t=!1}}},hJ=o=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,o())}),{isTriggered:()=>e,dispose:()=>{e=!1}}};class hr{constructor(e){this.defaultDelay=e,this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,t=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((n,s)=>{this.doResolve=n,this.doReject=s}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){const n=this.task;return this.task=null,n()}}));const i=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=t===Pz?hJ(i):dJ(t,i),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new Hr),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}}class Az{constructor(e){this.delayer=new hr(e),this.throttler=new cJ}trigger(e,t){return this.delayer.trigger(()=>this.throttler.queue(e),t)}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}}function Kc(o,e){return e?new Promise((t,i)=>{const n=setTimeout(()=>{s.dispose(),t()},o),s=e.onCancellationRequested(()=>{clearTimeout(n),s.dispose(),i(new Hr)})}):ji(t=>Kc(o,t))}function Rh(o,e=0,t){const i=setTimeout(()=>{o(),t&&n.dispose()},e),n=ve(()=>{clearTimeout(i),t?.deleteAndLeak(n)});return t?.add(n),n}function B4(o,e=i=>!!i,t=null){let i=0;const n=o.length,s=()=>{if(i>=n)return Promise.resolve(t);const r=o[i++];return Promise.resolve(r()).then(l=>e(l)?Promise.resolve(l):s())};return s()}class qr{constructor(e,t){this._isDisposed=!1,this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new pt("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new pt("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}}class W4{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new pt("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();const n=i.setInterval(()=>{e()},t);this.disposable=ve(()=>{i.clearInterval(n),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}}class xt{constructor(e,t){this.timeoutToken=-1,this.runner=e,this.timeout=t,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}}let Mz,Mv;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?Mv=(o,e)=>{ez(()=>{if(t)return;const i=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,i-Date.now())}}))});let t=!1;return{dispose(){t||(t=!0)}}}:Mv=(o,e,t)=>{const i=o.requestIdleCallback(e,typeof t=="number"?{timeout:t}:void 0);let n=!1;return{dispose(){n||(n=!0,o.cancelIdleCallback(i))}}},Mz=o=>Mv(globalThis,o)})();class Oz{constructor(e,t){this._didRun=!1,this._executor=()=>{try{this._value=t()}catch(i){this._error=i}finally{this._didRun=!0}},this._handle=Mv(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}}class uJ extends Oz{constructor(e){super(globalThis,e)}}class ib{get isRejected(){return this.outcome?.outcome===1}get isSettled(){return!!this.outcome}constructor(){this.p=new Promise((e,t)=>{this.completeCallback=e,this.errorCallback=t})}complete(e){return new Promise(t=>{this.completeCallback(e),this.outcome={outcome:0,value:e},t()})}error(e){return new Promise(t=>{this.errorCallback(e),this.outcome={outcome:1,value:e},t()})}cancel(){return this.error(new Hr)}}var sP;(function(o){async function e(i){let n;const s=await Promise.all(i.map(r=>r.then(a=>a,a=>{n||(n=a)})));if(typeof n<"u")throw n;return s}o.settled=e;function t(i){return new Promise(async(n,s)=>{try{await i(n,s)}catch(r){s(r)}})}o.withAsyncBody=t})(sP||(sP={}));const Gs=class Gs{static fromArray(e){return new Gs(t=>{t.emitMany(e)})}static fromPromise(e){return new Gs(async t=>{t.emitMany(await e)})}static fromPromises(e){return new Gs(async t=>{await Promise.all(e.map(async i=>t.emitOne(await i)))})}static merge(e){return new Gs(async t=>{await Promise.all(e.map(async i=>{for await(const n of i)t.emitOne(n)}))})}constructor(e,t){this._state=0,this._results=[],this._error=null,this._onReturn=t,this._onStateChanged=new O,queueMicrotask(async()=>{const i={emitOne:n=>this.emitOne(n),emitMany:n=>this.emitMany(n),reject:n=>this.reject(n)};try{await Promise.resolve(e(i)),this.resolve()}catch(n){this.reject(n)}finally{i.emitOne=void 0,i.emitMany=void 0,i.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await se.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,t){return new Gs(async i=>{for await(const n of e)i.emitOne(t(n))})}map(e){return Gs.map(this,e)}static filter(e,t){return new Gs(async i=>{for await(const n of e)t(n)&&i.emitOne(n)})}filter(e){return Gs.filter(this,e)}static coalesce(e){return Gs.filter(e,t=>!!t)}coalesce(){return Gs.coalesce(this)}static async toPromise(e){const t=[];for await(const i of e)t.push(i);return t}toPromise(){return Gs.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};Gs.EMPTY=Gs.fromArray([]);let No=Gs;class gJ extends No{constructor(e,t){super(t),this._source=e}cancel(){this._source.cancel()}}function fJ(o){const e=new ri,t=o(e.token);return new gJ(e,async i=>{const n=e.token.onCancellationRequested(()=>{n.dispose(),e.dispose(),i.reject(new Hr)});try{for await(const s of t){if(e.token.isCancellationRequested)return;i.emitOne(s)}n.dispose(),e.dispose()}catch(s){n.dispose(),e.dispose(),i.reject(s)}})}/*! @license DOMPurify 3.1.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.1.7/LICENSE */const{entries:Fz,setPrototypeOf:N3,isFrozen:pJ,getPrototypeOf:mJ,getOwnPropertyDescriptor:_J}=Object;let{freeze:ro,seal:zr,create:Bz}=Object,{apply:oP,construct:rP}=typeof Reflect<"u"&&Reflect;ro||(ro=function(e){return e});zr||(zr=function(e){return e});oP||(oP=function(e,t,i){return e.apply(t,i)});rP||(rP=function(e,t){return new e(...t)});const bS=ur(Array.prototype.forEach),R3=ur(Array.prototype.pop),Ab=ur(Array.prototype.push),I1=ur(String.prototype.toLowerCase),$D=ur(String.prototype.toString),P3=ur(String.prototype.match),Mb=ur(String.prototype.replace),bJ=ur(String.prototype.indexOf),vJ=ur(String.prototype.trim),na=ur(Object.prototype.hasOwnProperty),Hs=ur(RegExp.prototype.test),Ob=CJ(TypeError);function ur(o){return function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return oP(o,e,i)}}function CJ(o){return function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return rP(o,t)}}function Nt(o,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:I1;N3&&N3(o,null);let i=e.length;for(;i--;){let n=e[i];if(typeof n=="string"){const s=t(n);s!==n&&(pJ(e)||(e[i]=s),n=s)}o[n]=!0}return o}function yJ(o){for(let e=0;e<o.length;e++)na(o,e)||(o[e]=null);return o}function wu(o){const e=Bz(null);for(const[t,i]of Fz(o))na(o,t)&&(Array.isArray(i)?e[t]=yJ(i):i&&typeof i=="object"&&i.constructor===Object?e[t]=wu(i):e[t]=i);return e}function Fb(o,e){for(;o!==null;){const i=_J(o,e);if(i){if(i.get)return ur(i.get);if(typeof i.value=="function")return ur(i.value)}o=mJ(o)}function t(){return null}return t}const A3=ro(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),KD=ro(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),jD=ro(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),wJ=ro(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),qD=ro(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),SJ=ro(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),M3=ro(["#text"]),O3=ro(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),ZD=ro(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),F3=ro(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vS=ro(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),xJ=zr(/\{\{[\w\W]*|[\w\W]*\}\}/gm),LJ=zr(/<%[\w\W]*|[\w\W]*%>/gm),kJ=zr(/\${[\w\W]*}/gm),EJ=zr(/^data-[\-\w.\u00B7-\uFFFF]/),TJ=zr(/^aria-[\-\w]+$/),Wz=zr(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),DJ=zr(/^(?:\w+script|data):/i),IJ=zr(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Vz=zr(/^html$/i),NJ=zr(/^[a-z][.\w]*(-[.\w]+)+$/i);var B3=Object.freeze({__proto__:null,MUSTACHE_EXPR:xJ,ERB_EXPR:LJ,TMPLIT_EXPR:kJ,DATA_ATTR:EJ,ARIA_ATTR:TJ,IS_ALLOWED_URI:Wz,IS_SCRIPT_OR_DATA:DJ,ATTR_WHITESPACE:IJ,DOCTYPE_NAME:Vz,CUSTOM_ELEMENT:NJ});const Bb={element:1,text:3,progressingInstruction:7,comment:8,document:9},RJ=function(){return typeof window>"u"?null:window},PJ=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(i=t.getAttribute(n));const s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML(r){return r},createScriptURL(r){return r}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function Hz(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:RJ();const e=Ze=>Hz(Ze);if(e.version="3.1.7",e.removed=[],!o||!o.document||o.document.nodeType!==Bb.document)return e.isSupported=!1,e;let{document:t}=o;const i=t,n=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:r,Node:a,Element:l,NodeFilter:c,NamedNodeMap:d=o.NamedNodeMap||o.MozNamedAttrMap,HTMLFormElement:h,DOMParser:u,trustedTypes:g}=o,f=l.prototype,m=Fb(f,"cloneNode"),_=Fb(f,"remove"),b=Fb(f,"nextSibling"),v=Fb(f,"childNodes"),y=Fb(f,"parentNode");if(typeof r=="function"){const Ze=t.createElement("template");Ze.content&&Ze.content.ownerDocument&&(t=Ze.content.ownerDocument)}let C,w="";const{implementation:x,createNodeIterator:k,createDocumentFragment:E,getElementsByTagName:N}=t,{importNode:z}=i;let B={};e.isSupported=typeof Fz=="function"&&typeof y=="function"&&x&&x.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:U,ERB_EXPR:Z,TMPLIT_EXPR:V,DATA_ATTR:Q,ARIA_ATTR:le,IS_SCRIPT_OR_DATA:ge,ATTR_WHITESPACE:_e,CUSTOM_ELEMENT:he}=B3;let{IS_ALLOWED_URI:Ne}=B3,Pe=null;const Xt=Nt({},[...A3,...KD,...jD,...qD,...M3]);let Lt=null;const di=Nt({},[...O3,...ZD,...F3,...vS]);let kt=Object.seal(Bz(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Di=null,jo=null,Bi=!0,yr=!0,cd=!1,aS=!0,dd=!1,Tb=!0,Kl=!1,Db=!1,Ib=!1,hd=!1,ap=!1,lp=!1,su=!0,lS=!1;const cS="user-content-";let cp=!0,ou=!1,Ha={},ud=null;const dp=Nt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let dS=null;const ru=Nt({},["audio","video","img","source","image","track"]);let jl=null;const fo=Nt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),za="http://www.w3.org/1998/Math/MathML",ql="http://www.w3.org/2000/svg",ln="http://www.w3.org/1999/xhtml";let wr=ln,hp=!1,Xr=null;const ii=Nt({},[za,ql,ln],$D);let au=null;const OD=["application/xhtml+xml","text/html"],FD="text/html";let _n=null,gd=null;const BD=t.createElement("form"),hS=function(q){return q instanceof RegExp||q instanceof Function},Nb=function(){let q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(gd&&gd===q)){if((!q||typeof q!="object")&&(q={}),q=wu(q),au=OD.indexOf(q.PARSER_MEDIA_TYPE)===-1?FD:q.PARSER_MEDIA_TYPE,_n=au==="application/xhtml+xml"?$D:I1,Pe=na(q,"ALLOWED_TAGS")?Nt({},q.ALLOWED_TAGS,_n):Xt,Lt=na(q,"ALLOWED_ATTR")?Nt({},q.ALLOWED_ATTR,_n):di,Xr=na(q,"ALLOWED_NAMESPACES")?Nt({},q.ALLOWED_NAMESPACES,$D):ii,jl=na(q,"ADD_URI_SAFE_ATTR")?Nt(wu(fo),q.ADD_URI_SAFE_ATTR,_n):fo,dS=na(q,"ADD_DATA_URI_TAGS")?Nt(wu(ru),q.ADD_DATA_URI_TAGS,_n):ru,ud=na(q,"FORBID_CONTENTS")?Nt({},q.FORBID_CONTENTS,_n):dp,Di=na(q,"FORBID_TAGS")?Nt({},q.FORBID_TAGS,_n):{},jo=na(q,"FORBID_ATTR")?Nt({},q.FORBID_ATTR,_n):{},Ha=na(q,"USE_PROFILES")?q.USE_PROFILES:!1,Bi=q.ALLOW_ARIA_ATTR!==!1,yr=q.ALLOW_DATA_ATTR!==!1,cd=q.ALLOW_UNKNOWN_PROTOCOLS||!1,aS=q.ALLOW_SELF_CLOSE_IN_ATTR!==!1,dd=q.SAFE_FOR_TEMPLATES||!1,Tb=q.SAFE_FOR_XML!==!1,Kl=q.WHOLE_DOCUMENT||!1,hd=q.RETURN_DOM||!1,ap=q.RETURN_DOM_FRAGMENT||!1,lp=q.RETURN_TRUSTED_TYPE||!1,Ib=q.FORCE_BODY||!1,su=q.SANITIZE_DOM!==!1,lS=q.SANITIZE_NAMED_PROPS||!1,cp=q.KEEP_CONTENT!==!1,ou=q.IN_PLACE||!1,Ne=q.ALLOWED_URI_REGEXP||Wz,wr=q.NAMESPACE||ln,kt=q.CUSTOM_ELEMENT_HANDLING||{},q.CUSTOM_ELEMENT_HANDLING&&hS(q.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(kt.tagNameCheck=q.CUSTOM_ELEMENT_HANDLING.tagNameCheck),q.CUSTOM_ELEMENT_HANDLING&&hS(q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(kt.attributeNameCheck=q.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),q.CUSTOM_ELEMENT_HANDLING&&typeof q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(kt.allowCustomizedBuiltInElements=q.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),dd&&(yr=!1),ap&&(hd=!0),Ha&&(Pe=Nt({},M3),Lt=[],Ha.html===!0&&(Nt(Pe,A3),Nt(Lt,O3)),Ha.svg===!0&&(Nt(Pe,KD),Nt(Lt,ZD),Nt(Lt,vS)),Ha.svgFilters===!0&&(Nt(Pe,jD),Nt(Lt,ZD),Nt(Lt,vS)),Ha.mathMl===!0&&(Nt(Pe,qD),Nt(Lt,F3),Nt(Lt,vS))),q.ADD_TAGS&&(Pe===Xt&&(Pe=wu(Pe)),Nt(Pe,q.ADD_TAGS,_n)),q.ADD_ATTR&&(Lt===di&&(Lt=wu(Lt)),Nt(Lt,q.ADD_ATTR,_n)),q.ADD_URI_SAFE_ATTR&&Nt(jl,q.ADD_URI_SAFE_ATTR,_n),q.FORBID_CONTENTS&&(ud===dp&&(ud=wu(ud)),Nt(ud,q.FORBID_CONTENTS,_n)),cp&&(Pe["#text"]=!0),Kl&&Nt(Pe,["html","head","body"]),Pe.table&&(Nt(Pe,["tbody"]),delete Di.tbody),q.TRUSTED_TYPES_POLICY){if(typeof q.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ob('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof q.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ob('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');C=q.TRUSTED_TYPES_POLICY,w=C.createHTML("")}else C===void 0&&(C=PJ(g,n)),C!==null&&typeof w=="string"&&(w=C.createHTML(""));ro&&ro(q),gd=q}},ct=Nt({},["mi","mo","mn","ms","mtext"]),R=Nt({},["annotation-xml"]),P=Nt({},["title","style","font","a","script"]),M=Nt({},[...KD,...jD,...wJ]),W=Nt({},[...qD,...SJ]),G=function(q){let Se=y(q);(!Se||!Se.tagName)&&(Se={namespaceURI:wr,tagName:"template"});const Ve=I1(q.tagName),Ai=I1(Se.tagName);return Xr[q.namespaceURI]?q.namespaceURI===ql?Se.namespaceURI===ln?Ve==="svg":Se.namespaceURI===za?Ve==="svg"&&(Ai==="annotation-xml"||ct[Ai]):!!M[Ve]:q.namespaceURI===za?Se.namespaceURI===ln?Ve==="math":Se.namespaceURI===ql?Ve==="math"&&R[Ai]:!!W[Ve]:q.namespaceURI===ln?Se.namespaceURI===ql&&!R[Ai]||Se.namespaceURI===za&&!ct[Ai]?!1:!W[Ve]&&(P[Ve]||!M[Ve]):!!(au==="application/xhtml+xml"&&Xr[q.namespaceURI]):!1},te=function(q){Ab(e.removed,{element:q});try{y(q).removeChild(q)}catch{_(q)}},ae=function(q,Se){try{Ab(e.removed,{attribute:Se.getAttributeNode(q),from:Se})}catch{Ab(e.removed,{attribute:null,from:Se})}if(Se.removeAttribute(q),q==="is"&&!Lt[q])if(hd||ap)try{te(Se)}catch{}else try{Se.setAttribute(q,"")}catch{}},Te=function(q){let Se=null,Ve=null;if(Ib)q="<remove></remove>"+q;else{const Jn=P3(q,/^[\r\n\t ]+/);Ve=Jn&&Jn[0]}au==="application/xhtml+xml"&&wr===ln&&(q='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+q+"</body></html>");const Ai=C?C.createHTML(q):q;if(wr===ln)try{Se=new u().parseFromString(Ai,au)}catch{}if(!Se||!Se.documentElement){Se=x.createDocument(wr,"template",null);try{Se.documentElement.innerHTML=hp?w:Ai}catch{}}const ys=Se.body||Se.documentElement;return q&&Ve&&ys.insertBefore(t.createTextNode(Ve),ys.childNodes[0]||null),wr===ln?N.call(Se,Kl?"html":"body")[0]:Kl?Se.documentElement:ys},Me=function(q){return k.call(q.ownerDocument||q,q,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},ot=function(q){return q instanceof h&&(typeof q.nodeName!="string"||typeof q.textContent!="string"||typeof q.removeChild!="function"||!(q.attributes instanceof d)||typeof q.removeAttribute!="function"||typeof q.setAttribute!="function"||typeof q.namespaceURI!="string"||typeof q.insertBefore!="function"||typeof q.hasChildNodes!="function")},Et=function(q){return typeof a=="function"&&q instanceof a},Mt=function(q,Se,Ve){B[q]&&bS(B[q],Ai=>{Ai.call(e,Se,Ve,gd)})},Xi=function(q){let Se=null;if(Mt("beforeSanitizeElements",q,null),ot(q))return te(q),!0;const Ve=_n(q.nodeName);if(Mt("uponSanitizeElement",q,{tagName:Ve,allowedTags:Pe}),q.hasChildNodes()&&!Et(q.firstElementChild)&&Hs(/<[/\w]/g,q.innerHTML)&&Hs(/<[/\w]/g,q.textContent)||q.nodeType===Bb.progressingInstruction||Tb&&q.nodeType===Bb.comment&&Hs(/<[/\w]/g,q.data))return te(q),!0;if(!Pe[Ve]||Di[Ve]){if(!Di[Ve]&&Ws(Ve)&&(kt.tagNameCheck instanceof RegExp&&Hs(kt.tagNameCheck,Ve)||kt.tagNameCheck instanceof Function&&kt.tagNameCheck(Ve)))return!1;if(cp&&!ud[Ve]){const Ai=y(q)||q.parentNode,ys=v(q)||q.childNodes;if(ys&&Ai){const Jn=ys.length;for(let po=Jn-1;po>=0;--po){const Ua=m(ys[po],!0);Ua.__removalCount=(q.__removalCount||0)+1,Ai.insertBefore(Ua,b(q))}}}return te(q),!0}return q instanceof l&&!G(q)||(Ve==="noscript"||Ve==="noembed"||Ve==="noframes")&&Hs(/<\/no(script|embed|frames)/i,q.innerHTML)?(te(q),!0):(dd&&q.nodeType===Bb.text&&(Se=q.textContent,bS([U,Z,V],Ai=>{Se=Mb(Se,Ai," ")}),q.textContent!==Se&&(Ab(e.removed,{element:q.cloneNode()}),q.textContent=Se)),Mt("afterSanitizeElements",q,null),!1)},wi=function(q,Se,Ve){if(su&&(Se==="id"||Se==="name")&&(Ve in t||Ve in BD))return!1;if(!(yr&&!jo[Se]&&Hs(Q,Se))){if(!(Bi&&Hs(le,Se))){if(!Lt[Se]||jo[Se]){if(!(Ws(q)&&(kt.tagNameCheck instanceof RegExp&&Hs(kt.tagNameCheck,q)||kt.tagNameCheck instanceof Function&&kt.tagNameCheck(q))&&(kt.attributeNameCheck instanceof RegExp&&Hs(kt.attributeNameCheck,Se)||kt.attributeNameCheck instanceof Function&&kt.attributeNameCheck(Se))||Se==="is"&&kt.allowCustomizedBuiltInElements&&(kt.tagNameCheck instanceof RegExp&&Hs(kt.tagNameCheck,Ve)||kt.tagNameCheck instanceof Function&&kt.tagNameCheck(Ve))))return!1}else if(!jl[Se]){if(!Hs(Ne,Mb(Ve,_e,""))){if(!((Se==="src"||Se==="xlink:href"||Se==="href")&&q!=="script"&&bJ(Ve,"data:")===0&&dS[q])){if(!(cd&&!Hs(ge,Mb(Ve,_e,"")))){if(Ve)return!1}}}}}}return!0},Ws=function(q){return q!=="annotation-xml"&&P3(q,he)},qo=function(q){Mt("beforeSanitizeAttributes",q,null);const{attributes:Se}=q;if(!Se)return;const Ve={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Lt};let Ai=Se.length;for(;Ai--;){const ys=Se[Ai],{name:Jn,namespaceURI:po,value:Ua}=ys,Pb=_n(Jn);let Vs=Jn==="value"?Ua:vJ(Ua);if(Ve.attrName=Pb,Ve.attrValue=Vs,Ve.keepAttr=!0,Ve.forceKeepAttr=void 0,Mt("uponSanitizeAttribute",q,Ve),Vs=Ve.attrValue,Ve.forceKeepAttr||(ae(Jn,q),!Ve.keepAttr))continue;if(!aS&&Hs(/\/>/i,Vs)){ae(Jn,q);continue}dd&&bS([U,Z,V],g3=>{Vs=Mb(Vs,g3," ")});const u3=_n(q.nodeName);if(wi(u3,Pb,Vs)){if(lS&&(Pb==="id"||Pb==="name")&&(ae(Jn,q),Vs=cS+Vs),Tb&&Hs(/((--!?|])>)|<\/(style|title)/i,Vs)){ae(Jn,q);continue}if(C&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!po)switch(g.getAttributeType(u3,Pb)){case"TrustedHTML":{Vs=C.createHTML(Vs);break}case"TrustedScriptURL":{Vs=C.createScriptURL(Vs);break}}try{po?q.setAttributeNS(po,Jn,Vs):q.setAttribute(Jn,Vs),ot(q)?te(q):R3(e.removed)}catch{}}}Mt("afterSanitizeAttributes",q,null)},Rb=function Ze(q){let Se=null;const Ve=Me(q);for(Mt("beforeSanitizeShadowDOM",q,null);Se=Ve.nextNode();)Mt("uponSanitizeShadowNode",Se,null),!Xi(Se)&&(Se.content instanceof s&&Ze(Se.content),qo(Se));Mt("afterSanitizeShadowDOM",q,null)};return e.sanitize=function(Ze){let q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Se=null,Ve=null,Ai=null,ys=null;if(hp=!Ze,hp&&(Ze="<!-->"),typeof Ze!="string"&&!Et(Ze))if(typeof Ze.toString=="function"){if(Ze=Ze.toString(),typeof Ze!="string")throw Ob("dirty is not a string, aborting")}else throw Ob("toString is not a function");if(!e.isSupported)return Ze;if(Db||Nb(q),e.removed=[],typeof Ze=="string"&&(ou=!1),ou){if(Ze.nodeName){const Ua=_n(Ze.nodeName);if(!Pe[Ua]||Di[Ua])throw Ob("root node is forbidden and cannot be sanitized in-place")}}else if(Ze instanceof a)Se=Te("<!---->"),Ve=Se.ownerDocument.importNode(Ze,!0),Ve.nodeType===Bb.element&&Ve.nodeName==="BODY"||Ve.nodeName==="HTML"?Se=Ve:Se.appendChild(Ve);else{if(!hd&&!dd&&!Kl&&Ze.indexOf("<")===-1)return C&&lp?C.createHTML(Ze):Ze;if(Se=Te(Ze),!Se)return hd?null:lp?w:""}Se&&Ib&&te(Se.firstChild);const Jn=Me(ou?Ze:Se);for(;Ai=Jn.nextNode();)Xi(Ai)||(Ai.content instanceof s&&Rb(Ai.content),qo(Ai));if(ou)return Ze;if(hd){if(ap)for(ys=E.call(Se.ownerDocument);Se.firstChild;)ys.appendChild(Se.firstChild);else ys=Se;return(Lt.shadowroot||Lt.shadowrootmode)&&(ys=z.call(i,ys,!0)),ys}let po=Kl?Se.outerHTML:Se.innerHTML;return Kl&&Pe["!doctype"]&&Se.ownerDocument&&Se.ownerDocument.doctype&&Se.ownerDocument.doctype.name&&Hs(Vz,Se.ownerDocument.doctype.name)&&(po="<!DOCTYPE "+Se.ownerDocument.doctype.name+`>
`+po),dd&&bS([U,Z,V],Ua=>{po=Mb(po,Ua," ")}),C&&lp?C.createHTML(po):po},e.setConfig=function(){let Ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Nb(Ze),Db=!0},e.clearConfig=function(){gd=null,Db=!1},e.isValidAttribute=function(Ze,q,Se){gd||Nb({});const Ve=_n(Ze),Ai=_n(q);return wi(Ve,Ai,Se)},e.addHook=function(Ze,q){typeof q=="function"&&(B[Ze]=B[Ze]||[],Ab(B[Ze],q))},e.removeHook=function(Ze){if(B[Ze])return R3(B[Ze])},e.removeHooks=function(Ze){B[Ze]&&(B[Ze]=[])},e.removeAllHooks=function(){B={}},e}var Wl=Hz();Wl.version;Wl.isSupported;const zz=Wl.sanitize;Wl.setConfig;Wl.clearConfig;Wl.isValidAttribute;const Uz=Wl.addHook,Gz=Wl.removeHook;Wl.removeHooks;Wl.removeAllHooks;var Oe;(function(o){o.inMemory="inmemory",o.vscode="vscode",o.internal="private",o.walkThrough="walkThrough",o.walkThroughSnippet="walkThroughSnippet",o.http="http",o.https="https",o.file="file",o.mailto="mailto",o.untitled="untitled",o.data="data",o.command="command",o.vscodeRemote="vscode-remote",o.vscodeRemoteResource="vscode-remote-resource",o.vscodeManagedRemoteResource="vscode-managed-remote-resource",o.vscodeUserData="vscode-userdata",o.vscodeCustomEditor="vscode-custom-editor",o.vscodeNotebookCell="vscode-notebook-cell",o.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",o.vscodeNotebookCellMetadataDiff="vscode-notebook-cell-metadata-diff",o.vscodeNotebookCellOutput="vscode-notebook-cell-output",o.vscodeNotebookCellOutputDiff="vscode-notebook-cell-output-diff",o.vscodeNotebookMetadata="vscode-notebook-metadata",o.vscodeInteractiveInput="vscode-interactive-input",o.vscodeSettings="vscode-settings",o.vscodeWorkspaceTrust="vscode-workspace-trust",o.vscodeTerminal="vscode-terminal",o.vscodeChatCodeBlock="vscode-chat-code-block",o.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",o.vscodeChatSesssion="vscode-chat-editor",o.webviewPanel="webview-panel",o.vscodeWebview="vscode-webview",o.extension="extension",o.vscodeFileResource="vscode-file",o.tmp="tmp",o.vsls="vsls",o.vscodeSourceControl="vscode-scm",o.commentsInput="comment",o.codeSetting="code-setting",o.outputChannel="output"})(Oe||(Oe={}));function iT(o,e){return ye.isUri(o)?Gp(o.scheme,e):N4(o,e+":")}function aP(o,...e){return e.some(t=>iT(o,t))}const AJ="tkn";class MJ{constructor(){this._hosts=Object.create(null),this._ports=Object.create(null),this._connectionTokens=Object.create(null),this._preferredWebSchema="http",this._delegate=null,this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}get _remoteResourcesPath(){return Ri.join(this._serverRootPath,Oe.vscodeRemoteResource)}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(a){return Ae(a),e}const t=e.authority;let i=this._hosts[t];i&&i.indexOf(":")!==-1&&i.indexOf("[")===-1&&(i=`[${i}]`);const n=this._ports[t],s=this._connectionTokens[t];let r=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(r+=`&${AJ}=${encodeURIComponent(s)}`),ye.from({scheme:Uf?this._preferredWebSchema:Oe.vscodeRemoteResource,authority:`${i}:${n}`,path:this._remoteResourcesPath,query:r})}}const $z=new MJ,OJ="vscode-app",CC=class CC{asBrowserUri(e){const t=this.toUri(e);return this.uriToBrowserUri(t)}uriToBrowserUri(e){return e.scheme===Oe.vscodeRemote?$z.rewrite(e):e.scheme===Oe.file&&(El||GY===`${Oe.vscodeFileResource}://${CC.FALLBACK_AUTHORITY}`)?e.with({scheme:Oe.vscodeFileResource,authority:e.authority||CC.FALLBACK_AUTHORITY,query:null,fragment:null}):e}toUri(e,t){if(ye.isUri(e))return e;if(globalThis._VSCODE_FILE_ROOT){const i=globalThis._VSCODE_FILE_ROOT;if(/^\w[\w\d+.-]*:\/\//.test(i))return ye.joinPath(ye.parse(i,!0),e);const n=fQ(i,e);return ye.file(n)}return ye.parse(t.toUrl(e))}};CC.FALLBACK_AUTHORITY=OJ;let lP=CC;const nT=new lP;var cP;(function(o){const e=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);o.CoopAndCoep=Object.freeze(e.get("3"));const t="vscode-coi";function i(s){let r;typeof s=="string"?r=new URL(s).searchParams:s instanceof URL?r=s.searchParams:ye.isUri(s)&&(r=new URL(s.toString(!0)).searchParams);const a=r?.get(t);if(a)return e.get(a)}o.getHeadersFromQuery=i;function n(s,r,a){if(!globalThis.crossOriginIsolated)return;const l=r&&a?"3":a?"2":"1";s instanceof URLSearchParams?s.set(t,l):s[t]=l}o.addSearchParam=n})(cP||(cP={}));function sT(o){return oT(o,0)}function oT(o,e){switch(typeof o){case"object":return o===null?Sc(349,e):Array.isArray(o)?BJ(o,e):WJ(o,e);case"string":return V4(o,e);case"boolean":return FJ(o,e);case"number":return Sc(o,e);case"undefined":return Sc(937,e);default:return Sc(617,e)}}function Sc(o,e){return(e<<5)-e+o|0}function FJ(o,e){return Sc(o?433:863,e)}function V4(o,e){e=Sc(149417,e);for(let t=0,i=o.length;t<i;t++)e=Sc(o.charCodeAt(t),e);return e}function BJ(o,e){return e=Sc(104579,e),o.reduce((t,i)=>oT(i,t),e)}function WJ(o,e){return e=Sc(181387,e),Object.keys(o).sort().reduce((t,i)=>(t=V4(i,t),oT(o[i],t)),e)}function YD(o,e,t=32){const i=t-e,n=~((1<<i)-1);return(o<<e|(n&o)>>>i)>>>0}function W3(o,e=0,t=o.byteLength,i=0){for(let n=0;n<t;n++)o[e+n]=i}function VJ(o,e,t="0"){for(;o.length<e;)o=t+o;return o}function Wb(o,e=32){return o instanceof ArrayBuffer?Array.from(new Uint8Array(o)).map(t=>t.toString(16).padStart(2,"0")).join(""):VJ((o>>>0).toString(16),e/4)}const bk=class bk{constructor(){this._h0=1732584193,this._h1=4023233417,this._h2=2562383102,this._h3=271733878,this._h4=3285377520,this._buff=new Uint8Array(67),this._buffDV=new DataView(this._buff.buffer),this._buffLen=0,this._totalLen=0,this._leftoverHighSurrogate=0,this._finished=!1}update(e){const t=e.length;if(t===0)return;const i=this._buff;let n=this._buffLen,s=this._leftoverHighSurrogate,r,a;for(s!==0?(r=s,a=-1,s=0):(r=e.charCodeAt(0),a=0);;){let l=r;if($i(r))if(a+1<t){const c=e.charCodeAt(a+1);_f(c)?(a++,l=R4(r,c)):l=65533}else{s=r;break}else _f(r)&&(l=65533);if(n=this._push(i,n,l),a++,a<t)r=e.charCodeAt(a);else break}this._buffLen=n,this._leftoverHighSurrogate=s}_push(e,t,i){return i<128?e[t++]=i:i<2048?(e[t++]=192|(i&1984)>>>6,e[t++]=128|(i&63)>>>0):i<65536?(e[t++]=224|(i&61440)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0):(e[t++]=240|(i&1835008)>>>18,e[t++]=128|(i&258048)>>>12,e[t++]=128|(i&4032)>>>6,e[t++]=128|(i&63)>>>0),t>=64&&(this._step(),t-=64,this._totalLen+=64,e[0]=e[64],e[1]=e[65],e[2]=e[66]),t}digest(){return this._finished||(this._finished=!0,this._leftoverHighSurrogate&&(this._leftoverHighSurrogate=0,this._buffLen=this._push(this._buff,this._buffLen,65533)),this._totalLen+=this._buffLen,this._wrapUp()),Wb(this._h0)+Wb(this._h1)+Wb(this._h2)+Wb(this._h3)+Wb(this._h4)}_wrapUp(){this._buff[this._buffLen++]=128,W3(this._buff,this._buffLen),this._buffLen>56&&(this._step(),W3(this._buff));const e=8*this._totalLen;this._buffDV.setUint32(56,Math.floor(e/4294967296),!1),this._buffDV.setUint32(60,e%4294967296,!1),this._step()}_step(){const e=bk._bigBlock32,t=this._buffDV;for(let h=0;h<64;h+=4)e.setUint32(h,t.getUint32(h,!1),!1);for(let h=64;h<320;h+=4)e.setUint32(h,YD(e.getUint32(h-12,!1)^e.getUint32(h-32,!1)^e.getUint32(h-56,!1)^e.getUint32(h-64,!1),1),!1);let i=this._h0,n=this._h1,s=this._h2,r=this._h3,a=this._h4,l,c,d;for(let h=0;h<80;h++)h<20?(l=n&s|~n&r,c=1518500249):h<40?(l=n^s^r,c=1859775393):h<60?(l=n&s|n&r|s&r,c=2400959708):(l=n^s^r,c=3395469782),d=YD(i,5)+l+a+c+e.getUint32(h*4,!1)&4294967295,a=r,r=s,s=YD(n,30),n=i,i=d;this._h0=this._h0+i&4294967295,this._h1=this._h1+n&4294967295,this._h2=this._h2+s&4294967295,this._h3=this._h3+r&4294967295,this._h4=this._h4+a&4294967295}};bk._bigBlock32=new DataView(new ArrayBuffer(320));let dP=bk;const{getWindow:xe,getWindows:Kz,getWindowsCount:HJ,getWindowId:N0,getWindowById:V3,onDidRegisterWindow:rT,onWillUnregisterWindow:zJ,onDidUnregisterWindow:UJ}=function(){const o=new Map;AQ(It,1);const e={window:It,disposables:new $};o.set(It.vscodeWindowId,e);const t=new O,i=new O,n=new O;function s(r,a){return(typeof r=="number"?o.get(r):void 0)??(a?e:void 0)}return{onDidRegisterWindow:t.event,onWillUnregisterWindow:n.event,onDidUnregisterWindow:i.event,registerWindow(r){if(o.has(r.vscodeWindowId))return F.None;const a=new $,l={window:r,disposables:a.add(new $)};return o.set(r.vscodeWindowId,l),a.add(ve(()=>{o.delete(r.vscodeWindowId),i.fire(r)})),a.add(H(r,ee.BEFORE_UNLOAD,()=>{n.fire(r)})),t.fire(l),a},getWindows(){return o.values()},getWindowsCount(){return o.size},getWindowId(r){return r.vscodeWindowId},hasWindow(r){return o.has(r)},getWindowById:s,getWindow(r){const a=r;if(a?.ownerDocument?.defaultView)return a.ownerDocument.defaultView.window;const l=r;return l?.view?l.view.window:It},getDocument(r){return xe(r).document}}}();function fn(o){for(;o.firstChild;)o.firstChild.remove()}class GJ{constructor(e,t,i,n){this._node=e,this._type=t,this._handler=i,this._options=n||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}}function H(o,e,t,i){return new GJ(o,e,t,i)}function jz(o,e){return function(t){return e(new Mr(o,t))}}function $J(o){return function(e){return o(new Pt(e))}}const ci=function(e,t,i,n){let s=i;return t==="click"||t==="mousedown"||t==="contextmenu"?s=jz(xe(e),i):(t==="keydown"||t==="keypress"||t==="keyup")&&(s=$J(i)),H(e,t,s,n)},KJ=function(e,t,i){const n=jz(xe(e),t);return jJ(e,n,i)};function jJ(o,e,t){return H(o,Ta&&F4.pointerEvents?ee.POINTER_DOWN:ee.MOUSE_DOWN,e,t)}function cv(o,e,t){return Mv(o,e,t)}class XD extends Oz{constructor(e,t){super(e,t)}}let R0,ao;class H4 extends W4{constructor(e){super(),this.defaultTarget=e&&xe(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}}class QD{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Ae(e)}}static sort(e,t){return t.priority-e.priority}}(function(){const o=new Map,e=new Map,t=new Map,i=new Map,n=s=>{t.set(s,!1);const r=o.get(s)??[];for(e.set(s,r),o.set(s,[]),i.set(s,!0);r.length>0;)r.sort(QD.sort),r.shift().execute();i.set(s,!1)};ao=(s,r,a=0)=>{const l=N0(s),c=new QD(r,a);let d=o.get(l);return d||(d=[],o.set(l,d)),d.push(c),t.get(l)||(t.set(l,!0),s.requestAnimationFrame(()=>n(l))),c},R0=(s,r,a)=>{const l=N0(s);if(i.get(l)){const c=new QD(r,a);let d=e.get(l);return d||(d=[],e.set(l,d)),d.push(c),c}else return ao(s,r,a)}})();function aT(o){return xe(o).getComputedStyle(o,null)}function Ph(o,e){const t=xe(o),i=t.document;if(o!==i.body)return new wt(o.clientWidth,o.clientHeight);if(Ta&&t?.visualViewport)return new wt(t.visualViewport.width,t.visualViewport.height);if(t?.innerWidth&&t.innerHeight)return new wt(t.innerWidth,t.innerHeight);if(i.body&&i.body.clientWidth&&i.body.clientHeight)return new wt(i.body.clientWidth,i.body.clientHeight);if(i.documentElement&&i.documentElement.clientWidth&&i.documentElement.clientHeight)return new wt(i.documentElement.clientWidth,i.documentElement.clientHeight);throw new Error("Unable to figure out browser width and height")}class Li{static convertToPixels(e,t){return parseFloat(t)||0}static getDimension(e,t,i){const n=aT(e),s=n?n.getPropertyValue(t):"0";return Li.convertToPixels(e,s)}static getBorderLeftWidth(e){return Li.getDimension(e,"border-left-width","borderLeftWidth")}static getBorderRightWidth(e){return Li.getDimension(e,"border-right-width","borderRightWidth")}static getBorderTopWidth(e){return Li.getDimension(e,"border-top-width","borderTopWidth")}static getBorderBottomWidth(e){return Li.getDimension(e,"border-bottom-width","borderBottomWidth")}static getPaddingLeft(e){return Li.getDimension(e,"padding-left","paddingLeft")}static getPaddingRight(e){return Li.getDimension(e,"padding-right","paddingRight")}static getPaddingTop(e){return Li.getDimension(e,"padding-top","paddingTop")}static getPaddingBottom(e){return Li.getDimension(e,"padding-bottom","paddingBottom")}static getMarginLeft(e){return Li.getDimension(e,"margin-left","marginLeft")}static getMarginTop(e){return Li.getDimension(e,"margin-top","marginTop")}static getMarginRight(e){return Li.getDimension(e,"margin-right","marginRight")}static getMarginBottom(e){return Li.getDimension(e,"margin-bottom","marginBottom")}}const $u=class $u{constructor(e,t){this.width=e,this.height=t}with(e=this.width,t=this.height){return e!==this.width||t!==this.height?new $u(e,t):this}static is(e){return typeof e=="object"&&typeof e.height=="number"&&typeof e.width=="number"}static lift(e){return e instanceof $u?e:new $u(e.width,e.height)}static equals(e,t){return e===t?!0:!e||!t?!1:e.width===t.width&&e.height===t.height}};$u.None=new $u(0,0);let wt=$u;function qz(o){let e=o.offsetParent,t=o.offsetTop,i=o.offsetLeft;for(;(o=o.parentNode)!==null&&o!==o.ownerDocument.body&&o!==o.ownerDocument.documentElement;){t-=o.scrollTop;const n=Yz(o)?null:aT(o);n&&(i-=n.direction!=="rtl"?o.scrollLeft:-o.scrollLeft),o===e&&(i+=Li.getBorderLeftWidth(o),t+=Li.getBorderTopWidth(o),t+=o.offsetTop,i+=o.offsetLeft,e=o.offsetParent)}return{left:i,top:t}}function qJ(o,e,t){typeof e=="number"&&(o.style.width=`${e}px`),typeof t=="number"&&(o.style.height=`${t}px`)}function Ci(o){const e=o.getBoundingClientRect(),t=xe(o);return{left:e.left+t.scrollX,top:e.top+t.scrollY,width:e.width,height:e.height}}function Zz(o){let e=o,t=1;do{const i=aT(e).zoom;i!=null&&i!=="1"&&(t*=i),e=e.parentElement}while(e!==null&&e!==e.ownerDocument.documentElement);return t}function Ks(o){const e=Li.getMarginLeft(o)+Li.getMarginRight(o);return o.offsetWidth+e}function JD(o){const e=Li.getBorderLeftWidth(o)+Li.getBorderRightWidth(o),t=Li.getPaddingLeft(o)+Li.getPaddingRight(o);return o.offsetWidth-e-t}function ZJ(o){const e=Li.getBorderTopWidth(o)+Li.getBorderBottomWidth(o),t=Li.getPaddingTop(o)+Li.getPaddingBottom(o);return o.offsetHeight-e-t}function xc(o){const e=Li.getMarginTop(o)+Li.getMarginBottom(o);return o.offsetHeight+e}function Ki(o,e){return!!e?.contains(o)}function YJ(o,e,t){for(;o&&o.nodeType===o.ELEMENT_NODE;){if(o.classList.contains(e))return o;if(t){if(typeof t=="string"){if(o.classList.contains(t))return null}else if(o===t)return null}o=o.parentNode}return null}function eI(o,e,t){return!!YJ(o,e,t)}function Yz(o){return o&&!!o.host&&!!o.mode}function P0(o){return!!vf(o)}function vf(o){for(;o.parentNode;){if(o===o.ownerDocument?.body)return null;o=o.parentNode}return Yz(o)?o:null}function Ln(){let o=nb().activeElement;for(;o?.shadowRoot;)o=o.shadowRoot.activeElement;return o}function lT(o){return Ln()===o}function Xz(o){return Ki(Ln(),o)}function nb(){return HJ()<=1?It.document:Array.from(Kz()).map(({window:e})=>e.document).find(e=>e.hasFocus())??It.document}function dv(){return nb().defaultView?.window??It}const z4=new Map;function Qz(){return new XJ}class XJ{constructor(){this._currentCssStyle="",this._styleSheet=void 0}setStyle(e){e!==this._currentCssStyle&&(this._currentCssStyle=e,this._styleSheet?this._styleSheet.innerText=e:this._styleSheet=Bo(It.document.head,t=>t.innerText=e))}dispose(){this._styleSheet&&(this._styleSheet.remove(),this._styleSheet=void 0)}}function Bo(o=It.document.head,e,t){const i=document.createElement("style");if(i.type="text/css",i.media="screen",e?.(i),o.appendChild(i),t&&t.add(ve(()=>i.remove())),o===It.document.head){const n=new Set;z4.set(i,n);for(const{window:s,disposables:r}of Kz()){if(s===It)continue;const a=r.add(QJ(i,n,s));t?.add(a)}}return i}function QJ(o,e,t){const i=new $,n=o.cloneNode(!0);t.document.head.appendChild(n),i.add(ve(()=>n.remove()));for(const s of eU(o))n.sheet?.insertRule(s.cssText,n.sheet?.cssRules.length);return i.add(JJ.observe(o,i,{childList:!0})(()=>{n.textContent=o.textContent})),e.add(n),i.add(ve(()=>e.delete(n))),i}const JJ=new class{constructor(){this.mutationObservers=new Map}observe(o,e,t){let i=this.mutationObservers.get(o);i||(i=new Map,this.mutationObservers.set(o,i));const n=sT(t);let s=i.get(n);if(s)s.users+=1;else{const r=new O,a=new MutationObserver(c=>r.fire(c));a.observe(o,t);const l=s={users:1,observer:a,onDidMutate:r.event};e.add(ve(()=>{l.users-=1,l.users===0&&(r.dispose(),a.disconnect(),i?.delete(n),i?.size===0&&this.mutationObservers.delete(o))})),i.set(n,s)}return s.onDidMutate}};let tI=null;function Jz(){return tI||(tI=Bo()),tI}function eU(o){return o?.sheet?.rules?o.sheet.rules:o?.sheet?.cssRules?o.sheet.cssRules:[]}function A0(o,e,t=Jz()){if(!(!t||!e)){t.sheet?.insertRule(`${o} {${e}}`,0);for(const i of z4.get(t)??[])A0(o,e,i)}}function hP(o,e=Jz()){if(!e)return;const t=eU(e),i=[];for(let n=0;n<t.length;n++){const s=t[n];eee(s)&&s.selectorText.indexOf(o)!==-1&&i.push(n)}for(let n=i.length-1;n>=0;n--)e.sheet?.deleteRule(i[n]);for(const n of z4.get(e)??[])hP(o,n)}function eee(o){return typeof o.selectorText=="string"}function qi(o){return o instanceof HTMLElement||o instanceof xe(o).HTMLElement}function H3(o){return o instanceof HTMLAnchorElement||o instanceof xe(o).HTMLAnchorElement}function tee(o){return o instanceof SVGElement||o instanceof xe(o).SVGElement}function U4(o){return o instanceof MouseEvent||o instanceof xe(o).MouseEvent}function fc(o){return o instanceof KeyboardEvent||o instanceof xe(o).KeyboardEvent}const ee={CLICK:"click",AUXCLICK:"auxclick",DBLCLICK:"dblclick",MOUSE_UP:"mouseup",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_MOVE:"mousemove",MOUSE_OUT:"mouseout",MOUSE_ENTER:"mouseenter",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",POINTER_LEAVE:"pointerleave",CONTEXT_MENU:"contextmenu",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",FOCUS_IN:"focusin",FOCUS_OUT:"focusout",BLUR:"blur",INPUT:"input",DRAG_START:"dragstart",DRAG:"drag",DRAG_ENTER:"dragenter",DRAG_LEAVE:"dragleave",DRAG_OVER:"dragover",DROP:"drop",DRAG_END:"dragend"};function iee(o){const e=o;return!!(e&&typeof e.preventDefault=="function"&&typeof e.stopPropagation=="function")}const tt={stop:(o,e)=>(o.preventDefault(),e&&o.stopPropagation(),o)};function nee(o){const e=[];for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)e[t]=o.scrollTop,o=o.parentNode;return e}function see(o,e){for(let t=0;o&&o.nodeType===o.ELEMENT_NODE;t++)o.scrollTop!==e[t]&&(o.scrollTop=e[t]),o=o.parentNode}class M0 extends F{static hasFocusWithin(e){if(qi(e)){const t=vf(e),i=t?t.activeElement:e.ownerDocument.activeElement;return Ki(i,e)}else{const t=e;return Ki(t.document.activeElement,t.document)}}constructor(e){super(),this._onDidFocus=this._register(new O),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new O),this.onDidBlur=this._onDidBlur.event;let t=M0.hasFocusWithin(e),i=!1;const n=()=>{i=!1,t||(t=!0,this._onDidFocus.fire())},s=()=>{t&&(i=!0,(qi(e)?xe(e):e).setTimeout(()=>{i&&(i=!1,t=!1,this._onDidBlur.fire())},0))};this._refreshStateHandler=()=>{M0.hasFocusWithin(e)!==t&&(t?s():n())},this._register(H(e,ee.FOCUS,n,!0)),this._register(H(e,ee.BLUR,s,!0)),qi(e)&&(this._register(H(e,ee.FOCUS_IN,()=>this._refreshStateHandler())),this._register(H(e,ee.FOCUS_OUT,()=>this._refreshStateHandler())))}}function Ia(o){return new M0(o)}function oee(o,e){return o.after(e),e}function Y(o,...e){if(o.append(...e),e.length===1&&typeof e[0]!="string")return e[0]}function G4(o,e){return o.insertBefore(e,o.firstChild),e}function pn(o,...e){o.innerText="",Y(o,...e)}const ree=/([\w\-]+)?(#([\w\-]+))?((\.([\w\-]+))*)/;var ZC;(function(o){o.HTML="http://www.w3.org/1999/xhtml",o.SVG="http://www.w3.org/2000/svg"})(ZC||(ZC={}));function tU(o,e,t,...i){const n=ree.exec(e);if(!n)throw new Error("Bad use of emmet");const s=n[1]||"div";let r;return o!==ZC.HTML?r=document.createElementNS(o,s):r=document.createElement(s),n[3]&&(r.id=n[3]),n[4]&&(r.className=n[4].replace(/\./g," ").trim()),t&&Object.entries(t).forEach(([a,l])=>{typeof l>"u"||(/^on\w+$/.test(a)?r[a]=l:a==="selected"?l&&r.setAttribute(a,"true"):r.setAttribute(a,l))}),r.append(...i),r}function ie(o,e,...t){return tU(ZC.HTML,o,e,...t)}ie.SVG=function(o,e,...t){return tU(ZC.SVG,o,e,...t)};function aee(o,...e){o?Ys(...e):is(...e)}function Ys(...o){for(const e of o)e.style.display="",e.removeAttribute("aria-hidden")}function is(...o){for(const e of o)e.style.display="none",e.setAttribute("aria-hidden","true")}function z3(o,e){const t=o.devicePixelRatio*e;return Math.max(1,Math.floor(t))/o.devicePixelRatio}function iU(o){It.open(o,"_blank","noopener")}function lee(o,e){const t=()=>{e(),i=ao(o,t)};let i=ao(o,t);return ve(()=>i.dispose())}$z.setPreferredWebSchema(/^https:/.test(It.location.href)?"https":"http");function jc(o){return o?`url('${nT.uriToBrowserUri(o).toString(!0).replace(/'/g,"%27")}')`:"url('')"}function iI(o){return`'${o.replace(/'/g,"%27")}'`}function Bc(o,e){if(o!==void 0){const t=o.match(/^\s*var\((.+)\)$/);if(t){const i=t[1].split(",",2);return i.length===2&&(e=Bc(i[1].trim(),e)),`var(${i[0]}, ${e})`}return o}return e}function cee(o,e=!1){const t=document.createElement("a");return Uz("afterSanitizeAttributes",i=>{for(const n of["href","src"])if(i.hasAttribute(n)){const s=i.getAttribute(n);if(n==="href"&&s.startsWith("#"))continue;if(t.href=s,!o.includes(t.protocol.replace(/:$/,""))){if(e&&n==="src"&&t.href.startsWith("data:"))continue;i.removeAttribute(n)}}}),ve(()=>{Gz("afterSanitizeAttributes")})}const dee=Object.freeze(["a","abbr","b","bdo","blockquote","br","caption","cite","code","col","colgroup","dd","del","details","dfn","div","dl","dt","em","figcaption","figure","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","label","li","mark","ol","p","pre","q","rp","rt","ruby","samp","small","small","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","video","wbr"]);class Lc extends O{constructor(){super(),this._subscriptions=new $,this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1},this._subscriptions.add(se.runAndSubscribe(rT,({window:e,disposables:t})=>this.registerListeners(e,t),{window:It,disposables:this._subscriptions}))}registerListeners(e,t){t.add(H(e,"keydown",i=>{if(i.defaultPrevented)return;const n=new Pt(i);if(!(n.keyCode===6&&i.repeat)){if(i.altKey&&!this._keyStatus.altKey)this._keyStatus.lastKeyPressed="alt";else if(i.ctrlKey&&!this._keyStatus.ctrlKey)this._keyStatus.lastKeyPressed="ctrl";else if(i.metaKey&&!this._keyStatus.metaKey)this._keyStatus.lastKeyPressed="meta";else if(i.shiftKey&&!this._keyStatus.shiftKey)this._keyStatus.lastKeyPressed="shift";else if(n.keyCode!==6)this._keyStatus.lastKeyPressed=void 0;else return;this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyPressed&&(this._keyStatus.event=i,this.fire(this._keyStatus))}},!0)),t.add(H(e,"keyup",i=>{i.defaultPrevented||(!i.altKey&&this._keyStatus.altKey?this._keyStatus.lastKeyReleased="alt":!i.ctrlKey&&this._keyStatus.ctrlKey?this._keyStatus.lastKeyReleased="ctrl":!i.metaKey&&this._keyStatus.metaKey?this._keyStatus.lastKeyReleased="meta":!i.shiftKey&&this._keyStatus.shiftKey?this._keyStatus.lastKeyReleased="shift":this._keyStatus.lastKeyReleased=void 0,this._keyStatus.lastKeyPressed!==this._keyStatus.lastKeyReleased&&(this._keyStatus.lastKeyPressed=void 0),this._keyStatus.altKey=i.altKey,this._keyStatus.ctrlKey=i.ctrlKey,this._keyStatus.metaKey=i.metaKey,this._keyStatus.shiftKey=i.shiftKey,this._keyStatus.lastKeyReleased&&(this._keyStatus.event=i,this.fire(this._keyStatus)))},!0)),t.add(H(e.document.body,"mousedown",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(H(e.document.body,"mouseup",()=>{this._keyStatus.lastKeyPressed=void 0},!0)),t.add(H(e.document.body,"mousemove",i=>{i.buttons&&(this._keyStatus.lastKeyPressed=void 0)},!0)),t.add(H(e,"blur",()=>{this.resetKeyStatus()}))}get keyStatus(){return this._keyStatus}resetKeyStatus(){this.doResetKeyStatus(),this.fire(this._keyStatus)}doResetKeyStatus(){this._keyStatus={altKey:!1,shiftKey:!1,ctrlKey:!1,metaKey:!1}}static getInstance(){return Lc.instance||(Lc.instance=new Lc),Lc.instance}dispose(){super.dispose(),this._subscriptions.dispose()}}class hee extends F{constructor(e,t){super(),this.element=e,this.callbacks=t,this.counter=0,this.dragStartTime=0,this.registerListeners()}registerListeners(){this.callbacks.onDragStart&&this._register(H(this.element,ee.DRAG_START,e=>{this.callbacks.onDragStart?.(e)})),this.callbacks.onDrag&&this._register(H(this.element,ee.DRAG,e=>{this.callbacks.onDrag?.(e)})),this._register(H(this.element,ee.DRAG_ENTER,e=>{this.counter++,this.dragStartTime=e.timeStamp,this.callbacks.onDragEnter?.(e)})),this._register(H(this.element,ee.DRAG_OVER,e=>{e.preventDefault(),this.callbacks.onDragOver?.(e,e.timeStamp-this.dragStartTime)})),this._register(H(this.element,ee.DRAG_LEAVE,e=>{this.counter--,this.counter===0&&(this.dragStartTime=0,this.callbacks.onDragLeave?.(e))})),this._register(H(this.element,ee.DRAG_END,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDragEnd?.(e)})),this._register(H(this.element,ee.DROP,e=>{this.counter=0,this.dragStartTime=0,this.callbacks.onDrop?.(e)}))}}const nU=/(?<tag>[\w\-]+)?(?:#(?<id>[\w\-]+))?(?<class>(?:\.(?:[\w\-]+))*)(?:@(?<name>(?:[\w\_])+))?/;function Ye(o,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=nU.exec(o);if(!n||!n.groups)throw new Error("Bad use of h");const s=n.groups.tag||"div",r=document.createElement(s);n.groups.id&&(r.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(r.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=r),i)for(const c of i)qi(c)?r.appendChild(c):typeof c=="string"?r.append(c):"root"in c&&(Object.assign(l,c),r.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[h,u]of Object.entries(d))r.style.setProperty(O0(h),typeof u=="number"?u+"px":""+u);else c==="tabIndex"?r.tabIndex=d:r.setAttribute(O0(c),d.toString());return l.root=r,l}function gp(o,...e){let t,i;Array.isArray(e[0])?(t={},i=e[0]):(t=e[0]||{},i=e[1]);const n=nU.exec(o);if(!n||!n.groups)throw new Error("Bad use of h");const s=n.groups.tag||"div",r=document.createElementNS("http://www.w3.org/2000/svg",s);n.groups.id&&(r.id=n.groups.id);const a=[];if(n.groups.class)for(const c of n.groups.class.split("."))c!==""&&a.push(c);if(t.className!==void 0)for(const c of t.className.split("."))c!==""&&a.push(c);a.length>0&&(r.className=a.join(" "));const l={};if(n.groups.name&&(l[n.groups.name]=r),i)for(const c of i)qi(c)?r.appendChild(c):typeof c=="string"?r.append(c):"root"in c&&(Object.assign(l,c),r.appendChild(c.root));for(const[c,d]of Object.entries(t))if(c!=="className")if(c==="style")for(const[h,u]of Object.entries(d))r.style.setProperty(O0(h),typeof u=="number"?u+"px":""+u);else c==="tabIndex"?r.tabIndex=d:r.setAttribute(O0(c),d.toString());return l.root=r,l}function O0(o){return o.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class uee extends F{constructor(e){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._listener=()=>this._handleChange(e,!0),this._mediaQueryList=null,this._handleChange(e,!1)}_handleChange(e,t){this._mediaQueryList?.removeEventListener("change",this._listener),this._mediaQueryList=e.matchMedia(`(resolution: ${e.devicePixelRatio}dppx)`),this._mediaQueryList.addEventListener("change",this._listener),t&&this._onDidChange.fire()}}class gee extends F{get value(){return this._value}constructor(e){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._value=this._getPixelRatio(e);const t=this._register(new uee(e));this._register(t.onDidChange(()=>{this._value=this._getPixelRatio(e),this._onDidChange.fire(this._value)}))}_getPixelRatio(e){const t=document.createElement("canvas").getContext("2d"),i=e.devicePixelRatio||1,n=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return i/n}}class fee{constructor(){this.mapWindowIdToPixelRatioMonitor=new Map}_getOrCreatePixelRatioMonitor(e){const t=N0(e);let i=this.mapWindowIdToPixelRatioMonitor.get(t);return i||(i=new gee(e),this.mapWindowIdToPixelRatioMonitor.set(t,i),se.once(UJ)(({vscodeWindowId:n})=>{n===t&&(i?.dispose(),this.mapWindowIdToPixelRatioMonitor.delete(t))})),i}getInstance(e){return this._getOrCreatePixelRatioMonitor(e)}}const YC=new fee;class sU{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingLeft="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){const t=Qr(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){const t=Qr(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){const t=Qr(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){const t=Qr(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){const t=Qr(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){const t=Qr(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){const t=Qr(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingLeft(e){const t=Qr(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){const t=Qr(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){const t=Qr(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){const t=Qr(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}}function Qr(o){return typeof o=="number"?`${o}px`:o}function bt(o){return new sU(o)}function mn(o,e){o instanceof sU?(o.setFontFamily(e.getMassagedFontFamily()),o.setFontWeight(e.fontWeight),o.setFontSize(e.fontSize),o.setFontFeatureSettings(e.fontFeatureSettings),o.setFontVariationSettings(e.fontVariationSettings),o.setLineHeight(e.lineHeight),o.setLetterSpacing(e.letterSpacing)):(o.style.fontFamily=e.getMassagedFontFamily(),o.style.fontWeight=e.fontWeight,o.style.fontSize=e.fontSize+"px",o.style.fontFeatureSettings=e.fontFeatureSettings,o.style.fontVariationSettings=e.fontVariationSettings,o.style.lineHeight=e.lineHeight+"px",o.style.letterSpacing=e.letterSpacing+"px")}class pee{constructor(e,t){this.chr=e,this.type=t,this.width=0}fulfill(e){this.width=e}}class $4{constructor(e,t){this._bareFontInfo=e,this._requests=t,this._container=null,this._testElements=null}read(e){this._createDomElements(),e.document.body.appendChild(this._container),this._readFromDomElements(),this._container?.remove(),this._container=null,this._testElements=null}_createDomElements(){const e=document.createElement("div");e.style.position="absolute",e.style.top="-50000px",e.style.width="50000px";const t=document.createElement("div");mn(t,this._bareFontInfo),e.appendChild(t);const i=document.createElement("div");mn(i,this._bareFontInfo),i.style.fontWeight="bold",e.appendChild(i);const n=document.createElement("div");mn(n,this._bareFontInfo),n.style.fontStyle="italic",e.appendChild(n);const s=[];for(const r of this._requests){let a;r.type===0&&(a=t),r.type===2&&(a=i),r.type===1&&(a=n),a.appendChild(document.createElement("br"));const l=document.createElement("span");$4._render(l,r),a.appendChild(l),s.push(l)}this._container=e,this._testElements=s}static _render(e,t){if(t.chr===" "){let i=" ";for(let n=0;n<8;n++)i+=i;e.innerText=i}else{let i=t.chr;for(let n=0;n<8;n++)i+=i;e.textContent=i}}_readFromDomElements(){for(let e=0,t=this._requests.length;e<t;e++){const i=this._requests[e],n=this._testElements[e];i.fulfill(n.offsetWidth/256)}}}function mee(o,e,t){new $4(e,t).read(o)}const ir=new class{constructor(){this._zoomLevel=0,this._onDidChangeZoomLevel=new O,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event}getZoomLevel(){return this._zoomLevel}setZoomLevel(o){o=Math.min(Math.max(-5,o),20),this._zoomLevel!==o&&(this._zoomLevel=o,this._onDidChangeZoomLevel.fire(this._zoomLevel))}},_ee=Qe?1.5:1.35,nI=8;class rg{static createFromValidatedSettings(e,t,i){const n=e.get(49),s=e.get(53),r=e.get(52),a=e.get(51),l=e.get(54),c=e.get(67),d=e.get(64);return rg._create(n,s,r,a,l,c,d,t,i)}static _create(e,t,i,n,s,r,a,l,c){r===0?r=_ee*i:r<nI&&(r=r*i),r=Math.round(r),r<nI&&(r=nI);const d=1+(c?0:ir.getZoomLevel()*.1);return i*=d,r*=d,s===zC.TRANSLATE&&(t==="normal"||t==="bold"?s=zC.OFF:(s=`'wght' ${parseInt(t,10)}`,t="normal")),new rg({pixelRatio:l,fontFamily:e,fontWeight:t,fontSize:i,fontFeatureSettings:n,fontVariationSettings:s,lineHeight:r,letterSpacing:a})}constructor(e){this._bareFontInfoBrand=void 0,this.pixelRatio=e.pixelRatio,this.fontFamily=String(e.fontFamily),this.fontWeight=String(e.fontWeight),this.fontSize=e.fontSize,this.fontFeatureSettings=e.fontFeatureSettings,this.fontVariationSettings=e.fontVariationSettings,this.lineHeight=e.lineHeight|0,this.letterSpacing=e.letterSpacing}getId(){return`${this.pixelRatio}-${this.fontFamily}-${this.fontWeight}-${this.fontSize}-${this.fontFeatureSettings}-${this.fontVariationSettings}-${this.lineHeight}-${this.letterSpacing}`}getMassagedFontFamily(){const e=ds.fontFamily,t=rg._wrapInQuotes(this.fontFamily);return e&&this.fontFamily!==e?`${t}, ${e}`:t}static _wrapInQuotes(e){return/[,"']/.test(e)?e:/[+ ]/.test(e)?`"${e}"`:e}}const bee=2;class uP extends rg{constructor(e,t){super(e),this._editorStylingBrand=void 0,this.version=bee,this.isTrusted=t,this.isMonospace=e.isMonospace,this.typicalHalfwidthCharacterWidth=e.typicalHalfwidthCharacterWidth,this.typicalFullwidthCharacterWidth=e.typicalFullwidthCharacterWidth,this.canUseHalfwidthRightwardsArrow=e.canUseHalfwidthRightwardsArrow,this.spaceWidth=e.spaceWidth,this.middotWidth=e.middotWidth,this.wsmiddotWidth=e.wsmiddotWidth,this.maxDigitWidth=e.maxDigitWidth}equals(e){return this.fontFamily===e.fontFamily&&this.fontWeight===e.fontWeight&&this.fontSize===e.fontSize&&this.fontFeatureSettings===e.fontFeatureSettings&&this.fontVariationSettings===e.fontVariationSettings&&this.lineHeight===e.lineHeight&&this.letterSpacing===e.letterSpacing&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.typicalFullwidthCharacterWidth===e.typicalFullwidthCharacterWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.maxDigitWidth===e.maxDigitWidth}}class vee extends F{constructor(){super(...arguments),this._cache=new Map,this._evictUntrustedReadingsTimeout=-1,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event}dispose(){this._evictUntrustedReadingsTimeout!==-1&&(clearTimeout(this._evictUntrustedReadingsTimeout),this._evictUntrustedReadingsTimeout=-1),super.dispose()}clearAllFontInfos(){this._cache.clear(),this._onDidChange.fire()}_ensureCache(e){const t=N0(e);let i=this._cache.get(t);return i||(i=new Cee,this._cache.set(t,i)),i}_writeToCache(e,t,i){this._ensureCache(e).put(t,i),!i.isTrusted&&this._evictUntrustedReadingsTimeout===-1&&(this._evictUntrustedReadingsTimeout=e.setTimeout(()=>{this._evictUntrustedReadingsTimeout=-1,this._evictUntrustedReadings(e)},5e3))}_evictUntrustedReadings(e){const t=this._ensureCache(e),i=t.getValues();let n=!1;for(const s of i)s.isTrusted||(n=!0,t.remove(s));n&&this._onDidChange.fire()}readFontInfo(e,t){const i=this._ensureCache(e);if(!i.has(t)){let n=this._actualReadFontInfo(e,t);(n.typicalHalfwidthCharacterWidth<=2||n.typicalFullwidthCharacterWidth<=2||n.spaceWidth<=2||n.maxDigitWidth<=2)&&(n=new uP({pixelRatio:YC.getInstance(e).value,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontSize:n.fontSize,fontFeatureSettings:n.fontFeatureSettings,fontVariationSettings:n.fontVariationSettings,lineHeight:n.lineHeight,letterSpacing:n.letterSpacing,isMonospace:n.isMonospace,typicalHalfwidthCharacterWidth:Math.max(n.typicalHalfwidthCharacterWidth,5),typicalFullwidthCharacterWidth:Math.max(n.typicalFullwidthCharacterWidth,5),canUseHalfwidthRightwardsArrow:n.canUseHalfwidthRightwardsArrow,spaceWidth:Math.max(n.spaceWidth,5),middotWidth:Math.max(n.middotWidth,5),wsmiddotWidth:Math.max(n.wsmiddotWidth,5),maxDigitWidth:Math.max(n.maxDigitWidth,5)},!1)),this._writeToCache(e,t,n)}return i.get(t)}_createRequest(e,t,i,n){const s=new pee(e,t);return i.push(s),n?.push(s),s}_actualReadFontInfo(e,t){const i=[],n=[],s=this._createRequest("n",0,i,n),r=this._createRequest("ｍ",0,i,null),a=this._createRequest(" ",0,i,n),l=this._createRequest("0",0,i,n),c=this._createRequest("1",0,i,n),d=this._createRequest("2",0,i,n),h=this._createRequest("3",0,i,n),u=this._createRequest("4",0,i,n),g=this._createRequest("5",0,i,n),f=this._createRequest("6",0,i,n),m=this._createRequest("7",0,i,n),_=this._createRequest("8",0,i,n),b=this._createRequest("9",0,i,n),v=this._createRequest("→",0,i,n),y=this._createRequest("￫",0,i,null),C=this._createRequest("·",0,i,n),w=this._createRequest("⸱",0,i,null),x="|/-_ilm%";for(let B=0,U=x.length;B<U;B++)this._createRequest(x.charAt(B),0,i,n),this._createRequest(x.charAt(B),1,i,n),this._createRequest(x.charAt(B),2,i,n);mee(e,t,i);const k=Math.max(l.width,c.width,d.width,h.width,u.width,g.width,f.width,m.width,_.width,b.width);let E=t.fontFeatureSettings===kh.OFF;const N=n[0].width;for(let B=1,U=n.length;E&&B<U;B++){const Z=N-n[B].width;if(Z<-.001||Z>.001){E=!1;break}}let z=!0;return E&&y.width!==N&&(z=!1),y.width>v.width&&(z=!1),new uP({pixelRatio:YC.getInstance(e).value,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontSize:t.fontSize,fontFeatureSettings:t.fontFeatureSettings,fontVariationSettings:t.fontVariationSettings,lineHeight:t.lineHeight,letterSpacing:t.letterSpacing,isMonospace:E,typicalHalfwidthCharacterWidth:s.width,typicalFullwidthCharacterWidth:r.width,canUseHalfwidthRightwardsArrow:z,spaceWidth:a.width,middotWidth:C.width,wsmiddotWidth:w.width,maxDigitWidth:k},!0)}}class Cee{constructor(){this._keys=Object.create(null),this._values=Object.create(null)}has(e){const t=e.getId();return!!this._values[t]}get(e){const t=e.getId();return this._values[t]}put(e,t){const i=e.getId();this._keys[i]=e,this._values[i]=t}remove(e){const t=e.getId();delete this._keys[t],delete this._values[t]}getValues(){return Object.keys(this._keys).map(e=>this._values[e])}}const gP=new vee;var ba;(function(o){o.serviceIds=new Map,o.DI_TARGET="$di$target",o.DI_DEPENDENCIES="$di$dependencies";function e(t){return t[o.DI_DEPENDENCIES]||[]}o.getServiceDependencies=e})(ba||(ba={}));const Ce=Je("instantiationService");function yee(o,e,t){e[ba.DI_TARGET]===e?e[ba.DI_DEPENDENCIES].push({id:o,index:t}):(e[ba.DI_DEPENDENCIES]=[{id:o,index:t}],e[ba.DI_TARGET]=e)}function Je(o){if(ba.serviceIds.has(o))return ba.serviceIds.get(o);const e=function(t,i,n){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");yee(e,t,n)};return e.toString=()=>o,ba.serviceIds.set(o,e),e}const gt=Je("codeEditorService"),Ut=Je("modelService"),Ms=Je("textModelService");class to extends F{constructor(e,t="",i="",n=!0,s){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._enabled=!0,this._id=e,this._label=t,this._cssClass=i,this._enabled=n,this._actionCallback=s}get id(){return this._id}get label(){return this._label}set label(e){this._setLabel(e)}_setLabel(e){this._label!==e&&(this._label=e,this._onDidChange.fire({label:e}))}get tooltip(){return this._tooltip||""}set tooltip(e){this._setTooltip(e)}_setTooltip(e){this._tooltip!==e&&(this._tooltip=e,this._onDidChange.fire({tooltip:e}))}get class(){return this._cssClass}set class(e){this._setClass(e)}_setClass(e){this._cssClass!==e&&(this._cssClass=e,this._onDidChange.fire({class:e}))}get enabled(){return this._enabled}set enabled(e){this._setEnabled(e)}_setEnabled(e){this._enabled!==e&&(this._enabled=e,this._onDidChange.fire({enabled:e}))}get checked(){return this._checked}set checked(e){this._setChecked(e)}_setChecked(e){this._checked!==e&&(this._checked=e,this._onDidChange.fire({checked:e}))}async run(e,t){this._actionCallback&&await this._actionCallback(e)}}class Cf extends F{constructor(){super(...arguments),this._onWillRun=this._register(new O),this.onWillRun=this._onWillRun.event,this._onDidRun=this._register(new O),this.onDidRun=this._onDidRun.event}async run(e,t){if(!e.enabled)return;this._onWillRun.fire({action:e});let i;try{await this.runAction(e,t)}catch(n){i=n}this._onDidRun.fire({action:e,error:i})}async runAction(e,t){await e.run(t)}}const yC=class yC{constructor(){this.id=yC.ID,this.label="",this.tooltip="",this.class="separator",this.enabled=!1,this.checked=!1}static join(...e){let t=[];for(const i of e)i.length&&(t.length?t=[...t,new yC,...i]:t=i);return t}async run(){}};yC.ID="vs.actions.separator";let Zi=yC;class m_{get actions(){return this._actions}constructor(e,t,i,n){this.tooltip="",this.enabled=!0,this.checked=void 0,this.id=e,this.label=t,this.class=n,this._actions=i}async run(){}}const vk=class vk extends to{constructor(){super(vk.ID,p("submenu.empty","(empty)"),void 0,!1)}};vk.ID="vs.actions.empty";let fP=vk;function ag(o){return{id:o.id,label:o.label,tooltip:o.tooltip??o.label,class:o.class,enabled:o.enabled??!0,checked:o.checked,run:async(...e)=>o.run(...e)}}var pP;(function(o){function e(t){return t&&typeof t=="object"&&typeof t.id=="string"}o.isThemeColor=e})(pP||(pP={}));var ke;(function(o){o.iconNameSegment="[A-Za-z0-9]+",o.iconNameExpression="[A-Za-z0-9-]+",o.iconModifierExpression="~[A-Za-z]+",o.iconNameCharacter="[A-Za-z0-9~-]";const e=new RegExp(`^(${o.iconNameExpression})(${o.iconModifierExpression})?$`);function t(u){const g=e.exec(u.id);if(!g)return t(J.error);const[,f,m]=g,_=["codicon","codicon-"+f];return m&&_.push("codicon-modifier-"+m.substring(1)),_}o.asClassNameArray=t;function i(u){return t(u).join(" ")}o.asClassName=i;function n(u){return"."+t(u).join(".")}o.asCSSSelector=n;function s(u){return u&&typeof u=="object"&&typeof u.id=="string"&&(typeof u.color>"u"||pP.isThemeColor(u.color))}o.isThemeIcon=s;const r=new RegExp(`^\\$\\((${o.iconNameExpression}(?:${o.iconModifierExpression})?)\\)$`);function a(u){const g=r.exec(u);if(!g)return;const[,f]=g;return{id:f}}o.fromString=a;function l(u){return{id:u}}o.fromId=l;function c(u,g){let f=u.id;const m=f.lastIndexOf("~");return m!==-1&&(f=f.substring(0,m)),g&&(f=`${f}~${g}`),{id:f}}o.modify=c;function d(u){const g=u.id.lastIndexOf("~");if(g!==-1)return u.id.substring(g+1)}o.getModifier=d;function h(u,g){return u.id===g.id&&u.color?.id===g.color?.id}o.isEqual=h})(ke||(ke={}));const Ft=Je("commandService"),st=new class{constructor(){this._commands=new Map,this._onDidRegisterCommand=new O,this.onDidRegisterCommand=this._onDidRegisterCommand.event}registerCommand(o,e){if(!o)throw new Error("invalid command");if(typeof o=="string"){if(!e)throw new Error("invalid command");return this.registerCommand({id:o,handler:e})}if(o.metadata&&Array.isArray(o.metadata.args)){const r=[];for(const l of o.metadata.args)r.push(l.constraint);const a=o.handler;o.handler=function(l,...c){return AY(c,r),a(l,...c)}}const{id:t}=o;let i=this._commands.get(t);i||(i=new os,this._commands.set(t,i));const n=i.unshift(o),s=ve(()=>{n(),this._commands.get(t)?.isEmpty()&&this._commands.delete(t)});return this._onDidRegisterCommand.fire(t),s}registerCommandAlias(o,e){return st.registerCommand(o,(t,...i)=>t.get(Ft).executeCommand(e,...i))}getCommand(o){const e=this._commands.get(o);if(!(!e||e.isEmpty()))return nt.first(e)}getCommands(){const o=new Map;for(const e of this._commands.keys()){const t=this.getCommand(e);t&&o.set(e,t)}return o}};st.registerCommand("noop",()=>{});function sI(...o){switch(o.length){case 1:return p("contextkey.scanner.hint.didYouMean1","Did you mean {0}?",o[0]);case 2:return p("contextkey.scanner.hint.didYouMean2","Did you mean {0} or {1}?",o[0],o[1]);case 3:return p("contextkey.scanner.hint.didYouMean3","Did you mean {0}, {1} or {2}?",o[0],o[1],o[2]);default:return}}const wee=p("contextkey.scanner.hint.didYouForgetToOpenOrCloseQuote","Did you forget to open or close the quote?"),See=p("contextkey.scanner.hint.didYouForgetToEscapeSlash","Did you forget to escape the '/' (slash) character? Put two backslashes before it to escape, e.g., '\\\\/'.");var Pc;let Vb=(Pc=class{constructor(){this._input="",this._start=0,this._current=0,this._tokens=[],this._errors=[],this.stringRe=/[a-zA-Z0-9_<>\-\./\\:\*\?\+\[\]\^,#@;"%\$\p{L}-]+/uy}static getLexeme(e){switch(e.type){case 0:return"(";case 1:return")";case 2:return"!";case 3:return e.isTripleEq?"===":"==";case 4:return e.isTripleEq?"!==":"!=";case 5:return"<";case 6:return"<=";case 7:return">=";case 8:return">=";case 9:return"=~";case 10:return e.lexeme;case 11:return"true";case 12:return"false";case 13:return"in";case 14:return"not";case 15:return"&&";case 16:return"||";case 17:return e.lexeme;case 18:return e.lexeme;case 19:return e.lexeme;case 20:return"EOF";default:throw x4(`unhandled token type: ${JSON.stringify(e)}; have you forgotten to add a case?`)}}reset(e){return this._input=e,this._start=0,this._current=0,this._tokens=[],this._errors=[],this}scan(){for(;!this._isAtEnd();)switch(this._start=this._current,this._advance()){case 40:this._addToken(0);break;case 41:this._addToken(1);break;case 33:if(this._match(61)){const t=this._match(61);this._tokens.push({type:4,offset:this._start,isTripleEq:t})}else this._addToken(2);break;case 39:this._quotedString();break;case 47:this._regex();break;case 61:if(this._match(61)){const t=this._match(61);this._tokens.push({type:3,offset:this._start,isTripleEq:t})}else this._match(126)?this._addToken(9):this._error(sI("==","=~"));break;case 60:this._addToken(this._match(61)?6:5);break;case 62:this._addToken(this._match(61)?8:7);break;case 38:this._match(38)?this._addToken(15):this._error(sI("&&"));break;case 124:this._match(124)?this._addToken(16):this._error(sI("||"));break;case 32:case 13:case 9:case 10:case 160:break;default:this._string()}return this._start=this._current,this._addToken(20),Array.from(this._tokens)}_match(e){return this._isAtEnd()||this._input.charCodeAt(this._current)!==e?!1:(this._current++,!0)}_advance(){return this._input.charCodeAt(this._current++)}_peek(){return this._isAtEnd()?0:this._input.charCodeAt(this._current)}_addToken(e){this._tokens.push({type:e,offset:this._start})}_error(e){const t=this._start,i=this._input.substring(this._start,this._current),n={type:19,offset:this._start,lexeme:i};this._errors.push({offset:t,lexeme:i,additionalInfo:e}),this._tokens.push(n)}_string(){this.stringRe.lastIndex=this._start;const e=this.stringRe.exec(this._input);if(e){this._current=this._start+e[0].length;const t=this._input.substring(this._start,this._current),i=Pc._keywords.get(t);i?this._addToken(i):this._tokens.push({type:17,lexeme:t,offset:this._start})}}_quotedString(){for(;this._peek()!==39&&!this._isAtEnd();)this._advance();if(this._isAtEnd()){this._error(wee);return}this._advance(),this._tokens.push({type:18,lexeme:this._input.substring(this._start+1,this._current-1),offset:this._start+1})}_regex(){let e=this._current,t=!1,i=!1;for(;;){if(e>=this._input.length){this._current=e,this._error(See);return}const s=this._input.charCodeAt(e);if(t)t=!1;else if(s===47&&!i){e++;break}else s===91?i=!0:s===92?t=!0:s===93&&(i=!1);e++}for(;e<this._input.length&&Pc._regexFlags.has(this._input.charCodeAt(e));)e++;this._current=e;const n=this._input.substring(this._start,this._current);this._tokens.push({type:10,lexeme:n,offset:this._start})}_isAtEnd(){return this._current>=this._input.length}},Pc._regexFlags=new Set(["i","g","s","m","y","u"].map(e=>e.charCodeAt(0))),Pc._keywords=new Map([["not",14],["in",13],["false",12],["true",11]]),Pc);const An=new Map;An.set("false",!1);An.set("true",!0);An.set("isMac",Qe);An.set("isLinux",us);An.set("isWindows",En);An.set("isWeb",Uf);An.set("isMacNative",Qe&&!Uf);An.set("isEdge",ZY);An.set("isFirefox",jY);An.set("isChrome",iz);An.set("isSafari",qY);const xee=Object.prototype.hasOwnProperty,Lee={regexParsingWithErrorRecovery:!0},kee=p("contextkey.parser.error.emptyString","Empty context key expression"),Eee=p("contextkey.parser.error.emptyString.hint","Did you forget to write an expression? You can also put 'false' or 'true' to always evaluate to false or true, respectively."),Tee=p("contextkey.parser.error.noInAfterNot","'in' after 'not'."),U3=p("contextkey.parser.error.closingParenthesis","closing parenthesis ')'"),Dee=p("contextkey.parser.error.unexpectedToken","Unexpected token"),Iee=p("contextkey.parser.error.unexpectedToken.hint","Did you forget to put && or || before the token?"),Nee=p("contextkey.parser.error.unexpectedEOF","Unexpected end of expression"),Ree=p("contextkey.parser.error.unexpectedEOF.hint","Did you forget to put a context key?");var bl;let Pee=(bl=class{constructor(e=Lee){this._config=e,this._scanner=new Vb,this._tokens=[],this._current=0,this._parsingErrors=[],this._flagsGYRe=/g|y/g}parse(e){if(e===""){this._parsingErrors.push({message:kee,offset:0,lexeme:"",additionalInfo:Eee});return}this._tokens=this._scanner.reset(e).scan(),this._current=0,this._parsingErrors=[];try{const t=this._expr();if(!this._isAtEnd()){const i=this._peek(),n=i.type===17?Iee:void 0;throw this._parsingErrors.push({message:Dee,offset:i.offset,lexeme:Vb.getLexeme(i),additionalInfo:n}),bl._parseError}return t}catch(t){if(t!==bl._parseError)throw t;return}}_expr(){return this._or()}_or(){const e=[this._and()];for(;this._matchOne(16);){const t=this._and();e.push(t)}return e.length===1?e[0]:K.or(...e)}_and(){const e=[this._term()];for(;this._matchOne(15);){const t=this._term();e.push(t)}return e.length===1?e[0]:K.and(...e)}_term(){if(this._matchOne(2)){const e=this._peek();switch(e.type){case 11:return this._advance(),gs.INSTANCE;case 12:return this._advance(),Ns.INSTANCE;case 0:{this._advance();const t=this._expr();return this._consume(1,U3),t?.negate()}case 17:return this._advance(),$f.create(e.lexeme);default:throw this._errExpectedButGot("KEY | true | false | '(' expression ')'",e)}}return this._primary()}_primary(){const e=this._peek();switch(e.type){case 11:return this._advance(),K.true();case 12:return this._advance(),K.false();case 0:{this._advance();const t=this._expr();return this._consume(1,U3),t}case 17:{const t=e.lexeme;if(this._advance(),this._matchOne(9)){const n=this._peek();if(!this._config.regexParsingWithErrorRecovery){if(this._advance(),n.type!==10)throw this._errExpectedButGot("REGEX",n);const s=n.lexeme,r=s.lastIndexOf("/"),a=r===s.length-1?void 0:this._removeFlagsGY(s.substring(r+1));let l;try{l=new RegExp(s.substring(1,r),a)}catch{throw this._errExpectedButGot("REGEX",n)}return XC.create(t,l)}switch(n.type){case 10:case 19:{const s=[n.lexeme];this._advance();let r=this._peek(),a=0;for(let u=0;u<n.lexeme.length;u++)n.lexeme.charCodeAt(u)===40?a++:n.lexeme.charCodeAt(u)===41&&a--;for(;!this._isAtEnd()&&r.type!==15&&r.type!==16;){switch(r.type){case 0:a++;break;case 1:a--;break;case 10:case 18:for(let u=0;u<r.lexeme.length;u++)r.lexeme.charCodeAt(u)===40?a++:n.lexeme.charCodeAt(u)===41&&a--}if(a<0)break;s.push(Vb.getLexeme(r)),this._advance(),r=this._peek()}const l=s.join(""),c=l.lastIndexOf("/"),d=c===l.length-1?void 0:this._removeFlagsGY(l.substring(c+1));let h;try{h=new RegExp(l.substring(1,c),d)}catch{throw this._errExpectedButGot("REGEX",n)}return K.regex(t,h)}case 18:{const s=n.lexeme;this._advance();let r=null;if(!Sz(s)){const a=s.indexOf("/"),l=s.lastIndexOf("/");if(a!==l&&a>=0){const c=s.slice(a+1,l),d=s[l+1]==="i"?"i":"";try{r=new RegExp(c,d)}catch{throw this._errExpectedButGot("REGEX",n)}}}if(r===null)throw this._errExpectedButGot("REGEX",n);return XC.create(t,r)}default:throw this._errExpectedButGot("REGEX",this._peek())}}if(this._matchOne(14)){this._consume(13,Tee);const n=this._value();return K.notIn(t,n)}switch(this._peek().type){case 3:{this._advance();const n=this._value();if(this._previous().type===18)return K.equals(t,n);switch(n){case"true":return K.has(t);case"false":return K.not(t);default:return K.equals(t,n)}}case 4:{this._advance();const n=this._value();if(this._previous().type===18)return K.notEquals(t,n);switch(n){case"true":return K.not(t);case"false":return K.has(t);default:return K.notEquals(t,n)}}case 5:return this._advance(),pT.create(t,this._value());case 6:return this._advance(),mT.create(t,this._value());case 7:return this._advance(),gT.create(t,this._value());case 8:return this._advance(),fT.create(t,this._value());case 13:return this._advance(),K.in(t,this._value());default:return K.has(t)}}case 20:throw this._parsingErrors.push({message:Nee,offset:e.offset,lexeme:"",additionalInfo:Ree}),bl._parseError;default:throw this._errExpectedButGot(`true | false | KEY 
	| KEY '=~' REGEX 
	| KEY ('==' | '!=' | '<' | '<=' | '>' | '>=' | 'in' | 'not' 'in') value`,this._peek())}}_value(){const e=this._peek();switch(e.type){case 17:case 18:return this._advance(),e.lexeme;case 11:return this._advance(),"true";case 12:return this._advance(),"false";case 13:return this._advance(),"in";default:return""}}_removeFlagsGY(e){return e.replaceAll(this._flagsGYRe,"")}_previous(){return this._tokens[this._current-1]}_matchOne(e){return this._check(e)?(this._advance(),!0):!1}_advance(){return this._isAtEnd()||this._current++,this._previous()}_consume(e,t){if(this._check(e))return this._advance();throw this._errExpectedButGot(t,this._peek())}_errExpectedButGot(e,t,i){const n=p("contextkey.parser.error.expectedButGot",`Expected: {0}
Received: '{1}'.`,e,Vb.getLexeme(t)),s=t.offset,r=Vb.getLexeme(t);return this._parsingErrors.push({message:n,offset:s,lexeme:r,additionalInfo:i}),bl._parseError}_check(e){return this._peek().type===e}_peek(){return this._tokens[this._current]}_isAtEnd(){return this._peek().type===20}},bl._parseError=new Error,bl);const s3=class s3{static false(){return gs.INSTANCE}static true(){return Ns.INSTANCE}static has(e){return Gf.create(e)}static equals(e,t){return sb.create(e,t)}static notEquals(e,t){return hT.create(e,t)}static regex(e,t){return XC.create(e,t)}static in(e,t){return cT.create(e,t)}static notIn(e,t){return dT.create(e,t)}static not(e){return $f.create(e)}static and(...e){return Xu.create(e,null,!0)}static or(...e){return vc.create(e,null,!0)}static deserialize(e){return e==null?void 0:this._parser.parse(e)}};s3._parser=new Pee({regexParsingWithErrorRecovery:!1});let K=s3;function Aee(o,e){const t=o?o.substituteConstants():void 0,i=e?e.substituteConstants():void 0;return!t&&!i?!0:!t||!i?!1:t.equals(i)}function Ov(o,e){return o.cmp(e)}const Ck=class Ck{constructor(){this.type=0}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!1}serialize(){return"false"}keys(){return[]}negate(){return Ns.INSTANCE}};Ck.INSTANCE=new Ck;let gs=Ck;const yk=class yk{constructor(){this.type=1}cmp(e){return this.type-e.type}equals(e){return e.type===this.type}substituteConstants(){return this}evaluate(e){return!0}serialize(){return"true"}keys(){return[]}negate(){return gs.INSTANCE}};yk.INSTANCE=new yk;let Ns=yk;class Gf{static create(e,t=null){const i=An.get(e);return typeof i=="boolean"?i?Ns.INSTANCE:gs.INSTANCE:new Gf(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=2}cmp(e){return e.type!==this.type?this.type-e.type:rU(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=An.get(this.key);return typeof e=="boolean"?e?Ns.INSTANCE:gs.INSTANCE:this}evaluate(e){return!!e.getValue(this.key)}serialize(){return this.key}keys(){return[this.key]}negate(){return this.negated||(this.negated=$f.create(this.key,this)),this.negated}}class sb{static create(e,t,i=null){if(typeof t=="boolean")return t?Gf.create(e,i):$f.create(e,i);const n=An.get(e);return typeof n=="boolean"?t===(n?"true":"false")?Ns.INSTANCE:gs.INSTANCE:new sb(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=4}cmp(e){return e.type!==this.type?this.type-e.type:Kf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=An.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?Ns.INSTANCE:gs.INSTANCE}return this}evaluate(e){return e.getValue(this.key)==this.value}serialize(){return`${this.key} == '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=hT.create(this.key,this.value,this)),this.negated}}class cT{static create(e,t){return new cT(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=10,this.negated=null}cmp(e){return e.type!==this.type?this.type-e.type:Kf(this.key,this.valueKey,e.key,e.valueKey)}equals(e){return e.type===this.type?this.key===e.key&&this.valueKey===e.valueKey:!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.valueKey),i=e.getValue(this.key);return Array.isArray(t)?t.includes(i):typeof i=="string"&&typeof t=="object"&&t!==null?xee.call(t,i):!1}serialize(){return`${this.key} in '${this.valueKey}'`}keys(){return[this.key,this.valueKey]}negate(){return this.negated||(this.negated=dT.create(this.key,this.valueKey)),this.negated}}class dT{static create(e,t){return new dT(e,t)}constructor(e,t){this.key=e,this.valueKey=t,this.type=11,this._negated=cT.create(e,t)}cmp(e){return e.type!==this.type?this.type-e.type:this._negated.cmp(e._negated)}equals(e){return e.type===this.type?this._negated.equals(e._negated):!1}substituteConstants(){return this}evaluate(e){return!this._negated.evaluate(e)}serialize(){return`${this.key} not in '${this.valueKey}'`}keys(){return this._negated.keys()}negate(){return this._negated}}class hT{static create(e,t,i=null){if(typeof t=="boolean")return t?$f.create(e,i):Gf.create(e,i);const n=An.get(e);return typeof n=="boolean"?t===(n?"true":"false")?gs.INSTANCE:Ns.INSTANCE:new hT(e,t,i)}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=5}cmp(e){return e.type!==this.type?this.type-e.type:Kf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){const e=An.get(this.key);if(typeof e=="boolean"){const t=e?"true":"false";return this.value===t?gs.INSTANCE:Ns.INSTANCE}return this}evaluate(e){return e.getValue(this.key)!=this.value}serialize(){return`${this.key} != '${this.value}'`}keys(){return[this.key]}negate(){return this.negated||(this.negated=sb.create(this.key,this.value,this)),this.negated}}class $f{static create(e,t=null){const i=An.get(e);return typeof i=="boolean"?i?gs.INSTANCE:Ns.INSTANCE:new $f(e,t)}constructor(e,t){this.key=e,this.negated=t,this.type=3}cmp(e){return e.type!==this.type?this.type-e.type:rU(this.key,e.key)}equals(e){return e.type===this.type?this.key===e.key:!1}substituteConstants(){const e=An.get(this.key);return typeof e=="boolean"?e?gs.INSTANCE:Ns.INSTANCE:this}evaluate(e){return!e.getValue(this.key)}serialize(){return`!${this.key}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=Gf.create(this.key,this)),this.negated}}function uT(o,e){if(typeof o=="string"){const t=parseFloat(o);isNaN(t)||(o=t)}return typeof o=="string"||typeof o=="number"?e(o):gs.INSTANCE}class gT{static create(e,t,i=null){return uT(t,n=>new gT(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=12}cmp(e){return e.type!==this.type?this.type-e.type:Kf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>this.value}serialize(){return`${this.key} > ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=mT.create(this.key,this.value,this)),this.negated}}class fT{static create(e,t,i=null){return uT(t,n=>new fT(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=13}cmp(e){return e.type!==this.type?this.type-e.type:Kf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))>=this.value}serialize(){return`${this.key} >= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=pT.create(this.key,this.value,this)),this.negated}}class pT{static create(e,t,i=null){return uT(t,n=>new pT(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=14}cmp(e){return e.type!==this.type?this.type-e.type:Kf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<this.value}serialize(){return`${this.key} < ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=fT.create(this.key,this.value,this)),this.negated}}class mT{static create(e,t,i=null){return uT(t,n=>new mT(e,n,i))}constructor(e,t,i){this.key=e,this.value=t,this.negated=i,this.type=15}cmp(e){return e.type!==this.type?this.type-e.type:Kf(this.key,this.value,e.key,e.value)}equals(e){return e.type===this.type?this.key===e.key&&this.value===e.value:!1}substituteConstants(){return this}evaluate(e){return typeof this.value=="string"?!1:parseFloat(e.getValue(this.key))<=this.value}serialize(){return`${this.key} <= ${this.value}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=gT.create(this.key,this.value,this)),this.negated}}class XC{static create(e,t){return new XC(e,t)}constructor(e,t){this.key=e,this.regexp=t,this.type=7,this.negated=null}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.key<e.key)return-1;if(this.key>e.key)return 1;const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return t<i?-1:t>i?1:0}equals(e){if(e.type===this.type){const t=this.regexp?this.regexp.source:"",i=e.regexp?e.regexp.source:"";return this.key===e.key&&t===i}return!1}substituteConstants(){return this}evaluate(e){const t=e.getValue(this.key);return this.regexp?this.regexp.test(t):!1}serialize(){const e=this.regexp?`/${this.regexp.source}/${this.regexp.flags}`:"/invalid/";return`${this.key} =~ ${e}`}keys(){return[this.key]}negate(){return this.negated||(this.negated=K4.create(this)),this.negated}}class K4{static create(e){return new K4(e)}constructor(e){this._actual=e,this.type=8}cmp(e){return e.type!==this.type?this.type-e.type:this._actual.cmp(e._actual)}equals(e){return e.type===this.type?this._actual.equals(e._actual):!1}substituteConstants(){return this}evaluate(e){return!this._actual.evaluate(e)}serialize(){return`!(${this._actual.serialize()})`}keys(){return this._actual.keys()}negate(){return this._actual}}function oU(o){let e=null;for(let t=0,i=o.length;t<i;t++){const n=o[t].substituteConstants();if(o[t]!==n&&e===null){e=[];for(let s=0;s<t;s++)e[s]=o[s]}e!==null&&(e[t]=n)}return e===null?o:e}class Xu{static create(e,t,i){return Xu._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=6}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=Ov(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=oU(this.expr);return e===this.expr?this:Xu.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].evaluate(e))return!1;return!0}static _normalizeArr(e,t,i){const n=[];let s=!1;for(const r of e)if(r){if(r.type===1){s=!0;continue}if(r.type===0)return gs.INSTANCE;if(r.type===6){n.push(...r.expr);continue}n.push(r)}if(n.length===0&&s)return Ns.INSTANCE;if(n.length!==0){if(n.length===1)return n[0];n.sort(Ov);for(let r=1;r<n.length;r++)n[r-1].equals(n[r])&&(n.splice(r,1),r--);if(n.length===1)return n[0];for(;n.length>1;){const r=n[n.length-1];if(r.type!==9)break;n.pop();const a=n.pop(),l=n.length===0,c=vc.create(r.expr.map(d=>Xu.create([d,a],null,i)),null,l);c&&(n.push(c),n.sort(Ov))}if(n.length===1)return n[0];if(i){for(let r=0;r<n.length;r++)for(let a=r+1;a<n.length;a++)if(n[r].negate().equals(n[a]))return gs.INSTANCE;if(n.length===1)return n[0]}return new Xu(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" && ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());this.negated=vc.create(e,this,!0)}return this.negated}}class vc{static create(e,t,i){return vc._normalizeArr(e,t,i)}constructor(e,t){this.expr=e,this.negated=t,this.type=9}cmp(e){if(e.type!==this.type)return this.type-e.type;if(this.expr.length<e.expr.length)return-1;if(this.expr.length>e.expr.length)return 1;for(let t=0,i=this.expr.length;t<i;t++){const n=Ov(this.expr[t],e.expr[t]);if(n!==0)return n}return 0}equals(e){if(e.type===this.type){if(this.expr.length!==e.expr.length)return!1;for(let t=0,i=this.expr.length;t<i;t++)if(!this.expr[t].equals(e.expr[t]))return!1;return!0}return!1}substituteConstants(){const e=oU(this.expr);return e===this.expr?this:vc.create(e,this.negated,!1)}evaluate(e){for(let t=0,i=this.expr.length;t<i;t++)if(this.expr[t].evaluate(e))return!0;return!1}static _normalizeArr(e,t,i){let n=[],s=!1;if(e){for(let r=0,a=e.length;r<a;r++){const l=e[r];if(l){if(l.type===0){s=!0;continue}if(l.type===1)return Ns.INSTANCE;if(l.type===9){n=n.concat(l.expr);continue}n.push(l)}}if(n.length===0&&s)return gs.INSTANCE;n.sort(Ov)}if(n.length!==0){if(n.length===1)return n[0];for(let r=1;r<n.length;r++)n[r-1].equals(n[r])&&(n.splice(r,1),r--);if(n.length===1)return n[0];if(i){for(let r=0;r<n.length;r++)for(let a=r+1;a<n.length;a++)if(n[r].negate().equals(n[a]))return Ns.INSTANCE;if(n.length===1)return n[0]}return new vc(n,t)}}serialize(){return this.expr.map(e=>e.serialize()).join(" || ")}keys(){const e=[];for(const t of this.expr)e.push(...t.keys());return e}negate(){if(!this.negated){const e=[];for(const t of this.expr)e.push(t.negate());for(;e.length>1;){const t=e.shift(),i=e.shift(),n=[];for(const s of $3(t))for(const r of $3(i))n.push(Xu.create([s,r],null,!1));e.unshift(vc.create(n,null,!1))}this.negated=vc.create(e,this,!0)}return this.negated}}const mm=class mm extends Gf{static all(){return mm._info.values()}constructor(e,t,i){super(e,null),this._defaultValue=t,typeof i=="object"?mm._info.push({...i,key:e}):i!==!0&&mm._info.push({key:e,description:i,type:t!=null?typeof t:void 0})}bindTo(e){return e.createKey(this.key,this._defaultValue)}getValue(e){return e.getContextKeyValue(this.key)}toNegated(){return this.negate()}isEqualTo(e){return sb.create(this.key,e)}};mm._info=[];let re=mm;const Ee=Je("contextKeyService");function rU(o,e){return o<e?-1:o>e?1:0}function Kf(o,e,t,i){return o<t?-1:o>t?1:e<i?-1:e>i?1:0}function mP(o,e){if(o.type===0||e.type===1)return!0;if(o.type===9)return e.type===9?G3(o.expr,e.expr):!1;if(e.type===9){for(const t of e.expr)if(mP(o,t))return!0;return!1}if(o.type===6){if(e.type===6)return G3(e.expr,o.expr);for(const t of o.expr)if(mP(t,e))return!0;return!1}return o.equals(e)}function G3(o,e){let t=0,i=0;for(;t<o.length&&i<e.length;){const n=o[t].cmp(e[i]);if(n<0)return!1;n===0&&t++,i++}return t===o.length}function $3(o){return o.type===9?o.expr:[o]}function oI(o,e){if(!o)throw new Error(e?`Assertion failed (${e})`:"Assertion Failed")}function _T(o,e="Unreachable"){throw new Error(e)}function K3(o){o||Ae(new pt("Soft Assertion Failed"))}function yf(o){if(!o()){debugger;o(),Ae(new pt("Assertion Failed"))}}function j4(o,e){let t=0;for(;t<o.length-1;){const i=o[t],n=o[t+1];if(!e(i,n))return!1;t++}return!0}class Mee{constructor(){this.data=new Map}add(e,t){oI(Ds(e)),oI(nn(t)),oI(!this.data.has(e),"There is already an extension with this id"),this.data.set(e,t)}as(e){return this.data.get(e)||null}}const ai=new Mee;class q4{constructor(){this._coreKeybindings=new os,this._extensionKeybindings=[],this._cachedMergedKeybindings=null}static bindToCurrentPlatform(e){if(Js===1){if(e&&e.win)return e.win}else if(Js===2){if(e&&e.mac)return e.mac}else if(e&&e.linux)return e.linux;return e}registerKeybindingRule(e){const t=q4.bindToCurrentPlatform(e),i=new $;if(t&&t.primary){const n=iP(t.primary,Js);n&&i.add(this._registerDefaultKeybinding(n,e.id,e.args,e.weight,0,e.when))}if(t&&Array.isArray(t.secondary))for(let n=0,s=t.secondary.length;n<s;n++){const r=t.secondary[n],a=iP(r,Js);a&&i.add(this._registerDefaultKeybinding(a,e.id,e.args,e.weight,-n-1,e.when))}return i}registerCommandAndKeybindingRule(e){return Wr(this.registerKeybindingRule(e),st.registerCommand(e))}_registerDefaultKeybinding(e,t,i,n,s,r){const a=this._coreKeybindings.push({keybinding:e,command:t,commandArgs:i,when:r,weight1:n,weight2:s,extensionId:null,isBuiltinExtension:!1});return this._cachedMergedKeybindings=null,ve(()=>{a(),this._cachedMergedKeybindings=null})}getDefaultKeybindings(){return this._cachedMergedKeybindings||(this._cachedMergedKeybindings=Array.from(this._coreKeybindings).concat(this._extensionKeybindings),this._cachedMergedKeybindings.sort(Fee)),this._cachedMergedKeybindings.slice(0)}}const fs=new q4,Oee={EditorModes:"platform.keybindingsRegistry"};ai.add(Oee.EditorModes,fs);function Fee(o,e){if(o.weight1!==e.weight1)return o.weight1-e.weight1;if(o.command&&e.command){if(o.command<e.command)return-1;if(o.command>e.command)return 1}return o.weight2-e.weight2}var Bee=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},j3=function(o,e){return function(t,i){e(t,i,o)}},N1;function Rm(o){return o.command!==void 0}function Wee(o){return o.submenu!==void 0}const I=class I{constructor(e){if(I._instances.has(e))throw new TypeError(`MenuId with identifier '${e}' already exists. Use MenuId.for(ident) or a unique identifier`);I._instances.set(e,this),this.id=e}};I._instances=new Map,I.CommandPalette=new I("CommandPalette"),I.DebugBreakpointsContext=new I("DebugBreakpointsContext"),I.DebugCallStackContext=new I("DebugCallStackContext"),I.DebugConsoleContext=new I("DebugConsoleContext"),I.DebugVariablesContext=new I("DebugVariablesContext"),I.NotebookVariablesContext=new I("NotebookVariablesContext"),I.DebugHoverContext=new I("DebugHoverContext"),I.DebugWatchContext=new I("DebugWatchContext"),I.DebugToolBar=new I("DebugToolBar"),I.DebugToolBarStop=new I("DebugToolBarStop"),I.DebugCallStackToolbar=new I("DebugCallStackToolbar"),I.DebugCreateConfiguration=new I("DebugCreateConfiguration"),I.EditorContext=new I("EditorContext"),I.SimpleEditorContext=new I("SimpleEditorContext"),I.EditorContent=new I("EditorContent"),I.EditorLineNumberContext=new I("EditorLineNumberContext"),I.EditorContextCopy=new I("EditorContextCopy"),I.EditorContextPeek=new I("EditorContextPeek"),I.EditorContextShare=new I("EditorContextShare"),I.EditorTitle=new I("EditorTitle"),I.EditorTitleRun=new I("EditorTitleRun"),I.EditorTitleContext=new I("EditorTitleContext"),I.EditorTitleContextShare=new I("EditorTitleContextShare"),I.EmptyEditorGroup=new I("EmptyEditorGroup"),I.EmptyEditorGroupContext=new I("EmptyEditorGroupContext"),I.EditorTabsBarContext=new I("EditorTabsBarContext"),I.EditorTabsBarShowTabsSubmenu=new I("EditorTabsBarShowTabsSubmenu"),I.EditorTabsBarShowTabsZenModeSubmenu=new I("EditorTabsBarShowTabsZenModeSubmenu"),I.EditorActionsPositionSubmenu=new I("EditorActionsPositionSubmenu"),I.ExplorerContext=new I("ExplorerContext"),I.ExplorerContextShare=new I("ExplorerContextShare"),I.ExtensionContext=new I("ExtensionContext"),I.GlobalActivity=new I("GlobalActivity"),I.CommandCenter=new I("CommandCenter"),I.CommandCenterCenter=new I("CommandCenterCenter"),I.LayoutControlMenuSubmenu=new I("LayoutControlMenuSubmenu"),I.LayoutControlMenu=new I("LayoutControlMenu"),I.MenubarMainMenu=new I("MenubarMainMenu"),I.MenubarAppearanceMenu=new I("MenubarAppearanceMenu"),I.MenubarDebugMenu=new I("MenubarDebugMenu"),I.MenubarEditMenu=new I("MenubarEditMenu"),I.MenubarCopy=new I("MenubarCopy"),I.MenubarFileMenu=new I("MenubarFileMenu"),I.MenubarGoMenu=new I("MenubarGoMenu"),I.MenubarHelpMenu=new I("MenubarHelpMenu"),I.MenubarLayoutMenu=new I("MenubarLayoutMenu"),I.MenubarNewBreakpointMenu=new I("MenubarNewBreakpointMenu"),I.PanelAlignmentMenu=new I("PanelAlignmentMenu"),I.PanelPositionMenu=new I("PanelPositionMenu"),I.ActivityBarPositionMenu=new I("ActivityBarPositionMenu"),I.MenubarPreferencesMenu=new I("MenubarPreferencesMenu"),I.MenubarRecentMenu=new I("MenubarRecentMenu"),I.MenubarSelectionMenu=new I("MenubarSelectionMenu"),I.MenubarShare=new I("MenubarShare"),I.MenubarSwitchEditorMenu=new I("MenubarSwitchEditorMenu"),I.MenubarSwitchGroupMenu=new I("MenubarSwitchGroupMenu"),I.MenubarTerminalMenu=new I("MenubarTerminalMenu"),I.MenubarViewMenu=new I("MenubarViewMenu"),I.MenubarHomeMenu=new I("MenubarHomeMenu"),I.OpenEditorsContext=new I("OpenEditorsContext"),I.OpenEditorsContextShare=new I("OpenEditorsContextShare"),I.ProblemsPanelContext=new I("ProblemsPanelContext"),I.SCMInputBox=new I("SCMInputBox"),I.SCMChangesSeparator=new I("SCMChangesSeparator"),I.SCMChangesContext=new I("SCMChangesContext"),I.SCMIncomingChanges=new I("SCMIncomingChanges"),I.SCMIncomingChangesContext=new I("SCMIncomingChangesContext"),I.SCMIncomingChangesSetting=new I("SCMIncomingChangesSetting"),I.SCMOutgoingChanges=new I("SCMOutgoingChanges"),I.SCMOutgoingChangesContext=new I("SCMOutgoingChangesContext"),I.SCMOutgoingChangesSetting=new I("SCMOutgoingChangesSetting"),I.SCMIncomingChangesAllChangesContext=new I("SCMIncomingChangesAllChangesContext"),I.SCMIncomingChangesHistoryItemContext=new I("SCMIncomingChangesHistoryItemContext"),I.SCMOutgoingChangesAllChangesContext=new I("SCMOutgoingChangesAllChangesContext"),I.SCMOutgoingChangesHistoryItemContext=new I("SCMOutgoingChangesHistoryItemContext"),I.SCMChangeContext=new I("SCMChangeContext"),I.SCMResourceContext=new I("SCMResourceContext"),I.SCMResourceContextShare=new I("SCMResourceContextShare"),I.SCMResourceFolderContext=new I("SCMResourceFolderContext"),I.SCMResourceGroupContext=new I("SCMResourceGroupContext"),I.SCMSourceControl=new I("SCMSourceControl"),I.SCMSourceControlInline=new I("SCMSourceControlInline"),I.SCMSourceControlTitle=new I("SCMSourceControlTitle"),I.SCMHistoryTitle=new I("SCMHistoryTitle"),I.SCMTitle=new I("SCMTitle"),I.SearchContext=new I("SearchContext"),I.SearchActionMenu=new I("SearchActionContext"),I.StatusBarWindowIndicatorMenu=new I("StatusBarWindowIndicatorMenu"),I.StatusBarRemoteIndicatorMenu=new I("StatusBarRemoteIndicatorMenu"),I.StickyScrollContext=new I("StickyScrollContext"),I.TestItem=new I("TestItem"),I.TestItemGutter=new I("TestItemGutter"),I.TestProfilesContext=new I("TestProfilesContext"),I.TestMessageContext=new I("TestMessageContext"),I.TestMessageContent=new I("TestMessageContent"),I.TestPeekElement=new I("TestPeekElement"),I.TestPeekTitle=new I("TestPeekTitle"),I.TestCallStack=new I("TestCallStack"),I.TouchBarContext=new I("TouchBarContext"),I.TitleBarContext=new I("TitleBarContext"),I.TitleBarTitleContext=new I("TitleBarTitleContext"),I.TunnelContext=new I("TunnelContext"),I.TunnelPrivacy=new I("TunnelPrivacy"),I.TunnelProtocol=new I("TunnelProtocol"),I.TunnelPortInline=new I("TunnelInline"),I.TunnelTitle=new I("TunnelTitle"),I.TunnelLocalAddressInline=new I("TunnelLocalAddressInline"),I.TunnelOriginInline=new I("TunnelOriginInline"),I.ViewItemContext=new I("ViewItemContext"),I.ViewContainerTitle=new I("ViewContainerTitle"),I.ViewContainerTitleContext=new I("ViewContainerTitleContext"),I.ViewTitle=new I("ViewTitle"),I.ViewTitleContext=new I("ViewTitleContext"),I.CommentEditorActions=new I("CommentEditorActions"),I.CommentThreadTitle=new I("CommentThreadTitle"),I.CommentThreadActions=new I("CommentThreadActions"),I.CommentThreadAdditionalActions=new I("CommentThreadAdditionalActions"),I.CommentThreadTitleContext=new I("CommentThreadTitleContext"),I.CommentThreadCommentContext=new I("CommentThreadCommentContext"),I.CommentTitle=new I("CommentTitle"),I.CommentActions=new I("CommentActions"),I.CommentsViewThreadActions=new I("CommentsViewThreadActions"),I.InteractiveToolbar=new I("InteractiveToolbar"),I.InteractiveCellTitle=new I("InteractiveCellTitle"),I.InteractiveCellDelete=new I("InteractiveCellDelete"),I.InteractiveCellExecute=new I("InteractiveCellExecute"),I.InteractiveInputExecute=new I("InteractiveInputExecute"),I.InteractiveInputConfig=new I("InteractiveInputConfig"),I.ReplInputExecute=new I("ReplInputExecute"),I.IssueReporter=new I("IssueReporter"),I.NotebookToolbar=new I("NotebookToolbar"),I.NotebookStickyScrollContext=new I("NotebookStickyScrollContext"),I.NotebookCellTitle=new I("NotebookCellTitle"),I.NotebookCellDelete=new I("NotebookCellDelete"),I.NotebookCellInsert=new I("NotebookCellInsert"),I.NotebookCellBetween=new I("NotebookCellBetween"),I.NotebookCellListTop=new I("NotebookCellTop"),I.NotebookCellExecute=new I("NotebookCellExecute"),I.NotebookCellExecuteGoTo=new I("NotebookCellExecuteGoTo"),I.NotebookCellExecutePrimary=new I("NotebookCellExecutePrimary"),I.NotebookDiffCellInputTitle=new I("NotebookDiffCellInputTitle"),I.NotebookDiffCellMetadataTitle=new I("NotebookDiffCellMetadataTitle"),I.NotebookDiffCellOutputsTitle=new I("NotebookDiffCellOutputsTitle"),I.NotebookOutputToolbar=new I("NotebookOutputToolbar"),I.NotebookOutlineFilter=new I("NotebookOutlineFilter"),I.NotebookOutlineActionMenu=new I("NotebookOutlineActionMenu"),I.NotebookEditorLayoutConfigure=new I("NotebookEditorLayoutConfigure"),I.NotebookKernelSource=new I("NotebookKernelSource"),I.BulkEditTitle=new I("BulkEditTitle"),I.BulkEditContext=new I("BulkEditContext"),I.TimelineItemContext=new I("TimelineItemContext"),I.TimelineTitle=new I("TimelineTitle"),I.TimelineTitleContext=new I("TimelineTitleContext"),I.TimelineFilterSubMenu=new I("TimelineFilterSubMenu"),I.AccountsContext=new I("AccountsContext"),I.SidebarTitle=new I("SidebarTitle"),I.PanelTitle=new I("PanelTitle"),I.AuxiliaryBarTitle=new I("AuxiliaryBarTitle"),I.AuxiliaryBarHeader=new I("AuxiliaryBarHeader"),I.TerminalInstanceContext=new I("TerminalInstanceContext"),I.TerminalEditorInstanceContext=new I("TerminalEditorInstanceContext"),I.TerminalNewDropdownContext=new I("TerminalNewDropdownContext"),I.TerminalTabContext=new I("TerminalTabContext"),I.TerminalTabEmptyAreaContext=new I("TerminalTabEmptyAreaContext"),I.TerminalStickyScrollContext=new I("TerminalStickyScrollContext"),I.WebviewContext=new I("WebviewContext"),I.InlineCompletionsActions=new I("InlineCompletionsActions"),I.InlineEditsActions=new I("InlineEditsActions"),I.InlineEditActions=new I("InlineEditActions"),I.NewFile=new I("NewFile"),I.MergeInput1Toolbar=new I("MergeToolbar1Toolbar"),I.MergeInput2Toolbar=new I("MergeToolbar2Toolbar"),I.MergeBaseToolbar=new I("MergeBaseToolbar"),I.MergeInputResultToolbar=new I("MergeToolbarResultToolbar"),I.InlineSuggestionToolbar=new I("InlineSuggestionToolbar"),I.InlineEditToolbar=new I("InlineEditToolbar"),I.ChatContext=new I("ChatContext"),I.ChatCodeBlock=new I("ChatCodeblock"),I.ChatCompareBlock=new I("ChatCompareBlock"),I.ChatMessageTitle=new I("ChatMessageTitle"),I.ChatExecute=new I("ChatExecute"),I.ChatExecuteSecondary=new I("ChatExecuteSecondary"),I.ChatInputSide=new I("ChatInputSide"),I.AccessibleView=new I("AccessibleView"),I.MultiDiffEditorFileToolbar=new I("MultiDiffEditorFileToolbar"),I.DiffEditorHunkToolbar=new I("DiffEditorHunkToolbar"),I.DiffEditorSelectionToolbar=new I("DiffEditorSelectionToolbar");let fe=I;const zo=Je("menuService"),wC=class wC{static for(e){let t=this._all.get(e);return t||(t=new wC(e),this._all.set(e,t)),t}static merge(e){const t=new Set;for(const i of e)i instanceof wC&&t.add(i.id);return t}constructor(e){this.id=e,this.has=t=>t===e}};wC._all=new Map;let Nu=wC;const sn=new class{constructor(){this._commands=new Map,this._menuItems=new Map,this._onDidChangeMenu=new tQ({merge:Nu.merge}),this.onDidChangeMenu=this._onDidChangeMenu.event}addCommand(o){return this._commands.set(o.id,o),this._onDidChangeMenu.fire(Nu.for(fe.CommandPalette)),ve(()=>{this._commands.delete(o.id)&&this._onDidChangeMenu.fire(Nu.for(fe.CommandPalette))})}getCommand(o){return this._commands.get(o)}getCommands(){const o=new Map;return this._commands.forEach((e,t)=>o.set(t,e)),o}appendMenuItem(o,e){let t=this._menuItems.get(o);t||(t=new os,this._menuItems.set(o,t));const i=t.push(e);return this._onDidChangeMenu.fire(Nu.for(o)),ve(()=>{i(),this._onDidChangeMenu.fire(Nu.for(o))})}appendMenuItems(o){const e=new $;for(const{id:t,item:i}of o)e.add(this.appendMenuItem(t,i));return e}getMenuItems(o){let e;return this._menuItems.has(o)?e=[...this._menuItems.get(o)]:e=[],o===fe.CommandPalette&&this._appendImplicitItems(e),e}_appendImplicitItems(o){const e=new Set;for(const t of o)Rm(t)&&(e.add(t.command.id),t.alt&&e.add(t.alt.id));this._commands.forEach((t,i)=>{e.has(i)||o.push({command:t})})}};class Pm extends m_{constructor(e,t,i){super(`submenuitem.${e.submenu.id}`,typeof e.title=="string"?e.title:e.title.value,i,"submenu"),this.item=e,this.hideActions=t}}let io=N1=class{static label(e,t){return t?.renderShortTitle&&e.shortTitle?typeof e.shortTitle=="string"?e.shortTitle:e.shortTitle.value:typeof e.title=="string"?e.title:e.title.value}constructor(e,t,i,n,s,r,a){this.hideActions=n,this.menuKeybinding=s,this._commandService=a,this.id=e.id,this.label=N1.label(e,i),this.tooltip=(typeof e.tooltip=="string"?e.tooltip:e.tooltip?.value)??"",this.enabled=!e.precondition||r.contextMatchesRules(e.precondition),this.checked=void 0;let l;if(e.toggled){const c=e.toggled.condition?e.toggled:{condition:e.toggled};this.checked=r.contextMatchesRules(c.condition),this.checked&&c.tooltip&&(this.tooltip=typeof c.tooltip=="string"?c.tooltip:c.tooltip.value),this.checked&&ke.isThemeIcon(c.icon)&&(l=c.icon),this.checked&&c.title&&(this.label=typeof c.title=="string"?c.title:c.title.value)}l||(l=ke.isThemeIcon(e.icon)?e.icon:void 0),this.item=e,this.alt=t?new N1(t,void 0,i,n,void 0,r,a):void 0,this._options=i,this.class=l&&ke.asClassName(l)}run(...e){let t=[];return this._options?.arg&&(t=[...t,this._options.arg]),this._options?.shouldForwardArgs&&(t=[...t,...e]),this._commandService.executeCommand(this.id,...t)}};io=N1=Bee([j3(5,Ee),j3(6,Ft)],io);class _s{constructor(e){this.desc=e}}function At(o){const e=[],t=new o,{f1:i,menu:n,keybinding:s,...r}=t.desc;if(st.getCommand(r.id))throw new Error(`Cannot register two commands with the same id: ${r.id}`);if(e.push(st.registerCommand({id:r.id,handler:(a,...l)=>t.run(a,...l),metadata:r.metadata})),Array.isArray(n))for(const a of n)e.push(sn.appendMenuItem(a.id,{command:{...r,precondition:a.precondition===null?void 0:r.precondition},...a}));else n&&e.push(sn.appendMenuItem(n.id,{command:{...r,precondition:n.precondition===null?void 0:r.precondition},...n}));if(i&&(e.push(sn.appendMenuItem(fe.CommandPalette,{command:r,when:r.precondition})),e.push(sn.addCommand(r))),Array.isArray(s))for(const a of s)e.push(fs.registerKeybindingRule({...a,id:r.id,when:r.precondition?K.and(r.precondition,a.when):a.when}));else s&&e.push(fs.registerKeybindingRule({...s,id:r.id,when:r.precondition?K.and(r.precondition,s.when):s.when}));return{dispose(){Dt(e)}}}const Fn=Je("telemetryService"),Tn=Je("logService");var Ls;(function(o){o[o.Off=0]="Off",o[o.Trace=1]="Trace",o[o.Debug=2]="Debug",o[o.Info=3]="Info",o[o.Warning=4]="Warning",o[o.Error=5]="Error"})(Ls||(Ls={}));const aU=Ls.Info;class lU extends F{constructor(){super(...arguments),this.level=aU,this._onDidChangeLogLevel=this._register(new O),this.onDidChangeLogLevel=this._onDidChangeLogLevel.event}setLevel(e){this.level!==e&&(this.level=e,this._onDidChangeLogLevel.fire(this.level))}getLevel(){return this.level}checkLogLevel(e){return this.level!==Ls.Off&&this.level<=e}}class Vee extends lU{constructor(e=aU,t=!0){super(),this.useColors=t,this.setLevel(e)}trace(e,...t){this.checkLogLevel(Ls.Trace)&&(this.useColors?console.log("%cTRACE","color: #888",e,...t):console.log(e,...t))}debug(e,...t){this.checkLogLevel(Ls.Debug)&&(this.useColors?console.log("%cDEBUG","background: #eee; color: #888",e,...t):console.log(e,...t))}info(e,...t){this.checkLogLevel(Ls.Info)&&(this.useColors?console.log("%c INFO","color: #33f",e,...t):console.log(e,...t))}warn(e,...t){this.checkLogLevel(Ls.Warning)&&(this.useColors?console.log("%c WARN","color: #993",e,...t):console.log(e,...t))}error(e,...t){this.checkLogLevel(Ls.Error)&&(this.useColors?console.log("%c  ERR","color: #f33",e,...t):console.error(e,...t))}}class Hee extends lU{constructor(e){super(),this.loggers=e,e.length&&this.setLevel(e[0].getLevel())}setLevel(e){for(const t of this.loggers)t.setLevel(e);super.setLevel(e)}trace(e,...t){for(const i of this.loggers)i.trace(e,...t)}debug(e,...t){for(const i of this.loggers)i.debug(e,...t)}info(e,...t){for(const i of this.loggers)i.info(e,...t)}warn(e,...t){for(const i of this.loggers)i.warn(e,...t)}error(e,...t){for(const i of this.loggers)i.error(e,...t)}dispose(){for(const e of this.loggers)e.dispose();super.dispose()}}function zee(o){switch(o){case Ls.Trace:return"trace";case Ls.Debug:return"debug";case Ls.Info:return"info";case Ls.Warning:return"warn";case Ls.Error:return"error";case Ls.Off:return"off"}}new re("logLevel",zee(Ls.Info));class bT{constructor(e){this.id=e.id,this.precondition=e.precondition,this._kbOpts=e.kbOpts,this._menuOpts=e.menuOpts,this.metadata=e.metadata}register(){if(Array.isArray(this._menuOpts)?this._menuOpts.forEach(this._registerMenuItem,this):this._menuOpts&&this._registerMenuItem(this._menuOpts),this._kbOpts){const e=Array.isArray(this._kbOpts)?this._kbOpts:[this._kbOpts];for(const t of e){let i=t.kbExpr;this.precondition&&(i?i=K.and(i,this.precondition):i=this.precondition);const n={id:this.id,weight:t.weight,args:t.args,when:i,primary:t.primary,secondary:t.secondary,win:t.win,linux:t.linux,mac:t.mac};fs.registerKeybindingRule(n)}}st.registerCommand({id:this.id,handler:(e,t)=>this.runCommand(e,t),metadata:this.metadata})}_registerMenuItem(e){sn.appendMenuItem(e.menuId,{group:e.group,command:{id:this.id,title:e.title,icon:e.icon,precondition:this.precondition},when:e.when,order:e.order})}}class ob extends bT{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t,i,n){return this._implementations.push({priority:e,name:t,implementation:i,when:n}),this._implementations.sort((s,r)=>r.priority-s.priority),{dispose:()=>{for(let s=0;s<this._implementations.length;s++)if(this._implementations[s].implementation===i){this._implementations.splice(s,1);return}}}}runCommand(e,t){const i=e.get(Tn),n=e.get(Ee);i.trace(`Executing Command '${this.id}' which has ${this._implementations.length} bound.`);for(const s of this._implementations){if(s.when){const a=n.getContext(Ln());if(!s.when.evaluate(a))continue}const r=s.implementation(e,t);if(r)return i.trace(`Command '${this.id}' was handled by '${s.name}'.`),typeof r=="boolean"?void 0:r}i.trace(`The Command '${this.id}' was not handled by any implementation.`)}}class cU extends bT{constructor(e,t){super(t),this.command=e}runCommand(e,t){return this.command.runCommand(e,t)}}class Hi extends bT{static bindToContribution(e){return class extends Hi{constructor(i){super(i),this._callback=i.handler}runEditorCommand(i,n,s){const r=e(n);r&&this._callback(r,s)}}}static runEditorCommand(e,t,i,n){const s=e.get(gt),r=s.getFocusedCodeEditor()||s.getActiveCodeEditor();if(r)return r.invokeWithinContext(a=>{if(a.get(Ee).contextMatchesRules(i??void 0))return n(a,r,t)})}runCommand(e,t){return Hi.runEditorCommand(e,t,this.precondition,(i,n,s)=>this.runEditorCommand(i,n,s))}}class de extends Hi{static convertOptions(e){let t;Array.isArray(e.menuOpts)?t=e.menuOpts:e.menuOpts?t=[e.menuOpts]:t=[];function i(n){return n.menuId||(n.menuId=fe.EditorContext),n.title||(n.title=e.label),n.when=K.and(e.precondition,n.when),n}return Array.isArray(e.contextMenuOpts)?t.push(...e.contextMenuOpts.map(i)):e.contextMenuOpts&&t.push(i(e.contextMenuOpts)),e.menuOpts=t,e}constructor(e){super(de.convertOptions(e)),this.label=e.label,this.alias=e.alias}runEditorCommand(e,t,i){return this.reportTelemetry(e,t),this.run(e,t,i||{})}reportTelemetry(e,t){e.get(Fn).publicLog2("editorActionInvoked",{name:this.label,id:this.id})}}class dU extends de{constructor(){super(...arguments),this._implementations=[]}addImplementation(e,t){return this._implementations.push([e,t]),this._implementations.sort((i,n)=>n[0]-i[0]),{dispose:()=>{for(let i=0;i<this._implementations.length;i++)if(this._implementations[i][1]===t){this._implementations.splice(i,1);return}}}}run(e,t,i){for(const n of this._implementations){const s=n[1](e,t,i);if(s)return typeof s=="boolean"?void 0:s}}}class Fa extends _s{run(e,...t){const i=e.get(gt),n=i.getFocusedCodeEditor()||i.getActiveCodeEditor();if(n)return n.invokeWithinContext(s=>{const r=s.get(Ee),a=s.get(Tn);if(!r.contextMatchesRules(this.desc.precondition??void 0)){a.debug("[EditorAction2] NOT running command because its precondition is FALSE",this.desc.id,this.desc.precondition?.serialize());return}return this.runEditorCommand(s,n,...t)})}}function Os(o,e){st.registerCommand(o,function(t,...i){const n=t.get(Ce),[s,r]=i;ut(ye.isUri(s)),ut(A.isIPosition(r));const a=t.get(Ut).getModel(s);if(a){const l=A.lift(r);return n.invokeFunction(e,a,l,...i.slice(2))}return t.get(Ms).createModelReference(s).then(l=>new Promise((c,d)=>{try{const h=n.invokeFunction(e,l.object.textEditorModel,A.lift(r),i.slice(2));c(h)}catch(h){d(h)}}).finally(()=>{l.dispose()}))})}function oe(o){return nr.INSTANCE.registerEditorCommand(o),o}function X(o){const e=new o;return nr.INSTANCE.registerEditorAction(e),e}function hU(o){return nr.INSTANCE.registerEditorAction(o),o}function Uee(o){nr.INSTANCE.registerEditorAction(o)}function at(o,e,t){nr.INSTANCE.registerEditorContribution(o,e,t)}var lg;(function(o){function e(r){return nr.INSTANCE.getEditorCommand(r)}o.getEditorCommand=e;function t(){return nr.INSTANCE.getEditorActions()}o.getEditorActions=t;function i(){return nr.INSTANCE.getEditorContributions()}o.getEditorContributions=i;function n(r){return nr.INSTANCE.getEditorContributions().filter(a=>r.indexOf(a.id)>=0)}o.getSomeEditorContributions=n;function s(){return nr.INSTANCE.getDiffEditorContributions()}o.getDiffEditorContributions=s})(lg||(lg={}));const Gee={EditorCommonContributions:"editor.contributions"},wk=class wk{constructor(){this.editorContributions=[],this.diffEditorContributions=[],this.editorActions=[],this.editorCommands=Object.create(null)}registerEditorContribution(e,t,i){this.editorContributions.push({id:e,ctor:t,instantiation:i})}getEditorContributions(){return this.editorContributions.slice(0)}getDiffEditorContributions(){return this.diffEditorContributions.slice(0)}registerEditorAction(e){e.register(),this.editorActions.push(e)}getEditorActions(){return this.editorActions}registerEditorCommand(e){e.register(),this.editorCommands[e.id]=e}getEditorCommand(e){return this.editorCommands[e]||null}};wk.INSTANCE=new wk;let nr=wk;ai.add(Gee.EditorCommonContributions,nr.INSTANCE);function kw(o){return o.register(),o}const uU=kw(new ob({id:"undo",precondition:void 0,kbOpts:{weight:0,primary:2104},menuOpts:[{menuId:fe.MenubarEditMenu,group:"1_do",title:p({key:"miUndo",comment:["&& denotes a mnemonic"]},"&&Undo"),order:1},{menuId:fe.CommandPalette,group:"",title:p("undo","Undo"),order:1}]}));kw(new cU(uU,{id:"default:undo",precondition:void 0}));const gU=kw(new ob({id:"redo",precondition:void 0,kbOpts:{weight:0,primary:2103,secondary:[3128],mac:{primary:3128}},menuOpts:[{menuId:fe.MenubarEditMenu,group:"1_do",title:p({key:"miRedo",comment:["&& denotes a mnemonic"]},"&&Redo"),order:2},{menuId:fe.CommandPalette,group:"",title:p("redo","Redo"),order:1}]}));kw(new cU(gU,{id:"default:redo",precondition:void 0}));const $ee=kw(new ob({id:"editor.action.selectAll",precondition:void 0,kbOpts:{weight:0,kbExpr:null,primary:2079},menuOpts:[{menuId:fe.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSelectAll",comment:["&& denotes a mnemonic"]},"&&Select All"),order:1},{menuId:fe.CommandPalette,group:"",title:p("selectAll","Select All"),order:1}]})),Kee="modulepreload",jee=function(o){return"/excalibur-playground/"+o},q3={},we=function(e,t,i){let n=Promise.resolve();if(t&&t.length>0){let l=function(c){return Promise.all(c.map(d=>Promise.resolve(d).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),a=r?.nonce||r?.getAttribute("nonce");n=l(t.map(c=>{if(c=jee(c),c in q3)return;q3[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":Kee,d||(u.as="script"),u.crossOrigin="",u.href=c,a&&u.setAttribute("nonce",a),document.head.appendChild(u),d)return new Promise((g,f)=>{u.addEventListener("load",g),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return n.then(r=>{for(const a of r||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},Z3="default",qee="$initialize";let Y3=!1;function _P(o){Uf&&(Y3||(Y3=!0,console.warn("Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq")),console.warn(o.message))}class Zee{constructor(e,t,i,n,s){this.vsWorker=e,this.req=t,this.channel=i,this.method=n,this.args=s,this.type=0}}class X3{constructor(e,t,i,n){this.vsWorker=e,this.seq=t,this.res=i,this.err=n,this.type=1}}class Yee{constructor(e,t,i,n,s){this.vsWorker=e,this.req=t,this.channel=i,this.eventName=n,this.arg=s,this.type=2}}class Xee{constructor(e,t,i){this.vsWorker=e,this.req=t,this.event=i,this.type=3}}class Qee{constructor(e,t){this.vsWorker=e,this.req=t,this.type=4}}class Jee{constructor(e){this._workerId=-1,this._handler=e,this._lastSentReq=0,this._pendingReplies=Object.create(null),this._pendingEmitters=new Map,this._pendingEvents=new Map}setWorkerId(e){this._workerId=e}sendMessage(e,t,i){const n=String(++this._lastSentReq);return new Promise((s,r)=>{this._pendingReplies[n]={resolve:s,reject:r},this._send(new Zee(this._workerId,n,e,t,i))})}listen(e,t,i){let n=null;const s=new O({onWillAddFirstListener:()=>{n=String(++this._lastSentReq),this._pendingEmitters.set(n,s),this._send(new Yee(this._workerId,n,e,t,i))},onDidRemoveLastListener:()=>{this._pendingEmitters.delete(n),this._send(new Qee(this._workerId,n)),n=null}});return s.event}handleMessage(e){!e||!e.vsWorker||this._workerId!==-1&&e.vsWorker!==this._workerId||this._handleMessage(e)}createProxyToRemoteChannel(e,t){const i={get:(n,s)=>(typeof s=="string"&&!n[s]&&(pU(s)?n[s]=r=>this.listen(e,s,r):fU(s)?n[s]=this.listen(e,s,void 0):s.charCodeAt(0)===36&&(n[s]=async(...r)=>(await t?.(),this.sendMessage(e,s,r)))),n[s])};return new Proxy(Object.create(null),i)}_handleMessage(e){switch(e.type){case 1:return this._handleReplyMessage(e);case 0:return this._handleRequestMessage(e);case 2:return this._handleSubscribeEventMessage(e);case 3:return this._handleEventMessage(e);case 4:return this._handleUnsubscribeEventMessage(e)}}_handleReplyMessage(e){if(!this._pendingReplies[e.seq]){console.warn("Got reply to unknown seq");return}const t=this._pendingReplies[e.seq];if(delete this._pendingReplies[e.seq],e.err){let i=e.err;e.err.$isError&&(i=new Error,i.name=e.err.name,i.message=e.err.message,i.stack=e.err.stack),t.reject(i);return}t.resolve(e.res)}_handleRequestMessage(e){const t=e.req;this._handler.handleMessage(e.channel,e.method,e.args).then(n=>{this._send(new X3(this._workerId,t,n,void 0))},n=>{n.detail instanceof Error&&(n.detail=w3(n.detail)),this._send(new X3(this._workerId,t,void 0,w3(n)))})}_handleSubscribeEventMessage(e){const t=e.req,i=this._handler.handleEvent(e.channel,e.eventName,e.arg)(n=>{this._send(new Xee(this._workerId,t,n))});this._pendingEvents.set(t,i)}_handleEventMessage(e){if(!this._pendingEmitters.has(e.req)){console.warn("Got event for unknown req");return}this._pendingEmitters.get(e.req).fire(e.event)}_handleUnsubscribeEventMessage(e){if(!this._pendingEvents.has(e.req)){console.warn("Got unsubscribe for unknown req");return}this._pendingEvents.get(e.req).dispose(),this._pendingEvents.delete(e.req)}_send(e){const t=[];if(e.type===0)for(let i=0;i<e.args.length;i++)e.args[i]instanceof ArrayBuffer&&t.push(e.args[i]);else e.type===1&&e.res instanceof ArrayBuffer&&t.push(e.res);this._handler.sendMessage(e,t)}}class ete extends F{constructor(e,t){super(),this._localChannels=new Map,this._worker=this._register(e.create({amdModuleId:"vs/base/common/worker/simpleWorker",esmModuleLocation:t.esmModuleLocation,label:t.label},s=>{this._protocol.handleMessage(s)},s=>{Ae(s)})),this._protocol=new Jee({sendMessage:(s,r)=>{this._worker.postMessage(s,r)},handleMessage:(s,r,a)=>this._handleMessage(s,r,a),handleEvent:(s,r,a)=>this._handleEvent(s,r,a)}),this._protocol.setWorkerId(this._worker.getId());let i=null;const n=globalThis.require;typeof n<"u"&&typeof n.getConfig=="function"?i=n.getConfig():typeof globalThis.requirejs<"u"&&(i=globalThis.requirejs.s.contexts._.config),this._onModuleLoaded=this._protocol.sendMessage(Z3,qee,[this._worker.getId(),JSON.parse(JSON.stringify(i)),t.amdModuleId]),this.proxy=this._protocol.createProxyToRemoteChannel(Z3,async()=>{await this._onModuleLoaded}),this._onModuleLoaded.catch(s=>{this._onError("Worker failed to load "+t.amdModuleId,s)})}_handleMessage(e,t,i){const n=this._localChannels.get(e);if(!n)return Promise.reject(new Error(`Missing channel ${e} on main thread`));if(typeof n[t]!="function")return Promise.reject(new Error(`Missing method ${t} on main thread channel ${e}`));try{return Promise.resolve(n[t].apply(n,i))}catch(s){return Promise.reject(s)}}_handleEvent(e,t,i){const n=this._localChannels.get(e);if(!n)throw new Error(`Missing channel ${e} on main thread`);if(pU(t)){const s=n[t].call(n,i);if(typeof s!="function")throw new Error(`Missing dynamic event ${t} on main thread channel ${e}.`);return s}if(fU(t)){const s=n[t];if(typeof s!="function")throw new Error(`Missing event ${t} on main thread channel ${e}.`);return s}throw new Error(`Malformed event name ${t}`)}setChannel(e,t){this._localChannels.set(e,t)}_onError(e,t){console.error(e),console.info(t)}}function fU(o){return o[0]==="o"&&o[1]==="n"&&dl(o.charCodeAt(2))}function pU(o){return/^onDynamic/.test(o)&&dl(o.charCodeAt(9))}function nd(o,e){const t=globalThis.MonacoEnvironment;if(t?.createTrustedTypesPolicy)try{return t.createTrustedTypesPolicy(o,e)}catch(i){Ae(i);return}try{return globalThis.trustedTypes?.createPolicy(o,e)}catch(i){Ae(i);return}}let $p;typeof self=="object"&&self.constructor&&self.constructor.name==="DedicatedWorkerGlobalScope"&&globalThis.workerttPolicy!==void 0?$p=globalThis.workerttPolicy:$p=nd("defaultWorkerFactory",{createScriptURL:o=>o});function tte(o,e){const t=globalThis.MonacoEnvironment;if(t){if(typeof t.getWorker=="function")return t.getWorker("workerMain.js",e);if(typeof t.getWorkerUrl=="function"){const i=t.getWorkerUrl("workerMain.js",e);return new Worker($p?$p.createScriptURL(i):i,{name:e,type:"module"})}}if(o){const i=ite(e,o.toString(!0)),n=new Worker($p?$p.createScriptURL(i):i,{name:e,type:"module"});return nte(n)}throw new Error("You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker")}function ite(o,e,t){if(!(/^((http:)|(https:)|(file:)|(vscode-file:))/.test(e)&&e.substring(0,globalThis.origin.length)!==globalThis.origin)){const s=e.lastIndexOf("?"),r=e.lastIndexOf("#",s),a=s>0?new URLSearchParams(e.substring(s+1,~r?r:void 0)):new URLSearchParams;cP.addSearchParam(a,!0,!0),a.toString()?e=`${e}?${a.toString()}#${o}`:e=`${e}#${o}`}const n=new Blob([Vr([`/*${o}*/`,void 0,`globalThis._VSCODE_NLS_MESSAGES = ${JSON.stringify(Z6())};`,`globalThis._VSCODE_NLS_LANGUAGE = ${JSON.stringify(v4())};`,`globalThis._VSCODE_FILE_ROOT = '${globalThis._VSCODE_FILE_ROOT}';`,"const ttPolicy = globalThis.trustedTypes?.createPolicy('defaultWorkerFactory', { createScriptURL: value => value });","globalThis.workerttPolicy = ttPolicy;",`await import(ttPolicy?.createScriptURL('${e}') ?? '${e}');`,"globalThis.postMessage({ type: 'vscode-worker-ready' });",`/*${o}*/`]).join("")],{type:"application/javascript"});return URL.createObjectURL(n)}function nte(o){return new Promise((e,t)=>{o.onmessage=function(i){i.data.type==="vscode-worker-ready"&&(o.onmessage=null,e(o))},o.onerror=t})}function ste(o){return typeof o.then=="function"}class ote extends F{constructor(e,t,i,n,s,r){super(),this.id=i,this.label=n;const a=tte(e,n);ste(a)?this.worker=a:this.worker=Promise.resolve(a),this.postMessage(t,[]),this.worker.then(l=>{l.onmessage=function(c){s(c.data)},l.onmessageerror=r,typeof l.addEventListener=="function"&&l.addEventListener("error",r)}),this._register(ve(()=>{this.worker?.then(l=>{l.onmessage=null,l.onmessageerror=null,l.removeEventListener("error",r),l.terminate()}),this.worker=null}))}getId(){return this.id}postMessage(e,t){this.worker?.then(i=>{try{i.postMessage(e,t)}catch(n){Ae(n),Ae(new Error(`FAILED to post message to '${this.label}'-worker`,{cause:n}))}})}}class rte{constructor(e,t){this.amdModuleId=e,this.label=t,this.esmModuleLocation=nT.asBrowserUri(`${e}.esm.js`)}}const Sk=class Sk{constructor(){this._webWorkerFailedBeforeError=!1}create(e,t,i){const n=++Sk.LAST_WORKER_ID;if(this._webWorkerFailedBeforeError)throw this._webWorkerFailedBeforeError;return new ote(e.esmModuleLocation,e.amdModuleId,n,e.label||"anonymous"+n,t,s=>{_P(s),this._webWorkerFailedBeforeError=s,i(s)})}};Sk.LAST_WORKER_ID=0;let bP=Sk;function ate(o,e){const t=typeof o=="string"?new rte(o,e):o;return new ete(new bP,t)}var Oi;(function(o){o[o.None=0]="None",o[o.Indent=1]="Indent",o[o.IndentOutdent=2]="IndentOutdent",o[o.Outdent=3]="Outdent"})(Oi||(Oi={}));class rI{constructor(e){if(this._neutralCharacter=null,this._neutralCharacterSearched=!1,this.open=e.open,this.close=e.close,this._inString=!0,this._inComment=!0,this._inRegEx=!0,Array.isArray(e.notIn))for(let t=0,i=e.notIn.length;t<i;t++)switch(e.notIn[t]){case"string":this._inString=!1;break;case"comment":this._inComment=!1;break;case"regex":this._inRegEx=!1;break}}isOK(e){switch(e){case 0:return!0;case 1:return this._inComment;case 2:return this._inString;case 3:return this._inRegEx}}shouldAutoClose(e,t){if(e.getTokenCount()===0)return!0;const i=e.findTokenIndexAtOffset(t-2),n=e.getStandardTokenType(i);return this.isOK(n)}_findNeutralCharacterInRange(e,t){for(let i=e;i<=t;i++){const n=String.fromCharCode(i);if(!this.open.includes(n)&&!this.close.includes(n))return n}return null}findNeutralCharacter(){return this._neutralCharacterSearched||(this._neutralCharacterSearched=!0,this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(48,57)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(97,122)),this._neutralCharacter||(this._neutralCharacter=this._findNeutralCharacterInRange(65,90))),this._neutralCharacter}}class lte{constructor(e){this.autoClosingPairsOpenByStart=new Map,this.autoClosingPairsOpenByEnd=new Map,this.autoClosingPairsCloseByStart=new Map,this.autoClosingPairsCloseByEnd=new Map,this.autoClosingPairsCloseSingleChar=new Map;for(const t of e)Hb(this.autoClosingPairsOpenByStart,t.open.charAt(0),t),Hb(this.autoClosingPairsOpenByEnd,t.open.charAt(t.open.length-1),t),Hb(this.autoClosingPairsCloseByStart,t.close.charAt(0),t),Hb(this.autoClosingPairsCloseByEnd,t.close.charAt(t.close.length-1),t),t.close.length===1&&t.open.length===1&&Hb(this.autoClosingPairsCloseSingleChar,t.close,t)}}function Hb(o,e,t){o.has(e)?o.get(e).push(t):o.set(e,[t])}const _m=class _m{constructor(e){if(e.autoClosingPairs?this._autoClosingPairs=e.autoClosingPairs.map(t=>new rI(t)):e.brackets?this._autoClosingPairs=e.brackets.map(t=>new rI({open:t[0],close:t[1]})):this._autoClosingPairs=[],e.__electricCharacterSupport&&e.__electricCharacterSupport.docComment){const t=e.__electricCharacterSupport.docComment;this._autoClosingPairs.push(new rI({open:t.open,close:t.close||""}))}this._autoCloseBeforeForQuotes=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:_m.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES,this._autoCloseBeforeForBrackets=typeof e.autoCloseBefore=="string"?e.autoCloseBefore:_m.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS,this._surroundingPairs=e.surroundingPairs||this._autoClosingPairs}getAutoClosingPairs(){return this._autoClosingPairs}getAutoCloseBeforeSet(e){return e?this._autoCloseBeforeForQuotes:this._autoCloseBeforeForBrackets}getSurroundingPairs(){return this._surroundingPairs}};_m.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_QUOTES=`;:.,=}])> 
	`,_m.DEFAULT_AUTOCLOSE_BEFORE_LANGUAGE_DEFINED_BRACKETS=`'"\`;:.,=}])> 
	`;let vP=_m;function Qu(o,e){const t=o.getCount(),i=o.findTokenIndexAtOffset(e),n=o.getLanguageId(i);let s=i;for(;s+1<t&&o.getLanguageId(s+1)===n;)s++;let r=i;for(;r>0&&o.getLanguageId(r-1)===n;)r--;return new cte(o,n,r,s+1,o.getStartOffset(r),o.getEndOffset(s))}class cte{constructor(e,t,i,n,s,r){this._scopedLineTokensBrand=void 0,this._actual=e,this.languageId=t,this._firstTokenIndex=i,this._lastTokenIndex=n,this.firstCharOffset=s,this._lastCharOffset=r,this.languageIdCodec=e.languageIdCodec}getLineContent(){return this._actual.getLineContent().substring(this.firstCharOffset,this._lastCharOffset)}getLineLength(){return this._lastCharOffset-this.firstCharOffset}getActualLineContentBefore(e){return this._actual.getLineContent().substring(0,this.firstCharOffset+e)}getTokenCount(){return this._lastTokenIndex-this._firstTokenIndex}findTokenIndexAtOffset(e){return this._actual.findTokenIndexAtOffset(e+this.firstCharOffset)-this._firstTokenIndex}getStandardTokenType(e){return this._actual.getStandardTokenType(e+this._firstTokenIndex)}toIViewLineTokens(){return this._actual.sliceAndInflate(this.firstCharOffset,this._lastCharOffset,0)}}function Xa(o){return(o&3)!==0}const Q3=typeof Buffer<"u";let aI;class vT{static wrap(e){return Q3&&!Buffer.isBuffer(e)&&(e=Buffer.from(e.buffer,e.byteOffset,e.byteLength)),new vT(e)}constructor(e){this.buffer=e,this.byteLength=this.buffer.byteLength}toString(){return Q3?this.buffer.toString():(aI||(aI=new TextDecoder),aI.decode(this.buffer))}}function dte(o,e){return o[e+0]<<0>>>0|o[e+1]<<8>>>0}function hte(o,e,t){o[t+0]=e&255,e=e>>>8,o[t+1]=e&255}function aa(o,e){return o[e]*2**24+o[e+1]*2**16+o[e+2]*2**8+o[e+3]}function la(o,e,t){o[t+3]=e,e=e>>>8,o[t+2]=e,e=e>>>8,o[t+1]=e,e=e>>>8,o[t]=e}function J3(o,e){return o[e]}function eV(o,e,t){o[t]=e}let lI;function mU(){return lI||(lI=new TextDecoder("UTF-16LE")),lI}let cI;function ute(){return cI||(cI=new TextDecoder("UTF-16BE")),cI}let dI;function _U(){return dI||(dI=tz()?mU():ute()),dI}function gte(o,e,t){const i=new Uint16Array(o.buffer,e,t);return t>0&&(i[0]===65279||i[0]===65534)?fte(o,e,t):mU().decode(i)}function fte(o,e,t){const i=[];let n=0;for(let s=0;s<t;s++){const r=dte(o,e);e+=2,i[n++]=String.fromCharCode(r)}return i.join("")}class rb{constructor(e){this._capacity=e|0,this._buffer=new Uint16Array(this._capacity),this._completedStrings=null,this._bufferLength=0}reset(){this._completedStrings=null,this._bufferLength=0}build(){return this._completedStrings!==null?(this._flushBuffer(),this._completedStrings.join("")):this._buildBuffer()}_buildBuffer(){if(this._bufferLength===0)return"";const e=new Uint16Array(this._buffer.buffer,0,this._bufferLength);return _U().decode(e)}_flushBuffer(){const e=this._buildBuffer();this._bufferLength=0,this._completedStrings===null?this._completedStrings=[e]:this._completedStrings[this._completedStrings.length]=e}appendCharCode(e){const t=this._capacity-this._bufferLength;t<=1&&(t===0||$i(e))&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendASCIICharCode(e){this._bufferLength===this._capacity&&this._flushBuffer(),this._buffer[this._bufferLength++]=e}appendString(e){const t=e.length;if(this._bufferLength+t>=this._capacity){this._flushBuffer(),this._completedStrings[this._completedStrings.length]=e;return}for(let i=0;i<t;i++)this._buffer[this._bufferLength++]=e.charCodeAt(i)}}class F0{constructor(e,t,i,n,s,r){this._richEditBracketBrand=void 0,this.languageId=e,this.index=t,this.open=i,this.close=n,this.forwardRegex=s,this.reversedRegex=r,this._openSet=F0._toSet(this.open),this._closeSet=F0._toSet(this.close)}isOpen(e){return this._openSet.has(e)}isClose(e){return this._closeSet.has(e)}static _toSet(e){const t=new Set;for(const i of e)t.add(i);return t}}function pte(o){const e=o.length;o=o.map(r=>[r[0].toLowerCase(),r[1].toLowerCase()]);const t=[];for(let r=0;r<e;r++)t[r]=r;const i=(r,a)=>{const[l,c]=r,[d,h]=a;return l===d||l===h||c===d||c===h},n=(r,a)=>{const l=Math.min(r,a),c=Math.max(r,a);for(let d=0;d<e;d++)t[d]===c&&(t[d]=l)};for(let r=0;r<e;r++){const a=o[r];for(let l=r+1;l<e;l++){const c=o[l];i(a,c)&&n(t[r],t[l])}}const s=[];for(let r=0;r<e;r++){const a=[],l=[];for(let c=0;c<e;c++)if(t[c]===r){const[d,h]=o[c];a.push(d),l.push(h)}a.length>0&&s.push({open:a,close:l})}return s}class mte{constructor(e,t){this._richEditBracketsBrand=void 0;const i=pte(t);this.brackets=i.map((n,s)=>new F0(e,s,n.open,n.close,_te(n.open,n.close,i,s),bte(n.open,n.close,i,s))),this.forwardRegex=vte(this.brackets),this.reversedRegex=Cte(this.brackets),this.textIsBracket={},this.textIsOpenBracket={},this.maxBracketLength=0;for(const n of this.brackets){for(const s of n.open)this.textIsBracket[s]=n,this.textIsOpenBracket[s]=!0,this.maxBracketLength=Math.max(this.maxBracketLength,s.length);for(const s of n.close)this.textIsBracket[s]=n,this.textIsOpenBracket[s]=!1,this.maxBracketLength=Math.max(this.maxBracketLength,s.length)}}}function bU(o,e,t,i){for(let n=0,s=e.length;n<s;n++){if(n===t)continue;const r=e[n];for(const a of r.open)a.indexOf(o)>=0&&i.push(a);for(const a of r.close)a.indexOf(o)>=0&&i.push(a)}}function vU(o,e){return o.length-e.length}function CT(o){if(o.length<=1)return o;const e=[],t=new Set;for(const i of o)t.has(i)||(e.push(i),t.add(i));return e}function _te(o,e,t,i){let n=[];n=n.concat(o),n=n.concat(e);for(let s=0,r=n.length;s<r;s++)bU(n[s],t,i,n);return n=CT(n),n.sort(vU),n.reverse(),Ew(n)}function bte(o,e,t,i){let n=[];n=n.concat(o),n=n.concat(e);for(let s=0,r=n.length;s<r;s++)bU(n[s],t,i,n);return n=CT(n),n.sort(vU),n.reverse(),Ew(n.map(Z4))}function vte(o){let e=[];for(const t of o){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=CT(e),Ew(e)}function Cte(o){let e=[];for(const t of o){for(const i of t.open)e.push(i);for(const i of t.close)e.push(i)}return e=CT(e),Ew(e.map(Z4))}function yte(o){const e=/^[\w ]+$/.test(o);return o=Fo(o),e?`\\b${o}\\b`:o}function Ew(o,e){const t=`(${o.map(yte).join(")|(")})`;return Lz(t,!0,e)}const Z4=function(){function o(i){const n=new Uint16Array(i.length);let s=0;for(let r=i.length-1;r>=0;r--)n[s++]=i.charCodeAt(r);return _U().decode(n)}let e=null,t=null;return function(n){return e!==n&&(e=n,t=o(e)),t}}();class Lr{static _findPrevBracketInText(e,t,i,n){const s=i.match(e);if(!s)return null;const r=i.length-(s.index||0),a=s[0].length,l=n+r;return new L(t,l-a+1,t,l+1)}static findPrevBracketInRange(e,t,i,n,s){const a=Z4(i).substring(i.length-s,i.length-n);return this._findPrevBracketInText(e,t,a,n)}static findNextBracketInText(e,t,i,n){const s=i.match(e);if(!s)return null;const r=s.index||0,a=s[0].length;if(a===0)return null;const l=n+r;return new L(t,l+1,t,l+1+a)}static findNextBracketInRange(e,t,i,n,s){const r=i.substring(n,s);return this.findNextBracketInText(e,t,r,n)}}class wte{constructor(e){this._richEditBrackets=e}getElectricCharacters(){const e=[];if(this._richEditBrackets)for(const t of this._richEditBrackets.brackets)for(const i of t.close){const n=i.charAt(i.length-1);e.push(n)}return Uc(e)}onElectricCharacter(e,t,i){if(!this._richEditBrackets||this._richEditBrackets.brackets.length===0)return null;const n=t.findTokenIndexAtOffset(i-1);if(Xa(t.getStandardTokenType(n)))return null;const s=this._richEditBrackets.reversedRegex,r=t.getLineContent().substring(0,i-1)+e,a=Lr.findPrevBracketInRange(s,1,r,0,r.length);if(!a)return null;const l=r.substring(a.startColumn-1,a.endColumn-1).toLowerCase();if(this._richEditBrackets.textIsOpenBracket[l])return null;const d=t.getActualLineContentBefore(a.startColumn-1);return/^\s*$/.test(d)?{matchOpenBracket:l}:null}}function CS(o){return o.global&&(o.lastIndex=0),!0}class Ste{constructor(e){this._indentationRules=e}shouldIncrease(e){return!!(this._indentationRules&&this._indentationRules.increaseIndentPattern&&CS(this._indentationRules.increaseIndentPattern)&&this._indentationRules.increaseIndentPattern.test(e))}shouldDecrease(e){return!!(this._indentationRules&&this._indentationRules.decreaseIndentPattern&&CS(this._indentationRules.decreaseIndentPattern)&&this._indentationRules.decreaseIndentPattern.test(e))}shouldIndentNextLine(e){return!!(this._indentationRules&&this._indentationRules.indentNextLinePattern&&CS(this._indentationRules.indentNextLinePattern)&&this._indentationRules.indentNextLinePattern.test(e))}shouldIgnore(e){return!!(this._indentationRules&&this._indentationRules.unIndentedLinePattern&&CS(this._indentationRules.unIndentedLinePattern)&&this._indentationRules.unIndentedLinePattern.test(e))}getIndentMetadata(e){let t=0;return this.shouldIncrease(e)&&(t+=1),this.shouldDecrease(e)&&(t+=2),this.shouldIndentNextLine(e)&&(t+=4),this.shouldIgnore(e)&&(t+=8),t}}class Kp{constructor(e){e=e||{},e.brackets=e.brackets||[["(",")"],["{","}"],["[","]"]],this._brackets=[],e.brackets.forEach(t=>{const i=Kp._createOpenBracketRegExp(t[0]),n=Kp._createCloseBracketRegExp(t[1]);i&&n&&this._brackets.push({open:t[0],openRegExp:i,close:t[1],closeRegExp:n})}),this._regExpRules=e.onEnterRules||[]}onEnter(e,t,i,n){if(e>=3)for(let s=0,r=this._regExpRules.length;s<r;s++){const a=this._regExpRules[s];if([{reg:a.beforeText,text:i},{reg:a.afterText,text:n},{reg:a.previousLineText,text:t}].every(c=>c.reg?(c.reg.lastIndex=0,c.reg.test(c.text)):!0))return a.action}if(e>=2&&i.length>0&&n.length>0)for(let s=0,r=this._brackets.length;s<r;s++){const a=this._brackets[s];if(a.openRegExp.test(i)&&a.closeRegExp.test(n))return{indentAction:Oi.IndentOutdent}}if(e>=2&&i.length>0){for(let s=0,r=this._brackets.length;s<r;s++)if(this._brackets[s].openRegExp.test(i))return{indentAction:Oi.Indent}}return null}static _createOpenBracketRegExp(e){let t=Fo(e);return/\B/.test(t.charAt(0))||(t="\\b"+t),t+="\\s*$",Kp._safeRegExp(t)}static _createCloseBracketRegExp(e){let t=Fo(e);return/\B/.test(t.charAt(t.length-1))||(t=t+"\\b"),t="^\\s*"+t,Kp._safeRegExp(t)}static _safeRegExp(e){try{return new RegExp(e)}catch(t){return Ae(t),null}}}const Ke=Je("configurationService");function CP(o,e){const t=Object.create(null);for(const i in o)CU(t,i,o[i],e);return t}function CU(o,e,t,i){const n=e.split("."),s=n.pop();let r=o;for(let a=0;a<n.length;a++){const l=n[a];let c=r[l];switch(typeof c){case"undefined":c=r[l]=Object.create(null);break;case"object":if(c===null){i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is null`);return}break;default:i(`Ignoring ${e} as ${n.slice(0,a+1).join(".")} is ${JSON.stringify(c)}`);return}r=c}if(typeof r=="object"&&r!==null)try{r[s]=t}catch{i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(r)}`)}else i(`Ignoring ${e} as ${n.join(".")} is ${JSON.stringify(r)}`)}function xte(o,e){const t=e.split(".");yU(o,t)}function yU(o,e){const t=e.shift();if(e.length===0){delete o[t];return}if(Object.keys(o).indexOf(t)!==-1){const i=o[t];typeof i=="object"&&!Array.isArray(i)&&(yU(i,e),Object.keys(i).length===0&&delete o[t])}}function tV(o,e,t){function i(r,a){let l=r;for(const c of a){if(typeof l!="object"||l===null)return;l=l[c]}return l}const n=e.split("."),s=i(o,n);return typeof s>"u"?t:s}function Lte(o){return o.replace(/[\[\]]/g,"")}const ti=Je("languageService");class hl{constructor(e,t=[],i=!1){this.ctor=e,this.staticArguments=t,this.supportsDelayedInstantiation=i}}const wU=[];function it(o,e,t){e instanceof hl||(e=new hl(e,[],!!t)),wU.push([o,e])}function iV(){return wU}const vi=Object.freeze({text:"text/plain",binary:"application/octet-stream",unknown:"application/unknown",markdown:"text/markdown",latex:"text/latex",uriList:"text/uri-list"}),yT={JSONContribution:"base.contributions.json"};function kte(o){return o.length>0&&o.charAt(o.length-1)==="#"?o.substring(0,o.length-1):o}class Ete{constructor(){this._onDidChangeSchema=new O,this.schemasById={}}registerSchema(e,t){this.schemasById[kte(e)]=t,this._onDidChangeSchema.fire(e)}notifySchemaChanged(e){this._onDidChangeSchema.fire(e)}}const Tte=new Ete;ai.add(yT.JSONContribution,Tte);const Zr={Configuration:"base.contributions.configuration"},yS="vscode://schemas/settings/resourceLanguage",nV=ai.as(yT.JSONContribution);class Dte{constructor(){this.registeredConfigurationDefaults=[],this.overrideIdentifiers=new Set,this._onDidSchemaChange=new O,this._onDidUpdateConfiguration=new O,this.configurationDefaultsOverrides=new Map,this.defaultLanguageConfigurationOverridesNode={id:"defaultOverrides",title:p("defaultLanguageConfigurationOverrides.title","Default Language Configuration Overrides"),properties:{}},this.configurationContributors=[this.defaultLanguageConfigurationOverridesNode],this.resourceLanguageSettingsSchema={properties:{},patternProperties:{},additionalProperties:!0,allowTrailingCommas:!0,allowComments:!0},this.configurationProperties={},this.policyConfigurations=new Map,this.excludedConfigurationProperties={},nV.registerSchema(yS,this.resourceLanguageSettingsSchema),this.registerOverridePropertyPatternKey()}registerConfiguration(e,t=!0){this.registerConfigurations([e],t)}registerConfigurations(e,t=!0){const i=new Set;this.doRegisterConfigurations(e,t,i),nV.registerSchema(yS,this.resourceLanguageSettingsSchema),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:i})}registerDefaultConfigurations(e){const t=new Set;this.doRegisterDefaultConfigurations(e,t),this._onDidSchemaChange.fire(),this._onDidUpdateConfiguration.fire({properties:t,defaultsOverrides:!0})}doRegisterDefaultConfigurations(e,t){this.registeredConfigurationDefaults.push(...e);const i=[];for(const{overrides:n,source:s}of e)for(const r in n){t.add(r);const a=this.configurationDefaultsOverrides.get(r)??this.configurationDefaultsOverrides.set(r,{configurationDefaultOverrides:[]}).get(r),l=n[r];if(a.configurationDefaultOverrides.push({value:l,source:s}),Ah.test(r)){const c=this.mergeDefaultConfigurationsForOverrideIdentifier(r,l,s,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c,this.updateDefaultOverrideProperty(r,c,s),i.push(...B0(r))}else{const c=this.mergeDefaultConfigurationsForConfigurationProperty(r,l,s,a.configurationDefaultOverrideValue);if(!c)continue;a.configurationDefaultOverrideValue=c;const d=this.configurationProperties[r];d&&(this.updatePropertyDefaultValue(r,d),this.updateSchema(r,d))}}this.doRegisterOverrideIdentifiers(i)}updateDefaultOverrideProperty(e,t,i){const n={type:"object",default:t.value,description:p("defaultLanguageConfiguration.description","Configure settings to be overridden for the {0} language.",Lte(e)),$ref:yS,defaultDefaultValue:t.value,source:i,defaultValueSource:i};this.configurationProperties[e]=n,this.defaultLanguageConfigurationOverridesNode.properties[e]=n}mergeDefaultConfigurationsForOverrideIdentifier(e,t,i,n){const s=n?.value||{},r=n?.source??new Map;if(!(r instanceof Map)){console.error("objectConfigurationSources is not a Map");return}for(const a of Object.keys(t)){const l=t[a];if(nn(l)&&(Zn(s[a])||nn(s[a]))){if(s[a]={...s[a]??{},...l},i)for(const d in l)r.set(`${a}.${d}`,i)}else s[a]=l,i?r.set(a,i):r.delete(a)}return{value:s,source:r}}mergeDefaultConfigurationsForConfigurationProperty(e,t,i,n){const s=this.configurationProperties[e],r=n?.value??s?.defaultDefaultValue;let a=i;if(nn(t)&&(s!==void 0&&s.type==="object"||s===void 0&&(Zn(r)||nn(r)))){if(a=n?.source??new Map,!(a instanceof Map)){console.error("defaultValueSource is not a Map");return}for(const c in t)i&&a.set(`${e}.${c}`,i);t={...nn(r)?r:{},...t}}return{value:t,source:a}}registerOverrideIdentifiers(e){this.doRegisterOverrideIdentifiers(e),this._onDidSchemaChange.fire()}doRegisterOverrideIdentifiers(e){for(const t of e)this.overrideIdentifiers.add(t);this.updateOverridePropertyPatternKey()}doRegisterConfigurations(e,t,i){e.forEach(n=>{this.validateAndRegisterProperties(n,t,n.extensionInfo,n.restrictedProperties,void 0,i),this.configurationContributors.push(n),this.registerJSONConfiguration(n)})}validateAndRegisterProperties(e,t=!0,i,n,s=3,r){s=ko(e.scope)?s:e.scope;const a=e.properties;if(a)for(const c in a){const d=a[c];if(t&&Rte(c,d)){delete a[c];continue}if(d.source=i,d.defaultDefaultValue=a[c].default,this.updatePropertyDefaultValue(c,d),Ah.test(c)?d.scope=void 0:(d.scope=ko(d.scope)?s:d.scope,d.restricted=ko(d.restricted)?!!n?.includes(c):d.restricted),a[c].hasOwnProperty("included")&&!a[c].included){this.excludedConfigurationProperties[c]=a[c],delete a[c];continue}else this.configurationProperties[c]=a[c],a[c].policy?.name&&this.policyConfigurations.set(a[c].policy.name,c);!a[c].deprecationMessage&&a[c].markdownDeprecationMessage&&(a[c].deprecationMessage=a[c].markdownDeprecationMessage),r.add(c)}const l=e.allOf;if(l)for(const c of l)this.validateAndRegisterProperties(c,t,i,n,s,r)}getConfigurationProperties(){return this.configurationProperties}getPolicyConfigurations(){return this.policyConfigurations}registerJSONConfiguration(e){const t=i=>{const n=i.properties;if(n)for(const r in n)this.updateSchema(r,n[r]);i.allOf?.forEach(t)};t(e)}updateSchema(e,t){switch(t.scope){case 1:break;case 2:break;case 6:break;case 3:break;case 4:break;case 5:this.resourceLanguageSettingsSchema.properties[e]=t;break}}updateOverridePropertyPatternKey(){for(const e of this.overrideIdentifiers.values()){const t=`[${e}]`,i={type:"object",description:p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),errorMessage:p("overrideSettings.errorMessage","This setting does not support per-language configuration."),$ref:yS};this.updatePropertyDefaultValue(t,i)}}registerOverridePropertyPatternKey(){p("overrideSettings.defaultDescription","Configure editor settings to be overridden for a language."),p("overrideSettings.errorMessage","This setting does not support per-language configuration."),this._onDidSchemaChange.fire()}updatePropertyDefaultValue(e,t){const i=this.configurationDefaultsOverrides.get(e)?.configurationDefaultOverrideValue;let n,s;i&&(!t.disallowConfigurationDefault||!i.source)&&(n=i.value,s=i.source),Zn(n)&&(n=t.defaultDefaultValue,s=void 0),Zn(n)&&(n=Nte(t.type)),t.default=n,t.defaultValueSource=s}}const SU="\\[([^\\]]+)\\]",sV=new RegExp(SU,"g"),Ite=`^(${SU})+$`,Ah=new RegExp(Ite);function B0(o){const e=[];if(Ah.test(o)){let t=sV.exec(o);for(;t?.length;){const i=t[1].trim();i&&e.push(i),t=sV.exec(o)}}return Uc(e)}function Nte(o){switch(Array.isArray(o)?o[0]:o){case"boolean":return!1;case"integer":case"number":return 0;case"string":return"";case"array":return[];case"object":return{};default:return null}}const R1=new Dte;ai.add(Zr.Configuration,R1);function Rte(o,e){return o.trim()?Ah.test(o)?p("config.property.languageDefault","Cannot register '{0}'. This matches property pattern '\\\\[.*\\\\]$' for describing language specific editor settings. Use 'configurationDefaults' contribution.",o):R1.getConfigurationProperties()[o]!==void 0?p("config.property.duplicate","Cannot register '{0}'. This property is already registered.",o):e.policy?.name&&R1.getPolicyConfigurations().get(e.policy?.name)!==void 0?p("config.policy.duplicate","Cannot register '{0}'. The associated policy {1} is already registered with {2}.",o,e.policy?.name,R1.getPolicyConfigurations().get(e.policy?.name)):null:p("config.property.empty","Cannot register an empty property")}const Pte={ModesRegistry:"editor.modesRegistry"};class Ate{constructor(){this._onDidChangeLanguages=new O,this.onDidChangeLanguages=this._onDidChangeLanguages.event,this._languages=[]}registerLanguage(e){return this._languages.push(e),this._onDidChangeLanguages.fire(void 0),{dispose:()=>{for(let t=0,i=this._languages.length;t<i;t++)if(this._languages[t]===e){this._languages.splice(t,1);return}}}}getLanguages(){return this._languages}}const __=new Ate;ai.add(Pte.ModesRegistry,__);const hs="plaintext",Mte=".txt";__.registerLanguage({id:hs,extensions:[Mte],aliases:[p("plainText.alias","Plain Text"),"text"],mimetypes:[vi.text]});ai.as(Zr.Configuration).registerDefaultConfigurations([{overrides:{"[plaintext]":{"editor.unicodeHighlight.ambiguousCharacters":!1,"editor.unicodeHighlight.invisibleCharacters":!1}}}]);class Ote{constructor(e,t){this.languageId=e;const i=t.brackets?oV(t.brackets):[],n=new E3(a=>{const l=new Set;return{info:new Fte(this,a,l),closing:l}}),s=new E3(a=>{const l=new Set,c=new Set;return{info:new Bte(this,a,l,c),opening:l,openingColorized:c}});for(const[a,l]of i){const c=n.get(a),d=s.get(l);c.closing.add(d.info),d.opening.add(c.info)}const r=t.colorizedBracketPairs?oV(t.colorizedBracketPairs):i.filter(a=>!(a[0]==="<"&&a[1]===">"));for(const[a,l]of r){const c=n.get(a),d=s.get(l);c.closing.add(d.info),d.openingColorized.add(c.info),d.opening.add(c.info)}this._openingBrackets=new Map([...n.cachedValues].map(([a,l])=>[a,l.info])),this._closingBrackets=new Map([...s.cachedValues].map(([a,l])=>[a,l.info]))}get openingBrackets(){return[...this._openingBrackets.values()]}get closingBrackets(){return[...this._closingBrackets.values()]}getOpeningBracketInfo(e){return this._openingBrackets.get(e)}getClosingBracketInfo(e){return this._closingBrackets.get(e)}getBracketInfo(e){return this.getOpeningBracketInfo(e)||this.getClosingBracketInfo(e)}getBracketRegExp(e){const t=Array.from([...this._openingBrackets.keys(),...this._closingBrackets.keys()]);return Ew(t,e)}}function oV(o){return o.filter(([e,t])=>e!==""&&t!=="")}class xU{constructor(e,t){this.config=e,this.bracketText=t}get languageId(){return this.config.languageId}}class Fte extends xU{constructor(e,t,i){super(e,t),this.openedBrackets=i,this.isOpeningBracket=!0}}class Bte extends xU{constructor(e,t,i,n){super(e,t),this.openingBrackets=i,this.openingColorizedBrackets=n,this.isOpeningBracket=!1}closes(e){return e.config!==this.config?!1:this.openingBrackets.has(e)}closesColorized(e){return e.config!==this.config?!1:this.openingColorizedBrackets.has(e)}getOpeningBrackets(){return[...this.openingBrackets]}}var Wte=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},rV=function(o,e){return function(t,i){e(t,i,o)}};class hI{constructor(e){this.languageId=e}affects(e){return this.languageId?this.languageId===e:!0}}const li=Je("languageConfigurationService");let yP=class extends F{constructor(e,t){super(),this.configurationService=e,this.languageService=t,this._registry=this._register(new Ute),this.onDidChangeEmitter=this._register(new O),this.onDidChange=this.onDidChangeEmitter.event,this.configurations=new Map;const i=new Set(Object.values(wP));this._register(this.configurationService.onDidChangeConfiguration(n=>{const s=n.change.keys.some(a=>i.has(a)),r=n.change.overrides.filter(([a,l])=>l.some(c=>i.has(c))).map(([a])=>a);if(s)this.configurations.clear(),this.onDidChangeEmitter.fire(new hI(void 0));else for(const a of r)this.languageService.isRegisteredLanguageId(a)&&(this.configurations.delete(a),this.onDidChangeEmitter.fire(new hI(a)))})),this._register(this._registry.onDidChange(n=>{this.configurations.delete(n.languageId),this.onDidChangeEmitter.fire(new hI(n.languageId))}))}register(e,t,i){return this._registry.register(e,t,i)}getLanguageConfiguration(e){let t=this.configurations.get(e);return t||(t=Vte(e,this._registry,this.configurationService,this.languageService),this.configurations.set(e,t)),t}};yP=Wte([rV(0,Ke),rV(1,ti)],yP);function Vte(o,e,t,i){let n=e.getLanguageConfiguration(o);if(!n){if(!i.isRegisteredLanguageId(o))return new Am(o,{});n=new Am(o,{})}const s=Hte(n.languageId,t),r=kU([n.underlyingConfig,s]);return new Am(n.languageId,r)}const wP={brackets:"editor.language.brackets",colorizedBracketPairs:"editor.language.colorizedBracketPairs"};function Hte(o,e){const t=e.getValue(wP.brackets,{overrideIdentifier:o}),i=e.getValue(wP.colorizedBracketPairs,{overrideIdentifier:o});return{brackets:aV(t),colorizedBracketPairs:aV(i)}}function aV(o){if(Array.isArray(o))return o.map(e=>{if(!(!Array.isArray(e)||e.length!==2))return[e[0],e[1]]}).filter(e=>!!e)}function LU(o,e,t){const i=o.getLineContent(e);let n=Tt(i);return n.length>t-1&&(n=n.substring(0,t-1)),n}class zte{constructor(e){this.languageId=e,this._resolved=null,this._entries=[],this._order=0,this._resolved=null}register(e,t){const i=new lV(e,t,++this._order);return this._entries.push(i),this._resolved=null,ve(()=>{for(let n=0;n<this._entries.length;n++)if(this._entries[n]===i){this._entries.splice(n,1),this._resolved=null;break}})}getResolvedConfiguration(){if(!this._resolved){const e=this._resolve();e&&(this._resolved=new Am(this.languageId,e))}return this._resolved}_resolve(){return this._entries.length===0?null:(this._entries.sort(lV.cmp),kU(this._entries.map(e=>e.configuration)))}}function kU(o){let e={comments:void 0,brackets:void 0,wordPattern:void 0,indentationRules:void 0,onEnterRules:void 0,autoClosingPairs:void 0,surroundingPairs:void 0,autoCloseBefore:void 0,folding:void 0,colorizedBracketPairs:void 0,__electricCharacterSupport:void 0};for(const t of o)e={comments:t.comments||e.comments,brackets:t.brackets||e.brackets,wordPattern:t.wordPattern||e.wordPattern,indentationRules:t.indentationRules||e.indentationRules,onEnterRules:t.onEnterRules||e.onEnterRules,autoClosingPairs:t.autoClosingPairs||e.autoClosingPairs,surroundingPairs:t.surroundingPairs||e.surroundingPairs,autoCloseBefore:t.autoCloseBefore||e.autoCloseBefore,folding:t.folding||e.folding,colorizedBracketPairs:t.colorizedBracketPairs||e.colorizedBracketPairs,__electricCharacterSupport:t.__electricCharacterSupport||e.__electricCharacterSupport};return e}class lV{constructor(e,t,i){this.configuration=e,this.priority=t,this.order=i}static cmp(e,t){return e.priority===t.priority?e.order-t.order:e.priority-t.priority}}class cV{constructor(e){this.languageId=e}}class Ute extends F{constructor(){super(),this._entries=new Map,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._register(this.register(hs,{brackets:[["(",")"],["[","]"],["{","}"]],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"},{open:"`",close:"`"}],colorizedBracketPairs:[],folding:{offSide:!0}},0))}register(e,t,i=0){let n=this._entries.get(e);n||(n=new zte(e),this._entries.set(e,n));const s=n.register(t,i);return this._onDidChange.fire(new cV(e)),ve(()=>{s.dispose(),this._onDidChange.fire(new cV(e))})}getLanguageConfiguration(e){return this._entries.get(e)?.getResolvedConfiguration()||null}}class Am{constructor(e,t){this.languageId=e,this.underlyingConfig=t,this._brackets=null,this._electricCharacter=null,this._onEnterSupport=this.underlyingConfig.brackets||this.underlyingConfig.indentationRules||this.underlyingConfig.onEnterRules?new Kp(this.underlyingConfig):null,this.comments=Am._handleComments(this.underlyingConfig),this.characterPair=new vP(this.underlyingConfig),this.wordDefinition=this.underlyingConfig.wordPattern||w4,this.indentationRules=this.underlyingConfig.indentationRules,this.underlyingConfig.indentationRules?this.indentRulesSupport=new Ste(this.underlyingConfig.indentationRules):this.indentRulesSupport=null,this.foldingRules=this.underlyingConfig.folding||{},this.bracketsNew=new Ote(e,this.underlyingConfig)}getWordDefinition(){return S4(this.wordDefinition)}get brackets(){return!this._brackets&&this.underlyingConfig.brackets&&(this._brackets=new mte(this.languageId,this.underlyingConfig.brackets)),this._brackets}get electricCharacter(){return this._electricCharacter||(this._electricCharacter=new wte(this.brackets)),this._electricCharacter}onEnter(e,t,i,n){return this._onEnterSupport?this._onEnterSupport.onEnter(e,t,i,n):null}getAutoClosingPairs(){return new lte(this.characterPair.getAutoClosingPairs())}getAutoCloseBeforeSet(e){return this.characterPair.getAutoCloseBeforeSet(e)}getSurroundingPairs(){return this.characterPair.getSurroundingPairs()}static _handleComments(e){const t=e.comments;if(!t)return null;const i={};if(t.lineComment&&(i.lineCommentToken=t.lineComment),t.blockComment){const[n,s]=t.blockComment;i.blockCommentStartToken=n,i.blockCommentEndToken=s}return i}}it(li,yP,1);class Cd{constructor(e,t,i,n){this.originalStart=e,this.originalLength=t,this.modifiedStart=i,this.modifiedLength=n}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}}class dV{constructor(e){this.source=e}getElements(){const e=this.source,t=new Int32Array(e.length);for(let i=0,n=e.length;i<n;i++)t[i]=e.charCodeAt(i);return t}}function Gte(o,e,t){return new pl(new dV(o),new dV(e)).ComputeDiff(t).changes}class fp{static Assert(e,t){if(!e)throw new Error(t)}}class pp{static Copy(e,t,i,n,s){for(let r=0;r<s;r++)i[n+r]=e[t+r]}static Copy2(e,t,i,n,s){for(let r=0;r<s;r++)i[n+r]=e[t+r]}}class hV{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new Cd(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_originalCount++}AddModifiedElement(e,t){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,t),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}}class pl{constructor(e,t,i=null){this.ContinueProcessingPredicate=i,this._originalSequence=e,this._modifiedSequence=t;const[n,s,r]=pl._getElements(e),[a,l,c]=pl._getElements(t);this._hasStrings=r&&c,this._originalStringElements=n,this._originalElementsOrHash=s,this._modifiedStringElements=a,this._modifiedElementsOrHash=l,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _isStringArray(e){return e.length>0&&typeof e[0]=="string"}static _getElements(e){const t=e.getElements();if(pl._isStringArray(t)){const i=new Int32Array(t.length);for(let n=0,s=t.length;n<s;n++)i[n]=V4(t[n],0);return[t,i,!0]}return t instanceof Int32Array?[[],t,!1]:[[],new Int32Array(t),!1]}ElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._modifiedStringElements[t]:!0}ElementsAreStrictEqual(e,t){if(!this.ElementsAreEqual(e,t))return!1;const i=pl._getStrictElement(this._originalSequence,e),n=pl._getStrictElement(this._modifiedSequence,t);return i===n}static _getStrictElement(e,t){return typeof e.getStrictElement=="function"?e.getStrictElement(t):null}OriginalElementsAreEqual(e,t){return this._originalElementsOrHash[e]!==this._originalElementsOrHash[t]?!1:this._hasStrings?this._originalStringElements[e]===this._originalStringElements[t]:!0}ModifiedElementsAreEqual(e,t){return this._modifiedElementsOrHash[e]!==this._modifiedElementsOrHash[t]?!1:this._hasStrings?this._modifiedStringElements[e]===this._modifiedStringElements[t]:!0}ComputeDiff(e){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1,e)}_ComputeDiff(e,t,i,n,s){const r=[!1];let a=this.ComputeDiffRecursive(e,t,i,n,r);return s&&(a=this.PrettifyChanges(a)),{quitEarly:r[0],changes:a}}ComputeDiffRecursive(e,t,i,n,s){for(s[0]=!1;e<=t&&i<=n&&this.ElementsAreEqual(e,i);)e++,i++;for(;t>=e&&n>=i&&this.ElementsAreEqual(t,n);)t--,n--;if(e>t||i>n){let h;return i<=n?(fp.Assert(e===t+1,"originalStart should only be one more than originalEnd"),h=[new Cd(e,0,i,n-i+1)]):e<=t?(fp.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),h=[new Cd(e,t-e+1,i,0)]):(fp.Assert(e===t+1,"originalStart should only be one more than originalEnd"),fp.Assert(i===n+1,"modifiedStart should only be one more than modifiedEnd"),h=[]),h}const r=[0],a=[0],l=this.ComputeRecursionPoint(e,t,i,n,r,a,s),c=r[0],d=a[0];if(l!==null)return l;if(!s[0]){const h=this.ComputeDiffRecursive(e,c,i,d,s);let u=[];return s[0]?u=[new Cd(c+1,t-(c+1)+1,d+1,n-(d+1)+1)]:u=this.ComputeDiffRecursive(c+1,t,d+1,n,s),this.ConcatenateChanges(h,u)}return[new Cd(e,t-e+1,i,n-i+1)]}WALKTRACE(e,t,i,n,s,r,a,l,c,d,h,u,g,f,m,_,b,v){let y=null,C=null,w=new hV,x=t,k=i,E=g[0]-_[0]-n,N=-1073741824,z=this.m_forwardHistory.length-1;do{const B=E+e;B===x||B<k&&c[B-1]<c[B+1]?(h=c[B+1],f=h-E-n,h<N&&w.MarkNextChange(),N=h,w.AddModifiedElement(h+1,f),E=B+1-e):(h=c[B-1]+1,f=h-E-n,h<N&&w.MarkNextChange(),N=h-1,w.AddOriginalElement(h,f+1),E=B-1-e),z>=0&&(c=this.m_forwardHistory[z],e=c[0],x=1,k=c.length-1)}while(--z>=-1);if(y=w.getReverseChanges(),v[0]){let B=g[0]+1,U=_[0]+1;if(y!==null&&y.length>0){const Z=y[y.length-1];B=Math.max(B,Z.getOriginalEnd()),U=Math.max(U,Z.getModifiedEnd())}C=[new Cd(B,u-B+1,U,m-U+1)]}else{w=new hV,x=r,k=a,E=g[0]-_[0]-l,N=1073741824,z=b?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{const B=E+s;B===x||B<k&&d[B-1]>=d[B+1]?(h=d[B+1]-1,f=h-E-l,h>N&&w.MarkNextChange(),N=h+1,w.AddOriginalElement(h+1,f+1),E=B+1-s):(h=d[B-1],f=h-E-l,h>N&&w.MarkNextChange(),N=h,w.AddModifiedElement(h+1,f+1),E=B-1-s),z>=0&&(d=this.m_reverseHistory[z],s=d[0],x=1,k=d.length-1)}while(--z>=-1);C=w.getChanges()}return this.ConcatenateChanges(y,C)}ComputeRecursionPoint(e,t,i,n,s,r,a){let l=0,c=0,d=0,h=0,u=0,g=0;e--,i--,s[0]=0,r[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];const f=t-e+(n-i),m=f+1,_=new Int32Array(m),b=new Int32Array(m),v=n-i,y=t-e,C=e-i,w=t-n,k=(y-v)%2===0;_[v]=e,b[y]=t,a[0]=!1;for(let E=1;E<=f/2+1;E++){let N=0,z=0;d=this.ClipDiagonalBound(v-E,E,v,m),h=this.ClipDiagonalBound(v+E,E,v,m);for(let U=d;U<=h;U+=2){U===d||U<h&&_[U-1]<_[U+1]?l=_[U+1]:l=_[U-1]+1,c=l-(U-v)-C;const Z=l;for(;l<t&&c<n&&this.ElementsAreEqual(l+1,c+1);)l++,c++;if(_[U]=l,l+c>N+z&&(N=l,z=c),!k&&Math.abs(U-y)<=E-1&&l>=b[U])return s[0]=l,r[0]=c,Z<=b[U]&&E<=1448?this.WALKTRACE(v,d,h,C,y,u,g,w,_,b,l,t,s,c,n,r,k,a):null}const B=(N-e+(z-i)-E)/2;if(this.ContinueProcessingPredicate!==null&&!this.ContinueProcessingPredicate(N,B))return a[0]=!0,s[0]=N,r[0]=z,B>0&&E<=1448?this.WALKTRACE(v,d,h,C,y,u,g,w,_,b,l,t,s,c,n,r,k,a):(e++,i++,[new Cd(e,t-e+1,i,n-i+1)]);u=this.ClipDiagonalBound(y-E,E,y,m),g=this.ClipDiagonalBound(y+E,E,y,m);for(let U=u;U<=g;U+=2){U===u||U<g&&b[U-1]>=b[U+1]?l=b[U+1]-1:l=b[U-1],c=l-(U-y)-w;const Z=l;for(;l>e&&c>i&&this.ElementsAreEqual(l,c);)l--,c--;if(b[U]=l,k&&Math.abs(U-v)<=E&&l<=_[U])return s[0]=l,r[0]=c,Z>=_[U]&&E<=1448?this.WALKTRACE(v,d,h,C,y,u,g,w,_,b,l,t,s,c,n,r,k,a):null}if(E<=1447){let U=new Int32Array(h-d+2);U[0]=v-d+1,pp.Copy2(_,d,U,1,h-d+1),this.m_forwardHistory.push(U),U=new Int32Array(g-u+2),U[0]=y-u+1,pp.Copy2(b,u,U,1,g-u+1),this.m_reverseHistory.push(U)}}return this.WALKTRACE(v,d,h,C,y,u,g,w,_,b,l,t,s,c,n,r,k,a)}PrettifyChanges(e){for(let t=0;t<e.length;t++){const i=e[t],n=t<e.length-1?e[t+1].originalStart:this._originalElementsOrHash.length,s=t<e.length-1?e[t+1].modifiedStart:this._modifiedElementsOrHash.length,r=i.originalLength>0,a=i.modifiedLength>0;for(;i.originalStart+i.originalLength<n&&i.modifiedStart+i.modifiedLength<s&&(!r||this.OriginalElementsAreEqual(i.originalStart,i.originalStart+i.originalLength))&&(!a||this.ModifiedElementsAreEqual(i.modifiedStart,i.modifiedStart+i.modifiedLength));){const c=this.ElementsAreStrictEqual(i.originalStart,i.modifiedStart);if(this.ElementsAreStrictEqual(i.originalStart+i.originalLength,i.modifiedStart+i.modifiedLength)&&!c)break;i.originalStart++,i.modifiedStart++}const l=[null];if(t<e.length-1&&this.ChangesOverlap(e[t],e[t+1],l)){e[t]=l[0],e.splice(t+1,1),t--;continue}}for(let t=e.length-1;t>=0;t--){const i=e[t];let n=0,s=0;if(t>0){const h=e[t-1];n=h.originalStart+h.originalLength,s=h.modifiedStart+h.modifiedLength}const r=i.originalLength>0,a=i.modifiedLength>0;let l=0,c=this._boundaryScore(i.originalStart,i.originalLength,i.modifiedStart,i.modifiedLength);for(let h=1;;h++){const u=i.originalStart-h,g=i.modifiedStart-h;if(u<n||g<s||r&&!this.OriginalElementsAreEqual(u,u+i.originalLength)||a&&!this.ModifiedElementsAreEqual(g,g+i.modifiedLength))break;const m=(u===n&&g===s?5:0)+this._boundaryScore(u,i.originalLength,g,i.modifiedLength);m>c&&(c=m,l=h)}i.originalStart-=l,i.modifiedStart-=l;const d=[null];if(t>0&&this.ChangesOverlap(e[t-1],e[t],d)){e[t-1]=d[0],e.splice(t,1),t++;continue}}if(this._hasStrings)for(let t=1,i=e.length;t<i;t++){const n=e[t-1],s=e[t],r=s.originalStart-n.originalStart-n.originalLength,a=n.originalStart,l=s.originalStart+s.originalLength,c=l-a,d=n.modifiedStart,h=s.modifiedStart+s.modifiedLength,u=h-d;if(r<5&&c<20&&u<20){const g=this._findBetterContiguousSequence(a,c,d,u,r);if(g){const[f,m]=g;(f!==n.originalStart+n.originalLength||m!==n.modifiedStart+n.modifiedLength)&&(n.originalLength=f-n.originalStart,n.modifiedLength=m-n.modifiedStart,s.originalStart=f+r,s.modifiedStart=m+r,s.originalLength=l-s.originalStart,s.modifiedLength=h-s.modifiedStart)}}}return e}_findBetterContiguousSequence(e,t,i,n,s){if(t<s||n<s)return null;const r=e+t-s+1,a=i+n-s+1;let l=0,c=0,d=0;for(let h=e;h<r;h++)for(let u=i;u<a;u++){const g=this._contiguousSequenceScore(h,u,s);g>0&&g>l&&(l=g,c=h,d=u)}return l>0?[c,d]:null}_contiguousSequenceScore(e,t,i){let n=0;for(let s=0;s<i;s++){if(!this.ElementsAreEqual(e+s,t+s))return 0;n+=this._originalStringElements[e+s].length}return n}_OriginalIsBoundary(e){return e<=0||e>=this._originalElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._originalStringElements[e])}_OriginalRegionIsBoundary(e,t){if(this._OriginalIsBoundary(e)||this._OriginalIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._OriginalIsBoundary(i-1)||this._OriginalIsBoundary(i))return!0}return!1}_ModifiedIsBoundary(e){return e<=0||e>=this._modifiedElementsOrHash.length-1?!0:this._hasStrings&&/^\s*$/.test(this._modifiedStringElements[e])}_ModifiedRegionIsBoundary(e,t){if(this._ModifiedIsBoundary(e)||this._ModifiedIsBoundary(e-1))return!0;if(t>0){const i=e+t;if(this._ModifiedIsBoundary(i-1)||this._ModifiedIsBoundary(i))return!0}return!1}_boundaryScore(e,t,i,n){const s=this._OriginalRegionIsBoundary(e,t)?1:0,r=this._ModifiedRegionIsBoundary(i,n)?1:0;return s+r}ConcatenateChanges(e,t){const i=[];if(e.length===0||t.length===0)return t.length>0?t:e;if(this.ChangesOverlap(e[e.length-1],t[0],i)){const n=new Array(e.length+t.length-1);return pp.Copy(e,0,n,0,e.length-1),n[e.length-1]=i[0],pp.Copy(t,1,n,e.length,t.length-1),n}else{const n=new Array(e.length+t.length);return pp.Copy(e,0,n,0,e.length),pp.Copy(t,0,n,e.length,t.length),n}}ChangesOverlap(e,t,i){if(fp.Assert(e.originalStart<=t.originalStart,"Left change is not less than or equal to right change"),fp.Assert(e.modifiedStart<=t.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=t.originalStart||e.modifiedStart+e.modifiedLength>=t.modifiedStart){const n=e.originalStart;let s=e.originalLength;const r=e.modifiedStart;let a=e.modifiedLength;return e.originalStart+e.originalLength>=t.originalStart&&(s=t.originalStart+t.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=t.modifiedStart&&(a=t.modifiedStart+t.modifiedLength-e.modifiedStart),i[0]=new Cd(n,s,r,a),!0}else return i[0]=null,!1}ClipDiagonalBound(e,t,i,n){if(e>=0&&e<n)return e;const s=i,r=n-i-1,a=t%2===0;if(e<0){const l=s%2===0;return a===l?0:1}else{const l=r%2===0;return a===l?n-1:n-2}}}function W0(o){return o<0?0:o>255?255:o|0}function mp(o){return o<0?0:o>4294967295?4294967295:o|0}class ab{constructor(e){const t=W0(e);this._defaultValue=t,this._asciiMap=ab._createAsciiMap(t),this._map=new Map}static _createAsciiMap(e){const t=new Uint8Array(256);return t.fill(e),t}set(e,t){const i=W0(t);e>=0&&e<256?this._asciiMap[e]=i:this._map.set(e,i)}get(e){return e>=0&&e<256?this._asciiMap[e]:this._map.get(e)||this._defaultValue}clear(){this._asciiMap.fill(this._defaultValue),this._map.clear()}}class V0{constructor(){this._actual=new ab(0)}add(e){this._actual.set(e,1)}has(e){return this._actual.get(e)===1}clear(){return this._actual.clear()}}class $te{constructor(e,t,i){const n=new Uint8Array(e*t);for(let s=0,r=e*t;s<r;s++)n[s]=i;this._data=n,this.rows=e,this.cols=t}get(e,t){return this._data[e*this.cols+t]}set(e,t,i){this._data[e*this.cols+t]=i}}class Kte{constructor(e){let t=0,i=0;for(let s=0,r=e.length;s<r;s++){const[a,l,c]=e[s];l>t&&(t=l),a>i&&(i=a),c>i&&(i=c)}t++,i++;const n=new $te(i,t,0);for(let s=0,r=e.length;s<r;s++){const[a,l,c]=e[s];n.set(a,l,c)}this._states=n,this._maxCharCode=t}nextState(e,t){return t<0||t>=this._maxCharCode?0:this._states.get(e,t)}}let uI=null;function jte(){return uI===null&&(uI=new Kte([[1,104,2],[1,72,2],[1,102,6],[1,70,6],[2,116,3],[2,84,3],[3,116,4],[3,84,4],[4,112,5],[4,80,5],[5,115,9],[5,83,9],[5,58,10],[6,105,7],[6,73,7],[7,108,8],[7,76,8],[8,101,9],[8,69,9],[9,58,10],[10,47,11],[11,47,12]])),uI}let zb=null;function qte(){if(zb===null){zb=new ab(0);const o=` 	<>'"、。｡､，．：；‘〈「『〔（［｛｢｣｝］）〕』」〉’｀～…`;for(let t=0;t<o.length;t++)zb.set(o.charCodeAt(t),1);const e=".,;:";for(let t=0;t<e.length;t++)zb.set(e.charCodeAt(t),2)}return zb}class H0{static _createLink(e,t,i,n,s){let r=s-1;do{const a=t.charCodeAt(r);if(e.get(a)!==2)break;r--}while(r>n);if(n>0){const a=t.charCodeAt(n-1),l=t.charCodeAt(r);(a===40&&l===41||a===91&&l===93||a===123&&l===125)&&r--}return{range:{startLineNumber:i,startColumn:n+1,endLineNumber:i,endColumn:r+2},url:t.substring(n,r+1)}}static computeLinks(e,t=jte()){const i=qte(),n=[];for(let s=1,r=e.getLineCount();s<=r;s++){const a=e.getLineContent(s),l=a.length;let c=0,d=0,h=0,u=1,g=!1,f=!1,m=!1,_=!1;for(;c<l;){let b=!1;const v=a.charCodeAt(c);if(u===13){let y;switch(v){case 40:g=!0,y=0;break;case 41:y=g?0:1;break;case 91:m=!0,f=!0,y=0;break;case 93:m=!1,y=f?0:1;break;case 123:_=!0,y=0;break;case 125:y=_?0:1;break;case 39:case 34:case 96:h===v?y=1:h===39||h===34||h===96?y=0:y=1;break;case 42:y=h===42?1:0;break;case 124:y=h===124?1:0;break;case 32:y=m?0:1;break;default:y=i.get(v)}y===1&&(n.push(H0._createLink(i,a,s,d,c)),b=!0)}else if(u===12){let y;v===91?(f=!0,y=0):y=i.get(v),y===1?b=!0:u=13}else u=t.nextState(u,v),u===0&&(b=!0);b&&(u=1,g=!1,f=!1,_=!1,d=c+1,h=v),c++}u===13&&n.push(H0._createLink(i,a,s,d,l))}return n}}function Zte(o){return!o||typeof o.getLineCount!="function"||typeof o.getLineContent!="function"?[]:H0.computeLinks(o)}const xk=class xk{constructor(){this._defaultValueSet=[["true","false"],["True","False"],["Private","Public","Friend","ReadOnly","Partial","Protected","WriteOnly"],["public","protected","private"]]}navigateValueSet(e,t,i,n,s){if(e&&t){const r=this.doNavigateValueSet(t,s);if(r)return{range:e,value:r}}if(i&&n){const r=this.doNavigateValueSet(n,s);if(r)return{range:i,value:r}}return null}doNavigateValueSet(e,t){const i=this.numberReplace(e,t);return i!==null?i:this.textReplace(e,t)}numberReplace(e,t){const i=Math.pow(10,e.length-(e.lastIndexOf(".")+1));let n=Number(e);const s=parseFloat(e);return!isNaN(n)&&!isNaN(s)&&n===s?n===0&&!t?null:(n=Math.floor(n*i),n+=t?i:-i,String(n/i)):null}textReplace(e,t){return this.valueSetsReplace(this._defaultValueSet,e,t)}valueSetsReplace(e,t,i){let n=null;for(let s=0,r=e.length;n===null&&s<r;s++)n=this.valueSetReplace(e[s],t,i);return n}valueSetReplace(e,t,i){let n=e.indexOf(t);return n>=0?(n+=i?1:-1,n<0?n=e.length-1:n%=e.length,e[n]):null}};xk.INSTANCE=new xk;let SP=xk;const SC=class SC{static getChannel(e){return e.getChannel(SC.CHANNEL_NAME)}static setChannel(e,t){e.setChannel(SC.CHANNEL_NAME,t)}};SC.CHANNEL_NAME="editorWorkerHost";let xP=SC;var uV,gV;class Yte{constructor(e,t){this.uri=e,this.value=t}}function Xte(o){return Array.isArray(o)}const Ku=class Ku{constructor(e,t){if(this[uV]="ResourceMap",e instanceof Ku)this.map=new Map(e.map),this.toKey=t??Ku.defaultToKey;else if(Xte(e)){this.map=new Map,this.toKey=t??Ku.defaultToKey;for(const[i,n]of e)this.set(i,n)}else this.map=new Map,this.toKey=e??Ku.defaultToKey}set(e,t){return this.map.set(this.toKey(e),new Yte(e,t)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,t){typeof t<"u"&&(e=e.bind(t));for(const[i,n]of this.map)e(n.value,n.uri,this)}*values(){for(const e of this.map.values())yield e.value}*keys(){for(const e of this.map.values())yield e.uri}*entries(){for(const e of this.map.values())yield[e.uri,e.value]}*[(uV=Symbol.toStringTag,Symbol.iterator)](){for(const[,e]of this.map)yield[e.uri,e.value]}};Ku.defaultToKey=e=>e.toString();let on=Ku;class Qte{constructor(){this[gV]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=0){const i=this._map.get(e);if(i)return t!==0&&this.touch(i,t),i.value}set(e,t,i=0){let n=this._map.get(e);if(n)n.value=t,i!==0&&this.touch(n,i);else{switch(n={key:e,value:t,next:void 0,previous:void 0},i){case 0:this.addItemLast(n);break;case 1:this.addItemFirst(n);break;case 2:this.addItemLast(n);break;default:this.addItemLast(n);break}this._map.set(e,n),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let n=this._head;for(;n;){if(t?e.bind(t)(n.value,n.key,this):e(n.value,n.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");n=n.next}}keys(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.key,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}values(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:i.value,done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}entries(){const e=this,t=this._state;let i=this._head;const n={[Symbol.iterator](){return n},next(){if(e._state!==t)throw new Error("LinkedMap got modified during iteration.");if(i){const s={value:[i.key,i.value],done:!1};return i=i.next,s}else return{value:void 0,done:!0}}};return n}[(gV=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._tail,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.previous,i--;this._tail=t,this._size=i,t&&(t.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==1&&t!==2)){if(t===1){if(e===this._head)return;const i=e.next,n=e.previous;e===this._tail?(n.next=void 0,this._tail=n):(i.previous=n,n.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===2){if(e===this._tail)return;const i=e.next,n=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=n,n.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}class Jte extends Qte{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get(e,t=2){return super.get(e,t)}peek(e){return super.get(e,0)}set(e,t){return super.set(e,t,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}}class Vl extends Jte{constructor(e,t=1){super(e,t)}trim(e){this.trimOld(e)}set(e,t){return super.set(e,t),this.checkTrim(),this}}class eie{constructor(e){if(this._m1=new Map,this._m2=new Map,e)for(const[t,i]of e)this.set(t,i)}clear(){this._m1.clear(),this._m2.clear()}set(e,t){this._m1.set(e,t),this._m2.set(t,e)}get(e){return this._m1.get(e)}getKey(e){return this._m2.get(e)}delete(e){const t=this._m1.get(e);return t===void 0?!1:(this._m1.delete(e),this._m2.delete(t),!0)}keys(){return this._m1.keys()}values(){return this._m1.values()}}class Y4{constructor(){this.map=new Map}add(e,t){let i=this.map.get(e);i||(i=new Set,this.map.set(e,i)),i.add(t)}delete(e,t){const i=this.map.get(e);i&&(i.delete(t),i.size===0&&this.map.delete(e))}forEach(e,t){const i=this.map.get(e);i&&i.forEach(t)}get(e){const t=this.map.get(e);return t||new Set}}class tie extends ab{constructor(e,t){super(0),this._segmenter=null,this._cachedLine=null,this._cachedSegments=[],this.intlSegmenterLocales=t,this.intlSegmenterLocales.length>0?this._segmenter=new Intl.Segmenter(this.intlSegmenterLocales,{granularity:"word"}):this._segmenter=null;for(let i=0,n=e.length;i<n;i++)this.set(e.charCodeAt(i),2);this.set(32,1),this.set(9,1)}findPrevIntlWordBeforeOrAtOffset(e,t){let i=null;for(const n of this._getIntlSegmenterWordsOnLine(e)){if(n.index>t)break;i=n}return i}findNextIntlWordAtOrAfterOffset(e,t){for(const i of this._getIntlSegmenterWordsOnLine(e))if(!(i.index<t))return i;return null}_getIntlSegmenterWordsOnLine(e){return this._segmenter?this._cachedLine===e?this._cachedSegments:(this._cachedLine=e,this._cachedSegments=this._filterWordSegments(this._segmenter.segment(e)),this._cachedSegments):[]}_filterWordSegments(e){const t=[];for(const i of e)this._isWordLike(i)&&t.push(i);return t}_isWordLike(e){return!!e.isWordLike}}const fV=new Vl(10);function gr(o,e){const t=`${o}/${e.join(",")}`;let i=fV.get(t);return i||(i=new tie(o,e),fV.set(t,i)),i}var Ao;(function(o){o[o.Left=1]="Left",o[o.Center=2]="Center",o[o.Right=4]="Right",o[o.Full=7]="Full"})(Ao||(Ao={}));var Ur;(function(o){o[o.Left=1]="Left",o[o.Center=2]="Center",o[o.Right=3]="Right"})(Ur||(Ur={}));var Or;(function(o){o[o.Both=0]="Both",o[o.Right=1]="Right",o[o.Left=2]="Left",o[o.None=3]="None"})(Or||(Or={}));class P1{get originalIndentSize(){return this._indentSizeIsTabSize?"tabSize":this.indentSize}constructor(e){this._textModelResolvedOptionsBrand=void 0,this.tabSize=Math.max(1,e.tabSize|0),e.indentSize==="tabSize"?(this.indentSize=this.tabSize,this._indentSizeIsTabSize=!0):(this.indentSize=Math.max(1,e.indentSize|0),this._indentSizeIsTabSize=!1),this.insertSpaces=!!e.insertSpaces,this.defaultEOL=e.defaultEOL|0,this.trimAutoWhitespace=!!e.trimAutoWhitespace,this.bracketPairColorizationOptions=e.bracketPairColorizationOptions}equals(e){return this.tabSize===e.tabSize&&this._indentSizeIsTabSize===e._indentSizeIsTabSize&&this.indentSize===e.indentSize&&this.insertSpaces===e.insertSpaces&&this.defaultEOL===e.defaultEOL&&this.trimAutoWhitespace===e.trimAutoWhitespace&&eo(this.bracketPairColorizationOptions,e.bracketPairColorizationOptions)}createChangeEvent(e){return{tabSize:this.tabSize!==e.tabSize,indentSize:this.indentSize!==e.indentSize,insertSpaces:this.insertSpaces!==e.insertSpaces,trimAutoWhitespace:this.trimAutoWhitespace!==e.trimAutoWhitespace}}}class QC{constructor(e,t){this._findMatchBrand=void 0,this.range=e,this.matches=t}}function iie(o){return o&&typeof o.read=="function"}class gI{constructor(e,t,i,n,s,r){this.identifier=e,this.range=t,this.text=i,this.forceMoveMarkers=n,this.isAutoWhitespaceEdit=s,this._isTracked=r}}class nie{constructor(e,t,i){this.regex=e,this.wordSeparators=t,this.simpleSearch=i}}class sie{constructor(e,t,i){this.reverseEdits=e,this.changes=t,this.trimAutoWhitespaceLineNumbers=i}}function EU(o){return!o.isTooLargeForSyncing()&&!o.isForSimpleWidget}const oie=999;class Su{constructor(e,t,i,n){this.searchString=e,this.isRegex=t,this.matchCase=i,this.wordSeparators=n}parseSearchRequest(){if(this.searchString==="")return null;let e;this.isRegex?e=rie(this.searchString):e=this.searchString.indexOf(`
`)>=0;let t=null;try{t=Lz(this.searchString,this.isRegex,{matchCase:this.matchCase,wholeWord:!1,multiline:e,global:!0,unicode:!0})}catch{return null}if(!t)return null;let i=!this.isRegex&&!e;return i&&this.searchString.toLowerCase()!==this.searchString.toUpperCase()&&(i=this.matchCase),new nie(t,this.wordSeparators?gr(this.wordSeparators,[]):null,i?this.searchString:null)}}function rie(o){if(!o||o.length===0)return!1;for(let e=0,t=o.length;e<t;e++){const i=o.charCodeAt(e);if(i===10)return!0;if(i===92){if(e++,e>=t)break;const n=o.charCodeAt(e);if(n===110||n===114||n===87)return!0}}return!1}function Ru(o,e,t){if(!t)return new QC(o,null);const i=[];for(let n=0,s=e.length;n<s;n++)i[n]=e[n];return new QC(o,i)}class pV{constructor(e){const t=[];let i=0;for(let n=0,s=e.length;n<s;n++)e.charCodeAt(n)===10&&(t[i++]=n);this._lineFeedsOffsets=t}findLineFeedCountBeforeOffset(e){const t=this._lineFeedsOffsets;let i=0,n=t.length-1;if(n===-1||e<=t[0])return 0;for(;i<n;){const s=i+((n-i)/2>>0);t[s]>=e?n=s-1:t[s+1]>=e?(i=s,n=s):i=s+1}return i+1}}class wS{static findMatches(e,t,i,n,s){const r=t.parseSearchRequest();return r?r.regex.multiline?this._doFindMatchesMultiline(e,i,new jp(r.wordSeparators,r.regex),n,s):this._doFindMatchesLineByLine(e,i,r,n,s):[]}static _getMultilineMatchRange(e,t,i,n,s,r){let a,l=0;n?(l=n.findLineFeedCountBeforeOffset(s),a=t+s+l):a=t+s;let c;if(n){const g=n.findLineFeedCountBeforeOffset(s+r.length)-l;c=a+r.length+g}else c=a+r.length;const d=e.getPositionAt(a),h=e.getPositionAt(c);return new L(d.lineNumber,d.column,h.lineNumber,h.column)}static _doFindMatchesMultiline(e,t,i,n,s){const r=e.getOffsetAt(t.getStartPosition()),a=e.getValueInRange(t,1),l=e.getEOL()===`\r
`?new pV(a):null,c=[];let d=0,h;for(i.reset(0);h=i.next(a);)if(c[d++]=Ru(this._getMultilineMatchRange(e,r,a,l,h.index,h[0]),h,n),d>=s)return c;return c}static _doFindMatchesLineByLine(e,t,i,n,s){const r=[];let a=0;if(t.startLineNumber===t.endLineNumber){const c=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);return a=this._findMatchesInLine(i,c,t.startLineNumber,t.startColumn-1,a,r,n,s),r}const l=e.getLineContent(t.startLineNumber).substring(t.startColumn-1);a=this._findMatchesInLine(i,l,t.startLineNumber,t.startColumn-1,a,r,n,s);for(let c=t.startLineNumber+1;c<t.endLineNumber&&a<s;c++)a=this._findMatchesInLine(i,e.getLineContent(c),c,0,a,r,n,s);if(a<s){const c=e.getLineContent(t.endLineNumber).substring(0,t.endColumn-1);a=this._findMatchesInLine(i,c,t.endLineNumber,0,a,r,n,s)}return r}static _findMatchesInLine(e,t,i,n,s,r,a,l){const c=e.wordSeparators;if(!a&&e.simpleSearch){const u=e.simpleSearch,g=u.length,f=t.length;let m=-g;for(;(m=t.indexOf(u,m+g))!==-1;)if((!c||X4(c,t,f,m,g))&&(r[s++]=new QC(new L(i,m+1+n,i,m+1+g+n),null),s>=l))return s;return s}const d=new jp(e.wordSeparators,e.regex);let h;d.reset(0);do if(h=d.next(t),h&&(r[s++]=Ru(new L(i,h.index+1+n,i,h.index+1+h[0].length+n),h,a),s>=l))return s;while(h);return s}static findNextMatch(e,t,i,n){const s=t.parseSearchRequest();if(!s)return null;const r=new jp(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindNextMatchMultiline(e,i,r,n):this._doFindNextMatchLineByLine(e,i,r,n)}static _doFindNextMatchMultiline(e,t,i,n){const s=new A(t.lineNumber,1),r=e.getOffsetAt(s),a=e.getLineCount(),l=e.getValueInRange(new L(s.lineNumber,s.column,a,e.getLineMaxColumn(a)),1),c=e.getEOL()===`\r
`?new pV(l):null;i.reset(t.column-1);const d=i.next(l);return d?Ru(this._getMultilineMatchRange(e,r,l,c,d.index,d[0]),d,n):t.lineNumber!==1||t.column!==1?this._doFindNextMatchMultiline(e,new A(1,1),i,n):null}static _doFindNextMatchLineByLine(e,t,i,n){const s=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r),l=this._findFirstMatchInLine(i,a,r,t.column,n);if(l)return l;for(let c=1;c<=s;c++){const d=(r+c-1)%s,h=e.getLineContent(d+1),u=this._findFirstMatchInLine(i,h,d+1,1,n);if(u)return u}return null}static _findFirstMatchInLine(e,t,i,n,s){e.reset(n-1);const r=e.next(t);return r?Ru(new L(i,r.index+1,i,r.index+1+r[0].length),r,s):null}static findPreviousMatch(e,t,i,n){const s=t.parseSearchRequest();if(!s)return null;const r=new jp(s.wordSeparators,s.regex);return s.regex.multiline?this._doFindPreviousMatchMultiline(e,i,r,n):this._doFindPreviousMatchLineByLine(e,i,r,n)}static _doFindPreviousMatchMultiline(e,t,i,n){const s=this._doFindMatchesMultiline(e,new L(1,1,t.lineNumber,t.column),i,n,10*oie);if(s.length>0)return s[s.length-1];const r=e.getLineCount();return t.lineNumber!==r||t.column!==e.getLineMaxColumn(r)?this._doFindPreviousMatchMultiline(e,new A(r,e.getLineMaxColumn(r)),i,n):null}static _doFindPreviousMatchLineByLine(e,t,i,n){const s=e.getLineCount(),r=t.lineNumber,a=e.getLineContent(r).substring(0,t.column-1),l=this._findLastMatchInLine(i,a,r,n);if(l)return l;for(let c=1;c<=s;c++){const d=(s+r-c-1)%s,h=e.getLineContent(d+1),u=this._findLastMatchInLine(i,h,d+1,n);if(u)return u}return null}static _findLastMatchInLine(e,t,i,n){let s=null,r;for(e.reset(0);r=e.next(t);)s=Ru(new L(i,r.index+1,i,r.index+1+r[0].length),r,n);return s}}function aie(o,e,t,i,n){if(i===0)return!0;const s=e.charCodeAt(i-1);if(o.get(s)!==0||s===13||s===10)return!0;if(n>0){const r=e.charCodeAt(i);if(o.get(r)!==0)return!0}return!1}function lie(o,e,t,i,n){if(i+n===t)return!0;const s=e.charCodeAt(i+n);if(o.get(s)!==0||s===13||s===10)return!0;if(n>0){const r=e.charCodeAt(i+n-1);if(o.get(r)!==0)return!0}return!1}function X4(o,e,t,i,n){return aie(o,e,t,i,n)&&lie(o,e,t,i,n)}class jp{constructor(e,t){this._wordSeparators=e,this._searchRegex=t,this._prevMatchStartIndex=-1,this._prevMatchLength=0}reset(e){this._searchRegex.lastIndex=e,this._prevMatchStartIndex=-1,this._prevMatchLength=0}next(e){const t=e.length;let i;do{if(this._prevMatchStartIndex+this._prevMatchLength===t||(i=this._searchRegex.exec(e),!i))return null;const n=i.index,s=i[0].length;if(n===this._prevMatchStartIndex&&s===this._prevMatchLength){if(s===0){T0(e,t,this._searchRegex.lastIndex)>65535?this._searchRegex.lastIndex+=2:this._searchRegex.lastIndex+=1;continue}return null}if(this._prevMatchStartIndex=n,this._prevMatchLength=s,!this._wordSeparators||X4(this._wordSeparators,e,t,n,s))return i}while(i);return null}}class Q4{static computeUnicodeHighlights(e,t,i){const n=i?i.startLineNumber:1,s=i?i.endLineNumber:e.getLineCount(),r=new mV(t),a=r.getCandidateCodePoints();let l;a==="allNonBasicAscii"?l=new RegExp("[^\\t\\n\\r\\x20-\\x7E]","g"):l=new RegExp(`${cie(Array.from(a))}`,"g");const c=new jp(null,l),d=[];let h=!1,u,g=0,f=0,m=0;e:for(let _=n,b=s;_<=b;_++){const v=e.getLineContent(_),y=v.length;c.reset(0);do if(u=c.next(v),u){let C=u.index,w=u.index+u[0].length;if(C>0){const N=v.charCodeAt(C-1);$i(N)&&C--}if(w+1<y){const N=v.charCodeAt(w-1);$i(N)&&w++}const x=v.substring(C,w);let k=HC(C+1,w4,v,0);k&&k.endColumn<=C+1&&(k=null);const E=r.shouldHighlightNonBasicASCII(x,k?k.word:null);if(E!==0){if(E===3?g++:E===2?f++:E===1?m++:_T(),d.length>=1e3){h=!0;break e}d.push(new L(_,C+1,_,w+1))}}while(u)}return{ranges:d,hasMore:h,ambiguousCharacterCount:g,invisibleCharacterCount:f,nonBasicAsciiCharacterCount:m}}static computeUnicodeHighlightReason(e,t){const i=new mV(t);switch(i.shouldHighlightNonBasicASCII(e,null)){case 0:return null;case 2:return{kind:1};case 3:{const s=e.codePointAt(0),r=i.ambiguousCharacters.getPrimaryConfusable(s),a=qC.getLocales().filter(l=>!qC.getInstance(new Set([...t.allowedLocales,l])).isAmbiguous(s));return{kind:0,confusableWith:String.fromCodePoint(r),notAmbiguousInLocales:a}}case 1:return{kind:2}}}}function cie(o,e){return`[${Fo(o.map(i=>String.fromCodePoint(i)).join(""))}]`}class mV{constructor(e){this.options=e,this.allowedCodePoints=new Set(e.allowedCodePoints),this.ambiguousCharacters=qC.getInstance(new Set(e.allowedLocales))}getCandidateCodePoints(){if(this.options.nonBasicASCII)return"allNonBasicAscii";const e=new Set;if(this.options.invisibleCharacters)for(const t of og.codePoints)_V(String.fromCodePoint(t))||e.add(t);if(this.options.ambiguousCharacters)for(const t of this.ambiguousCharacters.getConfusableCodePoints())e.add(t);for(const t of this.allowedCodePoints)e.delete(t);return e}shouldHighlightNonBasicASCII(e,t){const i=e.codePointAt(0);if(this.allowedCodePoints.has(i))return 0;if(this.options.nonBasicASCII)return 1;let n=!1,s=!1;if(t)for(const r of t){const a=r.codePointAt(0),l=Sw(r);n=n||l,!l&&!this.ambiguousCharacters.isAmbiguous(a)&&!og.isInvisibleCharacter(a)&&(s=!0)}return!n&&s?0:this.options.invisibleCharacters&&!_V(e)&&og.isInvisibleCharacter(i)?2:this.options.ambiguousCharacters&&this.ambiguousCharacters.isAmbiguous(i)?3:0}}function _V(o){return o===" "||o===`
`||o==="	"}class A1{constructor(e,t,i){this.changes=e,this.moves=t,this.hitTimeout=i}}class TU{constructor(e,t){this.lineRangeMapping=e,this.changes=t}}class je{static addRange(e,t){let i=0;for(;i<t.length&&t[i].endExclusive<e.start;)i++;let n=i;for(;n<t.length&&t[n].start<=e.endExclusive;)n++;if(i===n)t.splice(i,0,e);else{const s=Math.min(e.start,t[i].start),r=Math.max(e.endExclusive,t[n-1].endExclusive);t.splice(i,n-i,new je(s,r))}}static tryCreate(e,t){if(!(e>t))return new je(e,t)}static ofLength(e){return new je(0,e)}static ofStartAndLength(e,t){return new je(e,e+t)}constructor(e,t){if(this.start=e,this.endExclusive=t,e>t)throw new pt(`Invalid range: ${this.toString()}`)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new je(this.start+e,this.endExclusive+e)}deltaStart(e){return new je(this.start+e,this.endExclusive)}deltaEnd(e){return new je(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new je(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);if(t<=i)return new je(t,i)}intersects(e){const t=Math.max(this.start,e.start),i=Math.min(this.endExclusive,e.endExclusive);return t<i}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new pt(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new pt(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}forEach(e){for(let t=this.start;t<this.endExclusive;t++)e(t)}}class J4{constructor(){this._sortedRanges=[]}addRange(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<e.start;)t++;let i=t;for(;i<this._sortedRanges.length&&this._sortedRanges[i].start<=e.endExclusive;)i++;if(t===i)this._sortedRanges.splice(t,0,e);else{const n=Math.min(e.start,this._sortedRanges[t].start),s=Math.max(e.endExclusive,this._sortedRanges[i-1].endExclusive);this._sortedRanges.splice(t,i-t,new je(n,s))}}toString(){return this._sortedRanges.map(e=>e.toString()).join(", ")}intersectsStrict(e){let t=0;for(;t<this._sortedRanges.length&&this._sortedRanges[t].endExclusive<=e.start;)t++;return t<this._sortedRanges.length&&this._sortedRanges[t].start<e.endExclusive}intersectWithRange(e){const t=new J4;for(const i of this._sortedRanges){const n=i.intersect(e);n&&t.addRange(n)}return t}intersectWithRangeLength(e){return this.intersectWithRange(e).length}get length(){return this._sortedRanges.reduce((e,t)=>e+t.length,0)}}function JC(o,e){const t=die(o,e);if(t!==-1)return o[t]}function die(o,e,t=o.length-1){for(let i=t;i>=0;i--){const n=o[i];if(e(n))return i}return-1}function b_(o,e){const t=ey(o,e);return t===-1?void 0:o[t]}function ey(o,e,t=0,i=o.length){let n=t,s=i;for(;n<s;){const r=Math.floor((n+s)/2);e(o[r])?n=r+1:s=r}return n-1}function hie(o,e){const t=ty(o,e);return t===o.length?void 0:o[t]}function ty(o,e,t=0,i=o.length){let n=t,s=i;for(;n<s;){const r=Math.floor((n+s)/2);e(o[r])?s=r:n=r+1}return n}const Lk=class Lk{constructor(e){this._array=e,this._findLastMonotonousLastIdx=0}findLastMonotonous(e){if(Lk.assertInvariants){if(this._prevFindLastPredicate){for(const i of this._array)if(this._prevFindLastPredicate(i)&&!e(i))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}const t=ey(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=t+1,t===-1?void 0:this._array[t]}};Lk.assertInvariants=!1;let z0=Lk;function e5(o,e){if(o.length===0)return;let t=o[0];for(let i=1;i<o.length;i++){const n=o[i];e(n,t)>0&&(t=n)}return t}function uie(o,e){if(o.length===0)return;let t=o[0];for(let i=1;i<o.length;i++){const n=o[i];e(n,t)>=0&&(t=n)}return t}function gie(o,e){return e5(o,(t,i)=>-e(t,i))}function fie(o,e){if(o.length===0)return-1;let t=0;for(let i=1;i<o.length;i++){const n=o[i];e(n,o[t])>0&&(t=i)}return t}function pie(o,e){for(const t of o){const i=e(t);if(i!==void 0)return i}}let Be=class tc{static fromRangeInclusive(e){return new tc(e.startLineNumber,e.endLineNumber+1)}static joinMany(e){if(e.length===0)return[];let t=new sr(e[0].slice());for(let i=1;i<e.length;i++)t=t.getUnion(new sr(e[i].slice()));return t.ranges}static join(e){if(e.length===0)throw new pt("lineRanges cannot be empty");let t=e[0].startLineNumber,i=e[0].endLineNumberExclusive;for(let n=1;n<e.length;n++)t=Math.min(t,e[n].startLineNumber),i=Math.max(i,e[n].endLineNumberExclusive);return new tc(t,i)}static ofLength(e,t){return new tc(e,e+t)}static deserialize(e){return new tc(e[0],e[1])}constructor(e,t){if(e>t)throw new pt(`startLineNumber ${e} cannot be after endLineNumberExclusive ${t}`);this.startLineNumber=e,this.endLineNumberExclusive=t}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new tc(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new tc(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new tc(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(t<=i)return new tc(t,i)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new L(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new L(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){const t=[];for(let i=this.startLineNumber;i<this.endLineNumberExclusive;i++)t.push(e(i));return t}forEach(e){for(let t=this.startLineNumber;t<this.endLineNumberExclusive;t++)e(t)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new je(this.startLineNumber-1,this.endLineNumberExclusive-1)}};class sr{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;const t=ty(this._normalizedRanges,n=>n.endLineNumberExclusive>=e.startLineNumber),i=ey(this._normalizedRanges,n=>n.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)this._normalizedRanges.splice(t,0,e);else if(t===i-1){const n=this._normalizedRanges[t];this._normalizedRanges[t]=n.join(e)}else{const n=this._normalizedRanges[t].join(this._normalizedRanges[i-1]).join(e);this._normalizedRanges.splice(t,i-t,n)}}contains(e){const t=b_(this._normalizedRanges,i=>i.startLineNumber<=e);return!!t&&t.endLineNumberExclusive>e}intersects(e){const t=b_(this._normalizedRanges,i=>i.startLineNumber<e.endLineNumberExclusive);return!!t&&t.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;const t=[];let i=0,n=0,s=null;for(;i<this._normalizedRanges.length||n<e._normalizedRanges.length;){let r=null;if(i<this._normalizedRanges.length&&n<e._normalizedRanges.length){const a=this._normalizedRanges[i],l=e._normalizedRanges[n];a.startLineNumber<l.startLineNumber?(r=a,i++):(r=l,n++)}else i<this._normalizedRanges.length?(r=this._normalizedRanges[i],i++):(r=e._normalizedRanges[n],n++);s===null?s=r:s.endLineNumberExclusive>=r.startLineNumber?s=new Be(s.startLineNumber,Math.max(s.endLineNumberExclusive,r.endLineNumberExclusive)):(t.push(s),s=r)}return s!==null&&t.push(s),new sr(t)}subtractFrom(e){const t=ty(this._normalizedRanges,r=>r.endLineNumberExclusive>=e.startLineNumber),i=ey(this._normalizedRanges,r=>r.startLineNumber<=e.endLineNumberExclusive)+1;if(t===i)return new sr([e]);const n=[];let s=e.startLineNumber;for(let r=t;r<i;r++){const a=this._normalizedRanges[r];a.startLineNumber>s&&n.push(new Be(s,a.startLineNumber)),s=a.endLineNumberExclusive}return s<e.endLineNumberExclusive&&n.push(new Be(s,e.endLineNumberExclusive)),new sr(n)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){const t=[];let i=0,n=0;for(;i<this._normalizedRanges.length&&n<e._normalizedRanges.length;){const s=this._normalizedRanges[i],r=e._normalizedRanges[n],a=s.intersect(r);a&&!a.isEmpty&&t.push(a),s.endLineNumberExclusive<r.endLineNumberExclusive?i++:n++}return new sr(t)}getWithDelta(e){return new sr(this._normalizedRanges.map(t=>t.delta(e)))}}const kd=class kd{static betweenPositions(e,t){return e.lineNumber===t.lineNumber?new kd(0,t.column-e.column):new kd(t.lineNumber-e.lineNumber,t.column-1)}static ofRange(e){return kd.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let t=0,i=0;for(const n of e)n===`
`?(t++,i=0):i++;return new kd(t,i)}constructor(e,t){this.lineCount=e,this.columnCount=t}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}createRange(e){return this.lineCount===0?new L(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new L(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new A(e.lineNumber,e.column+this.columnCount):new A(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};kd.zero=new kd(0,0);let Gr=kd;class mie{constructor(e){this.text=e,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)e.charAt(t)===`
`&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}getOffsetRange(e){return new je(this.getOffset(e.getStartPosition()),this.getOffset(e.getEndPosition()))}get textLength(){const e=this.lineStartOffsetByLineIdx.length-1;return new Gr(e,this.text.length-this.lineStartOffsetByLineIdx[e])}}class t5{constructor(e){this.edits=e,yf(()=>j4(e,(t,i)=>t.range.getEndPosition().isBeforeOrEqual(i.range.getStartPosition())))}apply(e){let t="",i=new A(1,1);for(const s of this.edits){const r=s.range,a=r.getStartPosition(),l=r.getEndPosition(),c=bV(i,a);c.isEmpty()||(t+=e.getValueOfRange(c)),t+=s.text,i=l}const n=bV(i,e.endPositionExclusive);return n.isEmpty()||(t+=e.getValueOfRange(n)),t}applyToString(e){const t=new _ie(e);return this.apply(t)}getNewRanges(){const e=[];let t=0,i=0,n=0;for(const s of this.edits){const r=Gr.ofText(s.text),a=A.lift({lineNumber:s.range.startLineNumber+i,column:s.range.startColumn+(s.range.startLineNumber===t?n:0)}),l=r.createRange(a);e.push(l),i=l.endLineNumber-s.range.endLineNumber,n=l.endColumn-s.range.endColumn,t=s.range.endLineNumber}return e}}class Dl{constructor(e,t){this.range=e,this.text=t}toSingleEditOperation(){return{range:this.range,text:this.text}}}function bV(o,e){if(o.lineNumber===e.lineNumber&&o.column===Number.MAX_SAFE_INTEGER)return L.fromPositions(e,e);if(!o.isBeforeOrEqual(e))throw new pt("start must be before end");return new L(o.lineNumber,o.column,e.lineNumber,e.column)}class DU{get endPositionExclusive(){return this.length.addToPosition(new A(1,1))}}class _ie extends DU{constructor(e){super(),this.value=e,this._t=new mie(this.value)}getValueOfRange(e){return this._t.getOffsetRange(e).substring(this.value)}get length(){return this._t.textLength}}class qn{static inverse(e,t,i){const n=[];let s=1,r=1;for(const l of e){const c=new qn(new Be(s,l.original.startLineNumber),new Be(r,l.modified.startLineNumber));c.modified.isEmpty||n.push(c),s=l.original.endLineNumberExclusive,r=l.modified.endLineNumberExclusive}const a=new qn(new Be(s,t+1),new Be(r,i+1));return a.modified.isEmpty||n.push(a),n}static clip(e,t,i){const n=[];for(const s of e){const r=s.original.intersect(t),a=s.modified.intersect(i);r&&!r.isEmpty&&a&&!a.isEmpty&&n.push(new qn(r,a))}return n}constructor(e,t){this.original=e,this.modified=t}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new qn(this.modified,this.original)}join(e){return new qn(this.original.join(e.original),this.modified.join(e.modified))}toRangeMapping(){const e=this.original.toInclusiveRange(),t=this.modified.toInclusiveRange();if(e&&t)return new So(e,t);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new pt("not a valid diff");return new So(new L(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new L(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new So(new L(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new L(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}toRangeMapping2(e,t){if(vV(this.original.endLineNumberExclusive,e)&&vV(this.modified.endLineNumberExclusive,t))return new So(new L(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new L(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1));if(!this.original.isEmpty&&!this.modified.isEmpty)return new So(L.fromPositions(new A(this.original.startLineNumber,1),_p(new A(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),L.fromPositions(new A(this.modified.startLineNumber,1),_p(new A(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));if(this.original.startLineNumber>1&&this.modified.startLineNumber>1)return new So(L.fromPositions(_p(new A(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER),e),_p(new A(this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),e)),L.fromPositions(_p(new A(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER),t),_p(new A(this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),t)));throw new pt}}function _p(o,e){if(o.lineNumber<1)return new A(1,1);if(o.lineNumber>e.length)return new A(e.length,e[e.length-1].length+1);const t=e[o.lineNumber-1];return o.column>t.length+1?new A(o.lineNumber,t.length+1):o}function vV(o,e){return o>=1&&o<=e.length}class Mo extends qn{static fromRangeMappings(e){const t=Be.join(e.map(n=>Be.fromRangeInclusive(n.originalRange))),i=Be.join(e.map(n=>Be.fromRangeInclusive(n.modifiedRange)));return new Mo(t,i,e)}constructor(e,t,i){super(e,t),this.innerChanges=i}flip(){return new Mo(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new Mo(this.original,this.modified,[this.toRangeMapping()])}}class So{static assertSorted(e){for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t];if(!(i.originalRange.getEndPosition().isBeforeOrEqual(n.originalRange.getStartPosition())&&i.modifiedRange.getEndPosition().isBeforeOrEqual(n.modifiedRange.getStartPosition())))throw new pt("Range mappings must be sorted")}}constructor(e,t){this.originalRange=e,this.modifiedRange=t}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new So(this.modifiedRange,this.originalRange)}toTextEdit(e){const t=e.getValueOfRange(this.modifiedRange);return new Dl(this.originalRange,t)}}const bie=3;class vie{computeDiff(e,t,i){const s=new wie(e,t,{maxComputationTime:i.maxComputationTimeMs,shouldIgnoreTrimWhitespace:i.ignoreTrimWhitespace,shouldComputeCharChanges:!0,shouldMakePrettyDiff:!0,shouldPostProcessCharChanges:!0}).computeDiff(),r=[];let a=null;for(const l of s.changes){let c;l.originalEndLineNumber===0?c=new Be(l.originalStartLineNumber+1,l.originalStartLineNumber+1):c=new Be(l.originalStartLineNumber,l.originalEndLineNumber+1);let d;l.modifiedEndLineNumber===0?d=new Be(l.modifiedStartLineNumber+1,l.modifiedStartLineNumber+1):d=new Be(l.modifiedStartLineNumber,l.modifiedEndLineNumber+1);let h=new Mo(c,d,l.charChanges?.map(u=>new So(new L(u.originalStartLineNumber,u.originalStartColumn,u.originalEndLineNumber,u.originalEndColumn),new L(u.modifiedStartLineNumber,u.modifiedStartColumn,u.modifiedEndLineNumber,u.modifiedEndColumn))));a&&(a.modified.endLineNumberExclusive===h.modified.startLineNumber||a.original.endLineNumberExclusive===h.original.startLineNumber)&&(h=new Mo(a.original.join(h.original),a.modified.join(h.modified),a.innerChanges&&h.innerChanges?a.innerChanges.concat(h.innerChanges):void 0),r.pop()),r.push(h),a=h}return yf(()=>j4(r,(l,c)=>c.original.startLineNumber-l.original.endLineNumberExclusive===c.modified.startLineNumber-l.modified.endLineNumberExclusive&&l.original.endLineNumberExclusive<c.original.startLineNumber&&l.modified.endLineNumberExclusive<c.modified.startLineNumber)),new A1(r,[],s.quitEarly)}}function IU(o,e,t,i){return new pl(o,e,t).ComputeDiff(i)}let CV=class{constructor(e){const t=[],i=[];for(let n=0,s=e.length;n<s;n++)t[n]=LP(e[n],1),i[n]=kP(e[n],1);this.lines=e,this._startColumns=t,this._endColumns=i}getElements(){const e=[];for(let t=0,i=this.lines.length;t<i;t++)e[t]=this.lines[t].substring(this._startColumns[t]-1,this._endColumns[t]-1);return e}getStrictElement(e){return this.lines[e]}getStartLineNumber(e){return e+1}getEndLineNumber(e){return e+1}createCharSequence(e,t,i){const n=[],s=[],r=[];let a=0;for(let l=t;l<=i;l++){const c=this.lines[l],d=e?this._startColumns[l]:1,h=e?this._endColumns[l]:c.length+1;for(let u=d;u<h;u++)n[a]=c.charCodeAt(u-1),s[a]=l+1,r[a]=u,a++;!e&&l<i&&(n[a]=10,s[a]=l+1,r[a]=c.length+1,a++)}return new Cie(n,s,r)}};class Cie{constructor(e,t,i){this._charCodes=e,this._lineNumbers=t,this._columns=i}toString(){return"["+this._charCodes.map((e,t)=>(e===10?"\\n":String.fromCharCode(e))+`-(${this._lineNumbers[t]},${this._columns[t]})`).join(", ")+"]"}_assertIndex(e,t){if(e<0||e>=t.length)throw new Error("Illegal index")}getElements(){return this._charCodes}getStartLineNumber(e){return e>0&&e===this._lineNumbers.length?this.getEndLineNumber(e-1):(this._assertIndex(e,this._lineNumbers),this._lineNumbers[e])}getEndLineNumber(e){return e===-1?this.getStartLineNumber(e+1):(this._assertIndex(e,this._lineNumbers),this._charCodes[e]===10?this._lineNumbers[e]+1:this._lineNumbers[e])}getStartColumn(e){return e>0&&e===this._columns.length?this.getEndColumn(e-1):(this._assertIndex(e,this._columns),this._columns[e])}getEndColumn(e){return e===-1?this.getStartColumn(e+1):(this._assertIndex(e,this._columns),this._charCodes[e]===10?1:this._columns[e]+1)}}class Mm{constructor(e,t,i,n,s,r,a,l){this.originalStartLineNumber=e,this.originalStartColumn=t,this.originalEndLineNumber=i,this.originalEndColumn=n,this.modifiedStartLineNumber=s,this.modifiedStartColumn=r,this.modifiedEndLineNumber=a,this.modifiedEndColumn=l}static createFromDiffChange(e,t,i){const n=t.getStartLineNumber(e.originalStart),s=t.getStartColumn(e.originalStart),r=t.getEndLineNumber(e.originalStart+e.originalLength-1),a=t.getEndColumn(e.originalStart+e.originalLength-1),l=i.getStartLineNumber(e.modifiedStart),c=i.getStartColumn(e.modifiedStart),d=i.getEndLineNumber(e.modifiedStart+e.modifiedLength-1),h=i.getEndColumn(e.modifiedStart+e.modifiedLength-1);return new Mm(n,s,r,a,l,c,d,h)}}function yie(o){if(o.length<=1)return o;const e=[o[0]];let t=e[0];for(let i=1,n=o.length;i<n;i++){const s=o[i],r=s.originalStart-(t.originalStart+t.originalLength),a=s.modifiedStart-(t.modifiedStart+t.modifiedLength);Math.min(r,a)<bie?(t.originalLength=s.originalStart+s.originalLength-t.originalStart,t.modifiedLength=s.modifiedStart+s.modifiedLength-t.modifiedStart):(e.push(s),t=s)}return e}class Fv{constructor(e,t,i,n,s){this.originalStartLineNumber=e,this.originalEndLineNumber=t,this.modifiedStartLineNumber=i,this.modifiedEndLineNumber=n,this.charChanges=s}static createFromDiffResult(e,t,i,n,s,r,a){let l,c,d,h,u;if(t.originalLength===0?(l=i.getStartLineNumber(t.originalStart)-1,c=0):(l=i.getStartLineNumber(t.originalStart),c=i.getEndLineNumber(t.originalStart+t.originalLength-1)),t.modifiedLength===0?(d=n.getStartLineNumber(t.modifiedStart)-1,h=0):(d=n.getStartLineNumber(t.modifiedStart),h=n.getEndLineNumber(t.modifiedStart+t.modifiedLength-1)),r&&t.originalLength>0&&t.originalLength<20&&t.modifiedLength>0&&t.modifiedLength<20&&s()){const g=i.createCharSequence(e,t.originalStart,t.originalStart+t.originalLength-1),f=n.createCharSequence(e,t.modifiedStart,t.modifiedStart+t.modifiedLength-1);if(g.getElements().length>0&&f.getElements().length>0){let m=IU(g,f,s,!0).changes;a&&(m=yie(m)),u=[];for(let _=0,b=m.length;_<b;_++)u.push(Mm.createFromDiffChange(m[_],g,f))}}return new Fv(l,c,d,h,u)}}class wie{constructor(e,t,i){this.shouldComputeCharChanges=i.shouldComputeCharChanges,this.shouldPostProcessCharChanges=i.shouldPostProcessCharChanges,this.shouldIgnoreTrimWhitespace=i.shouldIgnoreTrimWhitespace,this.shouldMakePrettyDiff=i.shouldMakePrettyDiff,this.originalLines=e,this.modifiedLines=t,this.original=new CV(e),this.modified=new CV(t),this.continueLineDiff=yV(i.maxComputationTime),this.continueCharDiff=yV(i.maxComputationTime===0?0:Math.min(i.maxComputationTime,5e3))}computeDiff(){if(this.original.lines.length===1&&this.original.lines[0].length===0)return this.modified.lines.length===1&&this.modified.lines[0].length===0?{quitEarly:!1,changes:[]}:{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:1,modifiedStartLineNumber:1,modifiedEndLineNumber:this.modified.lines.length,charChanges:void 0}]};if(this.modified.lines.length===1&&this.modified.lines[0].length===0)return{quitEarly:!1,changes:[{originalStartLineNumber:1,originalEndLineNumber:this.original.lines.length,modifiedStartLineNumber:1,modifiedEndLineNumber:1,charChanges:void 0}]};const e=IU(this.original,this.modified,this.continueLineDiff,this.shouldMakePrettyDiff),t=e.changes,i=e.quitEarly;if(this.shouldIgnoreTrimWhitespace){const a=[];for(let l=0,c=t.length;l<c;l++)a.push(Fv.createFromDiffResult(this.shouldIgnoreTrimWhitespace,t[l],this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges));return{quitEarly:i,changes:a}}const n=[];let s=0,r=0;for(let a=-1,l=t.length;a<l;a++){const c=a+1<l?t[a+1]:null,d=c?c.originalStart:this.originalLines.length,h=c?c.modifiedStart:this.modifiedLines.length;for(;s<d&&r<h;){const u=this.originalLines[s],g=this.modifiedLines[r];if(u!==g){{let f=LP(u,1),m=LP(g,1);for(;f>1&&m>1;){const _=u.charCodeAt(f-2),b=g.charCodeAt(m-2);if(_!==b)break;f--,m--}(f>1||m>1)&&this._pushTrimWhitespaceCharChange(n,s+1,1,f,r+1,1,m)}{let f=kP(u,1),m=kP(g,1);const _=u.length+1,b=g.length+1;for(;f<_&&m<b;){const v=u.charCodeAt(f-1),y=u.charCodeAt(m-1);if(v!==y)break;f++,m++}(f<_||m<b)&&this._pushTrimWhitespaceCharChange(n,s+1,f,_,r+1,m,b)}}s++,r++}c&&(n.push(Fv.createFromDiffResult(this.shouldIgnoreTrimWhitespace,c,this.original,this.modified,this.continueCharDiff,this.shouldComputeCharChanges,this.shouldPostProcessCharChanges)),s+=c.originalLength,r+=c.modifiedLength)}return{quitEarly:i,changes:n}}_pushTrimWhitespaceCharChange(e,t,i,n,s,r,a){if(this._mergeTrimWhitespaceCharChange(e,t,i,n,s,r,a))return;let l;this.shouldComputeCharChanges&&(l=[new Mm(t,i,t,n,s,r,s,a)]),e.push(new Fv(t,t,s,s,l))}_mergeTrimWhitespaceCharChange(e,t,i,n,s,r,a){const l=e.length;if(l===0)return!1;const c=e[l-1];return c.originalEndLineNumber===0||c.modifiedEndLineNumber===0?!1:c.originalEndLineNumber===t&&c.modifiedEndLineNumber===s?(this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Mm(t,i,t,n,s,r,s,a)),!0):c.originalEndLineNumber+1===t&&c.modifiedEndLineNumber+1===s?(c.originalEndLineNumber=t,c.modifiedEndLineNumber=s,this.shouldComputeCharChanges&&c.charChanges&&c.charChanges.push(new Mm(t,i,t,n,s,r,s,a)),!0):!1}}function LP(o,e){const t=Xn(o);return t===-1?e:t+1}function kP(o,e){const t=Sa(o);return t===-1?e:t+2}function yV(o){if(o===0)return()=>!0;const e=Date.now();return()=>Date.now()-e<o}class Wc{static trivial(e,t){return new Wc([new Gi(je.ofLength(e.length),je.ofLength(t.length))],!1)}static trivialTimedOut(e,t){return new Wc([new Gi(je.ofLength(e.length),je.ofLength(t.length))],!0)}constructor(e,t){this.diffs=e,this.hitTimeout=t}}class Gi{static invert(e,t){const i=[];return z6(e,(n,s)=>{i.push(Gi.fromOffsetPairs(n?n.getEndExclusives():kc.zero,s?s.getStarts():new kc(t,(n?n.seq2Range.endExclusive-n.seq1Range.endExclusive:0)+t)))}),i}static fromOffsetPairs(e,t){return new Gi(new je(e.offset1,t.offset1),new je(e.offset2,t.offset2))}static assertSorted(e){let t;for(const i of e){if(t&&!(t.seq1Range.endExclusive<=i.seq1Range.start&&t.seq2Range.endExclusive<=i.seq2Range.start))throw new pt("Sequence diffs must be sorted");t=i}}constructor(e,t){this.seq1Range=e,this.seq2Range=t}swap(){return new Gi(this.seq2Range,this.seq1Range)}toString(){return`${this.seq1Range} <-> ${this.seq2Range}`}join(e){return new Gi(this.seq1Range.join(e.seq1Range),this.seq2Range.join(e.seq2Range))}delta(e){return e===0?this:new Gi(this.seq1Range.delta(e),this.seq2Range.delta(e))}deltaStart(e){return e===0?this:new Gi(this.seq1Range.deltaStart(e),this.seq2Range.deltaStart(e))}deltaEnd(e){return e===0?this:new Gi(this.seq1Range.deltaEnd(e),this.seq2Range.deltaEnd(e))}intersect(e){const t=this.seq1Range.intersect(e.seq1Range),i=this.seq2Range.intersect(e.seq2Range);if(!(!t||!i))return new Gi(t,i)}getStarts(){return new kc(this.seq1Range.start,this.seq2Range.start)}getEndExclusives(){return new kc(this.seq1Range.endExclusive,this.seq2Range.endExclusive)}}const ju=class ju{constructor(e,t){this.offset1=e,this.offset2=t}toString(){return`${this.offset1} <-> ${this.offset2}`}delta(e){return e===0?this:new ju(this.offset1+e,this.offset2+e)}equals(e){return this.offset1===e.offset1&&this.offset2===e.offset2}};ju.zero=new ju(0,0),ju.max=new ju(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER);let kc=ju;const kk=class kk{isValid(){return!0}};kk.instance=new kk;let iy=kk;class Sie{constructor(e){if(this.timeout=e,this.startTime=Date.now(),this.valid=!0,e<=0)throw new pt("timeout must be positive")}isValid(){if(!(Date.now()-this.startTime<this.timeout)&&this.valid){this.valid=!1;debugger}return this.valid}}class fI{constructor(e,t){this.width=e,this.height=t,this.array=[],this.array=new Array(e*t)}get(e,t){return this.array[e+t*this.width]}set(e,t,i){this.array[e+t*this.width]=i}}function EP(o){return o===32||o===9}const xC=class xC{static getKey(e){let t=this.chrKeys.get(e);return t===void 0&&(t=this.chrKeys.size,this.chrKeys.set(e,t)),t}constructor(e,t,i){this.range=e,this.lines=t,this.source=i,this.histogram=[];let n=0;for(let s=e.startLineNumber-1;s<e.endLineNumberExclusive-1;s++){const r=t[s];for(let l=0;l<r.length;l++){n++;const c=r[l],d=xC.getKey(c);this.histogram[d]=(this.histogram[d]||0)+1}n++;const a=xC.getKey(`
`);this.histogram[a]=(this.histogram[a]||0)+1}this.totalCount=n}computeSimilarity(e){let t=0;const i=Math.max(this.histogram.length,e.histogram.length);for(let n=0;n<i;n++)t+=Math.abs((this.histogram[n]??0)-(e.histogram[n]??0));return 1-t/(this.totalCount+e.totalCount)}};xC.chrKeys=new Map;let U0=xC;class xie{compute(e,t,i=iy.instance,n){if(e.length===0||t.length===0)return Wc.trivial(e,t);const s=new fI(e.length,t.length),r=new fI(e.length,t.length),a=new fI(e.length,t.length);for(let f=0;f<e.length;f++)for(let m=0;m<t.length;m++){if(!i.isValid())return Wc.trivialTimedOut(e,t);const _=f===0?0:s.get(f-1,m),b=m===0?0:s.get(f,m-1);let v;e.getElement(f)===t.getElement(m)?(f===0||m===0?v=0:v=s.get(f-1,m-1),f>0&&m>0&&r.get(f-1,m-1)===3&&(v+=a.get(f-1,m-1)),v+=n?n(f,m):1):v=-1;const y=Math.max(_,b,v);if(y===v){const C=f>0&&m>0?a.get(f-1,m-1):0;a.set(f,m,C+1),r.set(f,m,3)}else y===_?(a.set(f,m,0),r.set(f,m,1)):y===b&&(a.set(f,m,0),r.set(f,m,2));s.set(f,m,y)}const l=[];let c=e.length,d=t.length;function h(f,m){(f+1!==c||m+1!==d)&&l.push(new Gi(new je(f+1,c),new je(m+1,d))),c=f,d=m}let u=e.length-1,g=t.length-1;for(;u>=0&&g>=0;)r.get(u,g)===3?(h(u,g),u--,g--):r.get(u,g)===1?u--:g--;return h(-1,-1),l.reverse(),new Wc(l,!1)}}class NU{compute(e,t,i=iy.instance){if(e.length===0||t.length===0)return Wc.trivial(e,t);const n=e,s=t;function r(m,_){for(;m<n.length&&_<s.length&&n.getElement(m)===s.getElement(_);)m++,_++;return m}let a=0;const l=new Lie;l.set(0,r(0,0));const c=new kie;c.set(0,l.get(0)===0?null:new wV(null,0,0,l.get(0)));let d=0;e:for(;;){if(a++,!i.isValid())return Wc.trivialTimedOut(n,s);const m=-Math.min(a,s.length+a%2),_=Math.min(a,n.length+a%2);for(d=m;d<=_;d+=2){const b=d===_?-1:l.get(d+1),v=d===m?-1:l.get(d-1)+1,y=Math.min(Math.max(b,v),n.length),C=y-d;if(y>n.length||C>s.length)continue;const w=r(y,C);l.set(d,w);const x=y===b?c.get(d+1):c.get(d-1);if(c.set(d,w!==y?new wV(x,y,C,w-y):x),l.get(d)===n.length&&l.get(d)-d===s.length)break e}}let h=c.get(d);const u=[];let g=n.length,f=s.length;for(;;){const m=h?h.x+h.length:0,_=h?h.y+h.length:0;if((m!==g||_!==f)&&u.push(new Gi(new je(m,g),new je(_,f))),!h)break;g=h.x,f=h.y,h=h.prev}return u.reverse(),new Wc(u,!1)}}class wV{constructor(e,t,i,n){this.prev=e,this.x=t,this.y=i,this.length=n}}class Lie{constructor(){this.positiveArr=new Int32Array(10),this.negativeArr=new Int32Array(10)}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){if(e<0){if(e=-e-1,e>=this.negativeArr.length){const i=this.negativeArr;this.negativeArr=new Int32Array(i.length*2),this.negativeArr.set(i)}this.negativeArr[e]=t}else{if(e>=this.positiveArr.length){const i=this.positiveArr;this.positiveArr=new Int32Array(i.length*2),this.positiveArr.set(i)}this.positiveArr[e]=t}}}class kie{constructor(){this.positiveArr=[],this.negativeArr=[]}get(e){return e<0?(e=-e-1,this.negativeArr[e]):this.positiveArr[e]}set(e,t){e<0?(e=-e-1,this.negativeArr[e]=t):this.positiveArr[e]=t}}class G0{constructor(e,t,i){this.lines=e,this.range=t,this.considerWhitespaceChanges=i,this.elements=[],this.firstElementOffsetByLineIdx=[],this.lineStartOffsets=[],this.trimmedWsLengthsByLineIdx=[],this.firstElementOffsetByLineIdx.push(0);for(let n=this.range.startLineNumber;n<=this.range.endLineNumber;n++){let s=e[n-1],r=0;n===this.range.startLineNumber&&this.range.startColumn>1&&(r=this.range.startColumn-1,s=s.substring(r)),this.lineStartOffsets.push(r);let a=0;if(!i){const c=s.trimStart();a=s.length-c.length,s=c.trimEnd()}this.trimmedWsLengthsByLineIdx.push(a);const l=n===this.range.endLineNumber?Math.min(this.range.endColumn-1-r-a,s.length):s.length;for(let c=0;c<l;c++)this.elements.push(s.charCodeAt(c));n<this.range.endLineNumber&&(this.elements.push(10),this.firstElementOffsetByLineIdx.push(this.elements.length))}}toString(){return`Slice: "${this.text}"`}get text(){return this.getText(new je(0,this.length))}getText(e){return this.elements.slice(e.start,e.endExclusive).map(t=>String.fromCharCode(t)).join("")}getElement(e){return this.elements[e]}get length(){return this.elements.length}getBoundaryScore(e){const t=xV(e>0?this.elements[e-1]:-1),i=xV(e<this.elements.length?this.elements[e]:-1);if(t===7&&i===8)return 0;if(t===8)return 150;let n=0;return t!==i&&(n+=10,t===0&&i===1&&(n+=1)),n+=SV(t),n+=SV(i),n}translateOffset(e,t="right"){const i=ey(this.firstElementOffsetByLineIdx,s=>s<=e),n=e-this.firstElementOffsetByLineIdx[i];return new A(this.range.startLineNumber+i,1+this.lineStartOffsets[i]+n+(n===0&&t==="left"?0:this.trimmedWsLengthsByLineIdx[i]))}translateRange(e){const t=this.translateOffset(e.start,"right"),i=this.translateOffset(e.endExclusive,"left");return i.isBefore(t)?L.fromPositions(i,i):L.fromPositions(t,i)}findWordContaining(e){if(e<0||e>=this.elements.length||!pI(this.elements[e]))return;let t=e;for(;t>0&&pI(this.elements[t-1]);)t--;let i=e;for(;i<this.elements.length&&pI(this.elements[i]);)i++;return new je(t,i)}countLinesIn(e){return this.translateOffset(e.endExclusive).lineNumber-this.translateOffset(e.start).lineNumber}isStronglyEqual(e,t){return this.elements[e]===this.elements[t]}extendToFullLines(e){const t=b_(this.firstElementOffsetByLineIdx,n=>n<=e.start)??0,i=hie(this.firstElementOffsetByLineIdx,n=>e.endExclusive<=n)??this.elements.length;return new je(t,i)}}function pI(o){return o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57}const Eie={0:0,1:0,2:0,3:10,4:2,5:30,6:3,7:10,8:10};function SV(o){return Eie[o]}function xV(o){return o===10?8:o===13?7:EP(o)?6:o>=97&&o<=122?0:o>=65&&o<=90?1:o>=48&&o<=57?2:o===-1?3:o===44||o===59?5:4}function Tie(o,e,t,i,n,s){let{moves:r,excludedChanges:a}=Iie(o,e,t,s);if(!s.isValid())return[];const l=o.filter(d=>!a.has(d)),c=Nie(l,i,n,e,t,s);return KN(r,c),r=Rie(r),r=r.filter(d=>{const h=d.original.toOffsetRange().slice(e).map(g=>g.trim());return h.join(`
`).length>=15&&Die(h,g=>g.length>=2)>=2}),r=Pie(o,r),r}function Die(o,e){let t=0;for(const i of o)e(i)&&t++;return t}function Iie(o,e,t,i){const n=[],s=o.filter(l=>l.modified.isEmpty&&l.original.length>=3).map(l=>new U0(l.original,e,l)),r=new Set(o.filter(l=>l.original.isEmpty&&l.modified.length>=3).map(l=>new U0(l.modified,t,l))),a=new Set;for(const l of s){let c=-1,d;for(const h of r){const u=l.computeSimilarity(h);u>c&&(c=u,d=h)}if(c>.9&&d&&(r.delete(d),n.push(new qn(l.range,d.range)),a.add(l.source),a.add(d.source)),!i.isValid())return{moves:n,excludedChanges:a}}return{moves:n,excludedChanges:a}}function Nie(o,e,t,i,n,s){const r=[],a=new Y4;for(const u of o)for(let g=u.original.startLineNumber;g<u.original.endLineNumberExclusive-2;g++){const f=`${e[g-1]}:${e[g+1-1]}:${e[g+2-1]}`;a.add(f,{range:new Be(g,g+3)})}const l=[];o.sort(cs(u=>u.modified.startLineNumber,Br));for(const u of o){let g=[];for(let f=u.modified.startLineNumber;f<u.modified.endLineNumberExclusive-2;f++){const m=`${t[f-1]}:${t[f+1-1]}:${t[f+2-1]}`,_=new Be(f,f+3),b=[];a.forEach(m,({range:v})=>{for(const C of g)if(C.originalLineRange.endLineNumberExclusive+1===v.endLineNumberExclusive&&C.modifiedLineRange.endLineNumberExclusive+1===_.endLineNumberExclusive){C.originalLineRange=new Be(C.originalLineRange.startLineNumber,v.endLineNumberExclusive),C.modifiedLineRange=new Be(C.modifiedLineRange.startLineNumber,_.endLineNumberExclusive),b.push(C);return}const y={modifiedLineRange:_,originalLineRange:v};l.push(y),b.push(y)}),g=b}if(!s.isValid())return[]}l.sort($6(cs(u=>u.modifiedLineRange.length,Br)));const c=new sr,d=new sr;for(const u of l){const g=u.modifiedLineRange.startLineNumber-u.originalLineRange.startLineNumber,f=c.subtractFrom(u.modifiedLineRange),m=d.subtractFrom(u.originalLineRange).getWithDelta(g),_=f.getIntersection(m);for(const b of _.ranges){if(b.length<3)continue;const v=b,y=b.delta(-g);r.push(new qn(y,v)),c.addRange(v),d.addRange(y)}}r.sort(cs(u=>u.original.startLineNumber,Br));const h=new z0(o);for(let u=0;u<r.length;u++){const g=r[u],f=h.findLastMonotonous(x=>x.original.startLineNumber<=g.original.startLineNumber),m=b_(o,x=>x.modified.startLineNumber<=g.modified.startLineNumber),_=Math.max(g.original.startLineNumber-f.original.startLineNumber,g.modified.startLineNumber-m.modified.startLineNumber),b=h.findLastMonotonous(x=>x.original.startLineNumber<g.original.endLineNumberExclusive),v=b_(o,x=>x.modified.startLineNumber<g.modified.endLineNumberExclusive),y=Math.max(b.original.endLineNumberExclusive-g.original.endLineNumberExclusive,v.modified.endLineNumberExclusive-g.modified.endLineNumberExclusive);let C;for(C=0;C<_;C++){const x=g.original.startLineNumber-C-1,k=g.modified.startLineNumber-C-1;if(x>i.length||k>n.length||c.contains(k)||d.contains(x)||!LV(i[x-1],n[k-1],s))break}C>0&&(d.addRange(new Be(g.original.startLineNumber-C,g.original.startLineNumber)),c.addRange(new Be(g.modified.startLineNumber-C,g.modified.startLineNumber)));let w;for(w=0;w<y;w++){const x=g.original.endLineNumberExclusive+w,k=g.modified.endLineNumberExclusive+w;if(x>i.length||k>n.length||c.contains(k)||d.contains(x)||!LV(i[x-1],n[k-1],s))break}w>0&&(d.addRange(new Be(g.original.endLineNumberExclusive,g.original.endLineNumberExclusive+w)),c.addRange(new Be(g.modified.endLineNumberExclusive,g.modified.endLineNumberExclusive+w))),(C>0||w>0)&&(r[u]=new qn(new Be(g.original.startLineNumber-C,g.original.endLineNumberExclusive+w),new Be(g.modified.startLineNumber-C,g.modified.endLineNumberExclusive+w)))}return r}function LV(o,e,t){if(o.trim()===e.trim())return!0;if(o.length>300&&e.length>300)return!1;const n=new NU().compute(new G0([o],new L(1,1,1,o.length),!1),new G0([e],new L(1,1,1,e.length),!1),t);let s=0;const r=Gi.invert(n.diffs,o.length);for(const d of r)d.seq1Range.forEach(h=>{EP(o.charCodeAt(h))||s++});function a(d){let h=0;for(let u=0;u<o.length;u++)EP(d.charCodeAt(u))||h++;return h}const l=a(o.length>e.length?o:e);return s/l>.6&&l>10}function Rie(o){if(o.length===0)return o;o.sort(cs(t=>t.original.startLineNumber,Br));const e=[o[0]];for(let t=1;t<o.length;t++){const i=e[e.length-1],n=o[t],s=n.original.startLineNumber-i.original.endLineNumberExclusive,r=n.modified.startLineNumber-i.modified.endLineNumberExclusive;if(s>=0&&r>=0&&s+r<=2){e[e.length-1]=i.join(n);continue}e.push(n)}return e}function Pie(o,e){const t=new z0(o);return e=e.filter(i=>{const n=t.findLastMonotonous(a=>a.original.startLineNumber<i.original.endLineNumberExclusive)||new qn(new Be(1,1),new Be(1,1)),s=b_(o,a=>a.modified.startLineNumber<i.modified.endLineNumberExclusive);return n!==s}),e}function TP(o,e,t){let i=t;return i=kV(o,e,i),i=kV(o,e,i),i=Aie(o,e,i),i}function kV(o,e,t){if(t.length===0)return t;const i=[];i.push(t[0]);for(let s=1;s<t.length;s++){const r=i[i.length-1];let a=t[s];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=a.seq1Range.start-r.seq1Range.endExclusive;let c;for(c=1;c<=l&&!(o.getElement(a.seq1Range.start-c)!==o.getElement(a.seq1Range.endExclusive-c)||e.getElement(a.seq2Range.start-c)!==e.getElement(a.seq2Range.endExclusive-c));c++);if(c--,c===l){i[i.length-1]=new Gi(new je(r.seq1Range.start,a.seq1Range.endExclusive-l),new je(r.seq2Range.start,a.seq2Range.endExclusive-l));continue}a=a.delta(-c)}i.push(a)}const n=[];for(let s=0;s<i.length-1;s++){const r=i[s+1];let a=i[s];if(a.seq1Range.isEmpty||a.seq2Range.isEmpty){const l=r.seq1Range.start-a.seq1Range.endExclusive;let c;for(c=0;c<l&&!(!o.isStronglyEqual(a.seq1Range.start+c,a.seq1Range.endExclusive+c)||!e.isStronglyEqual(a.seq2Range.start+c,a.seq2Range.endExclusive+c));c++);if(c===l){i[s+1]=new Gi(new je(a.seq1Range.start+l,r.seq1Range.endExclusive),new je(a.seq2Range.start+l,r.seq2Range.endExclusive));continue}c>0&&(a=a.delta(c))}n.push(a)}return i.length>0&&n.push(i[i.length-1]),n}function Aie(o,e,t){if(!o.getBoundaryScore||!e.getBoundaryScore)return t;for(let i=0;i<t.length;i++){const n=i>0?t[i-1]:void 0,s=t[i],r=i+1<t.length?t[i+1]:void 0,a=new je(n?n.seq1Range.endExclusive+1:0,r?r.seq1Range.start-1:o.length),l=new je(n?n.seq2Range.endExclusive+1:0,r?r.seq2Range.start-1:e.length);s.seq1Range.isEmpty?t[i]=EV(s,o,e,a,l):s.seq2Range.isEmpty&&(t[i]=EV(s.swap(),e,o,l,a).swap())}return t}function EV(o,e,t,i,n){let r=1;for(;o.seq1Range.start-r>=i.start&&o.seq2Range.start-r>=n.start&&t.isStronglyEqual(o.seq2Range.start-r,o.seq2Range.endExclusive-r)&&r<100;)r++;r--;let a=0;for(;o.seq1Range.start+a<i.endExclusive&&o.seq2Range.endExclusive+a<n.endExclusive&&t.isStronglyEqual(o.seq2Range.start+a,o.seq2Range.endExclusive+a)&&a<100;)a++;if(r===0&&a===0)return o;let l=0,c=-1;for(let d=-r;d<=a;d++){const h=o.seq2Range.start+d,u=o.seq2Range.endExclusive+d,g=o.seq1Range.start+d,f=e.getBoundaryScore(g)+t.getBoundaryScore(h)+t.getBoundaryScore(u);f>c&&(c=f,l=d)}return o.delta(l)}function Mie(o,e,t){const i=[];for(const n of t){const s=i[i.length-1];if(!s){i.push(n);continue}n.seq1Range.start-s.seq1Range.endExclusive<=2||n.seq2Range.start-s.seq2Range.endExclusive<=2?i[i.length-1]=new Gi(s.seq1Range.join(n.seq1Range),s.seq2Range.join(n.seq2Range)):i.push(n)}return i}function Oie(o,e,t){const i=Gi.invert(t,o.length),n=[];let s=new kc(0,0);function r(l,c){if(l.offset1<s.offset1||l.offset2<s.offset2)return;const d=o.findWordContaining(l.offset1),h=e.findWordContaining(l.offset2);if(!d||!h)return;let u=new Gi(d,h);const g=u.intersect(c);let f=g.seq1Range.length,m=g.seq2Range.length;for(;i.length>0;){const _=i[0];if(!(_.seq1Range.intersects(u.seq1Range)||_.seq2Range.intersects(u.seq2Range)))break;const v=o.findWordContaining(_.seq1Range.start),y=e.findWordContaining(_.seq2Range.start),C=new Gi(v,y),w=C.intersect(_);if(f+=w.seq1Range.length,m+=w.seq2Range.length,u=u.join(C),u.seq1Range.endExclusive>=_.seq1Range.endExclusive)i.shift();else break}f+m<(u.seq1Range.length+u.seq2Range.length)*2/3&&n.push(u),s=u.getEndExclusives()}for(;i.length>0;){const l=i.shift();l.seq1Range.isEmpty||(r(l.getStarts(),l),r(l.getEndExclusives().delta(-1),l))}return Fie(t,n)}function Fie(o,e){const t=[];for(;o.length>0||e.length>0;){const i=o[0],n=e[0];let s;i&&(!n||i.seq1Range.start<n.seq1Range.start)?s=o.shift():s=e.shift(),t.length>0&&t[t.length-1].seq1Range.endExclusive>=s.seq1Range.start?t[t.length-1]=t[t.length-1].join(s):t.push(s)}return t}function Bie(o,e,t){let i=t;if(i.length===0)return i;let n=0,s;do{s=!1;const r=[i[0]];for(let a=1;a<i.length;a++){let d=function(u,g){const f=new je(c.seq1Range.endExclusive,l.seq1Range.start);return o.getText(f).replace(/\s/g,"").length<=4&&(u.seq1Range.length+u.seq2Range.length>5||g.seq1Range.length+g.seq2Range.length>5)};const l=i[a],c=r[r.length-1];d(c,l)?(s=!0,r[r.length-1]=r[r.length-1].join(l)):r.push(l)}i=r}while(n++<10&&s);return i}function Wie(o,e,t){let i=t;if(i.length===0)return i;let n=0,s;do{s=!1;const a=[i[0]];for(let l=1;l<i.length;l++){let h=function(g,f){const m=new je(d.seq1Range.endExclusive,c.seq1Range.start);if(o.countLinesIn(m)>5||m.length>500)return!1;const b=o.getText(m).trim();if(b.length>20||b.split(/\r\n|\r|\n/).length>1)return!1;const v=o.countLinesIn(g.seq1Range),y=g.seq1Range.length,C=e.countLinesIn(g.seq2Range),w=g.seq2Range.length,x=o.countLinesIn(f.seq1Range),k=f.seq1Range.length,E=e.countLinesIn(f.seq2Range),N=f.seq2Range.length,z=2*40+50;function B(U){return Math.min(U,z)}return Math.pow(Math.pow(B(v*40+y),1.5)+Math.pow(B(C*40+w),1.5),1.5)+Math.pow(Math.pow(B(x*40+k),1.5)+Math.pow(B(E*40+N),1.5),1.5)>(z**1.5)**1.5*1.3};const c=i[l],d=a[a.length-1];h(d,c)?(s=!0,a[a.length-1]=a[a.length-1].join(c)):a.push(c)}i=a}while(n++<10&&s);const r=[];return DY(i,(a,l,c)=>{let d=l;function h(b){return b.length>0&&b.trim().length<=3&&l.seq1Range.length+l.seq2Range.length>100}const u=o.extendToFullLines(l.seq1Range),g=o.getText(new je(u.start,l.seq1Range.start));h(g)&&(d=d.deltaStart(-g.length));const f=o.getText(new je(l.seq1Range.endExclusive,u.endExclusive));h(f)&&(d=d.deltaEnd(f.length));const m=Gi.fromOffsetPairs(a?a.getEndExclusives():kc.zero,c?c.getStarts():kc.max),_=d.intersect(m);r.length>0&&_.getStarts().equals(r[r.length-1].getEndExclusives())?r[r.length-1]=r[r.length-1].join(_):r.push(_)}),r}class TV{constructor(e,t){this.trimmedHash=e,this.lines=t}getElement(e){return this.trimmedHash[e]}get length(){return this.trimmedHash.length}getBoundaryScore(e){const t=e===0?0:DV(this.lines[e-1]),i=e===this.lines.length?0:DV(this.lines[e]);return 1e3-(t+i)}getText(e){return this.lines.slice(e.start,e.endExclusive).join(`
`)}isStronglyEqual(e,t){return this.lines[e]===this.lines[t]}}function DV(o){let e=0;for(;e<o.length&&(o.charCodeAt(e)===32||o.charCodeAt(e)===9);)e++;return e}class RU{constructor(){this.dynamicProgrammingDiffing=new xie,this.myersDiffingAlgorithm=new NU}computeDiff(e,t,i){if(e.length<=1&&ei(e,t,(w,x)=>w===x))return new A1([],[],!1);if(e.length===1&&e[0].length===0||t.length===1&&t[0].length===0)return new A1([new Mo(new Be(1,e.length+1),new Be(1,t.length+1),[new So(new L(1,1,e.length,e[e.length-1].length+1),new L(1,1,t.length,t[t.length-1].length+1))])],[],!1);const n=i.maxComputationTimeMs===0?iy.instance:new Sie(i.maxComputationTimeMs),s=!i.ignoreTrimWhitespace,r=new Map;function a(w){let x=r.get(w);return x===void 0&&(x=r.size,r.set(w,x)),x}const l=e.map(w=>a(w.trim())),c=t.map(w=>a(w.trim())),d=new TV(l,e),h=new TV(c,t),u=d.length+h.length<1700?this.dynamicProgrammingDiffing.compute(d,h,n,(w,x)=>e[w]===t[x]?t[x].length===0?.1:1+Math.log(1+t[x].length):.99):this.myersDiffingAlgorithm.compute(d,h,n);let g=u.diffs,f=u.hitTimeout;g=TP(d,h,g),g=Bie(d,h,g);const m=[],_=w=>{if(s)for(let x=0;x<w;x++){const k=b+x,E=v+x;if(e[k]!==t[E]){const N=this.refineDiff(e,t,new Gi(new je(k,k+1),new je(E,E+1)),n,s);for(const z of N.mappings)m.push(z);N.hitTimeout&&(f=!0)}}};let b=0,v=0;for(const w of g){yf(()=>w.seq1Range.start-b===w.seq2Range.start-v);const x=w.seq1Range.start-b;_(x),b=w.seq1Range.endExclusive,v=w.seq2Range.endExclusive;const k=this.refineDiff(e,t,w,n,s);k.hitTimeout&&(f=!0);for(const E of k.mappings)m.push(E)}_(e.length-b);const y=IV(m,e,t);let C=[];return i.computeMoves&&(C=this.computeMoves(y,e,t,l,c,n,s)),yf(()=>{function w(k,E){if(k.lineNumber<1||k.lineNumber>E.length)return!1;const N=E[k.lineNumber-1];return!(k.column<1||k.column>N.length+1)}function x(k,E){return!(k.startLineNumber<1||k.startLineNumber>E.length+1||k.endLineNumberExclusive<1||k.endLineNumberExclusive>E.length+1)}for(const k of y){if(!k.innerChanges)return!1;for(const E of k.innerChanges)if(!(w(E.modifiedRange.getStartPosition(),t)&&w(E.modifiedRange.getEndPosition(),t)&&w(E.originalRange.getStartPosition(),e)&&w(E.originalRange.getEndPosition(),e)))return!1;if(!x(k.modified,t)||!x(k.original,e))return!1}return!0}),new A1(y,C,f)}computeMoves(e,t,i,n,s,r,a){return Tie(e,t,i,n,s,r).map(d=>{const h=this.refineDiff(t,i,new Gi(d.original.toOffsetRange(),d.modified.toOffsetRange()),r,a),u=IV(h.mappings,t,i,!0);return new TU(d,u)})}refineDiff(e,t,i,n,s){const a=Hie(i).toRangeMapping2(e,t),l=new G0(e,a.originalRange,s),c=new G0(t,a.modifiedRange,s),d=l.length+c.length<500?this.dynamicProgrammingDiffing.compute(l,c,n):this.myersDiffingAlgorithm.compute(l,c,n);let h=d.diffs;return h=TP(l,c,h),h=Oie(l,c,h),h=Mie(l,c,h),h=Wie(l,c,h),{mappings:h.map(g=>new So(l.translateRange(g.seq1Range),c.translateRange(g.seq2Range))),hitTimeout:d.hitTimeout}}}function IV(o,e,t,i=!1){const n=[];for(const s of m4(o.map(r=>Vie(r,e,t)),(r,a)=>r.original.overlapOrTouch(a.original)||r.modified.overlapOrTouch(a.modified))){const r=s[0],a=s[s.length-1];n.push(new Mo(r.original.join(a.original),r.modified.join(a.modified),s.map(l=>l.innerChanges[0])))}return yf(()=>!i&&n.length>0&&(n[0].modified.startLineNumber!==n[0].original.startLineNumber||t.length-n[n.length-1].modified.endLineNumberExclusive!==e.length-n[n.length-1].original.endLineNumberExclusive)?!1:j4(n,(s,r)=>r.original.startLineNumber-s.original.endLineNumberExclusive===r.modified.startLineNumber-s.modified.endLineNumberExclusive&&s.original.endLineNumberExclusive<r.original.startLineNumber&&s.modified.endLineNumberExclusive<r.modified.startLineNumber)),n}function Vie(o,e,t){let i=0,n=0;o.modifiedRange.endColumn===1&&o.originalRange.endColumn===1&&o.originalRange.startLineNumber+i<=o.originalRange.endLineNumber&&o.modifiedRange.startLineNumber+i<=o.modifiedRange.endLineNumber&&(n=-1),o.modifiedRange.startColumn-1>=t[o.modifiedRange.startLineNumber-1].length&&o.originalRange.startColumn-1>=e[o.originalRange.startLineNumber-1].length&&o.originalRange.startLineNumber<=o.originalRange.endLineNumber+n&&o.modifiedRange.startLineNumber<=o.modifiedRange.endLineNumber+n&&(i=1);const s=new Be(o.originalRange.startLineNumber+i,o.originalRange.endLineNumber+1+n),r=new Be(o.modifiedRange.startLineNumber+i,o.modifiedRange.endLineNumber+1+n);return new Mo(s,r,[o])}function Hie(o){return new qn(new Be(o.seq1Range.start+1,o.seq1Range.endExclusive+1),new Be(o.seq2Range.start+1,o.seq2Range.endExclusive+1))}const NV={getLegacy:()=>new vie,getDefault:()=>new RU};function ih(o,e){const t=Math.pow(10,e);return Math.round(o*t)/t}class lt{constructor(e,t,i,n=1){this._rgbaBrand=void 0,this.r=Math.min(255,Math.max(0,e))|0,this.g=Math.min(255,Math.max(0,t))|0,this.b=Math.min(255,Math.max(0,i))|0,this.a=ih(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}}class Nr{constructor(e,t,i,n){this._hslaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=ih(Math.max(Math.min(1,t),0),3),this.l=ih(Math.max(Math.min(1,i),0),3),this.a=ih(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.l===t.l&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,s=e.a,r=Math.max(t,i,n),a=Math.min(t,i,n);let l=0,c=0;const d=(a+r)/2,h=r-a;if(h>0){switch(c=Math.min(d<=.5?h/(2*d):h/(2-2*d),1),r){case t:l=(i-n)/h+(i<n?6:0);break;case i:l=(n-t)/h+2;break;case n:l=(t-i)/h+4;break}l*=60,l=Math.round(l)}return new Nr(l,c,d,s)}static _hue2rgb(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+(t-e)*6*i:i<1/2?t:i<2/3?e+(t-e)*(2/3-i)*6:e}static toRGBA(e){const t=e.h/360,{s:i,l:n,a:s}=e;let r,a,l;if(i===0)r=a=l=n;else{const c=n<.5?n*(1+i):n+i-n*i,d=2*n-c;r=Nr._hue2rgb(d,c,t+1/3),a=Nr._hue2rgb(d,c,t),l=Nr._hue2rgb(d,c,t-1/3)}return new lt(Math.round(r*255),Math.round(a*255),Math.round(l*255),s)}}class yl{constructor(e,t,i,n){this._hsvaBrand=void 0,this.h=Math.max(Math.min(360,e),0)|0,this.s=ih(Math.max(Math.min(1,t),0),3),this.v=ih(Math.max(Math.min(1,i),0),3),this.a=ih(Math.max(Math.min(1,n),0),3)}static equals(e,t){return e.h===t.h&&e.s===t.s&&e.v===t.v&&e.a===t.a}static fromRGBA(e){const t=e.r/255,i=e.g/255,n=e.b/255,s=Math.max(t,i,n),r=Math.min(t,i,n),a=s-r,l=s===0?0:a/s;let c;return a===0?c=0:s===t?c=((i-n)/a%6+6)%6:s===i?c=(n-t)/a+2:c=(t-i)/a+4,new yl(Math.round(c*60),l,s,e.a)}static toRGBA(e){const{h:t,s:i,v:n,a:s}=e,r=n*i,a=r*(1-Math.abs(t/60%2-1)),l=n-r;let[c,d,h]=[0,0,0];return t<60?(c=r,d=a):t<120?(c=a,d=r):t<180?(d=r,h=a):t<240?(d=a,h=r):t<300?(c=a,h=r):t<=360&&(c=r,h=a),c=Math.round((c+l)*255),d=Math.round((d+l)*255),h=Math.round((h+l)*255),new lt(c,d,h,s)}}const bi=class bi{static fromHex(e){return bi.Format.CSS.parseHex(e)||bi.red}static equals(e,t){return!e&&!t?!0:!e||!t?!1:e.equals(t)}get hsla(){return this._hsla?this._hsla:Nr.fromRGBA(this.rgba)}get hsva(){return this._hsva?this._hsva:yl.fromRGBA(this.rgba)}constructor(e){if(e)if(e instanceof lt)this.rgba=e;else if(e instanceof Nr)this._hsla=e,this.rgba=Nr.toRGBA(e);else if(e instanceof yl)this._hsva=e,this.rgba=yl.toRGBA(e);else throw new Error("Invalid color ctor argument");else throw new Error("Color needs a value")}equals(e){return!!e&&lt.equals(this.rgba,e.rgba)&&Nr.equals(this.hsla,e.hsla)&&yl.equals(this.hsva,e.hsva)}getRelativeLuminance(){const e=bi._relativeLuminanceForComponent(this.rgba.r),t=bi._relativeLuminanceForComponent(this.rgba.g),i=bi._relativeLuminanceForComponent(this.rgba.b),n=.2126*e+.7152*t+.0722*i;return ih(n,4)}static _relativeLuminanceForComponent(e){const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}isLighter(){return(this.rgba.r*299+this.rgba.g*587+this.rgba.b*114)/1e3>=128}isLighterThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t>i}isDarkerThan(e){const t=this.getRelativeLuminance(),i=e.getRelativeLuminance();return t<i}lighten(e){return new bi(new Nr(this.hsla.h,this.hsla.s,this.hsla.l+this.hsla.l*e,this.hsla.a))}darken(e){return new bi(new Nr(this.hsla.h,this.hsla.s,this.hsla.l-this.hsla.l*e,this.hsla.a))}transparent(e){const{r:t,g:i,b:n,a:s}=this.rgba;return new bi(new lt(t,i,n,s*e))}isTransparent(){return this.rgba.a===0}isOpaque(){return this.rgba.a===1}opposite(){return new bi(new lt(255-this.rgba.r,255-this.rgba.g,255-this.rgba.b,this.rgba.a))}makeOpaque(e){if(this.isOpaque()||e.rgba.a!==1)return this;const{r:t,g:i,b:n,a:s}=this.rgba;return new bi(new lt(e.rgba.r-s*(e.rgba.r-t),e.rgba.g-s*(e.rgba.g-i),e.rgba.b-s*(e.rgba.b-n),1))}toString(){return this._toString||(this._toString=bi.Format.CSS.format(this)),this._toString}static getLighterColor(e,t,i){if(e.isLighterThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),s=t.getRelativeLuminance();return i=i*(s-n)/s,e.lighten(i)}static getDarkerColor(e,t,i){if(e.isDarkerThan(t))return e;i=i||.5;const n=e.getRelativeLuminance(),s=t.getRelativeLuminance();return i=i*(n-s)/n,e.darken(i)}};bi.white=new bi(new lt(255,255,255,1)),bi.black=new bi(new lt(0,0,0,1)),bi.red=new bi(new lt(255,0,0,1)),bi.blue=new bi(new lt(0,0,255,1)),bi.green=new bi(new lt(0,255,0,1)),bi.cyan=new bi(new lt(0,255,255,1)),bi.lightgrey=new bi(new lt(211,211,211,1)),bi.transparent=new bi(new lt(0,0,0,0));let j=bi;(function(o){(function(e){(function(t){function i(g){return g.rgba.a===1?`rgb(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b})`:o.Format.CSS.formatRGBA(g)}t.formatRGB=i;function n(g){return`rgba(${g.rgba.r}, ${g.rgba.g}, ${g.rgba.b}, ${+g.rgba.a.toFixed(2)})`}t.formatRGBA=n;function s(g){return g.hsla.a===1?`hsl(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%)`:o.Format.CSS.formatHSLA(g)}t.formatHSL=s;function r(g){return`hsla(${g.hsla.h}, ${(g.hsla.s*100).toFixed(2)}%, ${(g.hsla.l*100).toFixed(2)}%, ${g.hsla.a.toFixed(2)})`}t.formatHSLA=r;function a(g){const f=g.toString(16);return f.length!==2?"0"+f:f}function l(g){return`#${a(g.rgba.r)}${a(g.rgba.g)}${a(g.rgba.b)}`}t.formatHex=l;function c(g,f=!1){return f&&g.rgba.a===1?o.Format.CSS.formatHex(g):`#${a(g.rgba.r)}${a(g.rgba.g)}${a(g.rgba.b)}${a(Math.round(g.rgba.a*255))}`}t.formatHexA=c;function d(g){return g.isOpaque()?o.Format.CSS.formatHex(g):o.Format.CSS.formatRGBA(g)}t.format=d;function h(g){const f=g.length;if(f===0||g.charCodeAt(0)!==35)return null;if(f===7){const m=16*u(g.charCodeAt(1))+u(g.charCodeAt(2)),_=16*u(g.charCodeAt(3))+u(g.charCodeAt(4)),b=16*u(g.charCodeAt(5))+u(g.charCodeAt(6));return new o(new lt(m,_,b,1))}if(f===9){const m=16*u(g.charCodeAt(1))+u(g.charCodeAt(2)),_=16*u(g.charCodeAt(3))+u(g.charCodeAt(4)),b=16*u(g.charCodeAt(5))+u(g.charCodeAt(6)),v=16*u(g.charCodeAt(7))+u(g.charCodeAt(8));return new o(new lt(m,_,b,v/255))}if(f===4){const m=u(g.charCodeAt(1)),_=u(g.charCodeAt(2)),b=u(g.charCodeAt(3));return new o(new lt(16*m+m,16*_+_,16*b+b))}if(f===5){const m=u(g.charCodeAt(1)),_=u(g.charCodeAt(2)),b=u(g.charCodeAt(3)),v=u(g.charCodeAt(4));return new o(new lt(16*m+m,16*_+_,16*b+b,(16*v+v)/255))}return null}t.parseHex=h;function u(g){switch(g){case 48:return 0;case 49:return 1;case 50:return 2;case 51:return 3;case 52:return 4;case 53:return 5;case 54:return 6;case 55:return 7;case 56:return 8;case 57:return 9;case 97:return 10;case 65:return 10;case 98:return 11;case 66:return 11;case 99:return 12;case 67:return 12;case 100:return 13;case 68:return 13;case 101:return 14;case 69:return 14;case 102:return 15;case 70:return 15}return 0}})(e.CSS||(e.CSS={}))})(o.Format||(o.Format={}))})(j||(j={}));function PU(o){const e=[];for(const t of o){const i=Number(t);(i||i===0&&t.replace(/\s/g,"")!=="")&&e.push(i)}return e}function i5(o,e,t,i){return{red:o/255,blue:t/255,green:e/255,alpha:i}}function Ub(o,e){const t=e.index,i=e[0].length;if(!t)return;const n=o.positionAt(t);return{startLineNumber:n.lineNumber,startColumn:n.column,endLineNumber:n.lineNumber,endColumn:n.column+i}}function zie(o,e){if(!o)return;const t=j.Format.CSS.parseHex(e);if(t)return{range:o,color:i5(t.rgba.r,t.rgba.g,t.rgba.b,t.rgba.a)}}function RV(o,e,t){if(!o||e.length!==1)return;const n=e[0].values(),s=PU(n);return{range:o,color:i5(s[0],s[1],s[2],t?s[3]:1)}}function PV(o,e,t){if(!o||e.length!==1)return;const n=e[0].values(),s=PU(n),r=new j(new Nr(s[0],s[1]/100,s[2]/100,t?s[3]:1));return{range:o,color:i5(r.rgba.r,r.rgba.g,r.rgba.b,r.rgba.a)}}function Gb(o,e){return typeof o=="string"?[...o.matchAll(e)]:o.findMatches(e)}function Uie(o){const e=[],i=Gb(o,/\b(rgb|rgba|hsl|hsla)(\([0-9\s,.\%]*\))|(#)([A-Fa-f0-9]{3})\b|(#)([A-Fa-f0-9]{4})\b|(#)([A-Fa-f0-9]{6})\b|(#)([A-Fa-f0-9]{8})\b/gm);if(i.length>0)for(const n of i){const s=n.filter(c=>c!==void 0),r=s[1],a=s[2];if(!a)continue;let l;if(r==="rgb"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*\)$/gm;l=RV(Ub(o,n),Gb(a,c),!1)}else if(r==="rgba"){const c=/^\(\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9][0-9]|[0-9])\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=RV(Ub(o,n),Gb(a,c),!0)}else if(r==="hsl"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*\)$/gm;l=PV(Ub(o,n),Gb(a,c),!1)}else if(r==="hsla"){const c=/^\(\s*(36[0]|3[0-5][0-9]|[12][0-9][0-9]|[1-9]?[0-9])\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(100|\d{1,2}[.]\d*|\d{1,2})%\s*,\s*(0[.][0-9]+|[.][0-9]+|[01][.]|[01])\s*\)$/gm;l=PV(Ub(o,n),Gb(a,c),!0)}else r==="#"&&(l=zie(Ub(o,n),r+a));l&&e.push(l)}return e}function Gie(o){return!o||typeof o.getValue!="function"||typeof o.positionAt!="function"?[]:Uie(o)}const AV=new RegExp("\\bMARK:\\s*(.*)$","d"),$ie=/^-+|-+$/g;function Kie(o,e){let t=[];if(e.findRegionSectionHeaders&&e.foldingRules?.markers){const i=jie(o,e);t=t.concat(i)}if(e.findMarkSectionHeaders){const i=qie(o);t=t.concat(i)}return t}function jie(o,e){const t=[],i=o.getLineCount();for(let n=1;n<=i;n++){const s=o.getLineContent(n),r=s.match(e.foldingRules.markers.start);if(r){const a={startLineNumber:n,startColumn:r[0].length+1,endLineNumber:n,endColumn:s.length+1};if(a.endColumn>a.startColumn){const l={range:a,...AU(s.substring(r[0].length)),shouldBeInComments:!1};(l.text||l.hasSeparatorLine)&&t.push(l)}}}return t}function qie(o){const e=[],t=o.getLineCount();for(let i=1;i<=t;i++){const n=o.getLineContent(i);Zie(n,i,e)}return e}function Zie(o,e,t){AV.lastIndex=0;const i=AV.exec(o);if(i){const n=i.indices[1][0]+1,s=i.indices[1][1]+1,r={startLineNumber:e,startColumn:n,endLineNumber:e,endColumn:s};if(r.endColumn>r.startColumn){const a={range:r,...AU(i[1]),shouldBeInComments:!0};(a.text||a.hasSeparatorLine)&&t.push(a)}}}function AU(o){o=o.trim();const e=o.startsWith("-");return o=o.replace($ie,""),{text:o,hasSeparatorLine:e}}class Yie{constructor(e){this.values=e,this.prefixSum=new Uint32Array(e.length),this.prefixSumValidIndex=new Int32Array(1),this.prefixSumValidIndex[0]=-1}insertValues(e,t){e=mp(e);const i=this.values,n=this.prefixSum,s=t.length;return s===0?!1:(this.values=new Uint32Array(i.length+s),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e),e+s),this.values.set(t,e),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSum=new Uint32Array(this.values.length),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}setValue(e,t){return e=mp(e),t=mp(t),this.values[e]===t?!1:(this.values[e]=t,e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),!0)}removeValues(e,t){e=mp(e),t=mp(t);const i=this.values,n=this.prefixSum;if(e>=i.length)return!1;const s=i.length-e;return t>=s&&(t=s),t===0?!1:(this.values=new Uint32Array(i.length-t),this.values.set(i.subarray(0,e),0),this.values.set(i.subarray(e+t),e),this.prefixSum=new Uint32Array(this.values.length),e-1<this.prefixSumValidIndex[0]&&(this.prefixSumValidIndex[0]=e-1),this.prefixSumValidIndex[0]>=0&&this.prefixSum.set(n.subarray(0,this.prefixSumValidIndex[0]+1)),!0)}getTotalSum(){return this.values.length===0?0:this._getPrefixSum(this.values.length-1)}getPrefixSum(e){return e<0?0:(e=mp(e),this._getPrefixSum(e))}_getPrefixSum(e){if(e<=this.prefixSumValidIndex[0])return this.prefixSum[e];let t=this.prefixSumValidIndex[0]+1;t===0&&(this.prefixSum[0]=this.values[0],t++),e>=this.values.length&&(e=this.values.length-1);for(let i=t;i<=e;i++)this.prefixSum[i]=this.prefixSum[i-1]+this.values[i];return this.prefixSumValidIndex[0]=Math.max(this.prefixSumValidIndex[0],e),this.prefixSum[e]}getIndexOf(e){e=Math.floor(e),this.getTotalSum();let t=0,i=this.values.length-1,n=0,s=0,r=0;for(;t<=i;)if(n=t+(i-t)/2|0,s=this.prefixSum[n],r=s-this.values[n],e<r)i=n-1;else if(e>=s)t=n+1;else break;return new MU(n,e-r)}}class Xie{constructor(e){this._values=e,this._isValid=!1,this._validEndIndex=-1,this._prefixSum=[],this._indexBySum=[]}getTotalSum(){return this._ensureValid(),this._indexBySum.length}getPrefixSum(e){return this._ensureValid(),e===0?0:this._prefixSum[e-1]}getIndexOf(e){this._ensureValid();const t=this._indexBySum[e],i=t>0?this._prefixSum[t-1]:0;return new MU(t,e-i)}removeValues(e,t){this._values.splice(e,t),this._invalidate(e)}insertValues(e,t){this._values=YE(this._values,e,t),this._invalidate(e)}_invalidate(e){this._isValid=!1,this._validEndIndex=Math.min(this._validEndIndex,e-1)}_ensureValid(){if(!this._isValid){for(let e=this._validEndIndex+1,t=this._values.length;e<t;e++){const i=this._values[e],n=e>0?this._prefixSum[e-1]:0;this._prefixSum[e]=n+i;for(let s=0;s<i;s++)this._indexBySum[n+s]=e}this._prefixSum.length=this._values.length,this._indexBySum.length=this._prefixSum[this._prefixSum.length-1],this._isValid=!0,this._validEndIndex=this._values.length-1}}setValue(e,t){this._values[e]!==t&&(this._values[e]=t,this._invalidate(e))}}class MU{constructor(e,t){this.index=e,this.remainder=t,this._prefixSumIndexOfResultBrand=void 0,this.index=e,this.remainder=t}}class Qie{constructor(e,t,i,n){this._uri=e,this._lines=t,this._eol=i,this._versionId=n,this._lineStarts=null,this._cachedTextValue=null}dispose(){this._lines.length=0}get version(){return this._versionId}getText(){return this._cachedTextValue===null&&(this._cachedTextValue=this._lines.join(this._eol)),this._cachedTextValue}onEvents(e){e.eol&&e.eol!==this._eol&&(this._eol=e.eol,this._lineStarts=null);const t=e.changes;for(const i of t)this._acceptDeleteRange(i.range),this._acceptInsertText(new A(i.range.startLineNumber,i.range.startColumn),i.text);this._versionId=e.versionId,this._cachedTextValue=null}_ensureLineStarts(){if(!this._lineStarts){const e=this._eol.length,t=this._lines.length,i=new Uint32Array(t);for(let n=0;n<t;n++)i[n]=this._lines[n].length+e;this._lineStarts=new Yie(i)}}_setLineText(e,t){this._lines[e]=t,this._lineStarts&&this._lineStarts.setValue(e,this._lines[e].length+this._eol.length)}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.startLineNumber-1].substring(e.endColumn-1));return}this._setLineText(e.startLineNumber-1,this._lines[e.startLineNumber-1].substring(0,e.startColumn-1)+this._lines[e.endLineNumber-1].substring(e.endColumn-1)),this._lines.splice(e.startLineNumber,e.endLineNumber-e.startLineNumber),this._lineStarts&&this._lineStarts.removeValues(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t){if(t.length===0)return;const i=Bl(t);if(i.length===1){this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]+this._lines[e.lineNumber-1].substring(e.column-1));return}i[i.length-1]+=this._lines[e.lineNumber-1].substring(e.column-1),this._setLineText(e.lineNumber-1,this._lines[e.lineNumber-1].substring(0,e.column-1)+i[0]);const n=new Uint32Array(i.length-1);for(let s=1;s<i.length;s++)this._lines.splice(e.lineNumber+s-1,0,i[s]),n[s-1]=i[s].length+this._eol.length;this._lineStarts&&this._lineStarts.insertValues(e.lineNumber,n)}}const MV=60*1e3;class Jie extends F{constructor(e,t,i=!1){if(super(),this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),this._proxy=e,this._modelService=t,!i){const n=new W4;n.cancelAndSet(()=>this._checkStopModelSync(),Math.round(MV/2)),this._register(n)}}dispose(){for(const e in this._syncedModels)Dt(this._syncedModels[e]);this._syncedModels=Object.create(null),this._syncedModelsLastUsedTime=Object.create(null),super.dispose()}ensureSyncedResources(e,t=!1){for(const i of e){const n=i.toString();this._syncedModels[n]||this._beginModelSync(i,t),this._syncedModels[n]&&(this._syncedModelsLastUsedTime[n]=new Date().getTime())}}_checkStopModelSync(){const e=new Date().getTime(),t=[];for(const i in this._syncedModelsLastUsedTime)e-this._syncedModelsLastUsedTime[i]>MV&&t.push(i);for(const i of t)this._stopModelSync(i)}_beginModelSync(e,t){const i=this._modelService.getModel(e);if(!i||!t&&i.isTooLargeForSyncing())return;const n=e.toString();this._proxy.$acceptNewModel({url:i.uri.toString(),lines:i.getLinesContent(),EOL:i.getEOL(),versionId:i.getVersionId()});const s=new $;s.add(i.onDidChangeContent(r=>{this._proxy.$acceptModelChanged(n.toString(),r)})),s.add(i.onWillDispose(()=>{this._stopModelSync(n)})),s.add(ve(()=>{this._proxy.$acceptRemovedModel(n)})),this._syncedModels[n]=s}_stopModelSync(e){const t=this._syncedModels[e];delete this._syncedModels[e],delete this._syncedModelsLastUsedTime[e],Dt(t)}}class ene{constructor(){this._models=Object.create(null)}getModel(e){return this._models[e]}getModels(){const e=[];return Object.keys(this._models).forEach(t=>e.push(this._models[t])),e}$acceptNewModel(e){this._models[e.url]=new tne(ye.parse(e.url),e.lines,e.EOL,e.versionId)}$acceptModelChanged(e,t){if(!this._models[e])return;this._models[e].onEvents(t)}$acceptRemovedModel(e){this._models[e]&&delete this._models[e]}}class tne extends Qie{get uri(){return this._uri}get eol(){return this._eol}getValue(){return this.getText()}findMatches(e){const t=[];for(let i=0;i<this._lines.length;i++){const n=this._lines[i],s=this.offsetAt(new A(i+1,1)),r=n.matchAll(e);for(const a of r)(a.index||a.index===0)&&(a.index=a.index+s),t.push(a)}return t}getLinesContent(){return this._lines.slice(0)}getLineCount(){return this._lines.length}getLineContent(e){return this._lines[e-1]}getWordAtPosition(e,t){const i=HC(e.column,S4(t),this._lines[e.lineNumber-1],0);return i?new L(e.lineNumber,i.startColumn,e.lineNumber,i.endColumn):null}words(e){const t=this._lines,i=this._wordenize.bind(this);let n=0,s="",r=0,a=[];return{*[Symbol.iterator](){for(;;)if(r<a.length){const l=s.substring(a[r].start,a[r].end);r+=1,yield l}else if(n<t.length)s=t[n],a=i(s,e),r=0,n+=1;else break}}}getLineWords(e,t){const i=this._lines[e-1],n=this._wordenize(i,t),s=[];for(const r of n)s.push({word:i.substring(r.start,r.end),startColumn:r.start+1,endColumn:r.end+1});return s}_wordenize(e,t){const i=[];let n;for(t.lastIndex=0;(n=t.exec(e))&&n[0].length!==0;)i.push({start:n.index,end:n.index+n[0].length});return i}getValueInRange(e){if(e=this._validateRange(e),e.startLineNumber===e.endLineNumber)return this._lines[e.startLineNumber-1].substring(e.startColumn-1,e.endColumn-1);const t=this._eol,i=e.startLineNumber-1,n=e.endLineNumber-1,s=[];s.push(this._lines[i].substring(e.startColumn-1));for(let r=i+1;r<n;r++)s.push(this._lines[r]);return s.push(this._lines[n].substring(0,e.endColumn-1)),s.join(t)}offsetAt(e){return e=this._validatePosition(e),this._ensureLineStarts(),this._lineStarts.getPrefixSum(e.lineNumber-2)+(e.column-1)}positionAt(e){e=Math.floor(e),e=Math.max(0,e),this._ensureLineStarts();const t=this._lineStarts.getIndexOf(e),i=this._lines[t.index].length;return{lineNumber:1+t.index,column:1+Math.min(t.remainder,i)}}_validateRange(e){const t=this._validatePosition({lineNumber:e.startLineNumber,column:e.startColumn}),i=this._validatePosition({lineNumber:e.endLineNumber,column:e.endColumn});return t.lineNumber!==e.startLineNumber||t.column!==e.startColumn||i.lineNumber!==e.endLineNumber||i.column!==e.endColumn?{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:i.lineNumber,endColumn:i.column}:e}_validatePosition(e){if(!A.isIPosition(e))throw new Error("bad position");let{lineNumber:t,column:i}=e,n=!1;if(t<1)t=1,i=1,n=!0;else if(t>this._lines.length)t=this._lines.length,i=this._lines[t-1].length+1,n=!0;else{const s=this._lines[t-1].length+1;i<1?(i=1,n=!0):i>s&&(i=s,n=!0)}return n?{lineNumber:t,column:i}:e}}const Ek=class Ek{constructor(){this._workerTextModelSyncServer=new ene}dispose(){}_getModel(e){return this._workerTextModelSyncServer.getModel(e)}_getModels(){return this._workerTextModelSyncServer.getModels()}$acceptNewModel(e){this._workerTextModelSyncServer.$acceptNewModel(e)}$acceptModelChanged(e,t){this._workerTextModelSyncServer.$acceptModelChanged(e,t)}$acceptRemovedModel(e){this._workerTextModelSyncServer.$acceptRemovedModel(e)}async $computeUnicodeHighlights(e,t,i){const n=this._getModel(e);return n?Q4.computeUnicodeHighlights(n,t,i):{ranges:[],hasMore:!1,ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0}}async $findSectionHeaders(e,t){const i=this._getModel(e);return i?Kie(i,t):[]}async $computeDiff(e,t,i,n){const s=this._getModel(e),r=this._getModel(t);return!s||!r?null:M1.computeDiff(s,r,i,n)}static computeDiff(e,t,i,n){const s=n==="advanced"?NV.getDefault():NV.getLegacy(),r=e.getLinesContent(),a=t.getLinesContent(),l=s.computeDiff(r,a,i),c=l.changes.length>0?!1:this._modelsAreIdentical(e,t);function d(h){return h.map(u=>[u.original.startLineNumber,u.original.endLineNumberExclusive,u.modified.startLineNumber,u.modified.endLineNumberExclusive,u.innerChanges?.map(g=>[g.originalRange.startLineNumber,g.originalRange.startColumn,g.originalRange.endLineNumber,g.originalRange.endColumn,g.modifiedRange.startLineNumber,g.modifiedRange.startColumn,g.modifiedRange.endLineNumber,g.modifiedRange.endColumn])])}return{identical:c,quitEarly:l.hitTimeout,changes:d(l.changes),moves:l.moves.map(h=>[h.lineRangeMapping.original.startLineNumber,h.lineRangeMapping.original.endLineNumberExclusive,h.lineRangeMapping.modified.startLineNumber,h.lineRangeMapping.modified.endLineNumberExclusive,d(h.changes)])}}static _modelsAreIdentical(e,t){const i=e.getLineCount(),n=t.getLineCount();if(i!==n)return!1;for(let s=1;s<=i;s++){const r=e.getLineContent(s),a=t.getLineContent(s);if(r!==a)return!1}return!0}async $computeMoreMinimalEdits(e,t,i){const n=this._getModel(e);if(!n)return t;const s=[];let r;t=t.slice(0).sort((l,c)=>{if(l.range&&c.range)return L.compareRangesUsingStarts(l.range,c.range);const d=l.range?0:1,h=c.range?0:1;return d-h});let a=0;for(let l=1;l<t.length;l++)L.getEndPosition(t[a].range).equals(L.getStartPosition(t[l].range))?(t[a].range=L.fromPositions(L.getStartPosition(t[a].range),L.getEndPosition(t[l].range)),t[a].text+=t[l].text):(a++,t[a]=t[l]);t.length=a+1;for(let{range:l,text:c,eol:d}of t){if(typeof d=="number"&&(r=d),L.isEmpty(l)&&!c)continue;const h=n.getValueInRange(l);if(c=c.replace(/\r\n|\n|\r/g,n.eol),h===c)continue;if(Math.max(c.length,h.length)>M1._diffLimit){s.push({range:l,text:c});continue}const u=Gte(h,c,i),g=n.offsetAt(L.lift(l).getStartPosition());for(const f of u){const m=n.positionAt(g+f.originalStart),_=n.positionAt(g+f.originalStart+f.originalLength),b={text:c.substr(f.modifiedStart,f.modifiedLength),range:{startLineNumber:m.lineNumber,startColumn:m.column,endLineNumber:_.lineNumber,endColumn:_.column}};n.getValueInRange(b.range)!==b.text&&s.push(b)}}return typeof r=="number"&&s.push({eol:r,text:"",range:{startLineNumber:0,startColumn:0,endLineNumber:0,endColumn:0}}),s}async $computeLinks(e){const t=this._getModel(e);return t?Zte(t):null}async $computeDefaultDocumentColors(e){const t=this._getModel(e);return t?Gie(t):null}async $textualSuggest(e,t,i,n){const s=new rn,r=new RegExp(i,n),a=new Set;e:for(const l of e){const c=this._getModel(l);if(c){for(const d of c.words(r))if(!(d===t||!isNaN(Number(d)))&&(a.add(d),a.size>M1._suggestionsLimit))break e}}return{words:Array.from(a),duration:s.elapsed()}}async $computeWordRanges(e,t,i,n){const s=this._getModel(e);if(!s)return Object.create(null);const r=new RegExp(i,n),a=Object.create(null);for(let l=t.startLineNumber;l<t.endLineNumber;l++){const c=s.getLineWords(l,r);for(const d of c){if(!isNaN(Number(d.word)))continue;let h=a[d.word];h||(h=[],a[d.word]=h),h.push({startLineNumber:l,startColumn:d.startColumn,endLineNumber:l,endColumn:d.endColumn})}}return a}async $navigateValueSet(e,t,i,n,s){const r=this._getModel(e);if(!r)return null;const a=new RegExp(n,s);t.startColumn===t.endColumn&&(t={startLineNumber:t.startLineNumber,startColumn:t.startColumn,endLineNumber:t.endLineNumber,endColumn:t.endColumn+1});const l=r.getValueInRange(t),c=r.getWordAtPosition({lineNumber:t.startLineNumber,column:t.startColumn},a);if(!c)return null;const d=r.getValueInRange(c);return SP.INSTANCE.navigateValueSet(t,l,c,d,i)}};Ek._diffLimit=1e5,Ek._suggestionsLimit=1e4;let DP=Ek;class M1 extends DP{constructor(e,t){super(),this._host=e,this._foreignModuleFactory=t,this._foreignModule=null}async $ping(){return"pong"}$loadForeignModule(e,t,i){const r={host:BY(i,(a,l)=>this._host.$fhr(a,l)),getMirrorModels:()=>this._getModels()};return this._foreignModuleFactory?(this._foreignModule=this._foreignModuleFactory(r,t),Promise.resolve(qN(this._foreignModule))):new Promise((a,l)=>{const c=d=>{this._foreignModule=d.create(r,t),a(qN(this._foreignModule))};{const d=nT.asBrowserUri(`${e}.js`).toString(!0);we(()=>import(`${d}`),[]).then(c).catch(l)}})}$fmr(e,t){if(!this._foreignModule||typeof this._foreignModule[e]!="function")return Promise.reject(new Error("Missing requestHandler or method: "+e));try{return Promise.resolve(this._foreignModule[e].apply(this._foreignModule,t))}catch(i){return Promise.reject(i)}}}typeof importScripts=="function"&&(globalThis.monaco=yz());const wT=Je("textResourceConfigurationService"),OU=Je("textResourcePropertiesService"),ue=Je("ILanguageFeaturesService");var n5=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Pu=function(o,e){return function(t,i){e(t,i,o)}};const OV=5*60*1e3;function Au(o,e){const t=o.getModel(e);return!(!t||t.isTooLargeForSyncing())}let IP=class extends F{constructor(e,t,i,n,s,r){super(),this._languageConfigurationService=s,this._modelService=t,this._workerManager=this._register(new NP(e,this._modelService)),this._logService=n,this._register(r.linkProvider.register({language:"*",hasAccessToAllModels:!0},{provideLinks:async(a,l)=>{if(!Au(this._modelService,a.uri))return Promise.resolve({links:[]});const d=await(await this._workerWithResources([a.uri])).$computeLinks(a.uri.toString());return d&&{links:d}}})),this._register(r.completionProvider.register("*",new ine(this._workerManager,i,this._modelService,this._languageConfigurationService)))}dispose(){super.dispose()}canComputeUnicodeHighlights(e){return Au(this._modelService,e)}async computedUnicodeHighlights(e,t,i){return(await this._workerWithResources([e])).$computeUnicodeHighlights(e.toString(),t,i)}async computeDiff(e,t,i,n){const r=await(await this._workerWithResources([e,t],!0)).$computeDiff(e.toString(),t.toString(),i,n);if(!r)return null;return{identical:r.identical,quitEarly:r.quitEarly,changes:l(r.changes),moves:r.moves.map(c=>new TU(new qn(new Be(c[0],c[1]),new Be(c[2],c[3])),l(c[4])))};function l(c){return c.map(d=>new Mo(new Be(d[0],d[1]),new Be(d[2],d[3]),d[4]?.map(h=>new So(new L(h[0],h[1],h[2],h[3]),new L(h[4],h[5],h[6],h[7])))))}}async computeMoreMinimalEdits(e,t,i=!1){if(Yn(t)){if(!Au(this._modelService,e))return Promise.resolve(t);const n=rn.create(),s=this._workerWithResources([e]).then(r=>r.$computeMoreMinimalEdits(e.toString(),t,i));return s.finally(()=>this._logService.trace("FORMAT#computeMoreMinimalEdits",e.toString(!0),n.elapsed())),Promise.race([s,Kc(1e3).then(()=>t)])}else return Promise.resolve(void 0)}canNavigateValueSet(e){return Au(this._modelService,e)}async navigateValueSet(e,t,i){const n=this._modelService.getModel(e);if(!n)return null;const s=this._languageConfigurationService.getLanguageConfiguration(n.getLanguageId()).getWordDefinition(),r=s.source,a=s.flags;return(await this._workerWithResources([e])).$navigateValueSet(e.toString(),t,i,r,a)}canComputeWordRanges(e){return Au(this._modelService,e)}async computeWordRanges(e,t){const i=this._modelService.getModel(e);if(!i)return Promise.resolve(null);const n=this._languageConfigurationService.getLanguageConfiguration(i.getLanguageId()).getWordDefinition(),s=n.source,r=n.flags;return(await this._workerWithResources([e])).$computeWordRanges(e.toString(),t,s,r)}async findSectionHeaders(e,t){return(await this._workerWithResources([e])).$findSectionHeaders(e.toString(),t)}async computeDefaultDocumentColors(e){return(await this._workerWithResources([e])).$computeDefaultDocumentColors(e.toString())}async _workerWithResources(e,t=!1){return await(await this._workerManager.withWorker()).workerWithSyncedResources(e,t)}};IP=n5([Pu(1,Ut),Pu(2,wT),Pu(3,Tn),Pu(4,li),Pu(5,ue)],IP);class ine{constructor(e,t,i,n){this.languageConfigurationService=n,this._debugDisplayName="wordbasedCompletions",this._workerManager=e,this._configurationService=t,this._modelService=i}async provideCompletionItems(e,t){const i=this._configurationService.getValue(e.uri,t,"editor");if(i.wordBasedSuggestions==="off")return;const n=[];if(i.wordBasedSuggestions==="currentDocument")Au(this._modelService,e.uri)&&n.push(e.uri);else for(const h of this._modelService.getModels())Au(this._modelService,h.uri)&&(h===e?n.unshift(h.uri):(i.wordBasedSuggestions==="allDocuments"||h.getLanguageId()===e.getLanguageId())&&n.push(h.uri));if(n.length===0)return;const s=this.languageConfigurationService.getLanguageConfiguration(e.getLanguageId()).getWordDefinition(),r=e.getWordAtPosition(t),a=r?new L(t.lineNumber,r.startColumn,t.lineNumber,r.endColumn):L.fromPositions(t),l=a.setEndPosition(t.lineNumber,t.column),d=await(await this._workerManager.withWorker()).textualSuggest(n,r?.word,s);if(d)return{duration:d.duration,suggestions:d.words.map(h=>({kind:18,label:h,insertText:h,range:{insert:l,replace:a}}))}}}let NP=class extends F{constructor(e,t){super(),this._workerDescriptor=e,this._modelService=t,this._editorWorkerClient=null,this._lastWorkerUsedTime=new Date().getTime(),this._register(new H4).cancelAndSet(()=>this._checkStopIdleWorker(),Math.round(OV/2),It),this._register(this._modelService.onModelRemoved(n=>this._checkStopEmptyWorker()))}dispose(){this._editorWorkerClient&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null),super.dispose()}_checkStopEmptyWorker(){if(!this._editorWorkerClient)return;this._modelService.getModels().length===0&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}_checkStopIdleWorker(){if(!this._editorWorkerClient)return;new Date().getTime()-this._lastWorkerUsedTime>OV&&(this._editorWorkerClient.dispose(),this._editorWorkerClient=null)}withWorker(){return this._lastWorkerUsedTime=new Date().getTime(),this._editorWorkerClient||(this._editorWorkerClient=new $0(this._workerDescriptor,!1,this._modelService)),Promise.resolve(this._editorWorkerClient)}};NP=n5([Pu(1,Ut)],NP);class nne{constructor(e){this._instance=e,this.proxy=this._instance}dispose(){this._instance.dispose()}setChannel(e,t){throw new Error("Not supported")}}let $0=class extends F{constructor(e,t,i){super(),this._workerDescriptor=e,this._disposed=!1,this._modelService=i,this._keepIdleModels=t,this._worker=null,this._modelManager=null}fhr(e,t){throw new Error("Not implemented!")}_getOrCreateWorker(){if(!this._worker)try{this._worker=this._register(ate(this._workerDescriptor)),xP.setChannel(this._worker,this._createEditorWorkerHost())}catch(e){_P(e),this._worker=this._createFallbackLocalWorker()}return this._worker}async _getProxy(){try{const e=this._getOrCreateWorker().proxy;return await e.$ping(),e}catch(e){return _P(e),this._worker=this._createFallbackLocalWorker(),this._worker.proxy}}_createFallbackLocalWorker(){return new nne(new M1(this._createEditorWorkerHost(),null))}_createEditorWorkerHost(){return{$fhr:(e,t)=>this.fhr(e,t)}}_getOrCreateModelManager(e){return this._modelManager||(this._modelManager=this._register(new Jie(e,this._modelService,this._keepIdleModels))),this._modelManager}async workerWithSyncedResources(e,t=!1){if(this._disposed)return Promise.reject($X());const i=await this._getProxy();return this._getOrCreateModelManager(i).ensureSyncedResources(e,t),i}async textualSuggest(e,t,i){const n=await this.workerWithSyncedResources(e),s=i.source,r=i.flags;return n.$textualSuggest(e.map(a=>a.toString()),t,s,r)}dispose(){super.dispose(),this._disposed=!0}};$0=n5([Pu(2,Ut)],$0);var or;(function(o){o.DARK="dark",o.LIGHT="light",o.HIGH_CONTRAST_DARK="hcDark",o.HIGH_CONTRAST_LIGHT="hcLight"})(or||(or={}));function xa(o){return o===or.HIGH_CONTRAST_DARK||o===or.HIGH_CONTRAST_LIGHT}function v_(o){return o===or.DARK||o===or.HIGH_CONTRAST_DARK}const zi=Je("themeService");function fi(o){return{id:o}}function RP(o){switch(o){case or.DARK:return"vs-dark";case or.HIGH_CONTRAST_DARK:return"hc-black";case or.HIGH_CONTRAST_LIGHT:return"hc-light";default:return"vs"}}const FU={ThemingContribution:"base.contributions.theming"};class sne{constructor(){this.themingParticipants=[],this.themingParticipants=[],this.onThemingParticipantAddedEmitter=new O}onColorThemeChange(e){return this.themingParticipants.push(e),this.onThemingParticipantAddedEmitter.fire(e),ve(()=>{const t=this.themingParticipants.indexOf(e);this.themingParticipants.splice(t,1)})}getThemingParticipants(){return this.themingParticipants}}const BU=new sne;ai.add(FU.ThemingContribution,BU);function br(o){return BU.onColorThemeChange(o)}class one extends F{constructor(e){super(),this.themeService=e,this.theme=e.getColorTheme(),this._register(this.themeService.onDidColorThemeChange(t=>this.onThemeChange(t)))}onThemeChange(e){this.theme=e,this.updateStyles()}updateStyles(){}}var rne=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},ane=function(o,e){return function(t,i){e(t,i,o)}};let PP=class extends F{constructor(e){super(),this._themeService=e,this._onWillCreateCodeEditor=this._register(new O),this._onCodeEditorAdd=this._register(new O),this.onCodeEditorAdd=this._onCodeEditorAdd.event,this._onCodeEditorRemove=this._register(new O),this.onCodeEditorRemove=this._onCodeEditorRemove.event,this._onWillCreateDiffEditor=this._register(new O),this._onDiffEditorAdd=this._register(new O),this.onDiffEditorAdd=this._onDiffEditorAdd.event,this._onDiffEditorRemove=this._register(new O),this.onDiffEditorRemove=this._onDiffEditorRemove.event,this._decorationOptionProviders=new Map,this._codeEditorOpenHandlers=new os,this._modelProperties=new Map,this._codeEditors=Object.create(null),this._diffEditors=Object.create(null),this._globalStyleSheet=null}willCreateCodeEditor(){this._onWillCreateCodeEditor.fire()}addCodeEditor(e){this._codeEditors[e.getId()]=e,this._onCodeEditorAdd.fire(e)}removeCodeEditor(e){delete this._codeEditors[e.getId()]&&this._onCodeEditorRemove.fire(e)}listCodeEditors(){return Object.keys(this._codeEditors).map(e=>this._codeEditors[e])}willCreateDiffEditor(){this._onWillCreateDiffEditor.fire()}addDiffEditor(e){this._diffEditors[e.getId()]=e,this._onDiffEditorAdd.fire(e)}listDiffEditors(){return Object.keys(this._diffEditors).map(e=>this._diffEditors[e])}getFocusedCodeEditor(){let e=null;const t=this.listCodeEditors();for(const i of t){if(i.hasTextFocus())return i;i.hasWidgetFocus()&&(e=i)}return e}removeDecorationType(e){const t=this._decorationOptionProviders.get(e);t&&(t.refCount--,t.refCount<=0&&(this._decorationOptionProviders.delete(e),t.dispose(),this.listCodeEditors().forEach(i=>i.removeDecorationsByType(e))))}setModelProperty(e,t,i){const n=e.toString();let s;this._modelProperties.has(n)?s=this._modelProperties.get(n):(s=new Map,this._modelProperties.set(n,s)),s.set(t,i)}getModelProperty(e,t){const i=e.toString();if(this._modelProperties.has(i))return this._modelProperties.get(i).get(t)}async openCodeEditor(e,t,i){for(const n of this._codeEditorOpenHandlers){const s=await n(e,t,i);if(s!==null)return s}return null}registerCodeEditorOpenHandler(e){const t=this._codeEditorOpenHandlers.unshift(e);return ve(t)}};PP=rne([ane(0,zi)],PP);var lne=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},FV=function(o,e){return function(t,i){e(t,i,o)}};let K0=class extends PP{constructor(e,t){super(t),this._register(this.onCodeEditorAdd(()=>this._checkContextKey())),this._register(this.onCodeEditorRemove(()=>this._checkContextKey())),this._editorIsOpen=e.createKey("editorIsOpen",!1),this._activeCodeEditor=null,this._register(this.registerCodeEditorOpenHandler(async(i,n,s)=>n?this.doOpenEditor(n,i):null))}_checkContextKey(){let e=!1;for(const t of this.listCodeEditors())if(!t.isSimpleWidget){e=!0;break}this._editorIsOpen.set(e)}setActiveCodeEditor(e){this._activeCodeEditor=e}getActiveCodeEditor(){return this._activeCodeEditor}doOpenEditor(e,t){if(!this.findModel(e,t.resource)){if(t.resource){const s=t.resource.scheme;if(s===Oe.http||s===Oe.https)return iU(t.resource.toString()),e}return null}const n=t.options?t.options.selection:null;if(n)if(typeof n.endLineNumber=="number"&&typeof n.endColumn=="number")e.setSelection(n),e.revealRangeInCenter(n,1);else{const s={lineNumber:n.startLineNumber,column:n.startColumn};e.setPosition(s),e.revealPositionInCenter(s,1)}return e}findModel(e,t){const i=e.getModel();return i&&i.uri.toString()!==t.toString()?null:i}};K0=lne([FV(0,Ee),FV(1,zi)],K0);it(gt,K0,0);const qh=Je("layoutService");var WU=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},VU=function(o,e){return function(t,i){e(t,i,o)}};let j0=class{get mainContainer(){return _4(this._codeEditorService.listCodeEditors())?.getContainerDomNode()??It.document.body}get activeContainer(){return(this._codeEditorService.getFocusedCodeEditor()??this._codeEditorService.getActiveCodeEditor())?.getContainerDomNode()??this.mainContainer}get mainContainerDimension(){return Ph(this.mainContainer)}get activeContainerDimension(){return Ph(this.activeContainer)}get containers(){return Vr(this._codeEditorService.listCodeEditors().map(e=>e.getContainerDomNode()))}getContainer(){return this.activeContainer}whenContainerStylesLoaded(){}focus(){this._codeEditorService.getFocusedCodeEditor()?.focus()}constructor(e){this._codeEditorService=e,this.onDidLayoutMainContainer=se.None,this.onDidLayoutActiveContainer=se.None,this.onDidLayoutContainer=se.None,this.onDidChangeActiveContainer=se.None,this.onDidAddContainer=se.None,this.mainContainerOffset={top:0,quickPickTop:0},this.activeContainerOffset={top:0,quickPickTop:0}}};j0=WU([VU(0,gt)],j0);let AP=class extends j0{get mainContainer(){return this._container}constructor(e,t){super(t),this._container=e}};AP=WU([VU(1,gt)],AP);it(qh,j0,1);var ny;(function(o){o[o.Ignore=0]="Ignore",o[o.Info=1]="Info",o[o.Warning=2]="Warning",o[o.Error=3]="Error"})(ny||(ny={}));(function(o){const e="error",t="warning",i="warn",n="info",s="ignore";function r(l){return l?Gp(e,l)?o.Error:Gp(t,l)||Gp(i,l)?o.Warning:Gp(n,l)?o.Info:o.Ignore:o.Ignore}o.fromValue=r;function a(l){switch(l){case o.Error:return e;case o.Warning:return t;case o.Info:return n;default:return s}}o.toString=a})(ny||(ny={}));const ki=ny,Tw=Je("dialogService");var ST=ki;const Ei=Je("notificationService");class cne{}const s5=Je("undoRedoService");class HU{constructor(e,t){this.resource=e,this.elements=t}}const bm=class bm{constructor(){this.id=bm._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};bm._ID=0,bm.None=new bm;let MP=bm;const vm=class vm{constructor(){this.id=vm._ID++,this.order=1}nextOrder(){return this.id===0?0:this.order++}};vm._ID=0,vm.None=new vm;let Mu=vm;var dne=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},BV=function(o,e){return function(t,i){e(t,i,o)}};function SS(o){return o.scheme===Oe.file?o.fsPath:o.path}let zU=0;class xS{constructor(e,t,i,n,s,r,a){this.id=++zU,this.type=0,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabel=t,this.strResource=i,this.resourceLabels=[this.resourceLabel],this.strResources=[this.strResource],this.groupId=n,this.groupOrder=s,this.sourceId=r,this.sourceOrder=a,this.isValid=!0}setValid(e){this.isValid=e}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.isValid?"  VALID":"INVALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class WV{constructor(e,t){this.resourceLabel=e,this.reason=t}}class VV{constructor(){this.elements=new Map}createMessage(){const e=[],t=[];for(const[,n]of this.elements)(n.reason===0?e:t).push(n.resourceLabel);const i=[];return e.length>0&&i.push(p({key:"externalRemoval",comment:["{0} is a list of filenames"]},"The following files have been closed and modified on disk: {0}.",e.join(", "))),t.length>0&&i.push(p({key:"noParallelUniverses",comment:["{0} is a list of filenames"]},"The following files have been modified in an incompatible way: {0}.",t.join(", "))),i.join(`
`)}get size(){return this.elements.size}has(e){return this.elements.has(e)}set(e,t){this.elements.set(e,t)}delete(e){return this.elements.delete(e)}}class hne{constructor(e,t,i,n,s,r,a){this.id=++zU,this.type=1,this.actual=e,this.label=e.label,this.confirmBeforeUndo=e.confirmBeforeUndo||!1,this.resourceLabels=t,this.strResources=i,this.groupId=n,this.groupOrder=s,this.sourceId=r,this.sourceOrder=a,this.removedResources=null,this.invalidatedResources=null}canSplit(){return typeof this.actual.split=="function"}removeResource(e,t,i){this.removedResources||(this.removedResources=new VV),this.removedResources.has(t)||this.removedResources.set(t,new WV(e,i))}setValid(e,t,i){i?this.invalidatedResources&&(this.invalidatedResources.delete(t),this.invalidatedResources.size===0&&(this.invalidatedResources=null)):(this.invalidatedResources||(this.invalidatedResources=new VV),this.invalidatedResources.has(t)||this.invalidatedResources.set(t,new WV(e,0)))}toString(){return`[id:${this.id}] [group:${this.groupId}] [${this.invalidatedResources?"INVALID":"  VALID"}] ${this.actual.constructor.name} - ${this.actual}`}}class UU{constructor(e,t){this.resourceLabel=e,this.strResource=t,this._past=[],this._future=[],this.locked=!1,this.versionId=1}dispose(){for(const e of this._past)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);for(const e of this._future)e.type===1&&e.removeResource(this.resourceLabel,this.strResource,0);this.versionId++}toString(){const e=[];e.push(`* ${this.strResource}:`);for(let t=0;t<this._past.length;t++)e.push(`   * [UNDO] ${this._past[t]}`);for(let t=this._future.length-1;t>=0;t--)e.push(`   * [REDO] ${this._future[t]}`);return e.join(`
`)}flushAllElements(){this._past=[],this._future=[],this.versionId++}_setElementValidFlag(e,t){e.type===1?e.setValid(this.resourceLabel,this.strResource,t):e.setValid(t)}setElementsValidFlag(e,t){for(const i of this._past)t(i.actual)&&this._setElementValidFlag(i,e);for(const i of this._future)t(i.actual)&&this._setElementValidFlag(i,e)}pushElement(e){for(const t of this._future)t.type===1&&t.removeResource(this.resourceLabel,this.strResource,1);this._future=[],this._past.push(e),this.versionId++}createSnapshot(e){const t=[];for(let i=0,n=this._past.length;i<n;i++)t.push(this._past[i].id);for(let i=this._future.length-1;i>=0;i--)t.push(this._future[i].id);return new HU(e,t)}restoreSnapshot(e){const t=e.elements.length;let i=!0,n=0,s=-1;for(let a=0,l=this._past.length;a<l;a++,n++){const c=this._past[a];i&&(n>=t||c.id!==e.elements[n])&&(i=!1,s=0),!i&&c.type===1&&c.removeResource(this.resourceLabel,this.strResource,0)}let r=-1;for(let a=this._future.length-1;a>=0;a--,n++){const l=this._future[a];i&&(n>=t||l.id!==e.elements[n])&&(i=!1,r=a),!i&&l.type===1&&l.removeResource(this.resourceLabel,this.strResource,0)}s!==-1&&(this._past=this._past.slice(0,s)),r!==-1&&(this._future=this._future.slice(r+1)),this.versionId++}getElements(){const e=[],t=[];for(const i of this._past)e.push(i.actual);for(const i of this._future)t.push(i.actual);return{past:e,future:t}}getClosestPastElement(){return this._past.length===0?null:this._past[this._past.length-1]}getSecondClosestPastElement(){return this._past.length<2?null:this._past[this._past.length-2]}getClosestFutureElement(){return this._future.length===0?null:this._future[this._future.length-1]}hasPastElements(){return this._past.length>0}hasFutureElements(){return this._future.length>0}splitPastWorkspaceElement(e,t){for(let i=this._past.length-1;i>=0;i--)if(this._past[i]===e){t.has(this.strResource)?this._past[i]=t.get(this.strResource):this._past.splice(i,1);break}this.versionId++}splitFutureWorkspaceElement(e,t){for(let i=this._future.length-1;i>=0;i--)if(this._future[i]===e){t.has(this.strResource)?this._future[i]=t.get(this.strResource):this._future.splice(i,1);break}this.versionId++}moveBackward(e){this._past.pop(),this._future.push(e),this.versionId++}moveForward(e){this._future.pop(),this._past.push(e),this.versionId++}}class mI{constructor(e){this.editStacks=e,this._versionIds=[];for(let t=0,i=this.editStacks.length;t<i;t++)this._versionIds[t]=this.editStacks[t].versionId}isValid(){for(let e=0,t=this.editStacks.length;e<t;e++)if(this._versionIds[e]!==this.editStacks[e].versionId)return!1;return!0}}const GU=new UU("","");GU.locked=!0;let OP=class{constructor(e,t){this._dialogService=e,this._notificationService=t,this._editStacks=new Map,this._uriComparisonKeyComputers=[]}getUriComparisonKey(e){for(const t of this._uriComparisonKeyComputers)if(t[0]===e.scheme)return t[1].getComparisonKey(e);return e.toString()}_print(e){console.log("------------------------------------"),console.log(`AFTER ${e}: `);const t=[];for(const i of this._editStacks)t.push(i[1].toString());console.log(t.join(`
`))}pushElement(e,t=MP.None,i=Mu.None){if(e.type===0){const n=SS(e.resource),s=this.getUriComparisonKey(e.resource);this._pushElement(new xS(e,n,s,t.id,t.nextOrder(),i.id,i.nextOrder()))}else{const n=new Set,s=[],r=[];for(const a of e.resources){const l=SS(a),c=this.getUriComparisonKey(a);n.has(c)||(n.add(c),s.push(l),r.push(c))}s.length===1?this._pushElement(new xS(e,s[0],r[0],t.id,t.nextOrder(),i.id,i.nextOrder())):this._pushElement(new hne(e,s,r,t.id,t.nextOrder(),i.id,i.nextOrder()))}}_pushElement(e){for(let t=0,i=e.strResources.length;t<i;t++){const n=e.resourceLabels[t],s=e.strResources[t];let r;this._editStacks.has(s)?r=this._editStacks.get(s):(r=new UU(n,s),this._editStacks.set(s,r)),r.pushElement(e)}}getLastElement(e){const t=this.getUriComparisonKey(e);if(this._editStacks.has(t)){const i=this._editStacks.get(t);if(i.hasFutureElements())return null;const n=i.getClosestPastElement();return n?n.actual:null}return null}_splitPastWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const s of i){const r=SS(s.resource),a=this.getUriComparisonKey(s.resource),l=new xS(s,r,a,0,0,0,0);n.set(l.strResource,l)}for(const s of e.strResources){if(t&&t.has(s))continue;this._editStacks.get(s).splitPastWorkspaceElement(e,n)}}_splitFutureWorkspaceElement(e,t){const i=e.actual.split(),n=new Map;for(const s of i){const r=SS(s.resource),a=this.getUriComparisonKey(s.resource),l=new xS(s,r,a,0,0,0,0);n.set(l.strResource,l)}for(const s of e.strResources){if(t&&t.has(s))continue;this._editStacks.get(s).splitFutureWorkspaceElement(e,n)}}removeElements(e){const t=typeof e=="string"?e:this.getUriComparisonKey(e);this._editStacks.has(t)&&(this._editStacks.get(t).dispose(),this._editStacks.delete(t))}setElementsValidFlag(e,t,i){const n=this.getUriComparisonKey(e);this._editStacks.has(n)&&this._editStacks.get(n).setElementsValidFlag(t,i)}createSnapshot(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).createSnapshot(e):new HU(e,[])}restoreSnapshot(e){const t=this.getUriComparisonKey(e.resource);if(this._editStacks.has(t)){const i=this._editStacks.get(t);i.restoreSnapshot(e),!i.hasPastElements()&&!i.hasFutureElements()&&(i.dispose(),this._editStacks.delete(t))}}getElements(e){const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).getElements():{past:[],future:[]}}_findClosestUndoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const r=s.getClosestPastElement();r&&r.sourceId===e&&(!t||r.sourceOrder>t.sourceOrder)&&(t=r,i=n)}return[t,i]}canUndo(e){if(e instanceof Mu){const[,i]=this._findClosestUndoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasPastElements():!1}_onError(e,t){Ae(e);for(const i of t.strResources)this.removeElements(i);this._notificationService.error(e)}_acquireLocks(e){for(const t of e.editStacks)if(t.locked)throw new Error("Cannot acquire edit stack lock");for(const t of e.editStacks)t.locked=!0;return()=>{for(const t of e.editStacks)t.locked=!1}}_safeInvokeWithLocks(e,t,i,n,s){const r=this._acquireLocks(i);let a;try{a=t()}catch(l){return r(),n.dispose(),this._onError(l,e)}return a?a.then(()=>(r(),n.dispose(),s()),l=>(r(),n.dispose(),this._onError(l,e))):(r(),n.dispose(),s())}async _invokeWorkspacePrepare(e){if(typeof e.actual.prepareUndoRedo>"u")return F.None;const t=e.actual.prepareUndoRedo();return typeof t>"u"?F.None:t}_invokeResourcePrepare(e,t){if(e.actual.type!==1||typeof e.actual.prepareUndoRedo>"u")return t(F.None);const i=e.actual.prepareUndoRedo();return i?JE(i)?t(i):i.then(n=>t(n)):t(F.None)}_getAffectedEditStacks(e){const t=[];for(const i of e.strResources)t.push(this._editStacks.get(i)||GU);return new mI(t)}_tryToSplitAndUndo(e,t,i,n){if(t.canSplit())return this._splitPastWorkspaceElement(t,i),this._notificationService.warn(n),new LS(this._undo(e,0,!0));for(const s of t.strResources)this.removeElements(s);return this._notificationService.warn(n),new LS}_checkWorkspaceUndo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndUndo(e,t,t.removedResources,p({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndUndo(e,t,t.invalidatedResources,p({key:"cannotWorkspaceUndo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not undo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const s=[];for(const a of i.editStacks)a.getClosestPastElement()!==t&&s.push(a.resourceLabel);if(s.length>0)return this._tryToSplitAndUndo(e,t,null,p({key:"cannotWorkspaceUndoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because changes were made to {1}",t.label,s.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndUndo(e,t,null,p({key:"cannotWorkspaceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndUndo(e,t,null,p({key:"cannotWorkspaceUndoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not undo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceUndo(e,t,i){const n=this._getAffectedEditStacks(t),s=this._checkWorkspaceUndo(e,t,n,!1);return s?s.returnValue:this._confirmAndExecuteWorkspaceUndo(e,t,n,i)}_isPartOfUndoGroup(e){if(!e.groupId)return!1;for(const[,t]of this._editStacks){const i=t.getClosestPastElement();if(i){if(i===e){const n=t.getSecondClosestPastElement();if(n&&n.groupId===e.groupId)return!0}if(i.groupId===e.groupId)return!0}}return!1}async _confirmAndExecuteWorkspaceUndo(e,t,i,n){if(t.canSplit()&&!this._isPartOfUndoGroup(t)){let a;(function(d){d[d.All=0]="All",d[d.This=1]="This",d[d.Cancel=2]="Cancel"})(a||(a={}));const{result:l}=await this._dialogService.prompt({type:ki.Info,message:p("confirmWorkspace","Would you like to undo '{0}' across all files?",t.label),buttons:[{label:p({key:"ok",comment:["{0} denotes a number that is > 1, && denotes a mnemonic"]},"&&Undo in {0} Files",i.editStacks.length),run:()=>a.All},{label:p({key:"nok",comment:["&& denotes a mnemonic"]},"Undo this &&File"),run:()=>a.This}],cancelButton:{run:()=>a.Cancel}});if(l===a.Cancel)return;if(l===a.This)return this._splitPastWorkspaceElement(t,null),this._undo(e,0,!0);const c=this._checkWorkspaceUndo(e,t,i,!1);if(c)return c.returnValue;n=!0}let s;try{s=await this._invokeWorkspacePrepare(t)}catch(a){return this._onError(a,t)}const r=this._checkWorkspaceUndo(e,t,i,!0);if(r)return s.dispose(),r.returnValue;for(const a of i.editStacks)a.moveBackward(t);return this._safeInvokeWithLocks(t,()=>t.actual.undo(),i,s,()=>this._continueUndoInGroup(t.groupId,n))}_resourceUndo(e,t,i){if(!t.isValid){e.flushAllElements();return}if(e.locked){const n=p({key:"cannotResourceUndoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not undo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(n);return}return this._invokeResourcePrepare(t,n=>(e.moveBackward(t),this._safeInvokeWithLocks(t,()=>t.actual.undo(),new mI([e]),n,()=>this._continueUndoInGroup(t.groupId,i))))}_findClosestUndoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const r=s.getClosestPastElement();r&&r.groupId===e&&(!t||r.groupOrder>t.groupOrder)&&(t=r,i=n)}return[t,i]}_continueUndoInGroup(e,t){if(!e)return;const[,i]=this._findClosestUndoElementInGroup(e);if(i)return this._undo(i,0,t)}undo(e){if(e instanceof Mu){const[,t]=this._findClosestUndoElementWithSource(e.id);return t?this._undo(t,e.id,!1):void 0}return typeof e=="string"?this._undo(e,0,!1):this._undo(this.getUriComparisonKey(e),0,!1)}_undo(e,t=0,i){if(!this._editStacks.has(e))return;const n=this._editStacks.get(e),s=n.getClosestPastElement();if(!s)return;if(s.groupId){const[a,l]=this._findClosestUndoElementInGroup(s.groupId);if(s!==a&&l)return this._undo(l,t,i)}if((s.sourceId!==t||s.confirmBeforeUndo)&&!i)return this._confirmAndContinueUndo(e,t,s);try{return s.type===1?this._workspaceUndo(e,s,i):this._resourceUndo(n,s,i)}finally{}}async _confirmAndContinueUndo(e,t,i){if((await this._dialogService.confirm({message:p("confirmDifferentSource","Would you like to undo '{0}'?",i.label),primaryButton:p({key:"confirmDifferentSource.yes",comment:["&& denotes a mnemonic"]},"&&Yes"),cancelButton:p("confirmDifferentSource.no","No")})).confirmed)return this._undo(e,t,!0)}_findClosestRedoElementWithSource(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const r=s.getClosestFutureElement();r&&r.sourceId===e&&(!t||r.sourceOrder<t.sourceOrder)&&(t=r,i=n)}return[t,i]}canRedo(e){if(e instanceof Mu){const[,i]=this._findClosestRedoElementWithSource(e.id);return!!i}const t=this.getUriComparisonKey(e);return this._editStacks.has(t)?this._editStacks.get(t).hasFutureElements():!1}_tryToSplitAndRedo(e,t,i,n){if(t.canSplit())return this._splitFutureWorkspaceElement(t,i),this._notificationService.warn(n),new LS(this._redo(e));for(const s of t.strResources)this.removeElements(s);return this._notificationService.warn(n),new LS}_checkWorkspaceRedo(e,t,i,n){if(t.removedResources)return this._tryToSplitAndRedo(e,t,t.removedResources,p({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.removedResources.createMessage()));if(n&&t.invalidatedResources)return this._tryToSplitAndRedo(e,t,t.invalidatedResources,p({key:"cannotWorkspaceRedo",comment:["{0} is a label for an operation. {1} is another message."]},"Could not redo '{0}' across all files. {1}",t.label,t.invalidatedResources.createMessage()));const s=[];for(const a of i.editStacks)a.getClosestFutureElement()!==t&&s.push(a.resourceLabel);if(s.length>0)return this._tryToSplitAndRedo(e,t,null,p({key:"cannotWorkspaceRedoDueToChanges",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because changes were made to {1}",t.label,s.join(", ")));const r=[];for(const a of i.editStacks)a.locked&&r.push(a.resourceLabel);return r.length>0?this._tryToSplitAndRedo(e,t,null,p({key:"cannotWorkspaceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because there is already an undo or redo operation running on {1}",t.label,r.join(", "))):i.isValid()?null:this._tryToSplitAndRedo(e,t,null,p({key:"cannotWorkspaceRedoDueToInMeantimeUndoRedo",comment:["{0} is a label for an operation. {1} is a list of filenames."]},"Could not redo '{0}' across all files because an undo or redo operation occurred in the meantime",t.label))}_workspaceRedo(e,t){const i=this._getAffectedEditStacks(t),n=this._checkWorkspaceRedo(e,t,i,!1);return n?n.returnValue:this._executeWorkspaceRedo(e,t,i)}async _executeWorkspaceRedo(e,t,i){let n;try{n=await this._invokeWorkspacePrepare(t)}catch(r){return this._onError(r,t)}const s=this._checkWorkspaceRedo(e,t,i,!0);if(s)return n.dispose(),s.returnValue;for(const r of i.editStacks)r.moveForward(t);return this._safeInvokeWithLocks(t,()=>t.actual.redo(),i,n,()=>this._continueRedoInGroup(t.groupId))}_resourceRedo(e,t){if(!t.isValid){e.flushAllElements();return}if(e.locked){const i=p({key:"cannotResourceRedoDueToInProgressUndoRedo",comment:["{0} is a label for an operation."]},"Could not redo '{0}' because there is already an undo or redo operation running.",t.label);this._notificationService.warn(i);return}return this._invokeResourcePrepare(t,i=>(e.moveForward(t),this._safeInvokeWithLocks(t,()=>t.actual.redo(),new mI([e]),i,()=>this._continueRedoInGroup(t.groupId))))}_findClosestRedoElementInGroup(e){if(!e)return[null,null];let t=null,i=null;for(const[n,s]of this._editStacks){const r=s.getClosestFutureElement();r&&r.groupId===e&&(!t||r.groupOrder<t.groupOrder)&&(t=r,i=n)}return[t,i]}_continueRedoInGroup(e){if(!e)return;const[,t]=this._findClosestRedoElementInGroup(e);if(t)return this._redo(t)}redo(e){if(e instanceof Mu){const[,t]=this._findClosestRedoElementWithSource(e.id);return t?this._redo(t):void 0}return typeof e=="string"?this._redo(e):this._redo(this.getUriComparisonKey(e))}_redo(e){if(!this._editStacks.has(e))return;const t=this._editStacks.get(e),i=t.getClosestFutureElement();if(i){if(i.groupId){const[n,s]=this._findClosestRedoElementInGroup(i.groupId);if(i!==n&&s)return this._redo(s)}try{return i.type===1?this._workspaceRedo(e,i):this._resourceRedo(t,i)}finally{}}}};OP=dne([BV(0,Tw),BV(1,Ei)],OP);class LS{constructor(e){this.returnValue=e}}it(s5,OP,1);function ts(o,e,t){return Math.min(Math.max(o,e),t)}class $U{constructor(){this._n=1,this._val=0}update(e){return this._val=this._val+(e-this._val)/this._n,this._n+=1,this._val}get value(){return this._val}}class une{constructor(e){this._n=0,this._val=0,this._values=[],this._index=0,this._sum=0,this._values=new Array(e),this._values.fill(0,0,e)}update(e){const t=this._values[this._index];return this._values[this._index]=e,this._index=(this._index+1)%this._values.length,this._sum-=t,this._sum+=e,this._n<this._values.length&&(this._n+=1),this._val=this._sum/this._n,this._val}get value(){return this._val}}const o5=Je("environmentService");var gne=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},HV=function(o,e){return function(t,i){e(t,i,o)}};const Uo=Je("ILanguageFeatureDebounceService");var q0;(function(o){const e=new WeakMap;let t=0;function i(n){let s=e.get(n);return s===void 0&&(s=++t,e.set(n,s)),s}o.of=i})(q0||(q0={}));class fne{constructor(e){this._default=e}get(e){return this._default}update(e,t){return this._default}default(){return this._default}}class pne{constructor(e,t,i,n,s,r){this._logService=e,this._name=t,this._registry=i,this._default=n,this._min=s,this._max=r,this._cache=new Vl(50,.7)}_key(e){return e.id+this._registry.all(e).reduce((t,i)=>oT(q0.of(i),t),0)}get(e){const t=this._key(e),i=this._cache.get(t);return i?ts(i.value,this._min,this._max):this.default()}update(e,t){const i=this._key(e);let n=this._cache.get(i);n||(n=new une(6),this._cache.set(i,n));const s=ts(n.update(t),this._min,this._max);return iT(e.uri,"output")||this._logService.trace(`[DEBOUNCE: ${this._name}] for ${e.uri.toString()} is ${s}ms`),s}_overall(){const e=new $U;for(const[,t]of this._cache)e.update(t.value);return e.value}default(){const e=this._overall()|0||this._default;return ts(e,this._min,this._max)}}let FP=class{constructor(e,t){this._logService=e,this._data=new Map,this._isDev=t.isExtensionDevelopment||!t.isBuilt}for(e,t,i){const n=i?.min??50,s=i?.max??n**2,r=i?.key??void 0,a=`${q0.of(e)},${n}${r?","+r:""}`;let l=this._data.get(a);return l||(this._isDev?(this._logService.debug(`[DEBOUNCE: ${t}] is disabled in developed mode`),l=new fne(n*1.5)):l=new pne(this._logService,t,e,this._overallAverage()|0||n*1.5,n,s),this._data.set(a,l)),l}_overallAverage(){const e=new $U;for(const t of this._data.values())e.update(t.default());return e.value}};FP=gne([HV(0,Tn),HV(1,o5)],FP);it(Uo,FP,1);class ks{static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static getClassNameFromMetadata(e){let i="mtk"+this.getForeground(e);const n=this.getFontStyle(e);return n&1&&(i+=" mtki"),n&2&&(i+=" mtkb"),n&4&&(i+=" mtku"),n&8&&(i+=" mtks"),i}static getInlineStyleFromMetadata(e,t){const i=this.getForeground(e),n=this.getFontStyle(e);let s=`color: ${t[i]};`;n&1&&(s+="font-style: italic;"),n&2&&(s+="font-weight: bold;");let r="";return n&4&&(r+=" underline"),n&8&&(r+=" line-through"),r&&(s+=`text-decoration:${r};`),s}static getPresentationFromMetadata(e){const t=this.getForeground(e),i=this.getFontStyle(e);return{foreground:t,italic:!!(i&1),bold:!!(i&2),underline:!!(i&4),strikethrough:!!(i&8)}}}function Mh(o){let e=0,t=0,i=0,n=0;for(let s=0,r=o.length;s<r;s++){const a=o.charCodeAt(s);a===13?(e===0&&(t=s),e++,s+1<r&&o.charCodeAt(s+1)===10?(n|=2,s++):n|=3,i=s+1):a===10&&(n|=1,e===0&&(t=s),e++,i=s+1)}return e===0&&(t=o.length),[e,t,o.length-i,n]}class Bv{static create(e,t){return new Bv(e,new Z0(t))}get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._endLineNumber}constructor(e,t){this._startLineNumber=e,this._tokens=t,this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}toString(){return this._tokens.toString(this._startLineNumber)}_updateEndLineNumber(){this._endLineNumber=this._startLineNumber+this._tokens.getMaxDeltaLine()}isEmpty(){return this._tokens.isEmpty()}getLineTokens(e){return this._startLineNumber<=e&&e<=this._endLineNumber?this._tokens.getLineTokens(e-this._startLineNumber):null}getRange(){const e=this._tokens.getRange();return e&&new L(this._startLineNumber+e.startLineNumber,e.startColumn,this._startLineNumber+e.endLineNumber,e.endColumn)}removeTokens(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;this._startLineNumber+=this._tokens.removeTokens(t,e.startColumn-1,i,e.endColumn-1),this._updateEndLineNumber()}split(e){const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber,[n,s,r]=this._tokens.split(t,e.startColumn-1,i,e.endColumn-1);return[new Bv(this._startLineNumber,n),new Bv(this._startLineNumber+r,s)]}applyEdit(e,t){const[i,n,s]=Mh(t);this.acceptEdit(e,i,n,s,t.length>0?t.charCodeAt(0):0)}acceptEdit(e,t,i,n,s){this._acceptDeleteRange(e),this._acceptInsertText(new A(e.startLineNumber,e.startColumn),t,i,n,s),this._updateEndLineNumber()}_acceptDeleteRange(e){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return;const t=e.startLineNumber-this._startLineNumber,i=e.endLineNumber-this._startLineNumber;if(i<0){const s=i-t;this._startLineNumber-=s;return}const n=this._tokens.getMaxDeltaLine();if(!(t>=n+1)){if(t<0&&i>=n+1){this._startLineNumber=0,this._tokens.clear();return}if(t<0){const s=-t;this._startLineNumber-=s,this._tokens.acceptDeleteRange(e.startColumn-1,0,0,i,e.endColumn-1)}else this._tokens.acceptDeleteRange(0,t,e.startColumn-1,i,e.endColumn-1)}}_acceptInsertText(e,t,i,n,s){if(t===0&&i===0)return;const r=e.lineNumber-this._startLineNumber;if(r<0){this._startLineNumber+=t;return}const a=this._tokens.getMaxDeltaLine();r>=a+1||this._tokens.acceptInsertText(r,e.column-1,t,i,n,s)}}class Z0{constructor(e){this._tokens=e,this._tokenCount=e.length/4}toString(e){const t=[];for(let i=0;i<this._tokenCount;i++)t.push(`(${this._getDeltaLine(i)+e},${this._getStartCharacter(i)}-${this._getEndCharacter(i)})`);return`[${t.join(",")}]`}getMaxDeltaLine(){const e=this._getTokenCount();return e===0?-1:this._getDeltaLine(e-1)}getRange(){const e=this._getTokenCount();if(e===0)return null;const t=this._getStartCharacter(0),i=this._getDeltaLine(e-1),n=this._getEndCharacter(e-1);return new L(0,t+1,i,n+1)}_getTokenCount(){return this._tokenCount}_getDeltaLine(e){return this._tokens[4*e]}_getStartCharacter(e){return this._tokens[4*e+1]}_getEndCharacter(e){return this._tokens[4*e+2]}isEmpty(){return this._getTokenCount()===0}getLineTokens(e){let t=0,i=this._getTokenCount()-1;for(;t<i;){const n=t+Math.floor((i-t)/2),s=this._getDeltaLine(n);if(s<e)t=n+1;else if(s>e)i=n-1;else{let r=n;for(;r>t&&this._getDeltaLine(r-1)===e;)r--;let a=n;for(;a<i&&this._getDeltaLine(a+1)===e;)a++;return new zV(this._tokens.subarray(4*r,4*a+4))}}return this._getDeltaLine(t)===e?new zV(this._tokens.subarray(4*t,4*t+4)):null}clear(){this._tokenCount=0}removeTokens(e,t,i,n){const s=this._tokens,r=this._tokenCount;let a=0,l=!1,c=0;for(let d=0;d<r;d++){const h=4*d,u=s[h],g=s[h+1],f=s[h+2],m=s[h+3];if((u>e||u===e&&f>=t)&&(u<i||u===i&&g<=n))l=!0;else{if(a===0&&(c=u),l){const _=4*a;s[_]=u-c,s[_+1]=g,s[_+2]=f,s[_+3]=m}a++}}return this._tokenCount=a,c}split(e,t,i,n){const s=this._tokens,r=this._tokenCount,a=[],l=[];let c=a,d=0,h=0;for(let u=0;u<r;u++){const g=4*u,f=s[g],m=s[g+1],_=s[g+2],b=s[g+3];if(f>e||f===e&&_>=t){if(f<i||f===i&&m<=n)continue;c!==l&&(c=l,d=0,h=f)}c[d++]=f-h,c[d++]=m,c[d++]=_,c[d++]=b}return[new Z0(new Uint32Array(a)),new Z0(new Uint32Array(l)),h]}acceptDeleteRange(e,t,i,n,s){const r=this._tokens,a=this._tokenCount,l=n-t;let c=0,d=!1;for(let h=0;h<a;h++){const u=4*h;let g=r[u],f=r[u+1],m=r[u+2];const _=r[u+3];if(g<t||g===t&&m<=i){c++;continue}else if(g===t&&f<i)g===n&&m>s?m-=s-i:m=i;else if(g===t&&f===i)if(g===n&&m>s)m-=s-i;else{d=!0;continue}else if(g<n||g===n&&f<s)if(g===n&&m>s)g=t,f=i,m=f+(m-s);else{d=!0;continue}else if(g>n){if(l===0&&!d){c=a;break}g-=l}else if(g===n&&f>=s)e&&g===0&&(f+=e,m+=e),g-=l,f-=s-i,m-=s-i;else throw new Error("Not possible!");const b=4*c;r[b]=g,r[b+1]=f,r[b+2]=m,r[b+3]=_,c++}this._tokenCount=c}acceptInsertText(e,t,i,n,s,r){const a=i===0&&n===1&&(r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122),l=this._tokens,c=this._tokenCount;for(let d=0;d<c;d++){const h=4*d;let u=l[h],g=l[h+1],f=l[h+2];if(!(u<e||u===e&&f<t)){if(u===e&&f===t)if(a)f+=1;else continue;else if(u===e&&g<t&&t<f)i===0?f+=n:f=t;else{if(u===e&&g===t&&a)continue;if(u===e)if(u+=i,i===0)g+=n,f+=n;else{const m=f-g;g=s+(g-t),f=g+m}else u+=i}l[h]=u,l[h+1]=g,l[h+2]=f}}}}class zV{constructor(e){this._tokens=e}getCount(){return this._tokens.length/4}getStartCharacter(e){return this._tokens[4*e+1]}getEndCharacter(e){return this._tokens[4*e+2]}getMetadata(e){return this._tokens[4*e+3]}}var mne=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},_I=function(o,e){return function(t,i){e(t,i,o)}};let BP=class{constructor(e,t,i,n){this._legend=e,this._themeService=t,this._languageService=i,this._logService=n,this._hasWarnedOverlappingTokens=!1,this._hasWarnedInvalidLengthTokens=!1,this._hasWarnedInvalidEditStart=!1,this._hashTable=new WP}getMetadata(e,t,i){const n=this._languageService.languageIdCodec.encodeLanguageId(i),s=this._hashTable.get(e,t,n);let r;if(s)r=s.metadata;else{let a=this._legend.tokenTypes[e];const l=[];if(a){let c=t;for(let h=0;c>0&&h<this._legend.tokenModifiers.length;h++)c&1&&l.push(this._legend.tokenModifiers[h]),c=c>>1;const d=this._themeService.getColorTheme().getTokenStyleMetadata(a,l,i);if(typeof d>"u")r=2147483647;else{if(r=0,typeof d.italic<"u"){const h=(d.italic?1:0)<<11;r|=h|1}if(typeof d.bold<"u"){const h=(d.bold?2:0)<<11;r|=h|2}if(typeof d.underline<"u"){const h=(d.underline?4:0)<<11;r|=h|4}if(typeof d.strikethrough<"u"){const h=(d.strikethrough?8:0)<<11;r|=h|8}if(d.foreground){const h=d.foreground<<15;r|=h|16}r===0&&(r=2147483647)}}else r=2147483647,a="not-in-legend";this._hashTable.add(e,t,n,r)}return r}warnOverlappingSemanticTokens(e,t){this._hasWarnedOverlappingTokens||(this._hasWarnedOverlappingTokens=!0,this._logService.warn(`Overlapping semantic tokens detected at lineNumber ${e}, column ${t}`))}warnInvalidLengthSemanticTokens(e,t){this._hasWarnedInvalidLengthTokens||(this._hasWarnedInvalidLengthTokens=!0,this._logService.warn(`Semantic token with invalid length detected at lineNumber ${e}, column ${t}`))}warnInvalidEditStart(e,t,i,n,s){this._hasWarnedInvalidEditStart||(this._hasWarnedInvalidEditStart=!0,this._logService.warn(`Invalid semantic tokens edit detected (previousResultId: ${e}, resultId: ${t}) at edit #${i}: The provided start offset ${n} is outside the previous data (length ${s}).`))}};BP=mne([_I(1,zi),_I(2,ti),_I(3,Tn)],BP);function KU(o,e,t){const i=o.data,n=o.data.length/5|0,s=Math.max(Math.ceil(n/1024),400),r=[];let a=0,l=1,c=0;for(;a<n;){const d=a;let h=Math.min(d+s,n);if(h<n){let v=h;for(;v-1>d&&i[5*v]===0;)v--;if(v-1===d){let y=h;for(;y+1<n&&i[5*y]===0;)y++;h=y}else h=v}let u=new Uint32Array((h-d)*4),g=0,f=0,m=0,_=0;for(;a<h;){const v=5*a,y=i[v],C=i[v+1],w=l+y|0,x=y===0?c+C|0:C,k=i[v+2],E=x+k|0,N=i[v+3],z=i[v+4];if(E<=x)e.warnInvalidLengthSemanticTokens(w,x+1);else if(m===w&&_>x)e.warnOverlappingSemanticTokens(w,x+1);else{const B=e.getMetadata(N,z,t);B!==2147483647&&(f===0&&(f=w),u[g]=w-f,u[g+1]=x,u[g+2]=E,u[g+3]=B,g+=4,m=w,_=E)}l=w,c=x,a++}g!==u.length&&(u=u.subarray(0,g));const b=Bv.create(f,u);r.push(b)}return r}class _ne{constructor(e,t,i,n){this.tokenTypeIndex=e,this.tokenModifierSet=t,this.languageId=i,this.metadata=n,this.next=null}}const dc=class dc{constructor(){this._elementsCount=0,this._currentLengthIndex=0,this._currentLength=dc._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<dc._SIZES.length?2/3*this._currentLength:0),this._elements=[],dc._nullOutEntries(this._elements,this._currentLength)}static _nullOutEntries(e,t){for(let i=0;i<t;i++)e[i]=null}_hash2(e,t){return(e<<5)-e+t|0}_hashFunc(e,t,i){return this._hash2(this._hash2(e,t),i)%this._currentLength}get(e,t,i){const n=this._hashFunc(e,t,i);let s=this._elements[n];for(;s;){if(s.tokenTypeIndex===e&&s.tokenModifierSet===t&&s.languageId===i)return s;s=s.next}return null}add(e,t,i,n){if(this._elementsCount++,this._growCount!==0&&this._elementsCount>=this._growCount){const s=this._elements;this._currentLengthIndex++,this._currentLength=dc._SIZES[this._currentLengthIndex],this._growCount=Math.round(this._currentLengthIndex+1<dc._SIZES.length?2/3*this._currentLength:0),this._elements=[],dc._nullOutEntries(this._elements,this._currentLength);for(const r of s){let a=r;for(;a;){const l=a.next;a.next=null,this._add(a),a=l}}}this._add(new _ne(e,t,i,n))}_add(e){const t=this._hashFunc(e.tokenTypeIndex,e.tokenModifierSet,e.languageId);e.next=this._elements[t],this._elements[t]=e}};dc._SIZES=[3,7,13,31,61,127,251,509,1021,2039,4093,8191,16381,32749,65521,131071,262139,524287,1048573,2097143];let WP=dc;const xT=Je("semanticTokensStylingService");var bne=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},bI=function(o,e){return function(t,i){e(t,i,o)}};let VP=class extends F{constructor(e,t,i){super(),this._themeService=e,this._logService=t,this._languageService=i,this._caches=new WeakMap,this._register(this._themeService.onDidColorThemeChange(()=>{this._caches=new WeakMap}))}getStyling(e){return this._caches.has(e)||this._caches.set(e,new BP(e.getLegend(),this._themeService,this._languageService,this._logService)),this._caches.get(e)}};VP=bne([bI(0,zi),bI(1,Tn),bI(2,ti)],VP);it(xT,VP,1);function md(o){return o===47||o===92}function jU(o){return o.replace(/[\\/]/g,Ri.sep)}function vne(o){return o.indexOf("/")===-1&&(o=jU(o)),/^[a-zA-Z]:(\/|$)/.test(o)&&(o="/"+o),o}function UV(o,e=Ri.sep){if(!o)return"";const t=o.length,i=o.charCodeAt(0);if(md(i)){if(md(o.charCodeAt(1))&&!md(o.charCodeAt(2))){let s=3;const r=s;for(;s<t&&!md(o.charCodeAt(s));s++);if(r!==s&&!md(o.charCodeAt(s+1))){for(s+=1;s<t;s++)if(md(o.charCodeAt(s)))return o.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(qU(i)&&o.charCodeAt(1)===58)return md(o.charCodeAt(2))?o.slice(0,2)+e:o.slice(0,2);let n=o.indexOf("://");if(n!==-1){for(n+=3;n<t;n++)if(md(o.charCodeAt(n)))return o.slice(0,n+1)}return""}function HP(o,e,t,i=ya){if(o===e)return!0;if(!o||!e||e.length>o.length)return!1;if(t){if(!N4(o,e))return!1;if(e.length===o.length)return!0;let s=e.length;return e.charAt(e.length-1)===i&&s--,o.charAt(s)===i}return e.charAt(e.length-1)!==i&&(e+=i),o.indexOf(e)===0}function qU(o){return o>=65&&o<=90||o>=97&&o<=122}function Cne(o,e=En){return e?qU(o.charCodeAt(0))&&o.charCodeAt(1)===58:!1}const kS="**",GV="/",O1="[/\\\\]",F1="[^/\\\\]",yne=/\//g;function $V(o,e){switch(o){case 0:return"";case 1:return`${F1}*?`;default:return`(?:${O1}|${F1}+${O1}${e?`|${O1}${F1}+`:""})*?`}}function KV(o,e){if(!o)return[];const t=[];let i=!1,n=!1,s="";for(const r of o){switch(r){case e:if(!i&&!n){t.push(s),s="";continue}break;case"{":i=!0;break;case"}":i=!1;break;case"[":n=!0;break;case"]":n=!1;break}s+=r}return s&&t.push(s),t}function ZU(o){if(!o)return"";let e="";const t=KV(o,GV);if(t.every(i=>i===kS))e=".*";else{let i=!1;t.forEach((n,s)=>{if(n===kS){if(i)return;e+=$V(2,s===t.length-1)}else{let r=!1,a="",l=!1,c="";for(const d of n){if(d!=="}"&&r){a+=d;continue}if(l&&(d!=="]"||!c)){let h;d==="-"?h=d:(d==="^"||d==="!")&&!c?h="^":d===GV?h="":h=Fo(d),c+=h;continue}switch(d){case"{":r=!0;continue;case"[":l=!0;continue;case"}":{const u=`(?:${KV(a,",").map(g=>ZU(g)).join("|")})`;e+=u,r=!1,a="";break}case"]":{e+="["+c+"]",l=!1,c="";break}case"?":e+=F1;continue;case"*":e+=$V(1);continue;default:e+=Fo(d)}}s<t.length-1&&(t[s+1]!==kS||s+2<t.length)&&(e+=O1)}i=n===kS})}return e}const wne=/^\*\*\/\*\.[\w\.-]+$/,Sne=/^\*\*\/([\w\.-]+)\/?$/,xne=/^{\*\*\/\*?[\w\.-]+\/?(,\*\*\/\*?[\w\.-]+\/?)*}$/,Lne=/^{\*\*\/\*?[\w\.-]+(\/(\*\*)?)?(,\*\*\/\*?[\w\.-]+(\/(\*\*)?)?)*}$/,kne=/^\*\*((\/[\w\.-]+)+)\/?$/,Ene=/^([\w\.-]+(\/[\w\.-]+)*)\/?$/,jV=new Vl(1e4),qV=function(){return!1},Ll=function(){return null};function r5(o,e){if(!o)return Ll;let t;typeof o!="string"?t=o.pattern:t=o,t=t.trim();const i=`${t}_${!!e.trimForExclusions}`;let n=jV.get(i);if(n)return ZV(n,o);let s;return wne.test(t)?n=Tne(t.substr(4),t):(s=Sne.exec(vI(t,e)))?n=Dne(s[1],t):(e.trimForExclusions?Lne:xne).test(t)?n=Ine(t,e):(s=kne.exec(vI(t,e)))?n=YV(s[1].substr(1),t,!0):(s=Ene.exec(vI(t,e)))?n=YV(s[1],t,!1):n=Nne(t),jV.set(i,n),ZV(n,o)}function ZV(o,e){if(typeof e=="string")return o;const t=function(i,n){return HP(i,e.base,!us)?o(yw(i.substr(e.base.length),ya),n):null};return t.allBasenames=o.allBasenames,t.allPaths=o.allPaths,t.basenames=o.basenames,t.patterns=o.patterns,t}function vI(o,e){return e.trimForExclusions&&o.endsWith("/**")?o.substr(0,o.length-2):o}function Tne(o,e){return function(t,i){return typeof t=="string"&&t.endsWith(o)?e:null}}function Dne(o,e){const t=`/${o}`,i=`\\${o}`,n=function(r,a){return typeof r!="string"?null:a?a===o?e:null:r===o||r.endsWith(t)||r.endsWith(i)?e:null},s=[o];return n.basenames=s,n.patterns=[e],n.allBasenames=s,n}function Ine(o,e){const t=XU(o.slice(1,-1).split(",").map(a=>r5(a,e)).filter(a=>a!==Ll),o),i=t.length;if(!i)return Ll;if(i===1)return t[0];const n=function(a,l){for(let c=0,d=t.length;c<d;c++)if(t[c](a,l))return o;return null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(n.allPaths=r),n}function YV(o,e,t){const i=ya===Ri.sep,n=i?o:o.replace(yne,ya),s=ya+n,r=Ri.sep+o;let a;return t?a=function(l,c){return typeof l=="string"&&(l===n||l.endsWith(s)||!i&&(l===o||l.endsWith(r)))?e:null}:a=function(l,c){return typeof l=="string"&&(l===n||!i&&l===o)?e:null},a.allPaths=[(t?"*/":"./")+o],a}function Nne(o){try{const e=new RegExp(`^${ZU(o)}$`);return function(t){return e.lastIndex=0,typeof t=="string"&&e.test(t)?o:null}}catch{return Ll}}function Rne(o,e,t){return!o||typeof e!="string"?!1:YU(o)(e,void 0,t)}function YU(o,e={}){if(!o)return qV;if(typeof o=="string"||Pne(o)){const t=r5(o,e);if(t===Ll)return qV;const i=function(n,s){return!!t(n,s)};return t.allBasenames&&(i.allBasenames=t.allBasenames),t.allPaths&&(i.allPaths=t.allPaths),i}return Ane(o,e)}function Pne(o){const e=o;return e?typeof e.base=="string"&&typeof e.pattern=="string":!1}function Ane(o,e){const t=XU(Object.getOwnPropertyNames(o).map(a=>Mne(a,o[a],e)).filter(a=>a!==Ll)),i=t.length;if(!i)return Ll;if(!t.some(a=>!!a.requiresSiblings)){if(i===1)return t[0];const a=function(d,h){let u;for(let g=0,f=t.length;g<f;g++){const m=t[g](d,h);if(typeof m=="string")return m;nP(m)&&(u||(u=[]),u.push(m))}return u?(async()=>{for(const g of u){const f=await g;if(typeof f=="string")return f}return null})():null},l=t.find(d=>!!d.allBasenames);l&&(a.allBasenames=l.allBasenames);const c=t.reduce((d,h)=>h.allPaths?d.concat(h.allPaths):d,[]);return c.length&&(a.allPaths=c),a}const n=function(a,l,c){let d,h;for(let u=0,g=t.length;u<g;u++){const f=t[u];f.requiresSiblings&&c&&(l||(l=th(a)),d||(d=l.substr(0,l.length-_Q(a).length)));const m=f(a,l,d,c);if(typeof m=="string")return m;nP(m)&&(h||(h=[]),h.push(m))}return h?(async()=>{for(const u of h){const g=await u;if(typeof g=="string")return g}return null})():null},s=t.find(a=>!!a.allBasenames);s&&(n.allBasenames=s.allBasenames);const r=t.reduce((a,l)=>l.allPaths?a.concat(l.allPaths):a,[]);return r.length&&(n.allPaths=r),n}function Mne(o,e,t){if(e===!1)return Ll;const i=r5(o,t);if(i===Ll)return Ll;if(typeof e=="boolean")return i;if(e){const n=e.when;if(typeof n=="string"){const s=(r,a,l,c)=>{if(!c||!i(r,a))return null;const d=n.replace("$(basename)",()=>l),h=c(d);return nP(h)?h.then(u=>u?o:null):h?o:null};return s.requiresSiblings=!0,s}}return i}function XU(o,e){const t=o.filter(a=>!!a.basenames);if(t.length<2)return o;const i=t.reduce((a,l)=>{const c=l.basenames;return c?a.concat(c):a},[]);let n;if(e){n=[];for(let a=0,l=i.length;a<l;a++)n.push(e)}else n=t.reduce((a,l)=>{const c=l.patterns;return c?a.concat(c):a},[]);const s=function(a,l){if(typeof a!="string")return null;if(!l){let d;for(d=a.length;d>0;d--){const h=a.charCodeAt(d-1);if(h===47||h===92)break}l=a.substr(d)}const c=i.indexOf(l);return c!==-1?n[c]:null};s.basenames=i,s.patterns=n,s.allBasenames=i;const r=o.filter(a=>!a.basenames);return r.push(s),r}function a5(o,e,t,i,n,s){if(Array.isArray(o)){let r=0;for(const a of o){const l=a5(a,e,t,i,n,s);if(l===10)return l;l>r&&(r=l)}return r}else{if(typeof o=="string")return i?o==="*"?5:o===t?10:0:0;if(o){const{language:r,pattern:a,scheme:l,hasAccessToAllModels:c,notebookType:d}=o;if(!i&&!c)return 0;d&&n&&(e=n);let h=0;if(l)if(l===e.scheme)h=10;else if(l==="*")h=5;else return 0;if(r)if(r===t)h=10;else if(r==="*")h=Math.max(h,5);else return 0;if(d)if(d===s)h=10;else if(d==="*"&&s!==void 0)h=Math.max(h,5);else return 0;if(a){let u;if(typeof a=="string"?u=a:u={...a,base:gz(a.base)},u===e.fsPath||Rne(u,e.fsPath))h=10;else return 0}return h}else return 0}}function QU(o){return typeof o=="string"?!1:Array.isArray(o)?o.every(QU):!!o.exclusive}class XV{constructor(e,t,i,n,s){this.uri=e,this.languageId=t,this.notebookUri=i,this.notebookType=n,this.recursive=s}equals(e){return this.notebookType===e.notebookType&&this.languageId===e.languageId&&this.uri.toString()===e.uri.toString()&&this.notebookUri?.toString()===e.notebookUri?.toString()&&this.recursive===e.recursive}}class ni{constructor(e){this._notebookInfoResolver=e,this._clock=0,this._entries=[],this._onDidChange=new O,this.onDidChange=this._onDidChange.event}register(e,t){let i={selector:e,provider:t,_score:-1,_time:this._clock++};return this._entries.push(i),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),ve(()=>{if(i){const n=this._entries.indexOf(i);n>=0&&(this._entries.splice(n,1),this._lastCandidate=void 0,this._onDidChange.fire(this._entries.length),i=void 0)}})}has(e){return this.all(e).length>0}all(e){if(!e)return[];this._updateScores(e,!1);const t=[];for(const i of this._entries)i._score>0&&t.push(i.provider);return t}ordered(e,t=!1){const i=[];return this._orderedForEach(e,t,n=>i.push(n.provider)),i}orderedGroups(e){const t=[];let i,n;return this._orderedForEach(e,!1,s=>{i&&n===s._score?i.push(s.provider):(n=s._score,i=[s.provider],t.push(i))}),t}_orderedForEach(e,t,i){this._updateScores(e,t);for(const n of this._entries)n._score>0&&i(n)}_updateScores(e,t){const i=this._notebookInfoResolver?.(e.uri),n=i?new XV(e.uri,e.getLanguageId(),i.uri,i.type,t):new XV(e.uri,e.getLanguageId(),void 0,void 0,t);if(!this._lastCandidate?.equals(n)){this._lastCandidate=n;for(const s of this._entries)if(s._score=a5(s.selector,n.uri,n.languageId,EU(e),n.notebookUri,n.notebookType),QU(s.selector)&&s._score>0)if(t)s._score=0;else{for(const r of this._entries)r._score=0;s._score=1e3;break}this._entries.sort(ni._compareByScoreAndTime)}}static _compareByScoreAndTime(e,t){return e._score<t._score?1:e._score>t._score?-1:hv(e.selector)&&!hv(t.selector)?1:!hv(e.selector)&&hv(t.selector)?-1:e._time<t._time?1:e._time>t._time?-1:0}}function hv(o){return typeof o=="string"?!1:Array.isArray(o)?o.some(hv):!!o.isBuiltin}class One{constructor(){this.referenceProvider=new ni(this._score.bind(this)),this.renameProvider=new ni(this._score.bind(this)),this.newSymbolNamesProvider=new ni(this._score.bind(this)),this.codeActionProvider=new ni(this._score.bind(this)),this.definitionProvider=new ni(this._score.bind(this)),this.typeDefinitionProvider=new ni(this._score.bind(this)),this.declarationProvider=new ni(this._score.bind(this)),this.implementationProvider=new ni(this._score.bind(this)),this.documentSymbolProvider=new ni(this._score.bind(this)),this.inlayHintsProvider=new ni(this._score.bind(this)),this.colorProvider=new ni(this._score.bind(this)),this.codeLensProvider=new ni(this._score.bind(this)),this.documentFormattingEditProvider=new ni(this._score.bind(this)),this.documentRangeFormattingEditProvider=new ni(this._score.bind(this)),this.onTypeFormattingEditProvider=new ni(this._score.bind(this)),this.signatureHelpProvider=new ni(this._score.bind(this)),this.hoverProvider=new ni(this._score.bind(this)),this.documentHighlightProvider=new ni(this._score.bind(this)),this.multiDocumentHighlightProvider=new ni(this._score.bind(this)),this.selectionRangeProvider=new ni(this._score.bind(this)),this.foldingRangeProvider=new ni(this._score.bind(this)),this.linkProvider=new ni(this._score.bind(this)),this.inlineCompletionsProvider=new ni(this._score.bind(this)),this.inlineEditProvider=new ni(this._score.bind(this)),this.completionProvider=new ni(this._score.bind(this)),this.linkedEditingRangeProvider=new ni(this._score.bind(this)),this.documentRangeSemanticTokensProvider=new ni(this._score.bind(this)),this.documentSemanticTokensProvider=new ni(this._score.bind(this)),this.documentDropEditProvider=new ni(this._score.bind(this)),this.documentPasteEditProvider=new ni(this._score.bind(this))}_score(e){return this._notebookTypeResolver?.(e)}}it(ue,One,1);function l5(o){return`--vscode-${o.replace(/\./g,"-")}`}function ce(o){return`var(${l5(o)})`}function Fne(o,e){return`var(${l5(o)}, ${e})`}function Bne(o){return o!==null&&typeof o=="object"&&"light"in o&&"dark"in o}const JU={ColorContribution:"base.contributions.colors"},Wne="default";class Vne{constructor(){this._onDidChangeSchema=new O,this.onDidChangeSchema=this._onDidChangeSchema.event,this.colorSchema={type:"object",properties:{}},this.colorReferenceSchema={type:"string",enum:[],enumDescriptions:[]},this.colorsById={}}registerColor(e,t,i,n=!1,s){const r={id:e,description:i,defaults:t,needsTransparency:n,deprecationMessage:s};this.colorsById[e]=r;const a={type:"string",format:"color-hex",defaultSnippets:[{body:"${1:#ff0000}"}]};return s&&(a.deprecationMessage=s),n&&(a.pattern="^#(?:(?<rgba>[0-9a-fA-f]{3}[0-9a-eA-E])|(?:[0-9a-fA-F]{6}(?:(?![fF]{2})(?:[0-9a-fA-F]{2}))))?$",a.patternErrorMessage=p("transparecyRequired","This color must be transparent or it will obscure content")),this.colorSchema.properties[e]={description:i,oneOf:[a,{type:"string",const:Wne,description:p("useDefault","Use the default color.")}]},this.colorReferenceSchema.enum.push(e),this.colorReferenceSchema.enumDescriptions.push(i),this._onDidChangeSchema.fire(),e}getColors(){return Object.keys(this.colorsById).map(e=>this.colorsById[e])}resolveDefaultColor(e,t){const i=this.colorsById[e];if(i?.defaults){const n=Bne(i.defaults)?i.defaults[t.type]:i.defaults;return Jr(n,t)}}getColorSchema(){return this.colorSchema}toString(){const e=(t,i)=>{const n=t.indexOf(".")===-1?0:1,s=i.indexOf(".")===-1?0:1;return n!==s?n-s:t.localeCompare(i)};return Object.keys(this.colorsById).sort(e).map(t=>`- \`${t}\`: ${this.colorsById[t].description}`).join(`
`)}}const LT=new Vne;ai.add(JU.ColorContribution,LT);function D(o,e,t,i,n){return LT.registerColor(o,e,t,i,n)}function Hne(o,e){switch(o.op){case 0:return Jr(o.value,e)?.darken(o.factor);case 1:return Jr(o.value,e)?.lighten(o.factor);case 2:return Jr(o.value,e)?.transparent(o.factor);case 3:{const t=Jr(o.background,e);return t?Jr(o.value,e)?.makeOpaque(t):Jr(o.value,e)}case 4:for(const t of o.values){const i=Jr(t,e);if(i)return i}return;case 6:return Jr(e.defines(o.if)?o.then:o.else,e);case 5:{const t=Jr(o.value,e);if(!t)return;const i=Jr(o.background,e);return i?t.isDarkerThan(i)?j.getLighterColor(t,i,o.factor).transparent(o.transparency):j.getDarkerColor(t,i,o.factor).transparent(o.transparency):t.transparent(o.factor*o.transparency)}default:throw _T()}}function jf(o,e){return{op:0,value:o,factor:e}}function La(o,e){return{op:1,value:o,factor:e}}function Ue(o,e){return{op:2,value:o,factor:e}}function sy(...o){return{op:4,values:o}}function zne(o,e,t){return{op:6,if:o,then:e,else:t}}function QV(o,e,t,i){return{op:5,value:o,background:e,factor:t,transparency:i}}function Jr(o,e){if(o!==null){if(typeof o=="string")return o[0]==="#"?j.fromHex(o):e.getColor(o);if(o instanceof j)return o;if(typeof o=="object")return Hne(o,e)}}const eG="vscode://schemas/workbench-colors",tG=ai.as(yT.JSONContribution);tG.registerSchema(eG,LT.getColorSchema());const JV=new xt(()=>tG.notifySchemaChanged(eG),200);LT.onDidChangeSchema(()=>{JV.isScheduled()||JV.schedule()});const qe=D("foreground",{dark:"#CCCCCC",light:"#616161",hcDark:"#FFFFFF",hcLight:"#292929"},p("foreground","Overall foreground color. This color is only used if not overridden by a component."));D("disabledForeground",{dark:"#CCCCCC80",light:"#61616180",hcDark:"#A5A5A5",hcLight:"#7F7F7F"},p("disabledForeground","Overall foreground for disabled elements. This color is only used if not overridden by a component."));D("errorForeground",{dark:"#F48771",light:"#A1260D",hcDark:"#F48771",hcLight:"#B5200D"},p("errorForeground","Overall foreground color for error messages. This color is only used if not overridden by a component."));D("descriptionForeground",{light:"#717171",dark:Ue(qe,.7),hcDark:Ue(qe,.7),hcLight:Ue(qe,.7)},p("descriptionForeground","Foreground color for description text providing additional information, for example for a label."));const Y0=D("icon.foreground",{dark:"#C5C5C5",light:"#424242",hcDark:"#FFFFFF",hcLight:"#292929"},p("iconForeground","The default color for icons in the workbench.")),Il=D("focusBorder",{dark:"#007FD4",light:"#0090F1",hcDark:"#F38518",hcLight:"#006BBD"},p("focusBorder","Overall border color for focused elements. This color is only used if not overridden by a component.")),rt=D("contrastBorder",{light:null,dark:null,hcDark:"#6FC3DF",hcLight:"#0F4A85"},p("contrastBorder","An extra border around elements to separate them from others for greater contrast.")),qt=D("contrastActiveBorder",{light:null,dark:null,hcDark:Il,hcLight:Il},p("activeContrastBorder","An extra border around active elements to separate them from others for greater contrast."));D("selection.background",null,p("selectionBackground","The background color of text selections in the workbench (e.g. for input fields or text areas). Note that this does not apply to selections within the editor."));const Une=D("textLink.foreground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkForeground","Foreground color for links in text."));D("textLink.activeForeground",{light:"#006AB1",dark:"#3794FF",hcDark:"#21A6FF",hcLight:"#0F4A85"},p("textLinkActiveForeground","Foreground color for links in text when clicked on and on mouse hover."));D("textSeparator.foreground",{light:"#0000002e",dark:"#ffffff2e",hcDark:j.black,hcLight:"#292929"},p("textSeparatorForeground","Color for text separators."));D("textPreformat.foreground",{light:"#A31515",dark:"#D7BA7D",hcDark:"#000000",hcLight:"#FFFFFF"},p("textPreformatForeground","Foreground color for preformatted text segments."));D("textPreformat.background",{light:"#0000001A",dark:"#FFFFFF1A",hcDark:"#FFFFFF",hcLight:"#09345f"},p("textPreformatBackground","Background color for preformatted text segments."));D("textBlockQuote.background",{light:"#f2f2f2",dark:"#222222",hcDark:null,hcLight:"#F2F2F2"},p("textBlockQuoteBackground","Background color for block quotes in text."));D("textBlockQuote.border",{light:"#007acc80",dark:"#007acc80",hcDark:j.white,hcLight:"#292929"},p("textBlockQuoteBorder","Border color for block quotes in text."));D("textCodeBlock.background",{light:"#dcdcdc66",dark:"#0a0a0a66",hcDark:j.black,hcLight:"#F2F2F2"},p("textCodeBlockBackground","Background color for code blocks in text."));D("sash.hoverBorder",Il,p("sashActiveBorder","Border color of active sashes."));const B1=D("badge.background",{dark:"#4D4D4D",light:"#C4C4C4",hcDark:j.black,hcLight:"#0F4A85"},p("badgeBackground","Badge background color. Badges are small information labels, e.g. for search results count.")),Gne=D("badge.foreground",{dark:j.white,light:"#333",hcDark:j.white,hcLight:j.white},p("badgeForeground","Badge foreground color. Badges are small information labels, e.g. for search results count.")),c5=D("scrollbar.shadow",{dark:"#000000",light:"#DDDDDD",hcDark:null,hcLight:null},p("scrollbarShadow","Scrollbar shadow to indicate that the view is scrolled.")),iG=D("scrollbarSlider.background",{dark:j.fromHex("#797979").transparent(.4),light:j.fromHex("#646464").transparent(.4),hcDark:Ue(rt,.6),hcLight:Ue(rt,.4)},p("scrollbarSliderBackground","Scrollbar slider background color.")),nG=D("scrollbarSlider.hoverBackground",{dark:j.fromHex("#646464").transparent(.7),light:j.fromHex("#646464").transparent(.7),hcDark:Ue(rt,.8),hcLight:Ue(rt,.8)},p("scrollbarSliderHoverBackground","Scrollbar slider background color when hovering.")),sG=D("scrollbarSlider.activeBackground",{dark:j.fromHex("#BFBFBF").transparent(.4),light:j.fromHex("#000000").transparent(.6),hcDark:rt,hcLight:rt},p("scrollbarSliderActiveBackground","Scrollbar slider background color when clicked on.")),$ne=D("progressBar.background",{dark:j.fromHex("#0E70C0"),light:j.fromHex("#0E70C0"),hcDark:rt,hcLight:rt},p("progressBarBackground","Background color of the progress bar that can show for long running operations.")),$r=D("editor.background",{light:"#ffffff",dark:"#1E1E1E",hcDark:j.black,hcLight:j.white},p("editorBackground","Editor background color.")),Hl=D("editor.foreground",{light:"#333333",dark:"#BBBBBB",hcDark:j.white,hcLight:qe},p("editorForeground","Editor default foreground color."));D("editorStickyScroll.background",$r,p("editorStickyScrollBackground","Background color of sticky scroll in the editor"));D("editorStickyScrollHover.background",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:null,hcLight:j.fromHex("#0F4A85").transparent(.1)},p("editorStickyScrollHoverBackground","Background color of sticky scroll on hover in the editor"));D("editorStickyScroll.border",{dark:null,light:null,hcDark:rt,hcLight:rt},p("editorStickyScrollBorder","Border color of sticky scroll in the editor"));D("editorStickyScroll.shadow",c5,p("editorStickyScrollShadow"," Shadow color of sticky scroll in the editor"));const Ro=D("editorWidget.background",{dark:"#252526",light:"#F3F3F3",hcDark:"#0C141F",hcLight:j.white},p("editorWidgetBackground","Background color of editor widgets, such as find/replace.")),kT=D("editorWidget.foreground",qe,p("editorWidgetForeground","Foreground color of editor widgets, such as find/replace.")),d5=D("editorWidget.border",{dark:"#454545",light:"#C8C8C8",hcDark:rt,hcLight:rt},p("editorWidgetBorder","Border color of editor widgets. The color is only used if the widget chooses to have a border and if the color is not overridden by a widget."));D("editorWidget.resizeBorder",null,p("editorWidgetResizeBorder","Border color of the resize bar of editor widgets. The color is only used if the widget chooses to have a resize border and if the color is not overridden by a widget."));D("editorError.background",null,p("editorError.background","Background color of error text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const ET=D("editorError.foreground",{dark:"#F14C4C",light:"#E51400",hcDark:"#F48771",hcLight:"#B5200D"},p("editorError.foreground","Foreground color of error squigglies in the editor.")),Kne=D("editorError.border",{dark:null,light:null,hcDark:j.fromHex("#E47777").transparent(.8),hcLight:"#B5200D"},p("errorBorder","If set, color of double underlines for errors in the editor.")),jne=D("editorWarning.background",null,p("editorWarning.background","Background color of warning text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0),qc=D("editorWarning.foreground",{dark:"#CCA700",light:"#BF8803",hcDark:"#FFD370",hcLight:"#895503"},p("editorWarning.foreground","Foreground color of warning squigglies in the editor.")),oy=D("editorWarning.border",{dark:null,light:null,hcDark:j.fromHex("#FFCC00").transparent(.8),hcLight:j.fromHex("#FFCC00").transparent(.8)},p("warningBorder","If set, color of double underlines for warnings in the editor."));D("editorInfo.background",null,p("editorInfo.background","Background color of info text in the editor. The color must not be opaque so as not to hide underlying decorations."),!0);const Nl=D("editorInfo.foreground",{dark:"#3794FF",light:"#1a85ff",hcDark:"#3794FF",hcLight:"#1a85ff"},p("editorInfo.foreground","Foreground color of info squigglies in the editor.")),ry=D("editorInfo.border",{dark:null,light:null,hcDark:j.fromHex("#3794FF").transparent(.8),hcLight:"#292929"},p("infoBorder","If set, color of double underlines for infos in the editor.")),qne=D("editorHint.foreground",{dark:j.fromHex("#eeeeee").transparent(.7),light:"#6c6c6c",hcDark:null,hcLight:null},p("editorHint.foreground","Foreground color of hint squigglies in the editor."));D("editorHint.border",{dark:null,light:null,hcDark:j.fromHex("#eeeeee").transparent(.8),hcLight:"#292929"},p("hintBorder","If set, color of double underlines for hints in the editor."));const Zne=D("editorLink.activeForeground",{dark:"#4E94CE",light:j.blue,hcDark:j.cyan,hcLight:"#292929"},p("activeLinkForeground","Color of active links.")),zd=D("editor.selectionBackground",{light:"#ADD6FF",dark:"#264F78",hcDark:"#f3f518",hcLight:"#0F4A85"},p("editorSelectionBackground","Color of the editor selection.")),Yne=D("editor.selectionForeground",{light:null,dark:null,hcDark:"#000000",hcLight:j.white},p("editorSelectionForeground","Color of the selected text for high contrast.")),oG=D("editor.inactiveSelectionBackground",{light:Ue(zd,.5),dark:Ue(zd,.5),hcDark:Ue(zd,.7),hcLight:Ue(zd,.5)},p("editorInactiveSelection","Color of the selection in an inactive editor. The color must not be opaque so as not to hide underlying decorations."),!0),h5=D("editor.selectionHighlightBackground",{light:QV(zd,$r,.3,.6),dark:QV(zd,$r,.3,.6),hcDark:null,hcLight:null},p("editorSelectionHighlight","Color for regions with the same content as the selection. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.selectionHighlightBorder",{light:null,dark:null,hcDark:qt,hcLight:qt},p("editorSelectionHighlightBorder","Border color for regions with the same content as the selection."));D("editor.findMatchBackground",{light:"#A8AC94",dark:"#515C6A",hcDark:null,hcLight:null},p("editorFindMatch","Color of the current search match."));const Xne=D("editor.findMatchForeground",null,p("editorFindMatchForeground","Text color of the current search match.")),Ec=D("editor.findMatchHighlightBackground",{light:"#EA5C0055",dark:"#EA5C0055",hcDark:null,hcLight:null},p("findMatchHighlight","Color of the other search matches. The color must not be opaque so as not to hide underlying decorations."),!0),Qne=D("editor.findMatchHighlightForeground",null,p("findMatchHighlightForeground","Foreground color of the other search matches."),!0);D("editor.findRangeHighlightBackground",{dark:"#3a3d4166",light:"#b4b4b44d",hcDark:null,hcLight:null},p("findRangeHighlight","Color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.findMatchBorder",{light:null,dark:null,hcDark:qt,hcLight:qt},p("editorFindMatchBorder","Border color of the current search match."));const Ud=D("editor.findMatchHighlightBorder",{light:null,dark:null,hcDark:qt,hcLight:qt},p("findMatchHighlightBorder","Border color of the other search matches.")),Jne=D("editor.findRangeHighlightBorder",{dark:null,light:null,hcDark:Ue(qt,.4),hcLight:Ue(qt,.4)},p("findRangeHighlightBorder","Border color of the range limiting the search. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.hoverHighlightBackground",{light:"#ADD6FF26",dark:"#264f7840",hcDark:"#ADD6FF26",hcLight:null},p("hoverHighlight","Highlight below the word for which a hover is shown. The color must not be opaque so as not to hide underlying decorations."),!0);const X0=D("editorHoverWidget.background",Ro,p("hoverBackground","Background color of the editor hover."));D("editorHoverWidget.foreground",kT,p("hoverForeground","Foreground color of the editor hover."));const rG=D("editorHoverWidget.border",d5,p("hoverBorder","Border color of the editor hover."));D("editorHoverWidget.statusBarBackground",{dark:La(X0,.2),light:jf(X0,.05),hcDark:Ro,hcLight:Ro},p("statusBarBackground","Background color of the editor hover status bar."));const u5=D("editorInlayHint.foreground",{dark:"#969696",light:"#969696",hcDark:j.white,hcLight:j.black},p("editorInlayHintForeground","Foreground color of inline hints")),g5=D("editorInlayHint.background",{dark:Ue(B1,.1),light:Ue(B1,.1),hcDark:Ue(j.white,.1),hcLight:Ue(B1,.1)},p("editorInlayHintBackground","Background color of inline hints")),ese=D("editorInlayHint.typeForeground",u5,p("editorInlayHintForegroundTypes","Foreground color of inline hints for types")),tse=D("editorInlayHint.typeBackground",g5,p("editorInlayHintBackgroundTypes","Background color of inline hints for types")),ise=D("editorInlayHint.parameterForeground",u5,p("editorInlayHintForegroundParameter","Foreground color of inline hints for parameters")),nse=D("editorInlayHint.parameterBackground",g5,p("editorInlayHintBackgroundParameter","Background color of inline hints for parameters")),sse=D("editorLightBulb.foreground",{dark:"#FFCC00",light:"#DDB100",hcDark:"#FFCC00",hcLight:"#007ACC"},p("editorLightBulbForeground","The color used for the lightbulb actions icon."));D("editorLightBulbAutoFix.foreground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("editorLightBulbAutoFixForeground","The color used for the lightbulb auto fix actions icon."));D("editorLightBulbAi.foreground",sse,p("editorLightBulbAiForeground","The color used for the lightbulb AI icon."));D("editor.snippetTabstopHighlightBackground",{dark:new j(new lt(124,124,124,.3)),light:new j(new lt(10,50,100,.2)),hcDark:new j(new lt(124,124,124,.3)),hcLight:new j(new lt(10,50,100,.2))},p("snippetTabstopHighlightBackground","Highlight background color of a snippet tabstop."));D("editor.snippetTabstopHighlightBorder",null,p("snippetTabstopHighlightBorder","Highlight border color of a snippet tabstop."));D("editor.snippetFinalTabstopHighlightBackground",null,p("snippetFinalTabstopHighlightBackground","Highlight background color of the final tabstop of a snippet."));D("editor.snippetFinalTabstopHighlightBorder",{dark:"#525252",light:new j(new lt(10,50,100,.5)),hcDark:"#525252",hcLight:"#292929"},p("snippetFinalTabstopHighlightBorder","Highlight border color of the final tabstop of a snippet."));const zP=new j(new lt(155,185,85,.2)),UP=new j(new lt(255,0,0,.2)),ose=D("diffEditor.insertedTextBackground",{dark:"#9ccc2c33",light:"#9ccc2c40",hcDark:null,hcLight:null},p("diffEditorInserted","Background color for text that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0),rse=D("diffEditor.removedTextBackground",{dark:"#ff000033",light:"#ff000033",hcDark:null,hcLight:null},p("diffEditorRemoved","Background color for text that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);D("diffEditor.insertedLineBackground",{dark:zP,light:zP,hcDark:null,hcLight:null},p("diffEditorInsertedLines","Background color for lines that got inserted. The color must not be opaque so as not to hide underlying decorations."),!0);D("diffEditor.removedLineBackground",{dark:UP,light:UP,hcDark:null,hcLight:null},p("diffEditorRemovedLines","Background color for lines that got removed. The color must not be opaque so as not to hide underlying decorations."),!0);D("diffEditorGutter.insertedLineBackground",null,p("diffEditorInsertedLineGutter","Background color for the margin where lines got inserted."));D("diffEditorGutter.removedLineBackground",null,p("diffEditorRemovedLineGutter","Background color for the margin where lines got removed."));const ase=D("diffEditorOverview.insertedForeground",null,p("diffEditorOverviewInserted","Diff overview ruler foreground for inserted content.")),lse=D("diffEditorOverview.removedForeground",null,p("diffEditorOverviewRemoved","Diff overview ruler foreground for removed content."));D("diffEditor.insertedTextBorder",{dark:null,light:null,hcDark:"#33ff2eff",hcLight:"#374E06"},p("diffEditorInsertedOutline","Outline color for the text that got inserted."));D("diffEditor.removedTextBorder",{dark:null,light:null,hcDark:"#FF008F",hcLight:"#AD0707"},p("diffEditorRemovedOutline","Outline color for text that got removed."));D("diffEditor.border",{dark:null,light:null,hcDark:rt,hcLight:rt},p("diffEditorBorder","Border color between the two text editors."));D("diffEditor.diagonalFill",{dark:"#cccccc33",light:"#22222233",hcDark:null,hcLight:null},p("diffDiagonalFill","Color of the diff editor's diagonal fill. The diagonal fill is used in side-by-side diff views."));D("diffEditor.unchangedRegionBackground","sideBar.background",p("diffEditor.unchangedRegionBackground","The background color of unchanged blocks in the diff editor."));D("diffEditor.unchangedRegionForeground","foreground",p("diffEditor.unchangedRegionForeground","The foreground color of unchanged blocks in the diff editor."));D("diffEditor.unchangedCodeBackground",{dark:"#74747429",light:"#b8b8b829",hcDark:null,hcLight:null},p("diffEditor.unchangedCodeBackground","The background color of unchanged code in the diff editor."));const lb=D("widget.shadow",{dark:Ue(j.black,.36),light:Ue(j.black,.16),hcDark:null,hcLight:null},p("widgetShadow","Shadow color of widgets such as find/replace inside the editor.")),aG=D("widget.border",{dark:null,light:null,hcDark:rt,hcLight:rt},p("widgetBorder","Border color of widgets such as find/replace inside the editor.")),eH=D("toolbar.hoverBackground",{dark:"#5a5d5e50",light:"#b8b8b850",hcDark:null,hcLight:null},p("toolbarHoverBackground","Toolbar background when hovering over actions using the mouse"));D("toolbar.hoverOutline",{dark:null,light:null,hcDark:qt,hcLight:qt},p("toolbarHoverOutline","Toolbar outline when hovering over actions using the mouse"));D("toolbar.activeBackground",{dark:La(eH,.1),light:jf(eH,.1),hcDark:null,hcLight:null},p("toolbarActiveBackground","Toolbar background when holding the mouse over actions"));const cse=D("breadcrumb.foreground",Ue(qe,.8),p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),dse=D("breadcrumb.background",$r,p("breadcrumbsBackground","Background color of breadcrumb items.")),tH=D("breadcrumb.focusForeground",{light:jf(qe,.2),dark:La(qe,.1),hcDark:La(qe,.1),hcLight:La(qe,.1)},p("breadcrumbsFocusForeground","Color of focused breadcrumb items.")),hse=D("breadcrumb.activeSelectionForeground",{light:jf(qe,.2),dark:La(qe,.1),hcDark:La(qe,.1),hcLight:La(qe,.1)},p("breadcrumbsSelectedForeground","Color of selected breadcrumb items."));D("breadcrumbPicker.background",Ro,p("breadcrumbsSelectedBackground","Background color of breadcrumb item picker."));const lG=.5,iH=j.fromHex("#40C8AE").transparent(lG),nH=j.fromHex("#40A6FF").transparent(lG),sH=j.fromHex("#606060").transparent(.4),f5=.4,C_=1,GP=D("merge.currentHeaderBackground",{dark:iH,light:iH,hcDark:null,hcLight:null},p("mergeCurrentHeaderBackground","Current header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);D("merge.currentContentBackground",Ue(GP,f5),p("mergeCurrentContentBackground","Current content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const $P=D("merge.incomingHeaderBackground",{dark:nH,light:nH,hcDark:null,hcLight:null},p("mergeIncomingHeaderBackground","Incoming header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);D("merge.incomingContentBackground",Ue($P,f5),p("mergeIncomingContentBackground","Incoming content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const KP=D("merge.commonHeaderBackground",{dark:sH,light:sH,hcDark:null,hcLight:null},p("mergeCommonHeaderBackground","Common ancestor header background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);D("merge.commonContentBackground",Ue(KP,f5),p("mergeCommonContentBackground","Common ancestor content background in inline merge-conflicts. The color must not be opaque so as not to hide underlying decorations."),!0);const y_=D("merge.border",{dark:null,light:null,hcDark:"#C3DF6F",hcLight:"#007ACC"},p("mergeBorder","Border color on headers and the splitter in inline merge-conflicts."));D("editorOverviewRuler.currentContentForeground",{dark:Ue(GP,C_),light:Ue(GP,C_),hcDark:y_,hcLight:y_},p("overviewRulerCurrentContentForeground","Current overview ruler foreground for inline merge-conflicts."));D("editorOverviewRuler.incomingContentForeground",{dark:Ue($P,C_),light:Ue($P,C_),hcDark:y_,hcLight:y_},p("overviewRulerIncomingContentForeground","Incoming overview ruler foreground for inline merge-conflicts."));D("editorOverviewRuler.commonContentForeground",{dark:Ue(KP,C_),light:Ue(KP,C_),hcDark:y_,hcLight:y_},p("overviewRulerCommonContentForeground","Common ancestor overview ruler foreground for inline merge-conflicts."));const CI=D("editorOverviewRuler.findMatchForeground",{dark:"#d186167e",light:"#d186167e",hcDark:"#AB5A00",hcLight:"#AB5A00"},p("overviewRulerFindMatchForeground","Overview ruler marker color for find matches. The color must not be opaque so as not to hide underlying decorations."),!0),cG=D("editorOverviewRuler.selectionHighlightForeground","#A0A0A0CC",p("overviewRulerSelectionHighlightForeground","Overview ruler marker color for selection highlights. The color must not be opaque so as not to hide underlying decorations."),!0),use=D("problemsErrorIcon.foreground",ET,p("problemsErrorIconForeground","The color used for the problems error icon.")),gse=D("problemsWarningIcon.foreground",qc,p("problemsWarningIconForeground","The color used for the problems warning icon.")),fse=D("problemsInfoIcon.foreground",Nl,p("problemsInfoIconForeground","The color used for the problems info icon.")),jP=D("minimap.findMatchHighlight",{light:"#d18616",dark:"#d18616",hcDark:"#AB5A00",hcLight:"#0F4A85"},p("minimapFindMatchHighlight","Minimap marker color for find matches."),!0),TT=D("minimap.selectionOccurrenceHighlight",{light:"#c9c9c9",dark:"#676767",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionOccurrenceHighlight","Minimap marker color for repeating editor selections."),!0),oH=D("minimap.selectionHighlight",{light:"#ADD6FF",dark:"#264F78",hcDark:"#ffffff",hcLight:"#0F4A85"},p("minimapSelectionHighlight","Minimap marker color for the editor selection."),!0),pse=D("minimap.infoHighlight",{dark:Nl,light:Nl,hcDark:ry,hcLight:ry},p("minimapInfo","Minimap marker color for infos.")),mse=D("minimap.warningHighlight",{dark:qc,light:qc,hcDark:oy,hcLight:oy},p("overviewRuleWarning","Minimap marker color for warnings.")),_se=D("minimap.errorHighlight",{dark:new j(new lt(255,18,18,.7)),light:new j(new lt(255,18,18,.7)),hcDark:new j(new lt(255,50,50,1)),hcLight:"#B5200D"},p("minimapError","Minimap marker color for errors.")),bse=D("minimap.background",null,p("minimapBackground","Minimap background color.")),vse=D("minimap.foregroundOpacity",j.fromHex("#000f"),p("minimapForegroundOpacity",'Opacity of foreground elements rendered in the minimap. For example, "#000000c0" will render the elements with 75% opacity.'));D("minimapSlider.background",Ue(iG,.5),p("minimapSliderBackground","Minimap slider background color."));D("minimapSlider.hoverBackground",Ue(nG,.5),p("minimapSliderHoverBackground","Minimap slider background color when hovering."));D("minimapSlider.activeBackground",Ue(sG,.5),p("minimapSliderActiveBackground","Minimap slider background color when clicked on."));D("charts.foreground",qe,p("chartsForeground","The foreground color used in charts."));D("charts.lines",Ue(qe,.5),p("chartsLines","The color used for horizontal lines in charts."));D("charts.red",ET,p("chartsRed","The red color used in chart visualizations."));D("charts.blue",Nl,p("chartsBlue","The blue color used in chart visualizations."));D("charts.yellow",qc,p("chartsYellow","The yellow color used in chart visualizations."));D("charts.orange",jP,p("chartsOrange","The orange color used in chart visualizations."));D("charts.green",{dark:"#89D185",light:"#388A34",hcDark:"#89D185",hcLight:"#374e06"},p("chartsGreen","The green color used in chart visualizations."));D("charts.purple",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("chartsPurple","The purple color used in chart visualizations."));const qP=D("input.background",{dark:"#3C3C3C",light:j.white,hcDark:j.black,hcLight:j.white},p("inputBoxBackground","Input box background.")),dG=D("input.foreground",qe,p("inputBoxForeground","Input box foreground.")),hG=D("input.border",{dark:null,light:null,hcDark:rt,hcLight:rt},p("inputBoxBorder","Input box border.")),DT=D("inputOption.activeBorder",{dark:"#007ACC",light:"#007ACC",hcDark:rt,hcLight:rt},p("inputBoxActiveOptionBorder","Border color of activated options in input fields.")),Cse=D("inputOption.hoverBackground",{dark:"#5a5d5e80",light:"#b8b8b850",hcDark:null,hcLight:null},p("inputOption.hoverBackground","Background color of activated options in input fields.")),Dw=D("inputOption.activeBackground",{dark:Ue(Il,.4),light:Ue(Il,.2),hcDark:j.transparent,hcLight:j.transparent},p("inputOption.activeBackground","Background hover color of options in input fields.")),IT=D("inputOption.activeForeground",{dark:j.white,light:j.black,hcDark:qe,hcLight:qe},p("inputOption.activeForeground","Foreground color of activated options in input fields."));D("input.placeholderForeground",{light:Ue(qe,.5),dark:Ue(qe,.5),hcDark:Ue(qe,.7),hcLight:Ue(qe,.7)},p("inputPlaceholderForeground","Input box foreground color for placeholder text."));const yse=D("inputValidation.infoBackground",{dark:"#063B49",light:"#D6ECF2",hcDark:j.black,hcLight:j.white},p("inputValidationInfoBackground","Input validation background color for information severity.")),wse=D("inputValidation.infoForeground",{dark:null,light:null,hcDark:null,hcLight:qe},p("inputValidationInfoForeground","Input validation foreground color for information severity.")),Sse=D("inputValidation.infoBorder",{dark:"#007acc",light:"#007acc",hcDark:rt,hcLight:rt},p("inputValidationInfoBorder","Input validation border color for information severity.")),xse=D("inputValidation.warningBackground",{dark:"#352A05",light:"#F6F5D2",hcDark:j.black,hcLight:j.white},p("inputValidationWarningBackground","Input validation background color for warning severity.")),Lse=D("inputValidation.warningForeground",{dark:null,light:null,hcDark:null,hcLight:qe},p("inputValidationWarningForeground","Input validation foreground color for warning severity.")),kse=D("inputValidation.warningBorder",{dark:"#B89500",light:"#B89500",hcDark:rt,hcLight:rt},p("inputValidationWarningBorder","Input validation border color for warning severity.")),Ese=D("inputValidation.errorBackground",{dark:"#5A1D1D",light:"#F2DEDE",hcDark:j.black,hcLight:j.white},p("inputValidationErrorBackground","Input validation background color for error severity.")),Tse=D("inputValidation.errorForeground",{dark:null,light:null,hcDark:null,hcLight:qe},p("inputValidationErrorForeground","Input validation foreground color for error severity.")),Dse=D("inputValidation.errorBorder",{dark:"#BE1100",light:"#BE1100",hcDark:rt,hcLight:rt},p("inputValidationErrorBorder","Input validation border color for error severity.")),NT=D("dropdown.background",{dark:"#3C3C3C",light:j.white,hcDark:j.black,hcLight:j.white},p("dropdownBackground","Dropdown background.")),Ise=D("dropdown.listBackground",{dark:null,light:null,hcDark:j.black,hcLight:j.white},p("dropdownListBackground","Dropdown list background.")),p5=D("dropdown.foreground",{dark:"#F0F0F0",light:qe,hcDark:j.white,hcLight:qe},p("dropdownForeground","Dropdown foreground.")),m5=D("dropdown.border",{dark:NT,light:"#CECECE",hcDark:rt,hcLight:rt},p("dropdownBorder","Dropdown border.")),uG=D("button.foreground",j.white,p("buttonForeground","Button foreground color.")),Nse=D("button.separator",Ue(uG,.4),p("buttonSeparator","Button separator color.")),uv=D("button.background",{dark:"#0E639C",light:"#007ACC",hcDark:null,hcLight:"#0F4A85"},p("buttonBackground","Button background color.")),Rse=D("button.hoverBackground",{dark:La(uv,.2),light:jf(uv,.2),hcDark:uv,hcLight:uv},p("buttonHoverBackground","Button background color when hovering.")),Pse=D("button.border",rt,p("buttonBorder","Button border color.")),Ase=D("button.secondaryForeground",{dark:j.white,light:j.white,hcDark:j.white,hcLight:qe},p("buttonSecondaryForeground","Secondary button foreground color.")),ZP=D("button.secondaryBackground",{dark:"#3A3D41",light:"#5F6A79",hcDark:null,hcLight:j.white},p("buttonSecondaryBackground","Secondary button background color.")),Mse=D("button.secondaryHoverBackground",{dark:La(ZP,.2),light:jf(ZP,.2),hcDark:null,hcLight:null},p("buttonSecondaryHoverBackground","Secondary button background color when hovering.")),gv=D("radio.activeForeground",IT,p("radioActiveForeground","Foreground color of active radio option.")),Ose=D("radio.activeBackground",Dw,p("radioBackground","Background color of active radio option.")),Fse=D("radio.activeBorder",DT,p("radioActiveBorder","Border color of the active radio option.")),Bse=D("radio.inactiveForeground",null,p("radioInactiveForeground","Foreground color of inactive radio option.")),Wse=D("radio.inactiveBackground",null,p("radioInactiveBackground","Background color of inactive radio option.")),Vse=D("radio.inactiveBorder",{light:Ue(gv,.2),dark:Ue(gv,.2),hcDark:Ue(gv,.4),hcLight:Ue(gv,.2)},p("radioInactiveBorder","Border color of the inactive radio option.")),Hse=D("radio.inactiveHoverBackground",Cse,p("radioHoverBackground","Background color of inactive active radio option when hovering.")),zse=D("checkbox.background",NT,p("checkbox.background","Background color of checkbox widget."));D("checkbox.selectBackground",Ro,p("checkbox.select.background","Background color of checkbox widget when the element it's in is selected."));const Use=D("checkbox.foreground",p5,p("checkbox.foreground","Foreground color of checkbox widget.")),Gse=D("checkbox.border",m5,p("checkbox.border","Border color of checkbox widget."));D("checkbox.selectBorder",Y0,p("checkbox.select.border","Border color of checkbox widget when the element it's in is selected."));const $se=D("keybindingLabel.background",{dark:new j(new lt(128,128,128,.17)),light:new j(new lt(221,221,221,.4)),hcDark:j.transparent,hcLight:j.transparent},p("keybindingLabelBackground","Keybinding label background color. The keybinding label is used to represent a keyboard shortcut.")),Kse=D("keybindingLabel.foreground",{dark:j.fromHex("#CCCCCC"),light:j.fromHex("#555555"),hcDark:j.white,hcLight:qe},p("keybindingLabelForeground","Keybinding label foreground color. The keybinding label is used to represent a keyboard shortcut.")),jse=D("keybindingLabel.border",{dark:new j(new lt(51,51,51,.6)),light:new j(new lt(204,204,204,.4)),hcDark:new j(new lt(111,195,223)),hcLight:rt},p("keybindingLabelBorder","Keybinding label border color. The keybinding label is used to represent a keyboard shortcut.")),qse=D("keybindingLabel.bottomBorder",{dark:new j(new lt(68,68,68,.6)),light:new j(new lt(187,187,187,.4)),hcDark:new j(new lt(111,195,223)),hcLight:qe},p("keybindingLabelBottomBorder","Keybinding label border bottom color. The keybinding label is used to represent a keyboard shortcut.")),Zse=D("list.focusBackground",null,p("listFocusBackground","List/Tree background color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Yse=D("list.focusForeground",null,p("listFocusForeground","List/Tree foreground color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Xse=D("list.focusOutline",{dark:Il,light:Il,hcDark:qt,hcLight:qt},p("listFocusOutline","List/Tree outline color for the focused item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Qse=D("list.focusAndSelectionOutline",null,p("listFocusAndSelectionOutline","List/Tree outline color for the focused item when the list/tree is active and selected. An active list/tree has keyboard focus, an inactive does not.")),wf=D("list.activeSelectionBackground",{dark:"#04395E",light:"#0060C0",hcDark:null,hcLight:j.fromHex("#0F4A85").transparent(.1)},p("listActiveSelectionBackground","List/Tree background color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),ay=D("list.activeSelectionForeground",{dark:j.white,light:j.white,hcDark:null,hcLight:null},p("listActiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),gG=D("list.activeSelectionIconForeground",null,p("listActiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is active. An active list/tree has keyboard focus, an inactive does not.")),Jse=D("list.inactiveSelectionBackground",{dark:"#37373D",light:"#E4E6F1",hcDark:null,hcLight:j.fromHex("#0F4A85").transparent(.1)},p("listInactiveSelectionBackground","List/Tree background color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),eoe=D("list.inactiveSelectionForeground",null,p("listInactiveSelectionForeground","List/Tree foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),toe=D("list.inactiveSelectionIconForeground",null,p("listInactiveSelectionIconForeground","List/Tree icon foreground color for the selected item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),ioe=D("list.inactiveFocusBackground",null,p("listInactiveFocusBackground","List/Tree background color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),noe=D("list.inactiveFocusOutline",null,p("listInactiveFocusOutline","List/Tree outline color for the focused item when the list/tree is inactive. An active list/tree has keyboard focus, an inactive does not.")),fG=D("list.hoverBackground",{dark:"#2A2D2E",light:"#F0F0F0",hcDark:j.white.transparent(.1),hcLight:j.fromHex("#0F4A85").transparent(.1)},p("listHoverBackground","List/Tree background when hovering over items using the mouse.")),pG=D("list.hoverForeground",null,p("listHoverForeground","List/Tree foreground when hovering over items using the mouse.")),soe=D("list.dropBackground",{dark:"#062F4A",light:"#D6EBFF",hcDark:null,hcLight:null},p("listDropBackground","List/Tree drag and drop background when moving items over other items when using the mouse.")),ooe=D("list.dropBetweenBackground",{dark:Y0,light:Y0,hcDark:null,hcLight:null},p("listDropBetweenBackground","List/Tree drag and drop border color when moving items between items when using the mouse.")),qp=D("list.highlightForeground",{dark:"#2AAAFF",light:"#0066BF",hcDark:Il,hcLight:Il},p("highlight","List/Tree foreground color of the match highlights when searching inside the list/tree.")),roe=D("list.focusHighlightForeground",{dark:qp,light:zne(wf,qp,"#BBE7FF"),hcDark:qp,hcLight:qp},p("listFocusHighlightForeground","List/Tree foreground color of the match highlights on actively focused items when searching inside the list/tree."));D("list.invalidItemForeground",{dark:"#B89500",light:"#B89500",hcDark:"#B89500",hcLight:"#B5200D"},p("invalidItemForeground","List/Tree foreground color for invalid items, for example an unresolved root in explorer."));D("list.errorForeground",{dark:"#F88070",light:"#B01011",hcDark:null,hcLight:null},p("listErrorForeground","Foreground color of list items containing errors."));D("list.warningForeground",{dark:"#CCA700",light:"#855F00",hcDark:null,hcLight:null},p("listWarningForeground","Foreground color of list items containing warnings."));const aoe=D("listFilterWidget.background",{light:jf(Ro,0),dark:La(Ro,0),hcDark:Ro,hcLight:Ro},p("listFilterWidgetBackground","Background color of the type filter widget in lists and trees.")),loe=D("listFilterWidget.outline",{dark:j.transparent,light:j.transparent,hcDark:"#f38518",hcLight:"#007ACC"},p("listFilterWidgetOutline","Outline color of the type filter widget in lists and trees.")),coe=D("listFilterWidget.noMatchesOutline",{dark:"#BE1100",light:"#BE1100",hcDark:rt,hcLight:rt},p("listFilterWidgetNoMatchesOutline","Outline color of the type filter widget in lists and trees, when there are no matches.")),doe=D("listFilterWidget.shadow",lb,p("listFilterWidgetShadow","Shadow color of the type filter widget in lists and trees."));D("list.filterMatchBackground",{dark:Ec,light:Ec,hcDark:null,hcLight:null},p("listFilterMatchHighlight","Background color of the filtered match."));D("list.filterMatchBorder",{dark:Ud,light:Ud,hcDark:rt,hcLight:qt},p("listFilterMatchHighlightBorder","Border color of the filtered match."));D("list.deemphasizedForeground",{dark:"#8C8C8C",light:"#8E8E90",hcDark:"#A7A8A9",hcLight:"#666666"},p("listDeemphasizedForeground","List/Tree foreground color for items that are deemphasized."));const mG=D("tree.indentGuidesStroke",{dark:"#585858",light:"#a9a9a9",hcDark:"#a9a9a9",hcLight:"#a5a5a5"},p("treeIndentGuidesStroke","Tree stroke color for the indentation guides.")),hoe=D("tree.inactiveIndentGuidesStroke",Ue(mG,.4),p("treeInactiveIndentGuidesStroke","Tree stroke color for the indentation guides that are not active.")),uoe=D("tree.tableColumnsBorder",{dark:"#CCCCCC20",light:"#61616120",hcDark:null,hcLight:null},p("tableColumnsBorder","Table border color between columns.")),goe=D("tree.tableOddRowsBackground",{dark:Ue(qe,.04),light:Ue(qe,.04),hcDark:null,hcLight:null},p("tableOddRowsBackgroundColor","Background color for odd table rows."));D("editorActionList.background",Ro,p("editorActionListBackground","Action List background color."));D("editorActionList.foreground",kT,p("editorActionListForeground","Action List foreground color."));D("editorActionList.focusForeground",ay,p("editorActionListFocusForeground","Action List foreground color for the focused item."));D("editorActionList.focusBackground",wf,p("editorActionListFocusBackground","Action List background color for the focused item."));const foe=D("menu.border",{dark:null,light:null,hcDark:rt,hcLight:rt},p("menuBorder","Border color of menus.")),poe=D("menu.foreground",p5,p("menuForeground","Foreground color of menu items.")),moe=D("menu.background",NT,p("menuBackground","Background color of menu items.")),_oe=D("menu.selectionForeground",ay,p("menuSelectionForeground","Foreground color of the selected menu item in menus.")),boe=D("menu.selectionBackground",wf,p("menuSelectionBackground","Background color of the selected menu item in menus.")),voe=D("menu.selectionBorder",{dark:null,light:null,hcDark:qt,hcLight:qt},p("menuSelectionBorder","Border color of the selected menu item in menus.")),Coe=D("menu.separatorBackground",{dark:"#606060",light:"#D4D4D4",hcDark:rt,hcLight:rt},p("menuSeparatorBackground","Color of a separator menu item in menus.")),rH=D("quickInput.background",Ro,p("pickerBackground","Quick picker background color. The quick picker widget is the container for pickers like the command palette.")),yoe=D("quickInput.foreground",kT,p("pickerForeground","Quick picker foreground color. The quick picker widget is the container for pickers like the command palette.")),woe=D("quickInputTitle.background",{dark:new j(new lt(255,255,255,.105)),light:new j(new lt(0,0,0,.06)),hcDark:"#000000",hcLight:j.white},p("pickerTitleBackground","Quick picker title background color. The quick picker widget is the container for pickers like the command palette.")),_G=D("pickerGroup.foreground",{dark:"#3794FF",light:"#0066BF",hcDark:j.white,hcLight:"#0F4A85"},p("pickerGroupForeground","Quick picker color for grouping labels.")),Soe=D("pickerGroup.border",{dark:"#3F3F46",light:"#CCCEDB",hcDark:j.white,hcLight:"#0F4A85"},p("pickerGroupBorder","Quick picker color for grouping borders.")),aH=D("quickInput.list.focusBackground",null,"",void 0,p("quickInput.list.focusBackground deprecation","Please use quickInputList.focusBackground instead")),ly=D("quickInputList.focusForeground",ay,p("quickInput.listFocusForeground","Quick picker foreground color for the focused item.")),_5=D("quickInputList.focusIconForeground",gG,p("quickInput.listFocusIconForeground","Quick picker icon foreground color for the focused item.")),cy=D("quickInputList.focusBackground",{dark:sy(aH,wf),light:sy(aH,wf),hcDark:null,hcLight:null},p("quickInput.listFocusBackground","Quick picker background color for the focused item."));D("search.resultsInfoForeground",{light:qe,dark:Ue(qe,.65),hcDark:qe,hcLight:qe},p("search.resultsInfoForeground","Color of the text in the search viewlet's completion message."));D("searchEditor.findMatchBackground",{light:Ue(Ec,.66),dark:Ue(Ec,.66),hcDark:Ec,hcLight:Ec},p("searchEditor.queryMatch","Color of the Search Editor query matches."));D("searchEditor.findMatchBorder",{light:Ue(Ud,.66),dark:Ue(Ud,.66),hcDark:Ud,hcLight:Ud},p("searchEditor.editorFindMatchBorder","Border color of the Search Editor query matches."));var xoe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},lH=function(o,e){return function(t,i){e(t,i,o)}};const zl=Je("hoverService");let w_=class extends F{get delay(){return this.isInstantlyHovering()?0:this._delay}constructor(e,t,i={},n,s){super(),this.placement=e,this.instantHover=t,this.overrideOptions=i,this.configurationService=n,this.hoverService=s,this.lastHoverHideTime=0,this.timeLimit=200,this.hoverDisposables=this._register(new $),this._delay=this.configurationService.getValue("workbench.hover.delay"),this._register(this.configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("workbench.hover.delay")&&(this._delay=this.configurationService.getValue("workbench.hover.delay"))}))}showHover(e,t){const i=typeof this.overrideOptions=="function"?this.overrideOptions(e,t):this.overrideOptions;this.hoverDisposables.clear();const n=qi(e.target)?[e.target]:e.target.targetElements;for(const r of n)this.hoverDisposables.add(ci(r,"keydown",a=>{a.equals(9)&&this.hoverService.hideHover()}));const s=qi(e.content)?void 0:e.content.toString();return this.hoverService.showHover({...e,...i,persistence:{hideOnKeyDown:!0,...i.persistence},id:s,appearance:{...e.appearance,compact:!0,skipFadeInAnimation:this.isInstantlyHovering(),...i.appearance}},t)}isInstantlyHovering(){return this.instantHover&&Date.now()-this.lastHoverHideTime<this.timeLimit}onDidHideHover(){this.hoverDisposables.clear(),this.instantHover&&(this.lastHoverHideTime=Date.now())}};w_=xoe([lH(3,Ke),lH(4,zl)],w_);const sd=Je("contextViewService"),co=Je("contextMenuService"),vt=Je("keybindingService");class cb{constructor(){this._hooks=new $,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;const i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,n,s){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=n,this._onStopCallback=s;let r=e;try{e.setPointerCapture(t),this._hooks.add(ve(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{r=xe(e)}this._hooks.add(H(r,ee.POINTER_MOVE,a=>{if(a.buttons!==i){this.stopMonitoring(!0);return}a.preventDefault(),this._pointerMoveCallback(a)})),this._hooks.add(H(r,ee.POINTER_UP,a=>this.stopMonitoring(!0)))}}function Ti(o,e,t){let i=null,n=null;if(typeof t.value=="function"?(i="value",n=t.value,n.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof t.get=="function"&&(i="get",n=t.get),!n)throw new Error("not supported");const s=`$memoize$${e}`;t[i]=function(...r){return this.hasOwnProperty(s)||Object.defineProperty(this,s,{configurable:!1,enumerable:!1,writable:!1,value:n.apply(this,r)}),this[s]}}var Loe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ot;(function(o){o.Tap="-monaco-gesturetap",o.Change="-monaco-gesturechange",o.Start="-monaco-gesturestart",o.End="-monaco-gesturesend",o.Contextmenu="-monaco-gesturecontextmenu"})(Ot||(Ot={}));const yn=class yn extends F{constructor(){super(),this.dispatched=!1,this.targets=new os,this.ignoreTargets=new os,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(se.runAndSubscribe(rT,({window:e,disposables:t})=>{t.add(H(e.document,"touchstart",i=>this.onTouchStart(i),{passive:!1})),t.add(H(e.document,"touchend",i=>this.onTouchEnd(e,i))),t.add(H(e.document,"touchmove",i=>this.onTouchMove(i),{passive:!1}))},{window:It,disposables:this._store}))}static addTarget(e){if(!yn.isTouchDevice())return F.None;yn.INSTANCE||(yn.INSTANCE=new yn);const t=yn.INSTANCE.targets.push(e);return ve(t)}static ignoreTarget(e){if(!yn.isTouchDevice())return F.None;yn.INSTANCE||(yn.INSTANCE=new yn);const t=yn.INSTANCE.ignoreTargets.push(e);return ve(t)}static isTouchDevice(){return"ontouchstart"in It||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(e){const t=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let i=0,n=e.targetTouches.length;i<n;i++){const s=e.targetTouches.item(i);this.activeTouches[s.identifier]={id:s.identifier,initialTarget:s.target,initialTimeStamp:t,initialPageX:s.pageX,initialPageY:s.pageY,rollingTimestamps:[t],rollingPageX:[s.pageX],rollingPageY:[s.pageY]};const r=this.newGestureEvent(Ot.Start,s.target);r.pageX=s.pageX,r.pageY=s.pageY,this.dispatchEvent(r)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}onTouchEnd(e,t){const i=Date.now(),n=Object.keys(this.activeTouches).length;for(let s=0,r=t.changedTouches.length;s<r;s++){const a=t.changedTouches.item(s);if(!this.activeTouches.hasOwnProperty(String(a.identifier))){console.warn("move of an UNKNOWN touch",a);continue}const l=this.activeTouches[a.identifier],c=Date.now()-l.initialTimeStamp;if(c<yn.HOLD_DELAY&&Math.abs(l.initialPageX-Zo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Zo(l.rollingPageY))<30){const d=this.newGestureEvent(Ot.Tap,l.initialTarget);d.pageX=Zo(l.rollingPageX),d.pageY=Zo(l.rollingPageY),this.dispatchEvent(d)}else if(c>=yn.HOLD_DELAY&&Math.abs(l.initialPageX-Zo(l.rollingPageX))<30&&Math.abs(l.initialPageY-Zo(l.rollingPageY))<30){const d=this.newGestureEvent(Ot.Contextmenu,l.initialTarget);d.pageX=Zo(l.rollingPageX),d.pageY=Zo(l.rollingPageY),this.dispatchEvent(d)}else if(n===1){const d=Zo(l.rollingPageX),h=Zo(l.rollingPageY),u=Zo(l.rollingTimestamps)-l.rollingTimestamps[0],g=d-l.rollingPageX[0],f=h-l.rollingPageY[0],m=[...this.targets].filter(_=>l.initialTarget instanceof Node&&_.contains(l.initialTarget));this.inertia(e,m,i,Math.abs(g)/u,g>0?1:-1,d,Math.abs(f)/u,f>0?1:-1,h)}this.dispatchEvent(this.newGestureEvent(Ot.End,l.initialTarget)),delete this.activeTouches[a.identifier]}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}newGestureEvent(e,t){const i=document.createEvent("CustomEvent");return i.initEvent(e,!1,!0),i.initialTarget=t,i.tapCount=0,i}dispatchEvent(e){if(e.type===Ot.Tap){const t=new Date().getTime();let i=0;t-this._lastSetTapCountTime>yn.CLEAR_TAP_COUNT_TIME?i=1:i=2,this._lastSetTapCountTime=t,e.tapCount=i}else(e.type===Ot.Change||e.type===Ot.Contextmenu)&&(this._lastSetTapCountTime=0);if(e.initialTarget instanceof Node){for(const i of this.ignoreTargets)if(i.contains(e.initialTarget))return;const t=[];for(const i of this.targets)if(i.contains(e.initialTarget)){let n=0,s=e.initialTarget;for(;s&&s!==i;)n++,s=s.parentElement;t.push([n,i])}t.sort((i,n)=>i[0]-n[0]);for(const[i,n]of t)n.dispatchEvent(e),this.dispatched=!0}}inertia(e,t,i,n,s,r,a,l,c){this.handle=ao(e,()=>{const d=Date.now(),h=d-i;let u=0,g=0,f=!0;n+=yn.SCROLL_FRICTION*h,a+=yn.SCROLL_FRICTION*h,n>0&&(f=!1,u=s*n*h),a>0&&(f=!1,g=l*a*h);const m=this.newGestureEvent(Ot.Change);m.translationX=u,m.translationY=g,t.forEach(_=>_.dispatchEvent(m)),f||this.inertia(e,t,d,n,s,r+u,a,l,c+g)})}onTouchMove(e){const t=Date.now();for(let i=0,n=e.changedTouches.length;i<n;i++){const s=e.changedTouches.item(i);if(!this.activeTouches.hasOwnProperty(String(s.identifier))){console.warn("end of an UNKNOWN touch",s);continue}const r=this.activeTouches[s.identifier],a=this.newGestureEvent(Ot.Change,r.initialTarget);a.translationX=s.pageX-Zo(r.rollingPageX),a.translationY=s.pageY-Zo(r.rollingPageY),a.pageX=s.pageX,a.pageY=s.pageY,this.dispatchEvent(a),r.rollingPageX.length>3&&(r.rollingPageX.shift(),r.rollingPageY.shift(),r.rollingTimestamps.shift()),r.rollingPageX.push(s.pageX),r.rollingPageY.push(s.pageY),r.rollingTimestamps.push(t)}this.dispatched&&(e.preventDefault(),e.stopPropagation(),this.dispatched=!1)}};yn.SCROLL_FRICTION=-.005,yn.HOLD_DELAY=700,yn.CLEAR_TAP_COUNT_TIME=400;let Mn=yn;Loe([Ti],Mn,"isTouchDevice",null);let Go=class extends F{onclick(e,t){this._register(H(e,ee.CLICK,i=>t(new Mr(xe(e),i))))}onmousedown(e,t){this._register(H(e,ee.MOUSE_DOWN,i=>t(new Mr(xe(e),i))))}onmouseover(e,t){this._register(H(e,ee.MOUSE_OVER,i=>t(new Mr(xe(e),i))))}onmouseleave(e,t){this._register(H(e,ee.MOUSE_LEAVE,i=>t(new Mr(xe(e),i))))}onkeydown(e,t){this._register(H(e,ee.KEY_DOWN,i=>t(new Pt(i))))}onkeyup(e,t){this._register(H(e,ee.KEY_UP,i=>t(new Pt(i))))}oninput(e,t){this._register(H(e,ee.INPUT,t))}onblur(e,t){this._register(H(e,ee.BLUR,t))}onfocus(e,t){this._register(H(e,ee.FOCUS,t))}ignoreGesture(e){return Mn.ignoreTarget(e)}};const S_=11;class koe extends Go{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.classList.add(...ke.asClassNameArray(e.icon)),this.domNode.style.position="absolute",this.domNode.style.width=S_+"px",this.domNode.style.height=S_+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new cb),this._register(ci(this.bgDomNode,ee.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(ci(this.domNode,ee.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new H4),this._pointerdownScheduleRepeatTimer=this._register(new qr)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,xe(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}}class Eoe extends F{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new qr)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){const e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}}const Toe=140;class bG extends Go{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new Eoe(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new cb),this._shouldRender=!0,this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(H(this.domNode.domNode,ee.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){const t=this._register(new koe(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,n){this.slider=bt(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof n=="number"&&this.slider.setHeight(n),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(H(this.slider.domNode,ee.POINTER_DOWN,s=>{s.button===0&&(s.preventDefault(),this._sliderPointerDown(s))})),this.onclick(this.slider.domNode,s=>{s.leftButton&&s.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){const t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),n=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),s=this._sliderPointerPosition(e);i<=s&&s<=n?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{const s=Ci(this.domNode.domNode);t=e.pageX-s.left,i=e.pageY-s.top}const n=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(n):this._scrollbarState.getDesiredScrollPositionFromOffset(n)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),n=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,s=>{const r=this._sliderOrthogonalPointerPosition(s),a=Math.abs(r-i);if(En&&a>Toe){this._setDesiredScrollPositionNow(n.getScrollPosition());return}const c=this._sliderPointerPosition(s)-t;this._setDesiredScrollPositionNow(n.getDesiredScrollPositionFromDelta(c))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){const t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}}const Doe=20;class x_{constructor(e,t,i,n,s,r){this._scrollbarSize=Math.round(t),this._oppositeScrollbarSize=Math.round(i),this._arrowSize=Math.round(e),this._visibleSize=n,this._scrollSize=s,this._scrollPosition=r,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new x_(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(e){const t=Math.round(e);return this._visibleSize!==t?(this._visibleSize=t,this._refreshComputedValues(),!0):!1}setScrollSize(e){const t=Math.round(e);return this._scrollSize!==t?(this._scrollSize=t,this._refreshComputedValues(),!0):!1}setScrollPosition(e){const t=Math.round(e);return this._scrollPosition!==t?(this._scrollPosition=t,this._refreshComputedValues(),!0):!1}setScrollbarSize(e){this._scrollbarSize=Math.round(e)}setOppositeScrollbarSize(e){this._oppositeScrollbarSize=Math.round(e)}static _computeValues(e,t,i,n,s){const r=Math.max(0,i-e),a=Math.max(0,r-2*t),l=n>0&&n>i;if(!l)return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(a),computedSliderRatio:0,computedSliderPosition:0};const c=Math.round(Math.max(Doe,Math.floor(i*a/n))),d=(a-c)/(n-i),h=s*d;return{computedAvailableSize:Math.round(r),computedIsNeeded:l,computedSliderSize:Math.round(c),computedSliderRatio:d,computedSliderPosition:Math.round(h)}}_refreshComputedValues(){const e=x_._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=e.computedAvailableSize,this._computedIsNeeded=e.computedIsNeeded,this._computedSliderSize=e.computedSliderSize,this._computedSliderRatio=e.computedSliderRatio,this._computedSliderPosition=e.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize-this._computedSliderSize/2;return Math.round(t/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(e){if(!this._computedIsNeeded)return 0;const t=e-this._arrowSize;let i=this._scrollPosition;return t<this._computedSliderPosition?i-=this._visibleSize:i+=this._visibleSize,i}getDesiredScrollPositionFromDelta(e){if(!this._computedIsNeeded)return 0;const t=this._computedSliderPosition+e;return Math.round(t/this._computedSliderRatio)}}class Ioe extends bG{constructor(e,t,i){const n=e.getScrollDimensions(),s=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new x_(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,n.width,n.scrollWidth,s.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows){const r=(t.arrowSize-S_)/2,a=(t.horizontalScrollbarSize-S_)/2;this._createArrow({className:"scra",icon:J.scrollbarButtonLeft,top:a,left:r,bottom:void 0,right:void 0,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new bf(null,1,0))}),this._createArrow({className:"scra",icon:J.scrollbarButtonRight,top:a,left:void 0,bottom:void 0,right:r,bgWidth:t.arrowSize,bgHeight:t.horizontalScrollbarSize,onActivate:()=>this._host.onMouseWheel(new bf(null,-1,0))})}this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}}class Noe extends bG{constructor(e,t,i){const n=e.getScrollDimensions(),s=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new x_(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,n.height,n.scrollHeight,s.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows){const r=(t.arrowSize-S_)/2,a=(t.verticalScrollbarSize-S_)/2;this._createArrow({className:"scra",icon:J.scrollbarButtonUp,top:r,left:a,bottom:void 0,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new bf(null,0,1))}),this._createArrow({className:"scra",icon:J.scrollbarButtonDown,top:void 0,left:a,bottom:r,right:void 0,bgWidth:t.verticalScrollbarSize,bgHeight:t.arrowSize,onActivate:()=>this._host.onMouseWheel(new bf(null,0,-1))})}this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}}class Q0{constructor(e,t,i,n,s,r,a){this._forceIntegerValues=e,this._scrollStateBrand=void 0,this._forceIntegerValues&&(t=t|0,i=i|0,n=n|0,s=s|0,r=r|0,a=a|0),this.rawScrollLeft=n,this.rawScrollTop=a,t<0&&(t=0),n+t>i&&(n=i-t),n<0&&(n=0),s<0&&(s=0),a+s>r&&(a=r-s),a<0&&(a=0),this.width=t,this.scrollWidth=i,this.scrollLeft=n,this.height=s,this.scrollHeight=r,this.scrollTop=a}equals(e){return this.rawScrollLeft===e.rawScrollLeft&&this.rawScrollTop===e.rawScrollTop&&this.width===e.width&&this.scrollWidth===e.scrollWidth&&this.scrollLeft===e.scrollLeft&&this.height===e.height&&this.scrollHeight===e.scrollHeight&&this.scrollTop===e.scrollTop}withScrollDimensions(e,t){return new Q0(this._forceIntegerValues,typeof e.width<"u"?e.width:this.width,typeof e.scrollWidth<"u"?e.scrollWidth:this.scrollWidth,t?this.rawScrollLeft:this.scrollLeft,typeof e.height<"u"?e.height:this.height,typeof e.scrollHeight<"u"?e.scrollHeight:this.scrollHeight,t?this.rawScrollTop:this.scrollTop)}withScrollPosition(e){return new Q0(this._forceIntegerValues,this.width,this.scrollWidth,typeof e.scrollLeft<"u"?e.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof e.scrollTop<"u"?e.scrollTop:this.rawScrollTop)}createScrollEvent(e,t){const i=this.width!==e.width,n=this.scrollWidth!==e.scrollWidth,s=this.scrollLeft!==e.scrollLeft,r=this.height!==e.height,a=this.scrollHeight!==e.scrollHeight,l=this.scrollTop!==e.scrollTop;return{inSmoothScrolling:t,oldWidth:e.width,oldScrollWidth:e.scrollWidth,oldScrollLeft:e.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:e.height,oldScrollHeight:e.scrollHeight,oldScrollTop:e.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:i,scrollWidthChanged:n,scrollLeftChanged:s,heightChanged:r,scrollHeightChanged:a,scrollTopChanged:l}}}class db extends F{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new O),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new Q0(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){const i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){const t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};const i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let n;t?n=new dy(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):n=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=n}else{const i=this._state.withScrollPosition(e);this._smoothScrolling=dy.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;const e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){const i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}}class cH{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}}function yI(o,e){const t=e-o;return function(i){return o+t*Aoe(i)}}function Roe(o,e,t){return function(i){return i<t?o(i/t):e((i-t)/(1-t))}}class dy{constructor(e,t,i,n){this.from=e,this.to=t,this.duration=n,this.startTime=i,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(e,t,i){if(Math.abs(e-t)>2.5*i){let s,r;return e<t?(s=e+.75*i,r=t-.75*i):(s=e-.75*i,r=t+.75*i),Roe(yI(e,s),yI(r,t),.33)}return yI(e,t)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(e){this.to=e.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(e){const t=(e-this.startTime)/this.duration;if(t<1){const i=this.scrollLeft(t),n=this.scrollTop(t);return new cH(i,n,!1)}return new cH(this.to.scrollLeft,this.to.scrollTop,!0)}combine(e,t,i){return dy.start(e,t,i)}static start(e,t,i){i=i+10;const n=Date.now()-10;return new dy(e,t,n,i)}}function Poe(o){return Math.pow(o,3)}function Aoe(o){return 1-Poe(1-o)}const Moe=500,dH=50;class Ooe{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}}const Tk=class Tk{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let e=1,t=0,i=1,n=this._rear;do{const s=n===this._front?e:Math.pow(2,-i);if(e-=s,t+=this._memory[n].score*s,n===this._front)break;n=(this._capacity+n-1)%this._capacity,i++}while(!0);return t<=.5}acceptStandardWheelEvent(e){if(xw){const t=xe(e.browserEvent),i=JQ(t);this.accept(Date.now(),e.deltaX*i,e.deltaY*i)}else this.accept(Date.now(),e.deltaX,e.deltaY)}accept(e,t,i){let n=null;const s=new Ooe(e,t,i);this._front===-1&&this._rear===-1?(this._memory[0]=s,this._front=0,this._rear=0):(n=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=s),s.score=this._computeScore(s,n)}_computeScore(e,t){if(Math.abs(e.deltaX)>0&&Math.abs(e.deltaY)>0)return 1;let i=.5;if((!this._isAlmostInt(e.deltaX)||!this._isAlmostInt(e.deltaY))&&(i+=.25),t){const n=Math.abs(e.deltaX),s=Math.abs(e.deltaY),r=Math.abs(t.deltaX),a=Math.abs(t.deltaY),l=Math.max(Math.min(n,r),1),c=Math.max(Math.min(s,a),1),d=Math.max(n,r),h=Math.max(s,a);d%l===0&&h%c===0&&(i-=.5)}return Math.min(Math.max(i,0),1)}_isAlmostInt(e){return Math.abs(Math.round(e)-e)<.01}};Tk.INSTANCE=new Tk;let J0=Tk;class b5 extends Go{get options(){return this._options}constructor(e,t,i){super(),this._onScroll=this._register(new O),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new O),e.style.overflow="hidden",this._options=Foe(t),this._scrollable=i,this._register(this._scrollable.onScroll(s=>{this._onWillScroll.fire(s),this._onDidScroll(s),this._onScroll.fire(s)}));const n={onMouseWheel:s=>this._onMouseWheel(s),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new Noe(this._scrollable,this._options,n)),this._horizontalScrollbar=this._register(new Ioe(this._scrollable,this._options,n)),this._domNode=document.createElement("div"),this._domNode.className="monaco-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.style.overflow="hidden",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=bt(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=bt(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=bt(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,s=>this._onMouseOver(s)),this.onmouseleave(this._listenOnDomNode,s=>this._onMouseLeave(s)),this._hideTimeout=this._register(new qr),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}dispose(){this._mouseWheelToDispose=Dt(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,Qe&&(this._options.className+=" mac"),this._domNode.className="monaco-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new bf(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=Dt(this._mouseWheelToDispose),e)){const i=n=>{this._onMouseWheel(new bf(n))};this._mouseWheelToDispose.push(H(this._listenOnDomNode,ee.MOUSE_WHEEL,i,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;const t=J0.INSTANCE;t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let s=e.deltaY*this._options.mouseWheelScrollSensitivity,r=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&r+s===0?r=s=0:Math.abs(s)>=Math.abs(r)?r=0:s=0),this._options.flipAxes&&([s,r]=[r,s]);const a=!Qe&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||a)&&!r&&(r=s,s=0),e.browserEvent&&e.browserEvent.altKey&&(r=r*this._options.fastScrollSensitivity,s=s*this._options.fastScrollSensitivity);const l=this._scrollable.getFutureScrollPosition();let c={};if(s){const d=dH*s,h=l.scrollTop-(d<0?Math.floor(d):Math.ceil(d));this._verticalScrollbar.writeScrollPosition(c,h)}if(r){const d=dH*r,h=l.scrollLeft-(d<0?Math.floor(d):Math.ceil(d));this._horizontalScrollbar.writeScrollPosition(c,h)}c=this._scrollable.validateScrollPosition(c),(l.scrollLeft!==c.scrollLeft||l.scrollTop!==c.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(c):this._scrollable.setScrollPositionNow(c),i=!0)}let n=i;!n&&this._options.alwaysConsumeMouseWheel&&(n=!0),!n&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(n=!0),n&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){const e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,n=i?" left":"",s=t?" top":"",r=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${n}`),this._topShadowDomNode.setClassName(`shadow${s}`),this._topLeftShadowDomNode.setClassName(`shadow${r}${s}${n}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),Moe)}}class vG extends b5{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new db({forceIntegerValues:!0,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>ao(xe(e),n)});super(e,t,i),this._register(i)}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}}class RT extends b5{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}}class Iw extends b5{constructor(e,t){t=t||{},t.mouseWheelSmoothScroll=!1;const i=new db({forceIntegerValues:!1,smoothScrollDuration:0,scheduleAtNextAnimationFrame:n=>ao(xe(e),n)});super(e,t,i),this._register(i),this._element=e,this._register(this.onScroll(n=>{n.scrollTopChanged&&(this._element.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this._element.scrollLeft=n.scrollLeft)})),this.scanDomNode()}setScrollPosition(e){this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}scanDomNode(){this.setScrollDimensions({width:this._element.clientWidth,scrollWidth:this._element.scrollWidth,height:this._element.clientHeight,scrollHeight:this._element.scrollHeight}),this.setScrollPosition({scrollLeft:this._element.scrollLeft,scrollTop:this._element.scrollTop})}}function Foe(o){const e={lazyRender:typeof o.lazyRender<"u"?o.lazyRender:!1,className:typeof o.className<"u"?o.className:"",useShadows:typeof o.useShadows<"u"?o.useShadows:!0,handleMouseWheel:typeof o.handleMouseWheel<"u"?o.handleMouseWheel:!0,flipAxes:typeof o.flipAxes<"u"?o.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof o.consumeMouseWheelIfScrollbarIsNeeded<"u"?o.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof o.alwaysConsumeMouseWheel<"u"?o.alwaysConsumeMouseWheel:!1,scrollYToX:typeof o.scrollYToX<"u"?o.scrollYToX:!1,mouseWheelScrollSensitivity:typeof o.mouseWheelScrollSensitivity<"u"?o.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof o.fastScrollSensitivity<"u"?o.fastScrollSensitivity:5,scrollPredominantAxis:typeof o.scrollPredominantAxis<"u"?o.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof o.mouseWheelSmoothScroll<"u"?o.mouseWheelSmoothScroll:!0,arrowSize:typeof o.arrowSize<"u"?o.arrowSize:11,listenOnDomNode:typeof o.listenOnDomNode<"u"?o.listenOnDomNode:null,horizontal:typeof o.horizontal<"u"?o.horizontal:1,horizontalScrollbarSize:typeof o.horizontalScrollbarSize<"u"?o.horizontalScrollbarSize:10,horizontalSliderSize:typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:0,horizontalHasArrows:typeof o.horizontalHasArrows<"u"?o.horizontalHasArrows:!1,vertical:typeof o.vertical<"u"?o.vertical:1,verticalScrollbarSize:typeof o.verticalScrollbarSize<"u"?o.verticalScrollbarSize:10,verticalHasArrows:typeof o.verticalHasArrows<"u"?o.verticalHasArrows:!1,verticalSliderSize:typeof o.verticalSliderSize<"u"?o.verticalSliderSize:0,scrollByPage:typeof o.scrollByPage<"u"?o.scrollByPage:!1};return e.horizontalSliderSize=typeof o.horizontalSliderSize<"u"?o.horizontalSliderSize:e.horizontalScrollbarSize,e.verticalSliderSize=typeof o.verticalSliderSize<"u"?o.verticalSliderSize:e.verticalScrollbarSize,Qe&&(e.className+=" mac"),e}const ES=ie;let v5=class extends F{constructor(){super(),this.containerDomNode=document.createElement("div"),this.containerDomNode.className="monaco-hover",this.containerDomNode.tabIndex=0,this.containerDomNode.setAttribute("role","tooltip"),this.contentsDomNode=document.createElement("div"),this.contentsDomNode.className="monaco-hover-content",this.scrollbar=this._register(new Iw(this.contentsDomNode,{consumeMouseWheelIfScrollbarIsNeeded:!0})),this.containerDomNode.appendChild(this.scrollbar.getDomNode())}onContentsChanged(){this.scrollbar.scanDomNode()}};class PT extends F{static render(e,t,i){return new PT(e,t,i)}constructor(e,t,i){super(),this.actionLabel=t.label,this.actionKeybindingLabel=i,this.actionContainer=Y(e,ES("div.action-container")),this.actionContainer.setAttribute("tabindex","0"),this.action=Y(this.actionContainer,ES("a.action")),this.action.setAttribute("role","button"),t.iconClass&&Y(this.action,ES(`span.icon.${t.iconClass}`));const n=Y(this.action,ES("span"));n.textContent=i?`${t.label} (${i})`:t.label,this._store.add(new yG(this.actionContainer,t.run)),this._store.add(new wG(this.actionContainer,t.run,[3,10])),this.setEnabled(!0)}setEnabled(e){e?(this.actionContainer.classList.remove("disabled"),this.actionContainer.removeAttribute("aria-disabled")):(this.actionContainer.classList.add("disabled"),this.actionContainer.setAttribute("aria-disabled","true"))}}function CG(o,e){return o&&e?p("acessibleViewHint","Inspect this in the accessible view with {0}.",e):o?p("acessibleViewHintNoKbOpen","Inspect this in the accessible view via the command Open Accessible View which is currently not triggerable via keybinding."):""}class yG extends F{constructor(e,t){super(),this._register(H(e,ee.CLICK,i=>{i.stopPropagation(),i.preventDefault(),t(e)}))}}class wG extends F{constructor(e,t,i){super(),this._register(H(e,ee.KEY_DOWN,n=>{const s=new Pt(n);i.some(r=>s.equals(r))&&(n.stopPropagation(),n.preventDefault(),t(e))}))}}const Fs=Je("openerService");function Boe(o){let e;const t=/^L?(\d+)(?:,(\d+))?(-L?(\d+)(?:,(\d+))?)?/.exec(o.fragment);return t&&(e={startLineNumber:parseInt(t[1]),startColumn:t[2]?parseInt(t[2]):1,endLineNumber:t[4]?parseInt(t[4]):void 0,endColumn:t[4]?t[5]?parseInt(t[5]):1:void 0},o=o.with({fragment:""})),{selection:e,uri:o}}class et{get event(){return this.emitter.event}constructor(e,t,i){const n=s=>this.emitter.fire(s);this.emitter=new O({onWillAddFirstListener:()=>e.addEventListener(t,n,i),onDidRemoveLastListener:()=>e.removeEventListener(t,n,i)})}dispose(){this.emitter.dispose()}}function Woe(o,e={}){const t=C5(e);return t.textContent=o,t}function Voe(o,e={}){const t=C5(e);return SG(t,zoe(o,!!e.renderCodeSegments),e.actionHandler,e.renderCodeSegments),t}function C5(o){const e=o.inline?"span":"div",t=document.createElement(e);return o.className&&(t.className=o.className),t}class Hoe{constructor(e){this.source=e,this.index=0}eos(){return this.index>=this.source.length}next(){const e=this.peek();return this.advance(),e}peek(){return this.source[this.index]}advance(){this.index++}}function SG(o,e,t,i){let n;if(e.type===2)n=document.createTextNode(e.content||"");else if(e.type===3)n=document.createElement("b");else if(e.type===4)n=document.createElement("i");else if(e.type===7&&i)n=document.createElement("code");else if(e.type===5&&t){const s=document.createElement("a");t.disposables.add(ci(s,"click",r=>{t.callback(String(e.index),r)})),n=s}else e.type===8?n=document.createElement("br"):e.type===1&&(n=o);n&&o!==n&&o.appendChild(n),n&&Array.isArray(e.children)&&e.children.forEach(s=>{SG(n,s,t,i)})}function zoe(o,e){const t={type:1,children:[]};let i=0,n=t;const s=[],r=new Hoe(o);for(;!r.eos();){let a=r.next();const l=a==="\\"&&YP(r.peek(),e)!==0;if(l&&(a=r.next()),!l&&Uoe(a,e)&&a===r.peek()){r.advance(),n.type===2&&(n=s.pop());const c=YP(a,e);if(n.type===c||n.type===5&&c===6)n=s.pop();else{const d={type:c,children:[]};c===5&&(d.index=i,i++),n.children.push(d),s.push(n),n=d}}else if(a===`
`)n.type===2&&(n=s.pop()),n.children.push({type:8});else if(n.type!==2){const c={type:2,content:a};n.children.push(c),s.push(n),n=c}else n.content+=a}return n.type===2&&(n=s.pop()),t}function Uoe(o,e){return YP(o,e)!==0}function YP(o,e){switch(o){case"*":return 3;case"_":return 4;case"[":return 5;case"]":return 6;case"`":return e?7:0;default:return 0}}const Goe=new RegExp(`(\\\\)?\\$\\((${ke.iconNameExpression}(?:${ke.iconModifierExpression})?)\\)`,"g");function nh(o){const e=new Array;let t,i=0,n=0;for(;(t=Goe.exec(o))!==null;){n=t.index||0,i<n&&e.push(o.substring(i,n)),i=(t.index||0)+t[0].length;const[,s,r]=t;e.push(s?`$(${r})`:Sf({id:r}))}return i<o.length&&e.push(o.substring(i)),e}function Sf(o){const e=ie("span");return e.classList.add(...ke.asClassNameArray(o)),e}function $oe(o){const e=Koe(o);if(e&&e.length>0)return new Uint32Array(e)}let Co=0;const Rd=new Uint32Array(10);function Koe(o){if(Co=0,Ga(o,wI,4352),Co>0||(Ga(o,SI,4449),Co>0)||(Ga(o,xI,4520),Co>0)||(Ga(o,lu,12593),Co))return Rd.subarray(0,Co);if(o>=44032&&o<=55203){const e=o-44032,t=e%588,i=Math.floor(e/588),n=Math.floor(t/28),s=t%28-1;if(i<wI.length?Ga(i,wI,0):4352+i-12593<lu.length&&Ga(4352+i,lu,12593),n<SI.length?Ga(n,SI,0):4449+n-12593<lu.length&&Ga(4449+n-12593,lu,12593),s>=0&&(s<xI.length?Ga(s,xI,0):4520+s-12593<lu.length&&Ga(4520+s-12593,lu,12593)),Co>0)return Rd.subarray(0,Co)}}function Ga(o,e,t){o>=t&&o<t+e.length&&joe(e[o-t])}function joe(o){o!==0&&(Rd[Co++]=o&255,o>>8&&(Rd[Co++]=o>>8&255),o>>16&&(Rd[Co++]=o>>16&255))}const wI=new Uint8Array([114,82,115,101,69,102,97,113,81,116,84,100,119,87,99,122,120,118,103]),SI=new Uint16Array([107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]),xI=new Uint16Array([114,82,29810,115,30579,26483,101,102,29286,24934,29030,29798,30822,30310,26470,97,113,29809,116,84,100,119,99,122,120,118,103]),lu=new Uint16Array([114,82,29810,115,30579,26483,101,69,102,29286,24934,29030,29798,30822,30310,26470,97,113,81,29809,116,84,100,119,87,99,122,120,118,103,107,111,105,79,106,112,117,80,104,27496,28520,27752,121,110,27246,28782,27758,98,109,27757,108]);function y5(...o){return function(e,t){for(let i=0,n=o.length;i<n;i++){const s=o[i](e,t);if(s)return s}return null}}xG.bind(void 0,!1);const hy=xG.bind(void 0,!0);function xG(o,e,t){if(!t||t.length<e.length)return null;let i;return o?i=N4(t,e):i=t.indexOf(e)===0,i?e.length>0?[{start:0,end:e.length}]:[]:null}function LG(o,e){const t=e.toLowerCase().indexOf(o.toLowerCase());return t===-1?null:[{start:t,end:t+o.length}]}function kG(o,e){return XP(o.toLowerCase(),e.toLowerCase(),0,0)}function XP(o,e,t,i){if(t===o.length)return[];if(i===e.length)return null;if(o[t]===e[i]){let n=null;return(n=XP(o,e,t+1,i+1))?x5({start:i,end:i+1},n):null}return XP(o,e,t,i+1)}function w5(o){return 97<=o&&o<=122}function AT(o){return 65<=o&&o<=90}function S5(o){return 48<=o&&o<=57}function EG(o){return o===32||o===9||o===10||o===13}const TG=new Set;"()[]{}<>`'\"-/;:,.?!".split("").forEach(o=>TG.add(o.charCodeAt(0)));function ex(o){return EG(o)||TG.has(o)}function hH(o,e){return o===e||ex(o)&&ex(e)}const LI=new Map;function uH(o){if(LI.has(o))return LI.get(o);let e;const t=$oe(o);return t&&(e=t),LI.set(o,e),e}function DG(o){return w5(o)||AT(o)||S5(o)}function x5(o,e){return e.length===0?e=[o]:o.end===e[0].start?e[0].start=o.start:e.unshift(o),e}function IG(o,e){for(let t=e;t<o.length;t++){const i=o.charCodeAt(t);if(AT(i)||S5(i)||t>0&&!DG(o.charCodeAt(t-1)))return t}return o.length}function QP(o,e,t,i){if(t===o.length)return[];if(i===e.length)return null;if(o[t]!==e[i].toLowerCase())return null;{let n=null,s=i+1;for(n=QP(o,e,t+1,i+1);!n&&(s=IG(e,s))<e.length;)n=QP(o,e,t+1,s),s++;return n===null?null:x5({start:i,end:i+1},n)}}function qoe(o){let e=0,t=0,i=0,n=0,s=0;for(let d=0;d<o.length;d++)s=o.charCodeAt(d),AT(s)&&e++,w5(s)&&t++,DG(s)&&i++,S5(s)&&n++;const r=e/o.length,a=t/o.length,l=i/o.length,c=n/o.length;return{upperPercent:r,lowerPercent:a,alphaPercent:l,numericPercent:c}}function Zoe(o){const{upperPercent:e,lowerPercent:t}=o;return t===0&&e>.6}function Yoe(o){const{upperPercent:e,lowerPercent:t,alphaPercent:i,numericPercent:n}=o;return t>.2&&e<.8&&i>.6&&n<.2}function Xoe(o){let e=0,t=0,i=0,n=0;for(let s=0;s<o.length;s++)i=o.charCodeAt(s),AT(i)&&e++,w5(i)&&t++,EG(i)&&n++;return(e===0||t===0)&&n===0?o.length<=30:e<=5}function NG(o,e){if(!e||(e=e.trim(),e.length===0)||!Xoe(o))return null;e.length>60&&(e=e.substring(0,60));const t=qoe(e);if(!Yoe(t)){if(!Zoe(t))return null;e=e.toLowerCase()}let i=null,n=0;for(o=o.toLowerCase();n<e.length&&(i=QP(o,e,0,n))===null;)n=IG(e,n+1);return i}function Qoe(o,e,t=!1){if(!e||e.length===0)return null;let i=null,n=0;for(o=o.toLowerCase(),e=e.toLowerCase();n<e.length&&(i=JP(o,e,0,n,t),i===null);)n=RG(e,n+1);return i}function JP(o,e,t,i,n){let s=0;if(t===o.length)return[];if(i===e.length)return null;if(!hH(o.charCodeAt(t),e.charCodeAt(i))){const l=uH(o.charCodeAt(t));if(!l)return null;for(let c=0;c<l.length;c++)if(!hH(l[c],e.charCodeAt(i+c)))return null;s+=l.length-1}let r=null,a=i+s+1;if(r=JP(o,e,t+1,a,n),!n)for(;!r&&(a=RG(e,a))<e.length;)r=JP(o,e,t+1,a,n),a++;if(!r)return null;if(o.charCodeAt(t)!==e.charCodeAt(i)){const l=uH(o.charCodeAt(t));if(!l)return r;for(let c=0;c<l.length;c++)if(l[c]!==e.charCodeAt(i+c))return r}return x5({start:i,end:i+s+1},r)}function RG(o,e){for(let t=e;t<o.length;t++)if(ex(o.charCodeAt(t))||t>0&&ex(o.charCodeAt(t-1)))return t;return o.length}const Joe=y5(hy,NG,LG),ere=y5(hy,NG,kG),gH=new Vl(1e4);function fH(o,e,t=!1){if(typeof o!="string"||typeof e!="string")return null;let i=gH.get(o);i||(i=new RegExp(WQ(o),"i"),gH.set(o,i));const n=i.exec(e);return n?[{start:n.index,end:n.index+n[0].length}]:t?ere(o,e):Joe(o,e)}function tre(o,e){const t=xf(o,o.toLowerCase(),0,e,e.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return t?Nw(t):null}function ire(o,e,t,i,n,s){const r=Math.min(13,o.length);for(;t<r;t++){const a=xf(o,e,t,i,n,s,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(a)return a}return[0,s]}function Nw(o){if(typeof o>"u")return[];const e=[],t=o[1];for(let i=o.length-1;i>1;i--){const n=o[i]+t,s=e[e.length-1];s&&s.end===n?s.end=n+1:e.push({start:n,end:n+1})}return e}const Gd=128;function L5(){const o=[],e=[];for(let t=0;t<=Gd;t++)e[t]=0;for(let t=0;t<=Gd;t++)o.push(e.slice(0));return o}function PG(o){const e=[];for(let t=0;t<=o;t++)e[t]=0;return e}const AG=PG(2*Gd),eA=PG(2*Gd),Zl=L5(),cu=L5(),TS=L5();function DS(o,e){if(e<0||e>=o.length)return!1;const t=o.codePointAt(e);switch(t){case 95:case 45:case 46:case 32:case 47:case 92:case 39:case 34:case 58:case 36:case 60:case 62:case 40:case 41:case 91:case 93:case 123:case 125:return!0;case void 0:return!1;default:return!!M4(t)}}function pH(o,e){if(e<0||e>=o.length)return!1;switch(o.charCodeAt(e)){case 32:case 9:return!0;default:return!1}}function W1(o,e,t){return e[o]!==t[o]}function nre(o,e,t,i,n,s,r=!1){for(;e<t&&n<s;)o[e]===i[n]&&(r&&(AG[e]=n),e+=1),n+=1;return e===t}var ka;(function(o){o.Default=[-100,0];function e(t){return!t||t.length===2&&t[0]===-100&&t[1]===0}o.isDefault=e})(ka||(ka={}));const o3=class o3{constructor(e,t){this.firstMatchCanBeWeak=e,this.boostFullMatch=t}};o3.default={boostFullMatch:!0,firstMatchCanBeWeak:!1};let uy=o3;function xf(o,e,t,i,n,s,r=uy.default){const a=o.length>Gd?Gd:o.length,l=i.length>Gd?Gd:i.length;if(t>=a||s>=l||a-t>l-s||!nre(e,t,a,n,s,l,!0))return;sre(a,l,t,s,e,n);let c=1,d=1,h=t,u=s;const g=[!1];for(c=1,h=t;h<a;c++,h++){const v=AG[h],y=eA[h],C=h+1<a?eA[h+1]:l;for(d=v-s+1,u=v;u<C;d++,u++){let w=Number.MIN_SAFE_INTEGER,x=!1;u<=y&&(w=ore(o,e,h,t,i,n,u,l,s,Zl[c-1][d-1]===0,g));let k=0;w!==Number.MAX_SAFE_INTEGER&&(x=!0,k=w+cu[c-1][d-1]);const E=u>v,N=E?cu[c][d-1]+(Zl[c][d-1]>0?-5:0):0,z=u>v+1&&Zl[c][d-1]>0,B=z?cu[c][d-2]+(Zl[c][d-2]>0?-5:0):0;if(z&&(!E||B>=N)&&(!x||B>=k))cu[c][d]=B,TS[c][d]=3,Zl[c][d]=0;else if(E&&(!x||N>=k))cu[c][d]=N,TS[c][d]=2,Zl[c][d]=0;else if(x)cu[c][d]=k,TS[c][d]=1,Zl[c][d]=Zl[c-1][d-1]+1;else throw new Error("not possible")}}if(!g[0]&&!r.firstMatchCanBeWeak)return;c--,d--;const f=[cu[c][d],s];let m=0,_=0;for(;c>=1;){let v=d;do{const y=TS[c][v];if(y===3)v=v-2;else if(y===2)v=v-1;else break}while(v>=1);m>1&&e[t+c-1]===n[s+d-1]&&!W1(v+s-1,i,n)&&m+1>Zl[c][v]&&(v=d),v===d?m++:m=1,_||(_=v),c--,d=v-1,f.push(d)}l-s===a&&r.boostFullMatch&&(f[0]+=2);const b=_-a;return f[0]-=b,f}function sre(o,e,t,i,n,s){let r=o-1,a=e-1;for(;r>=t&&a>=i;)n[r]===s[a]&&(eA[r]=a,r--),a--}function ore(o,e,t,i,n,s,r,a,l,c,d){if(e[t]!==s[r])return Number.MIN_SAFE_INTEGER;let h=1,u=!1;return r===t-i?h=o[t]===n[r]?7:5:W1(r,n,s)&&(r===0||!W1(r-1,n,s))?(h=o[t]===n[r]?7:5,u=!0):DS(s,r)&&(r===0||!DS(s,r-1))?h=5:(DS(s,r-1)||pH(s,r-1))&&(h=5,u=!0),h>1&&t===i&&(d[0]=!0),u||(u=W1(r,n,s)||DS(s,r-1)||pH(s,r-1)),t===i?r>l&&(h-=u?3:5):c?h+=u?2:0:h+=u?0:1,r+1===a&&(h-=u?3:5),h}function rre(o,e,t,i,n,s,r){return are(o,e,t,i,n,s,!0,r)}function are(o,e,t,i,n,s,r,a){let l=xf(o,e,t,i,n,s,a);if(o.length>=3){const c=Math.min(7,o.length-1);for(let d=t+1;d<c;d++){const h=lre(o,d);if(h){const u=xf(h,h.toLowerCase(),t,i,n,s,a);u&&(u[0]-=3,(!l||u[0]>l[0])&&(l=u))}}}return l}function lre(o,e){if(e+1>=o.length)return;const t=o[e],i=o[e+1];if(t!==i)return o.slice(0,e)+i+t+o.slice(e+2)}const cre="$(",k5=new RegExp(`\\$\\(${ke.iconNameExpression}(?:${ke.iconModifierExpression})?\\)`,"g"),dre=new RegExp(`(\\\\)?${k5.source}`,"g");function hre(o){return o.replace(dre,(e,t)=>t?e:`\\${e}`)}const ure=new RegExp(`\\\\${k5.source}`,"g");function gre(o){return o.replace(ure,e=>`\\${e}`)}const fre=new RegExp(`(\\s)?(\\\\)?${k5.source}(\\s)?`,"g");function E5(o){return o.indexOf(cre)===-1?o:o.replace(fre,(e,t,i,n)=>i?e:t||n||"")}function pre(o){return o?o.replace(/\$\((.*?)\)/g,(e,t)=>` ${t} `).trim():""}const kI=new RegExp(`\\$\\(${ke.iconNameCharacter}+\\)`,"g");function fv(o){kI.lastIndex=0;let e="";const t=[];let i=0;for(;;){const n=kI.lastIndex,s=kI.exec(o),r=o.substring(n,s?.index);if(r.length>0){e+=r;for(let a=0;a<r.length;a++)t.push(i)}if(!s)break;i+=s[0].length}return{text:e,iconOffsets:t}}function EI(o,e,t=!1){const{text:i,iconOffsets:n}=e;if(!n||n.length===0)return fH(o,i,t);const s=yw(i," "),r=i.length-s.length,a=fH(o,s,t);if(a)for(const l of a){const c=n[l.start+r]+r;l.start+=c,l.end+=c}return a}function Qa(o){return S0(o,!0)}class mre{constructor(e){this._ignorePathCasing=e}compare(e,t,i=!1){return e===t?0:jC(this.getComparisonKey(e,i),this.getComparisonKey(t,i))}isEqual(e,t,i=!1){return e===t?!0:!e||!t?!1:this.getComparisonKey(e,i)===this.getComparisonKey(t,i)}getComparisonKey(e,t=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:t?null:void 0}).toString()}isEqualOrParent(e,t,i=!1){if(e.scheme===t.scheme){if(e.scheme===Oe.file)return HP(Qa(e),Qa(t),this._ignorePathCasing(e))&&e.query===t.query&&(i||e.fragment===t.fragment);if(_H(e.authority,t.authority))return HP(e.path,t.path,this._ignorePathCasing(e),"/")&&e.query===t.query&&(i||e.fragment===t.fragment)}return!1}joinPath(e,...t){return ye.joinPath(e,...t)}basenameOrAuthority(e){return fr(e)||e.authority}basename(e){return Ri.basename(e.path)}extname(e){return Ri.extname(e.path)}dirname(e){if(e.path.length===0)return e;let t;return e.scheme===Oe.file?t=ye.file(fz(Qa(e))).path:(t=Ri.dirname(e.path),e.authority&&t.length&&t.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),t="/")),e.with({path:t})}normalizePath(e){if(!e.path.length)return e;let t;return e.scheme===Oe.file?t=ye.file(gz(Qa(e))).path:t=Ri.normalize(e.path),e.with({path:t})}relativePath(e,t){if(e.scheme!==t.scheme||!_H(e.authority,t.authority))return;if(e.scheme===Oe.file){const s=mQ(Qa(e),Qa(t));return En?jU(s):s}let i=e.path||"/";const n=t.path||"/";if(this._ignorePathCasing(e)){let s=0;for(const r=Math.min(i.length,n.length);s<r&&!(i.charCodeAt(s)!==n.charCodeAt(s)&&i.charAt(s).toLowerCase()!==n.charAt(s).toLowerCase());s++);i=n.substr(0,s)+i.substr(s)}return Ri.relative(i,n)}resolvePath(e,t){if(e.scheme===Oe.file){const i=ye.file(pQ(Qa(e),t));return e.with({authority:i.authority,path:i.path})}return t=vne(t),e.with({path:Ri.resolve(e.path,t)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,t){return e===t||e!==void 0&&t!==void 0&&Gp(e,t)}hasTrailingPathSeparator(e,t=ya){if(e.scheme===Oe.file){const i=Qa(e);return i.length>UV(i).length&&i[i.length-1]===t}else{const i=e.path;return i.length>1&&i.charCodeAt(i.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,t=ya){return bH(e,t)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,t=ya){let i=!1;if(e.scheme===Oe.file){const n=Qa(e);i=n!==void 0&&n.length===UV(n).length&&n[n.length-1]===t}else{t="/";const n=e.path;i=n.length===1&&n.charCodeAt(n.length-1)===47}return!i&&!bH(e,t)?e.with({path:e.path+"/"}):e}}const Zt=new mre(()=>!1),gy=Zt.isEqual.bind(Zt);Zt.isEqualOrParent.bind(Zt);Zt.getComparisonKey.bind(Zt);const _re=Zt.basenameOrAuthority.bind(Zt),fr=Zt.basename.bind(Zt),bre=Zt.extname.bind(Zt),MT=Zt.dirname.bind(Zt),vre=Zt.joinPath.bind(Zt),Cre=Zt.normalizePath.bind(Zt),yre=Zt.relativePath.bind(Zt),mH=Zt.resolvePath.bind(Zt);Zt.isAbsolutePath.bind(Zt);const _H=Zt.isEqualAuthority.bind(Zt),bH=Zt.hasTrailingPathSeparator.bind(Zt);Zt.removeTrailingPathSeparator.bind(Zt);Zt.addTrailingPathSeparator.bind(Zt);var Oh;(function(o){o.META_DATA_LABEL="label",o.META_DATA_DESCRIPTION="description",o.META_DATA_SIZE="size",o.META_DATA_MIME="mime";function e(t){const i=new Map;t.path.substring(t.path.indexOf(";")+1,t.path.lastIndexOf(";")).split(";").forEach(r=>{const[a,l]=r.split(":");a&&l&&i.set(a,l)});const s=t.path.substring(0,t.path.indexOf(";"));return s&&i.set(o.META_DATA_MIME,s),i}o.parseMetaData=e})(Oh||(Oh={}));class Pn{constructor(e="",t=!1){if(this.value=e,typeof this.value!="string")throw ar("value");typeof t=="boolean"?(this.isTrusted=t,this.supportThemeIcons=!1,this.supportHtml=!1):(this.isTrusted=t.isTrusted??void 0,this.supportThemeIcons=t.supportThemeIcons??!1,this.supportHtml=t.supportHtml??!1)}appendText(e,t=0){return this.value+=Sre(this.supportThemeIcons?hre(e):e).replace(/([ \t]+)/g,(i,n)=>"&nbsp;".repeat(n.length)).replace(/\>/gm,"\\>").replace(/\n/g,t===1?`\\
`:`

`),this}appendMarkdown(e){return this.value+=e,this}appendCodeblock(e,t){return this.value+=`
${xre(t,e)}
`,this}appendLink(e,t,i){return this.value+="[",this.value+=this._escape(t,"]"),this.value+="](",this.value+=this._escape(String(e),")"),i&&(this.value+=` "${this._escape(this._escape(i,'"'),")")}"`),this.value+=")",this}_escape(e,t){const i=new RegExp(Fo(t),"g");return e.replace(i,(n,s)=>e.charAt(s-1)!=="\\"?`\\${n}`:n)}}function L_(o){return Ea(o)?!o.value:Array.isArray(o)?o.every(L_):!0}function Ea(o){return o instanceof Pn?!0:o&&typeof o=="object"?typeof o.value=="string"&&(typeof o.isTrusted=="boolean"||typeof o.isTrusted=="object"||o.isTrusted===void 0)&&(typeof o.supportThemeIcons=="boolean"||o.supportThemeIcons===void 0):!1}function wre(o,e){return o===e?!0:!o||!e?!1:o.value===e.value&&o.isTrusted===e.isTrusted&&o.supportThemeIcons===e.supportThemeIcons&&o.supportHtml===e.supportHtml&&(o.baseUri===e.baseUri||!!o.baseUri&&!!e.baseUri&&gy(ye.from(o.baseUri),ye.from(e.baseUri)))}function Sre(o){return o.replace(/[\\`*_{}[\]()#+\-!~]/g,"\\$&")}function xre(o,e){const t=o.match(/^`+/gm)?.reduce((n,s)=>n.length>s.length?n:s).length??0,i=t>=3?t+1:3;return[`${"`".repeat(i)}${e}`,o,`${"`".repeat(i)}`].join(`
`)}function IS(o){return o.replace(/"/g,"&quot;")}function TI(o){return o&&o.replace(/\\([\\`*_{}[\]()#+\-.!~])/g,"$1")}function Lre(o){const e=[],t=o.split("|").map(n=>n.trim());o=t[0];const i=t[1];if(i){const n=/height=(\d+)/.exec(i),s=/width=(\d+)/.exec(i),r=n?n[1]:"",a=s?s[1]:"",l=isFinite(parseInt(a)),c=isFinite(parseInt(r));l&&e.push(`width="${a}"`),c&&e.push(`height="${r}"`)}return{href:o,dimensions:e}}class T5{constructor(e){this._prefix=e,this._lastId=0}nextId(){return this._prefix+ ++this._lastId}}const tA=new T5("id#");let Bn={};(function(){function o(e,t){t(Bn)}o.amd=!0,function(e,t){typeof o=="function"&&o.amd?o(["exports"],t):typeof exports=="object"&&typeof module<"u"?t(exports):(e=typeof globalThis<"u"?globalThis:e||self,t(e.marked={}))}(this,function(e){function t(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}e.defaults=t();function i(ct){e.defaults=ct}const n=/[&<>"']/,s=new RegExp(n.source,"g"),r=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,a=new RegExp(r.source,"g"),l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},c=ct=>l[ct];function d(ct,R){if(R){if(n.test(ct))return ct.replace(s,c)}else if(r.test(ct))return ct.replace(a,c);return ct}const h=/(^|[^\[])\^/g;function u(ct,R){let P=typeof ct=="string"?ct:ct.source;R=R||"";const M={replace:(W,G)=>{let te=typeof G=="string"?G:G.source;return te=te.replace(h,"$1"),P=P.replace(W,te),M},getRegex:()=>new RegExp(P,R)};return M}function g(ct){try{ct=encodeURI(ct).replace(/%25/g,"%")}catch{return null}return ct}const f={exec:()=>null};function m(ct,R){const P=ct.replace(/\|/g,(G,te,ae)=>{let Te=!1,Me=te;for(;--Me>=0&&ae[Me]==="\\";)Te=!Te;return Te?"|":" |"}),M=P.split(/ \|/);let W=0;if(M[0].trim()||M.shift(),M.length>0&&!M[M.length-1].trim()&&M.pop(),R)if(M.length>R)M.splice(R);else for(;M.length<R;)M.push("");for(;W<M.length;W++)M[W]=M[W].trim().replace(/\\\|/g,"|");return M}function _(ct,R,P){const M=ct.length;if(M===0)return"";let W=0;for(;W<M&&ct.charAt(M-W-1)===R;)W++;return ct.slice(0,M-W)}function b(ct,R){if(ct.indexOf(R[1])===-1)return-1;let P=0;for(let M=0;M<ct.length;M++)if(ct[M]==="\\")M++;else if(ct[M]===R[0])P++;else if(ct[M]===R[1]&&(P--,P<0))return M;return-1}function v(ct,R,P,M){const W=R.href,G=R.title?d(R.title):null,te=ct[1].replace(/\\([\[\]])/g,"$1");if(ct[0].charAt(0)!=="!"){M.state.inLink=!0;const ae={type:"link",raw:P,href:W,title:G,text:te,tokens:M.inlineTokens(te)};return M.state.inLink=!1,ae}return{type:"image",raw:P,href:W,title:G,text:d(te)}}function y(ct,R){const P=ct.match(/^(\s+)(?:```)/);if(P===null)return R;const M=P[1];return R.split(`
`).map(W=>{const G=W.match(/^\s+/);if(G===null)return W;const[te]=G;return te.length>=M.length?W.slice(M.length):W}).join(`
`)}class C{options;rules;lexer;constructor(R){this.options=R||e.defaults}space(R){const P=this.rules.block.newline.exec(R);if(P&&P[0].length>0)return{type:"space",raw:P[0]}}code(R){const P=this.rules.block.code.exec(R);if(P){const M=P[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:P[0],codeBlockStyle:"indented",text:this.options.pedantic?M:_(M,`
`)}}}fences(R){const P=this.rules.block.fences.exec(R);if(P){const M=P[0],W=y(M,P[3]||"");return{type:"code",raw:M,lang:P[2]?P[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):P[2],text:W}}}heading(R){const P=this.rules.block.heading.exec(R);if(P){let M=P[2].trim();if(/#$/.test(M)){const W=_(M,"#");(this.options.pedantic||!W||/ $/.test(W))&&(M=W.trim())}return{type:"heading",raw:P[0],depth:P[1].length,text:M,tokens:this.lexer.inline(M)}}}hr(R){const P=this.rules.block.hr.exec(R);if(P)return{type:"hr",raw:_(P[0],`
`)}}blockquote(R){const P=this.rules.block.blockquote.exec(R);if(P){let M=_(P[0],`
`).split(`
`),W="",G="";const te=[];for(;M.length>0;){let ae=!1;const Te=[];let Me;for(Me=0;Me<M.length;Me++)if(/^ {0,3}>/.test(M[Me]))Te.push(M[Me]),ae=!0;else if(!ae)Te.push(M[Me]);else break;M=M.slice(Me);const ot=Te.join(`
`),Et=ot.replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`).replace(/^ {0,3}>[ \t]?/gm,"");W=W?`${W}
${ot}`:ot,G=G?`${G}
${Et}`:Et;const Mt=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(Et,te,!0),this.lexer.state.top=Mt,M.length===0)break;const Xi=te[te.length-1];if(Xi?.type==="code")break;if(Xi?.type==="blockquote"){const wi=Xi,Ws=wi.raw+`
`+M.join(`
`),qo=this.blockquote(Ws);te[te.length-1]=qo,W=W.substring(0,W.length-wi.raw.length)+qo.raw,G=G.substring(0,G.length-wi.text.length)+qo.text;break}else if(Xi?.type==="list"){const wi=Xi,Ws=wi.raw+`
`+M.join(`
`),qo=this.list(Ws);te[te.length-1]=qo,W=W.substring(0,W.length-Xi.raw.length)+qo.raw,G=G.substring(0,G.length-wi.raw.length)+qo.raw,M=Ws.substring(te[te.length-1].raw.length).split(`
`);continue}}return{type:"blockquote",raw:W,tokens:te,text:G}}}list(R){let P=this.rules.block.list.exec(R);if(P){let M=P[1].trim();const W=M.length>1,G={type:"list",raw:"",ordered:W,start:W?+M.slice(0,-1):"",loose:!1,items:[]};M=W?`\\d{1,9}\\${M.slice(-1)}`:`\\${M}`,this.options.pedantic&&(M=W?M:"[*+-]");const te=new RegExp(`^( {0,3}${M})((?:[	 ][^\\n]*)?(?:\\n|$))`);let ae=!1;for(;R;){let Te=!1,Me="",ot="";if(!(P=te.exec(R))||this.rules.block.hr.test(R))break;Me=P[0],R=R.substring(Me.length);let Et=P[2].split(`
`,1)[0].replace(/^\t+/,Rb=>" ".repeat(3*Rb.length)),Mt=R.split(`
`,1)[0],Xi=!Et.trim(),wi=0;if(this.options.pedantic?(wi=2,ot=Et.trimStart()):Xi?wi=P[1].length+1:(wi=P[2].search(/[^ ]/),wi=wi>4?1:wi,ot=Et.slice(wi),wi+=P[1].length),Xi&&/^ *$/.test(Mt)&&(Me+=Mt+`
`,R=R.substring(Mt.length+1),Te=!0),!Te){const Rb=new RegExp(`^ {0,${Math.min(3,wi-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),Ze=new RegExp(`^ {0,${Math.min(3,wi-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),q=new RegExp(`^ {0,${Math.min(3,wi-1)}}(?:\`\`\`|~~~)`),Se=new RegExp(`^ {0,${Math.min(3,wi-1)}}#`);for(;R;){const Ve=R.split(`
`,1)[0];if(Mt=Ve,this.options.pedantic&&(Mt=Mt.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),q.test(Mt)||Se.test(Mt)||Rb.test(Mt)||Ze.test(R))break;if(Mt.search(/[^ ]/)>=wi||!Mt.trim())ot+=`
`+Mt.slice(wi);else{if(Xi||Et.search(/[^ ]/)>=4||q.test(Et)||Se.test(Et)||Ze.test(Et))break;ot+=`
`+Mt}!Xi&&!Mt.trim()&&(Xi=!0),Me+=Ve+`
`,R=R.substring(Ve.length+1),Et=Mt.slice(wi)}}G.loose||(ae?G.loose=!0:/\n *\n *$/.test(Me)&&(ae=!0));let Ws=null,qo;this.options.gfm&&(Ws=/^\[[ xX]\] /.exec(ot),Ws&&(qo=Ws[0]!=="[ ] ",ot=ot.replace(/^\[[ xX]\] +/,""))),G.items.push({type:"list_item",raw:Me,task:!!Ws,checked:qo,loose:!1,text:ot,tokens:[]}),G.raw+=Me}G.items[G.items.length-1].raw=G.items[G.items.length-1].raw.trimEnd(),G.items[G.items.length-1].text=G.items[G.items.length-1].text.trimEnd(),G.raw=G.raw.trimEnd();for(let Te=0;Te<G.items.length;Te++)if(this.lexer.state.top=!1,G.items[Te].tokens=this.lexer.blockTokens(G.items[Te].text,[]),!G.loose){const Me=G.items[Te].tokens.filter(Et=>Et.type==="space"),ot=Me.length>0&&Me.some(Et=>/\n.*\n/.test(Et.raw));G.loose=ot}if(G.loose)for(let Te=0;Te<G.items.length;Te++)G.items[Te].loose=!0;return G}}html(R){const P=this.rules.block.html.exec(R);if(P)return{type:"html",block:!0,raw:P[0],pre:P[1]==="pre"||P[1]==="script"||P[1]==="style",text:P[0]}}def(R){const P=this.rules.block.def.exec(R);if(P){const M=P[1].toLowerCase().replace(/\s+/g," "),W=P[2]?P[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",G=P[3]?P[3].substring(1,P[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):P[3];return{type:"def",tag:M,raw:P[0],href:W,title:G}}}table(R){const P=this.rules.block.table.exec(R);if(!P||!/[:|]/.test(P[2]))return;const M=m(P[1]),W=P[2].replace(/^\||\| *$/g,"").split("|"),G=P[3]&&P[3].trim()?P[3].replace(/\n[ \t]*$/,"").split(`
`):[],te={type:"table",raw:P[0],header:[],align:[],rows:[]};if(M.length===W.length){for(const ae of W)/^ *-+: *$/.test(ae)?te.align.push("right"):/^ *:-+: *$/.test(ae)?te.align.push("center"):/^ *:-+ *$/.test(ae)?te.align.push("left"):te.align.push(null);for(let ae=0;ae<M.length;ae++)te.header.push({text:M[ae],tokens:this.lexer.inline(M[ae]),header:!0,align:te.align[ae]});for(const ae of G)te.rows.push(m(ae,te.header.length).map((Te,Me)=>({text:Te,tokens:this.lexer.inline(Te),header:!1,align:te.align[Me]})));return te}}lheading(R){const P=this.rules.block.lheading.exec(R);if(P)return{type:"heading",raw:P[0],depth:P[2].charAt(0)==="="?1:2,text:P[1],tokens:this.lexer.inline(P[1])}}paragraph(R){const P=this.rules.block.paragraph.exec(R);if(P){const M=P[1].charAt(P[1].length-1)===`
`?P[1].slice(0,-1):P[1];return{type:"paragraph",raw:P[0],text:M,tokens:this.lexer.inline(M)}}}text(R){const P=this.rules.block.text.exec(R);if(P)return{type:"text",raw:P[0],text:P[0],tokens:this.lexer.inline(P[0])}}escape(R){const P=this.rules.inline.escape.exec(R);if(P)return{type:"escape",raw:P[0],text:d(P[1])}}tag(R){const P=this.rules.inline.tag.exec(R);if(P)return!this.lexer.state.inLink&&/^<a /i.test(P[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(P[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(P[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(P[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:P[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:P[0]}}link(R){const P=this.rules.inline.link.exec(R);if(P){const M=P[2].trim();if(!this.options.pedantic&&/^</.test(M)){if(!/>$/.test(M))return;const te=_(M.slice(0,-1),"\\");if((M.length-te.length)%2===0)return}else{const te=b(P[2],"()");if(te>-1){const Te=(P[0].indexOf("!")===0?5:4)+P[1].length+te;P[2]=P[2].substring(0,te),P[0]=P[0].substring(0,Te).trim(),P[3]=""}}let W=P[2],G="";if(this.options.pedantic){const te=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(W);te&&(W=te[1],G=te[3])}else G=P[3]?P[3].slice(1,-1):"";return W=W.trim(),/^</.test(W)&&(this.options.pedantic&&!/>$/.test(M)?W=W.slice(1):W=W.slice(1,-1)),v(P,{href:W&&W.replace(this.rules.inline.anyPunctuation,"$1"),title:G&&G.replace(this.rules.inline.anyPunctuation,"$1")},P[0],this.lexer)}}reflink(R,P){let M;if((M=this.rules.inline.reflink.exec(R))||(M=this.rules.inline.nolink.exec(R))){const W=(M[2]||M[1]).replace(/\s+/g," "),G=P[W.toLowerCase()];if(!G){const te=M[0].charAt(0);return{type:"text",raw:te,text:te}}return v(M,G,M[0],this.lexer)}}emStrong(R,P,M=""){let W=this.rules.inline.emStrongLDelim.exec(R);if(!W||W[3]&&M.match(/[\p{L}\p{N}]/u))return;if(!(W[1]||W[2]||"")||!M||this.rules.inline.punctuation.exec(M)){const te=[...W[0]].length-1;let ae,Te,Me=te,ot=0;const Et=W[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(Et.lastIndex=0,P=P.slice(-1*R.length+te);(W=Et.exec(P))!=null;){if(ae=W[1]||W[2]||W[3]||W[4]||W[5]||W[6],!ae)continue;if(Te=[...ae].length,W[3]||W[4]){Me+=Te;continue}else if((W[5]||W[6])&&te%3&&!((te+Te)%3)){ot+=Te;continue}if(Me-=Te,Me>0)continue;Te=Math.min(Te,Te+Me+ot);const Mt=[...W[0]][0].length,Xi=R.slice(0,te+W.index+Mt+Te);if(Math.min(te,Te)%2){const Ws=Xi.slice(1,-1);return{type:"em",raw:Xi,text:Ws,tokens:this.lexer.inlineTokens(Ws)}}const wi=Xi.slice(2,-2);return{type:"strong",raw:Xi,text:wi,tokens:this.lexer.inlineTokens(wi)}}}}codespan(R){const P=this.rules.inline.code.exec(R);if(P){let M=P[2].replace(/\n/g," ");const W=/[^ ]/.test(M),G=/^ /.test(M)&&/ $/.test(M);return W&&G&&(M=M.substring(1,M.length-1)),M=d(M,!0),{type:"codespan",raw:P[0],text:M}}}br(R){const P=this.rules.inline.br.exec(R);if(P)return{type:"br",raw:P[0]}}del(R){const P=this.rules.inline.del.exec(R);if(P)return{type:"del",raw:P[0],text:P[2],tokens:this.lexer.inlineTokens(P[2])}}autolink(R){const P=this.rules.inline.autolink.exec(R);if(P){let M,W;return P[2]==="@"?(M=d(P[1]),W="mailto:"+M):(M=d(P[1]),W=M),{type:"link",raw:P[0],text:M,href:W,tokens:[{type:"text",raw:M,text:M}]}}}url(R){let P;if(P=this.rules.inline.url.exec(R)){let M,W;if(P[2]==="@")M=d(P[0]),W="mailto:"+M;else{let G;do G=P[0],P[0]=this.rules.inline._backpedal.exec(P[0])?.[0]??"";while(G!==P[0]);M=d(P[0]),P[1]==="www."?W="http://"+P[0]:W=P[0]}return{type:"link",raw:P[0],text:M,href:W,tokens:[{type:"text",raw:M,text:M}]}}}inlineText(R){const P=this.rules.inline.text.exec(R);if(P){let M;return this.lexer.state.inRawBlock?M=P[0]:M=d(P[0]),{type:"text",raw:P[0],text:M}}}}const w=/^(?: *(?:\n|$))+/,x=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,k=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,E=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,N=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,z=/(?:[*+-]|\d{1,9}[.)])/,B=u(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,z).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),U=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Z=/^[^\n]+/,V=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Q=u(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",V).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),le=u(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,z).getRegex(),ge="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",_e=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,he=u("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",_e).replace("tag",ge).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Ne=u(U).replace("hr",E).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ge).getRegex(),Xt={blockquote:u(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Ne).getRegex(),code:x,def:Q,fences:k,heading:N,hr:E,html:he,lheading:B,list:le,newline:w,paragraph:Ne,table:f,text:Z},Lt=u("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",E).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ge).getRegex(),di={...Xt,table:Lt,paragraph:u(U).replace("hr",E).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Lt).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ge).getRegex()},kt={...Xt,html:u(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",_e).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:f,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:u(U).replace("hr",E).replace("heading",` *#{1,6} *[^
]`).replace("lheading",B).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Di=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,jo=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Bi=/^( {2,}|\\)\n(?!\s*$)/,yr=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,cd="\\p{P}\\p{S}",aS=u(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,cd).getRegex(),dd=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,Tb=u(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,cd).getRegex(),Kl=u("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,cd).getRegex(),Db=u("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,cd).getRegex(),Ib=u(/\\([punct])/,"gu").replace(/punct/g,cd).getRegex(),hd=u(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),ap=u(_e).replace("(?:-->|$)","-->").getRegex(),lp=u("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",ap).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),su=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,lS=u(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",su).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),cS=u(/^!?\[(label)\]\[(ref)\]/).replace("label",su).replace("ref",V).getRegex(),cp=u(/^!?\[(ref)\](?:\[\])?/).replace("ref",V).getRegex(),ou=u("reflink|nolink(?!\\()","g").replace("reflink",cS).replace("nolink",cp).getRegex(),Ha={_backpedal:f,anyPunctuation:Ib,autolink:hd,blockSkip:dd,br:Bi,code:jo,del:f,emStrongLDelim:Tb,emStrongRDelimAst:Kl,emStrongRDelimUnd:Db,escape:Di,link:lS,nolink:cp,punctuation:aS,reflink:cS,reflinkSearch:ou,tag:lp,text:yr,url:f},ud={...Ha,link:u(/^!?\[(label)\]\((.*?)\)/).replace("label",su).getRegex(),reflink:u(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",su).getRegex()},dp={...Ha,escape:u(Di).replace("])","~|])").getRegex(),url:u(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},dS={...dp,br:u(Bi).replace("{2,}","*").getRegex(),text:u(dp.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ru={normal:Xt,gfm:di,pedantic:kt},jl={normal:Ha,gfm:dp,breaks:dS,pedantic:ud};class fo{tokens;options;state;tokenizer;inlineQueue;constructor(R){this.tokens=[],this.tokens.links=Object.create(null),this.options=R||e.defaults,this.options.tokenizer=this.options.tokenizer||new C,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const P={block:ru.normal,inline:jl.normal};this.options.pedantic?(P.block=ru.pedantic,P.inline=jl.pedantic):this.options.gfm&&(P.block=ru.gfm,this.options.breaks?P.inline=jl.breaks:P.inline=jl.gfm),this.tokenizer.rules=P}static get rules(){return{block:ru,inline:jl}}static lex(R,P){return new fo(P).lex(R)}static lexInline(R,P){return new fo(P).inlineTokens(R)}lex(R){R=R.replace(/\r\n|\r/g,`
`),this.blockTokens(R,this.tokens);for(let P=0;P<this.inlineQueue.length;P++){const M=this.inlineQueue[P];this.inlineTokens(M.src,M.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(R,P=[],M=!1){this.options.pedantic?R=R.replace(/\t/g,"    ").replace(/^ +$/gm,""):R=R.replace(/^( *)(\t+)/gm,(ae,Te,Me)=>Te+"    ".repeat(Me.length));let W,G,te;for(;R;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(ae=>(W=ae.call({lexer:this},R,P))?(R=R.substring(W.raw.length),P.push(W),!0):!1))){if(W=this.tokenizer.space(R)){R=R.substring(W.raw.length),W.raw.length===1&&P.length>0?P[P.length-1].raw+=`
`:P.push(W);continue}if(W=this.tokenizer.code(R)){R=R.substring(W.raw.length),G=P[P.length-1],G&&(G.type==="paragraph"||G.type==="text")?(G.raw+=`
`+W.raw,G.text+=`
`+W.text,this.inlineQueue[this.inlineQueue.length-1].src=G.text):P.push(W);continue}if(W=this.tokenizer.fences(R)){R=R.substring(W.raw.length),P.push(W);continue}if(W=this.tokenizer.heading(R)){R=R.substring(W.raw.length),P.push(W);continue}if(W=this.tokenizer.hr(R)){R=R.substring(W.raw.length),P.push(W);continue}if(W=this.tokenizer.blockquote(R)){R=R.substring(W.raw.length),P.push(W);continue}if(W=this.tokenizer.list(R)){R=R.substring(W.raw.length),P.push(W);continue}if(W=this.tokenizer.html(R)){R=R.substring(W.raw.length),P.push(W);continue}if(W=this.tokenizer.def(R)){R=R.substring(W.raw.length),G=P[P.length-1],G&&(G.type==="paragraph"||G.type==="text")?(G.raw+=`
`+W.raw,G.text+=`
`+W.raw,this.inlineQueue[this.inlineQueue.length-1].src=G.text):this.tokens.links[W.tag]||(this.tokens.links[W.tag]={href:W.href,title:W.title});continue}if(W=this.tokenizer.table(R)){R=R.substring(W.raw.length),P.push(W);continue}if(W=this.tokenizer.lheading(R)){R=R.substring(W.raw.length),P.push(W);continue}if(te=R,this.options.extensions&&this.options.extensions.startBlock){let ae=1/0;const Te=R.slice(1);let Me;this.options.extensions.startBlock.forEach(ot=>{Me=ot.call({lexer:this},Te),typeof Me=="number"&&Me>=0&&(ae=Math.min(ae,Me))}),ae<1/0&&ae>=0&&(te=R.substring(0,ae+1))}if(this.state.top&&(W=this.tokenizer.paragraph(te))){G=P[P.length-1],M&&G?.type==="paragraph"?(G.raw+=`
`+W.raw,G.text+=`
`+W.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=G.text):P.push(W),M=te.length!==R.length,R=R.substring(W.raw.length);continue}if(W=this.tokenizer.text(R)){R=R.substring(W.raw.length),G=P[P.length-1],G&&G.type==="text"?(G.raw+=`
`+W.raw,G.text+=`
`+W.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=G.text):P.push(W);continue}if(R){const ae="Infinite loop on byte: "+R.charCodeAt(0);if(this.options.silent){console.error(ae);break}else throw new Error(ae)}}return this.state.top=!0,P}inline(R,P=[]){return this.inlineQueue.push({src:R,tokens:P}),P}inlineTokens(R,P=[]){let M,W,G,te=R,ae,Te,Me;if(this.tokens.links){const ot=Object.keys(this.tokens.links);if(ot.length>0)for(;(ae=this.tokenizer.rules.inline.reflinkSearch.exec(te))!=null;)ot.includes(ae[0].slice(ae[0].lastIndexOf("[")+1,-1))&&(te=te.slice(0,ae.index)+"["+"a".repeat(ae[0].length-2)+"]"+te.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(ae=this.tokenizer.rules.inline.blockSkip.exec(te))!=null;)te=te.slice(0,ae.index)+"["+"a".repeat(ae[0].length-2)+"]"+te.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(ae=this.tokenizer.rules.inline.anyPunctuation.exec(te))!=null;)te=te.slice(0,ae.index)+"++"+te.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;R;)if(Te||(Me=""),Te=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(ot=>(M=ot.call({lexer:this},R,P))?(R=R.substring(M.raw.length),P.push(M),!0):!1))){if(M=this.tokenizer.escape(R)){R=R.substring(M.raw.length),P.push(M);continue}if(M=this.tokenizer.tag(R)){R=R.substring(M.raw.length),W=P[P.length-1],W&&M.type==="text"&&W.type==="text"?(W.raw+=M.raw,W.text+=M.text):P.push(M);continue}if(M=this.tokenizer.link(R)){R=R.substring(M.raw.length),P.push(M);continue}if(M=this.tokenizer.reflink(R,this.tokens.links)){R=R.substring(M.raw.length),W=P[P.length-1],W&&M.type==="text"&&W.type==="text"?(W.raw+=M.raw,W.text+=M.text):P.push(M);continue}if(M=this.tokenizer.emStrong(R,te,Me)){R=R.substring(M.raw.length),P.push(M);continue}if(M=this.tokenizer.codespan(R)){R=R.substring(M.raw.length),P.push(M);continue}if(M=this.tokenizer.br(R)){R=R.substring(M.raw.length),P.push(M);continue}if(M=this.tokenizer.del(R)){R=R.substring(M.raw.length),P.push(M);continue}if(M=this.tokenizer.autolink(R)){R=R.substring(M.raw.length),P.push(M);continue}if(!this.state.inLink&&(M=this.tokenizer.url(R))){R=R.substring(M.raw.length),P.push(M);continue}if(G=R,this.options.extensions&&this.options.extensions.startInline){let ot=1/0;const Et=R.slice(1);let Mt;this.options.extensions.startInline.forEach(Xi=>{Mt=Xi.call({lexer:this},Et),typeof Mt=="number"&&Mt>=0&&(ot=Math.min(ot,Mt))}),ot<1/0&&ot>=0&&(G=R.substring(0,ot+1))}if(M=this.tokenizer.inlineText(G)){R=R.substring(M.raw.length),M.raw.slice(-1)!=="_"&&(Me=M.raw.slice(-1)),Te=!0,W=P[P.length-1],W&&W.type==="text"?(W.raw+=M.raw,W.text+=M.text):P.push(M);continue}if(R){const ot="Infinite loop on byte: "+R.charCodeAt(0);if(this.options.silent){console.error(ot);break}else throw new Error(ot)}}return P}}class za{options;parser;constructor(R){this.options=R||e.defaults}space(R){return""}code({text:R,lang:P,escaped:M}){const W=(P||"").match(/^\S*/)?.[0],G=R.replace(/\n$/,"")+`
`;return W?'<pre><code class="language-'+d(W)+'">'+(M?G:d(G,!0))+`</code></pre>
`:"<pre><code>"+(M?G:d(G,!0))+`</code></pre>
`}blockquote({tokens:R}){return`<blockquote>
${this.parser.parse(R)}</blockquote>
`}html({text:R}){return R}heading({tokens:R,depth:P}){return`<h${P}>${this.parser.parseInline(R)}</h${P}>
`}hr(R){return`<hr>
`}list(R){const P=R.ordered,M=R.start;let W="";for(let ae=0;ae<R.items.length;ae++){const Te=R.items[ae];W+=this.listitem(Te)}const G=P?"ol":"ul",te=P&&M!==1?' start="'+M+'"':"";return"<"+G+te+`>
`+W+"</"+G+`>
`}listitem(R){let P="";if(R.task){const M=this.checkbox({checked:!!R.checked});R.loose?R.tokens.length>0&&R.tokens[0].type==="paragraph"?(R.tokens[0].text=M+" "+R.tokens[0].text,R.tokens[0].tokens&&R.tokens[0].tokens.length>0&&R.tokens[0].tokens[0].type==="text"&&(R.tokens[0].tokens[0].text=M+" "+R.tokens[0].tokens[0].text)):R.tokens.unshift({type:"text",raw:M+" ",text:M+" "}):P+=M+" "}return P+=this.parser.parse(R.tokens,!!R.loose),`<li>${P}</li>
`}checkbox({checked:R}){return"<input "+(R?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:R}){return`<p>${this.parser.parseInline(R)}</p>
`}table(R){let P="",M="";for(let G=0;G<R.header.length;G++)M+=this.tablecell(R.header[G]);P+=this.tablerow({text:M});let W="";for(let G=0;G<R.rows.length;G++){const te=R.rows[G];M="";for(let ae=0;ae<te.length;ae++)M+=this.tablecell(te[ae]);W+=this.tablerow({text:M})}return W&&(W=`<tbody>${W}</tbody>`),`<table>
<thead>
`+P+`</thead>
`+W+`</table>
`}tablerow({text:R}){return`<tr>
${R}</tr>
`}tablecell(R){const P=this.parser.parseInline(R.tokens),M=R.header?"th":"td";return(R.align?`<${M} align="${R.align}">`:`<${M}>`)+P+`</${M}>
`}strong({tokens:R}){return`<strong>${this.parser.parseInline(R)}</strong>`}em({tokens:R}){return`<em>${this.parser.parseInline(R)}</em>`}codespan({text:R}){return`<code>${R}</code>`}br(R){return"<br>"}del({tokens:R}){return`<del>${this.parser.parseInline(R)}</del>`}link({href:R,title:P,tokens:M}){const W=this.parser.parseInline(M),G=g(R);if(G===null)return W;R=G;let te='<a href="'+R+'"';return P&&(te+=' title="'+P+'"'),te+=">"+W+"</a>",te}image({href:R,title:P,text:M}){const W=g(R);if(W===null)return M;R=W;let G=`<img src="${R}" alt="${M}"`;return P&&(G+=` title="${P}"`),G+=">",G}text(R){return"tokens"in R&&R.tokens?this.parser.parseInline(R.tokens):R.text}}class ql{strong({text:R}){return R}em({text:R}){return R}codespan({text:R}){return R}del({text:R}){return R}html({text:R}){return R}text({text:R}){return R}link({text:R}){return""+R}image({text:R}){return""+R}br(){return""}}class ln{options;renderer;textRenderer;constructor(R){this.options=R||e.defaults,this.options.renderer=this.options.renderer||new za,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new ql}static parse(R,P){return new ln(P).parse(R)}static parseInline(R,P){return new ln(P).parseInline(R)}parse(R,P=!0){let M="";for(let W=0;W<R.length;W++){const G=R[W];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[G.type]){const ae=G,Te=this.options.extensions.renderers[ae.type].call({parser:this},ae);if(Te!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(ae.type)){M+=Te||"";continue}}const te=G;switch(te.type){case"space":{M+=this.renderer.space(te);continue}case"hr":{M+=this.renderer.hr(te);continue}case"heading":{M+=this.renderer.heading(te);continue}case"code":{M+=this.renderer.code(te);continue}case"table":{M+=this.renderer.table(te);continue}case"blockquote":{M+=this.renderer.blockquote(te);continue}case"list":{M+=this.renderer.list(te);continue}case"html":{M+=this.renderer.html(te);continue}case"paragraph":{M+=this.renderer.paragraph(te);continue}case"text":{let ae=te,Te=this.renderer.text(ae);for(;W+1<R.length&&R[W+1].type==="text";)ae=R[++W],Te+=`
`+this.renderer.text(ae);P?M+=this.renderer.paragraph({type:"paragraph",raw:Te,text:Te,tokens:[{type:"text",raw:Te,text:Te}]}):M+=Te;continue}default:{const ae='Token with "'+te.type+'" type was not found.';if(this.options.silent)return console.error(ae),"";throw new Error(ae)}}}return M}parseInline(R,P){P=P||this.renderer;let M="";for(let W=0;W<R.length;W++){const G=R[W];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[G.type]){const ae=this.options.extensions.renderers[G.type].call({parser:this},G);if(ae!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(G.type)){M+=ae||"";continue}}const te=G;switch(te.type){case"escape":{M+=P.text(te);break}case"html":{M+=P.html(te);break}case"link":{M+=P.link(te);break}case"image":{M+=P.image(te);break}case"strong":{M+=P.strong(te);break}case"em":{M+=P.em(te);break}case"codespan":{M+=P.codespan(te);break}case"br":{M+=P.br(te);break}case"del":{M+=P.del(te);break}case"text":{M+=P.text(te);break}default:{const ae='Token with "'+te.type+'" type was not found.';if(this.options.silent)return console.error(ae),"";throw new Error(ae)}}}return M}}class wr{options;constructor(R){this.options=R||e.defaults}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(R){return R}postprocess(R){return R}processAllTokens(R){return R}}class hp{defaults=t();options=this.setOptions;parse=this.parseMarkdown(fo.lex,ln.parse);parseInline=this.parseMarkdown(fo.lexInline,ln.parseInline);Parser=ln;Renderer=za;TextRenderer=ql;Lexer=fo;Tokenizer=C;Hooks=wr;constructor(...R){this.use(...R)}walkTokens(R,P){let M=[];for(const W of R)switch(M=M.concat(P.call(this,W)),W.type){case"table":{const G=W;for(const te of G.header)M=M.concat(this.walkTokens(te.tokens,P));for(const te of G.rows)for(const ae of te)M=M.concat(this.walkTokens(ae.tokens,P));break}case"list":{const G=W;M=M.concat(this.walkTokens(G.items,P));break}default:{const G=W;this.defaults.extensions?.childTokens?.[G.type]?this.defaults.extensions.childTokens[G.type].forEach(te=>{const ae=G[te].flat(1/0);M=M.concat(this.walkTokens(ae,P))}):G.tokens&&(M=M.concat(this.walkTokens(G.tokens,P)))}}return M}use(...R){const P=this.defaults.extensions||{renderers:{},childTokens:{}};return R.forEach(M=>{const W={...M};if(W.async=this.defaults.async||W.async||!1,M.extensions&&(M.extensions.forEach(G=>{if(!G.name)throw new Error("extension name required");if("renderer"in G){const te=P.renderers[G.name];te?P.renderers[G.name]=function(...ae){let Te=G.renderer.apply(this,ae);return Te===!1&&(Te=te.apply(this,ae)),Te}:P.renderers[G.name]=G.renderer}if("tokenizer"in G){if(!G.level||G.level!=="block"&&G.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const te=P[G.level];te?te.unshift(G.tokenizer):P[G.level]=[G.tokenizer],G.start&&(G.level==="block"?P.startBlock?P.startBlock.push(G.start):P.startBlock=[G.start]:G.level==="inline"&&(P.startInline?P.startInline.push(G.start):P.startInline=[G.start]))}"childTokens"in G&&G.childTokens&&(P.childTokens[G.name]=G.childTokens)}),W.extensions=P),M.renderer){const G=this.defaults.renderer||new za(this.defaults);for(const te in M.renderer){if(!(te in G))throw new Error(`renderer '${te}' does not exist`);if(["options","parser"].includes(te))continue;const ae=te,Te=M.renderer[ae],Me=G[ae];G[ae]=(...ot)=>{let Et=Te.apply(G,ot);return Et===!1&&(Et=Me.apply(G,ot)),Et||""}}W.renderer=G}if(M.tokenizer){const G=this.defaults.tokenizer||new C(this.defaults);for(const te in M.tokenizer){if(!(te in G))throw new Error(`tokenizer '${te}' does not exist`);if(["options","rules","lexer"].includes(te))continue;const ae=te,Te=M.tokenizer[ae],Me=G[ae];G[ae]=(...ot)=>{let Et=Te.apply(G,ot);return Et===!1&&(Et=Me.apply(G,ot)),Et}}W.tokenizer=G}if(M.hooks){const G=this.defaults.hooks||new wr;for(const te in M.hooks){if(!(te in G))throw new Error(`hook '${te}' does not exist`);if(te==="options")continue;const ae=te,Te=M.hooks[ae],Me=G[ae];wr.passThroughHooks.has(te)?G[ae]=ot=>{if(this.defaults.async)return Promise.resolve(Te.call(G,ot)).then(Mt=>Me.call(G,Mt));const Et=Te.call(G,ot);return Me.call(G,Et)}:G[ae]=(...ot)=>{let Et=Te.apply(G,ot);return Et===!1&&(Et=Me.apply(G,ot)),Et}}W.hooks=G}if(M.walkTokens){const G=this.defaults.walkTokens,te=M.walkTokens;W.walkTokens=function(ae){let Te=[];return Te.push(te.call(this,ae)),G&&(Te=Te.concat(G.call(this,ae))),Te}}this.defaults={...this.defaults,...W}}),this}setOptions(R){return this.defaults={...this.defaults,...R},this}lexer(R,P){return fo.lex(R,P??this.defaults)}parser(R,P){return ln.parse(R,P??this.defaults)}parseMarkdown(R,P){return(W,G)=>{const te={...G},ae={...this.defaults,...te},Te=this.onError(!!ae.silent,!!ae.async);if(this.defaults.async===!0&&te.async===!1)return Te(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof W>"u"||W===null)return Te(new Error("marked(): input parameter is undefined or null"));if(typeof W!="string")return Te(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(W)+", string expected"));if(ae.hooks&&(ae.hooks.options=ae),ae.async)return Promise.resolve(ae.hooks?ae.hooks.preprocess(W):W).then(Me=>R(Me,ae)).then(Me=>ae.hooks?ae.hooks.processAllTokens(Me):Me).then(Me=>ae.walkTokens?Promise.all(this.walkTokens(Me,ae.walkTokens)).then(()=>Me):Me).then(Me=>P(Me,ae)).then(Me=>ae.hooks?ae.hooks.postprocess(Me):Me).catch(Te);try{ae.hooks&&(W=ae.hooks.preprocess(W));let Me=R(W,ae);ae.hooks&&(Me=ae.hooks.processAllTokens(Me)),ae.walkTokens&&this.walkTokens(Me,ae.walkTokens);let ot=P(Me,ae);return ae.hooks&&(ot=ae.hooks.postprocess(ot)),ot}catch(Me){return Te(Me)}}}onError(R,P){return M=>{if(M.message+=`
Please report this to https://github.com/markedjs/marked.`,R){const W="<p>An error occurred:</p><pre>"+d(M.message+"",!0)+"</pre>";return P?Promise.resolve(W):W}if(P)return Promise.reject(M);throw M}}}const Xr=new hp;function ii(ct,R){return Xr.parse(ct,R)}ii.options=ii.setOptions=function(ct){return Xr.setOptions(ct),ii.defaults=Xr.defaults,i(ii.defaults),ii},ii.getDefaults=t,ii.defaults=e.defaults,ii.use=function(...ct){return Xr.use(...ct),ii.defaults=Xr.defaults,i(ii.defaults),ii},ii.walkTokens=function(ct,R){return Xr.walkTokens(ct,R)},ii.parseInline=Xr.parseInline,ii.Parser=ln,ii.parser=ln.parse,ii.Renderer=za,ii.TextRenderer=ql,ii.Lexer=fo,ii.lexer=fo.lex,ii.Tokenizer=C,ii.Hooks=wr,ii.parse=ii;const au=ii.options,OD=ii.setOptions,FD=ii.use,_n=ii.walkTokens,gd=ii.parseInline,BD=ii,hS=ln.parse,Nb=fo.lex;e.Hooks=wr,e.Lexer=fo,e.Marked=hp,e.Parser=ln,e.Renderer=za,e.TextRenderer=ql,e.Tokenizer=C,e.getDefaults=t,e.lexer=Nb,e.marked=ii,e.options=au,e.parse=BD,e.parseInline=gd,e.parser=hS,e.setOptions=OD,e.use=FD,e.walkTokens=_n})})();Bn.Hooks||exports.Hooks;Bn.Lexer||exports.Lexer;Bn.Marked||exports.Marked;Bn.Parser||exports.Parser;var MG=Bn.Renderer||exports.Renderer;Bn.TextRenderer||exports.TextRenderer;Bn.Tokenizer||exports.Tokenizer;var kre=Bn.defaults||exports.defaults;Bn.getDefaults||exports.getDefaults;var OT=Bn.lexer||exports.lexer;Bn.marked||exports.marked;Bn.options||exports.options;var OG=Bn.parse||exports.parse;Bn.parseInline||exports.parseInline;var Ere=Bn.parser||exports.parser;Bn.setOptions||exports.setOptions;Bn.use||exports.use;Bn.walkTokens||exports.walkTokens;function Tre(o){return JSON.stringify(o,Dre)}function iA(o){let e=JSON.parse(o);return e=nA(e),e}function Dre(o,e){return e instanceof RegExp?{$mid:2,source:e.source,flags:e.flags}:e}function nA(o,e=0){if(!o||e>200)return o;if(typeof o=="object"){switch(o.$mid){case 1:return ye.revive(o);case 2:return new RegExp(o.source,o.flags);case 17:return new Date(o.source)}if(o instanceof vT||o instanceof Uint8Array)return o;if(Array.isArray(o))for(let t=0;t<o.length;++t)o[t]=nA(o[t],e+1);else for(const t in o)Object.hasOwnProperty.call(o,t)&&(o[t]=nA(o[t],e+1))}return o}const DI=Object.freeze({image:({href:o,title:e,text:t})=>{let i=[],n=[];return o&&({href:o,dimensions:i}=Lre(o),n.push(`src="${IS(o)}"`)),t&&n.push(`alt="${IS(t)}"`),e&&n.push(`title="${IS(e)}"`),i.length&&(n=n.concat(i)),"<img "+n.join(" ")+">"},paragraph({tokens:o}){return`<p>${this.parser.parseInline(o)}</p>`},link({href:o,title:e,tokens:t}){let i=this.parser.parseInline(t);return typeof o!="string"?"":(o===i&&(i=TI(i)),e=typeof e=="string"?IS(TI(e)):"",o=TI(o),o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),`<a href="${o}" title="${e||o}" draggable="false">${i}</a>`)}});function FT(o,e={},t={}){const i=new $;let n=!1;const s=C5(e),r=function(m){let _;try{_=iA(decodeURIComponent(m))}catch{}return _?(_=q6(_,b=>{if(o.uris&&o.uris[b])return ye.revive(o.uris[b])}),encodeURIComponent(JSON.stringify(_))):m},a=function(m,_){const b=o.uris&&o.uris[m];let v=ye.revive(b);return _?m.startsWith(Oe.data+":")?m:(v||(v=ye.parse(m)),nT.uriToBrowserUri(v).toString(!0)):!v||ye.parse(m).toString()===v.toString()?m:(v.query&&(v=v.with({query:r(v.query)})),v.toString())},l=new MG;l.image=DI.image,l.link=DI.link,l.paragraph=DI.paragraph;const c=[],d=[];if(e.codeBlockRendererSync?l.code=({text:m,lang:_})=>{const b=tA.nextId(),v=e.codeBlockRendererSync(vH(_),m);return d.push([b,v]),`<div class="code" data-code="${b}">${Av(m)}</div>`}:e.codeBlockRenderer&&(l.code=({text:m,lang:_})=>{const b=tA.nextId(),v=e.codeBlockRenderer(vH(_),m);return c.push(v.then(y=>[b,y])),`<div class="code" data-code="${b}">${Av(m)}</div>`}),e.actionHandler){const m=function(v){let y=v.target;if(!(y.tagName!=="A"&&(y=y.parentElement,!y||y.tagName!=="A")))try{let C=y.dataset.href;C&&(o.baseUri&&(C=II(ye.from(o.baseUri),C)),e.actionHandler.callback(C,v))}catch(C){Ae(C)}finally{v.preventDefault()}},_=e.actionHandler.disposables.add(new et(s,"click")),b=e.actionHandler.disposables.add(new et(s,"auxclick"));e.actionHandler.disposables.add(se.any(_.event,b.event)(v=>{const y=new Mr(xe(s),v);!y.leftButton&&!y.middleButton||m(y)})),e.actionHandler.disposables.add(H(s,"keydown",v=>{const y=new Pt(v);!y.equals(10)&&!y.equals(3)||m(y)}))}o.supportHtml||(l.html=({text:m})=>e.sanitizerOptions?.replaceWithPlaintext?Av(m):(o.isTrusted?m.match(/^(<span[^>]+>)|(<\/\s*span>)$/):void 0)?m:""),t.renderer=l;let h=o.value??"";h.length>1e5&&(h=`${h.substr(0,1e5)}…`),o.supportThemeIcons&&(h=gre(h));let u;if(e.fillInIncompleteTokens){const m={...kre,...t},_=OT(h,m),b=zre(_);u=Ere(b,m)}else u=OG(h,{...t,async:!1});o.supportThemeIcons&&(u=nh(u).map(_=>typeof _=="string"?_:_.outerHTML).join(""));const f=new DOMParser().parseFromString(sA({isTrusted:o.isTrusted,...e.sanitizerOptions},u),"text/html");if(f.body.querySelectorAll("img, audio, video, source").forEach(m=>{const _=m.getAttribute("src");if(_){let b=_;try{o.baseUri&&(b=II(ye.from(o.baseUri),b))}catch{}if(m.setAttribute("src",a(b,!0)),e.remoteImageIsAllowed){const v=ye.parse(b);v.scheme!==Oe.file&&v.scheme!==Oe.data&&!e.remoteImageIsAllowed(v)&&m.replaceWith(ie("",void 0,m.outerHTML))}}}),f.body.querySelectorAll("a").forEach(m=>{const _=m.getAttribute("href");if(m.setAttribute("href",""),!_||/^data:|javascript:/i.test(_)||/^command:/i.test(_)&&!o.isTrusted||/^command:(\/\/\/)?_workbench\.downloadResource/i.test(_))m.replaceWith(...m.childNodes);else{let b=a(_,!1);o.baseUri&&(b=II(ye.from(o.baseUri),_)),m.dataset.href=b}}),s.innerHTML=sA({isTrusted:o.isTrusted,...e.sanitizerOptions},f.body.innerHTML),c.length>0)Promise.all(c).then(m=>{if(n)return;const _=new Map(m),b=s.querySelectorAll("div[data-code]");for(const v of b){const y=_.get(v.dataset.code??"");y&&pn(v,y)}e.asyncRenderCallback?.()});else if(d.length>0){const m=new Map(d),_=s.querySelectorAll("div[data-code]");for(const b of _){const v=m.get(b.dataset.code??"");v&&pn(b,v)}}if(e.asyncRenderCallback)for(const m of s.getElementsByTagName("img")){const _=i.add(H(m,"load",()=>{_.dispose(),e.asyncRenderCallback()}))}return{element:s,dispose:()=>{n=!0,i.dispose()}}}function vH(o){if(!o)return"";const e=o.split(/[\s+|:|,|\{|\?]/,1);return e.length?e[0]:o}function II(o,e){return/^\w[\w\d+.-]*:/.test(e)?e:o.path.endsWith("/")?mH(o,e).toString():mH(MT(o),e).toString()}const Ire=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];function sA(o,e){const{config:t,allowedSchemes:i}=Rre(o),n=new $;n.add(CH("uponSanitizeAttribute",(s,r)=>{if(r.attrName==="style"||r.attrName==="class"){if(s.tagName==="SPAN"){if(r.attrName==="style"){r.keepAttr=/^(color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(background-color\:(#[0-9a-fA-F]+|var\(--vscode(-[a-zA-Z]+)+\));)?(border-radius:[0-9]+px;)?$/.test(r.attrValue);return}else if(r.attrName==="class"){r.keepAttr=/^codicon codicon-[a-z\-]+( codicon-modifier-[a-z\-]+)?$/.test(r.attrValue);return}}r.keepAttr=!1;return}else if(s.tagName==="INPUT"&&s.attributes.getNamedItem("type")?.value==="checkbox"){if(r.attrName==="type"&&r.attrValue==="checkbox"||r.attrName==="disabled"||r.attrName==="checked"){r.keepAttr=!0;return}r.keepAttr=!1}})),n.add(CH("uponSanitizeElement",(s,r)=>{if(r.tagName==="input"&&(s.attributes.getNamedItem("type")?.value==="checkbox"?s.setAttribute("disabled",""):o.replaceWithPlaintext||s.remove()),o.replaceWithPlaintext&&!r.allowedTags[r.tagName]&&r.tagName!=="body"&&s.parentElement){let a,l;if(r.tagName==="#comment")a=`<!--${s.textContent}-->`;else{const u=Ire.includes(r.tagName),g=s.attributes.length?" "+Array.from(s.attributes).map(f=>`${f.name}="${f.value}"`).join(" "):"";a=`<${r.tagName}${g}>`,u||(l=`</${r.tagName}>`)}const c=document.createDocumentFragment(),d=s.parentElement.ownerDocument.createTextNode(a);c.appendChild(d);const h=l?s.parentElement.ownerDocument.createTextNode(l):void 0;for(;s.firstChild;)c.appendChild(s.firstChild);h&&c.appendChild(h),s.nodeType===Node.COMMENT_NODE?s.parentElement.insertBefore(c,s):s.parentElement.replaceChild(c,s)}})),n.add(cee(i));try{return zz(e,{...t,RETURN_TRUSTED_TYPE:!0})}finally{n.dispose()}}const Nre=["align","autoplay","alt","checked","class","colspan","controls","data-code","data-href","disabled","draggable","height","href","loop","muted","playsinline","poster","rowspan","src","style","target","title","type","width","start"];function Rre(o){const e=[Oe.http,Oe.https,Oe.mailto,Oe.data,Oe.file,Oe.vscodeFileResource,Oe.vscodeRemote,Oe.vscodeRemoteResource];return o.isTrusted&&e.push(Oe.command),{config:{ALLOWED_TAGS:o.allowedTags??[...dee],ALLOWED_ATTR:Nre,ALLOW_UNKNOWN_PROTOCOLS:!0},allowedSchemes:e}}function Pre(o){return typeof o=="string"?o:Are(o)}function Are(o,e){let t=o.value??"";t.length>1e5&&(t=`${t.substr(0,1e5)}…`);const i=OG(t,{async:!1,renderer:Fre.value}).replace(/&(#\d+|[a-zA-Z]+);/g,n=>Mre.get(n)??n);return sA({isTrusted:!1},i).toString()}const Mre=new Map([["&quot;",'"'],["&nbsp;"," "],["&amp;","&"],["&#39;","'"],["&lt;","<"],["&gt;",">"]]);function Ore(){const o=new MG;return o.code=({text:e})=>e,o.blockquote=({text:e})=>e+`
`,o.html=e=>"",o.heading=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.hr=()=>"",o.list=function({items:e}){return e.map(t=>this.listitem(t)).join(`
`)+`
`},o.listitem=({text:e})=>e+`
`,o.paragraph=function({tokens:e}){return this.parser.parseInline(e)+`
`},o.table=function({header:e,rows:t}){return e.map(i=>this.tablecell(i)).join(" ")+`
`+t.map(i=>i.map(n=>this.tablecell(n)).join(" ")).join(`
`)+`
`},o.tablerow=({text:e})=>e,o.tablecell=function({tokens:e}){return this.parser.parseInline(e)},o.strong=({text:e})=>e,o.em=({text:e})=>e,o.codespan=({text:e})=>e,o.br=e=>`
`,o.del=({text:e})=>e,o.image=e=>"",o.text=({text:e})=>e,o.link=({text:e})=>e,o}const Fre=new Da(o=>Ore());function tx(o){let e="";return o.forEach(t=>{e+=t.raw}),e}function FG(o){if(o.tokens)for(let e=o.tokens.length-1;e>=0;e--){const t=o.tokens[e];if(t.type==="text"){const i=t.raw.split(`
`),n=i[i.length-1];if(n.includes("`"))return Gre(o);if(n.includes("**"))return Yre(o);if(n.match(/\*\w/))return $re(o);if(n.match(/(^|\s)__\w/))return Xre(o);if(n.match(/(^|\s)_\w/))return Kre(o);if(Bre(n)||Wre(n)&&o.tokens.slice(0,e).some(s=>s.type==="text"&&s.raw.match(/\[[^\]]*$/))){const s=o.tokens.slice(e+1);return s[0]?.type==="link"&&s[1]?.type==="text"&&s[1].raw.match(/^ *"[^"]*$/)||n.match(/^[^"]* +"[^"]*$/)?qre(o):jre(o)}else if(n.match(/(^|\s)\[\w*/))return Zre(o)}}}function Bre(o){return!!o.match(/(^|\s)\[.*\]\(\w*/)}function Wre(o){return!!o.match(/^[^\[]*\]\([^\)]*$/)}function Vre(o){const e=o.items[o.items.length-1],t=e.tokens?e.tokens[e.tokens.length-1]:void 0;let i;if(t?.type==="text"&&!("inRawBlock"in e)&&(i=FG(t)),!i||i.type!=="paragraph")return;const n=tx(o.items.slice(0,-1)),s=e.raw.match(/^(\s*(-|\d+\.|\*) +)/)?.[0];if(!s)return;const r=s+tx(e.tokens.slice(0,-1))+i.raw,a=OT(n+r)[0];if(a.type==="list")return a}const Hre=3;function zre(o){for(let e=0;e<Hre;e++){const t=Ure(o);if(t)o=t;else break}return o}function Ure(o){let e,t;for(e=0;e<o.length;e++){const i=o[e];if(i.type==="paragraph"&&i.raw.match(/(\n|^)\|/)){t=Qre(o.slice(e));break}if(e===o.length-1&&i.type==="list"){const n=Vre(i);if(n){t=[n];break}}if(e===o.length-1&&i.type==="paragraph"){const n=FG(i);if(n){t=[n];break}}}if(t){const i=[...o.slice(0,e),...t];return i.links=o.links,i}return null}function Gre(o){return Zh(o,"`")}function $re(o){return Zh(o,"*")}function Kre(o){return Zh(o,"_")}function jre(o){return Zh(o,")")}function qre(o){return Zh(o,'")')}function Zre(o){return Zh(o,"](https://microsoft.com)")}function Yre(o){return Zh(o,"**")}function Xre(o){return Zh(o,"__")}function Zh(o,e){const t=tx(Array.isArray(o)?o:[o]);return OT(t+e)[0]}function Qre(o){const e=tx(o),t=e.split(`
`);let i,n=!1;for(let s=0;s<t.length;s++){const r=t[s].trim();if(typeof i>"u"&&r.match(/^\s*\|/)){const a=r.match(/(\|[^\|]+)(?=\||$)/g);a&&(i=a.length)}else if(typeof i=="number")if(r.match(/^\s*\|/)){if(s!==t.length-1)return;n=!0}else return}if(typeof i=="number"&&i>0){const s=n?t.slice(0,-1).join(`
`):e,r=!!s.match(/\|\s*$/),a=s+(r?"":"|")+`
|${" --- |".repeat(i)}`;return OT(a)}}function CH(o,e){return Uz(o,e),ve(()=>Gz(o))}const hc=class hc{static createEmpty(e,t){const i=hc.defaultTokenMetadata,n=new Uint32Array(2);return n[0]=e.length,n[1]=i,new hc(n,e,t)}static createFromTextAndMetadata(e,t){let i=0,n="";const s=new Array;for(const{text:r,metadata:a}of e)s.push(i+r.length,a),i+=r.length,n+=r;return new hc(new Uint32Array(s),n,t)}constructor(e,t,i){this._lineTokensBrand=void 0,this._tokens=e,this._tokensCount=this._tokens.length>>>1,this._text=t,this.languageIdCodec=i}equals(e){return e instanceof hc?this.slicedEquals(e,0,this._tokensCount):!1}slicedEquals(e,t,i){if(this._text!==e._text||this._tokensCount!==e._tokensCount)return!1;const n=t<<1,s=n+(i<<1);for(let r=n;r<s;r++)if(this._tokens[r]!==e._tokens[r])return!1;return!0}getLineContent(){return this._text}getCount(){return this._tokensCount}getStartOffset(e){return e>0?this._tokens[e-1<<1]:0}getMetadata(e){return this._tokens[(e<<1)+1]}getLanguageId(e){const t=this._tokens[(e<<1)+1],i=ks.getLanguageId(t);return this.languageIdCodec.decodeLanguageId(i)}getStandardTokenType(e){const t=this._tokens[(e<<1)+1];return ks.getTokenType(t)}getForeground(e){const t=this._tokens[(e<<1)+1];return ks.getForeground(t)}getClassName(e){const t=this._tokens[(e<<1)+1];return ks.getClassNameFromMetadata(t)}getInlineStyle(e,t){const i=this._tokens[(e<<1)+1];return ks.getInlineStyleFromMetadata(i,t)}getPresentation(e){const t=this._tokens[(e<<1)+1];return ks.getPresentationFromMetadata(t)}getEndOffset(e){return this._tokens[e<<1]}findTokenIndexAtOffset(e){return hc.findIndexInTokensArray(this._tokens,e)}inflate(){return this}sliceAndInflate(e,t,i){return new D5(this,e,t,i)}static convertToEndOffset(e,t){const n=(e.length>>>1)-1;for(let s=0;s<n;s++)e[s<<1]=e[s+1<<1];e[n<<1]=t}static findIndexInTokensArray(e,t){if(e.length<=2)return 0;let i=0,n=(e.length>>>1)-1;for(;i<n;){const s=i+Math.floor((n-i)/2),r=e[s<<1];if(r===t)return s+1;r<t?i=s+1:r>t&&(n=s)}return i}withInserted(e){if(e.length===0)return this;let t=0,i=0,n="";const s=new Array;let r=0;for(;;){const a=t<this._tokensCount?this._tokens[t<<1]:-1,l=i<e.length?e[i]:null;if(a!==-1&&(l===null||a<=l.offset)){n+=this._text.substring(r,a);const c=this._tokens[(t<<1)+1];s.push(n.length,c),t++,r=a}else if(l){if(l.offset>r){n+=this._text.substring(r,l.offset);const c=this._tokens[(t<<1)+1];s.push(n.length,c),r=l.offset}n+=l.text,s.push(n.length,l.tokenMetadata),i++}else break}return new hc(new Uint32Array(s),n,this.languageIdCodec)}getTokenText(e){const t=this.getStartOffset(e),i=this.getEndOffset(e);return this._text.substring(t,i)}forEach(e){const t=this.getCount();for(let i=0;i<t;i++)e(i)}};hc.defaultTokenMetadata=(32768|2<<24)>>>0;let an=hc;class D5{constructor(e,t,i,n){this._source=e,this._startOffset=t,this._endOffset=i,this._deltaOffset=n,this._firstTokenIndex=e.findTokenIndexAtOffset(t),this.languageIdCodec=e.languageIdCodec,this._tokensCount=0;for(let s=this._firstTokenIndex,r=e.getCount();s<r&&!(e.getStartOffset(s)>=i);s++)this._tokensCount++}getMetadata(e){return this._source.getMetadata(this._firstTokenIndex+e)}getLanguageId(e){return this._source.getLanguageId(this._firstTokenIndex+e)}getLineContent(){return this._source.getLineContent().substring(this._startOffset,this._endOffset)}equals(e){return e instanceof D5?this._startOffset===e._startOffset&&this._endOffset===e._endOffset&&this._deltaOffset===e._deltaOffset&&this._source.slicedEquals(e._source,this._firstTokenIndex,this._tokensCount):!1}getCount(){return this._tokensCount}getStandardTokenType(e){return this._source.getStandardTokenType(this._firstTokenIndex+e)}getForeground(e){return this._source.getForeground(this._firstTokenIndex+e)}getEndOffset(e){const t=this._source.getEndOffset(this._firstTokenIndex+e);return Math.min(this._endOffset,t)-this._startOffset+this._deltaOffset}getClassName(e){return this._source.getClassName(this._firstTokenIndex+e)}getInlineStyle(e,t){return this._source.getInlineStyle(this._firstTokenIndex+e,t)}getPresentation(e){return this._source.getPresentation(this._firstTokenIndex+e)}findTokenIndexAtOffset(e){return this._source.findTokenIndexAtOffset(e+this._startOffset-this._deltaOffset)-this._firstTokenIndex}getTokenText(e){const t=this._firstTokenIndex+e,i=this._source.getStartOffset(t),n=this._source.getEndOffset(t);let s=this._source.getTokenText(t);return i<this._startOffset&&(s=s.substring(this._startOffset-i)),n>this._endOffset&&(s=s.substring(0,s.length-(n-this._endOffset))),s}forEach(e){for(let t=0;t<this.getCount();t++)e(t)}}function Jre(o,e){const t=e.lineNumber;if(!o.tokenization.isCheapToTokenize(t))return;o.tokenization.forceTokenization(t);const i=o.tokenization.getLineTokens(t),n=i.findTokenIndexAtOffset(e.column-1);return i.getStandardTokenType(n)}const k_=new class{clone(){return this}equals(o){return this===o}};function I5(o,e){return new D4([new UC(0,"",o)],e)}function BT(o,e){const t=new Uint32Array(2);return t[0]=0,t[1]=(o<<0|0|0|32768|2<<24)>>>0,new eT(t,e===null?k_:e)}const yH={getInitialState:()=>k_,tokenizeEncoded:(o,e,t)=>BT(0,t)};async function eae(o,e,t){if(!t)return wH(e,o.languageIdCodec,yH);const i=await gi.getOrCreate(t);return wH(e,o.languageIdCodec,i||yH)}function tae(o,e,t,i,n,s,r){let a="<div>",l=i,c=0,d=!0;for(let h=0,u=e.getCount();h<u;h++){const g=e.getEndOffset(h);if(g<=i)continue;let f="";for(;l<g&&l<n;l++){const m=o.charCodeAt(l);switch(m){case 9:{let _=s-(l+c)%s;for(c+=_-1;_>0;)r&&d?(f+="&#160;",d=!1):(f+=" ",d=!0),_--;break}case 60:f+="&lt;",d=!1;break;case 62:f+="&gt;",d=!1;break;case 38:f+="&amp;",d=!1;break;case 0:f+="&#00;",d=!1;break;case 65279:case 8232:case 8233:case 133:f+="�",d=!1;break;case 13:f+="&#8203",d=!1;break;case 32:r&&d?(f+="&#160;",d=!1):(f+=" ",d=!0);break;default:f+=String.fromCharCode(m),d=!1}}if(a+=`<span style="${e.getInlineStyle(h,t)}">${f}</span>`,g>n||l>=n)break}return a+="</div>",a}function wH(o,e,t){let i='<div class="monaco-tokenized-source">';const n=Bl(o);let s=t.getInitialState();for(let r=0,a=n.length;r<a;r++){const l=n[r];r>0&&(i+="<br/>");const c=t.tokenizeEncoded(l,!0,s);an.convertToEndOffset(c.tokens,l.length);const h=new an(c.tokens,l,e).inflate();let u=0;for(let g=0,f=h.getCount();g<f;g++){const m=h.getClassName(g),_=h.getEndOffset(g);i+=`<span class="${m}">${Av(l.substring(u,_))}</span>`,u=_}s=c.endState}return i+="</div>",i}var iae=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},SH=function(o,e){return function(t,i){e(t,i,o)}},oA,bg;let Zc=(bg=class{constructor(e,t,i){this._options=e,this._languageService=t,this._openerService=i,this._onDidRenderAsync=new O,this.onDidRenderAsync=this._onDidRenderAsync.event}dispose(){this._onDidRenderAsync.dispose()}render(e,t,i){if(!e)return{element:document.createElement("span"),dispose:()=>{}};const n=new $,s=n.add(FT(e,{...this._getRenderOptions(e,n),...t},i));return s.element.classList.add("rendered-markdown"),{element:s.element,dispose:()=>n.dispose()}}_getRenderOptions(e,t){return{codeBlockRenderer:async(i,n)=>{let s;i?s=this._languageService.getLanguageIdByLanguageName(i):this._options.editor&&(s=this._options.editor.getModel()?.getLanguageId()),s||(s=hs);const r=await eae(this._languageService,n,s),a=document.createElement("span");if(a.innerHTML=oA._ttpTokenizer?.createHTML(r)??r,this._options.editor){const l=this._options.editor.getOption(50);mn(a,l)}else this._options.codeBlockFontFamily&&(a.style.fontFamily=this._options.codeBlockFontFamily);return this._options.codeBlockFontSize!==void 0&&(a.style.fontSize=this._options.codeBlockFontSize),a},asyncRenderCallback:()=>this._onDidRenderAsync.fire(),actionHandler:{callback:i=>N5(this._openerService,i,e.isTrusted),disposables:t}}}},oA=bg,bg._ttpTokenizer=nd("tokenizeToString",{createHTML(e){return e}}),bg);Zc=oA=iae([SH(1,ti),SH(2,Fs)],Zc);async function N5(o,e,t){try{return await o.open(e,{fromUserGesture:!0,allowContributedOpeners:!0,allowCommands:nae(t)})}catch(i){return Ae(i),!1}}function nae(o){return o===!0?!0:o&&Array.isArray(o.enabledCommands)?o.enabledCommands:!1}const ho=Je("accessibilityService"),Rw=new re("accessibilityModeEnabled",!1),xH=2e4;let Ou,V1,rA,H1,aA;function sae(o){Ou=document.createElement("div"),Ou.className="monaco-aria-container";const e=()=>{const i=document.createElement("div");return i.className="monaco-alert",i.setAttribute("role","alert"),i.setAttribute("aria-atomic","true"),Ou.appendChild(i),i};V1=e(),rA=e();const t=()=>{const i=document.createElement("div");return i.className="monaco-status",i.setAttribute("aria-live","polite"),i.setAttribute("aria-atomic","true"),Ou.appendChild(i),i};H1=t(),aA=t(),o.appendChild(Ou)}function ps(o){Ou&&(V1.textContent!==o?(fn(rA),ix(V1,o)):(fn(V1),ix(rA,o)))}function Rl(o){Ou&&(H1.textContent!==o?(fn(aA),ix(H1,o)):(fn(H1),ix(aA,o)))}function ix(o,e){fn(o),e.length>xH&&(e=e.substr(0,xH)),o.textContent=e,o.style.visibility="hidden",o.style.visibility="visible"}var oae=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},$b=function(o,e){return function(t,i){e(t,i,o)}};const $a=ie;let lA=class extends Go{get _targetWindow(){return xe(this._target.targetElements[0])}get _targetDocumentElement(){return xe(this._target.targetElements[0]).document.documentElement}get isDisposed(){return this._isDisposed}get isMouseIn(){return this._lockMouseTracker.isMouseIn}get domNode(){return this._hover.containerDomNode}get onDispose(){return this._onDispose.event}get onRequestLayout(){return this._onRequestLayout.event}get anchor(){return this._hoverPosition===2?0:1}get x(){return this._x}get y(){return this._y}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked!==e&&(this._isLocked=e,this._hoverContainer.classList.toggle("locked",this._isLocked))}constructor(e,t,i,n,s,r){super(),this._keybindingService=t,this._configurationService=i,this._openerService=n,this._instantiationService=s,this._accessibilityService=r,this._messageListeners=new $,this._isDisposed=!1,this._forcePosition=!1,this._x=0,this._y=0,this._isLocked=!1,this._enableFocusTraps=!1,this._addedFocusTrap=!1,this._onDispose=this._register(new O),this._onRequestLayout=this._register(new O),this._linkHandler=e.linkHandler||(u=>N5(this._openerService,u,Ea(e.content)?e.content.isTrusted:void 0)),this._target="targetElements"in e.target?e.target:new rae(e.target),this._hoverPointer=e.appearance?.showPointer?$a("div.workbench-hover-pointer"):void 0,this._hover=this._register(new v5),this._hover.containerDomNode.classList.add("workbench-hover","fadeIn"),e.appearance?.compact&&this._hover.containerDomNode.classList.add("workbench-hover","compact"),e.appearance?.skipFadeInAnimation&&this._hover.containerDomNode.classList.add("skip-fade-in"),e.additionalClasses&&this._hover.containerDomNode.classList.add(...e.additionalClasses),e.position?.forcePosition&&(this._forcePosition=!0),e.trapFocus&&(this._enableFocusTraps=!0),this._hoverPosition=e.position?.hoverPosition??3,this.onmousedown(this._hover.containerDomNode,u=>u.stopPropagation()),this.onkeydown(this._hover.containerDomNode,u=>{u.equals(9)&&this.dispose()}),this._register(H(this._targetWindow,"blur",()=>this.dispose()));const a=$a("div.hover-row.markdown-hover"),l=$a("div.hover-contents");if(typeof e.content=="string")l.textContent=e.content,l.style.whiteSpace="pre-wrap";else if(qi(e.content))l.appendChild(e.content),l.classList.add("html-hover-contents");else{const u=e.content,g=this._instantiationService.createInstance(Zc,{codeBlockFontFamily:this._configurationService.getValue("editor").fontFamily||ds.fontFamily}),{element:f}=g.render(u,{actionHandler:{callback:m=>this._linkHandler(m),disposables:this._messageListeners},asyncRenderCallback:()=>{l.classList.add("code-hover-contents"),this.layout(),this._onRequestLayout.fire()}});l.appendChild(f)}if(a.appendChild(l),this._hover.contentsDomNode.appendChild(a),e.actions&&e.actions.length>0){const u=$a("div.hover-row.status-bar"),g=$a("div.actions");e.actions.forEach(f=>{const m=this._keybindingService.lookupKeybinding(f.commandId),_=m?m.getLabel():null;PT.render(g,{label:f.label,commandId:f.commandId,run:b=>{f.run(b),this.dispose()},iconClass:f.iconClass},_)}),u.appendChild(g),this._hover.containerDomNode.appendChild(u)}this._hoverContainer=$a("div.workbench-hover-container"),this._hoverPointer&&this._hoverContainer.appendChild(this._hoverPointer),this._hoverContainer.appendChild(this._hover.containerDomNode);let c;if(e.actions&&e.actions.length>0?c=!1:e.persistence?.hideOnHover===void 0?c=typeof e.content=="string"||Ea(e.content)&&!e.content.value.includes("](")&&!e.content.value.includes("</a>"):c=e.persistence.hideOnHover,e.appearance?.showHoverHint){const u=$a("div.hover-row.status-bar"),g=$a("div.info");g.textContent=p("hoverhint","Hold {0} key to mouse over",Qe?"Option":"Alt"),u.appendChild(g),this._hover.containerDomNode.appendChild(u)}const d=[...this._target.targetElements];c||d.push(this._hoverContainer);const h=this._register(new LH(d));if(this._register(h.onMouseOut(()=>{this._isLocked||this.dispose()})),c){const u=[...this._target.targetElements,this._hoverContainer];this._lockMouseTracker=this._register(new LH(u)),this._register(this._lockMouseTracker.onMouseOut(()=>{this._isLocked||this.dispose()}))}else this._lockMouseTracker=h}addFocusTrap(){if(!this._enableFocusTraps||this._addedFocusTrap)return;this._addedFocusTrap=!0;const e=this._hover.containerDomNode,t=this.findLastFocusableChild(this._hover.containerDomNode);if(t){const i=G4(this._hoverContainer,$a("div")),n=Y(this._hoverContainer,$a("div"));i.tabIndex=0,n.tabIndex=0,this._register(H(n,"focus",s=>{e.focus(),s.preventDefault()})),this._register(H(i,"focus",s=>{t.focus(),s.preventDefault()}))}}findLastFocusableChild(e){if(e.hasChildNodes())for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes.item(e.childNodes.length-t-1);if(i.nodeType===i.ELEMENT_NODE){const s=i;if(typeof s.tabIndex=="number"&&s.tabIndex>=0)return s}const n=this.findLastFocusableChild(i);if(n)return n}}render(e){e.appendChild(this._hoverContainer);const i=this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement)&&CG(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel());i&&Rl(i),this.layout(),this.addFocusTrap()}layout(){this._hover.containerDomNode.classList.remove("right-aligned"),this._hover.contentsDomNode.style.maxHeight="";const e=d=>{const h=Zz(d),u=d.getBoundingClientRect();return{top:u.top*h,bottom:u.bottom*h,right:u.right*h,left:u.left*h}},t=this._target.targetElements.map(d=>e(d)),{top:i,right:n,bottom:s,left:r}=t[0],a=n-r,l=s-i,c={top:i,right:n,bottom:s,left:r,width:a,height:l,center:{x:r+a/2,y:i+l/2}};if(this.adjustHorizontalHoverPosition(c),this.adjustVerticalHoverPosition(c),this.adjustHoverMaxHeight(c),this._hoverContainer.style.padding="",this._hoverContainer.style.margin="",this._hoverPointer){switch(this._hoverPosition){case 1:c.left+=3,c.right+=3,this._hoverContainer.style.paddingLeft="3px",this._hoverContainer.style.marginLeft="-3px";break;case 0:c.left-=3,c.right-=3,this._hoverContainer.style.paddingRight="3px",this._hoverContainer.style.marginRight="-3px";break;case 2:c.top+=3,c.bottom+=3,this._hoverContainer.style.paddingTop="3px",this._hoverContainer.style.marginTop="-3px";break;case 3:c.top-=3,c.bottom-=3,this._hoverContainer.style.paddingBottom="3px",this._hoverContainer.style.marginBottom="-3px";break}c.center.x=c.left+a/2,c.center.y=c.top+l/2}this.computeXCordinate(c),this.computeYCordinate(c),this._hoverPointer&&(this._hoverPointer.classList.remove("top"),this._hoverPointer.classList.remove("left"),this._hoverPointer.classList.remove("right"),this._hoverPointer.classList.remove("bottom"),this.setHoverPointerPosition(c)),this._hover.onContentsChanged()}computeXCordinate(e){const t=this._hover.containerDomNode.clientWidth+2;this._target.x!==void 0?this._x=this._target.x:this._hoverPosition===1?this._x=e.right:this._hoverPosition===0?this._x=e.left-t:(this._hoverPointer?this._x=e.center.x-this._hover.containerDomNode.clientWidth/2:this._x=e.left,this._x+t>=this._targetDocumentElement.clientWidth&&(this._hover.containerDomNode.classList.add("right-aligned"),this._x=Math.max(this._targetDocumentElement.clientWidth-t-2,this._targetDocumentElement.clientLeft))),this._x<this._targetDocumentElement.clientLeft&&(this._x=e.left+2)}computeYCordinate(e){this._target.y!==void 0?this._y=this._target.y:this._hoverPosition===3?this._y=e.top:this._hoverPosition===2?this._y=e.bottom-2:this._hoverPointer?this._y=e.center.y+this._hover.containerDomNode.clientHeight/2:this._y=e.bottom,this._y>this._targetWindow.innerHeight&&(this._y=e.bottom)}adjustHorizontalHoverPosition(e){if(this._target.x!==void 0)return;const t=this._hoverPointer?3:0;if(this._forcePosition){const i=t+2;this._hoverPosition===1?this._hover.containerDomNode.style.maxWidth=`${this._targetDocumentElement.clientWidth-e.right-i}px`:this._hoverPosition===0&&(this._hover.containerDomNode.style.maxWidth=`${e.left-i}px`);return}this._hoverPosition===1?this._targetDocumentElement.clientWidth-e.right<this._hover.containerDomNode.clientWidth+t&&(e.left>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=0:this._hoverPosition=2):this._hoverPosition===0&&(e.left<this._hover.containerDomNode.clientWidth+t&&(this._targetDocumentElement.clientWidth-e.right>=this._hover.containerDomNode.clientWidth+t?this._hoverPosition=1:this._hoverPosition=2),e.left-this._hover.containerDomNode.clientWidth-t<=this._targetDocumentElement.clientLeft&&(this._hoverPosition=1))}adjustVerticalHoverPosition(e){if(this._target.y!==void 0||this._forcePosition)return;const t=this._hoverPointer?3:0;this._hoverPosition===3?e.top-this._hover.containerDomNode.clientHeight-t<0&&(this._hoverPosition=2):this._hoverPosition===2&&e.bottom+this._hover.containerDomNode.clientHeight+t>this._targetWindow.innerHeight&&(this._hoverPosition=3)}adjustHoverMaxHeight(e){let t=this._targetWindow.innerHeight/2;if(this._forcePosition){const i=(this._hoverPointer?3:0)+2;this._hoverPosition===3?t=Math.min(t,e.top-i):this._hoverPosition===2&&(t=Math.min(t,this._targetWindow.innerHeight-e.bottom-i))}if(this._hover.containerDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.clientHeight<this._hover.contentsDomNode.scrollHeight){const i=`${this._hover.scrollbar.options.verticalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingRight!==i&&(this._hover.contentsDomNode.style.paddingRight=i)}}setHoverPointerPosition(e){if(this._hoverPointer)switch(this._hoverPosition){case 0:case 1:{this._hoverPointer.classList.add(this._hoverPosition===0?"right":"left");const t=this._hover.containerDomNode.clientHeight;t>e.height?this._hoverPointer.style.top=`${e.center.y-(this._y-t)-3}px`:this._hoverPointer.style.top=`${Math.round(t/2)-3}px`;break}case 3:case 2:{this._hoverPointer.classList.add(this._hoverPosition===3?"bottom":"top");const t=this._hover.containerDomNode.clientWidth;let i=Math.round(t/2)-3;const n=this._x+i;(n<e.left||n>e.right)&&(i=e.center.x-this._x-3),this._hoverPointer.style.left=`${i}px`;break}}}focus(){this._hover.containerDomNode.focus()}dispose(){this._isDisposed||(this._onDispose.fire(),this._hoverContainer.remove(),this._messageListeners.dispose(),this._target.dispose(),super.dispose()),this._isDisposed=!0}};lA=oae([$b(1,vt),$b(2,Ke),$b(3,Fs),$b(4,Ce),$b(5,ho)],lA);class LH extends Go{get onMouseOut(){return this._onMouseOut.event}get isMouseIn(){return this._isMouseIn}constructor(e){super(),this._elements=e,this._isMouseIn=!0,this._onMouseOut=this._register(new O),this._elements.forEach(t=>this.onmouseover(t,()=>this._onTargetMouseOver(t))),this._elements.forEach(t=>this.onmouseleave(t,()=>this._onTargetMouseLeave(t)))}_onTargetMouseOver(e){this._isMouseIn=!0,this._clearEvaluateMouseStateTimeout(e)}_onTargetMouseLeave(e){this._isMouseIn=!1,this._evaluateMouseState(e)}_evaluateMouseState(e){this._clearEvaluateMouseStateTimeout(e),this._mouseTimeout=xe(e).setTimeout(()=>this._fireIfMouseOutside(),0)}_clearEvaluateMouseStateTimeout(e){this._mouseTimeout&&(xe(e).clearTimeout(this._mouseTimeout),this._mouseTimeout=void 0)}_fireIfMouseOutside(){this._isMouseIn||this._onMouseOut.fire()}}class rae{constructor(e){this._element=e,this.targetElements=[this._element]}dispose(){}}var In;(function(o){function e(s,r){if(s.start>=r.end||r.start>=s.end)return{start:0,end:0};const a=Math.max(s.start,r.start),l=Math.min(s.end,r.end);return l-a<=0?{start:0,end:0}:{start:a,end:l}}o.intersect=e;function t(s){return s.end-s.start<=0}o.isEmpty=t;function i(s,r){return!t(e(s,r))}o.intersects=i;function n(s,r){const a=[],l={start:s.start,end:Math.min(r.start,s.end)},c={start:Math.max(r.end,s.start),end:s.end};return t(l)||a.push(l),t(c)||a.push(c),a}o.relativeComplement=n})(In||(In={}));function aae(o){const e=o;return!!e&&typeof e.x=="number"&&typeof e.y=="number"}var $d;(function(o){o[o.AVOID=0]="AVOID",o[o.ALIGN=1]="ALIGN"})($d||($d={}));function Zp(o,e,t){const i=t.mode===$d.ALIGN?t.offset:t.offset+t.size,n=t.mode===$d.ALIGN?t.offset+t.size:t.offset;return t.position===0?e<=o-i?i:e<=n?n-e:Math.max(o-e,0):e<=n?n-e:e<=o-i?i:0}const Cm=class Cm extends F{constructor(e,t){super(),this.container=null,this.useFixedPosition=!1,this.useShadowDOM=!1,this.delegate=null,this.toDisposeOnClean=F.None,this.toDisposeOnSetContainer=F.None,this.shadowRoot=null,this.shadowRootHostElement=null,this.view=ie(".context-view"),is(this.view),this.setContainer(e,t),this._register(ve(()=>this.setContainer(null,1)))}setContainer(e,t){this.useFixedPosition=t!==1;const i=this.useShadowDOM;if(this.useShadowDOM=t===3,!(e===this.container&&i===this.useShadowDOM)&&(this.container&&(this.toDisposeOnSetContainer.dispose(),this.view.remove(),this.shadowRoot&&(this.shadowRoot=null,this.shadowRootHostElement?.remove(),this.shadowRootHostElement=null),this.container=null),e)){if(this.container=e,this.useShadowDOM){this.shadowRootHostElement=ie(".shadow-root-host"),this.container.appendChild(this.shadowRootHostElement),this.shadowRoot=this.shadowRootHostElement.attachShadow({mode:"open"});const s=document.createElement("style");s.textContent=lae,this.shadowRoot.appendChild(s),this.shadowRoot.appendChild(this.view),this.shadowRoot.appendChild(ie("slot"))}else this.container.appendChild(this.view);const n=new $;Cm.BUBBLE_UP_EVENTS.forEach(s=>{n.add(ci(this.container,s,r=>{this.onDOMEvent(r,!1)}))}),Cm.BUBBLE_DOWN_EVENTS.forEach(s=>{n.add(ci(this.container,s,r=>{this.onDOMEvent(r,!0)},!0))}),this.toDisposeOnSetContainer=n}}show(e){this.isVisible()&&this.hide(),fn(this.view),this.view.className="context-view monaco-component",this.view.style.top="0px",this.view.style.left="0px",this.view.style.zIndex=`${2575+(e.layer??0)}`,this.view.style.position=this.useFixedPosition?"fixed":"absolute",Ys(this.view),this.toDisposeOnClean=e.render(this.view)||F.None,this.delegate=e,this.doLayout(),this.delegate.focus?.()}getViewElement(){return this.view}layout(){if(this.isVisible()){if(this.delegate.canRelayout===!1&&!(Ta&&F4.pointerEvents)){this.hide();return}this.delegate?.layout?.(),this.doLayout()}}doLayout(){if(!this.isVisible())return;const e=this.delegate.getAnchor();let t;if(qi(e)){const u=Ci(e),g=Zz(e);t={top:u.top*g,left:u.left*g,width:u.width*g,height:u.height*g}}else aae(e)?t={top:e.y,left:e.x,width:e.width||1,height:e.height||2}:t={top:e.posy,left:e.posx,width:2,height:2};const i=Ks(this.view),n=xc(this.view),s=this.delegate.anchorPosition||0,r=this.delegate.anchorAlignment||0,a=this.delegate.anchorAxisAlignment||0;let l,c;const d=dv();if(a===0){const u={offset:t.top-d.pageYOffset,size:t.height,position:s===0?0:1},g={offset:t.left,size:t.width,position:r===0?0:1,mode:$d.ALIGN};l=Zp(d.innerHeight,n,u)+d.pageYOffset,In.intersects({start:l,end:l+n},{start:u.offset,end:u.offset+u.size})&&(g.mode=$d.AVOID),c=Zp(d.innerWidth,i,g)}else{const u={offset:t.left,size:t.width,position:r===0?0:1},g={offset:t.top,size:t.height,position:s===0?0:1,mode:$d.ALIGN};c=Zp(d.innerWidth,i,u),In.intersects({start:c,end:c+i},{start:u.offset,end:u.offset+u.size})&&(g.mode=$d.AVOID),l=Zp(d.innerHeight,n,g)+d.pageYOffset}this.view.classList.remove("top","bottom","left","right"),this.view.classList.add(s===0?"bottom":"top"),this.view.classList.add(r===0?"left":"right"),this.view.classList.toggle("fixed",this.useFixedPosition);const h=Ci(this.container);this.view.style.top=`${l-(this.useFixedPosition?Ci(this.view).top:h.top)}px`,this.view.style.left=`${c-(this.useFixedPosition?Ci(this.view).left:h.left)}px`,this.view.style.width="initial"}hide(e){const t=this.delegate;this.delegate=null,t?.onHide&&t.onHide(e),this.toDisposeOnClean.dispose(),is(this.view)}isVisible(){return!!this.delegate}onDOMEvent(e,t){this.delegate&&(this.delegate.onDOMEvent?this.delegate.onDOMEvent(e,xe(e).document.activeElement):t&&!Ki(e.target,this.container)&&this.hide())}dispose(){this.hide(),super.dispose()}};Cm.BUBBLE_UP_EVENTS=["click","keydown","focus","blur"],Cm.BUBBLE_DOWN_EVENTS=["click"];let cA=Cm;const lae=`
	:host {
		all: initial; /* 1st rule so subsequent properties are reset. */
	}

	.codicon[class*='codicon-'] {
		font: normal normal normal 16px/1 codicon;
		display: inline-block;
		text-decoration: none;
		text-rendering: auto;
		text-align: center;
		-webkit-font-smoothing: antialiased;
		-moz-osx-font-smoothing: grayscale;
		user-select: none;
		-webkit-user-select: none;
		-ms-user-select: none;
	}

	:host {
		font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "HelveticaNeue-Light", system-ui, "Ubuntu", "Droid Sans", sans-serif;
	}

	:host-context(.mac) { font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
	:host-context(.mac:lang(zh-Hans)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", "Hiragino Sans GB", sans-serif; }
	:host-context(.mac:lang(zh-Hant)) { font-family: -apple-system, BlinkMacSystemFont, "PingFang TC", sans-serif; }
	:host-context(.mac:lang(ja)) { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic Pro", sans-serif; }
	:host-context(.mac:lang(ko)) { font-family: -apple-system, BlinkMacSystemFont, "Nanum Gothic", "Apple SD Gothic Neo", "AppleGothic", sans-serif; }

	:host-context(.windows) { font-family: "Segoe WPC", "Segoe UI", sans-serif; }
	:host-context(.windows:lang(zh-Hans)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft YaHei", sans-serif; }
	:host-context(.windows:lang(zh-Hant)) { font-family: "Segoe WPC", "Segoe UI", "Microsoft Jhenghei", sans-serif; }
	:host-context(.windows:lang(ja)) { font-family: "Segoe WPC", "Segoe UI", "Yu Gothic UI", "Meiryo UI", sans-serif; }
	:host-context(.windows:lang(ko)) { font-family: "Segoe WPC", "Segoe UI", "Malgun Gothic", "Dotom", sans-serif; }

	:host-context(.linux) { font-family: system-ui, "Ubuntu", "Droid Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hans)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans SC", "Source Han Sans CN", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(zh-Hant)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans TC", "Source Han Sans TW", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ja)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans J", "Source Han Sans JP", "Source Han Sans", sans-serif; }
	:host-context(.linux:lang(ko)) { font-family: system-ui, "Ubuntu", "Droid Sans", "Source Han Sans K", "Source Han Sans JR", "Source Han Sans", "UnDotum", "FBaekmuk Gulim", sans-serif; }
`;var cae=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},dae=function(o,e){return function(t,i){e(t,i,o)}};let nx=class extends F{constructor(e){super(),this.layoutService=e,this.contextView=this._register(new cA(this.layoutService.mainContainer,1)),this.layout(),this._register(e.onDidLayoutContainer(()=>this.layout()))}showContextView(e,t,i){let n;t?t===this.layoutService.getContainer(xe(t))?n=1:i?n=3:n=2:n=1,this.contextView.setContainer(t??this.layoutService.activeContainer,n),this.contextView.show(e);const s={close:()=>{this.openContextView===s&&this.hideContextView()}};return this.openContextView=s,s}layout(){this.contextView.layout()}hideContextView(e){this.contextView.hide(e),this.openContextView=void 0}};nx=cae([dae(0,qh)],nx);class hae extends nx{getContextViewElement(){return this.contextView.getViewElement()}}class uae{constructor(e,t,i){this.hoverDelegate=e,this.target=t,this.fadeInAnimation=i}async update(e,t,i){if(this._cancellationTokenSource&&(this._cancellationTokenSource.dispose(!0),this._cancellationTokenSource=void 0),this.isDisposed)return;let n;if(e===void 0||Ds(e)||qi(e))n=e;else if(!VC(e.markdown))n=e.markdown??e.markdownNotSupportedFallback;else{this._hoverWidget||this.show(p("iconLabel.loading","Loading..."),t,i),this._cancellationTokenSource=new ri;const s=this._cancellationTokenSource.token;if(n=await e.markdown(s),n===void 0&&(n=e.markdownNotSupportedFallback),this.isDisposed||s.isCancellationRequested)return}this.show(n,t,i)}show(e,t,i){const n=this._hoverWidget;if(this.hasContent(e)){const s={content:e,target:this.target,actions:i?.actions,linkHandler:i?.linkHandler,trapFocus:i?.trapFocus,appearance:{showPointer:this.hoverDelegate.placement==="element",skipFadeInAnimation:!this.fadeInAnimation||!!n,showHoverHint:i?.appearance?.showHoverHint},position:{hoverPosition:2}};this._hoverWidget=this.hoverDelegate.showHover(s,t)}n?.dispose()}hasContent(e){return e?Ea(e)?!!e.value:!0:!1}get isDisposed(){return this._hoverWidget?.isDisposed}dispose(){this._hoverWidget?.dispose(),this._cancellationTokenSource?.dispose(!0),this._cancellationTokenSource=void 0}}var gae=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Kb=function(o,e){return function(t,i){e(t,i,o)}};let dA=class extends F{constructor(e,t,i,n,s){super(),this._instantiationService=e,this._keybindingService=i,this._layoutService=n,this._accessibilityService=s,this._managedHovers=new Map,t.onDidShowContextMenu(()=>this.hideHover()),this._contextViewHandler=this._register(new nx(this._layoutService))}showHover(e,t,i){if(kH(this._currentHoverOptions)===kH(e)||this._currentHover&&this._currentHoverOptions?.persistence?.sticky)return;this._currentHoverOptions=e,this._lastHoverOptions=e;const n=e.trapFocus||this._accessibilityService.isScreenReaderOptimized(),s=Ln();i||(n&&s?s.classList.contains("monaco-hover")||(this._lastFocusedElementBeforeOpen=s):this._lastFocusedElementBeforeOpen=void 0);const r=new $,a=this._instantiationService.createInstance(lA,e);if(e.persistence?.sticky&&(a.isLocked=!0),a.onDispose(()=>{this._currentHover?.domNode&&Xz(this._currentHover.domNode)&&this._lastFocusedElementBeforeOpen?.focus(),this._currentHoverOptions===e&&(this._currentHoverOptions=void 0),r.dispose()},void 0,r),!e.container){const l=qi(e.target)?e.target:e.target.targetElements[0];e.container=this._layoutService.getContainer(xe(l))}if(this._contextViewHandler.showContextView(new fae(a,t),e.container),a.onRequestLayout(()=>this._contextViewHandler.layout(),void 0,r),e.persistence?.sticky)r.add(H(xe(e.container).document,ee.MOUSE_DOWN,l=>{Ki(l.target,a.domNode)||this.doHideHover()}));else{if("targetElements"in e.target)for(const c of e.target.targetElements)r.add(H(c,ee.CLICK,()=>this.hideHover()));else r.add(H(e.target,ee.CLICK,()=>this.hideHover()));const l=Ln();if(l){const c=xe(l).document;r.add(H(l,ee.KEY_DOWN,d=>this._keyDown(d,a,!!e.persistence?.hideOnKeyDown))),r.add(H(c,ee.KEY_DOWN,d=>this._keyDown(d,a,!!e.persistence?.hideOnKeyDown))),r.add(H(l,ee.KEY_UP,d=>this._keyUp(d,a))),r.add(H(c,ee.KEY_UP,d=>this._keyUp(d,a)))}}if("IntersectionObserver"in It){const l=new IntersectionObserver(d=>this._intersectionChange(d,a),{threshold:0}),c="targetElements"in e.target?e.target.targetElements[0]:e.target;l.observe(c),r.add(ve(()=>l.disconnect()))}return this._currentHover=a,a}hideHover(){this._currentHover?.isLocked||!this._currentHoverOptions||this.doHideHover()}doHideHover(){this._currentHover=void 0,this._currentHoverOptions=void 0,this._contextViewHandler.hideContextView()}_intersectionChange(e,t){e[e.length-1].isIntersecting||t.dispose()}showAndFocusLastHover(){this._lastHoverOptions&&this.showHover(this._lastHoverOptions,!0,!0)}_keyDown(e,t,i){if(e.key==="Alt"){t.isLocked=!0;return}const n=new Pt(e);this._keybindingService.resolveKeyboardEvent(n).getSingleModifierDispatchChords().some(r=>!!r)||this._keybindingService.softDispatch(n,n.target).kind!==0||i&&(!this._currentHoverOptions?.trapFocus||e.key!=="Tab")&&(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus())}_keyUp(e,t){e.key==="Alt"&&(t.isLocked=!1,t.isMouseIn||(this.hideHover(),this._lastFocusedElementBeforeOpen?.focus()))}setupManagedHover(e,t,i,n){t.setAttribute("custom-hover","true"),t.title!==""&&(console.warn("HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute."),console.trace("Stack trace:",t.title),t.title="");let s,r;const a=(y,C)=>{const w=r!==void 0;y&&(r?.dispose(),r=void 0),C&&(s?.dispose(),s=void 0),w&&(e.onDidHideHover?.(),r=void 0)},l=(y,C,w,x)=>new qr(async()=>{(!r||r.isDisposed)&&(r=new uae(e,w||t,y>0),await r.update(typeof i=="function"?i():i,C,{...n,trapFocus:x}))},y);let c=!1;const d=H(t,ee.MOUSE_DOWN,()=>{c=!0,a(!0,!0)},!0),h=H(t,ee.MOUSE_UP,()=>{c=!1},!0),u=H(t,ee.MOUSE_LEAVE,y=>{c=!1,a(!1,y.fromElement===t)},!0),g=y=>{if(s)return;const C=new $,w={targetElements:[t],dispose:()=>{}};if(e.placement===void 0||e.placement==="mouse"){const x=k=>{w.x=k.x+10,qi(k.target)&&EH(k.target,t)!==t&&a(!0,!0)};C.add(H(t,ee.MOUSE_MOVE,x,!0))}s=C,!(qi(y.target)&&EH(y.target,t)!==t)&&C.add(l(e.delay,!1,w))},f=H(t,ee.MOUSE_OVER,g,!0),m=()=>{if(c||s)return;const y={targetElements:[t],dispose:()=>{}},C=new $,w=()=>a(!0,!0);C.add(H(t,ee.BLUR,w,!0)),C.add(l(e.delay,!1,y)),s=C};let _;const b=t.tagName.toLowerCase();b!=="input"&&b!=="textarea"&&(_=H(t,ee.FOCUS,m,!0));const v={show:y=>{a(!1,!0),l(0,y,void 0,y)},hide:()=>{a(!0,!0)},update:async(y,C)=>{i=y,await r?.update(i,void 0,C)},dispose:()=>{this._managedHovers.delete(t),f.dispose(),u.dispose(),d.dispose(),h.dispose(),_?.dispose(),a(!0,!0)}};return this._managedHovers.set(t,v),v}showManagedHover(e){const t=this._managedHovers.get(e);t&&t.show(!0)}dispose(){this._managedHovers.forEach(e=>e.dispose()),super.dispose()}};dA=gae([Kb(0,Ce),Kb(1,co),Kb(2,vt),Kb(3,qh),Kb(4,ho)],dA);function kH(o){if(o!==void 0)return o?.id??o}class fae{get anchorPosition(){return this._hover.anchor}constructor(e,t=!1){this._hover=e,this._focus=t,this.layer=1}render(e){return this._hover.render(e),this._focus&&this._hover.focus(),this._hover}getAnchor(){return{x:this._hover.x,y:this._hover.y}}layout(){this._hover.layout()}}function EH(o,e){for(e=e??xe(o).document.body;!o.hasAttribute("custom-hover")&&o!==e;)o=o.parentElement;return o}it(zl,dA,1);br((o,e)=>{const t=o.getColor(rG);t&&(e.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`))});const Pw=Je("IWorkspaceEditService");class R5{constructor(e){this.metadata=e}static convert(e){return e.edits.map(t=>{if(sh.is(t))return sh.lift(t);if(Om.is(t))return Om.lift(t);throw new Error("Unsupported edit")})}}class sh extends R5{static is(e){return e instanceof sh?!0:nn(e)&&ye.isUri(e.resource)&&nn(e.textEdit)}static lift(e){return e instanceof sh?e:new sh(e.resource,e.textEdit,e.versionId,e.metadata)}constructor(e,t,i=void 0,n){super(n),this.resource=e,this.textEdit=t,this.versionId=i}}class Om extends R5{static is(e){return e instanceof Om?!0:nn(e)&&(!!e.newResource||!!e.oldResource)}static lift(e){return e instanceof Om?e:new Om(e.oldResource,e.newResource,e.options,e.metadata)}constructor(e,t,i={},n){super(n),this.oldResource=e,this.newResource=t,this.options=i}}const bn={enableSplitViewResizing:!0,renderSideBySide:!0,renderMarginRevertIcon:!0,renderGutterMenu:!0,maxComputationTime:5e3,maxFileSize:50,ignoreTrimWhitespace:!0,renderIndicators:!0,originalEditable:!1,diffCodeLens:!1,renderOverviewRuler:!0,diffWordWrap:"inherit",diffAlgorithm:"advanced",accessibilityVerbose:!1,experimental:{showMoves:!1,showEmptyDecorations:!0,useTrueInlineView:!1},hideUnchangedRegions:{enabled:!1,contextLineCount:3,minimumLineCount:3,revealLineCount:20},isInEmbeddedEditor:!1,onlyShowAccessibleDiffViewer:!1,renderSideBySideInlineBreakpoint:900,useInlineViewWhenSpaceIsLimited:!0,compactMode:!1},Aw=Object.freeze({id:"editor",order:5,type:"object",title:p("editorConfigurationTitle","Editor"),scope:5}),sx={...Aw,properties:{"editor.tabSize":{type:"number",default:Rn.tabSize,minimum:1,markdownDescription:p("tabSize","The number of spaces a tab is equal to. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.indentSize":{anyOf:[{type:"string",enum:["tabSize"]},{type:"number",minimum:1}],default:"tabSize",markdownDescription:p("indentSize",'The number of spaces used for indentation or `"tabSize"` to use the value from `#editor.tabSize#`. This setting is overridden based on the file contents when `#editor.detectIndentation#` is on.')},"editor.insertSpaces":{type:"boolean",default:Rn.insertSpaces,markdownDescription:p("insertSpaces","Insert spaces when pressing `Tab`. This setting is overridden based on the file contents when {0} is on.","`#editor.detectIndentation#`")},"editor.detectIndentation":{type:"boolean",default:Rn.detectIndentation,markdownDescription:p("detectIndentation","Controls whether {0} and {1} will be automatically detected when a file is opened based on the file contents.","`#editor.tabSize#`","`#editor.insertSpaces#`")},"editor.trimAutoWhitespace":{type:"boolean",default:Rn.trimAutoWhitespace,description:p("trimAutoWhitespace","Remove trailing auto inserted whitespace.")},"editor.largeFileOptimizations":{type:"boolean",default:Rn.largeFileOptimizations,description:p("largeFileOptimizations","Special handling for large files to disable certain memory intensive features.")},"editor.wordBasedSuggestions":{enum:["off","currentDocument","matchingDocuments","allDocuments"],default:"matchingDocuments",enumDescriptions:[p("wordBasedSuggestions.off","Turn off Word Based Suggestions."),p("wordBasedSuggestions.currentDocument","Only suggest words from the active document."),p("wordBasedSuggestions.matchingDocuments","Suggest words from all open documents of the same language."),p("wordBasedSuggestions.allDocuments","Suggest words from all open documents.")],description:p("wordBasedSuggestions","Controls whether completions should be computed based on words in the document and from which documents they are computed.")},"editor.semanticHighlighting.enabled":{enum:[!0,!1,"configuredByTheme"],enumDescriptions:[p("semanticHighlighting.true","Semantic highlighting enabled for all color themes."),p("semanticHighlighting.false","Semantic highlighting disabled for all color themes."),p("semanticHighlighting.configuredByTheme","Semantic highlighting is configured by the current color theme's `semanticHighlighting` setting.")],default:"configuredByTheme",description:p("semanticHighlighting.enabled","Controls whether the semanticHighlighting is shown for the languages that support it.")},"editor.stablePeek":{type:"boolean",default:!1,markdownDescription:p("stablePeek","Keep peek editors open even when double-clicking their content or when hitting `Escape`.")},"editor.maxTokenizationLineLength":{type:"integer",default:2e4,description:p("maxTokenizationLineLength","Lines above this length will not be tokenized for performance reasons")},"editor.experimental.asyncTokenization":{type:"boolean",default:!0,description:p("editor.experimental.asyncTokenization","Controls whether the tokenization should happen asynchronously on a web worker."),tags:["experimental"]},"editor.experimental.asyncTokenizationLogging":{type:"boolean",default:!1,description:p("editor.experimental.asyncTokenizationLogging","Controls whether async tokenization should be logged. For debugging only.")},"editor.experimental.asyncTokenizationVerification":{type:"boolean",default:!1,description:p("editor.experimental.asyncTokenizationVerification","Controls whether async tokenization should be verified against legacy background tokenization. Might slow down tokenization. For debugging only."),tags:["experimental"]},"editor.experimental.treeSitterTelemetry":{type:"boolean",default:!1,markdownDescription:p("editor.experimental.treeSitterTelemetry","Controls whether tree sitter parsing should be turned on and telemetry collected. Setting `editor.experimental.preferTreeSitter` for specific languages will take precedence."),tags:["experimental"]},"editor.language.brackets":{type:["array","null"],default:null,description:p("schema.brackets","Defines the bracket symbols that increase or decrease the indentation."),items:{type:"array",items:[{type:"string",description:p("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:p("schema.closeBracket","The closing bracket character or string sequence.")}]}},"editor.language.colorizedBracketPairs":{type:["array","null"],default:null,description:p("schema.colorizedBracketPairs","Defines the bracket pairs that are colorized by their nesting level if bracket pair colorization is enabled."),items:{type:"array",items:[{type:"string",description:p("schema.openBracket","The opening bracket character or string sequence.")},{type:"string",description:p("schema.closeBracket","The closing bracket character or string sequence.")}]}},"diffEditor.maxComputationTime":{type:"number",default:bn.maxComputationTime,description:p("maxComputationTime","Timeout in milliseconds after which diff computation is cancelled. Use 0 for no timeout.")},"diffEditor.maxFileSize":{type:"number",default:bn.maxFileSize,description:p("maxFileSize","Maximum file size in MB for which to compute diffs. Use 0 for no limit.")},"diffEditor.renderSideBySide":{type:"boolean",default:bn.renderSideBySide,description:p("sideBySide","Controls whether the diff editor shows the diff side by side or inline.")},"diffEditor.renderSideBySideInlineBreakpoint":{type:"number",default:bn.renderSideBySideInlineBreakpoint,description:p("renderSideBySideInlineBreakpoint","If the diff editor width is smaller than this value, the inline view is used.")},"diffEditor.useInlineViewWhenSpaceIsLimited":{type:"boolean",default:bn.useInlineViewWhenSpaceIsLimited,description:p("useInlineViewWhenSpaceIsLimited","If enabled and the editor width is too small, the inline view is used.")},"diffEditor.renderMarginRevertIcon":{type:"boolean",default:bn.renderMarginRevertIcon,description:p("renderMarginRevertIcon","When enabled, the diff editor shows arrows in its glyph margin to revert changes.")},"diffEditor.renderGutterMenu":{type:"boolean",default:bn.renderGutterMenu,description:p("renderGutterMenu","When enabled, the diff editor shows a special gutter for revert and stage actions.")},"diffEditor.ignoreTrimWhitespace":{type:"boolean",default:bn.ignoreTrimWhitespace,description:p("ignoreTrimWhitespace","When enabled, the diff editor ignores changes in leading or trailing whitespace.")},"diffEditor.renderIndicators":{type:"boolean",default:bn.renderIndicators,description:p("renderIndicators","Controls whether the diff editor shows +/- indicators for added/removed changes.")},"diffEditor.codeLens":{type:"boolean",default:bn.diffCodeLens,description:p("codeLens","Controls whether the editor shows CodeLens.")},"diffEditor.wordWrap":{type:"string",enum:["off","on","inherit"],default:bn.diffWordWrap,markdownEnumDescriptions:[p("wordWrap.off","Lines will never wrap."),p("wordWrap.on","Lines will wrap at the viewport width."),p("wordWrap.inherit","Lines will wrap according to the {0} setting.","`#editor.wordWrap#`")]},"diffEditor.diffAlgorithm":{type:"string",enum:["legacy","advanced"],default:bn.diffAlgorithm,markdownEnumDescriptions:[p("diffAlgorithm.legacy","Uses the legacy diffing algorithm."),p("diffAlgorithm.advanced","Uses the advanced diffing algorithm.")],tags:["experimental"]},"diffEditor.hideUnchangedRegions.enabled":{type:"boolean",default:bn.hideUnchangedRegions.enabled,markdownDescription:p("hideUnchangedRegions.enabled","Controls whether the diff editor shows unchanged regions.")},"diffEditor.hideUnchangedRegions.revealLineCount":{type:"integer",default:bn.hideUnchangedRegions.revealLineCount,markdownDescription:p("hideUnchangedRegions.revealLineCount","Controls how many lines are used for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.minimumLineCount":{type:"integer",default:bn.hideUnchangedRegions.minimumLineCount,markdownDescription:p("hideUnchangedRegions.minimumLineCount","Controls how many lines are used as a minimum for unchanged regions."),minimum:1},"diffEditor.hideUnchangedRegions.contextLineCount":{type:"integer",default:bn.hideUnchangedRegions.contextLineCount,markdownDescription:p("hideUnchangedRegions.contextLineCount","Controls how many lines are used as context when comparing unchanged regions."),minimum:1},"diffEditor.experimental.showMoves":{type:"boolean",default:bn.experimental.showMoves,markdownDescription:p("showMoves","Controls whether the diff editor should show detected code moves.")},"diffEditor.experimental.showEmptyDecorations":{type:"boolean",default:bn.experimental.showEmptyDecorations,description:p("showEmptyDecorations","Controls whether the diff editor shows empty decorations to see where characters got inserted or deleted.")},"diffEditor.experimental.useTrueInlineView":{type:"boolean",default:bn.experimental.useTrueInlineView,description:p("useTrueInlineView","If enabled and the editor uses the inline view, word changes are rendered inline.")}}};function pae(o){return typeof o.type<"u"||typeof o.anyOf<"u"}for(const o of Up){const e=o.schema;if(typeof e<"u")if(pae(e))sx.properties[`editor.${o.name}`]=e;else for(const t in e)Object.hasOwnProperty.call(e,t)&&(sx.properties[t]=e[t])}let NS=null;function BG(){return NS===null&&(NS=Object.create(null),Object.keys(sx.properties).forEach(o=>{NS[o]=!0})),NS}function mae(o){return BG()[`editor.${o}`]||!1}function _ae(o){return BG()[`diffEditor.${o}`]||!1}const bae=ai.as(Zr.Configuration);bae.registerConfiguration(sx);class si{static insert(e,t){return{range:new L(e.lineNumber,e.column,e.lineNumber,e.column),text:t,forceMoveMarkers:!0}}static delete(e){return{range:e,text:null}}static replace(e,t){return{range:e,text:t}}static replaceMove(e,t){return{range:e,text:t,forceMoveMarkers:!0}}}function RS(o){return Object.isFrozen(o)?o:OY(o)}class gn{static createEmptyModel(e){return new gn({},[],[],void 0,e)}constructor(e,t,i,n,s){this._contents=e,this._keys=t,this._overrides=i,this.raw=n,this.logService=s,this.overrideConfigurations=new Map}get rawConfiguration(){if(!this._rawConfiguration)if(this.raw?.length){const e=this.raw.map(t=>{if(t instanceof gn)return t;const i=new vae("",this.logService);return i.parseRaw(t),i.configurationModel});this._rawConfiguration=e.reduce((t,i)=>i===t?i:t.merge(i),e[0])}else this._rawConfiguration=this;return this._rawConfiguration}get contents(){return this._contents}get overrides(){return this._overrides}get keys(){return this._keys}isEmpty(){return this._keys.length===0&&Object.keys(this._contents).length===0&&this._overrides.length===0}getValue(e){return e?tV(this.contents,e):this.contents}inspect(e,t){const i=this;return{get value(){return RS(i.rawConfiguration.getValue(e))},get override(){return t?RS(i.rawConfiguration.getOverrideValue(e,t)):void 0},get merged(){return RS(t?i.rawConfiguration.override(t).getValue(e):i.rawConfiguration.getValue(e))},get overrides(){const n=[];for(const{contents:s,identifiers:r,keys:a}of i.rawConfiguration.overrides){const l=new gn(s,a,[],void 0,i.logService).getValue(e);l!==void 0&&n.push({identifiers:r,value:l})}return n.length?RS(n):void 0}}}getOverrideValue(e,t){const i=this.getContentsForOverrideIdentifer(t);return i?e?tV(i,e):i:void 0}override(e){let t=this.overrideConfigurations.get(e);return t||(t=this.createOverrideConfigurationModel(e),this.overrideConfigurations.set(e,t)),t}merge(...e){const t=gc(this.contents),i=gc(this.overrides),n=[...this.keys],s=this.raw?.length?[...this.raw]:[this];for(const r of e)if(s.push(...r.raw?.length?r.raw:[r]),!r.isEmpty()){this.mergeContents(t,r.contents);for(const a of r.overrides){const[l]=i.filter(c=>ei(c.identifiers,a.identifiers));l?(this.mergeContents(l.contents,a.contents),l.keys.push(...a.keys),l.keys=Uc(l.keys)):i.push(gc(a))}for(const a of r.keys)n.indexOf(a)===-1&&n.push(a)}return new gn(t,n,i,s.every(r=>r instanceof gn)?void 0:s,this.logService)}createOverrideConfigurationModel(e){const t=this.getContentsForOverrideIdentifer(e);if(!t||typeof t!="object"||!Object.keys(t).length)return this;const i={};for(const n of Uc([...Object.keys(this.contents),...Object.keys(t)])){let s=this.contents[n];const r=t[n];r&&(typeof s=="object"&&typeof r=="object"?(s=gc(s),this.mergeContents(s,r)):s=r),i[n]=s}return new gn(i,this.keys,this.overrides,void 0,this.logService)}mergeContents(e,t){for(const i of Object.keys(t)){if(i in e&&nn(e[i])&&nn(t[i])){this.mergeContents(e[i],t[i]);continue}e[i]=gc(t[i])}}getContentsForOverrideIdentifer(e){let t=null,i=null;const n=s=>{s&&(i?this.mergeContents(i,s):i=gc(s))};for(const s of this.overrides)s.identifiers.length===1&&s.identifiers[0]===e?t=s.contents:s.identifiers.includes(e)&&n(s.contents);return n(t),i}toJSON(){return{contents:this.contents,overrides:this.overrides,keys:this.keys}}setValue(e,t){this.updateValue(e,t,!1)}removeValue(e){const t=this.keys.indexOf(e);t!==-1&&(this.keys.splice(t,1),xte(this.contents,e),Ah.test(e)&&this.overrides.splice(this.overrides.findIndex(i=>ei(i.identifiers,B0(e))),1))}updateValue(e,t,i){if(CU(this.contents,e,t,n=>this.logService.error(n)),i=i||this.keys.indexOf(e)===-1,i&&this.keys.push(e),Ah.test(e)){const n=B0(e),s={identifiers:n,keys:Object.keys(this.contents[e]),contents:CP(this.contents[e],a=>this.logService.error(a))},r=this.overrides.findIndex(a=>ei(a.identifiers,n));r!==-1?this.overrides[r]=s:this.overrides.push(s)}}}class vae{constructor(e,t){this._name=e,this.logService=t,this._raw=null,this._configurationModel=null,this._restrictedConfigurations=[]}get configurationModel(){return this._configurationModel||gn.createEmptyModel(this.logService)}parseRaw(e,t){this._raw=e;const{contents:i,keys:n,overrides:s,restricted:r,hasExcludedProperties:a}=this.doParseRaw(e,t);this._configurationModel=new gn(i,n,s,a?[e]:void 0,this.logService),this._restrictedConfigurations=r||[]}doParseRaw(e,t){const i=ai.as(Zr.Configuration).getConfigurationProperties(),n=this.filter(e,i,!0,t);e=n.raw;const s=CP(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`)),r=Object.keys(e),a=this.toOverrides(e,l=>this.logService.error(`Conflict in settings file ${this._name}: ${l}`));return{contents:s,keys:r,overrides:a,restricted:n.restricted,hasExcludedProperties:n.hasExcludedProperties}}filter(e,t,i,n){let s=!1;if(!n?.scopes&&!n?.skipRestricted&&!n?.exclude?.length)return{raw:e,restricted:[],hasExcludedProperties:s};const r={},a=[];for(const l in e)if(Ah.test(l)&&i){const c=this.filter(e[l],t,!1,n);r[l]=c.raw,s=s||c.hasExcludedProperties,a.push(...c.restricted)}else{const c=t[l],d=c?typeof c.scope<"u"?c.scope:3:void 0;c?.restricted&&a.push(l),!n.exclude?.includes(l)&&(n.include?.includes(l)||(d===void 0||n.scopes===void 0||n.scopes.includes(d))&&!(n.skipRestricted&&c?.restricted))?r[l]=e[l]:s=!0}return{raw:r,restricted:a,hasExcludedProperties:s}}toOverrides(e,t){const i=[];for(const n of Object.keys(e))if(Ah.test(n)){const s={};for(const r in e[n])s[r]=e[n][r];i.push({identifiers:B0(n),keys:Object.keys(s),contents:CP(s,t)})}return i}}class Cae{constructor(e,t,i,n,s,r,a,l,c,d,h,u,g){this.key=e,this.overrides=t,this._value=i,this.overrideIdentifiers=n,this.defaultConfiguration=s,this.policyConfiguration=r,this.applicationConfiguration=a,this.userConfiguration=l,this.localUserConfiguration=c,this.remoteUserConfiguration=d,this.workspaceConfiguration=h,this.folderConfigurationModel=u,this.memoryConfigurationModel=g}toInspectValue(e){return e?.value!==void 0||e?.override!==void 0||e?.overrides!==void 0?e:void 0}get userInspectValue(){return this._userInspectValue||(this._userInspectValue=this.userConfiguration.inspect(this.key,this.overrides.overrideIdentifier)),this._userInspectValue}get user(){return this.toInspectValue(this.userInspectValue)}}class WT{constructor(e,t,i,n,s,r,a,l,c,d){this._defaultConfiguration=e,this._policyConfiguration=t,this._applicationConfiguration=i,this._localUserConfiguration=n,this._remoteUserConfiguration=s,this._workspaceConfiguration=r,this._folderConfigurations=a,this._memoryConfiguration=l,this._memoryConfigurationByResource=c,this.logService=d,this._workspaceConsolidatedConfiguration=null,this._foldersConsolidatedConfigurations=new on,this._userConfiguration=null}getValue(e,t,i){return this.getConsolidatedConfigurationModel(e,t,i).getValue(e)}updateValue(e,t,i={}){let n;i.resource?(n=this._memoryConfigurationByResource.get(i.resource),n||(n=gn.createEmptyModel(this.logService),this._memoryConfigurationByResource.set(i.resource,n))):n=this._memoryConfiguration,t===void 0?n.removeValue(e):n.setValue(e,t),i.resource||(this._workspaceConsolidatedConfiguration=null)}inspect(e,t,i){const n=this.getConsolidatedConfigurationModel(e,t,i),s=this.getFolderConfigurationModelForResource(t.resource,i),r=t.resource?this._memoryConfigurationByResource.get(t.resource)||this._memoryConfiguration:this._memoryConfiguration,a=new Set;for(const l of n.overrides)for(const c of l.identifiers)n.getOverrideValue(e,c)!==void 0&&a.add(c);return new Cae(e,t,n.getValue(e),a.size?[...a]:void 0,this._defaultConfiguration,this._policyConfiguration.isEmpty()?void 0:this._policyConfiguration,this.applicationConfiguration.isEmpty()?void 0:this.applicationConfiguration,this.userConfiguration,this.localUserConfiguration,this.remoteUserConfiguration,i?this._workspaceConfiguration:void 0,s||void 0,r)}get applicationConfiguration(){return this._applicationConfiguration}get userConfiguration(){return this._userConfiguration||(this._userConfiguration=this._remoteUserConfiguration.isEmpty()?this._localUserConfiguration:this._localUserConfiguration.merge(this._remoteUserConfiguration)),this._userConfiguration}get localUserConfiguration(){return this._localUserConfiguration}get remoteUserConfiguration(){return this._remoteUserConfiguration}getConsolidatedConfigurationModel(e,t,i){let n=this.getConsolidatedConfigurationModelForResource(t,i);return t.overrideIdentifier&&(n=n.override(t.overrideIdentifier)),!this._policyConfiguration.isEmpty()&&this._policyConfiguration.getValue(e)!==void 0&&(n=n.merge(this._policyConfiguration)),n}getConsolidatedConfigurationModelForResource({resource:e},t){let i=this.getWorkspaceConsolidatedConfiguration();if(t&&e){const n=t.getFolder(e);n&&(i=this.getFolderConsolidatedConfiguration(n.uri)||i);const s=this._memoryConfigurationByResource.get(e);s&&(i=i.merge(s))}return i}getWorkspaceConsolidatedConfiguration(){return this._workspaceConsolidatedConfiguration||(this._workspaceConsolidatedConfiguration=this._defaultConfiguration.merge(this.applicationConfiguration,this.userConfiguration,this._workspaceConfiguration,this._memoryConfiguration)),this._workspaceConsolidatedConfiguration}getFolderConsolidatedConfiguration(e){let t=this._foldersConsolidatedConfigurations.get(e);if(!t){const i=this.getWorkspaceConsolidatedConfiguration(),n=this._folderConfigurations.get(e);n?(t=i.merge(n),this._foldersConsolidatedConfigurations.set(e,t)):t=i}return t}getFolderConfigurationModelForResource(e,t){if(t&&e){const i=t.getFolder(e);if(i)return this._folderConfigurations.get(i.uri)}}toData(){return{defaults:{contents:this._defaultConfiguration.contents,overrides:this._defaultConfiguration.overrides,keys:this._defaultConfiguration.keys},policy:{contents:this._policyConfiguration.contents,overrides:this._policyConfiguration.overrides,keys:this._policyConfiguration.keys},application:{contents:this.applicationConfiguration.contents,overrides:this.applicationConfiguration.overrides,keys:this.applicationConfiguration.keys},user:{contents:this.userConfiguration.contents,overrides:this.userConfiguration.overrides,keys:this.userConfiguration.keys},workspace:{contents:this._workspaceConfiguration.contents,overrides:this._workspaceConfiguration.overrides,keys:this._workspaceConfiguration.keys},folders:[...this._folderConfigurations.keys()].reduce((e,t)=>{const{contents:i,overrides:n,keys:s}=this._folderConfigurations.get(t);return e.push([t,{contents:i,overrides:n,keys:s}]),e},[])}}static parse(e,t){const i=this.parseConfigurationModel(e.defaults,t),n=this.parseConfigurationModel(e.policy,t),s=this.parseConfigurationModel(e.application,t),r=this.parseConfigurationModel(e.user,t),a=this.parseConfigurationModel(e.workspace,t),l=e.folders.reduce((c,d)=>(c.set(ye.revive(d[0]),this.parseConfigurationModel(d[1],t)),c),new on);return new WT(i,n,s,r,gn.createEmptyModel(t),a,l,gn.createEmptyModel(t),new on,t)}static parseConfigurationModel(e,t){return new gn(e.contents,e.keys,e.overrides,void 0,t)}}class yae{constructor(e,t,i,n,s){this.change=e,this.previous=t,this.currentConfiguraiton=i,this.currentWorkspace=n,this.logService=s,this._marker=`
`,this._markerCode1=this._marker.charCodeAt(0),this._markerCode2=46,this.affectedKeys=new Set,this._previousConfiguration=void 0;for(const r of e.keys)this.affectedKeys.add(r);for(const[,r]of e.overrides)for(const a of r)this.affectedKeys.add(a);this._affectsConfigStr=this._marker;for(const r of this.affectedKeys)this._affectsConfigStr+=r+this._marker}get previousConfiguration(){return!this._previousConfiguration&&this.previous&&(this._previousConfiguration=WT.parse(this.previous.data,this.logService)),this._previousConfiguration}affectsConfiguration(e,t){const i=this._marker+e,n=this._affectsConfigStr.indexOf(i);if(n<0)return!1;const s=n+i.length;if(s>=this._affectsConfigStr.length)return!1;const r=this._affectsConfigStr.charCodeAt(s);if(r!==this._markerCode1&&r!==this._markerCode2)return!1;if(t){const a=this.previousConfiguration?this.previousConfiguration.getValue(e,t,this.previous?.workspace):void 0,l=this.currentConfiguraiton.getValue(e,t,this.currentWorkspace);return!eo(a,l)}return!0}}class wae{constructor(){this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._enabled=!0}get enabled(){return this._enabled}enable(){this._enabled=!0,this._onDidChange.fire()}disable(){this._enabled=!1,this._onDidChange.fire()}}const Wv=new wae,ox={kind:0},Sae={kind:1};function xae(o,e,t){return{kind:2,commandId:o,commandArgs:e,isBubble:t}}class Vv{constructor(e,t,i){this._log=i,this._defaultKeybindings=e,this._defaultBoundCommands=new Map;for(const n of e){const s=n.command;s&&s.charAt(0)!=="-"&&this._defaultBoundCommands.set(s,!0)}this._map=new Map,this._lookupMap=new Map,this._keybindings=Vv.handleRemovals([].concat(e).concat(t));for(let n=0,s=this._keybindings.length;n<s;n++){const r=this._keybindings[n];if(r.chords.length===0)continue;const a=r.when?.substituteConstants();a&&a.type===0||this._addKeyPress(r.chords[0],r)}}static _isTargetedForRemoval(e,t,i){if(t){for(let n=0;n<t.length;n++)if(t[n]!==e.chords[n])return!1}return!(i&&i.type!==1&&(!e.when||!Aee(i,e.when)))}static handleRemovals(e){const t=new Map;for(let n=0,s=e.length;n<s;n++){const r=e[n];if(r.command&&r.command.charAt(0)==="-"){const a=r.command.substring(1);t.has(a)?t.get(a).push(r):t.set(a,[r])}}if(t.size===0)return e;const i=[];for(let n=0,s=e.length;n<s;n++){const r=e[n];if(!r.command||r.command.length===0){i.push(r);continue}if(r.command.charAt(0)==="-")continue;const a=t.get(r.command);if(!a||!r.isDefault){i.push(r);continue}let l=!1;for(const c of a){const d=c.when;if(this._isTargetedForRemoval(r,c.chords,d)){l=!0;break}}if(!l){i.push(r);continue}}return i}_addKeyPress(e,t){const i=this._map.get(e);if(typeof i>"u"){this._map.set(e,[t]),this._addToLookupMap(t);return}for(let n=i.length-1;n>=0;n--){const s=i[n];if(s.command===t.command)continue;let r=!0;for(let a=1;a<s.chords.length&&a<t.chords.length;a++)if(s.chords[a]!==t.chords[a]){r=!1;break}r&&Vv.whenIsEntirelyIncluded(s.when,t.when)&&this._removeFromLookupMap(s)}i.push(t),this._addToLookupMap(t)}_addToLookupMap(e){if(!e.command)return;let t=this._lookupMap.get(e.command);typeof t>"u"?(t=[e],this._lookupMap.set(e.command,t)):t.push(e)}_removeFromLookupMap(e){if(!e.command)return;const t=this._lookupMap.get(e.command);if(!(typeof t>"u")){for(let i=0,n=t.length;i<n;i++)if(t[i]===e){t.splice(i,1);return}}}static whenIsEntirelyIncluded(e,t){return!t||t.type===1?!0:!e||e.type===1?!1:mP(e,t)}getKeybindings(){return this._keybindings}lookupPrimaryKeybinding(e,t){const i=this._lookupMap.get(e);if(typeof i>"u"||i.length===0)return null;if(i.length===1)return i[0];for(let n=i.length-1;n>=0;n--){const s=i[n];if(t.contextMatchesRules(s.when))return s}return i[i.length-1]}resolve(e,t,i){const n=[...t,i];this._log(`| Resolving ${n}`);const s=this._map.get(n[0]);if(s===void 0)return this._log("\\ No keybinding entries."),ox;let r=null;if(n.length<2)r=s;else{r=[];for(let l=0,c=s.length;l<c;l++){const d=s[l];if(n.length>d.chords.length)continue;let h=!0;for(let u=1;u<n.length;u++)if(d.chords[u]!==n[u]){h=!1;break}h&&r.push(d)}}const a=this._findCommand(e,r);return a?n.length<a.chords.length?(this._log(`\\ From ${r.length} keybinding entries, awaiting ${a.chords.length-n.length} more chord(s), when: ${TH(a.when)}, source: ${DH(a)}.`),Sae):(this._log(`\\ From ${r.length} keybinding entries, matched ${a.command}, when: ${TH(a.when)}, source: ${DH(a)}.`),xae(a.command,a.commandArgs,a.bubble)):(this._log(`\\ From ${r.length} keybinding entries, no when clauses matched the context.`),ox)}_findCommand(e,t){for(let i=t.length-1;i>=0;i--){const n=t[i];if(Vv._contextMatchesRules(e,n.when))return n}return null}static _contextMatchesRules(e,t){return t?t.evaluate(e):!0}}function TH(o){return o?`${o.serialize()}`:"no when condition"}function DH(o){return o.extensionId?o.isBuiltinExtension?`built-in extension ${o.extensionId}`:`user extension ${o.extensionId}`:o.isDefault?"built-in":"user"}const Lae=/^(cursor|delete|undo|redo|tab|editor\.action\.clipboard)/;class kae extends F{get onDidUpdateKeybindings(){return this._onDidUpdateKeybindings?this._onDidUpdateKeybindings.event:se.None}get inChordMode(){return this._currentChords.length>0}constructor(e,t,i,n,s){super(),this._contextKeyService=e,this._commandService=t,this._telemetryService=i,this._notificationService=n,this._logService=s,this._onDidUpdateKeybindings=this._register(new O),this._currentChords=[],this._currentChordChecker=new W4,this._currentChordStatusMessage=null,this._ignoreSingleModifiers=Yp.EMPTY,this._currentSingleModifier=null,this._currentSingleModifierClearTimeout=new qr,this._currentlyDispatchingCommandId=null,this._logging=!1}dispose(){super.dispose()}_log(e){this._logging&&this._logService.info(`[KeybindingService]: ${e}`)}getKeybindings(){return this._getResolver().getKeybindings()}lookupKeybinding(e,t){const i=this._getResolver().lookupPrimaryKeybinding(e,t||this._contextKeyService);if(i)return i.resolvedKeybinding}dispatchEvent(e,t){return this._dispatch(e,t)}softDispatch(e,t){this._log("/ Soft dispatching keyboard event");const i=this.resolveKeyboardEvent(e);if(i.hasMultipleChords())return console.warn("keyboard event should not be mapped to multiple chords"),ox;const[n]=i.getDispatchChords();if(n===null)return this._log("\\ Keyboard event cannot be dispatched"),ox;const s=this._contextKeyService.getContext(t),r=this._currentChords.map(({keypress:a})=>a);return this._getResolver().resolve(s,r,n)}_scheduleLeaveChordMode(){const e=Date.now();this._currentChordChecker.cancelAndSet(()=>{if(!this._documentHasFocus()){this._leaveChordMode();return}Date.now()-e>5e3&&this._leaveChordMode()},500)}_expectAnotherChord(e,t){switch(this._currentChords.push({keypress:e,label:t}),this._currentChords.length){case 0:throw x4("impossible");case 1:this._currentChordStatusMessage=this._notificationService.status(p("first.chord","({0}) was pressed. Waiting for second key of chord...",t));break;default:{const i=this._currentChords.map(({label:n})=>n).join(", ");this._currentChordStatusMessage=this._notificationService.status(p("next.chord","({0}) was pressed. Waiting for next key of chord...",i))}}this._scheduleLeaveChordMode(),Wv.enabled&&Wv.disable()}_leaveChordMode(){this._currentChordStatusMessage&&(this._currentChordStatusMessage.dispose(),this._currentChordStatusMessage=null),this._currentChordChecker.cancel(),this._currentChords=[],Wv.enable()}_dispatch(e,t){return this._doDispatch(this.resolveKeyboardEvent(e),t,!1)}_singleModifierDispatch(e,t){const i=this.resolveKeyboardEvent(e),[n]=i.getSingleModifierDispatchChords();if(n)return this._ignoreSingleModifiers.has(n)?(this._log(`+ Ignoring single modifier ${n} due to it being pressed together with other keys.`),this._ignoreSingleModifiers=Yp.EMPTY,this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1):(this._ignoreSingleModifiers=Yp.EMPTY,this._currentSingleModifier===null?(this._log(`+ Storing single modifier for possible chord ${n}.`),this._currentSingleModifier=n,this._currentSingleModifierClearTimeout.cancelAndSet(()=>{this._log("+ Clearing single modifier due to 300ms elapsed."),this._currentSingleModifier=null},300),!1):n===this._currentSingleModifier?(this._log(`/ Dispatching single modifier chord ${n} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,this._doDispatch(i,t,!0)):(this._log(`+ Clearing single modifier due to modifier mismatch: ${this._currentSingleModifier} ${n}`),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1));const[s]=i.getChords();return this._ignoreSingleModifiers=new Yp(s),this._currentSingleModifier!==null&&this._log("+ Clearing single modifier due to other key up."),this._currentSingleModifierClearTimeout.cancel(),this._currentSingleModifier=null,!1}_doDispatch(e,t,i=!1){let n=!1;if(e.hasMultipleChords())return console.warn("Unexpected keyboard event mapped to multiple chords"),!1;let s=null,r=null;if(i){const[d]=e.getSingleModifierDispatchChords();s=d,r=d?[d]:[]}else[s]=e.getDispatchChords(),r=this._currentChords.map(({keypress:d})=>d);if(s===null)return this._log("\\ Keyboard event cannot be dispatched in keydown phase."),n;const a=this._contextKeyService.getContext(t),l=e.getLabel(),c=this._getResolver().resolve(a,r,s);switch(c.kind){case 0:{if(this._logService.trace("KeybindingService#dispatch",l,"[ No matching keybinding ]"),this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving multi-chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(p("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}return n}case 1:return this._logService.trace("KeybindingService#dispatch",l,"[ Several keybindings match - more chords needed ]"),n=!0,this._expectAnotherChord(s,l),this._log(this._currentChords.length===1?"+ Entering multi-chord mode...":"+ Continuing multi-chord mode..."),n;case 2:{if(this._logService.trace("KeybindingService#dispatch",l,`[ Will dispatch command ${c.commandId} ]`),c.commandId===null||c.commandId===""){if(this.inChordMode){const d=this._currentChords.map(({label:h})=>h).join(", ");this._log(`+ Leaving chord mode: Nothing bound to "${d}, ${l}".`),this._notificationService.status(p("missing.chord","The key combination ({0}, {1}) is not a command.",d,l),{hideAfter:10*1e3}),this._leaveChordMode(),n=!0}}else{this.inChordMode&&this._leaveChordMode(),c.isBubble||(n=!0),this._log(`+ Invoking command ${c.commandId}.`),this._currentlyDispatchingCommandId=c.commandId;try{typeof c.commandArgs>"u"?this._commandService.executeCommand(c.commandId).then(void 0,d=>this._notificationService.warn(d)):this._commandService.executeCommand(c.commandId,c.commandArgs).then(void 0,d=>this._notificationService.warn(d))}finally{this._currentlyDispatchingCommandId=null}Lae.test(c.commandId)||this._telemetryService.publicLog2("workbenchActionExecuted",{id:c.commandId,from:"keybinding",detail:e.getUserSettingsLabel()??void 0})}return n}}}mightProducePrintableCharacter(e){return e.ctrlKey||e.metaKey?!1:e.keyCode>=31&&e.keyCode<=56||e.keyCode>=21&&e.keyCode<=30}}const Dk=class Dk{constructor(e){this._ctrlKey=e?e.ctrlKey:!1,this._shiftKey=e?e.shiftKey:!1,this._altKey=e?e.altKey:!1,this._metaKey=e?e.metaKey:!1}has(e){switch(e){case"ctrl":return this._ctrlKey;case"shift":return this._shiftKey;case"alt":return this._altKey;case"meta":return this._metaKey}}};Dk.EMPTY=new Dk(null);let Yp=Dk;class IH{constructor(e,t,i,n,s,r,a){this._resolvedKeybindingItemBrand=void 0,this.resolvedKeybinding=e,this.chords=e?hA(e.getDispatchChords()):[],e&&this.chords.length===0&&(this.chords=hA(e.getSingleModifierDispatchChords())),this.bubble=t?t.charCodeAt(0)===94:!1,this.command=this.bubble?t.substr(1):t,this.commandArgs=i,this.when=n,this.isDefault=s,this.extensionId=r,this.isBuiltinExtension=a}}function hA(o){const e=[];for(let t=0,i=o.length;t<i;t++){const n=o[t];if(!n)return[];e.push(n)}return e}class VT{constructor(e,t,i=t){this.modifierLabels=[null],this.modifierLabels[2]=e,this.modifierLabels[1]=t,this.modifierLabels[3]=i}toLabel(e,t,i){if(t.length===0)return null;const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=i(a);if(l===null)return null;n[s]=Iae(a,l,this.modifierLabels[e])}return n.join(" ")}}const P5=new VT({ctrlKey:"⌃",shiftKey:"⇧",altKey:"⌥",metaKey:"⌘",separator:""},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey",comment:["This is the short form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey",comment:["This is the short form for the Control key on the keyboard"]},"Ctrl"),shiftKey:p({key:"shiftKey",comment:["This is the short form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey",comment:["This is the short form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey",comment:["This is the short form for the Super key on the keyboard"]},"Super"),separator:"+"}),Eae=new VT({ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"optKey.long",comment:["This is the long form for the Alt/Option key on the keyboard"]},"Option"),metaKey:p({key:"cmdKey.long",comment:["This is the long form for the Command key on the keyboard"]},"Command"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"windowsKey.long",comment:["This is the long form for the Windows key on the keyboard"]},"Windows"),separator:"+"},{ctrlKey:p({key:"ctrlKey.long",comment:["This is the long form for the Control key on the keyboard"]},"Control"),shiftKey:p({key:"shiftKey.long",comment:["This is the long form for the Shift key on the keyboard"]},"Shift"),altKey:p({key:"altKey.long",comment:["This is the long form for the Alt key on the keyboard"]},"Alt"),metaKey:p({key:"superKey.long",comment:["This is the long form for the Super key on the keyboard"]},"Super"),separator:"+"}),Tae=new VT({ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Cmd",separator:"+"},{ctrlKey:"Ctrl",shiftKey:"Shift",altKey:"Alt",metaKey:"Super",separator:"+"}),Dae=new VT({ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"cmd",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"win",separator:"+"},{ctrlKey:"ctrl",shiftKey:"shift",altKey:"alt",metaKey:"meta",separator:"+"});function Iae(o,e,t){if(e===null)return"";const i=[];return o.ctrlKey&&i.push(t.ctrlKey),o.shiftKey&&i.push(t.shiftKey),o.altKey&&i.push(t.altKey),o.metaKey&&i.push(t.metaKey),e!==""&&i.push(e),i.join(t.separator)}class Nae extends tJ{constructor(e,t){if(super(),t.length===0)throw ar("chords");this._os=e,this._chords=t}getLabel(){return P5.toLabel(this._os,this._chords,e=>this._getLabel(e))}getAriaLabel(){return Eae.toLabel(this._os,this._chords,e=>this._getAriaLabel(e))}getElectronAccelerator(){return this._chords.length>1||this._chords[0].isDuplicateModifierCase()?null:Tae.toLabel(this._os,this._chords,e=>this._getElectronAccelerator(e))}getUserSettingsLabel(){return Dae.toLabel(this._os,this._chords,e=>this._getUserSettingsLabel(e))}hasMultipleChords(){return this._chords.length>1}getChords(){return this._chords.map(e=>this._getChord(e))}_getChord(e){return new eJ(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,this._getLabel(e),this._getAriaLabel(e))}getDispatchChords(){return this._chords.map(e=>this._getChordDispatch(e))}getSingleModifierDispatchChords(){return this._chords.map(e=>this._getSingleModifierChordDispatch(e))}}class fy extends Nae{constructor(e,t){super(t,e)}_keyCodeToUILabel(e){if(this._os===2)switch(e){case 15:return"←";case 16:return"↑";case 17:return"→";case 18:return"↓"}return bc.toString(e)}_getLabel(e){return e.isDuplicateModifierCase()?"":this._keyCodeToUILabel(e.keyCode)}_getAriaLabel(e){return e.isDuplicateModifierCase()?"":bc.toString(e.keyCode)}_getElectronAccelerator(e){return bc.toElectronAccelerator(e.keyCode)}_getUserSettingsLabel(e){if(e.isDuplicateModifierCase())return"";const t=bc.toUserSettingsUS(e.keyCode);return t&&t.toLowerCase()}_getChordDispatch(e){return fy.getDispatchStr(e)}static getDispatchStr(e){if(e.isModifierKey())return null;let t="";return e.ctrlKey&&(t+="ctrl+"),e.shiftKey&&(t+="shift+"),e.altKey&&(t+="alt+"),e.metaKey&&(t+="meta+"),t+=bc.toString(e.keyCode),t}_getSingleModifierChordDispatch(e){return e.keyCode===5&&!e.shiftKey&&!e.altKey&&!e.metaKey?"ctrl":e.keyCode===4&&!e.ctrlKey&&!e.altKey&&!e.metaKey?"shift":e.keyCode===6&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey?"alt":e.keyCode===57&&!e.ctrlKey&&!e.shiftKey&&!e.altKey?"meta":null}static _scanCodeToKeyCode(e){const t=T4[e];if(t!==-1)return t;switch(e){case 10:return 31;case 11:return 32;case 12:return 33;case 13:return 34;case 14:return 35;case 15:return 36;case 16:return 37;case 17:return 38;case 18:return 39;case 19:return 40;case 20:return 41;case 21:return 42;case 22:return 43;case 23:return 44;case 24:return 45;case 25:return 46;case 26:return 47;case 27:return 48;case 28:return 49;case 29:return 50;case 30:return 51;case 31:return 52;case 32:return 53;case 33:return 54;case 34:return 55;case 35:return 56;case 36:return 22;case 37:return 23;case 38:return 24;case 39:return 25;case 40:return 26;case 41:return 27;case 42:return 28;case 43:return 29;case 44:return 30;case 45:return 21;case 51:return 88;case 52:return 86;case 53:return 92;case 54:return 94;case 55:return 93;case 56:return 0;case 57:return 85;case 58:return 95;case 59:return 91;case 60:return 87;case 61:return 89;case 62:return 90;case 106:return 97}return 0}static _toKeyCodeChord(e){if(!e)return null;if(e instanceof $c)return e;const t=this._scanCodeToKeyCode(e.scanCode);return t===0?null:new $c(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,t)}static resolveKeybinding(e,t){const i=hA(e.chords.map(n=>this._toKeyCodeChord(n)));return i.length>0?[new fy(i,t)]:[]}}const E_=Je("labelService"),WG=Je("progressService"),r3=class r3{constructor(e){this.callback=e}report(e){this._value=e,this.callback(this._value)}};r3.None=Object.freeze({report(){}});let va=r3;const Yh=Je("editorProgressService");class Rae{constructor(){this._value="",this._pos=0}reset(e){return this._value=e,this._pos=0,this}next(){return this._pos+=1,this}hasNext(){return this._pos<this._value.length-1}cmp(e){const t=e.charCodeAt(0),i=this._value.charCodeAt(this._pos);return t-i}value(){return this._value[this._pos]}}class Pae{constructor(e=!0){this._caseSensitive=e}reset(e){return this._value=e,this._from=0,this._to=0,this.next()}hasNext(){return this._to<this._value.length}next(){this._from=this._to;let e=!0;for(;this._to<this._value.length;this._to++)if(this._value.charCodeAt(this._to)===46)if(e)this._from++;else break;else e=!1;return this}cmp(e){return this._caseSensitive?I4(e,this._value,0,e.length,this._from,this._to):ww(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class Aae{constructor(e=!0,t=!0){this._splitOnBackslash=e,this._caseSensitive=t}reset(e){this._from=0,this._to=0,this._value=e,this._valueLen=e.length;for(let t=e.length-1;t>=0;t--,this._valueLen--){const i=this._value.charCodeAt(t);if(!(i===47||this._splitOnBackslash&&i===92))break}return this.next()}hasNext(){return this._to<this._valueLen}next(){this._from=this._to;let e=!0;for(;this._to<this._valueLen;this._to++){const t=this._value.charCodeAt(this._to);if(t===47||this._splitOnBackslash&&t===92)if(e)this._from++;else break;else e=!1}return this}cmp(e){return this._caseSensitive?I4(e,this._value,0,e.length,this._from,this._to):ww(e,this._value,0,e.length,this._from,this._to)}value(){return this._value.substring(this._from,this._to)}}class Mae{constructor(e,t){this._ignorePathCasing=e,this._ignoreQueryAndFragment=t,this._states=[],this._stateIdx=0}reset(e){return this._value=e,this._states=[],this._value.scheme&&this._states.push(1),this._value.authority&&this._states.push(2),this._value.path&&(this._pathIterator=new Aae(!1,!this._ignorePathCasing(e)),this._pathIterator.reset(e.path),this._pathIterator.value()&&this._states.push(3)),this._ignoreQueryAndFragment(e)||(this._value.query&&this._states.push(4),this._value.fragment&&this._states.push(5)),this._stateIdx=0,this}next(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()?this._pathIterator.next():this._stateIdx+=1,this}hasNext(){return this._states[this._stateIdx]===3&&this._pathIterator.hasNext()||this._stateIdx<this._states.length-1}cmp(e){if(this._states[this._stateIdx]===1)return eP(e,this._value.scheme);if(this._states[this._stateIdx]===2)return eP(e,this._value.authority);if(this._states[this._stateIdx]===3)return this._pathIterator.cmp(e);if(this._states[this._stateIdx]===4)return jC(e,this._value.query);if(this._states[this._stateIdx]===5)return jC(e,this._value.fragment);throw new Error}value(){if(this._states[this._stateIdx]===1)return this._value.scheme;if(this._states[this._stateIdx]===2)return this._value.authority;if(this._states[this._stateIdx]===3)return this._pathIterator.value();if(this._states[this._stateIdx]===4)return this._value.query;if(this._states[this._stateIdx]===5)return this._value.fragment;throw new Error}}class PS{constructor(){this.height=1}rotateLeft(){const e=this.right;return this.right=e.left,e.left=this,this.updateHeight(),e.updateHeight(),e}rotateRight(){const e=this.left;return this.left=e.right,e.right=this,this.updateHeight(),e.updateHeight(),e}updateHeight(){this.height=1+Math.max(this.heightLeft,this.heightRight)}balanceFactor(){return this.heightRight-this.heightLeft}get heightLeft(){return this.left?.height??0}get heightRight(){return this.right?.height??0}}class Fm{static forUris(e=()=>!1,t=()=>!1){return new Fm(new Mae(e,t))}static forStrings(){return new Fm(new Rae)}static forConfigKeys(){return new Fm(new Pae)}constructor(e){this._iter=e}clear(){this._root=void 0}set(e,t){const i=this._iter.reset(e);let n;this._root||(this._root=new PS,this._root.segment=i.value());const s=[];for(n=this._root;;){const a=i.cmp(n.segment);if(a>0)n.left||(n.left=new PS,n.left.segment=i.value()),s.push([-1,n]),n=n.left;else if(a<0)n.right||(n.right=new PS,n.right.segment=i.value()),s.push([1,n]),n=n.right;else if(i.hasNext())i.next(),n.mid||(n.mid=new PS,n.mid.segment=i.value()),s.push([0,n]),n=n.mid;else break}const r=n.value;n.value=t,n.key=e;for(let a=s.length-1;a>=0;a--){const l=s[a][1];l.updateHeight();const c=l.balanceFactor();if(c<-1||c>1){const d=s[a][0],h=s[a+1][0];if(d===1&&h===1)s[a][1]=l.rotateLeft();else if(d===-1&&h===-1)s[a][1]=l.rotateRight();else if(d===1&&h===-1)l.right=s[a+1][1]=s[a+1][1].rotateRight(),s[a][1]=l.rotateLeft();else if(d===-1&&h===1)l.left=s[a+1][1]=s[a+1][1].rotateLeft(),s[a][1]=l.rotateRight();else throw new Error;if(a>0)switch(s[a-1][0]){case-1:s[a-1][1].left=s[a][1];break;case 1:s[a-1][1].right=s[a][1];break;case 0:s[a-1][1].mid=s[a][1];break}else this._root=s[0][1]}}return r}get(e){return this._getNode(e)?.value}_getNode(e){const t=this._iter.reset(e);let i=this._root;for(;i;){const n=t.cmp(i.segment);if(n>0)i=i.left;else if(n<0)i=i.right;else if(t.hasNext())t.next(),i=i.mid;else break}return i}has(e){const t=this._getNode(e);return!(t?.value===void 0&&t?.mid===void 0)}delete(e){return this._delete(e,!1)}deleteSuperstr(e){return this._delete(e,!0)}_delete(e,t){const i=this._iter.reset(e),n=[];let s=this._root;for(;s;){const r=i.cmp(s.segment);if(r>0)n.push([-1,s]),s=s.left;else if(r<0)n.push([1,s]),s=s.right;else if(i.hasNext())i.next(),n.push([0,s]),s=s.mid;else break}if(s){if(t?(s.left=void 0,s.mid=void 0,s.right=void 0,s.height=1):(s.key=void 0,s.value=void 0),!s.mid&&!s.value)if(s.left&&s.right){const r=this._min(s.right);if(r.key){const{key:a,value:l,segment:c}=r;this._delete(r.key,!1),s.key=a,s.value=l,s.segment=c}}else{const r=s.left??s.right;if(n.length>0){const[a,l]=n[n.length-1];switch(a){case-1:l.left=r;break;case 0:l.mid=r;break;case 1:l.right=r;break}}else this._root=r}for(let r=n.length-1;r>=0;r--){const a=n[r][1];a.updateHeight();const l=a.balanceFactor();if(l>1?(a.right.balanceFactor()>=0||(a.right=a.right.rotateRight()),n[r][1]=a.rotateLeft()):l<-1&&(a.left.balanceFactor()<=0||(a.left=a.left.rotateLeft()),n[r][1]=a.rotateRight()),r>0)switch(n[r-1][0]){case-1:n[r-1][1].left=n[r][1];break;case 1:n[r-1][1].right=n[r][1];break;case 0:n[r-1][1].mid=n[r][1];break}else this._root=n[0][1]}}}_min(e){for(;e.left;)e=e.left;return e}findSubstr(e){const t=this._iter.reset(e);let i=this._root,n;for(;i;){const s=t.cmp(i.segment);if(s>0)i=i.left;else if(s<0)i=i.right;else if(t.hasNext())t.next(),n=i.value||n,i=i.mid;else break}return i&&i.value||n}findSuperstr(e){return this._findSuperstrOrElement(e,!1)}_findSuperstrOrElement(e,t){const i=this._iter.reset(e);let n=this._root;for(;n;){const s=i.cmp(n.segment);if(s>0)n=n.left;else if(s<0)n=n.right;else if(i.hasNext())i.next(),n=n.mid;else return n.mid?this._entries(n.mid):t?n.value:void 0}}forEach(e){for(const[t,i]of this)e(i,t)}*[Symbol.iterator](){yield*this._entries(this._root)}_entries(e){const t=[];return this._dfsEntries(e,t),t[Symbol.iterator]()}_dfsEntries(e,t){e&&(e.left&&this._dfsEntries(e.left,t),e.value&&t.push([e.key,e.value]),e.mid&&this._dfsEntries(e.mid,t),e.right&&this._dfsEntries(e.right,t))}}const Lf=Je("contextService");function uA(o){const e=o;return typeof e?.id=="string"&&ye.isUri(e.uri)}function Oae(o){return typeof o?.id=="string"&&!uA(o)&&!Wae(o)}const Fae={id:"empty-window"};function Bae(o,e){if(typeof o=="string"||typeof o>"u")return typeof o=="string"?{id:th(o)}:Fae;const t=o;return t.configuration?{id:t.id,configPath:t.configuration}:t.folders.length===1?{id:t.id,uri:t.folders[0].uri}:{id:t.id}}function Wae(o){const e=o;return typeof e?.id=="string"&&ye.isUri(e.configPath)}class Vae{constructor(e,t){this.raw=t,this.uri=e.uri,this.index=e.index,this.name=e.name}toJSON(){return{uri:this.uri,name:this.name,index:this.index}}}const gA="code-workspace";p("codeWorkspace","Code Workspace");const VG="4064f6ec-cb38-4ad0-af64-ee6467e63c82";function Hae(o){return o.id===VG}var fA;(function(o){o.inspectTokensAction=p("inspectTokens","Developer: Inspect Tokens")})(fA||(fA={}));var rx;(function(o){o.gotoLineActionLabel=p("gotoLineActionLabel","Go to Line/Column...")})(rx||(rx={}));var pA;(function(o){o.helpQuickAccessActionLabel=p("helpQuickAccess","Show all Quick Access Providers")})(pA||(pA={}));var ax;(function(o){o.quickCommandActionLabel=p("quickCommandActionLabel","Command Palette"),o.quickCommandHelp=p("quickCommandActionHelp","Show And Run Commands")})(ax||(ax={}));var py;(function(o){o.quickOutlineActionLabel=p("quickOutlineActionLabel","Go to Symbol..."),o.quickOutlineByCategoryActionLabel=p("quickOutlineByCategoryActionLabel","Go to Symbol by Category...")})(py||(py={}));var mA;(function(o){o.editorViewAccessibleLabel=p("editorViewAccessibleLabel","Editor content")})(mA||(mA={}));var _A;(function(o){o.toggleHighContrast=p("toggleHighContrast","Toggle High Contrast Theme")})(_A||(_A={}));var bA;(function(o){o.bulkEditServiceSummary=p("bulkEditServiceSummary","Made {0} edits in {1} files")})(bA||(bA={}));const HG=Je("workspaceTrustManagementService");let T_=[],A5=[],zG=[];function AS(o,e=!1){zae(o,!1,e)}function zae(o,e,t){const i=Uae(o,e);T_.push(i),i.userConfigured?zG.push(i):A5.push(i),t&&!i.userConfigured&&T_.forEach(n=>{n.mime===i.mime||n.userConfigured||(i.extension&&n.extension===i.extension&&console.warn(`Overwriting extension <<${i.extension}>> to now point to mime <<${i.mime}>>`),i.filename&&n.filename===i.filename&&console.warn(`Overwriting filename <<${i.filename}>> to now point to mime <<${i.mime}>>`),i.filepattern&&n.filepattern===i.filepattern&&console.warn(`Overwriting filepattern <<${i.filepattern}>> to now point to mime <<${i.mime}>>`),i.firstline&&n.firstline===i.firstline&&console.warn(`Overwriting firstline <<${i.firstline}>> to now point to mime <<${i.mime}>>`))})}function Uae(o,e){return{id:o.id,mime:o.mime,filename:o.filename,extension:o.extension,filepattern:o.filepattern,firstline:o.firstline,userConfigured:e,filenameLowercase:o.filename?o.filename.toLowerCase():void 0,extensionLowercase:o.extension?o.extension.toLowerCase():void 0,filepatternLowercase:o.filepattern?YU(o.filepattern.toLowerCase()):void 0,filepatternOnPath:o.filepattern?o.filepattern.indexOf(Ri.sep)>=0:!1}}function Gae(){T_=T_.filter(o=>o.userConfigured),A5=[]}function $ae(o,e){return Kae(o,e).map(t=>t.id)}function Kae(o,e){let t;if(o)switch(o.scheme){case Oe.file:t=o.fsPath;break;case Oe.data:{t=Oh.parseMetaData(o).get(Oh.META_DATA_LABEL);break}case Oe.vscodeNotebookCell:t=void 0;break;default:t=o.path}if(!t)return[{id:"unknown",mime:vi.unknown}];t=t.toLowerCase();const i=th(t),n=NH(t,i,zG);if(n)return[n,{id:hs,mime:vi.text}];const s=NH(t,i,A5);if(s)return[s,{id:hs,mime:vi.text}];if(e){const r=jae(e);if(r)return[r,{id:hs,mime:vi.text}]}return[{id:"unknown",mime:vi.unknown}]}function NH(o,e,t){let i,n,s;for(let r=t.length-1;r>=0;r--){const a=t[r];if(e===a.filenameLowercase){i=a;break}if(a.filepattern&&(!n||a.filepattern.length>n.filepattern.length)){const l=a.filepatternOnPath?o:e;a.filepatternLowercase?.(l)&&(n=a)}a.extension&&(!s||a.extension.length>s.extension.length)&&e.endsWith(a.extensionLowercase)&&(s=a)}if(i)return i;if(n)return n;if(s)return s}function jae(o){if(O4(o)&&(o=o.substr(1)),o.length>0)for(let e=T_.length-1;e>=0;e--){const t=T_[e];if(!t.firstline)continue;const i=o.match(t.firstline);if(i&&i.length>0)return t}}const MS=Object.prototype.hasOwnProperty,RH="vs.editor.nullLanguage";class qae{constructor(){this._languageIdToLanguage=[],this._languageToLanguageId=new Map,this._register(RH,0),this._register(hs,1),this._nextLanguageId=2}_register(e,t){this._languageIdToLanguage[t]=e,this._languageToLanguageId.set(e,t)}register(e){if(this._languageToLanguageId.has(e))return;const t=this._nextLanguageId++;this._register(e,t)}encodeLanguageId(e){return this._languageToLanguageId.get(e)||0}decodeLanguageId(e){return this._languageIdToLanguage[e]||RH}}const LC=class LC extends F{constructor(e=!0,t=!1){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,LC.instanceCount++,this._warnOnOverwrite=t,this.languageIdCodec=new qae,this._dynamicLanguages=[],this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},e&&(this._initializeFromRegistry(),this._register(__.onDidChangeLanguages(i=>{this._initializeFromRegistry()})))}dispose(){LC.instanceCount--,super.dispose()}_initializeFromRegistry(){this._languages={},this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Gae();const e=[].concat(__.getLanguages()).concat(this._dynamicLanguages);this._registerLanguages(e)}_registerLanguages(e){for(const t of e)this._registerLanguage(t);this._mimeTypesMap={},this._nameMap={},this._lowercaseNameMap={},Object.keys(this._languages).forEach(t=>{const i=this._languages[t];i.name&&(this._nameMap[i.name]=i.identifier),i.aliases.forEach(n=>{this._lowercaseNameMap[n.toLowerCase()]=i.identifier}),i.mimetypes.forEach(n=>{this._mimeTypesMap[n]=i.identifier})}),ai.as(Zr.Configuration).registerOverrideIdentifiers(this.getRegisteredLanguageIds()),this._onDidChange.fire()}_registerLanguage(e){const t=e.id;let i;MS.call(this._languages,t)?i=this._languages[t]:(this.languageIdCodec.register(t),i={identifier:t,name:null,mimetypes:[],aliases:[],extensions:[],filenames:[],configurationFiles:[],icons:[]},this._languages[t]=i),this._mergeLanguage(i,e)}_mergeLanguage(e,t){const i=t.id;let n=null;if(Array.isArray(t.mimetypes)&&t.mimetypes.length>0&&(e.mimetypes.push(...t.mimetypes),n=t.mimetypes[0]),n||(n=`text/x-${i}`,e.mimetypes.push(n)),Array.isArray(t.extensions)){t.configuration?e.extensions=t.extensions.concat(e.extensions):e.extensions=e.extensions.concat(t.extensions);for(const a of t.extensions)AS({id:i,mime:n,extension:a},this._warnOnOverwrite)}if(Array.isArray(t.filenames))for(const a of t.filenames)AS({id:i,mime:n,filename:a},this._warnOnOverwrite),e.filenames.push(a);if(Array.isArray(t.filenamePatterns))for(const a of t.filenamePatterns)AS({id:i,mime:n,filepattern:a},this._warnOnOverwrite);if(typeof t.firstLine=="string"&&t.firstLine.length>0){let a=t.firstLine;a.charAt(0)!=="^"&&(a="^"+a);try{const l=new RegExp(a);HQ(l)||AS({id:i,mime:n,firstline:l},this._warnOnOverwrite)}catch(l){console.warn(`[${t.id}]: Invalid regular expression \`${a}\`: `,l)}}e.aliases.push(i);let s=null;if(typeof t.aliases<"u"&&Array.isArray(t.aliases)&&(t.aliases.length===0?s=[null]:s=t.aliases),s!==null)for(const a of s)!a||a.length===0||e.aliases.push(a);const r=s!==null&&s.length>0;if(!(r&&s[0]===null)){const a=(r?s[0]:null)||i;(r||!e.name)&&(e.name=a)}t.configuration&&e.configurationFiles.push(t.configuration),t.icon&&e.icons.push(t.icon)}isRegisteredLanguageId(e){return e?MS.call(this._languages,e):!1}getRegisteredLanguageIds(){return Object.keys(this._languages)}getLanguageIdByLanguageName(e){const t=e.toLowerCase();return MS.call(this._lowercaseNameMap,t)?this._lowercaseNameMap[t]:null}getLanguageIdByMimeType(e){return e&&MS.call(this._mimeTypesMap,e)?this._mimeTypesMap[e]:null}guessLanguageIdByFilepathOrFirstLine(e,t){return!e&&!t?[]:$ae(e,t)}};LC.instanceCount=0;let vA=LC;const Wo=(o,e)=>o===e;function lx(o=Wo){return(e,t)=>ei(e,t,o)}function Zae(){return(o,e)=>o.equals(e)}function CA(o,e,t){if(t!==void 0){const i=o;return i==null||e===void 0||e===null?e===i:t(i,e)}else{const i=o;return(n,s)=>n==null||s===void 0||s===null?s===n:i(n,s)}}function cx(o,e){if(o===e)return!0;if(Array.isArray(o)&&Array.isArray(e)){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!cx(o[t],e[t]))return!1;return!0}if(o&&typeof o=="object"&&e&&typeof e=="object"&&Object.getPrototypeOf(o)===Object.prototype&&Object.getPrototypeOf(e)===Object.prototype){const t=o,i=e,n=Object.keys(t),s=Object.keys(i),r=new Set(s);if(n.length!==s.length)return!1;for(const a of n)if(!r.has(a)||!cx(t[a],i[a]))return!1;return!0}return!1}class On{constructor(e,t,i){this.owner=e,this.debugNameSource=t,this.referenceFn=i}getDebugName(e){return Yae(e,this)}}const PH=new Map,yA=new WeakMap;function Yae(o,e){const t=yA.get(o);if(t)return t;const i=Xae(o,e);if(i){let n=PH.get(i)??0;n++,PH.set(i,n);const s=n===1?i:`${i}#${n}`;return yA.set(o,s),s}}function Xae(o,e){const t=yA.get(o);if(t)return t;const i=e.owner?Jae(e.owner)+".":"";let n;const s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(n=s(),n!==void 0)return i+n}else return i+s;const r=e.referenceFn;if(r!==void 0&&(n=M5(r),n!==void 0))return i+n;if(e.owner!==void 0){const a=Qae(e.owner,o);if(a!==void 0)return i+a}}function Qae(o,e){for(const t in o)if(o[t]===e)return t}const AH=new Map,MH=new WeakMap;function Jae(o){const e=MH.get(o);if(e)return e;const t=ele(o);let i=AH.get(t)??0;i++,AH.set(t,i);const n=i===1?t:`${t}#${i}`;return MH.set(o,n),n}function ele(o){const e=o.constructor;return e?e.name:"Object"}function M5(o){const e=o.toString(),i=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(i?i[1]:void 0)?.trim()}let tle;function UG(){return tle}let GG;function ile(o){GG=o}let $G;function nle(o){$G=o}let wA;function sle(o){wA=o}class KG{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,t){const i=t===void 0?void 0:e,n=t===void 0?e:t;return wA({owner:i,debugName:()=>{const s=M5(n);if(s!==void 0)return s;const a=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(n.toString());if(a)return`${this.debugName}.${a[2]}`;if(!i)return`${this.debugName} (mapped)`},debugReferenceFn:n},s=>n(this.read(s),s))}flatten(){return wA({owner:void 0,debugName:()=>`${this.debugName} (flattened)`},e=>this.read(e).read(e))}recomputeInitiallyAndOnChange(e,t){return e.add(GG(this,t)),this}keepObserved(e){return e.add($G(this)),this}}class hb extends KG{constructor(){super(...arguments),this.observers=new Set}addObserver(e){const t=this.observers.size;this.observers.add(e),t===0&&this.onFirstObserverAdded()}removeObserver(e){this.observers.delete(e)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}}function oi(o,e){const t=new ub(o,e);try{o(t)}finally{t.finish()}}let OS;function pv(o){if(OS)o(OS);else{const e=new ub(o,void 0);OS=e;try{o(e)}finally{e.finish(),OS=void 0}}}async function jG(o,e){const t=new ub(o,e);try{await o(t)}finally{t.finish()}}function kf(o,e,t){o?e(o):oi(e,t)}class ub{constructor(e,t){this._fn=e,this._getDebugName=t,this.updatingObservers=[]}getDebugName(){return this._getDebugName?this._getDebugName():M5(this._fn)}updateObserver(e,t){this.updatingObservers.push({observer:e,observable:t}),e.beginUpdate(t)}finish(){const e=this.updatingObservers;for(let t=0;t<e.length;t++){const{observer:i,observable:n}=e[t];i.endUpdate(n)}this.updatingObservers=null}}function $e(o,e){let t;return typeof o=="string"?t=new On(void 0,o,void 0):t=new On(o,void 0,void 0),new O5(t,e,Wo)}class O5 extends hb{get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._value=t}get(){return this._value}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new ub(()=>{},()=>`Setting ${this.debugName}`));try{const s=this._value;this._setValue(e),UG()?.handleObservableChanged(this,{oldValue:s,newValue:e,change:i,didChange:!0,hadValue:!0});for(const r of this.observers)t.updateObserver(r,this),r.handleChange(this,i)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function my(o,e){let t;return typeof o=="string"?t=new On(void 0,o,void 0):t=new On(o,void 0,void 0),new ole(t,e,Wo)}class ole extends O5{_setValue(e){this._value!==e&&(this._value&&this._value.dispose(),this._value=e)}dispose(){this._value?.dispose()}}function me(o,e){return e!==void 0?new Ef(new On(o,void 0,e),e,void 0,void 0,void 0,Wo):new Ef(new On(void 0,void 0,o),o,void 0,void 0,void 0,Wo)}function Mw(o,e,t){return new rle(new On(o,void 0,e),e,void 0,void 0,void 0,Wo,t)}function Eo(o,e){return new Ef(new On(o.owner,o.debugName,o.debugReferenceFn),e,void 0,void 0,o.onLastObserverRemoved,o.equalsFn??Wo)}sle(Eo);function qG(o,e){return new Ef(new On(o.owner,o.debugName,void 0),e,o.createEmptyChangeSummary,o.handleChange,void 0,o.equalityComparer??Wo)}function Xh(o,e){let t,i;e===void 0?(t=o,i=void 0):(i=o,t=e);const n=new $;return new Ef(new On(i,void 0,t),s=>(n.clear(),t(s,n)),void 0,void 0,()=>n.dispose(),Wo)}function Kn(o,e){let t,i;e===void 0?(t=o,i=void 0):(i=o,t=e);let n;return new Ef(new On(i,void 0,t),s=>{n?n.clear():n=new $;const r=t(s);return r&&n.add(r),r},void 0,void 0,()=>{n&&(n.dispose(),n=void 0)},Wo)}class Ef extends hb{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n,s=void 0,r){super(),this._debugNameData=e,this._computeFn=t,this.createChangeSummary=i,this._handleChange=n,this._handleLastObserverRemoved=s,this._equalityComparator=r,this.state=0,this.value=void 0,this.updateCount=0,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=void 0,this.changeSummary=this.createChangeSummary?.()}onLastObserverRemoved(){this.state=0,this.value=void 0;for(const e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),this._handleLastObserverRemoved?.()}get(){if(this.observers.size===0){const e=this._computeFn(this,this.createChangeSummary?.());return this.onLastObserverRemoved(),e}else{do{if(this.state===1){for(const e of this.dependencies)if(e.reportChanges(),this.state===2)break}this.state===1&&(this.state=3),this._recomputeIfNeeded()}while(this.state!==3);return this.value}}_recomputeIfNeeded(){if(this.state===3)return;const e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e;const t=this.state!==0,i=this.value;this.state=3;const n=this.changeSummary;this.changeSummary=this.createChangeSummary?.();try{this.value=this._computeFn(this,n)}finally{for(const r of this.dependenciesToBeRemoved)r.removeObserver(this);this.dependenciesToBeRemoved.clear()}if(t&&!this._equalityComparator(i,this.value))for(const r of this.observers)r.handleChange(this,void 0)}toString(){return`LazyDerived<${this.debugName}>`}beginUpdate(e){this.updateCount++;const t=this.updateCount===1;if(this.state===3&&(this.state=1,!t))for(const i of this.observers)i.handlePossibleChange(this);if(t)for(const i of this.observers)i.beginUpdate(this)}endUpdate(e){if(this.updateCount--,this.updateCount===0){const t=[...this.observers];for(const i of t)i.endUpdate(this)}yf(()=>this.updateCount>=0)}handlePossibleChange(e){if(this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){this.state=1;for(const t of this.observers)t.handlePossibleChange(this)}}handleChange(e,t){if(this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)){const i=this._handleChange?this._handleChange({changedObservable:e,change:t,didChange:s=>s===e},this.changeSummary):!0,n=this.state===3;if(i&&(this.state===1||n)&&(this.state=2,n))for(const s of this.observers)s.handlePossibleChange(this)}}readObservable(e){e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}addObserver(e){const t=!this.observers.has(e)&&this.updateCount>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this.updateCount>0;super.removeObserver(e),t&&e.endUpdate(this)}}class rle extends Ef{constructor(e,t,i,n,s=void 0,r,a){super(e,t,i,n,s,r),this.set=a}}function Re(o){return new HT(new On(void 0,void 0,o),o,void 0,void 0)}function Ow(o,e){return new HT(new On(o.owner,o.debugName,o.debugReferenceFn??e),e,void 0,void 0)}function Fw(o,e){return new HT(new On(o.owner,o.debugName,o.debugReferenceFn??e),e,o.createEmptyChangeSummary,o.handleChange)}function ale(o,e){const t=new $,i=Fw({owner:o.owner,debugName:o.debugName,debugReferenceFn:o.debugReferenceFn??e,createEmptyChangeSummary:o.createEmptyChangeSummary,handleChange:o.handleChange},(n,s)=>{t.clear(),e(n,s,t)});return ve(()=>{i.dispose(),t.dispose()})}function Is(o){const e=new $,t=Ow({owner:void 0,debugName:void 0,debugReferenceFn:o},i=>{e.clear(),o(i,e)});return ve(()=>{t.dispose(),e.dispose()})}class HT{get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}constructor(e,t,i,n){this._debugNameData=e,this._runFn=t,this.createChangeSummary=i,this._handleChange=n,this.state=2,this.updateCount=0,this.disposed=!1,this.dependencies=new Set,this.dependenciesToBeRemoved=new Set,this.changeSummary=this.createChangeSummary?.(),this._runIfNeeded()}dispose(){this.disposed=!0;for(const e of this.dependencies)e.removeObserver(this);this.dependencies.clear()}_runIfNeeded(){if(this.state===3)return;const e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;const t=this.disposed;try{if(!t){UG()?.handleAutorunTriggered(this);const i=this.changeSummary;this.changeSummary=this.createChangeSummary?.(),this._runFn(this,i)}}finally{for(const i of this.dependenciesToBeRemoved)i.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(const e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,yf(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,t){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:t,didChange:n=>n===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);const t=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),t}}(function(o){o.Observer=HT})(Re||(Re={}));function rr(o){return new lle(o)}class lle extends KG{constructor(e){super(),this.value=e}get debugName(){return this.toString()}get(){return this.value}addObserver(e){}removeObserver(e){}toString(){return`Const: ${this.value}`}}function yt(...o){let e,t,i;return o.length===3?[e,t,i]=o:[t,i]=o,new Kd(new On(e,void 0,i),t,i,()=>Kd.globalTransaction,Wo)}function cle(o,e,t){return new Kd(new On(o.owner,o.debugName,o.debugReferenceFn??t),e,t,()=>Kd.globalTransaction,o.equalsFn??Wo)}class Kd extends hb{constructor(e,t,i,n,s){super(),this._debugNameData=e,this.event=t,this._getValue=i,this._getTransaction=n,this._equalityComparator=s,this.hasValue=!1,this.handleEvent=r=>{const a=this._getValue(r),l=this.value;(!this.hasValue||!this._equalityComparator(l,a))&&(this.value=a,this.hasValue&&kf(this._getTransaction(),d=>{for(const h of this.observers)d.updateObserver(h,this),h.handleChange(this,void 0)},()=>{const d=this.getDebugName();return"Event fired"+(d?`: ${d}`:"")}),this.hasValue=!0)}}getDebugName(){return this._debugNameData.getDebugName(this)}get debugName(){const e=this.getDebugName();return"From Event"+(e?`: ${e}`:"")}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0,this.hasValue=!1,this.value=void 0}get(){return this.subscription?(this.hasValue||this.handleEvent(void 0),this.value):this._getValue(void 0)}}(function(o){o.Observer=Kd;function e(t,i){let n=!1;Kd.globalTransaction===void 0&&(Kd.globalTransaction=t,n=!0);try{i()}finally{n&&(Kd.globalTransaction=void 0)}}o.batchEventsGlobally=e})(yt||(yt={}));function Sn(o,e){return new dle(o,e)}class dle extends hb{constructor(e,t){super(),this.debugName=e,this.event=t,this.handleEvent=()=>{oi(i=>{for(const n of this.observers)i.updateObserver(n,this),n.handleChange(this,void 0)},()=>this.debugName)}}onFirstObserverAdded(){this.subscription=this.event(this.handleEvent)}onLastObserverRemoved(){this.subscription.dispose(),this.subscription=void 0}get(){}}function gb(o){return typeof o=="string"?new OH(o):new OH(void 0,o)}class OH extends hb{get debugName(){return new On(this._owner,this._debugName,void 0).getDebugName(this)??"Observable Signal"}toString(){return this.debugName}constructor(e,t){super(),this._debugName=e,this._owner=t}trigger(e,t){if(!e){oi(i=>{this.trigger(i,t)},()=>`Trigger signal ${this.debugName}`);return}for(const i of this.observers)e.updateObserver(i,this),i.handleChange(this,t)}get(){}}function hle(o){const e=new ZG(!1,void 0);return o.addObserver(e),ve(()=>{o.removeObserver(e)})}nle(hle);function fb(o,e){const t=new ZG(!0,e);return o.addObserver(t),e?e(o.get()):o.reportChanges(),ve(()=>{o.removeObserver(t)})}ile(fb);class ZG{constructor(e,t){this._forceRecompute=e,this._handleValue=t,this._counter=0}beginUpdate(e){this._counter++}endUpdate(e){this._counter--,this._counter===0&&this._forceRecompute&&(this._handleValue?this._handleValue(e.get()):e.reportChanges())}handlePossibleChange(e){}handleChange(e,t){}}function Bw(o,e){let t;return Eo({owner:o,debugReferenceFn:e},n=>(t=e(n,t),t))}function ule(o,e,t,i){let n=new FH(t,i);return Eo({debugReferenceFn:t,owner:o,onLastObserverRemoved:()=>{n.dispose(),n=new FH(t)}},r=>(n.setItems(e.read(r)),n.getItems()))}class FH{constructor(e,t){this._map=e,this._keySelector=t,this._cache=new Map,this._items=[]}dispose(){this._cache.forEach(e=>e.store.dispose()),this._cache.clear()}setItems(e){const t=[],i=new Set(this._cache.keys());for(const n of e){const s=this._keySelector?this._keySelector(n):n;let r=this._cache.get(s);if(r)i.delete(s);else{const a=new $;r={out:this._map(n,a),store:a},this._cache.set(s,r)}t.push(r.out)}for(const n of i)this._cache.get(n).store.dispose(),this._cache.delete(n);this._items=t}getItems(){return this._items}}function gle(o,e){return Bw(o,(t,i)=>i??e(t))}class zT{static fromFn(e){return new zT(e())}constructor(e){this._value=$e(this,void 0),this.promiseResult=this._value,this.promise=e.then(t=>(oi(i=>{this._value.set(new BH(t,void 0),i)}),t),t=>{throw oi(i=>{this._value.set(new BH(void 0,t),i)}),t})}}class BH{constructor(e,t){this.data=e,this.error=t}}function YG(o,e,t,i){return e||(e=n=>n!=null),new Promise((n,s)=>{let r=!0,a=!1;const l=o.map(d=>({isFinished:e(d),error:t?t(d):!1,state:d})),c=Re(d=>{const{isFinished:h,error:u,state:g}=l.read(d);(h||u)&&(r?a=!0:c.dispose(),u?s(u===!0?g:u):n(g))});if(i){const d=i.onCancellationRequested(()=>{c.dispose(),d.dispose(),s(new Hr)});if(i.isCancellationRequested){c.dispose(),d.dispose(),s(new Hr);return}}r=!1,a&&c.dispose()})}class fle extends hb{get debugName(){return this._debugNameData.getDebugName(this)??"LazyObservableValue"}constructor(e,t,i){super(),this._debugNameData=e,this._equalityComparator=i,this._isUpToDate=!0,this._deltas=[],this._updateCounter=0,this._value=t}get(){return this._update(),this._value}_update(){if(!this._isUpToDate)if(this._isUpToDate=!0,this._deltas.length>0){for(const e of this.observers)for(const t of this._deltas)e.handleChange(this,t);this._deltas.length=0}else for(const e of this.observers)e.handleChange(this,void 0)}_beginUpdate(){if(this._updateCounter++,this._updateCounter===1)for(const e of this.observers)e.beginUpdate(this)}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){this._update();const e=[...this.observers];for(const t of e)t.endUpdate(this)}}addObserver(e){const t=!this.observers.has(e)&&this._updateCounter>0;super.addObserver(e),t&&e.beginUpdate(this)}removeObserver(e){const t=this.observers.has(e)&&this._updateCounter>0;super.removeObserver(e),t&&e.endUpdate(this)}set(e,t,i){if(i===void 0&&this._equalityComparator(this._value,e))return;let n;t||(t=n=new ub(()=>{},()=>`Setting ${this.debugName}`));try{if(this._isUpToDate=!1,this._setValue(e),i!==void 0&&this._deltas.push(i),t.updateObserver({beginUpdate:()=>this._beginUpdate(),endUpdate:()=>this._endUpdate(),handleChange:(s,r)=>{},handlePossibleChange:s=>{}},this),this._updateCounter>1)for(const s of this.observers)s.handlePossibleChange(this)}finally{n&&n.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(e){this._value=e}}function SA(o,e){return o.lazy?new fle(new On(o.owner,o.debugName,void 0),e,o.equalsFn??Wo):new O5(new On(o.owner,o.debugName,void 0),e,o.equalsFn??Wo)}const kC=class kC extends F{constructor(e=!1){super(),this._onDidRequestBasicLanguageFeatures=this._register(new O),this.onDidRequestBasicLanguageFeatures=this._onDidRequestBasicLanguageFeatures.event,this._onDidRequestRichLanguageFeatures=this._register(new O),this.onDidRequestRichLanguageFeatures=this._onDidRequestRichLanguageFeatures.event,this._onDidChange=this._register(new O({leakWarningThreshold:200})),this.onDidChange=this._onDidChange.event,this._requestedBasicLanguages=new Set,this._requestedRichLanguages=new Set,kC.instanceCount++,this._registry=this._register(new vA(!0,e)),this.languageIdCodec=this._registry.languageIdCodec,this._register(this._registry.onDidChange(()=>this._onDidChange.fire()))}dispose(){kC.instanceCount--,super.dispose()}isRegisteredLanguageId(e){return this._registry.isRegisteredLanguageId(e)}getLanguageIdByLanguageName(e){return this._registry.getLanguageIdByLanguageName(e)}getLanguageIdByMimeType(e){return this._registry.getLanguageIdByMimeType(e)}guessLanguageIdByFilepathOrFirstLine(e,t){const i=this._registry.guessLanguageIdByFilepathOrFirstLine(e,t);return _4(i,null)}createById(e){return new WH(this.onDidChange,()=>this._createAndGetLanguageIdentifier(e))}createByFilepathOrFirstLine(e,t){return new WH(this.onDidChange,()=>{const i=this.guessLanguageIdByFilepathOrFirstLine(e,t);return this._createAndGetLanguageIdentifier(i)})}_createAndGetLanguageIdentifier(e){return(!e||!this.isRegisteredLanguageId(e))&&(e=hs),e}requestBasicLanguageFeatures(e){this._requestedBasicLanguages.has(e)||(this._requestedBasicLanguages.add(e),this._onDidRequestBasicLanguageFeatures.fire(e))}requestRichLanguageFeatures(e){this._requestedRichLanguages.has(e)||(this._requestedRichLanguages.add(e),this.requestBasicLanguageFeatures(e),gi.getOrCreate(e),this._onDidRequestRichLanguageFeatures.fire(e))}};kC.instanceCount=0;let xA=kC;class WH{constructor(e,t){this._value=yt(this,e,()=>t()),this.onDidChange=se.fromObservable(this._value)}get languageId(){return this._value.get()}}const _y={RESOURCES:"ResourceURLs",TEXT:vi.text,INTERNAL_URI_LIST:"application/vnd.code.uri-list"},ple=()=>({get delay(){return-1},dispose:()=>{},showHover:()=>{}});let UT=ple;const mle=new Da(()=>UT("mouse",!1)),_le=new Da(()=>UT("element",!1));function ble(o){UT=o}function bs(o){return o==="element"?_le.value:mle.value}function D_(){return UT("element",!0)}let XG={showHover:()=>{},hideHover:()=>{},showAndFocusLastHover:()=>{},setupManagedHover:()=>null,showManagedHover:()=>{}};function vle(o){XG=o}function Ba(){return XG}class Cle{constructor(e){this.spliceables=e}splice(e,t,i){this.spliceables.forEach(n=>n.splice(e,t,i))}}class du extends Error{constructor(e,t){super(`ListError [${e}] ${t}`)}}function VH(o,e){const t=[];for(const i of e){if(o.start>=i.range.end)continue;if(o.end<i.range.start)break;const n=In.intersect(o,i.range);In.isEmpty(n)||t.push({range:n,size:i.size})}return t}function LA({start:o,end:e},t){return{start:o+t,end:e+t}}function yle(o){const e=[];let t=null;for(const i of o){const n=i.range.start,s=i.range.end,r=i.size;if(t&&r===t.size){t.range.end=s;continue}t={range:{start:n,end:s},size:r},e.push(t)}return e}function wle(...o){return yle(o.reduce((e,t)=>e.concat(t),[]))}class Sle{get paddingTop(){return this._paddingTop}set paddingTop(e){this._size=this._size+e-this._paddingTop,this._paddingTop=e}constructor(e){this.groups=[],this._size=0,this._paddingTop=0,this._paddingTop=e??0,this._size=this._paddingTop}splice(e,t,i=[]){const n=i.length-t,s=VH({start:0,end:e},this.groups),r=VH({start:e+t,end:Number.POSITIVE_INFINITY},this.groups).map(l=>({range:LA(l.range,n),size:l.size})),a=i.map((l,c)=>({range:{start:e+c,end:e+c+1},size:l.size}));this.groups=wle(s,a,r),this._size=this._paddingTop+this.groups.reduce((l,c)=>l+c.size*(c.range.end-c.range.start),0)}get count(){const e=this.groups.length;return e?this.groups[e-1].range.end:0}get size(){return this._size}indexAt(e){if(e<0)return-1;if(e<this._paddingTop)return 0;let t=0,i=this._paddingTop;for(const n of this.groups){const s=n.range.end-n.range.start,r=i+s*n.size;if(e<r)return t+Math.floor((e-i)/n.size);t+=s,i=r}return t}indexAfter(e){return Math.min(this.indexAt(e)+1,this.count)}positionAt(e){if(e<0)return-1;let t=0,i=0;for(const n of this.groups){const s=n.range.end-n.range.start,r=i+s;if(e<r)return this._paddingTop+t+(e-i)*n.size;t+=s*n.size,i=r}return-1}}class xle{constructor(e){this.renderers=e,this.cache=new Map,this.transactionNodesPendingRemoval=new Set,this.inTransaction=!1}alloc(e){let t=this.getTemplateCache(e).pop(),i=!1;if(t)i=this.transactionNodesPendingRemoval.has(t.domNode),i&&this.transactionNodesPendingRemoval.delete(t.domNode);else{const n=ie(".monaco-list-row"),r=this.getRenderer(e).renderTemplate(n);t={domNode:n,templateId:e,templateData:r}}return{row:t,isReusingConnectedDomNode:i}}release(e){e&&this.releaseRow(e)}transact(e){if(this.inTransaction)throw new Error("Already in transaction");this.inTransaction=!0;try{e()}finally{for(const t of this.transactionNodesPendingRemoval)this.doRemoveNode(t);this.transactionNodesPendingRemoval.clear(),this.inTransaction=!1}}releaseRow(e){const{domNode:t,templateId:i}=e;t&&(this.inTransaction?this.transactionNodesPendingRemoval.add(t):this.doRemoveNode(t)),this.getTemplateCache(i).push(e)}doRemoveNode(e){e.classList.remove("scrolling"),e.remove()}getTemplateCache(e){let t=this.cache.get(e);return t||(t=[],this.cache.set(e,t)),t}dispose(){this.cache.forEach((e,t)=>{for(const i of e)this.getRenderer(t).disposeTemplate(i.templateData),i.templateData=null}),this.cache.clear(),this.transactionNodesPendingRemoval.clear()}getRenderer(e){const t=this.renderers.get(e);if(!t)throw new Error(`No renderer found for ${e}`);return t}}var od=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};const hu={CurrentDragAndDropData:void 0},Ka={useShadows:!0,verticalScrollMode:1,setRowLineHeight:!0,setRowHeight:!0,supportDynamicHeights:!1,dnd:{getDragElements(o){return[o]},getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}},horizontalScrolling:!1,transformOptimization:!0,alwaysConsumeMouseWheel:!0};class Ww{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class Lle{constructor(e){this.elements=e}update(){}getData(){return this.elements}}class kle{constructor(){this.types=[],this.files=[]}update(e){if(e.types&&this.types.splice(0,this.types.length,...e.types),e.files){this.files.splice(0,this.files.length);for(let t=0;t<e.files.length;t++){const i=e.files.item(t);i&&(i.size||i.type)&&this.files.push(i)}}}getData(){return{types:this.types,files:this.files}}}function Ele(o,e){return Array.isArray(o)&&Array.isArray(e)?ei(o,e):o===e}class Tle{constructor(e){e?.getSetSize?this.getSetSize=e.getSetSize.bind(e):this.getSetSize=(t,i,n)=>n,e?.getPosInSet?this.getPosInSet=e.getPosInSet.bind(e):this.getPosInSet=(t,i)=>i+1,e?.getRole?this.getRole=e.getRole.bind(e):this.getRole=t=>"listitem",e?.isChecked?this.isChecked=e.isChecked.bind(e):this.isChecked=t=>{}}}const Ik=class Ik{get contentHeight(){return this.rangeMap.size}get onDidScroll(){return this.scrollableElement.onScroll}get scrollableElementDomNode(){return this.scrollableElement.getDomNode()}get horizontalScrolling(){return this._horizontalScrolling}set horizontalScrolling(e){if(e!==this._horizontalScrolling){if(e&&this.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");if(this._horizontalScrolling=e,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this._horizontalScrolling){for(const t of this.items)this.measureItemWidth(t);this.updateScrollWidth(),this.scrollableElement.setScrollDimensions({width:JD(this.domNode)}),this.rowsContainer.style.width=`${Math.max(this.scrollWidth||0,this.renderWidth)}px`}else this.scrollableElementWidthDelayer.cancel(),this.scrollableElement.setScrollDimensions({width:this.renderWidth,scrollWidth:this.renderWidth}),this.rowsContainer.style.width=""}}constructor(e,t,i,n=Ka){if(this.virtualDelegate=t,this.domId=`list_id_${++Ik.InstanceCount}`,this.renderers=new Map,this.renderWidth=0,this._scrollHeight=0,this.scrollableElementUpdateDisposable=null,this.scrollableElementWidthDelayer=new hr(50),this.splicing=!1,this.dragOverAnimationStopDisposable=F.None,this.dragOverMouseY=0,this.canDrop=!1,this.currentDragFeedbackDisposable=F.None,this.onDragLeaveTimeout=F.None,this.disposables=new $,this._onDidChangeContentHeight=new O,this._onDidChangeContentWidth=new O,this.onDidChangeContentHeight=se.latch(this._onDidChangeContentHeight.event,void 0,this.disposables),this._horizontalScrolling=!1,n.horizontalScrolling&&n.supportDynamicHeights)throw new Error("Horizontal scrolling and dynamic heights not supported simultaneously");this.items=[],this.itemId=0,this.rangeMap=this.createRangeMap(n.paddingTop??0);for(const r of i)this.renderers.set(r.templateId,r);this.cache=this.disposables.add(new xle(this.renderers)),this.lastRenderTop=0,this.lastRenderHeight=0,this.domNode=document.createElement("div"),this.domNode.className="monaco-list",this.domNode.classList.add(this.domId),this.domNode.tabIndex=0,this.domNode.classList.toggle("mouse-support",typeof n.mouseSupport=="boolean"?n.mouseSupport:!0),this._horizontalScrolling=n.horizontalScrolling??Ka.horizontalScrolling,this.domNode.classList.toggle("horizontal-scrolling",this._horizontalScrolling),this.paddingBottom=typeof n.paddingBottom>"u"?0:n.paddingBottom,this.accessibilityProvider=new Tle(n.accessibilityProvider),this.rowsContainer=document.createElement("div"),this.rowsContainer.className="monaco-list-rows",(n.transformOptimization??Ka.transformOptimization)&&(this.rowsContainer.style.transform="translate3d(0px, 0px, 0px)",this.rowsContainer.style.overflow="hidden",this.rowsContainer.style.contain="strict"),this.disposables.add(Mn.addTarget(this.rowsContainer)),this.scrollable=this.disposables.add(new db({forceIntegerValues:!0,smoothScrollDuration:n.smoothScrolling??!1?125:0,scheduleAtNextAnimationFrame:r=>ao(xe(this.domNode),r)})),this.scrollableElement=this.disposables.add(new RT(this.rowsContainer,{alwaysConsumeMouseWheel:n.alwaysConsumeMouseWheel??Ka.alwaysConsumeMouseWheel,horizontal:1,vertical:n.verticalScrollMode??Ka.verticalScrollMode,useShadows:n.useShadows??Ka.useShadows,mouseWheelScrollSensitivity:n.mouseWheelScrollSensitivity,fastScrollSensitivity:n.fastScrollSensitivity,scrollByPage:n.scrollByPage},this.scrollable)),this.domNode.appendChild(this.scrollableElement.getDomNode()),e.appendChild(this.domNode),this.scrollableElement.onScroll(this.onScroll,this,this.disposables),this.disposables.add(H(this.rowsContainer,Ot.Change,r=>this.onTouchChange(r))),this.disposables.add(H(this.scrollableElement.getDomNode(),"scroll",r=>r.target.scrollTop=0)),this.disposables.add(H(this.domNode,"dragover",r=>this.onDragOver(this.toDragEvent(r)))),this.disposables.add(H(this.domNode,"drop",r=>this.onDrop(this.toDragEvent(r)))),this.disposables.add(H(this.domNode,"dragleave",r=>this.onDragLeave(this.toDragEvent(r)))),this.disposables.add(H(this.domNode,"dragend",r=>this.onDragEnd(r))),this.setRowLineHeight=n.setRowLineHeight??Ka.setRowLineHeight,this.setRowHeight=n.setRowHeight??Ka.setRowHeight,this.supportDynamicHeights=n.supportDynamicHeights??Ka.supportDynamicHeights,this.dnd=n.dnd??this.disposables.add(Ka.dnd),this.layout(n.initialSize?.height,n.initialSize?.width)}updateOptions(e){e.paddingBottom!==void 0&&(this.paddingBottom=e.paddingBottom,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),e.smoothScrolling!==void 0&&this.scrollable.setSmoothScrollDuration(e.smoothScrolling?125:0),e.horizontalScrolling!==void 0&&(this.horizontalScrolling=e.horizontalScrolling);let t;if(e.scrollByPage!==void 0&&(t={...t??{},scrollByPage:e.scrollByPage}),e.mouseWheelScrollSensitivity!==void 0&&(t={...t??{},mouseWheelScrollSensitivity:e.mouseWheelScrollSensitivity}),e.fastScrollSensitivity!==void 0&&(t={...t??{},fastScrollSensitivity:e.fastScrollSensitivity}),t&&this.scrollableElement.updateOptions(t),e.paddingTop!==void 0&&e.paddingTop!==this.rangeMap.paddingTop){const i=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),n=e.paddingTop-this.rangeMap.paddingTop;this.rangeMap.paddingTop=e.paddingTop,this.render(i,Math.max(0,this.lastRenderTop+n),this.lastRenderHeight,void 0,void 0,!0),this.setScrollTop(this.lastRenderTop),this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.lastRenderTop,this.lastRenderHeight)}}createRangeMap(e){return new Sle(e)}splice(e,t,i=[]){if(this.splicing)throw new Error("Can't run recursive splices.");this.splicing=!0;try{return this._splice(e,t,i)}finally{this.splicing=!1,this._onDidChangeContentHeight.fire(this.contentHeight)}}_splice(e,t,i=[]){const n=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),s={start:e,end:e+t},r=In.intersect(n,s),a=new Map;for(let w=r.end-1;w>=r.start;w--){const x=this.items[w];if(x.dragStartDisposable.dispose(),x.checkedDisposable.dispose(),x.row){let k=a.get(x.templateId);k||(k=[],a.set(x.templateId,k));const E=this.renderers.get(x.templateId);E&&E.disposeElement&&E.disposeElement(x.element,w,x.row.templateData,x.size),k.unshift(x.row)}x.row=null,x.stale=!0}const l={start:e+t,end:this.items.length},c=In.intersect(l,n),d=In.relativeComplement(l,n),h=i.map(w=>({id:String(this.itemId++),element:w,templateId:this.virtualDelegate.getTemplateId(w),size:this.virtualDelegate.getHeight(w),width:void 0,hasDynamicHeight:!!this.virtualDelegate.hasDynamicHeight&&this.virtualDelegate.hasDynamicHeight(w),lastDynamicHeightWidth:void 0,row:null,uri:void 0,dropTarget:!1,dragStartDisposable:F.None,checkedDisposable:F.None,stale:!1}));let u;e===0&&t>=this.items.length?(this.rangeMap=this.createRangeMap(this.rangeMap.paddingTop),this.rangeMap.splice(0,0,h),u=this.items,this.items=h):(this.rangeMap.splice(e,t,h),u=this.items.splice(e,t,...h));const g=i.length-t,f=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight),m=LA(c,g),_=In.intersect(f,m);for(let w=_.start;w<_.end;w++)this.updateItemInDOM(this.items[w],w);const b=In.relativeComplement(m,f);for(const w of b)for(let x=w.start;x<w.end;x++)this.removeItemFromDOM(x);const v=d.map(w=>LA(w,g)),C=[{start:e,end:e+i.length},...v].map(w=>In.intersect(f,w)).reverse();for(const w of C)for(let x=w.end-1;x>=w.start;x--){const k=this.items[x],N=a.get(k.templateId)?.pop();this.insertItemInDOM(x,N)}for(const w of a.values())for(const x of w)this.cache.release(x);return this.eventuallyUpdateScrollDimensions(),this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight),u.map(w=>w.element)}eventuallyUpdateScrollDimensions(){this._scrollHeight=this.contentHeight,this.rowsContainer.style.height=`${this._scrollHeight}px`,this.scrollableElementUpdateDisposable||(this.scrollableElementUpdateDisposable=ao(xe(this.domNode),()=>{this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight}),this.updateScrollWidth(),this.scrollableElementUpdateDisposable=null}))}eventuallyUpdateScrollWidth(){if(!this.horizontalScrolling){this.scrollableElementWidthDelayer.cancel();return}this.scrollableElementWidthDelayer.trigger(()=>this.updateScrollWidth())}updateScrollWidth(){if(!this.horizontalScrolling)return;let e=0;for(const t of this.items)typeof t.width<"u"&&(e=Math.max(e,t.width));this.scrollWidth=e,this.scrollableElement.setScrollDimensions({scrollWidth:e===0?0:e+10}),this._onDidChangeContentWidth.fire(this.scrollWidth)}rerender(){if(this.supportDynamicHeights){for(const e of this.items)e.lastDynamicHeightWidth=void 0;this._rerender(this.lastRenderTop,this.lastRenderHeight)}}get length(){return this.items.length}get renderHeight(){return this.scrollableElement.getScrollDimensions().height}get firstVisibleIndex(){return this.getRenderRange(this.lastRenderTop,this.lastRenderHeight).start}element(e){return this.items[e].element}indexOf(e){return this.items.findIndex(t=>t.element===e)}domElement(e){const t=this.items[e].row;return t&&t.domNode}elementHeight(e){return this.items[e].size}elementTop(e){return this.rangeMap.positionAt(e)}indexAt(e){return this.rangeMap.indexAt(e)}indexAfter(e){return this.rangeMap.indexAfter(e)}layout(e,t){const i={height:typeof e=="number"?e:ZJ(this.domNode)};this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,i.scrollHeight=this.scrollHeight),this.scrollableElement.setScrollDimensions(i),typeof t<"u"&&(this.renderWidth=t,this.supportDynamicHeights&&this._rerender(this.scrollTop,this.renderHeight)),this.horizontalScrolling&&this.scrollableElement.setScrollDimensions({width:typeof t=="number"?t:JD(this.domNode)})}render(e,t,i,n,s,r=!1){const a=this.getRenderRange(t,i),l=In.relativeComplement(a,e).reverse(),c=In.relativeComplement(e,a);if(r){const d=In.intersect(e,a);for(let h=d.start;h<d.end;h++)this.updateItemInDOM(this.items[h],h)}this.cache.transact(()=>{for(const d of c)for(let h=d.start;h<d.end;h++)this.removeItemFromDOM(h);for(const d of l)for(let h=d.end-1;h>=d.start;h--)this.insertItemInDOM(h)}),n!==void 0&&(this.rowsContainer.style.left=`-${n}px`),this.rowsContainer.style.top=`-${t}px`,this.horizontalScrolling&&s!==void 0&&(this.rowsContainer.style.width=`${Math.max(s,this.renderWidth)}px`),this.lastRenderTop=t,this.lastRenderHeight=i}insertItemInDOM(e,t){const i=this.items[e];if(!i.row)if(t)i.row=t,i.stale=!0;else{const l=this.cache.alloc(i.templateId);i.row=l.row,i.stale||=l.isReusingConnectedDomNode}const n=this.accessibilityProvider.getRole(i.element)||"listitem";i.row.domNode.setAttribute("role",n);const s=this.accessibilityProvider.isChecked(i.element);if(typeof s=="boolean")i.row.domNode.setAttribute("aria-checked",String(!!s));else if(s){const l=c=>i.row.domNode.setAttribute("aria-checked",String(!!c));l(s.value),i.checkedDisposable=s.onDidChange(()=>l(s.value))}if(i.stale||!i.row.domNode.parentElement){const l=this.items.at(e+1)?.row?.domNode??null;(i.row.domNode.parentElement!==this.rowsContainer||i.row.domNode.nextElementSibling!==l)&&this.rowsContainer.insertBefore(i.row.domNode,l),i.stale=!1}this.updateItemInDOM(i,e);const r=this.renderers.get(i.templateId);if(!r)throw new Error(`No renderer found for template id ${i.templateId}`);r?.renderElement(i.element,e,i.row.templateData,i.size);const a=this.dnd.getDragURI(i.element);i.dragStartDisposable.dispose(),i.row.domNode.draggable=!!a,a&&(i.dragStartDisposable=H(i.row.domNode,"dragstart",l=>this.onDragStart(i.element,a,l))),this.horizontalScrolling&&(this.measureItemWidth(i),this.eventuallyUpdateScrollWidth())}measureItemWidth(e){if(!e.row||!e.row.domNode)return;e.row.domNode.style.width="fit-content",e.width=JD(e.row.domNode);const t=xe(e.row.domNode).getComputedStyle(e.row.domNode);t.paddingLeft&&(e.width+=parseFloat(t.paddingLeft)),t.paddingRight&&(e.width+=parseFloat(t.paddingRight)),e.row.domNode.style.width=""}updateItemInDOM(e,t){e.row.domNode.style.top=`${this.elementTop(t)}px`,this.setRowHeight&&(e.row.domNode.style.height=`${e.size}px`),this.setRowLineHeight&&(e.row.domNode.style.lineHeight=`${e.size}px`),e.row.domNode.setAttribute("data-index",`${t}`),e.row.domNode.setAttribute("data-last-element",t===this.length-1?"true":"false"),e.row.domNode.setAttribute("data-parity",t%2===0?"even":"odd"),e.row.domNode.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(e.element,t,this.length))),e.row.domNode.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(e.element,t))),e.row.domNode.setAttribute("id",this.getElementDomId(t)),e.row.domNode.classList.toggle("drop-target",e.dropTarget)}removeItemFromDOM(e){const t=this.items[e];if(t.dragStartDisposable.dispose(),t.checkedDisposable.dispose(),t.row){const i=this.renderers.get(t.templateId);i&&i.disposeElement&&i.disposeElement(t.element,e,t.row.templateData,t.size),this.cache.release(t.row),t.row=null}this.horizontalScrolling&&this.eventuallyUpdateScrollWidth()}getScrollTop(){return this.scrollableElement.getScrollPosition().scrollTop}setScrollTop(e,t){this.scrollableElementUpdateDisposable&&(this.scrollableElementUpdateDisposable.dispose(),this.scrollableElementUpdateDisposable=null,this.scrollableElement.setScrollDimensions({scrollHeight:this.scrollHeight})),this.scrollableElement.setScrollPosition({scrollTop:e,reuseAnimation:t})}get scrollTop(){return this.getScrollTop()}set scrollTop(e){this.setScrollTop(e)}get scrollHeight(){return this._scrollHeight+(this.horizontalScrolling?10:0)+this.paddingBottom}get onMouseClick(){return se.map(this.disposables.add(new et(this.domNode,"click")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseDblClick(){return se.map(this.disposables.add(new et(this.domNode,"dblclick")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseMiddleClick(){return se.filter(se.map(this.disposables.add(new et(this.domNode,"auxclick")).event,e=>this.toMouseEvent(e),this.disposables),e=>e.browserEvent.button===1,this.disposables)}get onMouseDown(){return se.map(this.disposables.add(new et(this.domNode,"mousedown")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOver(){return se.map(this.disposables.add(new et(this.domNode,"mouseover")).event,e=>this.toMouseEvent(e),this.disposables)}get onMouseOut(){return se.map(this.disposables.add(new et(this.domNode,"mouseout")).event,e=>this.toMouseEvent(e),this.disposables)}get onContextMenu(){return se.any(se.map(this.disposables.add(new et(this.domNode,"contextmenu")).event,e=>this.toMouseEvent(e),this.disposables),se.map(this.disposables.add(new et(this.domNode,Ot.Contextmenu)).event,e=>this.toGestureEvent(e),this.disposables))}get onTouchStart(){return se.map(this.disposables.add(new et(this.domNode,"touchstart")).event,e=>this.toTouchEvent(e),this.disposables)}get onTap(){return se.map(this.disposables.add(new et(this.rowsContainer,Ot.Tap)).event,e=>this.toGestureEvent(e),this.disposables)}toMouseEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toTouchEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toGestureEvent(e){const t=this.getItemIndexFromEventTarget(e.initialTarget||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element;return{browserEvent:e,index:t,element:n}}toDragEvent(e){const t=this.getItemIndexFromEventTarget(e.target||null),i=typeof t>"u"?void 0:this.items[t],n=i&&i.element,s=this.getTargetSector(e,t);return{browserEvent:e,index:t,element:n,sector:s}}onScroll(e){try{const t=this.getRenderRange(this.lastRenderTop,this.lastRenderHeight);this.render(t,e.scrollTop,e.height,e.scrollLeft,e.scrollWidth),this.supportDynamicHeights&&this._rerender(e.scrollTop,e.height,e.inSmoothScrolling)}catch(t){throw console.error("Got bad scroll event:",e),t}}onTouchChange(e){e.preventDefault(),e.stopPropagation(),this.scrollTop-=e.translationY}onDragStart(e,t,i){if(!i.dataTransfer)return;const n=this.dnd.getDragElements(e);if(i.dataTransfer.effectAllowed="copyMove",i.dataTransfer.setData(_y.TEXT,t),i.dataTransfer.setDragImage){let s;this.dnd.getDragLabel&&(s=this.dnd.getDragLabel(n,i)),typeof s>"u"&&(s=String(n.length));const r=ie(".monaco-drag-image");r.textContent=s,(c=>{for(;c&&!c.classList.contains("monaco-workbench");)c=c.parentElement;return c||this.domNode.ownerDocument})(this.domNode).appendChild(r),i.dataTransfer.setDragImage(r,-10,-10),setTimeout(()=>r.remove(),0)}this.domNode.classList.add("dragging"),this.currentDragData=new Ww(n),hu.CurrentDragAndDropData=new Lle(n),this.dnd.onDragStart?.(this.currentDragData,i)}onDragOver(e){if(e.browserEvent.preventDefault(),this.onDragLeaveTimeout.dispose(),hu.CurrentDragAndDropData&&hu.CurrentDragAndDropData.getData()==="vscode-ui"||(this.setupDragAndDropScrollTopAnimation(e.browserEvent),!e.browserEvent.dataTransfer))return!1;if(!this.currentDragData)if(hu.CurrentDragAndDropData)this.currentDragData=hu.CurrentDragAndDropData;else{if(!e.browserEvent.dataTransfer.types)return!1;this.currentDragData=new kle}const t=this.dnd.onDragOver(this.currentDragData,e.element,e.index,e.sector,e.browserEvent);if(this.canDrop=typeof t=="boolean"?t:t.accept,!this.canDrop)return this.currentDragFeedback=void 0,this.currentDragFeedbackDisposable.dispose(),!1;e.browserEvent.dataTransfer.dropEffect=typeof t!="boolean"&&t.effect?.type===0?"copy":"move";let i;typeof t!="boolean"&&t.feedback?i=t.feedback:typeof e.index>"u"?i=[-1]:i=[e.index],i=Uc(i).filter(s=>s>=-1&&s<this.length).sort((s,r)=>s-r),i=i[0]===-1?[-1]:i;let n=typeof t!="boolean"&&t.effect&&t.effect.position?t.effect.position:"drop-target";if(Ele(this.currentDragFeedback,i)&&this.currentDragFeedbackPosition===n)return!0;if(this.currentDragFeedback=i,this.currentDragFeedbackPosition=n,this.currentDragFeedbackDisposable.dispose(),i[0]===-1)this.domNode.classList.add(n),this.rowsContainer.classList.add(n),this.currentDragFeedbackDisposable=ve(()=>{this.domNode.classList.remove(n),this.rowsContainer.classList.remove(n)});else{if(i.length>1&&n!=="drop-target")throw new Error("Can't use multiple feedbacks with position different than 'over'");n==="drop-target-after"&&i[0]<this.length-1&&(i[0]+=1,n="drop-target-before");for(const s of i){const r=this.items[s];r.dropTarget=!0,r.row?.domNode.classList.add(n)}this.currentDragFeedbackDisposable=ve(()=>{for(const s of i){const r=this.items[s];r.dropTarget=!1,r.row?.domNode.classList.remove(n)}})}return!0}onDragLeave(e){this.onDragLeaveTimeout.dispose(),this.onDragLeaveTimeout=Rh(()=>this.clearDragOverFeedback(),100,this.disposables),this.currentDragData&&this.dnd.onDragLeave?.(this.currentDragData,e.element,e.index,e.browserEvent)}onDrop(e){if(!this.canDrop)return;const t=this.currentDragData;this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,hu.CurrentDragAndDropData=void 0,!(!t||!e.browserEvent.dataTransfer)&&(e.browserEvent.preventDefault(),t.update(e.browserEvent.dataTransfer),this.dnd.drop(t,e.element,e.index,e.sector,e.browserEvent))}onDragEnd(e){this.canDrop=!1,this.teardownDragAndDropScrollTopAnimation(),this.clearDragOverFeedback(),this.domNode.classList.remove("dragging"),this.currentDragData=void 0,hu.CurrentDragAndDropData=void 0,this.dnd.onDragEnd?.(e)}clearDragOverFeedback(){this.currentDragFeedback=void 0,this.currentDragFeedbackPosition=void 0,this.currentDragFeedbackDisposable.dispose(),this.currentDragFeedbackDisposable=F.None}setupDragAndDropScrollTopAnimation(e){if(!this.dragOverAnimationDisposable){const t=qz(this.domNode).top;this.dragOverAnimationDisposable=lee(xe(this.domNode),this.animateDragAndDropScrollTop.bind(this,t))}this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationStopDisposable=Rh(()=>{this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)},1e3,this.disposables),this.dragOverMouseY=e.pageY}animateDragAndDropScrollTop(e){if(this.dragOverMouseY===void 0)return;const t=this.dragOverMouseY-e,i=this.renderHeight-35;t<35?this.scrollTop+=Math.max(-14,Math.floor(.3*(t-35))):t>i&&(this.scrollTop+=Math.min(14,Math.floor(.3*(t-i))))}teardownDragAndDropScrollTopAnimation(){this.dragOverAnimationStopDisposable.dispose(),this.dragOverAnimationDisposable&&(this.dragOverAnimationDisposable.dispose(),this.dragOverAnimationDisposable=void 0)}getTargetSector(e,t){if(t===void 0)return;const i=e.offsetY/this.items[t].size,n=Math.floor(i/.25);return ts(n,0,3)}getItemIndexFromEventTarget(e){const t=this.scrollableElement.getDomNode();let i=e;for(;(qi(i)||tee(i))&&i!==this.rowsContainer&&t.contains(i);){const n=i.getAttribute("data-index");if(n){const s=Number(n);if(!isNaN(s))return s}i=i.parentElement}}getRenderRange(e,t){return{start:this.rangeMap.indexAt(e),end:this.rangeMap.indexAfter(e+t-1)}}_rerender(e,t,i){const n=this.getRenderRange(e,t);let s,r;e===this.elementTop(n.start)?(s=n.start,r=0):n.end-n.start>1&&(s=n.start+1,r=this.elementTop(s)-e);let a=0;for(;;){const l=this.getRenderRange(e,t);let c=!1;for(let d=l.start;d<l.end;d++){const h=this.probeDynamicHeight(d);h!==0&&this.rangeMap.splice(d,1,[this.items[d]]),a+=h,c=c||h!==0}if(!c){a!==0&&this.eventuallyUpdateScrollDimensions();const d=In.relativeComplement(n,l);for(const u of d)for(let g=u.start;g<u.end;g++)this.items[g].row&&this.removeItemFromDOM(g);const h=In.relativeComplement(l,n).reverse();for(const u of h)for(let g=u.end-1;g>=u.start;g--)this.insertItemInDOM(g);for(let u=l.start;u<l.end;u++)this.items[u].row&&this.updateItemInDOM(this.items[u],u);if(typeof s=="number"){const u=this.scrollable.getFutureScrollPosition().scrollTop-e,g=this.elementTop(s)-r+u;this.setScrollTop(g,i)}this._onDidChangeContentHeight.fire(this.contentHeight);return}}}probeDynamicHeight(e){const t=this.items[e];if(this.virtualDelegate.getDynamicHeight){const r=this.virtualDelegate.getDynamicHeight(t.element);if(r!==null){const a=t.size;return t.size=r,t.lastDynamicHeightWidth=this.renderWidth,r-a}}if(!t.hasDynamicHeight||t.lastDynamicHeightWidth===this.renderWidth||this.virtualDelegate.hasDynamicHeight&&!this.virtualDelegate.hasDynamicHeight(t.element))return 0;const i=t.size;if(t.row)return t.row.domNode.style.height="",t.size=t.row.domNode.offsetHeight,t.size===0&&!Ki(t.row.domNode,xe(t.row.domNode).document.body)&&console.warn("Measuring item node that is not in DOM! Add ListView to the DOM before measuring row height!",new Error().stack),t.lastDynamicHeightWidth=this.renderWidth,t.size-i;const{row:n}=this.cache.alloc(t.templateId);n.domNode.style.height="",this.rowsContainer.appendChild(n.domNode);const s=this.renderers.get(t.templateId);if(!s)throw new pt("Missing renderer for templateId: "+t.templateId);return s.renderElement(t.element,e,n.templateData,void 0),t.size=n.domNode.offsetHeight,s.disposeElement?.(t.element,e,n.templateData,void 0),this.virtualDelegate.setDynamicHeight?.(t.element,t.size),t.lastDynamicHeightWidth=this.renderWidth,n.domNode.remove(),this.cache.release(n),t.size-i}getElementDomId(e){return`${this.domId}_${e}`}dispose(){for(const e of this.items)if(e.dragStartDisposable.dispose(),e.checkedDisposable.dispose(),e.row){const t=this.renderers.get(e.row.templateId);t&&(t.disposeElement?.(e.element,-1,e.row.templateData,void 0),t.disposeTemplate(e.row.templateData))}this.items=[],this.domNode?.remove(),this.dragOverAnimationDisposable?.dispose(),this.disposables.dispose()}};Ik.InstanceCount=0;let Kr=Ik;od([Ti],Kr.prototype,"onMouseClick",null);od([Ti],Kr.prototype,"onMouseDblClick",null);od([Ti],Kr.prototype,"onMouseMiddleClick",null);od([Ti],Kr.prototype,"onMouseDown",null);od([Ti],Kr.prototype,"onMouseOver",null);od([Ti],Kr.prototype,"onMouseOut",null);od([Ti],Kr.prototype,"onContextMenu",null);od([Ti],Kr.prototype,"onTouchStart",null);od([Ti],Kr.prototype,"onTap",null);var Qh=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};class Dle{constructor(e){this.trait=e,this.renderedElements=[]}get templateId(){return`template:${this.trait.name}`}renderTemplate(e){return e}renderElement(e,t,i){const n=this.renderedElements.findIndex(s=>s.templateData===i);if(n>=0){const s=this.renderedElements[n];this.trait.unrender(i),s.index=t}else{const s={index:t,templateData:i};this.renderedElements.push(s)}this.trait.renderIndex(t,i)}splice(e,t,i){const n=[];for(const s of this.renderedElements)s.index<e?n.push(s):s.index>=e+t&&n.push({index:s.index+i-t,templateData:s.templateData});this.renderedElements=n}renderIndexes(e){for(const{index:t,templateData:i}of this.renderedElements)e.indexOf(t)>-1&&this.trait.renderIndex(t,i)}disposeTemplate(e){const t=this.renderedElements.findIndex(i=>i.templateData===e);t<0||this.renderedElements.splice(t,1)}}let dx=class{get name(){return this._trait}get renderer(){return new Dle(this)}constructor(e){this._trait=e,this.indexes=[],this.sortedIndexes=[],this._onChange=new O,this.onChange=this._onChange.event}splice(e,t,i){const n=i.length-t,s=e+t,r=[];let a=0;for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]<e;)r.push(this.sortedIndexes[a++]);for(let l=0;l<i.length;l++)i[l]&&r.push(l+e);for(;a<this.sortedIndexes.length&&this.sortedIndexes[a]>=s;)r.push(this.sortedIndexes[a++]+n);this.renderer.splice(e,t,i.length),this._set(r,r)}renderIndex(e,t){t.classList.toggle(this._trait,this.contains(e))}unrender(e){e.classList.remove(this._trait)}set(e,t){return this._set(e,[...e].sort(zH),t)}_set(e,t,i){const n=this.indexes,s=this.sortedIndexes;this.indexes=e,this.sortedIndexes=t;const r=kA(s,e);return this.renderer.renderIndexes(r),this._onChange.fire({indexes:e,browserEvent:i}),n}get(){return this.indexes}contains(e){return BC(this.sortedIndexes,e,zH)>=0}dispose(){Dt(this._onChange)}};Qh([Ti],dx.prototype,"renderer",null);class Ile extends dx{constructor(e){super("selected"),this.setAriaSelected=e}renderIndex(e,t){super.renderIndex(e,t),this.setAriaSelected&&(this.contains(e)?t.setAttribute("aria-selected","true"):t.setAttribute("aria-selected","false"))}}class NI{constructor(e,t,i){this.trait=e,this.view=t,this.identityProvider=i}splice(e,t,i){if(!this.identityProvider)return this.trait.splice(e,t,new Array(i.length).fill(!1));const n=this.trait.get().map(a=>this.identityProvider.getId(this.view.element(a)).toString());if(n.length===0)return this.trait.splice(e,t,new Array(i.length).fill(!1));const s=new Set(n),r=i.map(a=>s.has(this.identityProvider.getId(a).toString()));this.trait.splice(e,t,r)}}function oh(o){return o.tagName==="INPUT"||o.tagName==="TEXTAREA"}function Vw(o,e){return o.classList.contains(e)?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:Vw(o.parentElement,e)}function mv(o){return Vw(o,"monaco-editor")}function Nle(o){return Vw(o,"monaco-custom-toggle")}function Rle(o){return Vw(o,"action-item")}function Hv(o){return Vw(o,"monaco-tree-sticky-row")}function by(o){return o.classList.contains("monaco-tree-sticky-container")}function QG(o){return o.tagName==="A"&&o.classList.contains("monaco-button")||o.tagName==="DIV"&&o.classList.contains("monaco-button-dropdown")?!0:o.classList.contains("monaco-list")||!o.parentElement?!1:QG(o.parentElement)}class JG{get onKeyDown(){return se.chain(this.disposables.add(new et(this.view.domNode,"keydown")).event,e=>e.filter(t=>!oh(t.target)).map(t=>new Pt(t)))}constructor(e,t,i){this.list=e,this.view=t,this.disposables=new $,this.multipleSelectionDisposables=new $,this.multipleSelectionSupport=i.multipleSelectionSupport,this.disposables.add(this.onKeyDown(n=>{switch(n.keyCode){case 3:return this.onEnter(n);case 16:return this.onUpArrow(n);case 18:return this.onDownArrow(n);case 11:return this.onPageUpArrow(n);case 12:return this.onPageDownArrow(n);case 9:return this.onEscape(n);case 31:this.multipleSelectionSupport&&(Qe?n.metaKey:n.ctrlKey)&&this.onCtrlA(n)}}))}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionSupport=e.multipleSelectionSupport)}onEnter(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(this.list.getFocus(),e.browserEvent)}onUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPrevious(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNext(1,!1,e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageUpArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusPreviousPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onPageDownArrow(e){e.preventDefault(),e.stopPropagation(),this.list.focusNextPage(e.browserEvent);const t=this.list.getFocus()[0];this.list.setAnchor(t),this.list.reveal(t),this.view.domNode.focus()}onCtrlA(e){e.preventDefault(),e.stopPropagation(),this.list.setSelection(Ss(this.list.length),e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus()}onEscape(e){this.list.getSelection().length&&(e.preventDefault(),e.stopPropagation(),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0),this.view.domNode.focus())}dispose(){this.disposables.dispose(),this.multipleSelectionDisposables.dispose()}}Qh([Ti],JG.prototype,"onKeyDown",null);var ml;(function(o){o[o.Automatic=0]="Automatic",o[o.Trigger=1]="Trigger"})(ml||(ml={}));var Xp;(function(o){o[o.Idle=0]="Idle",o[o.Typing=1]="Typing"})(Xp||(Xp={}));const Ple=new class{mightProducePrintableCharacter(o){return o.ctrlKey||o.metaKey||o.altKey?!1:o.keyCode>=31&&o.keyCode<=56||o.keyCode>=21&&o.keyCode<=30||o.keyCode>=98&&o.keyCode<=107||o.keyCode>=85&&o.keyCode<=95}};class Ale{constructor(e,t,i,n,s){this.list=e,this.view=t,this.keyboardNavigationLabelProvider=i,this.keyboardNavigationEventFilter=n,this.delegate=s,this.enabled=!1,this.state=Xp.Idle,this.mode=ml.Automatic,this.triggered=!1,this.previouslyFocused=-1,this.enabledDisposables=new $,this.disposables=new $,this.updateOptions(e.options)}updateOptions(e){e.typeNavigationEnabled??!0?this.enable():this.disable(),this.mode=e.typeNavigationMode??ml.Automatic}enable(){if(this.enabled)return;let e=!1;const t=se.chain(this.enabledDisposables.add(new et(this.view.domNode,"keydown")).event,s=>s.filter(r=>!oh(r.target)).filter(()=>this.mode===ml.Automatic||this.triggered).map(r=>new Pt(r)).filter(r=>e||this.keyboardNavigationEventFilter(r)).filter(r=>this.delegate.mightProducePrintableCharacter(r)).forEach(r=>tt.stop(r,!0)).map(r=>r.browserEvent.key)),i=se.debounce(t,()=>null,800,void 0,void 0,void 0,this.enabledDisposables);se.reduce(se.any(t,i),(s,r)=>r===null?null:(s||"")+r,void 0,this.enabledDisposables)(this.onInput,this,this.enabledDisposables),i(this.onClear,this,this.enabledDisposables),t(()=>e=!0,void 0,this.enabledDisposables),i(()=>e=!1,void 0,this.enabledDisposables),this.enabled=!0,this.triggered=!1}disable(){this.enabled&&(this.enabledDisposables.clear(),this.enabled=!1,this.triggered=!1)}onClear(){const e=this.list.getFocus();if(e.length>0&&e[0]===this.previouslyFocused){const t=this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(e[0]));typeof t=="string"?ps(t):t&&ps(t.get())}this.previouslyFocused=-1}onInput(e){if(!e){this.state=Xp.Idle,this.triggered=!1;return}const t=this.list.getFocus(),i=t.length>0?t[0]:0,n=this.state===Xp.Idle?1:0;this.state=Xp.Typing;for(let s=0;s<this.list.length;s++){const r=(i+s+n)%this.list.length,a=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(r)),l=a&&a.toString();if(this.list.options.typeNavigationEnabled){if(typeof l<"u"){if(hy(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}const c=tre(e,l);if(c&&c[0].end-c[0].start>1&&c.length===1){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}else if(typeof l>"u"||hy(e,l)){this.previouslyFocused=i,this.list.setFocus([r]),this.list.reveal(r);return}}}dispose(){this.disable(),this.enabledDisposables.dispose(),this.disposables.dispose()}}class Mle{constructor(e,t){this.list=e,this.view=t,this.disposables=new $;const i=se.chain(this.disposables.add(new et(t.domNode,"keydown")).event,s=>s.filter(r=>!oh(r.target)).map(r=>new Pt(r)));se.chain(i,s=>s.filter(r=>r.keyCode===2&&!r.ctrlKey&&!r.metaKey&&!r.shiftKey&&!r.altKey))(this.onTab,this,this.disposables)}onTab(e){if(e.target!==this.view.domNode)return;const t=this.list.getFocus();if(t.length===0)return;const i=this.view.domElement(t[0]);if(!i)return;const n=i.querySelector("[tabIndex]");if(!n||!qi(n)||n.tabIndex===-1)return;const s=xe(n).getComputedStyle(n);s.visibility==="hidden"||s.display==="none"||(e.preventDefault(),e.stopPropagation(),n.focus())}dispose(){this.disposables.dispose()}}function e$(o){return Qe?o.browserEvent.metaKey:o.browserEvent.ctrlKey}function t$(o){return o.browserEvent.shiftKey}function Ole(o){return U4(o)&&o.button===2}const HH={isSelectionSingleChangeEvent:e$,isSelectionRangeChangeEvent:t$};class i${constructor(e){this.list=e,this.disposables=new $,this._onPointer=new O,this.onPointer=this._onPointer.event,e.options.multipleSelectionSupport!==!1&&(this.multipleSelectionController=this.list.options.multipleSelectionController||HH),this.mouseSupport=typeof e.options.mouseSupport>"u"||!!e.options.mouseSupport,this.mouseSupport&&(e.onMouseDown(this.onMouseDown,this,this.disposables),e.onContextMenu(this.onContextMenu,this,this.disposables),e.onMouseDblClick(this.onDoubleClick,this,this.disposables),e.onTouchStart(this.onMouseDown,this,this.disposables),this.disposables.add(Mn.addTarget(e.getHTMLElement()))),se.any(e.onMouseClick,e.onMouseMiddleClick,e.onTap)(this.onViewPointer,this,this.disposables)}updateOptions(e){e.multipleSelectionSupport!==void 0&&(this.multipleSelectionController=void 0,e.multipleSelectionSupport&&(this.multipleSelectionController=this.list.options.multipleSelectionController||HH))}isSelectionSingleChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionSingleChangeEvent(e):!1}isSelectionRangeChangeEvent(e){return this.multipleSelectionController?this.multipleSelectionController.isSelectionRangeChangeEvent(e):!1}isSelectionChangeEvent(e){return this.isSelectionSingleChangeEvent(e)||this.isSelectionRangeChangeEvent(e)}onMouseDown(e){mv(e.browserEvent.target)||Ln()!==e.browserEvent.target&&this.list.domFocus()}onContextMenu(e){if(oh(e.browserEvent.target)||mv(e.browserEvent.target))return;const t=typeof e.index>"u"?[]:[e.index];this.list.setFocus(t,e.browserEvent)}onViewPointer(e){if(!this.mouseSupport||oh(e.browserEvent.target)||mv(e.browserEvent.target)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=e.index;if(typeof t>"u"){this.list.setFocus([],e.browserEvent),this.list.setSelection([],e.browserEvent),this.list.setAnchor(void 0);return}if(this.isSelectionChangeEvent(e))return this.changeSelection(e);this.list.setFocus([t],e.browserEvent),this.list.setAnchor(t),Ole(e.browserEvent)||this.list.setSelection([t],e.browserEvent),this._onPointer.fire(e)}onDoubleClick(e){if(oh(e.browserEvent.target)||mv(e.browserEvent.target)||this.isSelectionChangeEvent(e)||e.browserEvent.isHandledByList)return;e.browserEvent.isHandledByList=!0;const t=this.list.getFocus();this.list.setSelection(t,e.browserEvent)}changeSelection(e){const t=e.index;let i=this.list.getAnchor();if(this.isSelectionRangeChangeEvent(e)){typeof i>"u"&&(i=this.list.getFocus()[0]??t,this.list.setAnchor(i));const n=Math.min(i,t),s=Math.max(i,t),r=Ss(n,s+1),a=this.list.getSelection(),l=Wle(kA(a,[i]),i);if(l.length===0)return;const c=kA(r,Vle(a,l));this.list.setSelection(c,e.browserEvent),this.list.setFocus([t],e.browserEvent)}else if(this.isSelectionSingleChangeEvent(e)){const n=this.list.getSelection(),s=n.filter(r=>r!==t);this.list.setFocus([t]),this.list.setAnchor(t),n.length===s.length?this.list.setSelection([...s,t],e.browserEvent):this.list.setSelection(s,e.browserEvent)}}dispose(){this.disposables.dispose()}}class n${constructor(e,t){this.styleElement=e,this.selectorSuffix=t}style(e){const t=this.selectorSuffix&&`.${this.selectorSuffix}`,i=[];e.listBackground&&i.push(`.monaco-list${t} .monaco-list-rows { background: ${e.listBackground}; }`),e.listFocusBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.focused { background-color: ${e.listFocusBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.focused:hover { background-color: ${e.listFocusBackground}; }`)),e.listFocusForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),e.listActiveSelectionBackground&&(i.push(`.monaco-list${t}:focus .monaco-list-row.selected { background-color: ${e.listActiveSelectionBackground}; }`),i.push(`.monaco-list${t}:focus .monaco-list-row.selected:hover { background-color: ${e.listActiveSelectionBackground}; }`)),e.listActiveSelectionForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected { color: ${e.listActiveSelectionForeground}; }`),e.listActiveSelectionIconForeground&&i.push(`.monaco-list${t}:focus .monaco-list-row.selected .codicon { color: ${e.listActiveSelectionIconForeground}; }`),e.listFocusAndSelectionBackground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { background-color: ${e.listFocusAndSelectionBackground}; }
			`),e.listFocusAndSelectionForeground&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.selected.focused { color: ${e.listFocusAndSelectionForeground}; }
			`),e.listInactiveFocusForeground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { color:  ${e.listInactiveFocusForeground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { color:  ${e.listInactiveFocusForeground}; }`)),e.listInactiveSelectionIconForeground&&i.push(`.monaco-list${t} .monaco-list-row.focused .codicon { color:  ${e.listInactiveSelectionIconForeground}; }`),e.listInactiveFocusBackground&&(i.push(`.monaco-list${t} .monaco-list-row.focused { background-color:  ${e.listInactiveFocusBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.focused:hover { background-color:  ${e.listInactiveFocusBackground}; }`)),e.listInactiveSelectionBackground&&(i.push(`.monaco-list${t} .monaco-list-row.selected { background-color:  ${e.listInactiveSelectionBackground}; }`),i.push(`.monaco-list${t} .monaco-list-row.selected:hover { background-color:  ${e.listInactiveSelectionBackground}; }`)),e.listInactiveSelectionForeground&&i.push(`.monaco-list${t} .monaco-list-row.selected { color: ${e.listInactiveSelectionForeground}; }`),e.listHoverBackground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${e.listHoverBackground}; }`),e.listHoverForeground&&i.push(`.monaco-list${t}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${e.listHoverForeground}; }`);const n=Bc(e.listFocusAndSelectionOutline,Bc(e.listSelectionOutline,e.listFocusOutline??""));n&&i.push(`.monaco-list${t}:focus .monaco-list-row.focused.selected { outline: 1px solid ${n}; outline-offset: -1px;}`),e.listFocusOutline&&i.push(`
				.monaco-drag-image,
				.monaco-list${t}:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
				.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }
			`);const s=Bc(e.listSelectionOutline,e.listInactiveFocusOutline??"");s&&i.push(`.monaco-list${t} .monaco-list-row.focused.selected { outline: 1px dotted ${s}; outline-offset: -1px; }`),e.listSelectionOutline&&i.push(`.monaco-list${t} .monaco-list-row.selected { outline: 1px dotted ${e.listSelectionOutline}; outline-offset: -1px; }`),e.listInactiveFocusOutline&&i.push(`.monaco-list${t} .monaco-list-row.focused { outline: 1px dotted ${e.listInactiveFocusOutline}; outline-offset: -1px; }`),e.listHoverOutline&&i.push(`.monaco-list${t} .monaco-list-row:hover { outline: 1px dashed ${e.listHoverOutline}; outline-offset: -1px; }`),e.listDropOverBackground&&i.push(`
				.monaco-list${t}.drop-target,
				.monaco-list${t} .monaco-list-rows.drop-target,
				.monaco-list${t} .monaco-list-row.drop-target { background-color: ${e.listDropOverBackground} !important; color: inherit !important; }
			`),e.listDropBetweenBackground&&(i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,
			.monaco-list${t} .monaco-list-row.drop-target-before::before {
				content: ""; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`),i.push(`
			.monaco-list${t} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,
			.monaco-list${t} .monaco-list-row.drop-target-after::after {
				content: ""; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;
				background-color: ${e.listDropBetweenBackground};
			}`)),e.tableColumnsBorder&&i.push(`
				.monaco-table > .monaco-split-view2,
				.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: ${e.tableColumnsBorder};
				}

				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,
				.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {
					border-color: transparent;
				}
			`),e.tableOddRowsBackgroundColor&&i.push(`
				.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,
				.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {
					background-color: ${e.tableOddRowsBackgroundColor};
				}
			`),this.styleElement.textContent=i.join(`
`)}}const Fle={listFocusBackground:"#7FB0D0",listActiveSelectionBackground:"#0E639C",listActiveSelectionForeground:"#FFFFFF",listActiveSelectionIconForeground:"#FFFFFF",listFocusAndSelectionOutline:"#90C2F9",listFocusAndSelectionBackground:"#094771",listFocusAndSelectionForeground:"#FFFFFF",listInactiveSelectionBackground:"#3F3F46",listInactiveSelectionIconForeground:"#FFFFFF",listHoverBackground:"#2A2D2E",listDropOverBackground:"#383B3D",listDropBetweenBackground:"#EEEEEE",treeIndentGuidesStroke:"#a9a9a9",treeInactiveIndentGuidesStroke:j.fromHex("#a9a9a9").transparent(.4).toString(),tableColumnsBorder:j.fromHex("#cccccc").transparent(.2).toString(),tableOddRowsBackgroundColor:j.fromHex("#cccccc").transparent(.04).toString(),listBackground:void 0,listFocusForeground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusForeground:void 0,listInactiveFocusBackground:void 0,listHoverForeground:void 0,listFocusOutline:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listHoverOutline:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},Ble={keyboardSupport:!0,mouseSupport:!0,multipleSelectionSupport:!0,dnd:{getDragURI(){return null},onDragStart(){},onDragOver(){return!1},drop(){},dispose(){}}};function Wle(o,e){const t=o.indexOf(e);if(t===-1)return[];const i=[];let n=t-1;for(;n>=0&&o[n]===e-(t-n);)i.push(o[n--]);for(i.reverse(),n=t;n<o.length&&o[n]===e+(n-t);)i.push(o[n++]);return i}function kA(o,e){const t=[];let i=0,n=0;for(;i<o.length||n<e.length;)if(i>=o.length)t.push(e[n++]);else if(n>=e.length)t.push(o[i++]);else if(o[i]===e[n]){t.push(o[i]),i++,n++;continue}else o[i]<e[n]?t.push(o[i++]):t.push(e[n++]);return t}function Vle(o,e){const t=[];let i=0,n=0;for(;i<o.length||n<e.length;)if(i>=o.length)t.push(e[n++]);else if(n>=e.length)t.push(o[i++]);else if(o[i]===e[n]){i++,n++;continue}else o[i]<e[n]?t.push(o[i++]):n++;return t}const zH=(o,e)=>o-e;class Hle{constructor(e,t){this._templateId=e,this.renderers=t}get templateId(){return this._templateId}renderTemplate(e){return this.renderers.map(t=>t.renderTemplate(e))}renderElement(e,t,i,n){let s=0;for(const r of this.renderers)r.renderElement(e,t,i[s++],n)}disposeElement(e,t,i,n){let s=0;for(const r of this.renderers)r.disposeElement?.(e,t,i[s],n),s+=1}disposeTemplate(e){let t=0;for(const i of this.renderers)i.disposeTemplate(e[t++])}}class zle{constructor(e){this.accessibilityProvider=e,this.templateId="a18n"}renderTemplate(e){return{container:e,disposables:new $}}renderElement(e,t,i){const n=this.accessibilityProvider.getAriaLabel(e),s=n&&typeof n!="string"?n:rr(n);i.disposables.add(Re(a=>{this.setAriaLabel(a.readObservable(s),i.container)}));const r=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(e);typeof r=="number"?i.container.setAttribute("aria-level",`${r}`):i.container.removeAttribute("aria-level")}setAriaLabel(e,t){e?t.setAttribute("aria-label",e):t.removeAttribute("aria-label")}disposeElement(e,t,i,n){i.disposables.clear()}disposeTemplate(e){e.disposables.dispose()}}class Ule{constructor(e,t){this.list=e,this.dnd=t}getDragElements(e){const t=this.list.getSelectedElements();return t.indexOf(e)>-1?t:[e]}getDragURI(e){return this.dnd.getDragURI(e)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e,t)}onDragStart(e,t){this.dnd.onDragStart?.(e,t)}onDragOver(e,t,i,n,s){return this.dnd.onDragOver(e,t,i,n,s)}onDragLeave(e,t,i,n){this.dnd.onDragLeave?.(e,t,i,n)}onDragEnd(e){this.dnd.onDragEnd?.(e)}drop(e,t,i,n,s){this.dnd.drop(e,t,i,n,s)}dispose(){this.dnd.dispose()}}class $o{get onDidChangeFocus(){return se.map(this.eventBufferer.wrapEvent(this.focus.onChange),e=>this.toListEvent(e),this.disposables)}get onDidChangeSelection(){return se.map(this.eventBufferer.wrapEvent(this.selection.onChange),e=>this.toListEvent(e),this.disposables)}get domId(){return this.view.domId}get onDidScroll(){return this.view.onDidScroll}get onMouseClick(){return this.view.onMouseClick}get onMouseDblClick(){return this.view.onMouseDblClick}get onMouseMiddleClick(){return this.view.onMouseMiddleClick}get onPointer(){return this.mouseController.onPointer}get onMouseDown(){return this.view.onMouseDown}get onMouseOver(){return this.view.onMouseOver}get onMouseOut(){return this.view.onMouseOut}get onTouchStart(){return this.view.onTouchStart}get onTap(){return this.view.onTap}get onContextMenu(){let e=!1;const t=se.chain(this.disposables.add(new et(this.view.domNode,"keydown")).event,s=>s.map(r=>new Pt(r)).filter(r=>e=r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>tt.stop(r,!0)).filter(()=>!1)),i=se.chain(this.disposables.add(new et(this.view.domNode,"keyup")).event,s=>s.forEach(()=>e=!1).map(r=>new Pt(r)).filter(r=>r.keyCode===58||r.shiftKey&&r.keyCode===68).map(r=>tt.stop(r,!0)).map(({browserEvent:r})=>{const a=this.getFocus(),l=a.length?a[0]:void 0,c=typeof l<"u"?this.view.element(l):void 0,d=typeof l<"u"?this.view.domElement(l):this.view.domNode;return{index:l,element:c,anchor:d,browserEvent:r}})),n=se.chain(this.view.onContextMenu,s=>s.filter(r=>!e).map(({element:r,index:a,browserEvent:l})=>({element:r,index:a,anchor:new Mr(xe(this.view.domNode),l),browserEvent:l})));return se.any(t,i,n)}get onKeyDown(){return this.disposables.add(new et(this.view.domNode,"keydown")).event}get onDidFocus(){return se.signal(this.disposables.add(new et(this.view.domNode,"focus",!0)).event)}get onDidBlur(){return se.signal(this.disposables.add(new et(this.view.domNode,"blur",!0)).event)}constructor(e,t,i,n,s=Ble){this.user=e,this._options=s,this.focus=new dx("focused"),this.anchor=new dx("anchor"),this.eventBufferer=new Cw,this._ariaLabel="",this.disposables=new $,this._onDidDispose=new O,this.onDidDispose=this._onDidDispose.event;const r=this._options.accessibilityProvider&&this._options.accessibilityProvider.getWidgetRole?this._options.accessibilityProvider?.getWidgetRole():"list";this.selection=new Ile(r!=="listbox");const a=[this.focus.renderer,this.selection.renderer];this.accessibilityProvider=s.accessibilityProvider,this.accessibilityProvider&&(a.push(new zle(this.accessibilityProvider)),this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant,this,this.disposables)),n=n.map(c=>new Hle(c.templateId,[...a,c]));const l={...s,dnd:s.dnd&&new Ule(this,s.dnd)};if(this.view=this.createListView(t,i,n,l),this.view.domNode.setAttribute("role",r),s.styleController)this.styleController=s.styleController(this.view.domId);else{const c=Bo(this.view.domNode);this.styleController=new n$(c,this.view.domId)}if(this.spliceable=new Cle([new NI(this.focus,this.view,s.identityProvider),new NI(this.selection,this.view,s.identityProvider),new NI(this.anchor,this.view,s.identityProvider),this.view]),this.disposables.add(this.focus),this.disposables.add(this.selection),this.disposables.add(this.anchor),this.disposables.add(this.view),this.disposables.add(this._onDidDispose),this.disposables.add(new Mle(this,this.view)),(typeof s.keyboardSupport!="boolean"||s.keyboardSupport)&&(this.keyboardController=new JG(this,this.view,s),this.disposables.add(this.keyboardController)),s.keyboardNavigationLabelProvider){const c=s.keyboardNavigationDelegate||Ple;this.typeNavigationController=new Ale(this,this.view,s.keyboardNavigationLabelProvider,s.keyboardNavigationEventFilter??(()=>!0),c),this.disposables.add(this.typeNavigationController)}this.mouseController=this.createMouseController(s),this.disposables.add(this.mouseController),this.onDidChangeFocus(this._onFocusChange,this,this.disposables),this.onDidChangeSelection(this._onSelectionChange,this,this.disposables),this.accessibilityProvider&&(this.ariaLabel=this.accessibilityProvider.getWidgetAriaLabel()),this._options.multipleSelectionSupport!==!1&&this.view.domNode.setAttribute("aria-multiselectable","true")}createListView(e,t,i,n){return new Kr(e,t,i,n)}createMouseController(e){return new i$(this)}updateOptions(e={}){this._options={...this._options,...e},this.typeNavigationController?.updateOptions(this._options),this._options.multipleSelectionController!==void 0&&(this._options.multipleSelectionSupport?this.view.domNode.setAttribute("aria-multiselectable","true"):this.view.domNode.removeAttribute("aria-multiselectable")),this.mouseController.updateOptions(e),this.keyboardController?.updateOptions(e),this.view.updateOptions(e)}get options(){return this._options}splice(e,t,i=[]){if(e<0||e>this.view.length)throw new du(this.user,`Invalid start index: ${e}`);if(t<0)throw new du(this.user,`Invalid delete count: ${t}`);t===0&&i.length===0||this.eventBufferer.bufferEvents(()=>this.spliceable.splice(e,t,i))}rerender(){this.view.rerender()}element(e){return this.view.element(e)}indexOf(e){return this.view.indexOf(e)}indexAt(e){return this.view.indexAt(e)}get length(){return this.view.length}get contentHeight(){return this.view.contentHeight}get onDidChangeContentHeight(){return this.view.onDidChangeContentHeight}get scrollTop(){return this.view.getScrollTop()}set scrollTop(e){this.view.setScrollTop(e)}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get firstVisibleIndex(){return this.view.firstVisibleIndex}get ariaLabel(){return this._ariaLabel}set ariaLabel(e){this._ariaLabel=e,this.view.domNode.setAttribute("aria-label",e)}domFocus(){this.view.domNode.focus({preventScroll:!0})}layout(e,t){this.view.layout(e,t)}setSelection(e,t){for(const i of e)if(i<0||i>=this.length)throw new du(this.user,`Invalid index ${i}`);this.selection.set(e,t)}getSelection(){return this.selection.get()}getSelectedElements(){return this.getSelection().map(e=>this.view.element(e))}setAnchor(e){if(typeof e>"u"){this.anchor.set([]);return}if(e<0||e>=this.length)throw new du(this.user,`Invalid index ${e}`);this.anchor.set([e])}getAnchor(){return _4(this.anchor.get(),void 0)}getAnchorElement(){const e=this.getAnchor();return typeof e>"u"?void 0:this.element(e)}setFocus(e,t){for(const i of e)if(i<0||i>=this.length)throw new du(this.user,`Invalid index ${i}`);this.focus.set(e,t)}focusNext(e=1,t=!1,i,n){if(this.length===0)return;const s=this.focus.get(),r=this.findNextIndex(s.length>0?s[0]+e:0,t,n);r>-1&&this.setFocus([r],i)}focusPrevious(e=1,t=!1,i,n){if(this.length===0)return;const s=this.focus.get(),r=this.findPreviousIndex(s.length>0?s[0]-e:0,t,n);r>-1&&this.setFocus([r],i)}async focusNextPage(e,t){let i=this.view.indexAt(this.view.getScrollTop()+this.view.renderHeight);i=i===0?0:i-1;const n=this.getFocus()[0];if(n!==i&&(n===void 0||i>n)){const s=this.findPreviousIndex(i,!1,t);s>-1&&n!==s?this.setFocus([s],e):this.setFocus([i],e)}else{const s=this.view.getScrollTop();let r=s+this.view.renderHeight;i>n&&(r-=this.view.elementHeight(i)),this.view.setScrollTop(r),this.view.getScrollTop()!==s&&(this.setFocus([]),await Kc(0),await this.focusNextPage(e,t))}}async focusPreviousPage(e,t,i=()=>0){let n;const s=i(),r=this.view.getScrollTop()+s;r===0?n=this.view.indexAt(r):n=this.view.indexAfter(r-1);const a=this.getFocus()[0];if(a!==n&&(a===void 0||a>=n)){const l=this.findNextIndex(n,!1,t);l>-1&&a!==l?this.setFocus([l],e):this.setFocus([n],e)}else{const l=r;this.view.setScrollTop(r-this.view.renderHeight-s),this.view.getScrollTop()+i()!==l&&(this.setFocus([]),await Kc(0),await this.focusPreviousPage(e,t,i))}}focusLast(e,t){if(this.length===0)return;const i=this.findPreviousIndex(this.length-1,!1,t);i>-1&&this.setFocus([i],e)}focusFirst(e,t){this.focusNth(0,e,t)}focusNth(e,t,i){if(this.length===0)return;const n=this.findNextIndex(e,!1,i);n>-1&&this.setFocus([n],t)}findNextIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e>=this.length&&!t)return-1;if(e=e%this.length,!i||i(this.element(e)))return e;e++}return-1}findPreviousIndex(e,t=!1,i){for(let n=0;n<this.length;n++){if(e<0&&!t)return-1;if(e=(this.length+e%this.length)%this.length,!i||i(this.element(e)))return e;e--}return-1}getFocus(){return this.focus.get()}getFocusedElements(){return this.getFocus().map(e=>this.view.element(e))}reveal(e,t,i=0){if(e<0||e>=this.length)throw new du(this.user,`Invalid index ${e}`);const n=this.view.getScrollTop(),s=this.view.elementTop(e),r=this.view.elementHeight(e);if(Lh(t)){const a=r-this.view.renderHeight+i;this.view.setScrollTop(a*ts(t,0,1)+s-i)}else{const a=s+r,l=n+this.view.renderHeight;s<n+i&&a>=l||(s<n+i||a>=l&&r>=this.view.renderHeight?this.view.setScrollTop(s-i):a>=l&&this.view.setScrollTop(a-this.view.renderHeight))}}getRelativeTop(e,t=0){if(e<0||e>=this.length)throw new du(this.user,`Invalid index ${e}`);const i=this.view.getScrollTop(),n=this.view.elementTop(e),s=this.view.elementHeight(e);if(n<i+t||n+s>i+this.view.renderHeight)return null;const r=s-this.view.renderHeight+t;return Math.abs((i+t-n)/r)}getHTMLElement(){return this.view.domNode}getScrollableElement(){return this.view.scrollableElementDomNode}getElementID(e){return this.view.getElementDomId(e)}getElementTop(e){return this.view.elementTop(e)}style(e){this.styleController.style(e)}toListEvent({indexes:e,browserEvent:t}){return{indexes:e,elements:e.map(i=>this.view.element(i)),browserEvent:t}}_onFocusChange(){const e=this.focus.get();this.view.domNode.classList.toggle("element-focused",e.length>0),this.onDidChangeActiveDescendant()}onDidChangeActiveDescendant(){const e=this.focus.get();if(e.length>0){let t;this.accessibilityProvider?.getActiveDescendantId&&(t=this.accessibilityProvider.getActiveDescendantId(this.view.element(e[0]))),this.view.domNode.setAttribute("aria-activedescendant",t||this.view.getElementDomId(e[0]))}else this.view.domNode.removeAttribute("aria-activedescendant")}_onSelectionChange(){const e=this.selection.get();this.view.domNode.classList.toggle("selection-none",e.length===0),this.view.domNode.classList.toggle("selection-single",e.length===1),this.view.domNode.classList.toggle("selection-multiple",e.length>1)}dispose(){this._onDidDispose.fire(),this.disposables.dispose(),this._onDidDispose.dispose()}}Qh([Ti],$o.prototype,"onDidChangeFocus",null);Qh([Ti],$o.prototype,"onDidChangeSelection",null);Qh([Ti],$o.prototype,"onContextMenu",null);Qh([Ti],$o.prototype,"onKeyDown",null);Qh([Ti],$o.prototype,"onDidFocus",null);Qh([Ti],$o.prototype,"onDidBlur",null);const Ju=ie,s$="selectOption.entry.template";class Gle{get templateId(){return s$}renderTemplate(e){const t=Object.create(null);return t.root=e,t.text=Y(e,Ju(".option-text")),t.detail=Y(e,Ju(".option-detail")),t.decoratorRight=Y(e,Ju(".option-decorator-right")),t}renderElement(e,t,i){const n=i,s=e.text,r=e.detail,a=e.decoratorRight,l=e.isDisabled;n.text.textContent=s,n.detail.textContent=r||"",n.decoratorRight.innerText=a||"",l?n.root.classList.add("option-disabled"):n.root.classList.remove("option-disabled")}disposeTemplate(e){}}const nl=class nl extends F{constructor(e,t,i,n,s){super(),this.options=[],this._currentSelection=0,this._hasDetails=!1,this._skipLayout=!1,this._sticky=!1,this._isVisible=!1,this.styles=n,this.selectBoxOptions=s||Object.create(null),typeof this.selectBoxOptions.minBottomMargin!="number"?this.selectBoxOptions.minBottomMargin=nl.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN:this.selectBoxOptions.minBottomMargin<0&&(this.selectBoxOptions.minBottomMargin=0),this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box monaco-select-box-dropdown-padding",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=new O,this._register(this._onDidSelect),this.registerListeners(),this.constructSelectDropDown(i),this.selected=t||0,e&&this.setOptions(e,t),this.initStyleSheet()}setTitle(e){!this._hover&&e?this._hover=this._register(Ba().setupManagedHover(bs("mouse"),this.selectElement,e)):this._hover&&this._hover.update(e)}getHeight(){return 22}getTemplateId(){return s$}constructSelectDropDown(e){this.contextViewProvider=e,this.selectDropDownContainer=ie(".monaco-select-box-dropdown-container"),this.selectDropDownContainer.classList.add("monaco-select-box-dropdown-padding"),this.selectionDetailsPane=Y(this.selectDropDownContainer,Ju(".select-box-details-pane"));const t=Y(this.selectDropDownContainer,Ju(".select-box-dropdown-container-width-control")),i=Y(t,Ju(".width-control-div"));this.widthControlElement=document.createElement("span"),this.widthControlElement.className="option-text-width-control",Y(i,this.widthControlElement),this._dropDownPosition=0,this.styleElement=Bo(this.selectDropDownContainer),this.selectDropDownContainer.setAttribute("draggable","true"),this._register(H(this.selectDropDownContainer,ee.DRAG_START,n=>{tt.stop(n,!0)}))}registerListeners(){this._register(ci(this.selectElement,"change",t=>{this.selected=t.target.selectedIndex,this._onDidSelect.fire({index:t.target.selectedIndex,selected:t.target.value}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)})),this._register(H(this.selectElement,ee.CLICK,t=>{tt.stop(t),this._isVisible?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(H(this.selectElement,ee.MOUSE_DOWN,t=>{tt.stop(t)}));let e;this._register(H(this.selectElement,"touchstart",t=>{e=this._isVisible})),this._register(H(this.selectElement,"touchend",t=>{tt.stop(t),e?this.hideSelectDropDown(!0):this.showSelectDropDown()})),this._register(H(this.selectElement,ee.KEY_DOWN,t=>{const i=new Pt(t);let n=!1;Qe?(i.keyCode===18||i.keyCode===16||i.keyCode===10||i.keyCode===3)&&(n=!0):(i.keyCode===18&&i.altKey||i.keyCode===16&&i.altKey||i.keyCode===10||i.keyCode===3)&&(n=!0),n&&(this.showSelectDropDown(),tt.stop(t,!0))}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){ei(this.options,e)||(this.options=e,this.selectElement.options.length=0,this._hasDetails=!1,this._cachedMaxDetailsHeight=void 0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled)),typeof i.description=="string"&&(this._hasDetails=!0)})),t!==void 0&&(this.select(t),this._currentSelection=this.selected)}setOptionsList(){this.selectList?.splice(0,this.selectList.length,this.options)}select(e){e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){this.container=e,e.classList.add("select-container"),e.appendChild(this.selectElement),this.styleSelectElement()}initStyleSheet(){const e=[];this.styles.listFocusBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { background-color: ${this.styles.listFocusBackground} !important; }`),this.styles.listFocusForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { color: ${this.styles.listFocusForeground} !important; }`),this.styles.decoratorRightForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.focused) .option-decorator-right { color: ${this.styles.decoratorRightForeground}; }`),this.styles.selectBackground&&this.styles.selectBorder&&this.styles.selectBorder!==this.styles.selectBackground?(e.push(`.monaco-select-box-dropdown-container { border: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectBorder} } `)):this.styles.selectListBorder&&(e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-top { border-top: 1px solid ${this.styles.selectListBorder} } `),e.push(`.monaco-select-box-dropdown-container > .select-box-details-pane.border-bottom { border-bottom: 1px solid ${this.styles.selectListBorder} } `)),this.styles.listHoverForeground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { color: ${this.styles.listHoverForeground} !important; }`),this.styles.listHoverBackground&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { background-color: ${this.styles.listHoverBackground} !important; }`),this.styles.listFocusOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.focused { outline: 1.6px dotted ${this.styles.listFocusOutline} !important; outline-offset: -1.6px !important; }`),this.styles.listHoverOutline&&e.push(`.monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row:not(.option-disabled):not(.focused):hover { outline: 1.6px dashed ${this.styles.listHoverOutline} !important; outline-offset: -1.6px !important; }`),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled.focused { background-color: transparent !important; color: inherit !important; outline: none !important; }"),e.push(".monaco-select-box-dropdown-container > .select-box-dropdown-list-container .monaco-list .monaco-list-row.option-disabled:hover { background-color: transparent !important; color: inherit !important; outline: none !important; }"),this.styleElement.textContent=e.join(`
`)}styleSelectElement(){const e=this.styles.selectBackground??"",t=this.styles.selectForeground??"",i=this.styles.selectBorder??"";this.selectElement.style.backgroundColor=e,this.selectElement.style.color=t,this.selectElement.style.borderColor=i}styleList(){const e=this.styles.selectBackground??"",t=Bc(this.styles.selectListBackground,e);this.selectDropDownListContainer.style.backgroundColor=t,this.selectionDetailsPane.style.backgroundColor=t;const i=this.styles.focusBorder??"";this.selectDropDownContainer.style.outlineColor=i,this.selectDropDownContainer.style.outlineOffset="-1px",this.selectList.style(this.styles)}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}showSelectDropDown(){this.selectionDetailsPane.innerText="",!(!this.contextViewProvider||this._isVisible)&&(this.createSelectList(this.selectDropDownContainer),this.setOptionsList(),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e,!0),layout:()=>{this.layoutSelectDropDown()},onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._isVisible=!0,this.hideSelectDropDown(!1),this.contextViewProvider.showContextView({getAnchor:()=>this.selectElement,render:e=>this.renderSelectDropDown(e),layout:()=>this.layoutSelectDropDown(),onHide:()=>{this.selectDropDownContainer.classList.remove("visible"),this.selectElement.classList.remove("synthetic-focus")},anchorPosition:this._dropDownPosition},this.selectBoxOptions.optionsAsChildren?this.container:void 0),this._currentSelection=this.selected,this._isVisible=!0,this.selectElement.setAttribute("aria-expanded","true"))}hideSelectDropDown(e){!this.contextViewProvider||!this._isVisible||(this._isVisible=!1,this.selectElement.setAttribute("aria-expanded","false"),e&&this.selectElement.focus(),this.contextViewProvider.hideContextView())}renderSelectDropDown(e,t){return e.appendChild(this.selectDropDownContainer),this.layoutSelectDropDown(t),{dispose:()=>{this.selectDropDownContainer.remove()}}}measureMaxDetailsHeight(){let e=0;return this.options.forEach((t,i)=>{this.updateDetail(i),this.selectionDetailsPane.offsetHeight>e&&(e=this.selectionDetailsPane.offsetHeight)}),e}layoutSelectDropDown(e){if(this._skipLayout)return!1;if(this.selectList){this.selectDropDownContainer.classList.add("visible");const t=xe(this.selectElement),i=Ci(this.selectElement),n=xe(this.selectElement).getComputedStyle(this.selectElement),s=parseFloat(n.getPropertyValue("--dropdown-padding-top"))+parseFloat(n.getPropertyValue("--dropdown-padding-bottom")),r=t.innerHeight-i.top-i.height-(this.selectBoxOptions.minBottomMargin||0),a=i.top-nl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN,l=this.selectElement.offsetWidth,c=this.setWidthControlElement(this.widthControlElement),d=Math.max(c,Math.round(l)).toString()+"px";this.selectDropDownContainer.style.width=d,this.selectList.getHTMLElement().style.height="",this.selectList.layout();let h=this.selectList.contentHeight;this._hasDetails&&this._cachedMaxDetailsHeight===void 0&&(this._cachedMaxDetailsHeight=this.measureMaxDetailsHeight());const u=this._hasDetails?this._cachedMaxDetailsHeight:0,g=h+s+u,f=Math.floor((r-s-u)/this.getHeight()),m=Math.floor((a-s-u)/this.getHeight());if(e)return i.top+i.height>t.innerHeight-22||i.top<nl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||f<1&&m<1?!1:(f<nl.DEFAULT_MINIMUM_VISIBLE_OPTIONS&&m>f&&this.options.length>f?(this._dropDownPosition=1,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectionDetailsPane.classList.remove("border-top"),this.selectionDetailsPane.classList.add("border-bottom")):(this._dropDownPosition=0,this.selectDropDownListContainer.remove(),this.selectionDetailsPane.remove(),this.selectDropDownContainer.appendChild(this.selectDropDownListContainer),this.selectDropDownContainer.appendChild(this.selectionDetailsPane),this.selectionDetailsPane.classList.remove("border-bottom"),this.selectionDetailsPane.classList.add("border-top")),!0);if(i.top+i.height>t.innerHeight-22||i.top<nl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN||this._dropDownPosition===0&&f<1||this._dropDownPosition===1&&m<1)return this.hideSelectDropDown(!0),!1;if(this._dropDownPosition===0){if(this._isVisible&&f+m<1)return this.hideSelectDropDown(!0),!1;g>r&&(h=f*this.getHeight())}else g>a&&(h=m*this.getHeight());return this.selectList.layout(h),this.selectList.domFocus(),this.selectList.length>0&&(this.selectList.setFocus([this.selected||0]),this.selectList.reveal(this.selectList.getFocus()[0]||0)),this._hasDetails?(this.selectList.getHTMLElement().style.height=h+s+"px",this.selectDropDownContainer.style.height=""):this.selectDropDownContainer.style.height=h+s+"px",this.updateDetail(this.selected),this.selectDropDownContainer.style.width=d,this.selectDropDownListContainer.setAttribute("tabindex","0"),this.selectElement.classList.add("synthetic-focus"),this.selectDropDownContainer.classList.add("synthetic-focus"),!0}else return!1}setWidthControlElement(e){let t=0;if(e){let i=0,n=0;this.options.forEach((s,r)=>{const a=s.detail?s.detail.length:0,l=s.decoratorRight?s.decoratorRight.length:0,c=s.text.length+a+l;c>n&&(i=r,n=c)}),e.textContent=this.options[i].text+(this.options[i].decoratorRight?this.options[i].decoratorRight+" ":""),t=Ks(e)}return t}createSelectList(e){if(this.selectList)return;this.selectDropDownListContainer=Y(e,Ju(".select-box-dropdown-list-container")),this.listRenderer=new Gle,this.selectList=this._register(new $o("SelectBoxCustom",this.selectDropDownListContainer,this,[this.listRenderer],{useShadows:!1,verticalScrollMode:3,keyboardSupport:!1,mouseSupport:!1,accessibilityProvider:{getAriaLabel:n=>{let s=n.text;return n.detail&&(s+=`. ${n.detail}`),n.decoratorRight&&(s+=`. ${n.decoratorRight}`),n.description&&(s+=`. ${n.description}`),s},getWidgetAriaLabel:()=>p({key:"selectBox",comment:["Behave like native select dropdown element."]},"Select Box"),getRole:()=>Qe?"":"option",getWidgetRole:()=>"listbox"}})),this.selectBoxOptions.ariaLabel&&(this.selectList.ariaLabel=this.selectBoxOptions.ariaLabel);const t=this._register(new et(this.selectDropDownListContainer,"keydown")),i=se.chain(t.event,n=>n.filter(()=>this.selectList.length>0).map(s=>new Pt(s)));this._register(se.chain(i,n=>n.filter(s=>s.keyCode===3))(this.onEnter,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===2))(this.onEnter,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===9))(this.onEscape,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===16))(this.onUpArrow,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===18))(this.onDownArrow,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===12))(this.onPageDown,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===11))(this.onPageUp,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===14))(this.onHome,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode===13))(this.onEnd,this)),this._register(se.chain(i,n=>n.filter(s=>s.keyCode>=21&&s.keyCode<=56||s.keyCode>=85&&s.keyCode<=113))(this.onCharacter,this)),this._register(H(this.selectList.getHTMLElement(),ee.POINTER_UP,n=>this.onPointerUp(n))),this._register(this.selectList.onMouseOver(n=>typeof n.index<"u"&&this.selectList.setFocus([n.index]))),this._register(this.selectList.onDidChangeFocus(n=>this.onListFocus(n))),this._register(H(this.selectDropDownContainer,ee.FOCUS_OUT,n=>{!this._isVisible||Ki(n.relatedTarget,this.selectDropDownContainer)||this.onListBlur()})),this.selectList.getHTMLElement().setAttribute("aria-label",this.selectBoxOptions.ariaLabel||""),this.selectList.getHTMLElement().setAttribute("aria-expanded","true"),this.styleList()}onPointerUp(e){if(!this.selectList.length)return;tt.stop(e);const t=e.target;if(!t||t.classList.contains("slider"))return;const i=t.closest(".monaco-list-row");if(!i)return;const n=Number(i.getAttribute("data-index")),s=i.classList.contains("option-disabled");n>=0&&n<this.options.length&&!s&&(this.selected=n,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0))}onListBlur(){this._sticky||(this.selected!==this._currentSelection&&this.select(this._currentSelection),this.hideSelectDropDown(!1))}renderDescriptionMarkdown(e,t){const i=s=>{for(let r=0;r<s.childNodes.length;r++){const a=s.childNodes.item(r);(a.tagName&&a.tagName.toLowerCase())==="img"?a.remove():i(a)}},n=FT({value:e,supportThemeIcons:!0},{actionHandler:t});return n.element.classList.add("select-box-description-markdown"),i(n.element),n.element}onListFocus(e){!this._isVisible||!this._hasDetails||this.updateDetail(e.indexes[0])}updateDetail(e){this.selectionDetailsPane.innerText="";const t=this.options[e],i=t?.description??"",n=t?.descriptionIsMarkdown??!1;if(i){if(n){const s=t.descriptionMarkdownActionHandler;this.selectionDetailsPane.appendChild(this.renderDescriptionMarkdown(i,s))}else this.selectionDetailsPane.innerText=i;this.selectionDetailsPane.style.display="block"}else this.selectionDetailsPane.style.display="none";this._skipLayout=!0,this.contextViewProvider.layout(),this._skipLayout=!1}onEscape(e){tt.stop(e),this.select(this._currentSelection),this.hideSelectDropDown(!0)}onEnter(e){tt.stop(e),this.selected!==this._currentSelection&&(this._currentSelection=this.selected,this._onDidSelect.fire({index:this.selectElement.selectedIndex,selected:this.options[this.selected].text}),this.options[this.selected]&&this.options[this.selected].text&&this.setTitle(this.options[this.selected].text)),this.hideSelectDropDown(!0)}onDownArrow(e){if(this.selected<this.options.length-1){tt.stop(e,!0);const t=this.options[this.selected+1].isDisabled;if(t&&this.options.length>this.selected+2)this.selected+=2;else{if(t)return;this.selected++}this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0])}}onUpArrow(e){this.selected>0&&(tt.stop(e,!0),this.options[this.selected-1].isDisabled&&this.selected>1?this.selected-=2:this.selected--,this.select(this.selected),this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selectList.getFocus()[0]))}onPageUp(e){tt.stop(e),this.selectList.focusPreviousPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected<this.options.length-1&&(this.selected++,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onPageDown(e){tt.stop(e),this.selectList.focusNextPage(),setTimeout(()=>{this.selected=this.selectList.getFocus()[0],this.options[this.selected].isDisabled&&this.selected>0&&(this.selected--,this.selectList.setFocus([this.selected])),this.selectList.reveal(this.selected),this.select(this.selected)},1)}onHome(e){tt.stop(e),!(this.options.length<2)&&(this.selected=0,this.options[this.selected].isDisabled&&this.selected>1&&this.selected++,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onEnd(e){tt.stop(e),!(this.options.length<2)&&(this.selected=this.options.length-1,this.options[this.selected].isDisabled&&this.selected>1&&this.selected--,this.selectList.setFocus([this.selected]),this.selectList.reveal(this.selected),this.select(this.selected))}onCharacter(e){const t=bc.toString(e.keyCode);let i=-1;for(let n=0;n<this.options.length-1;n++)if(i=(n+this.selected+1)%this.options.length,this.options[i].text.charAt(0).toUpperCase()===t&&!this.options[i].isDisabled){this.select(i),this.selectList.setFocus([i]),this.selectList.reveal(this.selectList.getFocus()[0]),tt.stop(e);break}}dispose(){this.hideSelectDropDown(!1),super.dispose()}};nl.DEFAULT_DROPDOWN_MINIMUM_BOTTOM_MARGIN=32,nl.DEFAULT_DROPDOWN_MINIMUM_TOP_MARGIN=2,nl.DEFAULT_MINIMUM_VISIBLE_OPTIONS=3;let EA=nl;class $le extends F{constructor(e,t,i,n){super(),this.selected=0,this.selectBoxOptions=n||Object.create(null),this.options=[],this.selectElement=document.createElement("select"),this.selectElement.className="monaco-select-box",typeof this.selectBoxOptions.ariaLabel=="string"&&this.selectElement.setAttribute("aria-label",this.selectBoxOptions.ariaLabel),typeof this.selectBoxOptions.ariaDescription=="string"&&this.selectElement.setAttribute("aria-description",this.selectBoxOptions.ariaDescription),this._onDidSelect=this._register(new O),this.styles=i,this.registerListeners(),this.setOptions(e,t)}registerListeners(){this._register(Mn.addTarget(this.selectElement)),[Ot.Tap].forEach(e=>{this._register(H(this.selectElement,e,t=>{this.selectElement.focus()}))}),this._register(ci(this.selectElement,"click",e=>{tt.stop(e,!0)})),this._register(ci(this.selectElement,"change",e=>{this.selectElement.title=e.target.value,this._onDidSelect.fire({index:e.target.selectedIndex,selected:e.target.value})})),this._register(ci(this.selectElement,"keydown",e=>{let t=!1;Qe?(e.keyCode===18||e.keyCode===16||e.keyCode===10)&&(t=!0):(e.keyCode===18&&e.altKey||e.keyCode===10||e.keyCode===3)&&(t=!0),t&&e.stopPropagation()}))}get onDidSelect(){return this._onDidSelect.event}setOptions(e,t){(!this.options||!ei(this.options,e))&&(this.options=e,this.selectElement.options.length=0,this.options.forEach((i,n)=>{this.selectElement.add(this.createOption(i.text,n,i.isDisabled))})),t!==void 0&&this.select(t)}select(e){this.options.length===0?this.selected=0:e>=0&&e<this.options.length?this.selected=e:e>this.options.length-1?this.select(this.options.length-1):this.selected<0&&(this.selected=0),this.selectElement.selectedIndex=this.selected,this.selected<this.options.length&&typeof this.options[this.selected].text=="string"?this.selectElement.title=this.options[this.selected].text:this.selectElement.title=""}focus(){this.selectElement&&(this.selectElement.tabIndex=0,this.selectElement.focus())}blur(){this.selectElement&&(this.selectElement.tabIndex=-1,this.selectElement.blur())}setFocusable(e){this.selectElement.tabIndex=e?0:-1}render(e){e.classList.add("select-container"),e.appendChild(this.selectElement),this.setOptions(this.options,this.selected),this.applyStyles()}applyStyles(){this.selectElement&&(this.selectElement.style.backgroundColor=this.styles.selectBackground??"",this.selectElement.style.color=this.styles.selectForeground??"",this.selectElement.style.borderColor=this.styles.selectBorder??"")}createOption(e,t,i){const n=document.createElement("option");return n.value=e,n.text=e,n.disabled=!!i,n}}class Kle extends Go{constructor(e,t,i,n,s){super(),Qe&&!s?.useCustomDrawn?this.selectBoxDelegate=new $le(e,t,n,s):this.selectBoxDelegate=new EA(e,t,i,n,s),this._register(this.selectBoxDelegate)}get onDidSelect(){return this.selectBoxDelegate.onDidSelect}setOptions(e,t){this.selectBoxDelegate.setOptions(e,t)}select(e){this.selectBoxDelegate.select(e)}focus(){this.selectBoxDelegate.focus()}blur(){this.selectBoxDelegate.blur()}setFocusable(e){this.selectBoxDelegate.setFocusable(e)}render(e){this.selectBoxDelegate.render(e)}}class ga extends F{get action(){return this._action}constructor(e,t,i={}){super(),this.options=i,this._context=e||this,this._action=t,t instanceof to&&this._register(t.onDidChange(n=>{this.element&&this.handleActionChangeEvent(n)}))}handleActionChangeEvent(e){e.enabled!==void 0&&this.updateEnabled(),e.checked!==void 0&&this.updateChecked(),e.class!==void 0&&this.updateClass(),e.label!==void 0&&(this.updateLabel(),this.updateTooltip()),e.tooltip!==void 0&&this.updateTooltip()}get actionRunner(){return this._actionRunner||(this._actionRunner=this._register(new Cf)),this._actionRunner}set actionRunner(e){this._actionRunner=e}isEnabled(){return this._action.enabled}setActionContext(e){this._context=e}render(e){const t=this.element=e;this._register(Mn.addTarget(e));const i=this.options&&this.options.draggable;i&&(e.draggable=!0,dr&&this._register(H(e,ee.DRAG_START,n=>n.dataTransfer?.setData(_y.TEXT,this._action.label)))),this._register(H(t,Ot.Tap,n=>this.onClick(n,!0))),this._register(H(t,ee.MOUSE_DOWN,n=>{i||tt.stop(n,!0),this._action.enabled&&n.button===0&&t.classList.add("active")})),Qe&&this._register(H(t,ee.CONTEXT_MENU,n=>{n.button===0&&n.ctrlKey===!0&&this.onClick(n)})),this._register(H(t,ee.CLICK,n=>{tt.stop(n,!0),this.options&&this.options.isMenu||this.onClick(n)})),this._register(H(t,ee.DBLCLICK,n=>{tt.stop(n,!0)})),[ee.MOUSE_UP,ee.MOUSE_OUT].forEach(n=>{this._register(H(t,n,s=>{tt.stop(s),t.classList.remove("active")}))})}onClick(e,t=!1){tt.stop(e,!0);const i=ko(this._context)?this.options?.useEventAsContext?e:{preserveFocus:t}:this._context;this.actionRunner.run(this._action,i)}focus(){this.element&&(this.element.tabIndex=0,this.element.focus(),this.element.classList.add("focused"))}blur(){this.element&&(this.element.blur(),this.element.tabIndex=-1,this.element.classList.remove("focused"))}setFocusable(e){this.element&&(this.element.tabIndex=e?0:-1)}get trapsArrowNavigation(){return!1}updateEnabled(){}updateLabel(){}getClass(){return this.action.class}getTooltip(){return this.action.tooltip}updateTooltip(){if(!this.element)return;const e=this.getTooltip()??"";if(this.updateAriaLabel(),this.options.hoverDelegate?.showNativeHover)this.element.title=e;else if(!this.customHover&&e!==""){const t=this.options.hoverDelegate??bs("element");this.customHover=this._store.add(Ba().setupManagedHover(t,this.element,e))}else this.customHover&&this.customHover.update(e)}updateAriaLabel(){if(this.element){const e=this.getTooltip()??"";this.element.setAttribute("aria-label",e)}}updateClass(){}updateChecked(){}dispose(){this.element&&(this.element.remove(),this.element=void 0),this._context=void 0,super.dispose()}}class I_ extends ga{constructor(e,t,i){super(e,t,i),this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass=""}render(e){super.render(e),ut(this.element);const t=document.createElement("a");if(t.classList.add("action-label"),t.setAttribute("role",this.getDefaultAriaRole()),this.label=t,this.element.appendChild(t),this.options.label&&this.options.keybinding){const i=document.createElement("span");i.classList.add("keybinding"),i.textContent=this.options.keybinding,this.element.appendChild(i)}this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked()}getDefaultAriaRole(){return this._action.id===Zi.ID?"presentation":this.options.isMenu?"menuitem":this.options.isTabList?"tab":"button"}focus(){this.label&&(this.label.tabIndex=0,this.label.focus())}blur(){this.label&&(this.label.tabIndex=-1)}setFocusable(e){this.label&&(this.label.tabIndex=e?0:-1)}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this.action.label)}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:!this.options.label&&this.action.label&&this.options.icon&&(e=this.action.label,this.options.keybinding&&(e=p({key:"titleLabel",comment:["action title","action keybinding"]},"{0} ({1})",e,this.options.keybinding))),e??void 0}updateClass(){this.cssClass&&this.label&&this.label.classList.remove(...this.cssClass.split(" ")),this.options.icon?(this.cssClass=this.getClass(),this.label&&(this.label.classList.add("codicon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" "))),this.updateEnabled()):this.label?.classList.remove("codicon")}updateEnabled(){this.action.enabled?(this.label&&(this.label.removeAttribute("aria-disabled"),this.label.classList.remove("disabled")),this.element?.classList.remove("disabled")):(this.label&&(this.label.setAttribute("aria-disabled","true"),this.label.classList.add("disabled")),this.element?.classList.add("disabled"))}updateAriaLabel(){if(this.label){const e=this.getTooltip()??"";this.label.setAttribute("aria-label",e)}}updateChecked(){this.label&&(this.action.checked!==void 0?(this.label.classList.toggle("checked",this.action.checked),this.options.isTabList?this.label.setAttribute("aria-selected",this.action.checked?"true":"false"):(this.label.setAttribute("aria-checked",this.action.checked?"true":"false"),this.label.setAttribute("role","checkbox"))):(this.label.classList.remove("checked"),this.label.removeAttribute(this.options.isTabList?"aria-selected":"aria-checked"),this.label.setAttribute("role",this.getDefaultAriaRole())))}}class jle extends ga{constructor(e,t,i,n,s,r,a){super(e,t),this.selectBox=new Kle(i,n,s,r,a),this.selectBox.setFocusable(!1),this._register(this.selectBox),this.registerListeners()}select(e){this.selectBox.select(e)}registerListeners(){this._register(this.selectBox.onDidSelect(e=>this.runAction(e.selected,e.index)))}runAction(e,t){this.actionRunner.run(this._action,this.getActionContext(e,t))}getActionContext(e,t){return e}setFocusable(e){this.selectBox.setFocusable(e)}focus(){this.selectBox?.focus()}blur(){this.selectBox?.blur()}render(e){this.selectBox.render(e)}}class qle extends Cf{constructor(e,t){super(),this._onDidChangeVisibility=this._register(new O),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this._element=Y(e,ie(".monaco-dropdown")),this._label=Y(this._element,ie(".dropdown-label"));let i=t.labelRenderer;i||(i=s=>(s.textContent=t.label||"",null));for(const s of[ee.CLICK,ee.MOUSE_DOWN,Ot.Tap])this._register(H(this.element,s,r=>tt.stop(r,!0)));for(const s of[ee.MOUSE_DOWN,Ot.Tap])this._register(H(this._label,s,r=>{U4(r)&&(r.detail>1||r.button!==0)||(this.visible?this.hide():this.show())}));this._register(H(this._label,ee.KEY_UP,s=>{const r=new Pt(s);(r.equals(3)||r.equals(10))&&(tt.stop(s,!0),this.visible?this.hide():this.show())}));const n=i(this._label);n&&this._register(n),this._register(Mn.addTarget(this._label))}get element(){return this._element}show(){this.visible||(this.visible=!0,this._onDidChangeVisibility.fire(!0))}hide(){this.visible&&(this.visible=!1,this._onDidChangeVisibility.fire(!1))}dispose(){super.dispose(),this.hide(),this.boxContainer&&(this.boxContainer.remove(),this.boxContainer=void 0),this.contents&&(this.contents.remove(),this.contents=void 0),this._label&&(this._label.remove(),this._label=void 0)}}class Zle extends qle{constructor(e,t){super(e,t),this._options=t,this._actions=[],this.actions=t.actions||[]}set menuOptions(e){this._menuOptions=e}get menuOptions(){return this._menuOptions}get actions(){return this._options.actionProvider?this._options.actionProvider.getActions():this._actions}set actions(e){this._actions=e}show(){super.show(),this.element.classList.add("active"),this._options.contextMenuProvider.showContextMenu({getAnchor:()=>this.element,getActions:()=>this.actions,getActionsContext:()=>this.menuOptions?this.menuOptions.context:null,getActionViewItem:(e,t)=>this.menuOptions&&this.menuOptions.actionViewItemProvider?this.menuOptions.actionViewItemProvider(e,t):void 0,getKeyBinding:e=>this.menuOptions&&this.menuOptions.getKeyBinding?this.menuOptions.getKeyBinding(e):void 0,getMenuClassName:()=>this._options.menuClassName||"",onHide:()=>this.onHide(),actionRunner:this.menuOptions?this.menuOptions.actionRunner:void 0,anchorAlignment:this.menuOptions?this.menuOptions.anchorAlignment:0,domForShadowRoot:this._options.menuAsChild?this.element:void 0,skipTelemetry:this._options.skipTelemetry})}hide(){super.hide()}onHide(){this.hide(),this.element.classList.remove("active")}}class hx extends ga{constructor(e,t,i,n=Object.create(null)){super(null,e,n),this.actionItem=null,this._onDidChangeVisibility=this._register(new O),this.onDidChangeVisibility=this._onDidChangeVisibility.event,this.menuActionsOrProvider=t,this.contextMenuProvider=i,this.options=n,this.options.actionRunner&&(this.actionRunner=this.options.actionRunner)}render(e){this.actionItem=e;const t=s=>{this.element=Y(s,ie("a.action-label"));let r=[];return typeof this.options.classNames=="string"?r=this.options.classNames.split(/\s+/g).filter(a=>!!a):this.options.classNames&&(r=this.options.classNames),r.find(a=>a==="icon")||r.push("codicon"),this.element.classList.add(...r),this.element.setAttribute("role","button"),this.element.setAttribute("aria-haspopup","true"),this.element.setAttribute("aria-expanded","false"),this._action.label&&this._register(Ba().setupManagedHover(this.options.hoverDelegate??bs("mouse"),this.element,this._action.label)),this.element.ariaLabel=this._action.label||"",null},i=Array.isArray(this.menuActionsOrProvider),n={contextMenuProvider:this.contextMenuProvider,labelRenderer:t,menuAsChild:this.options.menuAsChild,actions:i?this.menuActionsOrProvider:void 0,actionProvider:i?void 0:this.menuActionsOrProvider,skipTelemetry:this.options.skipTelemetry};if(this.dropdownMenu=this._register(new Zle(e,n)),this._register(this.dropdownMenu.onDidChangeVisibility(s=>{this.element?.setAttribute("aria-expanded",`${s}`),this._onDidChangeVisibility.fire(s)})),this.dropdownMenu.menuOptions={actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,getKeyBinding:this.options.keybindingProvider,context:this._context},this.options.anchorAlignmentProvider){const s=this;this.dropdownMenu.menuOptions={...this.dropdownMenu.menuOptions,get anchorAlignment(){return s.options.anchorAlignmentProvider()}}}this.updateTooltip(),this.updateEnabled()}getTooltip(){let e=null;return this.action.tooltip?e=this.action.tooltip:this.action.label&&(e=this.action.label),e??void 0}setActionContext(e){super.setActionContext(e),this.dropdownMenu&&(this.dropdownMenu.menuOptions?this.dropdownMenu.menuOptions.context=e:this.dropdownMenu.menuOptions={context:e})}show(){this.dropdownMenu?.show()}updateEnabled(){const e=!this.action.enabled;this.actionItem?.classList.toggle("disabled",e),this.element?.classList.toggle("disabled",e)}}function Yle(o){return o&&typeof o=="object"&&typeof o.original=="string"&&typeof o.value=="string"}function Xle(o){return o?o.condition!==void 0:!1}var Bm;(function(o){o[o.STORAGE_DOES_NOT_EXIST=0]="STORAGE_DOES_NOT_EXIST",o[o.STORAGE_IN_MEMORY=1]="STORAGE_IN_MEMORY"})(Bm||(Bm={}));var Qp;(function(o){o[o.None=0]="None",o[o.Initialized=1]="Initialized",o[o.Closed=2]="Closed"})(Qp||(Qp={}));const Nk=class Nk extends F{constructor(e,t=Object.create(null)){super(),this.database=e,this.options=t,this._onDidChangeStorage=this._register(new pf),this.onDidChangeStorage=this._onDidChangeStorage.event,this.state=Qp.None,this.cache=new Map,this.flushDelayer=this._register(new Az(Nk.DEFAULT_FLUSH_DELAY)),this.pendingDeletes=new Set,this.pendingInserts=new Map,this.whenFlushedCallbacks=[],this.registerListeners()}registerListeners(){this._register(this.database.onDidChangeItemsExternal(e=>this.onDidChangeItemsExternal(e)))}onDidChangeItemsExternal(e){this._onDidChangeStorage.pause();try{e.changed?.forEach((t,i)=>this.acceptExternal(i,t)),e.deleted?.forEach(t=>this.acceptExternal(t,void 0))}finally{this._onDidChangeStorage.resume()}}acceptExternal(e,t){if(this.state===Qp.Closed)return;let i=!1;ko(t)?i=this.cache.delete(e):this.cache.get(e)!==t&&(this.cache.set(e,t),i=!0),i&&this._onDidChangeStorage.fire({key:e,external:!0})}get(e,t){const i=this.cache.get(e);return ko(i)?t:i}getBoolean(e,t){const i=this.get(e);return ko(i)?t:i==="true"}getNumber(e,t){const i=this.get(e);return ko(i)?t:parseInt(i,10)}async set(e,t,i=!1){if(this.state===Qp.Closed)return;if(ko(t))return this.delete(e,i);const n=nn(t)||Array.isArray(t)?Tre(t):String(t);if(this.cache.get(e)!==n)return this.cache.set(e,n),this.pendingInserts.set(e,n),this.pendingDeletes.delete(e),this._onDidChangeStorage.fire({key:e,external:i}),this.doFlush()}async delete(e,t=!1){if(!(this.state===Qp.Closed||!this.cache.delete(e)))return this.pendingDeletes.has(e)||this.pendingDeletes.add(e),this.pendingInserts.delete(e),this._onDidChangeStorage.fire({key:e,external:t}),this.doFlush()}get hasPending(){return this.pendingInserts.size>0||this.pendingDeletes.size>0}async flushPending(){if(!this.hasPending)return;const e={insert:this.pendingInserts,delete:this.pendingDeletes};return this.pendingDeletes=new Set,this.pendingInserts=new Map,this.database.updateItems(e).finally(()=>{if(!this.hasPending)for(;this.whenFlushedCallbacks.length;)this.whenFlushedCallbacks.pop()?.()})}async doFlush(e){return this.options.hint===Bm.STORAGE_IN_MEMORY?this.flushPending():this.flushDelayer.trigger(()=>this.flushPending(),e)}};Nk.DEFAULT_FLUSH_DELAY=100;let zv=Nk;class RI{constructor(){this.onDidChangeItemsExternal=se.None,this.items=new Map}async updateItems(e){e.insert?.forEach((t,i)=>this.items.set(i,t)),e.delete?.forEach(t=>this.items.delete(t))}}const z1="__$__targetStorageMarker",Yr=Je("storageService");var vy;(function(o){o[o.NONE=0]="NONE",o[o.SHUTDOWN=1]="SHUTDOWN"})(vy||(vy={}));function Qle(o){const e=o.get(z1);if(e)try{return JSON.parse(e)}catch{}return Object.create(null)}const Rk=class Rk extends F{constructor(e={flushInterval:Rk.DEFAULT_FLUSH_INTERVAL}){super(),this.options=e,this._onDidChangeValue=this._register(new pf),this._onDidChangeTarget=this._register(new pf),this._onWillSaveState=this._register(new O),this.onWillSaveState=this._onWillSaveState.event,this._workspaceKeyTargets=void 0,this._profileKeyTargets=void 0,this._applicationKeyTargets=void 0}onDidChangeValue(e,t,i){return se.filter(this._onDidChangeValue.event,n=>n.scope===e&&(t===void 0||n.key===t),i)}emitDidChangeValue(e,t){const{key:i,external:n}=t;if(i===z1){switch(e){case-1:this._applicationKeyTargets=void 0;break;case 0:this._profileKeyTargets=void 0;break;case 1:this._workspaceKeyTargets=void 0;break}this._onDidChangeTarget.fire({scope:e})}else this._onDidChangeValue.fire({scope:e,key:i,target:this.getKeyTargets(e)[i],external:n})}get(e,t,i){return this.getStorage(t)?.get(e,i)}getBoolean(e,t,i){return this.getStorage(t)?.getBoolean(e,i)}getNumber(e,t,i){return this.getStorage(t)?.getNumber(e,i)}store(e,t,i,n,s=!1){if(ko(t)){this.remove(e,i,s);return}this.withPausedEmitters(()=>{this.updateKeyTarget(e,i,n),this.getStorage(i)?.set(e,t,s)})}remove(e,t,i=!1){this.withPausedEmitters(()=>{this.updateKeyTarget(e,t,void 0),this.getStorage(t)?.delete(e,i)})}withPausedEmitters(e){this._onDidChangeValue.pause(),this._onDidChangeTarget.pause();try{e()}finally{this._onDidChangeValue.resume(),this._onDidChangeTarget.resume()}}updateKeyTarget(e,t,i,n=!1){const s=this.getKeyTargets(t);typeof i=="number"?s[e]!==i&&(s[e]=i,this.getStorage(t)?.set(z1,JSON.stringify(s),n)):typeof s[e]=="number"&&(delete s[e],this.getStorage(t)?.set(z1,JSON.stringify(s),n))}get workspaceKeyTargets(){return this._workspaceKeyTargets||(this._workspaceKeyTargets=this.loadKeyTargets(1)),this._workspaceKeyTargets}get profileKeyTargets(){return this._profileKeyTargets||(this._profileKeyTargets=this.loadKeyTargets(0)),this._profileKeyTargets}get applicationKeyTargets(){return this._applicationKeyTargets||(this._applicationKeyTargets=this.loadKeyTargets(-1)),this._applicationKeyTargets}getKeyTargets(e){switch(e){case-1:return this.applicationKeyTargets;case 0:return this.profileKeyTargets;default:return this.workspaceKeyTargets}}loadKeyTargets(e){const t=this.getStorage(e);return t?Qle(t):Object.create(null)}};Rk.DEFAULT_FLUSH_INTERVAL=60*1e3;let TA=Rk;class Jle extends TA{constructor(){super(),this.applicationStorage=this._register(new zv(new RI,{hint:Bm.STORAGE_IN_MEMORY})),this.profileStorage=this._register(new zv(new RI,{hint:Bm.STORAGE_IN_MEMORY})),this.workspaceStorage=this._register(new zv(new RI,{hint:Bm.STORAGE_IN_MEMORY})),this._register(this.workspaceStorage.onDidChangeStorage(e=>this.emitDidChangeValue(1,e))),this._register(this.profileStorage.onDidChangeStorage(e=>this.emitDidChangeValue(0,e))),this._register(this.applicationStorage.onDidChangeStorage(e=>this.emitDidChangeValue(-1,e)))}getStorage(e){switch(e){case-1:return this.applicationStorage;case 0:return this.profileStorage;default:return this.workspaceStorage}}}function ece(o,e){const t={...e};for(const i in o){const n=o[i];t[i]=n!==void 0?ce(n):void 0}return t}const tce={keybindingLabelBackground:ce($se),keybindingLabelForeground:ce(Kse),keybindingLabelBorder:ce(jse),keybindingLabelBottomBorder:ce(qse),keybindingLabelShadow:ce(lb)},ice={buttonForeground:ce(uG),buttonSeparator:ce(Nse),buttonBackground:ce(uv),buttonHoverBackground:ce(Rse),buttonSecondaryForeground:ce(Ase),buttonSecondaryBackground:ce(ZP),buttonSecondaryHoverBackground:ce(Mse),buttonBorder:ce(Pse)},nce={progressBarBackground:ce($ne)},ux={inputActiveOptionBorder:ce(DT),inputActiveOptionForeground:ce(IT),inputActiveOptionBackground:ce(Dw)};ce(gv),ce(Ose),ce(Fse),ce(Bse),ce(Wse),ce(Vse),ce(Hse);ce(zse),ce(Gse),ce(Use);ce(Ro),ce(kT),ce(lb),ce(rt),ce(use),ce(gse),ce(fse),ce(Une);const gx={inputBackground:ce(qP),inputForeground:ce(dG),inputBorder:ce(hG),inputValidationInfoBorder:ce(Sse),inputValidationInfoBackground:ce(yse),inputValidationInfoForeground:ce(wse),inputValidationWarningBorder:ce(kse),inputValidationWarningBackground:ce(xse),inputValidationWarningForeground:ce(Lse),inputValidationErrorBorder:ce(Dse),inputValidationErrorBackground:ce(Ese),inputValidationErrorForeground:ce(Tse)},sce={listFilterWidgetBackground:ce(aoe),listFilterWidgetOutline:ce(loe),listFilterWidgetNoMatchesOutline:ce(coe),listFilterWidgetShadow:ce(doe),inputBoxStyles:gx,toggleStyles:ux},o$={badgeBackground:ce(B1),badgeForeground:ce(Gne),badgeBorder:ce(rt)};ce(dse),ce(cse),ce(tH),ce(tH),ce(hse);const qf={listBackground:void 0,listInactiveFocusForeground:void 0,listFocusBackground:ce(Zse),listFocusForeground:ce(Yse),listFocusOutline:ce(Xse),listActiveSelectionBackground:ce(wf),listActiveSelectionForeground:ce(ay),listActiveSelectionIconForeground:ce(gG),listFocusAndSelectionOutline:ce(Qse),listFocusAndSelectionBackground:ce(wf),listFocusAndSelectionForeground:ce(ay),listInactiveSelectionBackground:ce(Jse),listInactiveSelectionIconForeground:ce(toe),listInactiveSelectionForeground:ce(eoe),listInactiveFocusBackground:ce(ioe),listInactiveFocusOutline:ce(noe),listHoverBackground:ce(fG),listHoverForeground:ce(pG),listDropOverBackground:ce(soe),listDropBetweenBackground:ce(ooe),listSelectionOutline:ce(qt),listHoverOutline:ce(qt),treeIndentGuidesStroke:ce(mG),treeInactiveIndentGuidesStroke:ce(hoe),treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:ce(c5),tableColumnsBorder:ce(uoe),tableOddRowsBackgroundColor:ce(goe)};function Zf(o){return ece(o,qf)}const oce={selectBackground:ce(NT),selectListBackground:ce(Ise),selectForeground:ce(p5),decoratorRightForeground:ce(_G),selectBorder:ce(m5),focusBorder:ce(Il),listFocusBackground:ce(cy),listInactiveSelectionIconForeground:ce(_5),listFocusForeground:ce(ly),listFocusOutline:Fne(qt,j.transparent.toString()),listHoverBackground:ce(fG),listHoverForeground:ce(pG),listHoverOutline:ce(qt),selectListBorder:ce(d5),listBackground:void 0,listActiveSelectionBackground:void 0,listActiveSelectionForeground:void 0,listActiveSelectionIconForeground:void 0,listFocusAndSelectionBackground:void 0,listDropOverBackground:void 0,listDropBetweenBackground:void 0,listInactiveSelectionBackground:void 0,listInactiveSelectionForeground:void 0,listInactiveFocusBackground:void 0,listInactiveFocusOutline:void 0,listSelectionOutline:void 0,listFocusAndSelectionForeground:void 0,listFocusAndSelectionOutline:void 0,listInactiveFocusForeground:void 0,tableColumnsBorder:void 0,tableOddRowsBackgroundColor:void 0,treeIndentGuidesStroke:void 0,treeInactiveIndentGuidesStroke:void 0,treeStickyScrollBackground:void 0,treeStickyScrollBorder:void 0,treeStickyScrollShadow:void 0},rce={shadowColor:ce(lb),borderColor:ce(foe),foregroundColor:ce(poe),backgroundColor:ce(moe),selectionForegroundColor:ce(_oe),selectionBackgroundColor:ce(boe),selectionBorderColor:ce(voe),separatorColor:ce(Coe),scrollbarShadow:ce(c5),scrollbarSliderBackground:ce(iG),scrollbarSliderHoverBackground:ce(nG),scrollbarSliderActiveBackground:ce(sG)};var GT=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Es=function(o,e){return function(t,i){e(t,i,o)}};function ace(o,e,t,i){let n,s,r;if(Array.isArray(o))r=o,n=e,s=t;else{const c=e;r=o.getActions(c),n=t,s=i}const a=Lc.getInstance(),l=a.keyStatus.altKey||(En||us)&&a.keyStatus.shiftKey;r$(r,n,l,s?c=>c===s:c=>c==="navigation")}function $T(o,e,t,i,n,s){let r,a,l,c,d;if(Array.isArray(o))d=o,r=e,a=t,l=i,c=n;else{const u=e;d=o.getActions(u),r=t,a=i,l=n,c=s}r$(d,r,!1,typeof a=="string"?u=>u===a:a,l,c)}function r$(o,e,t,i=r=>r==="navigation",n=()=>!1,s=!1){let r,a;Array.isArray(e)?(r=e,a=e):(r=e.primary,a=e.secondary);const l=new Set;for(const[c,d]of o){let h;i(c)?(h=r,h.length>0&&s&&h.push(new Zi)):(h=a,h.length>0&&h.push(new Zi));for(let u of d){t&&(u=u instanceof io&&u.alt?u.alt:u);const g=h.push(u);u instanceof m_&&l.add({group:c,action:u,index:g-1})}}for(const{group:c,action:d,index:h}of l){const u=i(c)?r:a,g=d.actions;n(d,c,u.length)&&u.splice(h,1,...g)}}let Fh=class extends I_{constructor(e,t,i,n,s,r,a,l){super(void 0,e,{icon:!!(e.class||e.item.icon),label:!e.class&&!e.item.icon,draggable:t?.draggable,keybinding:t?.keybinding,hoverDelegate:t?.hoverDelegate}),this._options=t,this._keybindingService=i,this._notificationService=n,this._contextKeyService=s,this._themeService=r,this._contextMenuService=a,this._accessibilityService=l,this._wantsAltCommand=!1,this._itemClassDispose=this._register(new Yi),this._altKey=Lc.getInstance()}get _menuItemAction(){return this._action}get _commandAction(){return this._wantsAltCommand&&this._menuItemAction.alt||this._menuItemAction}async onClick(e){e.preventDefault(),e.stopPropagation();try{await this.actionRunner.run(this._commandAction,this._context)}catch(t){this._notificationService.error(t)}}render(e){if(super.render(e),e.classList.add("menu-entry"),this.options.icon&&this._updateItemClass(this._menuItemAction.item),this._menuItemAction.alt){let t=!1;const i=()=>{const n=!!this._menuItemAction.alt?.enabled&&(!this._accessibilityService.isMotionReduced()||t)&&(this._altKey.keyStatus.altKey||this._altKey.keyStatus.shiftKey&&t);n!==this._wantsAltCommand&&(this._wantsAltCommand=n,this.updateLabel(),this.updateTooltip(),this.updateClass())};this._register(this._altKey.event(i)),this._register(H(e,"mouseleave",n=>{t=!1,i()})),this._register(H(e,"mouseenter",n=>{t=!0,i()})),i()}}updateLabel(){this.options.label&&this.label&&(this.label.textContent=this._commandAction.label)}getTooltip(){const e=this._keybindingService.lookupKeybinding(this._commandAction.id,this._contextKeyService),t=e&&e.getLabel(),i=this._commandAction.tooltip||this._commandAction.label;let n=t?p("titleAndKb","{0} ({1})",i,t):i;if(!this._wantsAltCommand&&this._menuItemAction.alt?.enabled){const s=this._menuItemAction.alt.tooltip||this._menuItemAction.alt.label,r=this._keybindingService.lookupKeybinding(this._menuItemAction.alt.id,this._contextKeyService),a=r&&r.getLabel(),l=a?p("titleAndKb","{0} ({1})",s,a):s;n=p("titleAndKbAndAlt",`{0}
[{1}] {2}`,n,P5.modifierLabels[Js].altKey,l)}return n}updateClass(){this.options.icon&&(this._commandAction!==this._menuItemAction?this._menuItemAction.alt&&this._updateItemClass(this._menuItemAction.alt.item):this._updateItemClass(this._menuItemAction.item))}_updateItemClass(e){this._itemClassDispose.value=void 0;const{element:t,label:i}=this;if(!t||!i)return;const n=this._commandAction.checked&&Xle(e.toggled)&&e.toggled.icon?e.toggled.icon:e.icon;if(n)if(ke.isThemeIcon(n)){const s=ke.asClassNameArray(n);i.classList.add(...s),this._itemClassDispose.value=ve(()=>{i.classList.remove(...s)})}else i.style.backgroundImage=v_(this._themeService.getColorTheme().type)?jc(n.dark):jc(n.light),i.classList.add("icon"),this._itemClassDispose.value=Wr(ve(()=>{i.style.backgroundImage="",i.classList.remove("icon")}),this._themeService.onDidColorThemeChange(()=>{this.updateClass()}))}};Fh=GT([Es(2,vt),Es(3,Ei),Es(4,Ee),Es(5,zi),Es(6,co),Es(7,ho)],Fh);class F5 extends Fh{render(e){this.options.label=!0,this.options.icon=!1,super.render(e),e.classList.add("text-only"),e.classList.toggle("use-comma",this._options?.useComma??!1)}updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=F5._symbolPrintEnter(e);this._options?.conversational?this.label.textContent=p({key:"content2",comment:['A label with keybindg like "ESC to dismiss"']},"{1} to {0}",this._action.label,t):this.label.textContent=p({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",this._action.label,t)}}static _symbolPrintEnter(e){return e.getLabel()?.replace(/\benter\b/gi,"⏎").replace(/\bEscape\b/gi,"Esc")}}let DA=class extends hx{constructor(e,t,i,n,s){const r={...t,menuAsChild:t?.menuAsChild??!1,classNames:t?.classNames??(ke.isThemeIcon(e.item.icon)?ke.asClassName(e.item.icon):void 0),keybindingProvider:t?.keybindingProvider??(a=>i.lookupKeybinding(a.id))};super(e,{getActions:()=>e.actions},n,r),this._keybindingService=i,this._contextMenuService=n,this._themeService=s}render(e){super.render(e),ut(this.element),e.classList.add("menu-entry");const t=this._action,{icon:i}=t.item;if(i&&!ke.isThemeIcon(i)){this.element.classList.add("icon");const n=()=>{this.element&&(this.element.style.backgroundImage=v_(this._themeService.getColorTheme().type)?jc(i.dark):jc(i.light))};n(),this._register(this._themeService.onDidColorThemeChange(()=>{n()}))}}};DA=GT([Es(2,vt),Es(3,co),Es(4,zi)],DA);let IA=class extends ga{constructor(e,t,i,n,s,r,a,l){super(null,e),this._keybindingService=i,this._notificationService=n,this._contextMenuService=s,this._menuService=r,this._instaService=a,this._storageService=l,this._container=null,this._options=t,this._storageKey=`${e.item.submenu.id}_lastActionId`;let c;const d=t?.persistLastActionId?l.get(this._storageKey,1):void 0;d&&(c=e.actions.find(u=>d===u.id)),c||(c=e.actions[0]),this._defaultAction=this._instaService.createInstance(Fh,c,{keybinding:this._getDefaultActionKeybindingLabel(c)});const h={keybindingProvider:u=>this._keybindingService.lookupKeybinding(u.id),...t,menuAsChild:t?.menuAsChild??!0,classNames:t?.classNames??["codicon","codicon-chevron-down"],actionRunner:t?.actionRunner??new Cf};this._dropdown=new hx(e,e.actions,this._contextMenuService,h),this._register(this._dropdown.actionRunner.onDidRun(u=>{u.action instanceof io&&this.update(u.action)}))}update(e){this._options?.persistLastActionId&&this._storageService.store(this._storageKey,e.id,1,1),this._defaultAction.dispose(),this._defaultAction=this._instaService.createInstance(Fh,e,{keybinding:this._getDefaultActionKeybindingLabel(e)}),this._defaultAction.actionRunner=new class extends Cf{async runAction(t,i){await t.run(void 0)}},this._container&&this._defaultAction.render(G4(this._container,ie(".action-container")))}_getDefaultActionKeybindingLabel(e){let t;if(this._options?.renderKeybindingWithDefaultActionLabel){const i=this._keybindingService.lookupKeybinding(e.id);i&&(t=`(${i.getLabel()})`)}return t}setActionContext(e){super.setActionContext(e),this._defaultAction.setActionContext(e),this._dropdown.setActionContext(e)}render(e){this._container=e,super.render(this._container),this._container.classList.add("monaco-dropdown-with-default");const t=ie(".action-container");this._defaultAction.render(Y(this._container,t)),this._register(H(t,ee.KEY_DOWN,n=>{const s=new Pt(n);s.equals(17)&&(this._defaultAction.element.tabIndex=-1,this._dropdown.focus(),s.stopPropagation())}));const i=ie(".dropdown-action-container");this._dropdown.render(Y(this._container,i)),this._register(H(i,ee.KEY_DOWN,n=>{const s=new Pt(n);s.equals(15)&&(this._defaultAction.element.tabIndex=0,this._dropdown.setFocusable(!1),this._defaultAction.element?.focus(),s.stopPropagation())}))}focus(e){e?this._dropdown.focus():(this._defaultAction.element.tabIndex=0,this._defaultAction.element.focus())}blur(){this._defaultAction.element.tabIndex=-1,this._dropdown.blur(),this._container.blur()}setFocusable(e){e?this._defaultAction.element.tabIndex=0:(this._defaultAction.element.tabIndex=-1,this._dropdown.setFocusable(!1))}dispose(){this._defaultAction.dispose(),this._dropdown.dispose(),super.dispose()}};IA=GT([Es(2,vt),Es(3,Ei),Es(4,co),Es(5,zo),Es(6,Ce),Es(7,Yr)],IA);let NA=class extends jle{constructor(e,t){super(null,e,e.actions.map(i=>({text:i.id===Zi.ID?"─────────":i.label,isDisabled:!i.enabled})),0,t,oce,{ariaLabel:e.tooltip,optionsAsChildren:!0}),this.select(Math.max(0,e.actions.findIndex(i=>i.checked)))}render(e){super.render(e),e.style.borderColor=ce(m5)}runAction(e,t){const i=this.action.actions[t];i&&this.actionRunner.run(i)}};NA=GT([Es(1,sd)],NA);function a$(o,e,t){return e instanceof io?o.createInstance(Fh,e,t):e instanceof Pm?e.item.isSelection?o.createInstance(NA,e):e.item.rememberDefaultAction?o.createInstance(IA,e,{...t,persistLastActionId:!0}):o.createInstance(DA,e,t):void 0}class Oo extends F{constructor(e,t={}){super(),this._actionRunnerDisposables=this._register(new $),this.viewItemDisposables=this._register(new L4),this.triggerKeyDown=!1,this.focusable=!0,this._onDidBlur=this._register(new O),this.onDidBlur=this._onDidBlur.event,this._onDidCancel=this._register(new O({onWillAddFirstListener:()=>this.cancelHasListener=!0})),this.onDidCancel=this._onDidCancel.event,this.cancelHasListener=!1,this._onDidRun=this._register(new O),this.onDidRun=this._onDidRun.event,this._onWillRun=this._register(new O),this.onWillRun=this._onWillRun.event,this.options=t,this._context=t.context??null,this._orientation=this.options.orientation??0,this._triggerKeys={keyDown:this.options.triggerKeys?.keyDown??!1,keys:this.options.triggerKeys?.keys??[3,10]},this._hoverDelegate=t.hoverDelegate??this._register(D_()),this.options.actionRunner?this._actionRunner=this.options.actionRunner:(this._actionRunner=new Cf,this._actionRunnerDisposables.add(this._actionRunner)),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(s=>this._onDidRun.fire(s))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(s=>this._onWillRun.fire(s))),this.viewItems=[],this.focusedItem=void 0,this.domNode=document.createElement("div"),this.domNode.className="monaco-action-bar";let i,n;switch(this._orientation){case 0:i=[15],n=[17];break;case 1:i=[16],n=[18],this.domNode.className+=" vertical";break}this._register(H(this.domNode,ee.KEY_DOWN,s=>{const r=new Pt(s);let a=!0;const l=typeof this.focusedItem=="number"?this.viewItems[this.focusedItem]:void 0;i&&(r.equals(i[0])||r.equals(i[1]))?a=this.focusPrevious():n&&(r.equals(n[0])||r.equals(n[1]))?a=this.focusNext():r.equals(9)&&this.cancelHasListener?this._onDidCancel.fire():r.equals(14)?a=this.focusFirst():r.equals(13)?a=this.focusLast():r.equals(2)&&l instanceof ga&&l.trapsArrowNavigation?a=this.focusNext(void 0,!0):this.isTriggerKeyEvent(r)?this._triggerKeys.keyDown?this.doTrigger(r):this.triggerKeyDown=!0:a=!1,a&&(r.preventDefault(),r.stopPropagation())})),this._register(H(this.domNode,ee.KEY_UP,s=>{const r=new Pt(s);this.isTriggerKeyEvent(r)?(!this._triggerKeys.keyDown&&this.triggerKeyDown&&(this.triggerKeyDown=!1,this.doTrigger(r)),r.preventDefault(),r.stopPropagation()):(r.equals(2)||r.equals(1026)||r.equals(16)||r.equals(18)||r.equals(15)||r.equals(17))&&this.updateFocusedItem()})),this.focusTracker=this._register(Ia(this.domNode)),this._register(this.focusTracker.onDidBlur(()=>{(Ln()===this.domNode||!Ki(Ln(),this.domNode))&&(this._onDidBlur.fire(),this.previouslyFocusedItem=this.focusedItem,this.focusedItem=void 0,this.triggerKeyDown=!1)})),this._register(this.focusTracker.onDidFocus(()=>this.updateFocusedItem())),this.actionsList=document.createElement("ul"),this.actionsList.className="actions-container",this.options.highlightToggledItems&&this.actionsList.classList.add("highlight-toggled"),this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"),this.options.ariaLabel&&this.actionsList.setAttribute("aria-label",this.options.ariaLabel),this.domNode.appendChild(this.actionsList),e.appendChild(this.domNode)}refreshRole(){this.length()>=1?this.actionsList.setAttribute("role",this.options.ariaRole||"toolbar"):this.actionsList.setAttribute("role","presentation")}setFocusable(e){if(this.focusable=e,this.focusable){const t=this.viewItems.find(i=>i instanceof ga&&i.isEnabled());t instanceof ga&&t.setFocusable(!0)}else this.viewItems.forEach(t=>{t instanceof ga&&t.setFocusable(!1)})}isTriggerKeyEvent(e){let t=!1;return this._triggerKeys.keys.forEach(i=>{t=t||e.equals(i)}),t}updateFocusedItem(){for(let e=0;e<this.actionsList.children.length;e++){const t=this.actionsList.children[e];if(Ki(Ln(),t)){this.focusedItem=e,this.viewItems[this.focusedItem]?.showHover?.();break}}}get context(){return this._context}set context(e){this._context=e,this.viewItems.forEach(t=>t.setActionContext(e))}get actionRunner(){return this._actionRunner}set actionRunner(e){this._actionRunner=e,this._actionRunnerDisposables.clear(),this._actionRunnerDisposables.add(this._actionRunner.onDidRun(t=>this._onDidRun.fire(t))),this._actionRunnerDisposables.add(this._actionRunner.onWillRun(t=>this._onWillRun.fire(t))),this.viewItems.forEach(t=>t.actionRunner=e)}getContainer(){return this.domNode}getAction(e){if(typeof e=="number")return this.viewItems[e]?.action;if(qi(e)){for(;e.parentElement!==this.actionsList;){if(!e.parentElement)return;e=e.parentElement}for(let t=0;t<this.actionsList.childNodes.length;t++)if(this.actionsList.childNodes[t]===e)return this.viewItems[t].action}}push(e,t={}){const i=Array.isArray(e)?e:[e];let n=Lh(t.index)?t.index:null;i.forEach(s=>{const r=document.createElement("li");r.className="action-item",r.setAttribute("role","presentation");let a;const l={hoverDelegate:this._hoverDelegate,...t,isTabList:this.options.ariaRole==="tablist"};this.options.actionViewItemProvider&&(a=this.options.actionViewItemProvider(s,l)),a||(a=new I_(this.context,s,l)),this.options.allowContextMenu||this.viewItemDisposables.set(a,H(r,ee.CONTEXT_MENU,c=>{tt.stop(c,!0)})),a.actionRunner=this._actionRunner,a.setActionContext(this.context),a.render(r),this.focusable&&a instanceof ga&&this.viewItems.length===0&&a.setFocusable(!0),n===null||n<0||n>=this.actionsList.children.length?(this.actionsList.appendChild(r),this.viewItems.push(a)):(this.actionsList.insertBefore(r,this.actionsList.children[n]),this.viewItems.splice(n,0,a),n++)}),typeof this.focusedItem=="number"&&this.focus(this.focusedItem),this.refreshRole()}clear(){this.isEmpty()||(this.viewItems=Dt(this.viewItems),this.viewItemDisposables.clearAndDisposeAll(),fn(this.actionsList),this.refreshRole())}length(){return this.viewItems.length}isEmpty(){return this.viewItems.length===0}focus(e){let t=!1,i;if(e===void 0?t=!0:typeof e=="number"?i=e:typeof e=="boolean"&&(t=e),t&&typeof this.focusedItem>"u"){const n=this.viewItems.findIndex(s=>s.isEnabled());this.focusedItem=n===-1?void 0:n,this.updateFocus(void 0,void 0,!0)}else i!==void 0&&(this.focusedItem=i),this.updateFocus(void 0,void 0,!0)}focusFirst(){return this.focusedItem=this.length()-1,this.focusNext(!0)}focusLast(){return this.focusedItem=0,this.focusPrevious(!0)}focusNext(e,t){if(typeof this.focusedItem>"u")this.focusedItem=this.viewItems.length-1;else if(this.viewItems.length<=1)return!1;const i=this.focusedItem;let n;do{if(!e&&this.options.preventLoopNavigation&&this.focusedItem+1>=this.viewItems.length)return this.focusedItem=i,!1;this.focusedItem=(this.focusedItem+1)%this.viewItems.length,n=this.viewItems[this.focusedItem]}while(this.focusedItem!==i&&(this.options.focusOnlyEnabledItems&&!n.isEnabled()||n.action.id===Zi.ID));return this.updateFocus(void 0,void 0,t),!0}focusPrevious(e){if(typeof this.focusedItem>"u")this.focusedItem=0;else if(this.viewItems.length<=1)return!1;const t=this.focusedItem;let i;do{if(this.focusedItem=this.focusedItem-1,this.focusedItem<0){if(!e&&this.options.preventLoopNavigation)return this.focusedItem=t,!1;this.focusedItem=this.viewItems.length-1}i=this.viewItems[this.focusedItem]}while(this.focusedItem!==t&&(this.options.focusOnlyEnabledItems&&!i.isEnabled()||i.action.id===Zi.ID));return this.updateFocus(!0),!0}updateFocus(e,t,i=!1){typeof this.focusedItem>"u"&&this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem!==void 0&&this.previouslyFocusedItem!==this.focusedItem&&this.viewItems[this.previouslyFocusedItem]?.blur();const n=this.focusedItem!==void 0?this.viewItems[this.focusedItem]:void 0;if(n){let s=!0;VC(n.focus)||(s=!1),this.options.focusOnlyEnabledItems&&VC(n.isEnabled)&&!n.isEnabled()&&(s=!1),n.action.id===Zi.ID&&(s=!1),s?(i||this.previouslyFocusedItem!==this.focusedItem)&&(n.focus(e),this.previouslyFocusedItem=this.focusedItem):(this.actionsList.focus({preventScroll:t}),this.previouslyFocusedItem=void 0),s&&n.showHover?.()}}doTrigger(e){if(typeof this.focusedItem>"u")return;const t=this.viewItems[this.focusedItem];if(t instanceof ga){const i=t._context===null||t._context===void 0?e:t._context;this.run(t._action,i)}}async run(e,t){await this._actionRunner.run(e,t)}dispose(){this._context=void 0,this.viewItems=Dt(this.viewItems),this.getContainer().remove(),super.dispose()}}const RA=/\(&([^\s&])\)|(^|[^&])&([^\s&])/,PI=/(&amp;)?(&amp;)([^\s&])/g;var fx;(function(o){o[o.Right=0]="Right",o[o.Left=1]="Left"})(fx||(fx={}));var PA;(function(o){o[o.Above=0]="Above",o[o.Below=1]="Below"})(PA||(PA={}));class Wm extends Oo{constructor(e,t,i,n){e.classList.add("monaco-menu-container"),e.setAttribute("role","presentation");const s=document.createElement("div");s.classList.add("monaco-menu"),s.setAttribute("role","presentation"),super(s,{orientation:1,actionViewItemProvider:c=>this.doGetActionViewItem(c,i,r),context:i.context,actionRunner:i.actionRunner,ariaLabel:i.ariaLabel,ariaRole:"menu",focusOnlyEnabledItems:!0,triggerKeys:{keys:[3,...Qe||us?[10]:[]],keyDown:!0}}),this.menuStyles=n,this.menuElement=s,this.actionsList.tabIndex=0,this.initializeOrUpdateStyleSheet(e,n),this._register(Mn.addTarget(s)),this._register(H(s,ee.KEY_DOWN,c=>{new Pt(c).equals(2)&&c.preventDefault()})),i.enableMnemonics&&this._register(H(s,ee.KEY_DOWN,c=>{const d=c.key.toLocaleLowerCase();if(this.mnemonics.has(d)){tt.stop(c,!0);const h=this.mnemonics.get(d);if(h.length===1&&(h[0]instanceof UH&&h[0].container&&this.focusItemByElement(h[0].container),h[0].onClick(c)),h.length>1){const u=h.shift();u&&u.container&&(this.focusItemByElement(u.container),h.push(u)),this.mnemonics.set(d,h)}}})),us&&this._register(H(s,ee.KEY_DOWN,c=>{const d=new Pt(c);d.equals(14)||d.equals(11)?(this.focusedItem=this.viewItems.length-1,this.focusNext(),tt.stop(c,!0)):(d.equals(13)||d.equals(12))&&(this.focusedItem=0,this.focusPrevious(),tt.stop(c,!0))})),this._register(H(this.domNode,ee.MOUSE_OUT,c=>{const d=c.relatedTarget;Ki(d,this.domNode)||(this.focusedItem=void 0,this.updateFocus(),c.stopPropagation())})),this._register(H(this.actionsList,ee.MOUSE_OVER,c=>{let d=c.target;if(!(!d||!Ki(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}})),this._register(Mn.addTarget(this.actionsList)),this._register(H(this.actionsList,Ot.Tap,c=>{let d=c.initialTarget;if(!(!d||!Ki(d,this.actionsList)||d===this.actionsList)){for(;d.parentElement!==this.actionsList&&d.parentElement!==null;)d=d.parentElement;if(d.classList.contains("action-item")){const h=this.focusedItem;this.setFocusedItem(d),h!==this.focusedItem&&this.updateFocus()}}}));const r={parent:this};this.mnemonics=new Map,this.scrollableElement=this._register(new Iw(s,{alwaysConsumeMouseWheel:!0,horizontal:2,vertical:3,verticalScrollbarSize:7,handleMouseWheel:!0,useShadows:!0}));const a=this.scrollableElement.getDomNode();a.style.position="",this.styleScrollElement(a,n),this._register(H(s,Ot.Change,c=>{tt.stop(c,!0);const d=this.scrollableElement.getScrollPosition().scrollTop;this.scrollableElement.setScrollPosition({scrollTop:d-c.translationY})})),this._register(H(a,ee.MOUSE_UP,c=>{c.preventDefault()}));const l=xe(e);s.style.maxHeight=`${Math.max(10,l.innerHeight-e.getBoundingClientRect().top-35)}px`,t=t.filter((c,d)=>i.submenuIds?.has(c.id)?(console.warn(`Found submenu cycle: ${c.id}`),!1):!(c instanceof Zi&&(d===t.length-1||d===0||t[d-1]instanceof Zi))),this.push(t,{icon:!0,label:!0,isMenu:!0}),e.appendChild(this.scrollableElement.getDomNode()),this.scrollableElement.scanDomNode(),this.viewItems.filter(c=>!(c instanceof GH)).forEach((c,d,h)=>{c.updatePositionInSet(d+1,h.length)})}initializeOrUpdateStyleSheet(e,t){this.styleSheet||(P0(e)?this.styleSheet=Bo(e):(Wm.globalStyleSheet||(Wm.globalStyleSheet=Bo()),this.styleSheet=Wm.globalStyleSheet)),this.styleSheet.textContent=cce(t,P0(e))}styleScrollElement(e,t){const i=t.foregroundColor??"",n=t.backgroundColor??"",s=t.borderColor?`1px solid ${t.borderColor}`:"",r="5px",a=t.shadowColor?`0 2px 8px ${t.shadowColor}`:"";e.style.outline=s,e.style.borderRadius=r,e.style.color=i,e.style.backgroundColor=n,e.style.boxShadow=a}getContainer(){return this.scrollableElement.getDomNode()}get onScroll(){return this.scrollableElement.onScroll}focusItemByElement(e){const t=this.focusedItem;this.setFocusedItem(e),t!==this.focusedItem&&this.updateFocus()}setFocusedItem(e){for(let t=0;t<this.actionsList.children.length;t++){const i=this.actionsList.children[t];if(e===i){this.focusedItem=t;break}}}updateFocus(e){super.updateFocus(e,!0,!0),typeof this.focusedItem<"u"&&this.scrollableElement.setScrollPosition({scrollTop:Math.round(this.menuElement.scrollTop)})}doGetActionViewItem(e,t,i){if(e instanceof Zi)return new GH(t.context,e,{icon:!0},this.menuStyles);if(e instanceof m_){const n=new UH(e,e.actions,i,{...t,submenuIds:new Set([...t.submenuIds||[],e.id])},this.menuStyles);if(t.enableMnemonics){const s=n.getMnemonic();if(s&&n.isEnabled()){let r=[];this.mnemonics.has(s)&&(r=this.mnemonics.get(s)),r.push(n),this.mnemonics.set(s,r)}}return n}else{const n={enableMnemonics:t.enableMnemonics,useEventAsContext:t.useEventAsContext};if(t.getKeyBinding){const r=t.getKeyBinding(e);if(r){const a=r.getLabel();a&&(n.keybinding=a)}}const s=new l$(t.context,e,n,this.menuStyles);if(t.enableMnemonics){const r=s.getMnemonic();if(r&&s.isEnabled()){let a=[];this.mnemonics.has(r)&&(a=this.mnemonics.get(r)),a.push(s),this.mnemonics.set(r,a)}}return s}}}class l$ extends ga{constructor(e,t,i,n){if(i.isMenu=!0,super(t,t,i),this.menuStyle=n,this.options=i,this.options.icon=i.icon!==void 0?i.icon:!1,this.options.label=i.label!==void 0?i.label:!0,this.cssClass="",this.options.label&&i.enableMnemonics){const s=this.action.label;if(s){const r=RA.exec(s);r&&(this.mnemonic=(r[1]?r[1]:r[3]).toLocaleLowerCase())}}this.runOnceToEnableMouseUp=new xt(()=>{this.element&&(this._register(H(this.element,ee.MOUSE_UP,s=>{if(tt.stop(s,!0),dr){if(new Mr(xe(this.element),s).rightButton)return;this.onClick(s)}else setTimeout(()=>{this.onClick(s)},0)})),this._register(H(this.element,ee.CONTEXT_MENU,s=>{tt.stop(s,!0)})))},100),this._register(this.runOnceToEnableMouseUp)}render(e){super.render(e),this.element&&(this.container=e,this.item=Y(this.element,ie("a.action-menu-item")),this._action.id===Zi.ID?this.item.setAttribute("role","presentation"):(this.item.setAttribute("role","menuitem"),this.mnemonic&&this.item.setAttribute("aria-keyshortcuts",`${this.mnemonic}`)),this.check=Y(this.item,ie("span.menu-item-check"+ke.asCSSSelector(J.menuSelection))),this.check.setAttribute("role","none"),this.label=Y(this.item,ie("span.action-label")),this.options.label&&this.options.keybinding&&(Y(this.item,ie("span.keybinding")).textContent=this.options.keybinding),this.runOnceToEnableMouseUp.schedule(),this.updateClass(),this.updateLabel(),this.updateTooltip(),this.updateEnabled(),this.updateChecked(),this.applyStyle())}blur(){super.blur(),this.applyStyle()}focus(){super.focus(),this.item?.focus(),this.applyStyle()}updatePositionInSet(e,t){this.item&&(this.item.setAttribute("aria-posinset",`${e}`),this.item.setAttribute("aria-setsize",`${t}`))}updateLabel(){if(this.label&&this.options.label){fn(this.label);let e=E5(this.action.label);if(e){const t=lce(e);this.options.enableMnemonics||(e=t),this.label.setAttribute("aria-label",t.replace(/&&/g,"&"));const i=RA.exec(e);if(i){e=Av(e),PI.lastIndex=0;let n=PI.exec(e);for(;n&&n[1];)n=PI.exec(e);const s=r=>r.replace(/&amp;&amp;/g,"&amp;");n?this.label.append(yw(s(e.substr(0,n.index))," "),ie("u",{"aria-hidden":"true"},n[3]),xz(s(e.substr(n.index+n[0].length))," ")):this.label.innerText=s(e).trim(),this.item?.setAttribute("aria-keyshortcuts",(i[1]?i[1]:i[3]).toLocaleLowerCase())}else this.label.innerText=e.replace(/&&/g,"&").trim()}}}updateTooltip(){}updateClass(){this.cssClass&&this.item&&this.item.classList.remove(...this.cssClass.split(" ")),this.options.icon&&this.label?(this.cssClass=this.action.class||"",this.label.classList.add("icon"),this.cssClass&&this.label.classList.add(...this.cssClass.split(" ")),this.updateEnabled()):this.label&&this.label.classList.remove("icon")}updateEnabled(){this.action.enabled?(this.element&&(this.element.classList.remove("disabled"),this.element.removeAttribute("aria-disabled")),this.item&&(this.item.classList.remove("disabled"),this.item.removeAttribute("aria-disabled"),this.item.tabIndex=0)):(this.element&&(this.element.classList.add("disabled"),this.element.setAttribute("aria-disabled","true")),this.item&&(this.item.classList.add("disabled"),this.item.setAttribute("aria-disabled","true")))}updateChecked(){if(!this.item)return;const e=this.action.checked;this.item.classList.toggle("checked",!!e),e!==void 0?(this.item.setAttribute("role","menuitemcheckbox"),this.item.setAttribute("aria-checked",e?"true":"false")):(this.item.setAttribute("role","menuitem"),this.item.setAttribute("aria-checked",""))}getMnemonic(){return this.mnemonic}applyStyle(){const e=this.element&&this.element.classList.contains("focused"),t=e&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor,i=e&&this.menuStyle.selectionBackgroundColor?this.menuStyle.selectionBackgroundColor:void 0,n=e&&this.menuStyle.selectionBorderColor?`1px solid ${this.menuStyle.selectionBorderColor}`:"",s=e&&this.menuStyle.selectionBorderColor?"-1px":"";this.item&&(this.item.style.color=t??"",this.item.style.backgroundColor=i??"",this.item.style.outline=n,this.item.style.outlineOffset=s),this.check&&(this.check.style.color=t??"")}}class UH extends l${constructor(e,t,i,n,s){super(e,e,n,s),this.submenuActions=t,this.parentData=i,this.submenuOptions=n,this.mysubmenu=null,this.submenuDisposables=this._register(new $),this.mouseOver=!1,this.expandDirection=n&&n.expandDirection!==void 0?n.expandDirection:{horizontal:fx.Right,vertical:PA.Below},this.showScheduler=new xt(()=>{this.mouseOver&&(this.cleanupExistingSubmenu(!1),this.createSubmenu(!1))},250),this.hideScheduler=new xt(()=>{this.element&&!Ki(Ln(),this.element)&&this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))},750)}render(e){super.render(e),this.element&&(this.item&&(this.item.classList.add("monaco-submenu-item"),this.item.tabIndex=0,this.item.setAttribute("aria-haspopup","true"),this.updateAriaExpanded("false"),this.submenuIndicator=Y(this.item,ie("span.submenu-indicator"+ke.asCSSSelector(J.menuSubmenu))),this.submenuIndicator.setAttribute("aria-hidden","true")),this._register(H(this.element,ee.KEY_UP,t=>{const i=new Pt(t);(i.equals(17)||i.equals(3))&&(tt.stop(t,!0),this.createSubmenu(!0))})),this._register(H(this.element,ee.KEY_DOWN,t=>{const i=new Pt(t);Ln()===this.item&&(i.equals(17)||i.equals(3))&&tt.stop(t,!0)})),this._register(H(this.element,ee.MOUSE_OVER,t=>{this.mouseOver||(this.mouseOver=!0,this.showScheduler.schedule())})),this._register(H(this.element,ee.MOUSE_LEAVE,t=>{this.mouseOver=!1})),this._register(H(this.element,ee.FOCUS_OUT,t=>{this.element&&!Ki(Ln(),this.element)&&this.hideScheduler.schedule()})),this._register(this.parentData.parent.onScroll(()=>{this.parentData.submenu===this.mysubmenu&&(this.parentData.parent.focus(!1),this.cleanupExistingSubmenu(!0))})))}updateEnabled(){}onClick(e){tt.stop(e,!0),this.cleanupExistingSubmenu(!1),this.createSubmenu(!0)}cleanupExistingSubmenu(e){if(this.parentData.submenu&&(e||this.parentData.submenu!==this.mysubmenu)){try{this.parentData.submenu.dispose()}catch{}this.parentData.submenu=void 0,this.updateAriaExpanded("false"),this.submenuContainer&&(this.submenuDisposables.clear(),this.submenuContainer=void 0)}}calculateSubmenuMenuLayout(e,t,i,n){const s={top:0,left:0};return s.left=Zp(e.width,t.width,{position:n.horizontal===fx.Right?0:1,offset:i.left,size:i.width}),s.left>=i.left&&s.left<i.left+i.width&&(i.left+10+t.width<=e.width&&(s.left=i.left+10),i.top+=10,i.height=0),s.top=Zp(e.height,t.height,{position:0,offset:i.top,size:0}),s.top+t.height===i.top&&s.top+i.height+t.height<=e.height&&(s.top+=i.height),s}createSubmenu(e=!0){if(this.element)if(this.parentData.submenu)this.parentData.submenu.focus(!1);else{this.updateAriaExpanded("true"),this.submenuContainer=Y(this.element,ie("div.monaco-submenu")),this.submenuContainer.classList.add("menubar-menu-items-holder","context-view");const t=xe(this.parentData.parent.domNode).getComputedStyle(this.parentData.parent.domNode),i=parseFloat(t.paddingTop||"0")||0;this.submenuContainer.style.zIndex="1",this.submenuContainer.style.position="fixed",this.submenuContainer.style.top="0",this.submenuContainer.style.left="0",this.parentData.submenu=new Wm(this.submenuContainer,this.submenuActions.length?this.submenuActions:[new fP],this.submenuOptions,this.menuStyle);const n=this.element.getBoundingClientRect(),s={top:n.top-i,left:n.left,height:n.height+2*i,width:n.width},r=this.submenuContainer.getBoundingClientRect(),a=xe(this.element),{top:l,left:c}=this.calculateSubmenuMenuLayout(new wt(a.innerWidth,a.innerHeight),wt.lift(r),s,this.expandDirection);this.submenuContainer.style.left=`${c-r.left}px`,this.submenuContainer.style.top=`${l-r.top}px`,this.submenuDisposables.add(H(this.submenuContainer,ee.KEY_UP,d=>{new Pt(d).equals(15)&&(tt.stop(d,!0),this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0))})),this.submenuDisposables.add(H(this.submenuContainer,ee.KEY_DOWN,d=>{new Pt(d).equals(15)&&tt.stop(d,!0)})),this.submenuDisposables.add(this.parentData.submenu.onDidCancel(()=>{this.parentData.parent.focus(),this.cleanupExistingSubmenu(!0)})),this.parentData.submenu.focus(e),this.mysubmenu=this.parentData.submenu}}updateAriaExpanded(e){this.item&&this.item?.setAttribute("aria-expanded",e)}applyStyle(){super.applyStyle();const t=this.element&&this.element.classList.contains("focused")&&this.menuStyle.selectionForegroundColor?this.menuStyle.selectionForegroundColor:this.menuStyle.foregroundColor;this.submenuIndicator&&(this.submenuIndicator.style.color=t??"")}dispose(){super.dispose(),this.hideScheduler.dispose(),this.mysubmenu&&(this.mysubmenu.dispose(),this.mysubmenu=null),this.submenuContainer&&(this.submenuContainer=void 0)}}class GH extends I_{constructor(e,t,i,n){super(e,t,i),this.menuStyles=n}render(e){super.render(e),this.label&&(this.label.style.borderBottomColor=this.menuStyles.separatorColor?`${this.menuStyles.separatorColor}`:"")}}function lce(o){const e=RA,t=e.exec(o);if(!t)return o;const i=!t[1];return o.replace(e,i?"$2$3":"").trim()}function $H(o){const e=bz()[o.id];return`.codicon-${o.id}:before { content: '\\${e.toString(16)}'; }`}function cce(o,e){let t=`
.monaco-menu {
	font-size: 13px;
	border-radius: 5px;
	min-width: 160px;
}

${$H(J.menuSelection)}
${$H(J.menuSubmenu)}

.monaco-menu .monaco-action-bar {
	text-align: right;
	overflow: hidden;
	white-space: nowrap;
}

.monaco-menu .monaco-action-bar .actions-container {
	display: flex;
	margin: 0 auto;
	padding: 0;
	width: 100%;
	justify-content: flex-end;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: inline-block;
}

.monaco-menu .monaco-action-bar.reverse .actions-container {
	flex-direction: row-reverse;
}

.monaco-menu .monaco-action-bar .action-item {
	cursor: pointer;
	display: inline-block;
	transition: transform 50ms ease;
	position: relative;  /* DO NOT REMOVE - this is the key to preventing the ghosting icon bug in Chrome 42 */
}

.monaco-menu .monaco-action-bar .action-item.disabled {
	cursor: default;
}

.monaco-menu .monaco-action-bar .action-item .icon,
.monaco-menu .monaco-action-bar .action-item .codicon {
	display: inline-block;
}

.monaco-menu .monaco-action-bar .action-item .codicon {
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar .action-label {
	font-size: 11px;
	margin-right: 4px;
}

.monaco-menu .monaco-action-bar .action-item.disabled .action-label,
.monaco-menu .monaco-action-bar .action-item.disabled .action-label:hover {
	color: var(--vscode-disabledForeground);
}

/* Vertical actions */

.monaco-menu .monaco-action-bar.vertical {
	text-align: left;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	display: block;
	border-bottom: 1px solid var(--vscode-menu-separatorBackground);
	padding-top: 1px;
	padding: 30px;
}

.monaco-menu .secondary-actions .monaco-action-bar .action-label {
	margin-left: 6px;
}

/* Action Items */
.monaco-menu .monaco-action-bar .action-item.select-container {
	overflow: hidden; /* somehow the dropdown overflows its container, we prevent it here to not push */
	flex: 1;
	max-width: 170px;
	min-width: 60px;
	display: flex;
	align-items: center;
	justify-content: center;
	margin-right: 10px;
}

.monaco-menu .monaco-action-bar.vertical {
	margin-left: 0;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .actions-container {
	display: block;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	padding: 0;
	transform: none;
	display: flex;
}

.monaco-menu .monaco-action-bar.vertical .action-item.active {
	transform: none;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	flex: 1 1 auto;
	display: flex;
	height: 2em;
	align-items: center;
	position: relative;
	margin: 0 4px;
	border-radius: 4px;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item:hover .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-menu-item:focus .keybinding {
	opacity: unset;
}

.monaco-menu .monaco-action-bar.vertical .action-label {
	flex: 1 1 auto;
	text-decoration: none;
	padding: 0 1em;
	background: none;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .keybinding,
.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	display: inline-block;
	flex: 2 1 auto;
	padding: 0 1em;
	text-align: right;
	font-size: 12px;
	line-height: 1;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon {
	font-size: 16px !important;
	display: flex;
	align-items: center;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator.codicon::before {
	margin-left: auto;
	margin-right: -20px;
}

.monaco-menu .monaco-action-bar.vertical .action-item.disabled .keybinding,
.monaco-menu .monaco-action-bar.vertical .action-item.disabled .submenu-indicator {
	opacity: 0.4;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator) {
	display: inline-block;
	box-sizing: border-box;
	margin: 0;
}

.monaco-menu .monaco-action-bar.vertical .action-item {
	position: static;
	overflow: visible;
}

.monaco-menu .monaco-action-bar.vertical .action-item .monaco-submenu {
	position: absolute;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	width: 100%;
	height: 0px !important;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator.text {
	padding: 0.7em 1em 0.1em 1em;
	font-weight: bold;
	opacity: 1;
}

.monaco-menu .monaco-action-bar.vertical .action-label:hover {
	color: inherit;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	position: absolute;
	visibility: hidden;
	width: 1em;
	height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item.checked .menu-item-check {
	visibility: visible;
	display: flex;
	align-items: center;
	justify-content: center;
}

/* Context Menu */

.context-view.monaco-menu-container {
	outline: 0;
	border: none;
	animation: fadeIn 0.083s linear;
	-webkit-app-region: no-drag;
}

.context-view.monaco-menu-container :focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical:focus,
.context-view.monaco-menu-container .monaco-action-bar.vertical :focus {
	outline: 0;
}

.hc-black .context-view.monaco-menu-container,
.hc-light .context-view.monaco-menu-container,
:host-context(.hc-black) .context-view.monaco-menu-container,
:host-context(.hc-light) .context-view.monaco-menu-container {
	box-shadow: none;
}

.hc-black .monaco-menu .monaco-action-bar.vertical .action-item.focused,
.hc-light .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-black) .monaco-menu .monaco-action-bar.vertical .action-item.focused,
:host-context(.hc-light) .monaco-menu .monaco-action-bar.vertical .action-item.focused {
	background: none;
}

/* Vertical Action Bar Styles */

.monaco-menu .monaco-action-bar.vertical {
	padding: 4px 0;
}

.monaco-menu .monaco-action-bar.vertical .action-menu-item {
	height: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label:not(.separator),
.monaco-menu .monaco-action-bar.vertical .keybinding {
	font-size: inherit;
	padding: 0 2em;
	max-height: 100%;
}

.monaco-menu .monaco-action-bar.vertical .menu-item-check {
	font-size: inherit;
	width: 2em;
}

.monaco-menu .monaco-action-bar.vertical .action-label.separator {
	font-size: inherit;
	margin: 5px 0 !important;
	padding: 0;
	border-radius: 0;
}

.linux .monaco-menu .monaco-action-bar.vertical .action-label.separator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .action-label.separator {
	margin-left: 0;
	margin-right: 0;
}

.monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	font-size: 60%;
	padding: 0 1.8em;
}

.linux .monaco-menu .monaco-action-bar.vertical .submenu-indicator,
:host-context(.linux) .monaco-menu .monaco-action-bar.vertical .submenu-indicator {
	height: 100%;
	mask-size: 10px 10px;
	-webkit-mask-size: 10px 10px;
}

.monaco-menu .action-item {
	cursor: default;
}`;if(e){t+=`
			/* Arrows */
			.monaco-scrollable-element > .scrollbar > .scra {
				cursor: pointer;
				font-size: 11px !important;
			}

			.monaco-scrollable-element > .visible {
				opacity: 1;

				/* Background rule added for IE9 - to allow clicks on dom node */
				background:rgba(0,0,0,0);

				transition: opacity 100ms linear;
			}
			.monaco-scrollable-element > .invisible {
				opacity: 0;
				pointer-events: none;
			}
			.monaco-scrollable-element > .invisible.fade {
				transition: opacity 800ms linear;
			}

			/* Scrollable Content Inset Shadow */
			.monaco-scrollable-element > .shadow {
				position: absolute;
				display: none;
			}
			.monaco-scrollable-element > .shadow.top {
				display: block;
				top: 0;
				left: 3px;
				height: 3px;
				width: 100%;
			}
			.monaco-scrollable-element > .shadow.left {
				display: block;
				top: 3px;
				left: 0;
				height: 100%;
				width: 3px;
			}
			.monaco-scrollable-element > .shadow.top-left-corner {
				display: block;
				top: 0;
				left: 0;
				height: 3px;
				width: 3px;
			}
		`;const i=o.scrollbarShadow;i&&(t+=`
				.monaco-scrollable-element > .shadow.top {
					box-shadow: ${i} 0 6px 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.left {
					box-shadow: ${i} 6px 0 6px -6px inset;
				}

				.monaco-scrollable-element > .shadow.top.left {
					box-shadow: ${i} 6px 6px 6px -6px inset;
				}
			`);const n=o.scrollbarSliderBackground;n&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider {
					background: ${n};
				}
			`);const s=o.scrollbarSliderHoverBackground;s&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider:hover {
					background: ${s};
				}
			`);const r=o.scrollbarSliderActiveBackground;r&&(t+=`
				.monaco-scrollable-element > .scrollbar > .slider.active {
					background: ${r};
				}
			`)}return t}class dce{constructor(e,t,i,n){this.contextViewService=e,this.telemetryService=t,this.notificationService=i,this.keybindingService=n,this.focusToReturn=null,this.lastContainer=null,this.block=null,this.blockDisposable=null,this.options={blockMouse:!0}}configure(e){this.options=e}showContextMenu(e){const t=e.getActions();if(!t.length)return;this.focusToReturn=Ln();let i;const n=qi(e.domForShadowRoot)?e.domForShadowRoot:void 0;this.contextViewService.showContextView({getAnchor:()=>e.getAnchor(),canRelayout:!1,anchorAlignment:e.anchorAlignment,anchorAxisAlignment:e.anchorAxisAlignment,render:s=>{this.lastContainer=s;const r=e.getMenuClassName?e.getMenuClassName():"";r&&(s.className+=" "+r),this.options.blockMouse&&(this.block=s.appendChild(ie(".context-view-block")),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",this.blockDisposable?.dispose(),this.blockDisposable=H(this.block,ee.MOUSE_DOWN,d=>d.stopPropagation()));const a=new $,l=e.actionRunner||new Cf;l.onWillRun(d=>this.onActionRun(d,!e.skipTelemetry),this,a),l.onDidRun(this.onDidActionRun,this,a),i=new Wm(s,t,{actionViewItemProvider:e.getActionViewItem,context:e.getActionsContext?e.getActionsContext():null,actionRunner:l,getKeyBinding:e.getKeyBinding?e.getKeyBinding:d=>this.keybindingService.lookupKeybinding(d.id)},rce),i.onDidCancel(()=>this.contextViewService.hideContextView(!0),null,a),i.onDidBlur(()=>this.contextViewService.hideContextView(!0),null,a);const c=xe(s);return a.add(H(c,ee.BLUR,()=>this.contextViewService.hideContextView(!0))),a.add(H(c,ee.MOUSE_DOWN,d=>{if(d.defaultPrevented)return;const h=new Mr(c,d);let u=h.target;if(!h.rightButton){for(;u;){if(u===s)return;u=u.parentElement}this.contextViewService.hideContextView(!0)}})),Wr(a,i)},focus:()=>{i?.focus(!!e.autoSelectFirstItem)},onHide:s=>{e.onHide?.(!!s),this.block&&(this.block.remove(),this.block=null),this.blockDisposable?.dispose(),this.blockDisposable=null,this.lastContainer&&(Ln()===this.lastContainer||Ki(Ln(),this.lastContainer))&&this.focusToReturn?.focus(),this.lastContainer=null}},n,!!n)}onActionRun(e,t){t&&this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.action.id,from:"contextMenu"}),this.contextViewService.hideContextView(!1)}onDidActionRun(e){e.error&&!_r(e.error)&&this.notificationService.error(e.error)}}var hce=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},bp=function(o,e){return function(t,i){e(t,i,o)}};let AA=class extends F{get contextMenuHandler(){return this._contextMenuHandler||(this._contextMenuHandler=new dce(this.contextViewService,this.telemetryService,this.notificationService,this.keybindingService)),this._contextMenuHandler}constructor(e,t,i,n,s,r){super(),this.telemetryService=e,this.notificationService=t,this.contextViewService=i,this.keybindingService=n,this.menuService=s,this.contextKeyService=r,this._contextMenuHandler=void 0,this._onDidShowContextMenu=this._store.add(new O),this.onDidShowContextMenu=this._onDidShowContextMenu.event,this._onDidHideContextMenu=this._store.add(new O)}configure(e){this.contextMenuHandler.configure(e)}showContextMenu(e){e=MA.transform(e,this.menuService,this.contextKeyService),this.contextMenuHandler.showContextMenu({...e,onHide:t=>{e.onHide?.(t),this._onDidHideContextMenu.fire()}}),Lc.getInstance().resetKeyStatus(),this._onDidShowContextMenu.fire()}};AA=hce([bp(0,Fn),bp(1,Ei),bp(2,sd),bp(3,vt),bp(4,zo),bp(5,Ee)],AA);var MA;(function(o){function e(i){return i&&i.menuId instanceof fe}function t(i,n,s){if(!e(i))return i;const{menuId:r,menuActionOptions:a,contextKeyService:l}=i;return{...i,getActions:()=>{const c=[];if(r){const d=n.getMenuActions(r,l??s,a);ace(d,c)}return i.getActions?Zi.join(i.getActions(),c):c}}}o.transform=t})(MA||(MA={}));var px;(function(o){o[o.API=0]="API",o[o.USER=1]="USER"})(px||(px={}));var B5=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},mx=function(o,e){return function(t,i){e(t,i,o)}};let OA=class{constructor(e){this._commandService=e}async open(e,t){if(!iT(e,Oe.command))return!1;if(!t?.allowCommands||(typeof e=="string"&&(e=ye.parse(e)),Array.isArray(t.allowCommands)&&!t.allowCommands.includes(e.path)))return!0;let i=[];try{i=iA(decodeURIComponent(e.query))}catch{try{i=iA(e.query)}catch{}}return Array.isArray(i)||(i=[i]),await this._commandService.executeCommand(e.path,...i),!0}};OA=B5([mx(0,Ft)],OA);let FA=class{constructor(e){this._editorService=e}async open(e,t){typeof e=="string"&&(e=ye.parse(e));const{selection:i,uri:n}=Boe(e);return e=n,e.scheme===Oe.file&&(e=Cre(e)),await this._editorService.openCodeEditor({resource:e,options:{selection:i,source:t?.fromUserGesture?px.USER:px.API,...t?.editorOptions}},this._editorService.getFocusedCodeEditor(),t?.openToSide),!0}};FA=B5([mx(0,gt)],FA);let BA=class{constructor(e,t){this._openers=new os,this._validators=new os,this._resolvers=new os,this._resolvedUriTargets=new on(i=>i.with({path:null,fragment:null,query:null}).toString()),this._externalOpeners=new os,this._defaultExternalOpener={openExternal:async i=>(aP(i,Oe.http,Oe.https)?iU(i):It.location.href=i,!0)},this._openers.push({open:async(i,n)=>n?.openExternal||aP(i,Oe.mailto,Oe.http,Oe.https,Oe.vsls)?(await this._doOpenExternal(i,n),!0):!1}),this._openers.push(new OA(t)),this._openers.push(new FA(e))}registerOpener(e){return{dispose:this._openers.unshift(e)}}async open(e,t){const i=typeof e=="string"?ye.parse(e):e,n=this._resolvedUriTargets.get(i)??e;for(const s of this._validators)if(!await s.shouldOpen(n,t))return!1;for(const s of this._openers)if(await s.open(e,t))return!0;return!1}async resolveExternalUri(e,t){for(const i of this._resolvers)try{const n=await i.resolveExternalUri(e,t);if(n)return this._resolvedUriTargets.has(n.resolved)||this._resolvedUriTargets.set(n.resolved,e),n}catch{}throw new Error("Could not resolve external URI: "+e.toString())}async _doOpenExternal(e,t){const i=typeof e=="string"?ye.parse(e):e;let n;try{n=(await this.resolveExternalUri(i,t)).resolved}catch{n=i}let s;if(typeof e=="string"&&i.toString()===n.toString()?s=e:s=encodeURI(n.toString(!0)),t?.allowContributedOpeners){const r=typeof t?.allowContributedOpeners=="string"?t?.allowContributedOpeners:void 0;for(const a of this._externalOpeners)if(await a.openExternal(s,{sourceUri:i,preferredOpenerId:r},He.None))return!0}return this._defaultExternalOpener.openExternal(s,{sourceUri:i},He.None)}dispose(){this._validators.clear()}};BA=B5([mx(0,gt),mx(1,Ft)],BA);const Bs=Je("editorWorkerService");var pi;(function(o){o[o.Hint=1]="Hint",o[o.Info=2]="Info",o[o.Warning=4]="Warning",o[o.Error=8]="Error"})(pi||(pi={}));(function(o){function e(r,a){return a-r}o.compare=e;const t=Object.create(null);t[o.Error]=p("sev.error","Error"),t[o.Warning]=p("sev.warning","Warning"),t[o.Info]=p("sev.info","Info");function i(r){return t[r]||""}o.toString=i;function n(r){switch(r){case ki.Error:return o.Error;case ki.Warning:return o.Warning;case ki.Info:return o.Info;case ki.Ignore:return o.Hint}}o.fromSeverity=n;function s(r){switch(r){case o.Error:return ki.Error;case o.Warning:return ki.Warning;case o.Info:return ki.Info;case o.Hint:return ki.Ignore}}o.toSeverity=s})(pi||(pi={}));var _x;(function(o){const e="";function t(n){return i(n,!0)}o.makeKey=t;function i(n,s){const r=[e];return n.source?r.push(n.source.replace("¦","\\¦")):r.push(e),n.code?typeof n.code=="string"?r.push(n.code.replace("¦","\\¦")):r.push(n.code.value.replace("¦","\\¦")):r.push(e),n.severity!==void 0&&n.severity!==null?r.push(pi.toString(n.severity)):r.push(e),n.message&&s?r.push(n.message.replace("¦","\\¦")):r.push(e),n.startLineNumber!==void 0&&n.startLineNumber!==null?r.push(n.startLineNumber.toString()):r.push(e),n.startColumn!==void 0&&n.startColumn!==null?r.push(n.startColumn.toString()):r.push(e),n.endLineNumber!==void 0&&n.endLineNumber!==null?r.push(n.endLineNumber.toString()):r.push(e),n.endColumn!==void 0&&n.endColumn!==null?r.push(n.endColumn.toString()):r.push(e),r.push(e),r.join("¦")}o.makeKeyOptionalMessage=i})(_x||(_x={}));const Ul=Je("markerService"),c$=D("editor.lineHighlightBackground",null,p("lineHighlight","Background color for the highlight of line at the cursor position.")),KH=D("editor.lineHighlightBorder",{dark:"#282828",light:"#eeeeee",hcDark:"#f38518",hcLight:rt},p("lineHighlightBorderBox","Background color for the border around the line at the cursor position."));D("editor.rangeHighlightBackground",{dark:"#ffffff0b",light:"#fdff0033",hcDark:null,hcLight:null},p("rangeHighlight","Background color of highlighted ranges, like by quick open and find features. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.rangeHighlightBorder",{dark:null,light:null,hcDark:qt,hcLight:qt},p("rangeHighlightBorder","Background color of the border around highlighted ranges."));D("editor.symbolHighlightBackground",{dark:Ec,light:Ec,hcDark:null,hcLight:null},p("symbolHighlight","Background color of highlighted symbol, like for go to definition or go next/previous symbol. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.symbolHighlightBorder",{dark:null,light:null,hcDark:qt,hcLight:qt},p("symbolHighlightBorder","Background color of the border around highlighted symbols."));const KT=D("editorCursor.foreground",{dark:"#AEAFAD",light:j.black,hcDark:j.white,hcLight:"#0F4A85"},p("caret","Color of the editor cursor.")),W5=D("editorCursor.background",null,p("editorCursorBackground","The background color of the editor cursor. Allows customizing the color of a character overlapped by a block cursor.")),d$=D("editorMultiCursor.primary.foreground",KT,p("editorMultiCursorPrimaryForeground","Color of the primary editor cursor when multiple cursors are present.")),uce=D("editorMultiCursor.primary.background",W5,p("editorMultiCursorPrimaryBackground","The background color of the primary editor cursor when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),h$=D("editorMultiCursor.secondary.foreground",KT,p("editorMultiCursorSecondaryForeground","Color of secondary editor cursors when multiple cursors are present.")),gce=D("editorMultiCursor.secondary.background",W5,p("editorMultiCursorSecondaryBackground","The background color of secondary editor cursors when multiple cursors are present. Allows customizing the color of a character overlapped by a block cursor.")),V5=D("editorWhitespace.foreground",{dark:"#e3e4e229",light:"#33333333",hcDark:"#e3e4e229",hcLight:"#CCCCCC"},p("editorWhitespaces","Color of whitespace characters in the editor.")),fce=D("editorLineNumber.foreground",{dark:"#858585",light:"#237893",hcDark:j.white,hcLight:"#292929"},p("editorLineNumbers","Color of editor line numbers.")),pce=D("editorIndentGuide.background",V5,p("editorIndentGuides","Color of the editor indentation guides."),!1,p("deprecatedEditorIndentGuides","'editorIndentGuide.background' is deprecated. Use 'editorIndentGuide.background1' instead.")),mce=D("editorIndentGuide.activeBackground",V5,p("editorActiveIndentGuide","Color of the active editor indentation guides."),!1,p("deprecatedEditorActiveIndentGuide","'editorIndentGuide.activeBackground' is deprecated. Use 'editorIndentGuide.activeBackground1' instead.")),Hw=D("editorIndentGuide.background1",pce,p("editorIndentGuides1","Color of the editor indentation guides (1).")),_ce=D("editorIndentGuide.background2","#00000000",p("editorIndentGuides2","Color of the editor indentation guides (2).")),bce=D("editorIndentGuide.background3","#00000000",p("editorIndentGuides3","Color of the editor indentation guides (3).")),vce=D("editorIndentGuide.background4","#00000000",p("editorIndentGuides4","Color of the editor indentation guides (4).")),Cce=D("editorIndentGuide.background5","#00000000",p("editorIndentGuides5","Color of the editor indentation guides (5).")),yce=D("editorIndentGuide.background6","#00000000",p("editorIndentGuides6","Color of the editor indentation guides (6).")),zw=D("editorIndentGuide.activeBackground1",mce,p("editorActiveIndentGuide1","Color of the active editor indentation guides (1).")),wce=D("editorIndentGuide.activeBackground2","#00000000",p("editorActiveIndentGuide2","Color of the active editor indentation guides (2).")),Sce=D("editorIndentGuide.activeBackground3","#00000000",p("editorActiveIndentGuide3","Color of the active editor indentation guides (3).")),xce=D("editorIndentGuide.activeBackground4","#00000000",p("editorActiveIndentGuide4","Color of the active editor indentation guides (4).")),Lce=D("editorIndentGuide.activeBackground5","#00000000",p("editorActiveIndentGuide5","Color of the active editor indentation guides (5).")),kce=D("editorIndentGuide.activeBackground6","#00000000",p("editorActiveIndentGuide6","Color of the active editor indentation guides (6).")),Ece=D("editorActiveLineNumber.foreground",{dark:"#c6c6c6",light:"#0B216F",hcDark:qt,hcLight:qt},p("editorActiveLineNumber","Color of editor active line number"),!1,p("deprecatedEditorActiveLineNumber","Id is deprecated. Use 'editorLineNumber.activeForeground' instead."));D("editorLineNumber.activeForeground",Ece,p("editorActiveLineNumber","Color of editor active line number"));const Tce=D("editorLineNumber.dimmedForeground",null,p("editorDimmedLineNumber","Color of the final editor line when editor.renderFinalNewline is set to dimmed."));D("editorRuler.foreground",{dark:"#5A5A5A",light:j.lightgrey,hcDark:j.white,hcLight:"#292929"},p("editorRuler","Color of the editor rulers."));D("editorCodeLens.foreground",{dark:"#999999",light:"#919191",hcDark:"#999999",hcLight:"#292929"},p("editorCodeLensForeground","Foreground color of editor CodeLens"));D("editorBracketMatch.background",{dark:"#0064001a",light:"#0064001a",hcDark:"#0064001a",hcLight:"#0000"},p("editorBracketMatchBackground","Background color behind matching brackets"));D("editorBracketMatch.border",{dark:"#888",light:"#B9B9B9",hcDark:rt,hcLight:rt},p("editorBracketMatchBorder","Color for matching brackets boxes"));const Dce=D("editorOverviewRuler.border",{dark:"#7f7f7f4d",light:"#7f7f7f4d",hcDark:"#7f7f7f4d",hcLight:"#666666"},p("editorOverviewRulerBorder","Color of the overview ruler border.")),Ice=D("editorOverviewRuler.background",null,p("editorOverviewRulerBackground","Background color of the editor overview ruler."));D("editorGutter.background",$r,p("editorGutter","Background color of the editor gutter. The gutter contains the glyph margins and the line numbers."));D("editorUnnecessaryCode.border",{dark:null,light:null,hcDark:j.fromHex("#fff").transparent(.8),hcLight:rt},p("unnecessaryCodeBorder","Border color of unnecessary (unused) source code in the editor."));const Nce=D("editorUnnecessaryCode.opacity",{dark:j.fromHex("#000a"),light:j.fromHex("#0007"),hcDark:null,hcLight:null},p("unnecessaryCodeOpacity",`Opacity of unnecessary (unused) source code in the editor. For example, "#000000c0" will render the code with 75% opacity. For high contrast themes, use the  'editorUnnecessaryCode.border' theme color to underline unnecessary code instead of fading it out.`));D("editorGhostText.border",{dark:null,light:null,hcDark:j.fromHex("#fff").transparent(.8),hcLight:j.fromHex("#292929").transparent(.8)},p("editorGhostTextBorder","Border color of ghost text in the editor."));const Rce=D("editorGhostText.foreground",{dark:j.fromHex("#ffffff56"),light:j.fromHex("#0007"),hcDark:null,hcLight:null},p("editorGhostTextForeground","Foreground color of the ghost text in the editor."));D("editorGhostText.background",null,p("editorGhostTextBackground","Background color of the ghost text in the editor."));const Pce=new j(new lt(0,122,204,.6)),u$=D("editorOverviewRuler.rangeHighlightForeground",Pce,p("overviewRulerRangeHighlight","Overview ruler marker color for range highlights. The color must not be opaque so as not to hide underlying decorations."),!0),Ace=D("editorOverviewRuler.errorForeground",{dark:new j(new lt(255,18,18,.7)),light:new j(new lt(255,18,18,.7)),hcDark:new j(new lt(255,50,50,1)),hcLight:"#B5200D"},p("overviewRuleError","Overview ruler marker color for errors.")),Mce=D("editorOverviewRuler.warningForeground",{dark:qc,light:qc,hcDark:oy,hcLight:oy},p("overviewRuleWarning","Overview ruler marker color for warnings.")),Oce=D("editorOverviewRuler.infoForeground",{dark:Nl,light:Nl,hcDark:ry,hcLight:ry},p("overviewRuleInfo","Overview ruler marker color for infos.")),g$=D("editorBracketHighlight.foreground1",{dark:"#FFD700",light:"#0431FAFF",hcDark:"#FFD700",hcLight:"#0431FAFF"},p("editorBracketHighlightForeground1","Foreground color of brackets (1). Requires enabling bracket pair colorization.")),f$=D("editorBracketHighlight.foreground2",{dark:"#DA70D6",light:"#319331FF",hcDark:"#DA70D6",hcLight:"#319331FF"},p("editorBracketHighlightForeground2","Foreground color of brackets (2). Requires enabling bracket pair colorization.")),p$=D("editorBracketHighlight.foreground3",{dark:"#179FFF",light:"#7B3814FF",hcDark:"#87CEFA",hcLight:"#7B3814FF"},p("editorBracketHighlightForeground3","Foreground color of brackets (3). Requires enabling bracket pair colorization.")),m$=D("editorBracketHighlight.foreground4","#00000000",p("editorBracketHighlightForeground4","Foreground color of brackets (4). Requires enabling bracket pair colorization.")),_$=D("editorBracketHighlight.foreground5","#00000000",p("editorBracketHighlightForeground5","Foreground color of brackets (5). Requires enabling bracket pair colorization.")),b$=D("editorBracketHighlight.foreground6","#00000000",p("editorBracketHighlightForeground6","Foreground color of brackets (6). Requires enabling bracket pair colorization.")),Fce=D("editorBracketHighlight.unexpectedBracket.foreground",{dark:new j(new lt(255,18,18,.8)),light:new j(new lt(255,18,18,.8)),hcDark:"new Color(new RGBA(255, 50, 50, 1))",hcLight:"#B5200D"},p("editorBracketHighlightUnexpectedBracketForeground","Foreground color of unexpected brackets.")),Bce=D("editorBracketPairGuide.background1","#00000000",p("editorBracketPairGuide.background1","Background color of inactive bracket pair guides (1). Requires enabling bracket pair guides.")),Wce=D("editorBracketPairGuide.background2","#00000000",p("editorBracketPairGuide.background2","Background color of inactive bracket pair guides (2). Requires enabling bracket pair guides.")),Vce=D("editorBracketPairGuide.background3","#00000000",p("editorBracketPairGuide.background3","Background color of inactive bracket pair guides (3). Requires enabling bracket pair guides.")),Hce=D("editorBracketPairGuide.background4","#00000000",p("editorBracketPairGuide.background4","Background color of inactive bracket pair guides (4). Requires enabling bracket pair guides.")),zce=D("editorBracketPairGuide.background5","#00000000",p("editorBracketPairGuide.background5","Background color of inactive bracket pair guides (5). Requires enabling bracket pair guides.")),Uce=D("editorBracketPairGuide.background6","#00000000",p("editorBracketPairGuide.background6","Background color of inactive bracket pair guides (6). Requires enabling bracket pair guides.")),Gce=D("editorBracketPairGuide.activeBackground1","#00000000",p("editorBracketPairGuide.activeBackground1","Background color of active bracket pair guides (1). Requires enabling bracket pair guides.")),$ce=D("editorBracketPairGuide.activeBackground2","#00000000",p("editorBracketPairGuide.activeBackground2","Background color of active bracket pair guides (2). Requires enabling bracket pair guides.")),Kce=D("editorBracketPairGuide.activeBackground3","#00000000",p("editorBracketPairGuide.activeBackground3","Background color of active bracket pair guides (3). Requires enabling bracket pair guides.")),jce=D("editorBracketPairGuide.activeBackground4","#00000000",p("editorBracketPairGuide.activeBackground4","Background color of active bracket pair guides (4). Requires enabling bracket pair guides.")),qce=D("editorBracketPairGuide.activeBackground5","#00000000",p("editorBracketPairGuide.activeBackground5","Background color of active bracket pair guides (5). Requires enabling bracket pair guides.")),Zce=D("editorBracketPairGuide.activeBackground6","#00000000",p("editorBracketPairGuide.activeBackground6","Background color of active bracket pair guides (6). Requires enabling bracket pair guides."));D("editorUnicodeHighlight.border",qc,p("editorUnicodeHighlight.border","Border color used to highlight unicode characters."));D("editorUnicodeHighlight.background",jne,p("editorUnicodeHighlight.background","Background color used to highlight unicode characters."));br((o,e)=>{const t=o.getColor($r),i=o.getColor(c$),n=i&&!i.isTransparent()?i:t;n&&e.addRule(`.monaco-editor .inputarea.ime-input { background-color: ${n}; }`)});function Yce(o,e){const t=[],i=[];for(const n of o)e.has(n)||t.push(n);for(const n of e)o.has(n)||i.push(n);return{removed:t,added:i}}function Xce(o,e){const t=new Set;for(const i of e)o.has(i)&&t.add(i);return t}var Qce=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},jH=function(o,e){return function(t,i){e(t,i,o)}};let WA=class extends F{constructor(e,t){super(),this._markerService=t,this._onDidChangeMarker=this._register(new O),this._markerDecorations=new on,e.getModels().forEach(i=>this._onModelAdded(i)),this._register(e.onModelAdded(this._onModelAdded,this)),this._register(e.onModelRemoved(this._onModelRemoved,this)),this._register(this._markerService.onMarkerChanged(this._handleMarkerChange,this))}dispose(){super.dispose(),this._markerDecorations.forEach(e=>e.dispose()),this._markerDecorations.clear()}getMarker(e,t){const i=this._markerDecorations.get(e);return i&&i.getMarker(t)||null}_handleMarkerChange(e){e.forEach(t=>{const i=this._markerDecorations.get(t);i&&this._updateDecorations(i)})}_onModelAdded(e){const t=new Jce(e);this._markerDecorations.set(e.uri,t),this._updateDecorations(t)}_onModelRemoved(e){const t=this._markerDecorations.get(e.uri);t&&(t.dispose(),this._markerDecorations.delete(e.uri)),(e.uri.scheme===Oe.inMemory||e.uri.scheme===Oe.internal||e.uri.scheme===Oe.vscode)&&this._markerService?.read({resource:e.uri}).map(i=>i.owner).forEach(i=>this._markerService.remove(i,[e.uri]))}_updateDecorations(e){const t=this._markerService.read({resource:e.model.uri,take:500});e.update(t)&&this._onDidChangeMarker.fire(e.model)}};WA=Qce([jH(0,Ut),jH(1,Ul)],WA);class Jce extends F{constructor(e){super(),this.model=e,this._map=new eie,this._register(ve(()=>{this.model.deltaDecorations([...this._map.values()],[]),this._map.clear()}))}update(e){const{added:t,removed:i}=Yce(new Set(this._map.keys()),new Set(e));if(t.length===0&&i.length===0)return!1;const n=i.map(a=>this._map.get(a)),s=t.map(a=>({range:this._createDecorationRange(this.model,a),options:this._createDecorationOption(a)})),r=this.model.deltaDecorations(n,s);for(const a of i)this._map.delete(a);for(let a=0;a<r.length;a++)this._map.set(t[a],r[a]);return!0}getMarker(e){return this._map.getKey(e.id)}_createDecorationRange(e,t){let i=L.lift(t);if(t.severity===pi.Hint&&!this._hasMarkerTag(t,1)&&!this._hasMarkerTag(t,2)&&(i=i.setEndPosition(i.startLineNumber,i.startColumn+2)),i=e.validateRange(i),i.isEmpty()){const n=e.getLineLastNonWhitespaceColumn(i.startLineNumber)||e.getLineMaxColumn(i.startLineNumber);if(n===1||i.endColumn>=n)return i;const s=e.getWordAtPosition(i.getStartPosition());s&&(i=new L(i.startLineNumber,s.startColumn,i.endLineNumber,s.endColumn))}else if(t.endColumn===Number.MAX_VALUE&&t.startColumn===1&&i.startLineNumber===i.endLineNumber){const n=e.getLineFirstNonWhitespaceColumn(t.startLineNumber);n<i.endColumn&&(i=new L(i.startLineNumber,n,i.endLineNumber,i.endColumn),t.startColumn=n)}return i}_createDecorationOption(e){let t,i,n,s,r;switch(e.severity){case pi.Hint:this._hasMarkerTag(e,2)?t=void 0:this._hasMarkerTag(e,1)?t="squiggly-unnecessary":t="squiggly-hint",n=0;break;case pi.Info:t="squiggly-info",i=fi(Oce),n=10,r={color:fi(pse),position:1};break;case pi.Warning:t="squiggly-warning",i=fi(Mce),n=20,r={color:fi(mse),position:1};break;case pi.Error:default:t="squiggly-error",i=fi(Ace),n=30,r={color:fi(_se),position:1};break}return e.tags&&(e.tags.indexOf(1)!==-1&&(s="squiggly-inline-unnecessary"),e.tags.indexOf(2)!==-1&&(s="squiggly-inline-deprecated")),{description:"marker-decoration",stickiness:1,className:t,showIfCollapsed:!0,overviewRuler:{color:i,position:Ao.Right},minimap:r,zIndex:n,inlineClassName:s}}_hasMarkerTag(e,t){return e.tags?e.tags.indexOf(t)>=0:!1}}const H5=Je("markerDecorationsService");class Vi{static _nextVisibleColumn(e,t,i){return e===9?Vi.nextRenderTabStop(t,i):Ih(e)||M4(e)?t+2:t+1}static visibleColumnFromColumn(e,t,i){const n=Math.min(t-1,e.length),s=e.substring(0,n),r=new D0(s);let a=0;for(;!r.eol();){const l=T0(s,n,r.offset);r.nextGraphemeLength(),a=this._nextVisibleColumn(l,a,i)}return a}static columnFromVisibleColumn(e,t,i){if(t<=0)return 1;const n=e.length,s=new D0(e);let r=0,a=1;for(;!s.eol();){const l=T0(e,n,s.offset);s.nextGraphemeLength();const c=this._nextVisibleColumn(l,r,i),d=s.offset+1;if(c>=t){const h=t-r;return c-t<h?d:a}r=c,a=d}return n+1}static nextRenderTabStop(e,t){return e+t-e%t}static nextIndentTabStop(e,t){return e+t-e%t}static prevRenderTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}static prevIndentTabStop(e,t){return Math.max(0,e-1-(e-1)%t)}}function ede(o,e,t){let i=0;for(let s=0;s<o.length;s++)o.charAt(s)==="	"?i=Vi.nextIndentTabStop(i,e):i++;let n="";if(!t){const s=Math.floor(i/e);i=i%e;for(let r=0;r<s;r++)n+="	"}for(let s=0;s<i;s++)n+=" ";return n}function z5(o,e,t){let i=Xn(o);return i===-1&&(i=o.length),ede(o.substring(0,i),e,t)+o.substring(i)}class qH{constructor(e,t,i,n){this.range=e,this.nestingLevel=t,this.nestingLevelOfEqualBracketType=i,this.isInvalid=n}}class tde{constructor(e,t,i,n,s,r){this.range=e,this.openingBracketRange=t,this.closingBracketRange=i,this.nestingLevel=n,this.nestingLevelOfEqualBracketType=s,this.bracketPairNode=r}get openingBracketInfo(){return this.bracketPairNode.openingBracket.bracketInfo}}class ide extends tde{constructor(e,t,i,n,s,r,a){super(e,t,i,n,s,r),this.minVisibleColumnIndentation=a}}function nde(o,e,t,i){return o!==t?Ni(t-o,i):Ni(0,i-e)}const rs=0;function bx(o){return o===0}const Po=2**26;function Ni(o,e){return o*Po+e}function lr(o){const e=o,t=Math.floor(e/Po),i=e-t*Po;return new Gr(t,i)}function sde(o){return Math.floor(o/Po)}function mi(o,e){let t=o+e;return e>=Po&&(t=t-o%Po),t}function ode(o,e){return o.reduce((t,i)=>mi(t,e(i)),rs)}function v$(o,e){return o===e}function Cy(o,e){const t=o,i=e;if(i-t<=0)return rs;const s=Math.floor(t/Po),r=Math.floor(i/Po),a=i-r*Po;if(s===r){const l=t-s*Po;return Ni(0,a-l)}else return Ni(r-s,a)}function Vm(o,e){return o<e}function Hm(o,e){return o<=e}function _v(o,e){return o>=e}function Jp(o){return Ni(o.lineNumber-1,o.column-1)}function cg(o,e){const t=o,i=Math.floor(t/Po),n=t-i*Po,s=e,r=Math.floor(s/Po),a=s-r*Po;return new L(i+1,n+1,r+1,a+1)}function rde(o){const e=Bl(o);return Ni(e.length-1,e[e.length-1].length)}class Tc{static fromModelContentChanges(e){return e.map(i=>{const n=L.lift(i.range);return new Tc(Jp(n.getStartPosition()),Jp(n.getEndPosition()),rde(i.text))}).reverse()}constructor(e,t,i){this.startOffset=e,this.endOffset=t,this.newLength=i}toString(){return`[${lr(this.startOffset)}...${lr(this.endOffset)}) -> ${lr(this.newLength)}`}}class ade{constructor(e){this.nextEditIdx=0,this.deltaOldToNewLineCount=0,this.deltaOldToNewColumnCount=0,this.deltaLineIdxInOld=-1,this.edits=e.map(t=>U5.from(t))}getOffsetBeforeChange(e){return this.adjustNextEdit(e),this.translateCurToOld(e)}getDistanceToNextChange(e){this.adjustNextEdit(e);const t=this.edits[this.nextEditIdx],i=t?this.translateOldToCur(t.offsetObj):null;return i===null?null:Cy(e,i)}translateOldToCur(e){return e.lineCount===this.deltaLineIdxInOld?Ni(e.lineCount+this.deltaOldToNewLineCount,e.columnCount+this.deltaOldToNewColumnCount):Ni(e.lineCount+this.deltaOldToNewLineCount,e.columnCount)}translateCurToOld(e){const t=lr(e);return t.lineCount-this.deltaOldToNewLineCount===this.deltaLineIdxInOld?Ni(t.lineCount-this.deltaOldToNewLineCount,t.columnCount-this.deltaOldToNewColumnCount):Ni(t.lineCount-this.deltaOldToNewLineCount,t.columnCount)}adjustNextEdit(e){for(;this.nextEditIdx<this.edits.length;){const t=this.edits[this.nextEditIdx],i=this.translateOldToCur(t.endOffsetAfterObj);if(Hm(i,e)){this.nextEditIdx++;const n=lr(i),s=lr(this.translateOldToCur(t.endOffsetBeforeObj)),r=n.lineCount-s.lineCount;this.deltaOldToNewLineCount+=r;const a=this.deltaLineIdxInOld===t.endOffsetBeforeObj.lineCount?this.deltaOldToNewColumnCount:0,l=n.columnCount-s.columnCount;this.deltaOldToNewColumnCount=a+l,this.deltaLineIdxInOld=t.endOffsetBeforeObj.lineCount}else break}}}class U5{static from(e){return new U5(e.startOffset,e.endOffset,e.newLength)}constructor(e,t,i){this.endOffsetBeforeObj=lr(t),this.endOffsetAfterObj=lr(mi(e,i)),this.offsetObj=lr(e)}}const FS=[],Yo=class Yo{static create(e,t){if(e<=128&&t.length===0){let i=Yo.cache[e];return i||(i=new Yo(e,t),Yo.cache[e]=i),i}return new Yo(e,t)}static getEmpty(){return this.empty}constructor(e,t){this.items=e,this.additionalItems=t}add(e,t){const i=t.getKey(e);let n=i>>5;if(n===0){const r=1<<i|this.items;return r===this.items?this:Yo.create(r,this.additionalItems)}n--;const s=this.additionalItems.slice(0);for(;s.length<n;)s.push(0);return s[n]|=1<<(i&31),Yo.create(this.items,s)}merge(e){const t=this.items|e.items;if(this.additionalItems===FS&&e.additionalItems===FS)return t===this.items?this:t===e.items?e:Yo.create(t,FS);const i=[];for(let n=0;n<Math.max(this.additionalItems.length,e.additionalItems.length);n++){const s=this.additionalItems[n]||0,r=e.additionalItems[n]||0;i.push(s|r)}return Yo.create(t,i)}intersects(e){if((this.items&e.items)!==0)return!0;for(let t=0;t<Math.min(this.additionalItems.length,e.additionalItems.length);t++)if((this.additionalItems[t]&e.additionalItems[t])!==0)return!0;return!1}};Yo.cache=new Array(129),Yo.empty=Yo.create(0,FS);let Xs=Yo;const ZH={getKey(o){return o}};class C${constructor(){this.items=new Map}getKey(e){let t=this.items.get(e);return t===void 0&&(t=this.items.size,this.items.set(e,t)),t}}class G5{get length(){return this._length}constructor(e){this._length=e}}class yy extends G5{static create(e,t,i){let n=e.length;return t&&(n=mi(n,t.length)),i&&(n=mi(n,i.length)),new yy(n,e,t,i,t?t.missingOpeningBracketIds:Xs.getEmpty())}get kind(){return 2}get listHeight(){return 0}get childrenLength(){return 3}getChild(e){switch(e){case 0:return this.openingBracket;case 1:return this.child;case 2:return this.closingBracket}throw new Error("Invalid child index")}get children(){const e=[];return e.push(this.openingBracket),this.child&&e.push(this.child),this.closingBracket&&e.push(this.closingBracket),e}constructor(e,t,i,n,s){super(e),this.openingBracket=t,this.child=i,this.closingBracket=n,this.missingOpeningBracketIds=s}canBeReused(e){return!(this.closingBracket===null||e.intersects(this.missingOpeningBracketIds))}deepClone(){return new yy(this.length,this.openingBracket.deepClone(),this.child&&this.child.deepClone(),this.closingBracket&&this.closingBracket.deepClone(),this.missingOpeningBracketIds)}computeMinIndentation(e,t){return this.child?this.child.computeMinIndentation(mi(e,this.openingBracket.length),t):Number.MAX_SAFE_INTEGER}}class Pl extends G5{static create23(e,t,i,n=!1){let s=e.length,r=e.missingOpeningBracketIds;if(e.listHeight!==t.listHeight)throw new Error("Invalid list heights");if(s=mi(s,t.length),r=r.merge(t.missingOpeningBracketIds),i){if(e.listHeight!==i.listHeight)throw new Error("Invalid list heights");s=mi(s,i.length),r=r.merge(i.missingOpeningBracketIds)}return n?new lde(s,e.listHeight+1,e,t,i,r):new wy(s,e.listHeight+1,e,t,i,r)}static getEmpty(){return new cde(rs,0,[],Xs.getEmpty())}get kind(){return 4}get missingOpeningBracketIds(){return this._missingOpeningBracketIds}constructor(e,t,i){super(e),this.listHeight=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}throwIfImmutable(){}makeLastElementMutable(){this.throwIfImmutable();const e=this.childrenLength;if(e===0)return;const t=this.getChild(e-1),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(e-1,i),i}makeFirstElementMutable(){if(this.throwIfImmutable(),this.childrenLength===0)return;const t=this.getChild(0),i=t.kind===4?t.toMutable():t;return t!==i&&this.setChild(0,i),i}canBeReused(e){if(e.intersects(this.missingOpeningBracketIds)||this.childrenLength===0)return!1;let t=this;for(;t.kind===4;){const i=t.childrenLength;if(i===0)throw new pt;t=t.getChild(i-1)}return t.canBeReused(e)}handleChildrenChanged(){this.throwIfImmutable();const e=this.childrenLength;let t=this.getChild(0).length,i=this.getChild(0).missingOpeningBracketIds;for(let n=1;n<e;n++){const s=this.getChild(n);t=mi(t,s.length),i=i.merge(s.missingOpeningBracketIds)}this._length=t,this._missingOpeningBracketIds=i,this.cachedMinIndentation=-1}computeMinIndentation(e,t){if(this.cachedMinIndentation!==-1)return this.cachedMinIndentation;let i=Number.MAX_SAFE_INTEGER,n=e;for(let s=0;s<this.childrenLength;s++){const r=this.getChild(s);r&&(i=Math.min(i,r.computeMinIndentation(n,t)),n=mi(n,r.length))}return this.cachedMinIndentation=i,i}}class wy extends Pl{get childrenLength(){return this._item3!==null?3:2}getChild(e){switch(e){case 0:return this._item1;case 1:return this._item2;case 2:return this._item3}throw new Error("Invalid child index")}setChild(e,t){switch(e){case 0:this._item1=t;return;case 1:this._item2=t;return;case 2:this._item3=t;return}throw new Error("Invalid child index")}get children(){return this._item3?[this._item1,this._item2,this._item3]:[this._item1,this._item2]}get item1(){return this._item1}get item2(){return this._item2}get item3(){return this._item3}constructor(e,t,i,n,s,r){super(e,t,r),this._item1=i,this._item2=n,this._item3=s}deepClone(){return new wy(this.length,this.listHeight,this._item1.deepClone(),this._item2.deepClone(),this._item3?this._item3.deepClone():null,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){if(this._item3)throw new Error("Cannot append to a full (2,3) tree node");this.throwIfImmutable(),this._item3=e,this.handleChildrenChanged()}unappendChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item3;return this._item3=null,this.handleChildrenChanged(),e}prependChildOfSameHeight(e){if(this._item3)throw new Error("Cannot prepend to a full (2,3) tree node");this.throwIfImmutable(),this._item3=this._item2,this._item2=this._item1,this._item1=e,this.handleChildrenChanged()}unprependChild(){if(!this._item3)throw new Error("Cannot remove from a non-full (2,3) tree node");this.throwIfImmutable();const e=this._item1;return this._item1=this._item2,this._item2=this._item3,this._item3=null,this.handleChildrenChanged(),e}toMutable(){return this}}class lde extends wy{toMutable(){return new wy(this.length,this.listHeight,this.item1,this.item2,this.item3,this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}class vx extends Pl{get childrenLength(){return this._children.length}getChild(e){return this._children[e]}setChild(e,t){this._children[e]=t}get children(){return this._children}constructor(e,t,i,n){super(e,t,n),this._children=i}deepClone(){const e=new Array(this._children.length);for(let t=0;t<this._children.length;t++)e[t]=this._children[t].deepClone();return new vx(this.length,this.listHeight,e,this.missingOpeningBracketIds)}appendChildOfSameHeight(e){this.throwIfImmutable(),this._children.push(e),this.handleChildrenChanged()}unappendChild(){this.throwIfImmutable();const e=this._children.pop();return this.handleChildrenChanged(),e}prependChildOfSameHeight(e){this.throwIfImmutable(),this._children.unshift(e),this.handleChildrenChanged()}unprependChild(){this.throwIfImmutable();const e=this._children.shift();return this.handleChildrenChanged(),e}toMutable(){return this}}class cde extends vx{toMutable(){return new vx(this.length,this.listHeight,[...this.children],this.missingOpeningBracketIds)}throwIfImmutable(){throw new Error("this instance is immutable")}}const dde=[];class $5 extends G5{get listHeight(){return 0}get childrenLength(){return 0}getChild(e){return null}get children(){return dde}deepClone(){return this}}class Fu extends $5{get kind(){return 0}get missingOpeningBracketIds(){return Xs.getEmpty()}canBeReused(e){return!0}computeMinIndentation(e,t){const i=lr(e),n=(i.columnCount===0?i.lineCount:i.lineCount+1)+1,s=sde(mi(e,this.length))+1;let r=Number.MAX_SAFE_INTEGER;for(let a=n;a<=s;a++){const l=t.getLineFirstNonWhitespaceColumn(a),c=t.getLineContent(a);if(l===0)continue;const d=Vi.visibleColumnFromColumn(c,l,t.getOptions().tabSize);r=Math.min(r,d)}return r}}class Cx extends $5{static create(e,t,i){return new Cx(e,t,i)}get kind(){return 1}get missingOpeningBracketIds(){return Xs.getEmpty()}constructor(e,t,i){super(e),this.bracketInfo=t,this.bracketIds=i}get text(){return this.bracketInfo.bracketText}get languageId(){return this.bracketInfo.languageId}canBeReused(e){return!1}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}class hde extends $5{get kind(){return 3}constructor(e,t){super(t),this.missingOpeningBracketIds=e}canBeReused(e){return!e.intersects(this.missingOpeningBracketIds)}computeMinIndentation(e,t){return Number.MAX_SAFE_INTEGER}}let Pd=class{constructor(e,t,i,n,s){this.length=e,this.kind=t,this.bracketId=i,this.bracketIds=n,this.astNode=s}};class y${constructor(e,t){this.textModel=e,this.bracketTokens=t,this.reader=new ude(this.textModel,this.bracketTokens),this._offset=rs,this.didPeek=!1,this.peeked=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}get offset(){return this._offset}get length(){return Ni(this.textBufferLineCount-1,this.textBufferLastLineLength)}skip(e){this.didPeek=!1,this._offset=mi(this._offset,e);const t=lr(this._offset);this.reader.setPosition(t.lineCount,t.columnCount)}read(){let e;return this.peeked?(this.didPeek=!1,e=this.peeked):e=this.reader.read(),e&&(this._offset=mi(this._offset,e.length)),e}peek(){return this.didPeek||(this.peeked=this.reader.read(),this.didPeek=!0),this.peeked}}class ude{constructor(e,t){this.textModel=e,this.bracketTokens=t,this.lineIdx=0,this.line=null,this.lineCharOffset=0,this.lineTokens=null,this.lineTokenOffset=0,this.peekedToken=null,this.textBufferLineCount=e.getLineCount(),this.textBufferLastLineLength=e.getLineLength(this.textBufferLineCount)}setPosition(e,t){e===this.lineIdx?(this.lineCharOffset=t,this.line!==null&&(this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset))):(this.lineIdx=e,this.lineCharOffset=t,this.line=null),this.peekedToken=null}read(){if(this.peekedToken){const s=this.peekedToken;return this.peekedToken=null,this.lineCharOffset+=s.length,s}if(this.lineIdx>this.textBufferLineCount-1||this.lineIdx===this.textBufferLineCount-1&&this.lineCharOffset>=this.textBufferLastLineLength)return null;this.line===null&&(this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.line=this.lineTokens.getLineContent(),this.lineTokenOffset=this.lineCharOffset===0?0:this.lineTokens.findTokenIndexAtOffset(this.lineCharOffset));const e=this.lineIdx,t=this.lineCharOffset;let i=0;for(;;){const s=this.lineTokens,r=s.getCount();let a=null;if(this.lineTokenOffset<r){const l=s.getMetadata(this.lineTokenOffset);for(;this.lineTokenOffset+1<r&&l===s.getMetadata(this.lineTokenOffset+1);)this.lineTokenOffset++;const c=ks.getTokenType(l)===0,d=ks.containsBalancedBrackets(l),h=s.getEndOffset(this.lineTokenOffset);if(d&&c&&this.lineCharOffset<h){const u=s.getLanguageId(this.lineTokenOffset),g=this.line.substring(this.lineCharOffset,h),f=this.bracketTokens.getSingleLanguageBracketTokens(u),m=f.regExpGlobal;if(m){m.lastIndex=0;const _=m.exec(g);_&&(a=f.getToken(_[0]),a&&(this.lineCharOffset+=_.index))}}if(i+=h-this.lineCharOffset,a)if(e!==this.lineIdx||t!==this.lineCharOffset){this.peekedToken=a;break}else return this.lineCharOffset+=a.length,a;else this.lineTokenOffset++,this.lineCharOffset=h}else if(this.lineIdx===this.textBufferLineCount-1||(this.lineIdx++,this.lineTokens=this.textModel.tokenization.getLineTokens(this.lineIdx+1),this.lineTokenOffset=0,this.line=this.lineTokens.getLineContent(),this.lineCharOffset=0,i+=33,i>1e3))break;if(i>1500)break}const n=nde(e,t,this.lineIdx,this.lineCharOffset);return new Pd(n,0,-1,Xs.getEmpty(),new Fu(n))}}class gde{constructor(e,t){this.text=e,this._offset=rs,this.idx=0;const i=t.getRegExpStr(),n=i?new RegExp(i+`|
`,"gi"):null,s=[];let r,a=0,l=0,c=0,d=0;const h=[];for(let f=0;f<60;f++)h.push(new Pd(Ni(0,f),0,-1,Xs.getEmpty(),new Fu(Ni(0,f))));const u=[];for(let f=0;f<60;f++)u.push(new Pd(Ni(1,f),0,-1,Xs.getEmpty(),new Fu(Ni(1,f))));if(n)for(n.lastIndex=0;(r=n.exec(e))!==null;){const f=r.index,m=r[0];if(m===`
`)a++,l=f+1;else{if(c!==f){let _;if(d===a){const b=f-c;if(b<h.length)_=h[b];else{const v=Ni(0,b);_=new Pd(v,0,-1,Xs.getEmpty(),new Fu(v))}}else{const b=a-d,v=f-l;if(b===1&&v<u.length)_=u[v];else{const y=Ni(b,v);_=new Pd(y,0,-1,Xs.getEmpty(),new Fu(y))}}s.push(_)}s.push(t.getToken(m)),c=f+m.length,d=a}}const g=e.length;if(c!==g){const f=d===a?Ni(0,g-c):Ni(a-d,g-l);s.push(new Pd(f,0,-1,Xs.getEmpty(),new Fu(f)))}this.length=Ni(a,g-l),this.tokens=s}get offset(){return this._offset}read(){return this.tokens[this.idx++]||null}peek(){return this.tokens[this.idx]||null}skip(e){throw new KX}}class K5{static createFromLanguage(e,t){function i(s){return t.getKey(`${s.languageId}:::${s.bracketText}`)}const n=new Map;for(const s of e.bracketsNew.openingBrackets){const r=Ni(0,s.bracketText.length),a=i(s),l=Xs.getEmpty().add(a,ZH);n.set(s.bracketText,new Pd(r,1,a,l,Cx.create(r,s,l)))}for(const s of e.bracketsNew.closingBrackets){const r=Ni(0,s.bracketText.length);let a=Xs.getEmpty();const l=s.getOpeningBrackets();for(const c of l)a=a.add(i(c),ZH);n.set(s.bracketText,new Pd(r,2,i(l[0]),a,Cx.create(r,s,a)))}return new K5(n)}constructor(e){this.map=e,this.hasRegExp=!1,this._regExpGlobal=null}getRegExpStr(){if(this.isEmpty)return null;{const e=[...this.map.keys()];return e.sort(),e.reverse(),e.map(t=>fde(t)).join("|")}}get regExpGlobal(){if(!this.hasRegExp){const e=this.getRegExpStr();this._regExpGlobal=e?new RegExp(e,"gi"):null,this.hasRegExp=!0}return this._regExpGlobal}getToken(e){return this.map.get(e.toLowerCase())}findClosingTokenText(e){for(const[t,i]of this.map)if(i.kind===2&&i.bracketIds.intersects(e))return t}get isEmpty(){return this.map.size===0}}function fde(o){let e=Fo(o);return/^[\w ]+/.test(o)&&(e=`\\b${e}`),/[\w ]+$/.test(o)&&(e=`${e}\\b`),e}class w${constructor(e,t){this.denseKeyProvider=e,this.getLanguageConfiguration=t,this.languageIdToBracketTokens=new Map}didLanguageChange(e){return this.languageIdToBracketTokens.has(e)}getSingleLanguageBracketTokens(e){let t=this.languageIdToBracketTokens.get(e);return t||(t=K5.createFromLanguage(this.getLanguageConfiguration(e),this.denseKeyProvider),this.languageIdToBracketTokens.set(e,t)),t}}function pde(o){if(o.length===0)return null;if(o.length===1)return o[0];let e=0;function t(){if(e>=o.length)return null;const r=e,a=o[r].listHeight;for(e++;e<o.length&&o[e].listHeight===a;)e++;return e-r>=2?S$(r===0&&e===o.length?o:o.slice(r,e),!1):o[r]}let i=t(),n=t();if(!n)return i;for(let r=t();r;r=t())YH(i,n)<=YH(n,r)?(i=AI(i,n),n=r):n=AI(n,r);return AI(i,n)}function S$(o,e=!1){if(o.length===0)return null;if(o.length===1)return o[0];let t=o.length;for(;t>3;){const i=t>>1;for(let n=0;n<i;n++){const s=n<<1;o[n]=Pl.create23(o[s],o[s+1],s+3===t?o[s+2]:null,e)}t=i}return Pl.create23(o[0],o[1],t>=3?o[2]:null,e)}function YH(o,e){return Math.abs(o.listHeight-e.listHeight)}function AI(o,e){return o.listHeight===e.listHeight?Pl.create23(o,e,null,!1):o.listHeight>e.listHeight?mde(o,e):_de(e,o)}function mde(o,e){o=o.toMutable();let t=o;const i=[];let n;for(;;){if(e.listHeight===t.listHeight){n=e;break}if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeLastElementMutable()}for(let s=i.length-1;s>=0;s--){const r=i[s];n?r.childrenLength>=3?n=Pl.create23(r.unappendChild(),n,null,!1):(r.appendChildOfSameHeight(n),n=void 0):r.handleChildrenChanged()}return n?Pl.create23(o,n,null,!1):o}function _de(o,e){o=o.toMutable();let t=o;const i=[];for(;e.listHeight!==t.listHeight;){if(t.kind!==4)throw new Error("unexpected");i.push(t),t=t.makeFirstElementMutable()}let n=e;for(let s=i.length-1;s>=0;s--){const r=i[s];n?r.childrenLength>=3?n=Pl.create23(n,r.unprependChild(),null,!1):(r.prependChildOfSameHeight(n),n=void 0):r.handleChildrenChanged()}return n?Pl.create23(n,o,null,!1):o}class bde{constructor(e){this.lastOffset=rs,this.nextNodes=[e],this.offsets=[rs],this.idxs=[]}readLongestNodeAt(e,t){if(Vm(e,this.lastOffset))throw new Error("Invalid offset");for(this.lastOffset=e;;){const i=jb(this.nextNodes);if(!i)return;const n=jb(this.offsets);if(Vm(e,n))return;if(Vm(n,e))if(mi(n,i.length)<=e)this.nextNodeAfterCurrent();else{const s=MI(i);s!==-1?(this.nextNodes.push(i.getChild(s)),this.offsets.push(n),this.idxs.push(s)):this.nextNodeAfterCurrent()}else{if(t(i))return this.nextNodeAfterCurrent(),i;{const s=MI(i);if(s===-1){this.nextNodeAfterCurrent();return}else this.nextNodes.push(i.getChild(s)),this.offsets.push(n),this.idxs.push(s)}}}}nextNodeAfterCurrent(){for(;;){const e=jb(this.offsets),t=jb(this.nextNodes);if(this.nextNodes.pop(),this.offsets.pop(),this.idxs.length===0)break;const i=jb(this.nextNodes),n=MI(i,this.idxs[this.idxs.length-1]);if(n!==-1){this.nextNodes.push(i.getChild(n)),this.offsets.push(mi(e,t.length)),this.idxs[this.idxs.length-1]=n;break}else this.idxs.pop()}}}function MI(o,e=-1){for(;;){if(e++,e>=o.childrenLength)return-1;if(o.getChild(e))return e}}function jb(o){return o.length>0?o[o.length-1]:void 0}function VA(o,e,t,i){return new vde(o,e,t,i).parseDocument()}class vde{constructor(e,t,i,n){if(this.tokenizer=e,this.createImmutableLists=n,this._itemsConstructed=0,this._itemsFromCache=0,i&&n)throw new Error("Not supported");this.oldNodeReader=i?new bde(i):void 0,this.positionMapper=new ade(t)}parseDocument(){this._itemsConstructed=0,this._itemsFromCache=0;let e=this.parseList(Xs.getEmpty(),0);return e||(e=Pl.getEmpty()),e}parseList(e,t){const i=[];for(;;){let s=this.tryReadChildFromCache(e);if(!s){const r=this.tokenizer.peek();if(!r||r.kind===2&&r.bracketIds.intersects(e))break;s=this.parseChild(e,t+1)}s.kind===4&&s.childrenLength===0||i.push(s)}return this.oldNodeReader?pde(i):S$(i,this.createImmutableLists)}tryReadChildFromCache(e){if(this.oldNodeReader){const t=this.positionMapper.getDistanceToNextChange(this.tokenizer.offset);if(t===null||!bx(t)){const i=this.oldNodeReader.readLongestNodeAt(this.positionMapper.getOffsetBeforeChange(this.tokenizer.offset),n=>t!==null&&!Vm(n.length,t)?!1:n.canBeReused(e));if(i)return this._itemsFromCache++,this.tokenizer.skip(i.length),i}}}parseChild(e,t){this._itemsConstructed++;const i=this.tokenizer.read();switch(i.kind){case 2:return new hde(i.bracketIds,i.length);case 0:return i.astNode;case 1:{if(t>300)return new Fu(i.length);const n=e.merge(i.bracketIds),s=this.parseList(n,t+1),r=this.tokenizer.peek();return r&&r.kind===2&&(r.bracketId===i.bracketId||r.bracketIds.intersects(i.bracketIds))?(this.tokenizer.read(),yy.create(i.astNode,s,r.astNode)):yy.create(i.astNode,s,null)}default:throw new Error("unexpected")}}}function yx(o,e){if(o.length===0)return e;if(e.length===0)return o;const t=new Gc(XH(o)),i=XH(e);i.push({modified:!1,lengthBefore:void 0,lengthAfter:void 0});let n=t.dequeue();function s(c){if(c===void 0){const h=t.takeWhile(u=>!0)||[];return n&&h.unshift(n),h}const d=[];for(;n&&!bx(c);){const[h,u]=n.splitAt(c);d.push(h),c=Cy(h.lengthAfter,c),n=u??t.dequeue()}return bx(c)||d.push(new jd(!1,c,c)),d}const r=[];function a(c,d,h){if(r.length>0&&v$(r[r.length-1].endOffset,c)){const u=r[r.length-1];r[r.length-1]=new Tc(u.startOffset,d,mi(u.newLength,h))}else r.push({startOffset:c,endOffset:d,newLength:h})}let l=rs;for(const c of i){const d=s(c.lengthBefore);if(c.modified){const h=ode(d,g=>g.lengthBefore),u=mi(l,h);a(l,u,c.lengthAfter),l=u}else for(const h of d){const u=l;l=mi(l,h.lengthBefore),h.modified&&a(u,l,h.lengthAfter)}}return r}class jd{constructor(e,t,i){this.modified=e,this.lengthBefore=t,this.lengthAfter=i}splitAt(e){const t=Cy(e,this.lengthAfter);return v$(t,rs)?[this,void 0]:this.modified?[new jd(this.modified,this.lengthBefore,e),new jd(this.modified,rs,t)]:[new jd(this.modified,e,e),new jd(this.modified,t,t)]}toString(){return`${this.modified?"M":"U"}:${lr(this.lengthBefore)} -> ${lr(this.lengthAfter)}`}}function XH(o){const e=[];let t=rs;for(const i of o){const n=Cy(t,i.startOffset);bx(n)||e.push(new jd(!1,n,n));const s=Cy(i.startOffset,i.endOffset);e.push(new jd(!0,s,i.newLength)),t=i.endOffset}return e}class Cde extends F{didLanguageChange(e){return this.brackets.didLanguageChange(e)}constructor(e,t){if(super(),this.textModel=e,this.getLanguageConfiguration=t,this.didChangeEmitter=new O,this.denseKeyProvider=new C$,this.brackets=new w$(this.denseKeyProvider,this.getLanguageConfiguration),this.onDidChange=this.didChangeEmitter.event,this.queuedTextEditsForInitialAstWithoutTokens=[],this.queuedTextEdits=[],e.tokenization.hasTokens)e.tokenization.backgroundTokenizationState===2?(this.initialAstWithoutTokens=void 0,this.astWithTokens=this.parseDocumentFromTextBuffer([],void 0,!1)):(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer([],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens);else{const i=this.brackets.getSingleLanguageBracketTokens(this.textModel.getLanguageId()),n=new gde(this.textModel.getValue(),i);this.initialAstWithoutTokens=VA(n,[],void 0,!0),this.astWithTokens=this.initialAstWithoutTokens}}handleDidChangeBackgroundTokenizationState(){if(this.textModel.tokenization.backgroundTokenizationState===2){const e=this.initialAstWithoutTokens===void 0;this.initialAstWithoutTokens=void 0,e||this.didChangeEmitter.fire()}}handleDidChangeTokens({ranges:e}){const t=e.map(i=>new Tc(Ni(i.fromLineNumber-1,0),Ni(i.toLineNumber,0),Ni(i.toLineNumber-i.fromLineNumber+1,0)));this.handleEdits(t,!0),this.initialAstWithoutTokens||this.didChangeEmitter.fire()}handleContentChanged(e){const t=Tc.fromModelContentChanges(e.changes);this.handleEdits(t,!1)}handleEdits(e,t){const i=yx(this.queuedTextEdits,e);this.queuedTextEdits=i,this.initialAstWithoutTokens&&!t&&(this.queuedTextEditsForInitialAstWithoutTokens=yx(this.queuedTextEditsForInitialAstWithoutTokens,e))}flushQueue(){this.queuedTextEdits.length>0&&(this.astWithTokens=this.parseDocumentFromTextBuffer(this.queuedTextEdits,this.astWithTokens,!1),this.queuedTextEdits=[]),this.queuedTextEditsForInitialAstWithoutTokens.length>0&&(this.initialAstWithoutTokens&&(this.initialAstWithoutTokens=this.parseDocumentFromTextBuffer(this.queuedTextEditsForInitialAstWithoutTokens,this.initialAstWithoutTokens,!1)),this.queuedTextEditsForInitialAstWithoutTokens=[])}parseDocumentFromTextBuffer(e,t,i){const n=t,s=new y$(this.textModel,this.brackets);return VA(s,e,n,i)}getBracketsInRange(e,t){this.flushQueue();const i=Ni(e.startLineNumber-1,e.startColumn-1),n=Ni(e.endLineNumber-1,e.endColumn-1);return new sg(s=>{const r=this.initialAstWithoutTokens||this.astWithTokens;HA(r,rs,r.length,i,n,s,0,0,new Map,t)})}getBracketPairsInRange(e,t){this.flushQueue();const i=Jp(e.getStartPosition()),n=Jp(e.getEndPosition());return new sg(s=>{const r=this.initialAstWithoutTokens||this.astWithTokens,a=new yde(s,t,this.textModel);zA(r,rs,r.length,i,n,a,0,new Map)})}getFirstBracketAfter(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return L$(t,rs,t.length,Jp(e))}getFirstBracketBefore(e){this.flushQueue();const t=this.initialAstWithoutTokens||this.astWithTokens;return x$(t,rs,t.length,Jp(e))}}function x$(o,e,t,i){if(o.kind===4||o.kind===2){const n=[];for(const s of o.children)t=mi(e,s.length),n.push({nodeOffsetStart:e,nodeOffsetEnd:t}),e=t;for(let s=n.length-1;s>=0;s--){const{nodeOffsetStart:r,nodeOffsetEnd:a}=n[s];if(Vm(r,i)){const l=x$(o.children[s],r,a,i);if(l)return l}}return null}else{if(o.kind===3)return null;if(o.kind===1){const n=cg(e,t);return{bracketInfo:o.bracketInfo,range:n}}}return null}function L$(o,e,t,i){if(o.kind===4||o.kind===2){for(const n of o.children){if(t=mi(e,n.length),Vm(i,t)){const s=L$(n,e,t,i);if(s)return s}e=t}return null}else{if(o.kind===3)return null;if(o.kind===1){const n=cg(e,t);return{bracketInfo:o.bracketInfo,range:n}}}return null}function HA(o,e,t,i,n,s,r,a,l,c,d=!1){if(r>200)return!0;e:for(;;)switch(o.kind){case 4:{const h=o.childrenLength;for(let u=0;u<h;u++){const g=o.getChild(u);if(g){if(t=mi(e,g.length),Hm(e,n)&&_v(t,i)){if(_v(t,n)){o=g;continue e}if(!HA(g,e,t,i,n,s,r,0,l,c))return!1}e=t}}return!0}case 2:{const h=!c||!o.closingBracket||o.closingBracket.bracketInfo.closesColorized(o.openingBracket.bracketInfo);let u=0;if(l){let f=l.get(o.openingBracket.text);f===void 0&&(f=0),u=f,h&&(f++,l.set(o.openingBracket.text,f))}const g=o.childrenLength;for(let f=0;f<g;f++){const m=o.getChild(f);if(m){if(t=mi(e,m.length),Hm(e,n)&&_v(t,i)){if(_v(t,n)&&m.kind!==1){o=m,h?(r++,a=u+1):a=u;continue e}if((h||m.kind!==1||!o.closingBracket)&&!HA(m,e,t,i,n,s,h?r+1:r,h?u+1:u,l,c,!o.closingBracket))return!1}e=t}}return l?.set(o.openingBracket.text,u),!0}case 3:{const h=cg(e,t);return s(new qH(h,r-1,0,!0))}case 1:{const h=cg(e,t);return s(new qH(h,r-1,a-1,d))}case 0:return!0}}class yde{constructor(e,t,i){this.push=e,this.includeMinIndentation=t,this.textModel=i}}function zA(o,e,t,i,n,s,r,a){if(r>200)return!0;let l=!0;if(o.kind===2){let c=0;if(a){let u=a.get(o.openingBracket.text);u===void 0&&(u=0),c=u,u++,a.set(o.openingBracket.text,u)}const d=mi(e,o.openingBracket.length);let h=-1;if(s.includeMinIndentation&&(h=o.computeMinIndentation(e,s.textModel)),l=s.push(new ide(cg(e,t),cg(e,d),o.closingBracket?cg(mi(d,o.child?.length||rs),t):void 0,r,c,o,h)),e=d,l&&o.child){const u=o.child;if(t=mi(e,u.length),Hm(e,n)&&_v(t,i)&&(l=zA(u,e,t,i,n,s,r+1,a),!l))return!1}a?.set(o.openingBracket.text,c)}else{let c=e;for(const d of o.children){const h=c;if(c=mi(c,d.length),Hm(h,n)&&Hm(i,c)&&(l=zA(d,h,c,i,n,s,r,a),!l))return!1}}return l}class wde extends F{get canBuildAST(){return this.textModel.getValueLength()<=5e6}constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t,this.bracketPairsTree=this._register(new Yi),this.onDidChangeEmitter=new O,this.onDidChange=this.onDidChangeEmitter.event,this.bracketsRequested=!1}handleLanguageConfigurationServiceChange(e){(!e.languageId||this.bracketPairsTree.value?.object.didLanguageChange(e.languageId))&&(this.bracketPairsTree.clear(),this.updateBracketPairsTree())}handleDidChangeOptions(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeLanguage(e){this.bracketPairsTree.clear(),this.updateBracketPairsTree()}handleDidChangeContent(e){this.bracketPairsTree.value?.object.handleContentChanged(e)}handleDidChangeBackgroundTokenizationState(){this.bracketPairsTree.value?.object.handleDidChangeBackgroundTokenizationState()}handleDidChangeTokens(e){this.bracketPairsTree.value?.object.handleDidChangeTokens(e)}updateBracketPairsTree(){if(this.bracketsRequested&&this.canBuildAST){if(!this.bracketPairsTree.value){const e=new $;this.bracketPairsTree.value=Sde(e.add(new Cde(this.textModel,t=>this.languageConfigurationService.getLanguageConfiguration(t))),e),e.add(this.bracketPairsTree.value.object.onDidChange(t=>this.onDidChangeEmitter.fire(t))),this.onDidChangeEmitter.fire()}}else this.bracketPairsTree.value&&(this.bracketPairsTree.clear(),this.onDidChangeEmitter.fire())}getBracketPairsInRange(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!1)||sg.empty}getBracketPairsInRangeWithMinIndentation(e){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketPairsInRange(e,!0)||sg.empty}getBracketsInRange(e,t=!1){return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getBracketsInRange(e,t)||sg.empty}findMatchingBracketUp(e,t,i){const n=this.textModel.validatePosition(t),s=this.textModel.getLanguageIdAtPosition(n.lineNumber,n.column);if(this.canBuildAST){const r=this.languageConfigurationService.getLanguageConfiguration(s).bracketsNew.getClosingBracketInfo(e);if(!r)return null;const a=this.getBracketPairsInRange(L.fromPositions(t,t)).findLast(l=>r.closes(l.openingBracketInfo));return a?a.openingBracketRange:null}else{const r=e.toLowerCase(),a=this.languageConfigurationService.getLanguageConfiguration(s).brackets;if(!a)return null;const l=a.textIsBracket[r];return l?BS(this._findMatchingBracketUp(l,n,OI(i))):null}}matchBracket(e,t){if(this.canBuildAST){const i=this.getBracketPairsInRange(L.fromPositions(e,e)).filter(n=>n.closingBracketRange!==void 0&&(n.openingBracketRange.containsPosition(e)||n.closingBracketRange.containsPosition(e))).findLastMaxBy(cs(n=>n.openingBracketRange.containsPosition(e)?n.openingBracketRange:n.closingBracketRange,L.compareRangesUsingStarts));return i?[i.openingBracketRange,i.closingBracketRange]:null}else{const i=OI(t);return this._matchBracket(this.textModel.validatePosition(e),i)}}_establishBracketSearchOffsets(e,t,i,n){const s=t.getCount(),r=t.getLanguageId(n);let a=Math.max(0,e.column-1-i.maxBracketLength);for(let c=n-1;c>=0;c--){const d=t.getEndOffset(c);if(d<=a)break;if(Xa(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){a=d;break}}let l=Math.min(t.getLineContent().length,e.column-1+i.maxBracketLength);for(let c=n+1;c<s;c++){const d=t.getStartOffset(c);if(d>=l)break;if(Xa(t.getStandardTokenType(c))||t.getLanguageId(c)!==r){l=d;break}}return{searchStartOffset:a,searchEndOffset:l}}_matchBracket(e,t){const i=e.lineNumber,n=this.textModel.tokenization.getLineTokens(i),s=this.textModel.getLineContent(i),r=n.findTokenIndexAtOffset(e.column-1);if(r<0)return null;const a=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(r)).brackets;if(a&&!Xa(n.getStandardTokenType(r))){let{searchStartOffset:l,searchEndOffset:c}=this._establishBracketSearchOffsets(e,n,a,r),d=null;for(;;){const h=Lr.findNextBracketInRange(a.forwardRegex,i,s,l,c);if(!h)break;if(h.startColumn<=e.column&&e.column<=h.endColumn){const u=s.substring(h.startColumn-1,h.endColumn-1).toLowerCase(),g=this._matchFoundBracket(h,a.textIsBracket[u],a.textIsOpenBracket[u],t);if(g){if(g instanceof pc)return null;d=g}}l=h.endColumn-1}if(d)return d}if(r>0&&n.getStartOffset(r)===e.column-1){const l=r-1,c=this.languageConfigurationService.getLanguageConfiguration(n.getLanguageId(l)).brackets;if(c&&!Xa(n.getStandardTokenType(l))){const{searchStartOffset:d,searchEndOffset:h}=this._establishBracketSearchOffsets(e,n,c,l),u=Lr.findPrevBracketInRange(c.reversedRegex,i,s,d,h);if(u&&u.startColumn<=e.column&&e.column<=u.endColumn){const g=s.substring(u.startColumn-1,u.endColumn-1).toLowerCase(),f=this._matchFoundBracket(u,c.textIsBracket[g],c.textIsOpenBracket[g],t);if(f)return f instanceof pc?null:f}}}return null}_matchFoundBracket(e,t,i,n){if(!t)return null;const s=i?this._findMatchingBracketDown(t,e.getEndPosition(),n):this._findMatchingBracketUp(t,e.getStartPosition(),n);return s?s instanceof pc?s:[e,s]:null}_findMatchingBracketUp(e,t,i){const n=e.languageId,s=e.reversedRegex;let r=-1,a=0;const l=(c,d,h,u)=>{for(;;){if(i&&++a%100===0&&!i())return pc.INSTANCE;const g=Lr.findPrevBracketInRange(s,c,d,h,u);if(!g)break;const f=d.substring(g.startColumn-1,g.endColumn-1).toLowerCase();if(e.isOpen(f)?r++:e.isClose(f)&&r--,r===0)return g;u=g.startColumn-1}return null};for(let c=t.lineNumber;c>=1;c--){const d=this.textModel.tokenization.getLineTokens(c),h=d.getCount(),u=this.textModel.getLineContent(c);let g=h-1,f=u.length,m=u.length;c===t.lineNumber&&(g=d.findTokenIndexAtOffset(t.column-1),f=t.column-1,m=t.column-1);let _=!0;for(;g>=0;g--){const b=d.getLanguageId(g)===n&&!Xa(d.getStandardTokenType(g));if(b)_?f=d.getStartOffset(g):(f=d.getStartOffset(g),m=d.getEndOffset(g));else if(_&&f!==m){const v=l(c,u,f,m);if(v)return v}_=b}if(_&&f!==m){const b=l(c,u,f,m);if(b)return b}}return null}_findMatchingBracketDown(e,t,i){const n=e.languageId,s=e.forwardRegex;let r=1,a=0;const l=(d,h,u,g)=>{for(;;){if(i&&++a%100===0&&!i())return pc.INSTANCE;const f=Lr.findNextBracketInRange(s,d,h,u,g);if(!f)break;const m=h.substring(f.startColumn-1,f.endColumn-1).toLowerCase();if(e.isOpen(m)?r++:e.isClose(m)&&r--,r===0)return f;u=f.endColumn-1}return null},c=this.textModel.getLineCount();for(let d=t.lineNumber;d<=c;d++){const h=this.textModel.tokenization.getLineTokens(d),u=h.getCount(),g=this.textModel.getLineContent(d);let f=0,m=0,_=0;d===t.lineNumber&&(f=h.findTokenIndexAtOffset(t.column-1),m=t.column-1,_=t.column-1);let b=!0;for(;f<u;f++){const v=h.getLanguageId(f)===n&&!Xa(h.getStandardTokenType(f));if(v)b||(m=h.getStartOffset(f)),_=h.getEndOffset(f);else if(b&&m!==_){const y=l(d,g,m,_);if(y)return y}b=v}if(b&&m!==_){const v=l(d,g,m,_);if(v)return v}}return null}findPrevBracket(e){const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketBefore(t)||null;let i=null,n=null,s=null;for(let r=t.lineNumber;r>=1;r--){const a=this.textModel.tokenization.getLineTokens(r),l=a.getCount(),c=this.textModel.getLineContent(r);let d=l-1,h=c.length,u=c.length;if(r===t.lineNumber){d=a.findTokenIndexAtOffset(t.column-1),h=t.column-1,u=t.column-1;const f=a.getLanguageId(d);i!==f&&(i=f,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew)}let g=!0;for(;d>=0;d--){const f=a.getLanguageId(d);if(i!==f){if(n&&s&&g&&h!==u){const _=Lr.findPrevBracketInRange(n.reversedRegex,r,c,h,u);if(_)return this._toFoundBracket(s,_);g=!1}i=f,n=this.languageConfigurationService.getLanguageConfiguration(i).brackets,s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew}const m=!!n&&!Xa(a.getStandardTokenType(d));if(m)g?h=a.getStartOffset(d):(h=a.getStartOffset(d),u=a.getEndOffset(d));else if(s&&n&&g&&h!==u){const _=Lr.findPrevBracketInRange(n.reversedRegex,r,c,h,u);if(_)return this._toFoundBracket(s,_)}g=m}if(s&&n&&g&&h!==u){const f=Lr.findPrevBracketInRange(n.reversedRegex,r,c,h,u);if(f)return this._toFoundBracket(s,f)}}return null}findNextBracket(e){const t=this.textModel.validatePosition(e);if(this.canBuildAST)return this.bracketsRequested=!0,this.updateBracketPairsTree(),this.bracketPairsTree.value?.object.getFirstBracketAfter(t)||null;const i=this.textModel.getLineCount();let n=null,s=null,r=null;for(let a=t.lineNumber;a<=i;a++){const l=this.textModel.tokenization.getLineTokens(a),c=l.getCount(),d=this.textModel.getLineContent(a);let h=0,u=0,g=0;if(a===t.lineNumber){h=l.findTokenIndexAtOffset(t.column-1),u=t.column-1,g=t.column-1;const m=l.getLanguageId(h);n!==m&&(n=m,s=this.languageConfigurationService.getLanguageConfiguration(n).brackets,r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew)}let f=!0;for(;h<c;h++){const m=l.getLanguageId(h);if(n!==m){if(r&&s&&f&&u!==g){const b=Lr.findNextBracketInRange(s.forwardRegex,a,d,u,g);if(b)return this._toFoundBracket(r,b);f=!1}n=m,s=this.languageConfigurationService.getLanguageConfiguration(n).brackets,r=this.languageConfigurationService.getLanguageConfiguration(n).bracketsNew}const _=!!s&&!Xa(l.getStandardTokenType(h));if(_)f||(u=l.getStartOffset(h)),g=l.getEndOffset(h);else if(r&&s&&f&&u!==g){const b=Lr.findNextBracketInRange(s.forwardRegex,a,d,u,g);if(b)return this._toFoundBracket(r,b)}f=_}if(r&&s&&f&&u!==g){const m=Lr.findNextBracketInRange(s.forwardRegex,a,d,u,g);if(m)return this._toFoundBracket(r,m)}}return null}findEnclosingBrackets(e,t){const i=this.textModel.validatePosition(e);if(this.canBuildAST){const g=L.fromPositions(i),f=this.getBracketPairsInRange(L.fromPositions(i,i)).findLast(m=>m.closingBracketRange!==void 0&&m.range.strictContainsRange(g));return f?[f.openingBracketRange,f.closingBracketRange]:null}const n=OI(t),s=this.textModel.getLineCount(),r=new Map;let a=[];const l=(g,f)=>{if(!r.has(g)){const m=[];for(let _=0,b=f?f.brackets.length:0;_<b;_++)m[_]=0;r.set(g,m)}a=r.get(g)};let c=0;const d=(g,f,m,_,b)=>{for(;;){if(n&&++c%100===0&&!n())return pc.INSTANCE;const v=Lr.findNextBracketInRange(g.forwardRegex,f,m,_,b);if(!v)break;const y=m.substring(v.startColumn-1,v.endColumn-1).toLowerCase(),C=g.textIsBracket[y];if(C&&(C.isOpen(y)?a[C.index]++:C.isClose(y)&&a[C.index]--,a[C.index]===-1))return this._matchFoundBracket(v,C,!1,n);_=v.endColumn-1}return null};let h=null,u=null;for(let g=i.lineNumber;g<=s;g++){const f=this.textModel.tokenization.getLineTokens(g),m=f.getCount(),_=this.textModel.getLineContent(g);let b=0,v=0,y=0;if(g===i.lineNumber){b=f.findTokenIndexAtOffset(i.column-1),v=i.column-1,y=i.column-1;const w=f.getLanguageId(b);h!==w&&(h=w,u=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,u))}let C=!0;for(;b<m;b++){const w=f.getLanguageId(b);if(h!==w){if(u&&C&&v!==y){const k=d(u,g,_,v,y);if(k)return BS(k);C=!1}h=w,u=this.languageConfigurationService.getLanguageConfiguration(h).brackets,l(h,u)}const x=!!u&&!Xa(f.getStandardTokenType(b));if(x)C||(v=f.getStartOffset(b)),y=f.getEndOffset(b);else if(u&&C&&v!==y){const k=d(u,g,_,v,y);if(k)return BS(k)}C=x}if(u&&C&&v!==y){const w=d(u,g,_,v,y);if(w)return BS(w)}}return null}_toFoundBracket(e,t){if(!t)return null;let i=this.textModel.getValueInRange(t);i=i.toLowerCase();const n=e.getBracketInfo(i);return n?{range:t,bracketInfo:n}:null}}function Sde(o,e){return{object:o,dispose:()=>e?.dispose()}}function OI(o){if(typeof o>"u")return()=>!0;{const e=Date.now();return()=>Date.now()-e<=o}}const Pk=class Pk{constructor(){this._searchCanceledBrand=void 0}};Pk.INSTANCE=new Pk;let pc=Pk;function BS(o){return o instanceof pc?null:o}class xde extends F{constructor(e){super(),this.textModel=e,this.colorProvider=new k$,this.onDidChangeEmitter=new O,this.onDidChange=this.onDidChangeEmitter.event,this.colorizationOptions=e.getOptions().bracketPairColorizationOptions,this._register(e.bracketPairs.onDidChange(t=>{this.onDidChangeEmitter.fire()}))}handleDidChangeOptions(e){this.colorizationOptions=this.textModel.getOptions().bracketPairColorizationOptions}getDecorationsInRange(e,t,i,n){return n?[]:t===void 0?[]:this.colorizationOptions.enabled?this.textModel.bracketPairs.getBracketsInRange(e,!0).map(r=>({id:`bracket${r.range.toString()}-${r.nestingLevel}`,options:{description:"BracketPairColorization",inlineClassName:this.colorProvider.getInlineClassName(r,this.colorizationOptions.independentColorPoolPerBracketType)},ownerId:0,range:r.range})).toArray():[]}getAllDecorations(e,t){return e===void 0?[]:this.colorizationOptions.enabled?this.getDecorationsInRange(new L(1,1,this.textModel.getLineCount(),1),e,t):[]}}class k${constructor(){this.unexpectedClosingBracketClassName="unexpected-closing-bracket"}getInlineClassName(e,t){return e.isInvalid?this.unexpectedClosingBracketClassName:this.getInlineClassNameOfLevel(t?e.nestingLevelOfEqualBracketType:e.nestingLevel)}getInlineClassNameOfLevel(e){return`bracket-highlighting-${e%30}`}}br((o,e)=>{const t=[g$,f$,p$,m$,_$,b$],i=new k$;e.addRule(`.monaco-editor .${i.unexpectedClosingBracketClassName} { color: ${o.getColor(Fce)}; }`);const n=t.map(s=>o.getColor(s)).filter(s=>!!s).filter(s=>!s.isTransparent());for(let s=0;s<30;s++){const r=n[s%n.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(s)} { color: ${r}; }`)}});function WS(o){return o.replace(/\n/g,"\\n").replace(/\r/g,"\\r")}class wn{get oldLength(){return this.oldText.length}get oldEnd(){return this.oldPosition+this.oldText.length}get newLength(){return this.newText.length}get newEnd(){return this.newPosition+this.newText.length}constructor(e,t,i,n){this.oldPosition=e,this.oldText=t,this.newPosition=i,this.newText=n}toString(){return this.oldText.length===0?`(insert@${this.oldPosition} "${WS(this.newText)}")`:this.newText.length===0?`(delete@${this.oldPosition} "${WS(this.oldText)}")`:`(replace@${this.oldPosition} "${WS(this.oldText)}" with "${WS(this.newText)}")`}static _writeStringSize(e){return 4+2*e.length}static _writeString(e,t,i){const n=t.length;la(e,n,i),i+=4;for(let s=0;s<n;s++)hte(e,t.charCodeAt(s),i),i+=2;return i}static _readString(e,t){const i=aa(e,t);return t+=4,gte(e,t,i)}writeSize(){return 8+wn._writeStringSize(this.oldText)+wn._writeStringSize(this.newText)}write(e,t){return la(e,this.oldPosition,t),t+=4,la(e,this.newPosition,t),t+=4,t=wn._writeString(e,this.oldText,t),t=wn._writeString(e,this.newText,t),t}static read(e,t,i){const n=aa(e,t);t+=4;const s=aa(e,t);t+=4;const r=wn._readString(e,t);t+=wn._writeStringSize(r);const a=wn._readString(e,t);return t+=wn._writeStringSize(a),i.push(new wn(n,r,s,a)),t}}function Lde(o,e){return o===null||o.length===0?e:new el(o,e).compress()}class el{constructor(e,t){this._prevEdits=e,this._currEdits=t,this._result=[],this._resultLen=0,this._prevLen=this._prevEdits.length,this._prevDeltaOffset=0,this._currLen=this._currEdits.length,this._currDeltaOffset=0}compress(){let e=0,t=0,i=this._getPrev(e),n=this._getCurr(t);for(;e<this._prevLen||t<this._currLen;){if(i===null){this._acceptCurr(n),n=this._getCurr(++t);continue}if(n===null){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldEnd<=i.newPosition){this._acceptCurr(n),n=this._getCurr(++t);continue}if(i.newEnd<=n.oldPosition){this._acceptPrev(i),i=this._getPrev(++e);continue}if(n.oldPosition<i.newPosition){const[c,d]=el._splitCurr(n,i.newPosition-n.oldPosition);this._acceptCurr(c),n=d;continue}if(i.newPosition<n.oldPosition){const[c,d]=el._splitPrev(i,n.oldPosition-i.newPosition);this._acceptPrev(c),i=d;continue}let a,l;if(n.oldEnd===i.newEnd)a=i,l=n,i=this._getPrev(++e),n=this._getCurr(++t);else if(n.oldEnd<i.newEnd){const[c,d]=el._splitPrev(i,n.oldLength);a=c,l=n,i=d,n=this._getCurr(++t)}else{const[c,d]=el._splitCurr(n,i.newLength);a=i,l=c,i=this._getPrev(++e),n=d}this._result[this._resultLen++]=new wn(a.oldPosition,a.oldText,l.newPosition,l.newText),this._prevDeltaOffset+=a.newLength-a.oldLength,this._currDeltaOffset+=l.newLength-l.oldLength}const s=el._merge(this._result);return el._removeNoOps(s)}_acceptCurr(e){this._result[this._resultLen++]=el._rebaseCurr(this._prevDeltaOffset,e),this._currDeltaOffset+=e.newLength-e.oldLength}_getCurr(e){return e<this._currLen?this._currEdits[e]:null}_acceptPrev(e){this._result[this._resultLen++]=el._rebasePrev(this._currDeltaOffset,e),this._prevDeltaOffset+=e.newLength-e.oldLength}_getPrev(e){return e<this._prevLen?this._prevEdits[e]:null}static _rebaseCurr(e,t){return new wn(t.oldPosition-e,t.oldText,t.newPosition,t.newText)}static _rebasePrev(e,t){return new wn(t.oldPosition,t.oldText,t.newPosition+e,t.newText)}static _splitPrev(e,t){const i=e.newText.substr(0,t),n=e.newText.substr(t);return[new wn(e.oldPosition,e.oldText,e.newPosition,i),new wn(e.oldEnd,"",e.newPosition+t,n)]}static _splitCurr(e,t){const i=e.oldText.substr(0,t),n=e.oldText.substr(t);return[new wn(e.oldPosition,i,e.newPosition,e.newText),new wn(e.oldPosition+t,n,e.newEnd,"")]}static _merge(e){if(e.length===0)return e;const t=[];let i=0,n=e[0];for(let s=1;s<e.length;s++){const r=e[s];n.oldEnd===r.oldPosition?n=new wn(n.oldPosition,n.oldText+r.oldText,n.newPosition,n.newText+r.newText):(t[i++]=n,n=r)}return t[i++]=n,t}static _removeNoOps(e){if(e.length===0)return e;const t=[];let i=0;for(let n=0;n<e.length;n++){const s=e[n];s.oldText!==s.newText&&(t[i++]=s)}return t}}function vp(o){return o.toString()}class Ji{static create(e,t){const i=e.getAlternativeVersionId(),n=UA(e);return new Ji(i,i,n,n,t,t,[])}constructor(e,t,i,n,s,r,a){this.beforeVersionId=e,this.afterVersionId=t,this.beforeEOL=i,this.afterEOL=n,this.beforeCursorState=s,this.afterCursorState=r,this.changes=a}append(e,t,i,n,s){t.length>0&&(this.changes=Lde(this.changes,t)),this.afterEOL=i,this.afterVersionId=n,this.afterCursorState=s}static _writeSelectionsSize(e){return 4+4*4*(e?e.length:0)}static _writeSelections(e,t,i){if(la(e,t?t.length:0,i),i+=4,t)for(const n of t)la(e,n.selectionStartLineNumber,i),i+=4,la(e,n.selectionStartColumn,i),i+=4,la(e,n.positionLineNumber,i),i+=4,la(e,n.positionColumn,i),i+=4;return i}static _readSelections(e,t,i){const n=aa(e,t);t+=4;for(let s=0;s<n;s++){const r=aa(e,t);t+=4;const a=aa(e,t);t+=4;const l=aa(e,t);t+=4;const c=aa(e,t);t+=4,i.push(new pe(r,a,l,c))}return t}serialize(){let e=10+Ji._writeSelectionsSize(this.beforeCursorState)+Ji._writeSelectionsSize(this.afterCursorState)+4;for(const n of this.changes)e+=n.writeSize();const t=new Uint8Array(e);let i=0;la(t,this.beforeVersionId,i),i+=4,la(t,this.afterVersionId,i),i+=4,eV(t,this.beforeEOL,i),i+=1,eV(t,this.afterEOL,i),i+=1,i=Ji._writeSelections(t,this.beforeCursorState,i),i=Ji._writeSelections(t,this.afterCursorState,i),la(t,this.changes.length,i),i+=4;for(const n of this.changes)i=n.write(t,i);return t.buffer}static deserialize(e){const t=new Uint8Array(e);let i=0;const n=aa(t,i);i+=4;const s=aa(t,i);i+=4;const r=J3(t,i);i+=1;const a=J3(t,i);i+=1;const l=[];i=Ji._readSelections(t,i,l);const c=[];i=Ji._readSelections(t,i,c);const d=aa(t,i);i+=4;const h=[];for(let u=0;u<d;u++)i=wn.read(t,i,h);return new Ji(n,s,r,a,l,c,h)}}class E${get type(){return 0}get resource(){return ye.isUri(this.model)?this.model:this.model.uri}constructor(e,t,i,n){this.label=e,this.code=t,this.model=i,this._data=Ji.create(i,n)}toString(){return(this._data instanceof Ji?this._data:Ji.deserialize(this._data)).changes.map(t=>t.toString()).join(", ")}matchesResource(e){return(ye.isUri(this.model)?this.model:this.model.uri).toString()===e.toString()}setModel(e){this.model=e}canAppend(e){return this.model===e&&this._data instanceof Ji}append(e,t,i,n,s){this._data instanceof Ji&&this._data.append(e,t,i,n,s)}close(){this._data instanceof Ji&&(this._data=this._data.serialize())}open(){this._data instanceof Ji||(this._data=Ji.deserialize(this._data))}undo(){if(ye.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Ji&&(this._data=this._data.serialize());const e=Ji.deserialize(this._data);this.model._applyUndo(e.changes,e.beforeEOL,e.beforeVersionId,e.beforeCursorState)}redo(){if(ye.isUri(this.model))throw new Error("Invalid SingleModelEditStackElement");this._data instanceof Ji&&(this._data=this._data.serialize());const e=Ji.deserialize(this._data);this.model._applyRedo(e.changes,e.afterEOL,e.afterVersionId,e.afterCursorState)}heapSize(){return this._data instanceof Ji&&(this._data=this._data.serialize()),this._data.byteLength+168}}class kde{get resources(){return this._editStackElementsArr.map(e=>e.resource)}constructor(e,t,i){this.label=e,this.code=t,this.type=1,this._isOpen=!0,this._editStackElementsArr=i.slice(0),this._editStackElementsMap=new Map;for(const n of this._editStackElementsArr){const s=vp(n.resource);this._editStackElementsMap.set(s,n)}this._delegate=null}prepareUndoRedo(){if(this._delegate)return this._delegate.prepareUndoRedo(this)}matchesResource(e){const t=vp(e);return this._editStackElementsMap.has(t)}setModel(e){const t=vp(ye.isUri(e)?e:e.uri);this._editStackElementsMap.has(t)&&this._editStackElementsMap.get(t).setModel(e)}canAppend(e){if(!this._isOpen)return!1;const t=vp(e.uri);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).canAppend(e):!1}append(e,t,i,n,s){const r=vp(e.uri);this._editStackElementsMap.get(r).append(e,t,i,n,s)}close(){this._isOpen=!1}open(){}undo(){this._isOpen=!1;for(const e of this._editStackElementsArr)e.undo()}redo(){for(const e of this._editStackElementsArr)e.redo()}heapSize(e){const t=vp(e);return this._editStackElementsMap.has(t)?this._editStackElementsMap.get(t).heapSize():0}split(){return this._editStackElementsArr}toString(){const e=[];for(const t of this._editStackElementsArr)e.push(`${fr(t.resource)}: ${t}`);return`{${e.join(", ")}}`}}function UA(o){return o.getEOL()===`
`?0:1}function mc(o){return o?o instanceof E$||o instanceof kde:!1}class j5{constructor(e,t){this._model=e,this._undoRedoService=t}pushStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);mc(e)&&e.close()}popStackElement(){const e=this._undoRedoService.getLastElement(this._model.uri);mc(e)&&e.open()}clear(){this._undoRedoService.removeElements(this._model.uri)}_getOrCreateEditStackElement(e,t){const i=this._undoRedoService.getLastElement(this._model.uri);if(mc(i)&&i.canAppend(this._model))return i;const n=new E$(p("edit","Typing"),"undoredo.textBufferEdit",this._model,e);return this._undoRedoService.pushElement(n,t),n}pushEOL(e){const t=this._getOrCreateEditStackElement(null,void 0);this._model.setEOL(e),t.append(this._model,[],UA(this._model),this._model.getAlternativeVersionId(),null)}pushEditOperation(e,t,i,n){const s=this._getOrCreateEditStackElement(e,n),r=this._model.applyEdits(t,!0),a=j5._computeCursorState(i,r),l=r.map((c,d)=>({index:d,textChange:c.textChange}));return l.sort((c,d)=>c.textChange.oldPosition===d.textChange.oldPosition?c.index-d.index:c.textChange.oldPosition-d.textChange.oldPosition),s.append(this._model,l.map(c=>c.textChange),UA(this._model),this._model.getAlternativeVersionId(),a),a}static _computeCursorState(e,t){try{return e?e(t):null}catch(i){return Ae(i),null}}}class T$ extends F{constructor(){super(...arguments),this._isDisposed=!1}dispose(){super.dispose(),this._isDisposed=!0}assertNotDisposed(){if(this._isDisposed)throw new Error("TextModelPart is disposed!")}}function jT(o,e){let t=0,i=0;const n=o.length;for(;i<n;){const s=o.charCodeAt(i);if(s===32)t++;else if(s===9)t=t-t%e+e;else break;i++}return i===n?-1:t}var dg;(function(o){o[o.Disabled=0]="Disabled",o[o.EnabledForActive=1]="EnabledForActive",o[o.Enabled=2]="Enabled"})(dg||(dg={}));class eg{constructor(e,t,i,n,s,r){if(this.visibleColumn=e,this.column=t,this.className=i,this.horizontalLine=n,this.forWrappedLinesAfterColumn=s,this.forWrappedLinesBeforeOrAtColumn=r,e!==-1==(t!==-1))throw new Error}}class Uv{constructor(e,t){this.top=e,this.endColumn=t}}class Ede extends T${constructor(e,t){super(),this.textModel=e,this.languageConfigurationService=t}getLanguageConfiguration(e){return this.languageConfigurationService.getLanguageConfiguration(e)}_computeIndentLevel(e){return jT(this.textModel.getLineContent(e+1),this.textModel.getOptions().tabSize)}getActiveIndentGuide(e,t,i){this.assertNotDisposed();const n=this.textModel.getLineCount();if(e<1||e>n)throw new pt("Illegal value for lineNumber");const s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(s&&s.offSide);let a=-2,l=-1,c=-2,d=-1;const h=k=>{if(a!==-1&&(a===-2||a>k-1)){a=-1,l=-1;for(let E=k-2;E>=0;E--){const N=this._computeIndentLevel(E);if(N>=0){a=E,l=N;break}}}if(c===-2){c=-1,d=-1;for(let E=k;E<n;E++){const N=this._computeIndentLevel(E);if(N>=0){c=E,d=N;break}}}};let u=-2,g=-1,f=-2,m=-1;const _=k=>{if(u===-2){u=-1,g=-1;for(let E=k-2;E>=0;E--){const N=this._computeIndentLevel(E);if(N>=0){u=E,g=N;break}}}if(f!==-1&&(f===-2||f<k-1)){f=-1,m=-1;for(let E=k;E<n;E++){const N=this._computeIndentLevel(E);if(N>=0){f=E,m=N;break}}}};let b=0,v=!0,y=0,C=!0,w=0,x=0;for(let k=0;v||C;k++){const E=e-k,N=e+k;k>1&&(E<1||E<t)&&(v=!1),k>1&&(N>n||N>i)&&(C=!1),k>5e4&&(v=!1,C=!1);let z=-1;if(v&&E>=1){const U=this._computeIndentLevel(E-1);U>=0?(c=E-1,d=U,z=Math.ceil(U/this.textModel.getOptions().indentSize)):(h(E),z=this._getIndentLevelForWhitespaceLine(r,l,d))}let B=-1;if(C&&N<=n){const U=this._computeIndentLevel(N-1);U>=0?(u=N-1,g=U,B=Math.ceil(U/this.textModel.getOptions().indentSize)):(_(N),B=this._getIndentLevelForWhitespaceLine(r,g,m))}if(k===0){x=z;continue}if(k===1){if(N<=n&&B>=0&&x+1===B){v=!1,b=N,y=N,w=B;continue}if(E>=1&&z>=0&&z-1===x){C=!1,b=E,y=E,w=z;continue}if(b=e,y=e,w=x,w===0)return{startLineNumber:b,endLineNumber:y,indent:w}}v&&(z>=w?b=E:v=!1),C&&(B>=w?y=N:C=!1)}return{startLineNumber:b,endLineNumber:y,indent:w}}getLinesBracketGuides(e,t,i,n){const s=[];for(let h=e;h<=t;h++)s.push([]);const r=!0,a=this.textModel.bracketPairs.getBracketPairsInRangeWithMinIndentation(new L(e,1,t,this.textModel.getLineMaxColumn(t))).toArray();let l;if(i&&a.length>0){const h=(e<=i.lineNumber&&i.lineNumber<=t?a:this.textModel.bracketPairs.getBracketPairsInRange(L.fromPositions(i)).toArray()).filter(u=>L.strictContainsPosition(u.range,i));l=JC(h,u=>r)?.range}const c=this.textModel.getOptions().bracketPairColorizationOptions.independentColorPoolPerBracketType,d=new D$;for(const h of a){if(!h.closingBracketRange)continue;const u=l&&h.range.equalsRange(l);if(!u&&!n.includeInactive)continue;const g=d.getInlineClassName(h.nestingLevel,h.nestingLevelOfEqualBracketType,c)+(n.highlightActive&&u?" "+d.activeClassName:""),f=h.openingBracketRange.getStartPosition(),m=h.closingBracketRange.getStartPosition(),_=n.horizontalGuides===dg.Enabled||n.horizontalGuides===dg.EnabledForActive&&u;if(h.range.startLineNumber===h.range.endLineNumber){_&&s[h.range.startLineNumber-e].push(new eg(-1,h.openingBracketRange.getEndPosition().column,g,new Uv(!1,m.column),-1,-1));continue}const b=this.getVisibleColumnFromPosition(m),v=this.getVisibleColumnFromPosition(h.openingBracketRange.getStartPosition()),y=Math.min(v,b,h.minVisibleColumnIndentation+1);let C=!1;Xn(this.textModel.getLineContent(h.closingBracketRange.startLineNumber))<h.closingBracketRange.startColumn-1&&(C=!0);const k=Math.max(f.lineNumber,e),E=Math.min(m.lineNumber,t),N=C?1:0;for(let z=k;z<E+N;z++)s[z-e].push(new eg(y,-1,g,null,z===f.lineNumber?f.column:-1,z===m.lineNumber?m.column:-1));_&&(f.lineNumber>=e&&v>y&&s[f.lineNumber-e].push(new eg(y,-1,g,new Uv(!1,f.column),-1,-1)),m.lineNumber<=t&&b>y&&s[m.lineNumber-e].push(new eg(y,-1,g,new Uv(!C,m.column),-1,-1)))}for(const h of s)h.sort((u,g)=>u.visibleColumn-g.visibleColumn);return s}getVisibleColumnFromPosition(e){return Vi.visibleColumnFromColumn(this.textModel.getLineContent(e.lineNumber),e.column,this.textModel.getOptions().tabSize)+1}getLinesIndentGuides(e,t){this.assertNotDisposed();const i=this.textModel.getLineCount();if(e<1||e>i)throw new Error("Illegal value for startLineNumber");if(t<1||t>i)throw new Error("Illegal value for endLineNumber");const n=this.textModel.getOptions(),s=this.getLanguageConfiguration(this.textModel.getLanguageId()).foldingRules,r=!!(s&&s.offSide),a=new Array(t-e+1);let l=-2,c=-1,d=-2,h=-1;for(let u=e;u<=t;u++){const g=u-e,f=this._computeIndentLevel(u-1);if(f>=0){l=u-1,c=f,a[g]=Math.ceil(f/n.indentSize);continue}if(l===-2){l=-1,c=-1;for(let m=u-2;m>=0;m--){const _=this._computeIndentLevel(m);if(_>=0){l=m,c=_;break}}}if(d!==-1&&(d===-2||d<u-1)){d=-1,h=-1;for(let m=u;m<i;m++){const _=this._computeIndentLevel(m);if(_>=0){d=m,h=_;break}}}a[g]=this._getIndentLevelForWhitespaceLine(r,c,h)}return a}_getIndentLevelForWhitespaceLine(e,t,i){const n=this.textModel.getOptions();return t===-1||i===-1?0:t<i?1+Math.floor(t/n.indentSize):t===i||e?Math.ceil(i/n.indentSize):1+Math.floor(i/n.indentSize)}}class D${constructor(){this.activeClassName="indent-active"}getInlineClassName(e,t,i){return this.getInlineClassNameOfLevel(i?t:e)}getInlineClassNameOfLevel(e){return`bracket-indent-guide lvl-${e%30}`}}class Tde{constructor(){this.spacesDiff=0,this.looksLikeAlignment=!1}}function Dde(o,e,t,i,n){n.spacesDiff=0,n.looksLikeAlignment=!1;let s;for(s=0;s<e&&s<i;s++){const u=o.charCodeAt(s),g=t.charCodeAt(s);if(u!==g)break}let r=0,a=0;for(let u=s;u<e;u++)o.charCodeAt(u)===32?r++:a++;let l=0,c=0;for(let u=s;u<i;u++)t.charCodeAt(u)===32?l++:c++;if(r>0&&a>0||l>0&&c>0)return;const d=Math.abs(a-c),h=Math.abs(r-l);if(d===0){n.spacesDiff=h,h>0&&0<=l-1&&l-1<o.length&&l<t.length&&t.charCodeAt(l)!==32&&o.charCodeAt(l-1)===32&&o.charCodeAt(o.length-1)===44&&(n.looksLikeAlignment=!0);return}if(h%d===0){n.spacesDiff=h/d;return}}function QH(o,e,t){const i=Math.min(o.getLineCount(),1e4);let n=0,s=0,r="",a=0;const l=[2,4,6,8,3,5,7],c=8,d=[0,0,0,0,0,0,0,0,0],h=new Tde;for(let f=1;f<=i;f++){const m=o.getLineLength(f),_=o.getLineContent(f),b=m<=65536;let v=!1,y=0,C=0,w=0;for(let k=0,E=m;k<E;k++){const N=b?_.charCodeAt(k):o.getLineCharCode(f,k);if(N===9)w++;else if(N===32)C++;else{v=!0,y=k;break}}if(!v||(w>0?n++:C>1&&s++,Dde(r,a,_,y,h),h.looksLikeAlignment&&!(t&&e===h.spacesDiff)))continue;const x=h.spacesDiff;x<=c&&d[x]++,r=_,a=y}let u=t;n!==s&&(u=n<s);let g=e;if(u){let f=u?0:.1*i;l.forEach(m=>{const _=d[m];_>f&&(f=_,g=m)}),g===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(g=2)}return{insertSpaces:u,tabSize:g}}function ws(o){return(o.metadata&1)>>>0}function $t(o,e){o.metadata=o.metadata&254|e<<0}function kn(o){return(o.metadata&2)>>>1===1}function Ht(o,e){o.metadata=o.metadata&253|(e?1:0)<<1}function I$(o){return(o.metadata&4)>>>2===1}function JH(o,e){o.metadata=o.metadata&251|(e?1:0)<<2}function N$(o){return(o.metadata&64)>>>6===1}function e7(o,e){o.metadata=o.metadata&191|(e?1:0)<<6}function Ide(o){return(o.metadata&24)>>>3}function t7(o,e){o.metadata=o.metadata&231|e<<3}function Nde(o){return(o.metadata&32)>>>5===1}function i7(o,e){o.metadata=o.metadata&223|(e?1:0)<<5}class R${constructor(e,t,i){this.metadata=0,this.parent=this,this.left=this,this.right=this,$t(this,1),this.start=t,this.end=i,this.delta=0,this.maxEnd=i,this.id=e,this.ownerId=0,this.options=null,JH(this,!1),e7(this,!1),t7(this,1),i7(this,!1),this.cachedVersionId=0,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=null,Ht(this,!1)}reset(e,t,i,n){this.start=t,this.end=i,this.maxEnd=i,this.cachedVersionId=e,this.cachedAbsoluteStart=t,this.cachedAbsoluteEnd=i,this.range=n}setOptions(e){this.options=e;const t=this.options.className;JH(this,t==="squiggly-error"||t==="squiggly-warning"||t==="squiggly-info"),e7(this,this.options.glyphMarginClassName!==null),t7(this,this.options.stickiness),i7(this,this.options.collapseOnReplaceEdit)}setCachedOffsets(e,t,i){this.cachedVersionId!==i&&(this.range=null),this.cachedVersionId=i,this.cachedAbsoluteStart=e,this.cachedAbsoluteEnd=t}detach(){this.parent=null,this.left=null,this.right=null}}const Xe=new R$(null,0,0);Xe.parent=Xe;Xe.left=Xe;Xe.right=Xe;$t(Xe,0);class FI{constructor(){this.root=Xe,this.requestNormalizeDelta=!1}intervalSearch(e,t,i,n,s,r){return this.root===Xe?[]:Wde(this,e,t,i,n,s,r)}search(e,t,i,n){return this.root===Xe?[]:Bde(this,e,t,i,n)}collectNodesFromOwner(e){return Ode(this,e)}collectNodesPostOrder(){return Fde(this)}insert(e){n7(this,e),this._normalizeDeltaIfNecessary()}delete(e){s7(this,e),this._normalizeDeltaIfNecessary()}resolveNode(e,t){const i=e;let n=0;for(;e!==this.root;)e===e.parent.right&&(n+=e.parent.delta),e=e.parent;const s=i.start+n,r=i.end+n;i.setCachedOffsets(s,r,t)}acceptReplace(e,t,i,n){const s=Ade(this,e,e+t);for(let r=0,a=s.length;r<a;r++){const l=s[r];s7(this,l)}this._normalizeDeltaIfNecessary(),Mde(this,e,e+t,i),this._normalizeDeltaIfNecessary();for(let r=0,a=s.length;r<a;r++){const l=s[r];l.start=l.cachedAbsoluteStart,l.end=l.cachedAbsoluteEnd,Pde(l,e,e+t,i,n),l.maxEnd=l.end,n7(this,l)}this._normalizeDeltaIfNecessary()}_normalizeDeltaIfNecessary(){this.requestNormalizeDelta&&(this.requestNormalizeDelta=!1,Rde(this))}}function Rde(o){let e=o.root,t=0;for(;e!==Xe;){if(e.left!==Xe&&!kn(e.left)){e=e.left;continue}if(e.right!==Xe&&!kn(e.right)){t+=e.delta,e=e.right;continue}e.start=t+e.start,e.end=t+e.end,e.delta=0,Bh(e),Ht(e,!0),Ht(e.left,!1),Ht(e.right,!1),e===e.parent.right&&(t-=e.parent.delta),e=e.parent}Ht(o.root,!1)}function Cp(o,e,t,i){return o<t?!0:o>t||i===1?!1:i===2?!0:e}function Pde(o,e,t,i,n){const s=Ide(o),r=s===0||s===2,a=s===1||s===2,l=t-e,c=i,d=Math.min(l,c),h=o.start;let u=!1;const g=o.end;let f=!1;e<=h&&g<=t&&Nde(o)&&(o.start=e,u=!0,o.end=e,f=!0);{const _=n?1:l>0?2:0;!u&&Cp(h,r,e,_)&&(u=!0),!f&&Cp(g,a,e,_)&&(f=!0)}if(d>0&&!n){const _=l>c?2:0;!u&&Cp(h,r,e+d,_)&&(u=!0),!f&&Cp(g,a,e+d,_)&&(f=!0)}{const _=n?1:0;!u&&Cp(h,r,t,_)&&(o.start=e+c,u=!0),!f&&Cp(g,a,t,_)&&(o.end=e+c,f=!0)}const m=c-l;u||(o.start=Math.max(0,h+m)),f||(o.end=Math.max(0,g+m)),o.start>o.end&&(o.end=o.start)}function Ade(o,e,t){let i=o.root,n=0,s=0,r=0,a=0;const l=[];let c=0;for(;i!==Xe;){if(kn(i)){Ht(i.left,!1),Ht(i.right,!1),i===i.parent.right&&(n-=i.parent.delta),i=i.parent;continue}if(!kn(i.left)){if(s=n+i.maxEnd,s<e){Ht(i,!0);continue}if(i.left!==Xe){i=i.left;continue}}if(r=n+i.start,r>t){Ht(i,!0);continue}if(a=n+i.end,a>=e&&(i.setCachedOffsets(r,a,0),l[c++]=i),Ht(i,!0),i.right!==Xe&&!kn(i.right)){n+=i.delta,i=i.right;continue}}return Ht(o.root,!1),l}function Mde(o,e,t,i){let n=o.root,s=0,r=0,a=0;const l=i-(t-e);for(;n!==Xe;){if(kn(n)){Ht(n.left,!1),Ht(n.right,!1),n===n.parent.right&&(s-=n.parent.delta),Bh(n),n=n.parent;continue}if(!kn(n.left)){if(r=s+n.maxEnd,r<e){Ht(n,!0);continue}if(n.left!==Xe){n=n.left;continue}}if(a=s+n.start,a>t){n.start+=l,n.end+=l,n.delta+=l,(n.delta<-1073741824||n.delta>1073741824)&&(o.requestNormalizeDelta=!0),Ht(n,!0);continue}if(Ht(n,!0),n.right!==Xe&&!kn(n.right)){s+=n.delta,n=n.right;continue}}Ht(o.root,!1)}function Ode(o,e){let t=o.root;const i=[];let n=0;for(;t!==Xe;){if(kn(t)){Ht(t.left,!1),Ht(t.right,!1),t=t.parent;continue}if(t.left!==Xe&&!kn(t.left)){t=t.left;continue}if(t.ownerId===e&&(i[n++]=t),Ht(t,!0),t.right!==Xe&&!kn(t.right)){t=t.right;continue}}return Ht(o.root,!1),i}function Fde(o){let e=o.root;const t=[];let i=0;for(;e!==Xe;){if(kn(e)){Ht(e.left,!1),Ht(e.right,!1),e=e.parent;continue}if(e.left!==Xe&&!kn(e.left)){e=e.left;continue}if(e.right!==Xe&&!kn(e.right)){e=e.right;continue}t[i++]=e,Ht(e,!0)}return Ht(o.root,!1),t}function Bde(o,e,t,i,n){let s=o.root,r=0,a=0,l=0;const c=[];let d=0;for(;s!==Xe;){if(kn(s)){Ht(s.left,!1),Ht(s.right,!1),s===s.parent.right&&(r-=s.parent.delta),s=s.parent;continue}if(s.left!==Xe&&!kn(s.left)){s=s.left;continue}a=r+s.start,l=r+s.end,s.setCachedOffsets(a,l,i);let h=!0;if(e&&s.ownerId&&s.ownerId!==e&&(h=!1),t&&I$(s)&&(h=!1),n&&!N$(s)&&(h=!1),h&&(c[d++]=s),Ht(s,!0),s.right!==Xe&&!kn(s.right)){r+=s.delta,s=s.right;continue}}return Ht(o.root,!1),c}function Wde(o,e,t,i,n,s,r){let a=o.root,l=0,c=0,d=0,h=0;const u=[];let g=0;for(;a!==Xe;){if(kn(a)){Ht(a.left,!1),Ht(a.right,!1),a===a.parent.right&&(l-=a.parent.delta),a=a.parent;continue}if(!kn(a.left)){if(c=l+a.maxEnd,c<e){Ht(a,!0);continue}if(a.left!==Xe){a=a.left;continue}}if(d=l+a.start,d>t){Ht(a,!0);continue}if(h=l+a.end,h>=e){a.setCachedOffsets(d,h,s);let f=!0;i&&a.ownerId&&a.ownerId!==i&&(f=!1),n&&I$(a)&&(f=!1),r&&!N$(a)&&(f=!1),f&&(u[g++]=a)}if(Ht(a,!0),a.right!==Xe&&!kn(a.right)){l+=a.delta,a=a.right;continue}}return Ht(o.root,!1),u}function n7(o,e){if(o.root===Xe)return e.parent=Xe,e.left=Xe,e.right=Xe,$t(e,0),o.root=e,o.root;Vde(o,e),yd(e.parent);let t=e;for(;t!==o.root&&ws(t.parent)===1;)if(t.parent===t.parent.parent.left){const i=t.parent.parent.right;ws(i)===1?($t(t.parent,0),$t(i,0),$t(t.parent.parent,1),t=t.parent.parent):(t===t.parent.right&&(t=t.parent,Gv(o,t)),$t(t.parent,0),$t(t.parent.parent,1),$v(o,t.parent.parent))}else{const i=t.parent.parent.left;ws(i)===1?($t(t.parent,0),$t(i,0),$t(t.parent.parent,1),t=t.parent.parent):(t===t.parent.left&&(t=t.parent,$v(o,t)),$t(t.parent,0),$t(t.parent.parent,1),Gv(o,t.parent.parent))}return $t(o.root,0),e}function Vde(o,e){let t=0,i=o.root;const n=e.start,s=e.end;for(;;)if(zde(n,s,i.start+t,i.end+t)<0)if(i.left===Xe){e.start-=t,e.end-=t,e.maxEnd-=t,i.left=e;break}else i=i.left;else if(i.right===Xe){e.start-=t+i.delta,e.end-=t+i.delta,e.maxEnd-=t+i.delta,i.right=e;break}else t+=i.delta,i=i.right;e.parent=i,e.left=Xe,e.right=Xe,$t(e,1)}function s7(o,e){let t,i;if(e.left===Xe?(t=e.right,i=e,t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta):e.right===Xe?(t=e.left,i=e):(i=Hde(e.right),t=i.right,t.start+=i.delta,t.end+=i.delta,t.delta+=i.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),i.start+=e.delta,i.end+=e.delta,i.delta=e.delta,(i.delta<-1073741824||i.delta>1073741824)&&(o.requestNormalizeDelta=!0)),i===o.root){o.root=t,$t(t,0),e.detach(),BI(),Bh(t),o.root.parent=Xe;return}const n=ws(i)===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?t.parent=i.parent:(i.parent===e?t.parent=i:t.parent=i.parent,i.left=e.left,i.right=e.right,i.parent=e.parent,$t(i,ws(e)),e===o.root?o.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==Xe&&(i.left.parent=i),i.right!==Xe&&(i.right.parent=i)),e.detach(),n){yd(t.parent),i!==e&&(yd(i),yd(i.parent)),BI();return}yd(t),yd(t.parent),i!==e&&(yd(i),yd(i.parent));let s;for(;t!==o.root&&ws(t)===0;)t===t.parent.left?(s=t.parent.right,ws(s)===1&&($t(s,0),$t(t.parent,1),Gv(o,t.parent),s=t.parent.right),ws(s.left)===0&&ws(s.right)===0?($t(s,1),t=t.parent):(ws(s.right)===0&&($t(s.left,0),$t(s,1),$v(o,s),s=t.parent.right),$t(s,ws(t.parent)),$t(t.parent,0),$t(s.right,0),Gv(o,t.parent),t=o.root)):(s=t.parent.left,ws(s)===1&&($t(s,0),$t(t.parent,1),$v(o,t.parent),s=t.parent.left),ws(s.left)===0&&ws(s.right)===0?($t(s,1),t=t.parent):(ws(s.left)===0&&($t(s.right,0),$t(s,1),Gv(o,s),s=t.parent.left),$t(s,ws(t.parent)),$t(t.parent,0),$t(s.left,0),$v(o,t.parent),t=o.root));$t(t,0),BI()}function Hde(o){for(;o.left!==Xe;)o=o.left;return o}function BI(){Xe.parent=Xe,Xe.delta=0,Xe.start=0,Xe.end=0}function Gv(o,e){const t=e.right;t.delta+=e.delta,(t.delta<-1073741824||t.delta>1073741824)&&(o.requestNormalizeDelta=!0),t.start+=e.delta,t.end+=e.delta,e.right=t.left,t.left!==Xe&&(t.left.parent=e),t.parent=e.parent,e.parent===Xe?o.root=t:e===e.parent.left?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t,Bh(e),Bh(t)}function $v(o,e){const t=e.left;e.delta-=t.delta,(e.delta<-1073741824||e.delta>1073741824)&&(o.requestNormalizeDelta=!0),e.start-=t.delta,e.end-=t.delta,e.left=t.right,t.right!==Xe&&(t.right.parent=e),t.parent=e.parent,e.parent===Xe?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t,Bh(e),Bh(t)}function P$(o){let e=o.end;if(o.left!==Xe){const t=o.left.maxEnd;t>e&&(e=t)}if(o.right!==Xe){const t=o.right.maxEnd+o.delta;t>e&&(e=t)}return e}function Bh(o){o.maxEnd=P$(o)}function yd(o){for(;o!==Xe;){const e=P$(o);if(o.maxEnd===e)return;o.maxEnd=e,o=o.parent}}function zde(o,e,t,i){return o===t?e-i:o-t}class GA{constructor(e,t){this.piece=e,this.color=t,this.size_left=0,this.lf_left=0,this.parent=this,this.left=this,this.right=this}next(){if(this.right!==We)return q5(this.right);let e=this;for(;e.parent!==We&&e.parent.left!==e;)e=e.parent;return e.parent===We?We:e.parent}prev(){if(this.left!==We)return A$(this.left);let e=this;for(;e.parent!==We&&e.parent.right!==e;)e=e.parent;return e.parent===We?We:e.parent}detach(){this.parent=null,this.left=null,this.right=null}}const We=new GA(null,0);We.parent=We;We.left=We;We.right=We;We.color=0;function q5(o){for(;o.left!==We;)o=o.left;return o}function A$(o){for(;o.right!==We;)o=o.right;return o}function Z5(o){return o===We?0:o.size_left+o.piece.length+Z5(o.right)}function Y5(o){return o===We?0:o.lf_left+o.piece.lineFeedCnt+Y5(o.right)}function WI(){We.parent=We}function Kv(o,e){const t=e.right;t.size_left+=e.size_left+(e.piece?e.piece.length:0),t.lf_left+=e.lf_left+(e.piece?e.piece.lineFeedCnt:0),e.right=t.left,t.left!==We&&(t.left.parent=e),t.parent=e.parent,e.parent===We?o.root=t:e.parent.left===e?e.parent.left=t:e.parent.right=t,t.left=e,e.parent=t}function jv(o,e){const t=e.left;e.left=t.right,t.right!==We&&(t.right.parent=e),t.parent=e.parent,e.size_left-=t.size_left+(t.piece?t.piece.length:0),e.lf_left-=t.lf_left+(t.piece?t.piece.lineFeedCnt:0),e.parent===We?o.root=t:e===e.parent.right?e.parent.right=t:e.parent.left=t,t.right=e,e.parent=t}function VS(o,e){let t,i;if(e.left===We?(i=e,t=i.right):e.right===We?(i=e,t=i.left):(i=q5(e.right),t=i.right),i===o.root){o.root=t,t.color=0,e.detach(),WI(),o.root.parent=We;return}const n=i.color===1;if(i===i.parent.left?i.parent.left=t:i.parent.right=t,i===e?(t.parent=i.parent,bv(o,t)):(i.parent===e?t.parent=i:t.parent=i.parent,bv(o,t),i.left=e.left,i.right=e.right,i.parent=e.parent,i.color=e.color,e===o.root?o.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,i.left!==We&&(i.left.parent=i),i.right!==We&&(i.right.parent=i),i.size_left=e.size_left,i.lf_left=e.lf_left,bv(o,i)),e.detach(),t.parent.left===t){const r=Z5(t),a=Y5(t);if(r!==t.parent.size_left||a!==t.parent.lf_left){const l=r-t.parent.size_left,c=a-t.parent.lf_left;t.parent.size_left=r,t.parent.lf_left=a,ic(o,t.parent,l,c)}}if(bv(o,t.parent),n){WI();return}let s;for(;t!==o.root&&t.color===0;)t===t.parent.left?(s=t.parent.right,s.color===1&&(s.color=0,t.parent.color=1,Kv(o,t.parent),s=t.parent.right),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.right.color===0&&(s.left.color=0,s.color=1,jv(o,s),s=t.parent.right),s.color=t.parent.color,t.parent.color=0,s.right.color=0,Kv(o,t.parent),t=o.root)):(s=t.parent.left,s.color===1&&(s.color=0,t.parent.color=1,jv(o,t.parent),s=t.parent.left),s.left.color===0&&s.right.color===0?(s.color=1,t=t.parent):(s.left.color===0&&(s.right.color=0,s.color=1,Kv(o,s),s=t.parent.left),s.color=t.parent.color,t.parent.color=0,s.left.color=0,jv(o,t.parent),t=o.root));t.color=0,WI()}function o7(o,e){for(bv(o,e);e!==o.root&&e.parent.color===1;)if(e.parent===e.parent.parent.left){const t=e.parent.parent.right;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.right&&(e=e.parent,Kv(o,e)),e.parent.color=0,e.parent.parent.color=1,jv(o,e.parent.parent))}else{const t=e.parent.parent.left;t.color===1?(e.parent.color=0,t.color=0,e.parent.parent.color=1,e=e.parent.parent):(e===e.parent.left&&(e=e.parent,jv(o,e)),e.parent.color=0,e.parent.parent.color=1,Kv(o,e.parent.parent))}o.root.color=0}function ic(o,e,t,i){for(;e!==o.root&&e!==We;)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}function bv(o,e){let t=0,i=0;if(e!==o.root){for(;e!==o.root&&e===e.parent.right;)e=e.parent;if(e!==o.root)for(e=e.parent,t=Z5(e.left)-e.size_left,i=Y5(e.left)-e.lf_left,e.size_left+=t,e.lf_left+=i;e!==o.root&&(t!==0||i!==0);)e.parent.left===e&&(e.parent.size_left+=t,e.parent.lf_left+=i),e=e.parent}}const Yl=65535;function M$(o){let e;return o[o.length-1]<65536?e=new Uint16Array(o.length):e=new Uint32Array(o.length),e.set(o,0),e}class Ude{constructor(e,t,i,n,s){this.lineStarts=e,this.cr=t,this.lf=i,this.crlf=n,this.isBasicASCII=s}}function nc(o,e=!0){const t=[0];let i=1;for(let n=0,s=o.length;n<s;n++){const r=o.charCodeAt(n);r===13?n+1<s&&o.charCodeAt(n+1)===10?(t[i++]=n+2,n++):t[i++]=n+1:r===10&&(t[i++]=n+1)}return e?M$(t):t}function Gde(o,e){o.length=0,o[0]=0;let t=1,i=0,n=0,s=0,r=!0;for(let l=0,c=e.length;l<c;l++){const d=e.charCodeAt(l);d===13?l+1<c&&e.charCodeAt(l+1)===10?(s++,o[t++]=l+2,l++):(i++,o[t++]=l+1):d===10?(n++,o[t++]=l+1):r&&d!==9&&(d<32||d>126)&&(r=!1)}const a=new Ude(M$(o),i,n,s,r);return o.length=0,a}class zs{constructor(e,t,i,n,s){this.bufferIndex=e,this.start=t,this.end=i,this.lineFeedCnt=n,this.length=s}}class Bu{constructor(e,t){this.buffer=e,this.lineStarts=t}}class $de{constructor(e,t){this._pieces=[],this._tree=e,this._BOM=t,this._index=0,e.root!==We&&e.iterate(e.root,i=>(i!==We&&this._pieces.push(i.piece),!0))}read(){return this._pieces.length===0?this._index===0?(this._index++,this._BOM):null:this._index>this._pieces.length-1?null:this._index===0?this._BOM+this._tree.getPieceContent(this._pieces[this._index++]):this._tree.getPieceContent(this._pieces[this._index++])}}class Kde{constructor(e){this._limit=e,this._cache=[]}get(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartOffset<=e&&i.nodeStartOffset+i.node.piece.length>=e)return i}return null}get2(e){for(let t=this._cache.length-1;t>=0;t--){const i=this._cache[t];if(i.nodeStartLineNumber&&i.nodeStartLineNumber<e&&i.nodeStartLineNumber+i.node.piece.lineFeedCnt>=e)return i}return null}set(e){this._cache.length>=this._limit&&this._cache.shift(),this._cache.push(e)}validate(e){let t=!1;const i=this._cache;for(let n=0;n<i.length;n++){const s=i[n];if(s.node.parent===null||s.nodeStartOffset>=e){i[n]=null,t=!0;continue}}if(t){const n=[];for(const s of i)s!==null&&n.push(s);this._cache=n}}}class jde{constructor(e,t,i){this.create(e,t,i)}create(e,t,i){this._buffers=[new Bu("",[0])],this._lastChangeBufferPos={line:0,column:0},this.root=We,this._lineCnt=1,this._length=0,this._EOL=t,this._EOLLength=t.length,this._EOLNormalized=i;let n=null;for(let s=0,r=e.length;s<r;s++)if(e[s].buffer.length>0){e[s].lineStarts||(e[s].lineStarts=nc(e[s].buffer));const a=new zs(s+1,{line:0,column:0},{line:e[s].lineStarts.length-1,column:e[s].buffer.length-e[s].lineStarts[e[s].lineStarts.length-1]},e[s].lineStarts.length-1,e[s].buffer.length);this._buffers.push(e[s]),n=this.rbInsertRight(n,a)}this._searchCache=new Kde(1),this._lastVisitedLine={lineNumber:0,value:""},this.computeBufferMetadata()}normalizeEOL(e){const t=Yl,i=t-Math.floor(t/3),n=i*2;let s="",r=0;const a=[];if(this.iterate(this.root,l=>{const c=this.getNodeContent(l),d=c.length;if(r<=i||r+d<n)return s+=c,r+=d,!0;const h=s.replace(/\r\n|\r|\n/g,e);return a.push(new Bu(h,nc(h))),s=c,r=d,!0}),r>0){const l=s.replace(/\r\n|\r|\n/g,e);a.push(new Bu(l,nc(l)))}this.create(a,e,!0)}getEOL(){return this._EOL}setEOL(e){this._EOL=e,this._EOLLength=this._EOL.length,this.normalizeEOL(e)}createSnapshot(e){return new $de(this,e)}getOffsetAt(e,t){let i=0,n=this.root;for(;n!==We;)if(n.left!==We&&n.lf_left+1>=e)n=n.left;else if(n.lf_left+n.piece.lineFeedCnt+1>=e){i+=n.size_left;const s=this.getAccumulatedValue(n,e-n.lf_left-2);return i+=s+t-1}else e-=n.lf_left+n.piece.lineFeedCnt,i+=n.size_left+n.piece.length,n=n.right;return i}getPositionAt(e){e=Math.floor(e),e=Math.max(0,e);let t=this.root,i=0;const n=e;for(;t!==We;)if(t.size_left!==0&&t.size_left>=e)t=t.left;else if(t.size_left+t.piece.length>=e){const s=this.getIndexOf(t,e-t.size_left);if(i+=t.lf_left+s.index,s.index===0){const r=this.getOffsetAt(i+1,1),a=n-r;return new A(i+1,a+1)}return new A(i+1,s.remainder+1)}else if(e-=t.size_left+t.piece.length,i+=t.lf_left+t.piece.lineFeedCnt,t.right===We){const s=this.getOffsetAt(i+1,1),r=n-e-s;return new A(i+1,r+1)}else t=t.right;return new A(1,1)}getValueInRange(e,t){if(e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn)return"";const i=this.nodeAt2(e.startLineNumber,e.startColumn),n=this.nodeAt2(e.endLineNumber,e.endColumn),s=this.getValueInRange2(i,n);return t?t!==this._EOL||!this._EOLNormalized?s.replace(/\r\n|\r|\n/g,t):t===this.getEOL()&&this._EOLNormalized?s:s.replace(/\r\n|\r|\n/g,t):s}getValueInRange2(e,t){if(e.node===t.node){const a=e.node,l=this._buffers[a.piece.bufferIndex].buffer,c=this.offsetInBuffer(a.piece.bufferIndex,a.piece.start);return l.substring(c+e.remainder,c+t.remainder)}let i=e.node;const n=this._buffers[i.piece.bufferIndex].buffer,s=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);let r=n.substring(s+e.remainder,s+i.piece.length);for(i=i.next();i!==We;){const a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(i===t.node){r+=a.substring(l,l+t.remainder);break}else r+=a.substr(l,i.piece.length);i=i.next()}return r}getLinesContent(){const e=[];let t=0,i="",n=!1;return this.iterate(this.root,s=>{if(s===We)return!0;const r=s.piece;let a=r.length;if(a===0)return!0;const l=this._buffers[r.bufferIndex].buffer,c=this._buffers[r.bufferIndex].lineStarts,d=r.start.line,h=r.end.line;let u=c[d]+r.start.column;if(n&&(l.charCodeAt(u)===10&&(u++,a--),e[t++]=i,i="",n=!1,a===0))return!0;if(d===h)return!this._EOLNormalized&&l.charCodeAt(u+a-1)===13?(n=!0,i+=l.substr(u,a-1)):i+=l.substr(u,a),!0;i+=this._EOLNormalized?l.substring(u,Math.max(u,c[d+1]-this._EOLLength)):l.substring(u,c[d+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;for(let g=d+1;g<h;g++)i=this._EOLNormalized?l.substring(c[g],c[g+1]-this._EOLLength):l.substring(c[g],c[g+1]).replace(/(\r\n|\r|\n)$/,""),e[t++]=i;return!this._EOLNormalized&&l.charCodeAt(c[h]+r.end.column-1)===13?(n=!0,r.end.column===0?t--:i=l.substr(c[h],r.end.column-1)):i=l.substr(c[h],r.end.column),!0}),n&&(e[t++]=i,i=""),e[t++]=i,e}getLength(){return this._length}getLineCount(){return this._lineCnt}getLineContent(e){return this._lastVisitedLine.lineNumber===e?this._lastVisitedLine.value:(this._lastVisitedLine.lineNumber=e,e===this._lineCnt?this._lastVisitedLine.value=this.getLineRawContent(e):this._EOLNormalized?this._lastVisitedLine.value=this.getLineRawContent(e,this._EOLLength):this._lastVisitedLine.value=this.getLineRawContent(e).replace(/(\r\n|\r|\n)$/,""),this._lastVisitedLine.value)}_getCharCode(e){if(e.remainder===e.node.piece.length){const t=e.node.next();if(!t)return 0;const i=this._buffers[t.piece.bufferIndex],n=this.offsetInBuffer(t.piece.bufferIndex,t.piece.start);return i.buffer.charCodeAt(n)}else{const t=this._buffers[e.node.piece.bufferIndex],n=this.offsetInBuffer(e.node.piece.bufferIndex,e.node.piece.start)+e.remainder;return t.buffer.charCodeAt(n)}}getLineCharCode(e,t){const i=this.nodeAt2(e,t+1);return this._getCharCode(i)}getLineLength(e){if(e===this.getLineCount()){const t=this.getOffsetAt(e,1);return this.getLength()-t}return this.getOffsetAt(e+1,1)-this.getOffsetAt(e,1)-this._EOLLength}findMatchesInNode(e,t,i,n,s,r,a,l,c,d,h){const u=this._buffers[e.piece.bufferIndex],g=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start),f=this.offsetInBuffer(e.piece.bufferIndex,s),m=this.offsetInBuffer(e.piece.bufferIndex,r);let _;const b={line:0,column:0};let v,y;t._wordSeparators?(v=u.buffer.substring(f,m),y=C=>C+f,t.reset(0)):(v=u.buffer,y=C=>C,t.reset(f));do if(_=t.next(v),_){if(y(_.index)>=m)return d;this.positionInBuffer(e,y(_.index)-g,b);const C=this.getLineFeedCnt(e.piece.bufferIndex,s,b),w=b.line===s.line?b.column-s.column+n:b.column+1,x=w+_[0].length;if(h[d++]=Ru(new L(i+C,w,i+C,x),_,l),y(_.index)+_[0].length>=m||d>=c)return d}while(_);return d}findMatchesLineByLine(e,t,i,n){const s=[];let r=0;const a=new jp(t.wordSeparators,t.regex);let l=this.nodeAt2(e.startLineNumber,e.startColumn);if(l===null)return[];const c=this.nodeAt2(e.endLineNumber,e.endColumn);if(c===null)return[];let d=this.positionInBuffer(l.node,l.remainder);const h=this.positionInBuffer(c.node,c.remainder);if(l.node===c.node)return this.findMatchesInNode(l.node,a,e.startLineNumber,e.startColumn,d,h,t,i,n,r,s),s;let u=e.startLineNumber,g=l.node;for(;g!==c.node;){const m=this.getLineFeedCnt(g.piece.bufferIndex,d,g.piece.end);if(m>=1){const b=this._buffers[g.piece.bufferIndex].lineStarts,v=this.offsetInBuffer(g.piece.bufferIndex,g.piece.start),y=b[d.line+m],C=u===e.startLineNumber?e.startColumn:1;if(r=this.findMatchesInNode(g,a,u,C,d,this.positionInBuffer(g,y-v),t,i,n,r,s),r>=n)return s;u+=m}const _=u===e.startLineNumber?e.startColumn-1:0;if(u===e.endLineNumber){const b=this.getLineContent(u).substring(_,e.endColumn-1);return r=this._findMatchesInLine(t,a,b,e.endLineNumber,_,r,s,i,n),s}if(r=this._findMatchesInLine(t,a,this.getLineContent(u).substr(_),u,_,r,s,i,n),r>=n)return s;u++,l=this.nodeAt2(u,1),g=l.node,d=this.positionInBuffer(l.node,l.remainder)}if(u===e.endLineNumber){const m=u===e.startLineNumber?e.startColumn-1:0,_=this.getLineContent(u).substring(m,e.endColumn-1);return r=this._findMatchesInLine(t,a,_,e.endLineNumber,m,r,s,i,n),s}const f=u===e.startLineNumber?e.startColumn:1;return r=this.findMatchesInNode(c.node,a,u,f,d,h,t,i,n,r,s),s}_findMatchesInLine(e,t,i,n,s,r,a,l,c){const d=e.wordSeparators;if(!l&&e.simpleSearch){const u=e.simpleSearch,g=u.length,f=i.length;let m=-g;for(;(m=i.indexOf(u,m+g))!==-1;)if((!d||X4(d,i,f,m,g))&&(a[r++]=new QC(new L(n,m+1+s,n,m+1+g+s),null),r>=c))return r;return r}let h;t.reset(0);do if(h=t.next(i),h&&(a[r++]=Ru(new L(n,h.index+1+s,n,h.index+1+h[0].length+s),h,l),r>=c))return r;while(h);return r}insert(e,t,i=!1){if(this._EOLNormalized=this._EOLNormalized&&i,this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",this.root!==We){const{node:n,remainder:s,nodeStartOffset:r}=this.nodeAt(e),a=n.piece,l=a.bufferIndex,c=this.positionInBuffer(n,s);if(n.piece.bufferIndex===0&&a.end.line===this._lastChangeBufferPos.line&&a.end.column===this._lastChangeBufferPos.column&&r+a.length===e&&t.length<Yl){this.appendToNode(n,t),this.computeBufferMetadata();return}if(r===e)this.insertContentToNodeLeft(t,n),this._searchCache.validate(e);else if(r+n.piece.length>e){const d=[];let h=new zs(a.bufferIndex,c,a.end,this.getLineFeedCnt(a.bufferIndex,c,a.end),this.offsetInBuffer(l,a.end)-this.offsetInBuffer(l,c));if(this.shouldCheckCRLF()&&this.endWithCR(t)&&this.nodeCharCodeAt(n,s)===10){const m={line:h.start.line+1,column:0};h=new zs(h.bufferIndex,m,h.end,this.getLineFeedCnt(h.bufferIndex,m,h.end),h.length-1),t+=`
`}if(this.shouldCheckCRLF()&&this.startWithLF(t))if(this.nodeCharCodeAt(n,s-1)===13){const m=this.positionInBuffer(n,s-1);this.deleteNodeTail(n,m),t="\r"+t,n.piece.length===0&&d.push(n)}else this.deleteNodeTail(n,c);else this.deleteNodeTail(n,c);const u=this.createNewPieces(t);h.length>0&&this.rbInsertRight(n,h);let g=n;for(let f=0;f<u.length;f++)g=this.rbInsertRight(g,u[f]);this.deleteNodes(d)}else this.insertContentToNodeRight(t,n)}else{const n=this.createNewPieces(t);let s=this.rbInsertLeft(null,n[0]);for(let r=1;r<n.length;r++)s=this.rbInsertRight(s,n[r])}this.computeBufferMetadata()}delete(e,t){if(this._lastVisitedLine.lineNumber=0,this._lastVisitedLine.value="",t<=0||this.root===We)return;const i=this.nodeAt(e),n=this.nodeAt(e+t),s=i.node,r=n.node;if(s===r){const u=this.positionInBuffer(s,i.remainder),g=this.positionInBuffer(s,n.remainder);if(i.nodeStartOffset===e){if(t===s.piece.length){const f=s.next();VS(this,s),this.validateCRLFWithPrevNode(f),this.computeBufferMetadata();return}this.deleteNodeHead(s,g),this._searchCache.validate(e),this.validateCRLFWithPrevNode(s),this.computeBufferMetadata();return}if(i.nodeStartOffset+s.piece.length===e+t){this.deleteNodeTail(s,u),this.validateCRLFWithNextNode(s),this.computeBufferMetadata();return}this.shrinkNode(s,u,g),this.computeBufferMetadata();return}const a=[],l=this.positionInBuffer(s,i.remainder);this.deleteNodeTail(s,l),this._searchCache.validate(e),s.piece.length===0&&a.push(s);const c=this.positionInBuffer(r,n.remainder);this.deleteNodeHead(r,c),r.piece.length===0&&a.push(r);const d=s.next();for(let u=d;u!==We&&u!==r;u=u.next())a.push(u);const h=s.piece.length===0?s.prev():s;this.deleteNodes(a),this.validateCRLFWithNextNode(h),this.computeBufferMetadata()}insertContentToNodeLeft(e,t){const i=[];if(this.shouldCheckCRLF()&&this.endWithCR(e)&&this.startWithLF(t)){const r=t.piece,a={line:r.start.line+1,column:0},l=new zs(r.bufferIndex,a,r.end,this.getLineFeedCnt(r.bufferIndex,a,r.end),r.length-1);t.piece=l,e+=`
`,ic(this,t,-1,-1),t.piece.length===0&&i.push(t)}const n=this.createNewPieces(e);let s=this.rbInsertLeft(t,n[n.length-1]);for(let r=n.length-2;r>=0;r--)s=this.rbInsertLeft(s,n[r]);this.validateCRLFWithPrevNode(s),this.deleteNodes(i)}insertContentToNodeRight(e,t){this.adjustCarriageReturnFromNext(e,t)&&(e+=`
`);const i=this.createNewPieces(e),n=this.rbInsertRight(t,i[0]);let s=n;for(let r=1;r<i.length;r++)s=this.rbInsertRight(s,i[r]);this.validateCRLFWithPrevNode(n)}positionInBuffer(e,t,i){const n=e.piece,s=e.piece.bufferIndex,r=this._buffers[s].lineStarts,l=r[n.start.line]+n.start.column+t;let c=n.start.line,d=n.end.line,h=0,u=0,g=0;for(;c<=d&&(h=c+(d-c)/2|0,g=r[h],h!==d);)if(u=r[h+1],l<g)d=h-1;else if(l>=u)c=h+1;else break;return i?(i.line=h,i.column=l-g,null):{line:h,column:l-g}}getLineFeedCnt(e,t,i){if(i.column===0)return i.line-t.line;const n=this._buffers[e].lineStarts;if(i.line===n.length-1)return i.line-t.line;const s=n[i.line+1],r=n[i.line]+i.column;if(s>r+1)return i.line-t.line;const a=r-1;return this._buffers[e].buffer.charCodeAt(a)===13?i.line-t.line+1:i.line-t.line}offsetInBuffer(e,t){return this._buffers[e].lineStarts[t.line]+t.column}deleteNodes(e){for(let t=0;t<e.length;t++)VS(this,e[t])}createNewPieces(e){if(e.length>Yl){const d=[];for(;e.length>Yl;){const u=e.charCodeAt(Yl-1);let g;u===13||u>=55296&&u<=56319?(g=e.substring(0,Yl-1),e=e.substring(Yl-1)):(g=e.substring(0,Yl),e=e.substring(Yl));const f=nc(g);d.push(new zs(this._buffers.length,{line:0,column:0},{line:f.length-1,column:g.length-f[f.length-1]},f.length-1,g.length)),this._buffers.push(new Bu(g,f))}const h=nc(e);return d.push(new zs(this._buffers.length,{line:0,column:0},{line:h.length-1,column:e.length-h[h.length-1]},h.length-1,e.length)),this._buffers.push(new Bu(e,h)),d}let t=this._buffers[0].buffer.length;const i=nc(e,!1);let n=this._lastChangeBufferPos;if(this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-1]===t&&t!==0&&this.startWithLF(e)&&this.endWithCR(this._buffers[0].buffer)){this._lastChangeBufferPos={line:this._lastChangeBufferPos.line,column:this._lastChangeBufferPos.column+1},n=this._lastChangeBufferPos;for(let d=0;d<i.length;d++)i[d]+=t+1;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+="_"+e,t+=1}else{if(t!==0)for(let d=0;d<i.length;d++)i[d]+=t;this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(i.slice(1)),this._buffers[0].buffer+=e}const s=this._buffers[0].buffer.length,r=this._buffers[0].lineStarts.length-1,a=s-this._buffers[0].lineStarts[r],l={line:r,column:a},c=new zs(0,n,l,this.getLineFeedCnt(0,n,l),s-t);return this._lastChangeBufferPos=l,[c]}getLineRawContent(e,t=0){let i=this.root,n="";const s=this._searchCache.get2(e);if(s){i=s.node;const r=this.getAccumulatedValue(i,e-s.nodeStartLineNumber-1),a=this._buffers[i.piece.bufferIndex].buffer,l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);if(s.nodeStartLineNumber+i.piece.lineFeedCnt===e)n=a.substring(l+r,l+i.piece.length);else{const c=this.getAccumulatedValue(i,e-s.nodeStartLineNumber);return a.substring(l+r,l+c-t)}}else{let r=0;const a=e;for(;i!==We;)if(i.left!==We&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this.getAccumulatedValue(i,e-i.lf_left-1),d=this._buffers[i.piece.bufferIndex].buffer,h=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return r+=i.size_left,this._searchCache.set({node:i,nodeStartOffset:r,nodeStartLineNumber:a-(e-1-i.lf_left)}),d.substring(h+l,h+c-t)}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const l=this.getAccumulatedValue(i,e-i.lf_left-2),c=this._buffers[i.piece.bufferIndex].buffer,d=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n=c.substring(d+l,d+i.piece.length);break}else e-=i.lf_left+i.piece.lineFeedCnt,r+=i.size_left+i.piece.length,i=i.right}for(i=i.next();i!==We;){const r=this._buffers[i.piece.bufferIndex].buffer;if(i.piece.lineFeedCnt>0){const a=this.getAccumulatedValue(i,0),l=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);return n+=r.substring(l,l+a-t),n}else{const a=this.offsetInBuffer(i.piece.bufferIndex,i.piece.start);n+=r.substr(a,i.piece.length)}i=i.next()}return n}computeBufferMetadata(){let e=this.root,t=1,i=0;for(;e!==We;)t+=e.lf_left+e.piece.lineFeedCnt,i+=e.size_left+e.piece.length,e=e.right;this._lineCnt=t,this._length=i,this._searchCache.validate(this._length)}getIndexOf(e,t){const i=e.piece,n=this.positionInBuffer(e,t),s=n.line-i.start.line;if(this.offsetInBuffer(i.bufferIndex,i.end)-this.offsetInBuffer(i.bufferIndex,i.start)===t){const r=this.getLineFeedCnt(e.piece.bufferIndex,i.start,n);if(r!==s)return{index:r,remainder:0}}return{index:s,remainder:n.column}}getAccumulatedValue(e,t){if(t<0)return 0;const i=e.piece,n=this._buffers[i.bufferIndex].lineStarts,s=i.start.line+t+1;return s>i.end.line?n[i.end.line]+i.end.column-n[i.start.line]-i.start.column:n[s]-n[i.start.line]-i.start.column}deleteNodeTail(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.end),r=t,a=this.offsetInBuffer(i.bufferIndex,r),l=this.getLineFeedCnt(i.bufferIndex,i.start,r),c=l-n,d=a-s,h=i.length+d;e.piece=new zs(i.bufferIndex,i.start,r,l,h),ic(this,e,d,c)}deleteNodeHead(e,t){const i=e.piece,n=i.lineFeedCnt,s=this.offsetInBuffer(i.bufferIndex,i.start),r=t,a=this.getLineFeedCnt(i.bufferIndex,r,i.end),l=this.offsetInBuffer(i.bufferIndex,r),c=a-n,d=s-l,h=i.length+d;e.piece=new zs(i.bufferIndex,r,i.end,a,h),ic(this,e,d,c)}shrinkNode(e,t,i){const n=e.piece,s=n.start,r=n.end,a=n.length,l=n.lineFeedCnt,c=t,d=this.getLineFeedCnt(n.bufferIndex,n.start,c),h=this.offsetInBuffer(n.bufferIndex,t)-this.offsetInBuffer(n.bufferIndex,s);e.piece=new zs(n.bufferIndex,n.start,c,d,h),ic(this,e,h-a,d-l);const u=new zs(n.bufferIndex,i,r,this.getLineFeedCnt(n.bufferIndex,i,r),this.offsetInBuffer(n.bufferIndex,r)-this.offsetInBuffer(n.bufferIndex,i)),g=this.rbInsertRight(e,u);this.validateCRLFWithPrevNode(g)}appendToNode(e,t){this.adjustCarriageReturnFromNext(t,e)&&(t+=`
`);const i=this.shouldCheckCRLF()&&this.startWithLF(t)&&this.endWithCR(e),n=this._buffers[0].buffer.length;this._buffers[0].buffer+=t;const s=nc(t,!1);for(let g=0;g<s.length;g++)s[g]+=n;if(i){const g=this._buffers[0].lineStarts[this._buffers[0].lineStarts.length-2];this._buffers[0].lineStarts.pop(),this._lastChangeBufferPos={line:this._lastChangeBufferPos.line-1,column:n-g}}this._buffers[0].lineStarts=this._buffers[0].lineStarts.concat(s.slice(1));const r=this._buffers[0].lineStarts.length-1,a=this._buffers[0].buffer.length-this._buffers[0].lineStarts[r],l={line:r,column:a},c=e.piece.length+t.length,d=e.piece.lineFeedCnt,h=this.getLineFeedCnt(0,e.piece.start,l),u=h-d;e.piece=new zs(e.piece.bufferIndex,e.piece.start,l,h,c),this._lastChangeBufferPos=l,ic(this,e,t.length,u)}nodeAt(e){let t=this.root;const i=this._searchCache.get(e);if(i)return{node:i.node,nodeStartOffset:i.nodeStartOffset,remainder:e-i.nodeStartOffset};let n=0;for(;t!==We;)if(t.size_left>e)t=t.left;else if(t.size_left+t.piece.length>=e){n+=t.size_left;const s={node:t,remainder:e-t.size_left,nodeStartOffset:n};return this._searchCache.set(s),s}else e-=t.size_left+t.piece.length,n+=t.size_left+t.piece.length,t=t.right;return null}nodeAt2(e,t){let i=this.root,n=0;for(;i!==We;)if(i.left!==We&&i.lf_left>=e-1)i=i.left;else if(i.lf_left+i.piece.lineFeedCnt>e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2),r=this.getAccumulatedValue(i,e-i.lf_left-1);return n+=i.size_left,{node:i,remainder:Math.min(s+t-1,r),nodeStartOffset:n}}else if(i.lf_left+i.piece.lineFeedCnt===e-1){const s=this.getAccumulatedValue(i,e-i.lf_left-2);if(s+t-1<=i.piece.length)return{node:i,remainder:s+t-1,nodeStartOffset:n};t-=i.piece.length-s;break}else e-=i.lf_left+i.piece.lineFeedCnt,n+=i.size_left+i.piece.length,i=i.right;for(i=i.next();i!==We;){if(i.piece.lineFeedCnt>0){const s=this.getAccumulatedValue(i,0),r=this.offsetOfNode(i);return{node:i,remainder:Math.min(t-1,s),nodeStartOffset:r}}else if(i.piece.length>=t-1){const s=this.offsetOfNode(i);return{node:i,remainder:t-1,nodeStartOffset:s}}else t-=i.piece.length;i=i.next()}return null}nodeCharCodeAt(e,t){if(e.piece.lineFeedCnt<1)return-1;const i=this._buffers[e.piece.bufferIndex],n=this.offsetInBuffer(e.piece.bufferIndex,e.piece.start)+t;return i.buffer.charCodeAt(n)}offsetOfNode(e){if(!e)return 0;let t=e.size_left;for(;e!==this.root;)e.parent.right===e&&(t+=e.parent.size_left+e.parent.piece.length),e=e.parent;return t}shouldCheckCRLF(){return!(this._EOLNormalized&&this._EOL===`
`)}startWithLF(e){if(typeof e=="string")return e.charCodeAt(0)===10;if(e===We||e.piece.lineFeedCnt===0)return!1;const t=e.piece,i=this._buffers[t.bufferIndex].lineStarts,n=t.start.line,s=i[n]+t.start.column;return n===i.length-1||i[n+1]>s+1?!1:this._buffers[t.bufferIndex].buffer.charCodeAt(s)===10}endWithCR(e){return typeof e=="string"?e.charCodeAt(e.length-1)===13:e===We||e.piece.lineFeedCnt===0?!1:this.nodeCharCodeAt(e,e.piece.length-1)===13}validateCRLFWithPrevNode(e){if(this.shouldCheckCRLF()&&this.startWithLF(e)){const t=e.prev();this.endWithCR(t)&&this.fixCRLF(t,e)}}validateCRLFWithNextNode(e){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const t=e.next();this.startWithLF(t)&&this.fixCRLF(e,t)}}fixCRLF(e,t){const i=[],n=this._buffers[e.piece.bufferIndex].lineStarts;let s;e.piece.end.column===0?s={line:e.piece.end.line-1,column:n[e.piece.end.line]-n[e.piece.end.line-1]-1}:s={line:e.piece.end.line,column:e.piece.end.column-1};const r=e.piece.length-1,a=e.piece.lineFeedCnt-1;e.piece=new zs(e.piece.bufferIndex,e.piece.start,s,a,r),ic(this,e,-1,-1),e.piece.length===0&&i.push(e);const l={line:t.piece.start.line+1,column:0},c=t.piece.length-1,d=this.getLineFeedCnt(t.piece.bufferIndex,l,t.piece.end);t.piece=new zs(t.piece.bufferIndex,l,t.piece.end,d,c),ic(this,t,-1,-1),t.piece.length===0&&i.push(t);const h=this.createNewPieces(`\r
`);this.rbInsertRight(e,h[0]);for(let u=0;u<i.length;u++)VS(this,i[u])}adjustCarriageReturnFromNext(e,t){if(this.shouldCheckCRLF()&&this.endWithCR(e)){const i=t.next();if(this.startWithLF(i)){if(e+=`
`,i.piece.length===1)VS(this,i);else{const n=i.piece,s={line:n.start.line+1,column:0},r=n.length-1,a=this.getLineFeedCnt(n.bufferIndex,s,n.end);i.piece=new zs(n.bufferIndex,s,n.end,a,r),ic(this,i,-1,-1)}return!0}}return!1}iterate(e,t){if(e===We)return t(We);const i=this.iterate(e.left,t);return i&&t(e)&&this.iterate(e.right,t)}getNodeContent(e){if(e===We)return"";const t=this._buffers[e.piece.bufferIndex],i=e.piece,n=this.offsetInBuffer(i.bufferIndex,i.start),s=this.offsetInBuffer(i.bufferIndex,i.end);return t.buffer.substring(n,s)}getPieceContent(e){const t=this._buffers[e.bufferIndex],i=this.offsetInBuffer(e.bufferIndex,e.start),n=this.offsetInBuffer(e.bufferIndex,e.end);return t.buffer.substring(i,n)}rbInsertRight(e,t){const i=new GA(t,1);if(i.left=We,i.right=We,i.parent=We,i.size_left=0,i.lf_left=0,this.root===We)this.root=i,i.color=0;else if(e.right===We)e.right=i,i.parent=e;else{const s=q5(e.right);s.left=i,i.parent=s}return o7(this,i),i}rbInsertLeft(e,t){const i=new GA(t,1);if(i.left=We,i.right=We,i.parent=We,i.size_left=0,i.lf_left=0,this.root===We)this.root=i,i.color=0;else if(e.left===We)e.left=i,i.parent=e;else{const n=A$(e.left);n.right=i,i.parent=n}return o7(this,i),i}}class zm extends F{constructor(e,t,i,n,s,r,a){super(),this._onDidChangeContent=this._register(new O),this._BOM=t,this._mightContainNonBasicASCII=!r,this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._pieceTree=new jde(e,i,a)}mightContainRTL(){return this._mightContainRTL}mightContainUnusualLineTerminators(){return this._mightContainUnusualLineTerminators}resetMightContainUnusualLineTerminators(){this._mightContainUnusualLineTerminators=!1}mightContainNonBasicASCII(){return this._mightContainNonBasicASCII}getBOM(){return this._BOM}getEOL(){return this._pieceTree.getEOL()}createSnapshot(e){return this._pieceTree.createSnapshot(e?this._BOM:"")}getOffsetAt(e,t){return this._pieceTree.getOffsetAt(e,t)}getPositionAt(e){return this._pieceTree.getPositionAt(e)}getRangeAt(e,t){const i=e+t,n=this.getPositionAt(e),s=this.getPositionAt(i);return new L(n.lineNumber,n.column,s.lineNumber,s.column)}getValueInRange(e,t=0){if(e.isEmpty())return"";const i=this._getEndOfLine(t);return this._pieceTree.getValueInRange(e,i)}getValueLengthInRange(e,t=0){if(e.isEmpty())return 0;if(e.startLineNumber===e.endLineNumber)return e.endColumn-e.startColumn;const i=this.getOffsetAt(e.startLineNumber,e.startColumn),n=this.getOffsetAt(e.endLineNumber,e.endColumn);let s=0;const r=this._getEndOfLine(t),a=this.getEOL();if(r.length!==a.length){const l=r.length-a.length,c=e.endLineNumber-e.startLineNumber;s=l*c}return n-i+s}getCharacterCountInRange(e,t=0){if(this._mightContainNonBasicASCII){let i=0;const n=e.startLineNumber,s=e.endLineNumber;for(let r=n;r<=s;r++){const a=this.getLineContent(r),l=r===n?e.startColumn-1:0,c=r===s?e.endColumn-1:a.length;for(let d=l;d<c;d++)$i(a.charCodeAt(d))?(i=i+1,d=d+1):i=i+1}return i+=this._getEndOfLine(t).length*(s-n),i}return this.getValueLengthInRange(e,t)}getLength(){return this._pieceTree.getLength()}getLineCount(){return this._pieceTree.getLineCount()}getLinesContent(){return this._pieceTree.getLinesContent()}getLineContent(e){return this._pieceTree.getLineContent(e)}getLineCharCode(e,t){return this._pieceTree.getLineCharCode(e,t)}getLineLength(e){return this._pieceTree.getLineLength(e)}getLineFirstNonWhitespaceColumn(e){const t=Xn(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Sa(this.getLineContent(e));return t===-1?0:t+2}_getEndOfLine(e){switch(e){case 1:return`
`;case 2:return`\r
`;case 0:return this.getEOL();default:throw new Error("Unknown EOL preference")}}setEOL(e){this._pieceTree.setEOL(e)}applyEdits(e,t,i){let n=this._mightContainRTL,s=this._mightContainUnusualLineTerminators,r=this._mightContainNonBasicASCII,a=!0,l=[];for(let m=0;m<e.length;m++){const _=e[m];a&&_._isTracked&&(a=!1);const b=_.range;if(_.text){let x=!0;r||(x=!Sw(_.text),r=x),!n&&x&&(n=p_(_.text)),!s&&x&&(s=Tz(_.text))}let v="",y=0,C=0,w=0;if(_.text){let x;[y,C,w,x]=Mh(_.text);const k=this.getEOL();x===0||x===(k===`\r
`?2:1)?v=_.text:v=_.text.replace(/\r\n|\r|\n/g,k)}l[m]={sortIndex:m,identifier:_.identifier||null,range:b,rangeOffset:this.getOffsetAt(b.startLineNumber,b.startColumn),rangeLength:this.getValueLengthInRange(b),text:v,eolCount:y,firstLineLength:C,lastLineLength:w,forceMoveMarkers:!!_.forceMoveMarkers,isAutoWhitespaceEdit:_.isAutoWhitespaceEdit||!1}}l.sort(zm._sortOpsAscending);let c=!1;for(let m=0,_=l.length-1;m<_;m++){const b=l[m].range.getEndPosition(),v=l[m+1].range.getStartPosition();if(v.isBeforeOrEqual(b)){if(v.isBefore(b))throw new Error("Overlapping ranges are not allowed!");c=!0}}a&&(l=this._reduceOperations(l));const d=i||t?zm._getInverseEditRanges(l):[],h=[];if(t)for(let m=0;m<l.length;m++){const _=l[m],b=d[m];if(_.isAutoWhitespaceEdit&&_.range.isEmpty())for(let v=b.startLineNumber;v<=b.endLineNumber;v++){let y="";v===b.startLineNumber&&(y=this.getLineContent(_.range.startLineNumber),Xn(y)!==-1)||h.push({lineNumber:v,oldContent:y})}}let u=null;if(i){let m=0;u=[];for(let _=0;_<l.length;_++){const b=l[_],v=d[_],y=this.getValueInRange(b.range),C=b.rangeOffset+m;m+=b.text.length-y.length,u[_]={sortIndex:b.sortIndex,identifier:b.identifier,range:v,text:y,textChange:new wn(b.rangeOffset,y,C,b.text)}}c||u.sort((_,b)=>_.sortIndex-b.sortIndex)}this._mightContainRTL=n,this._mightContainUnusualLineTerminators=s,this._mightContainNonBasicASCII=r;const g=this._doApplyEdits(l);let f=null;if(t&&h.length>0){h.sort((m,_)=>_.lineNumber-m.lineNumber),f=[];for(let m=0,_=h.length;m<_;m++){const b=h[m].lineNumber;if(m>0&&h[m-1].lineNumber===b)continue;const v=h[m].oldContent,y=this.getLineContent(b);y.length===0||y===v||Xn(y)!==-1||f.push(b)}}return this._onDidChangeContent.fire(),new sie(u,g,f)}_reduceOperations(e){return e.length<1e3?e:[this._toSingleEditOperation(e)]}_toSingleEditOperation(e){let t=!1;const i=e[0].range,n=e[e.length-1].range,s=new L(i.startLineNumber,i.startColumn,n.endLineNumber,n.endColumn);let r=i.startLineNumber,a=i.startColumn;const l=[];for(let g=0,f=e.length;g<f;g++){const m=e[g],_=m.range;t=t||m.forceMoveMarkers,l.push(this.getValueInRange(new L(r,a,_.startLineNumber,_.startColumn))),m.text.length>0&&l.push(m.text),r=_.endLineNumber,a=_.endColumn}const c=l.join(""),[d,h,u]=Mh(c);return{sortIndex:0,identifier:e[0].identifier,range:s,rangeOffset:this.getOffsetAt(s.startLineNumber,s.startColumn),rangeLength:this.getValueLengthInRange(s,0),text:c,eolCount:d,firstLineLength:h,lastLineLength:u,forceMoveMarkers:t,isAutoWhitespaceEdit:!1}}_doApplyEdits(e){e.sort(zm._sortOpsDescending);const t=[];for(let i=0;i<e.length;i++){const n=e[i],s=n.range.startLineNumber,r=n.range.startColumn,a=n.range.endLineNumber,l=n.range.endColumn;if(s===a&&r===l&&n.text.length===0)continue;n.text?(this._pieceTree.delete(n.rangeOffset,n.rangeLength),this._pieceTree.insert(n.rangeOffset,n.text,!0)):this._pieceTree.delete(n.rangeOffset,n.rangeLength);const c=new L(s,r,a,l);t.push({range:c,rangeLength:n.rangeLength,text:n.text,rangeOffset:n.rangeOffset,forceMoveMarkers:n.forceMoveMarkers})}return t}findMatchesLineByLine(e,t,i,n){return this._pieceTree.findMatchesLineByLine(e,t,i,n)}static _getInverseEditRanges(e){const t=[];let i=0,n=0,s=null;for(let r=0,a=e.length;r<a;r++){const l=e[r];let c,d;s?s.range.endLineNumber===l.range.startLineNumber?(c=i,d=n+(l.range.startColumn-s.range.endColumn)):(c=i+(l.range.startLineNumber-s.range.endLineNumber),d=l.range.startColumn):(c=l.range.startLineNumber,d=l.range.startColumn);let h;if(l.text.length>0){const u=l.eolCount+1;u===1?h=new L(c,d,c,d+l.firstLineLength):h=new L(c,d,c+u-1,l.lastLineLength+1)}else h=new L(c,d,c,d);i=h.endLineNumber,n=h.endColumn,t.push(h),s=l}return t}static _sortOpsAscending(e,t){const i=L.compareRangesUsingEnds(e.range,t.range);return i===0?e.sortIndex-t.sortIndex:i}static _sortOpsDescending(e,t){const i=L.compareRangesUsingEnds(e.range,t.range);return i===0?t.sortIndex-e.sortIndex:-i}}class qde{constructor(e,t,i,n,s,r,a,l,c){this._chunks=e,this._bom=t,this._cr=i,this._lf=n,this._crlf=s,this._containsRTL=r,this._containsUnusualLineTerminators=a,this._isBasicASCII=l,this._normalizeEOL=c}_getEOL(e){const t=this._cr+this._lf+this._crlf,i=this._cr+this._crlf;return t===0?e===1?`
`:`\r
`:i>t/2?`\r
`:`
`}create(e){const t=this._getEOL(e),i=this._chunks;if(this._normalizeEOL&&(t===`\r
`&&(this._cr>0||this._lf>0)||t===`
`&&(this._cr>0||this._crlf>0)))for(let s=0,r=i.length;s<r;s++){const a=i[s].buffer.replace(/\r\n|\r|\n/g,t),l=nc(a);i[s]=new Bu(a,l)}const n=new zm(i,this._bom,t,this._containsRTL,this._containsUnusualLineTerminators,this._isBasicASCII,this._normalizeEOL);return{textBuffer:n,disposable:n}}}class O${constructor(){this.chunks=[],this.BOM="",this._hasPreviousChar=!1,this._previousChar=0,this._tmpLineStarts=[],this.cr=0,this.lf=0,this.crlf=0,this.containsRTL=!1,this.containsUnusualLineTerminators=!1,this.isBasicASCII=!0}acceptChunk(e){if(e.length===0)return;this.chunks.length===0&&O4(e)&&(this.BOM=jQ,e=e.substr(1));const t=e.charCodeAt(e.length-1);t===13||t>=55296&&t<=56319?(this._acceptChunk1(e.substr(0,e.length-1),!1),this._hasPreviousChar=!0,this._previousChar=t):(this._acceptChunk1(e,!1),this._hasPreviousChar=!1,this._previousChar=t)}_acceptChunk1(e,t){!t&&e.length===0||(this._hasPreviousChar?this._acceptChunk2(String.fromCharCode(this._previousChar)+e):this._acceptChunk2(e))}_acceptChunk2(e){const t=Gde(this._tmpLineStarts,e);this.chunks.push(new Bu(e,t.lineStarts)),this.cr+=t.cr,this.lf+=t.lf,this.crlf+=t.crlf,t.isBasicASCII||(this.isBasicASCII=!1,this.containsRTL||(this.containsRTL=p_(e)),this.containsUnusualLineTerminators||(this.containsUnusualLineTerminators=Tz(e)))}finish(e=!0){return this._finish(),new qde(this.chunks,this.BOM,this.cr,this.lf,this.crlf,this.containsRTL,this.containsUnusualLineTerminators,this.isBasicASCII,e)}_finish(){if(this.chunks.length===0&&this._acceptChunk1("",!0),this._hasPreviousChar){this._hasPreviousChar=!1;const e=this.chunks[this.chunks.length-1];e.buffer+=String.fromCharCode(this._previousChar);const t=nc(e.buffer);e.lineStarts=t,this._previousChar===13&&this.cr++}}}class Zde{constructor(e){this._default=e,this._store=[]}get(e){return e<this._store.length?this._store[e]:this._default}set(e,t){for(;e>=this._store.length;)this._store[this._store.length]=this._default;this._store[e]=t}replace(e,t,i){if(e>=this._store.length)return;if(t===0){this.insert(e,i);return}else if(i===0){this.delete(e,t);return}const n=this._store.slice(0,e),s=this._store.slice(e+t),r=Yde(i,this._default);this._store=n.concat(r,s)}delete(e,t){t===0||e>=this._store.length||this._store.splice(e,t)}insert(e,t){if(t===0||e>=this._store.length)return;const i=[];for(let n=0;n<t;n++)i[n]=this._default;this._store=YE(this._store,e,i)}}function Yde(o,e){const t=[];for(let i=0;i<o;i++)t[i]=e;return t}class Xde{get startLineNumber(){return this._startLineNumber}get endLineNumber(){return this._startLineNumber+this._tokens.length-1}constructor(e,t){this._startLineNumber=e,this._tokens=t}getLineTokens(e){return this._tokens[e-this._startLineNumber]}appendLineTokens(e){this._tokens.push(e)}}class $A{constructor(){this._tokens=[]}add(e,t){if(this._tokens.length>0){const i=this._tokens[this._tokens.length-1];if(i.endLineNumber+1===e){i.appendLineTokens(t);return}}this._tokens.push(new Xde(e,[t]))}finalize(){return this._tokens}}class Qde{constructor(e,t){this.tokenizationSupport=t,this.initialState=this.tokenizationSupport.getInitialState(),this.store=new KA(e)}getStartState(e){return this.store.getStartState(e,this.initialState)}getFirstInvalidLine(){return this.store.getFirstInvalidLine(this.initialState)}}class Jde extends Qde{constructor(e,t,i,n){super(e,t),this._textModel=i,this._languageIdCodec=n}updateTokensUntilLine(e,t){const i=this._textModel.getLanguageId();for(;;){const n=this.getFirstInvalidLine();if(!n||n.lineNumber>t)break;const s=this._textModel.getLineContent(n.lineNumber),r=qb(this._languageIdCodec,i,this.tokenizationSupport,s,!0,n.startState);e.add(n.lineNumber,r.tokens),this.store.setEndState(n.lineNumber,r.endState)}}getTokenTypeIfInsertingCharacter(e,t){const i=this.getStartState(e.lineNumber);if(!i)return 0;const n=this._textModel.getLanguageId(),s=this._textModel.getLineContent(e.lineNumber),r=s.substring(0,e.column-1)+t+s.substring(e.column-1),a=qb(this._languageIdCodec,n,this.tokenizationSupport,r,!0,i),l=new an(a.tokens,r,this._languageIdCodec);if(l.getCount()===0)return 0;const c=l.findTokenIndexAtOffset(e.column-1);return l.getStandardTokenType(c)}tokenizeLineWithEdit(e,t,i){const n=e.lineNumber,s=e.column,r=this.getStartState(n);if(!r)return null;const a=this._textModel.getLineContent(n),l=a.substring(0,s-1)+i+a.substring(s-1+t),c=this._textModel.getLanguageIdAtPosition(n,0),d=qb(this._languageIdCodec,c,this.tokenizationSupport,l,!0,r);return new an(d.tokens,l,this._languageIdCodec)}hasAccurateTokensForLine(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t}isCheapToTokenize(e){const t=this.store.getFirstInvalidEndStateLineNumberOrMax();return e<t||e===t&&this._textModel.getLineLength(e)<2048}tokenizeHeuristically(e,t,i){if(i<=this.store.getFirstInvalidEndStateLineNumberOrMax())return{heuristicTokens:!1};if(t<=this.store.getFirstInvalidEndStateLineNumberOrMax())return this.updateTokensUntilLine(e,i),{heuristicTokens:!1};let n=this.guessStartState(t);const s=this._textModel.getLanguageId();for(let r=t;r<=i;r++){const a=this._textModel.getLineContent(r),l=qb(this._languageIdCodec,s,this.tokenizationSupport,a,!0,n);e.add(r,l.tokens),n=l.endState}return{heuristicTokens:!0}}guessStartState(e){let t=this._textModel.getLineFirstNonWhitespaceColumn(e);const i=[];let n=null;for(let a=e-1;t>1&&a>=1;a--){const l=this._textModel.getLineFirstNonWhitespaceColumn(a);if(l!==0&&l<t&&(i.push(this._textModel.getLineContent(a)),t=l,n=this.getStartState(a),n))break}n||(n=this.tokenizationSupport.getInitialState()),i.reverse();const s=this._textModel.getLanguageId();let r=n;for(const a of i)r=qb(this._languageIdCodec,s,this.tokenizationSupport,a,!1,r).endState;return r}}class KA{constructor(e){this.lineCount=e,this._tokenizationStateStore=new ehe,this._invalidEndStatesLineNumbers=new the,this._invalidEndStatesLineNumbers.addRange(new je(1,e+1))}getEndState(e){return this._tokenizationStateStore.getEndState(e)}setEndState(e,t){if(!t)throw new pt("Cannot set null/undefined state");this._invalidEndStatesLineNumbers.delete(e);const i=this._tokenizationStateStore.setEndState(e,t);return i&&e<this.lineCount&&this._invalidEndStatesLineNumbers.addRange(new je(e+1,e+2)),i}acceptChange(e,t){this.lineCount+=t-e.length,this._tokenizationStateStore.acceptChange(e,t),this._invalidEndStatesLineNumbers.addRangeAndResize(new je(e.startLineNumber,e.endLineNumberExclusive),t)}acceptChanges(e){for(const t of e){const[i]=Mh(t.text);this.acceptChange(new Be(t.range.startLineNumber,t.range.endLineNumber+1),i+1)}}invalidateEndStateRange(e){this._invalidEndStatesLineNumbers.addRange(new je(e.startLineNumber,e.endLineNumberExclusive))}getFirstInvalidEndStateLineNumber(){return this._invalidEndStatesLineNumbers.min}getFirstInvalidEndStateLineNumberOrMax(){return this.getFirstInvalidEndStateLineNumber()||Number.MAX_SAFE_INTEGER}allStatesValid(){return this._invalidEndStatesLineNumbers.min===null}getStartState(e,t){return e===1?t:this.getEndState(e-1)}getFirstInvalidLine(e){const t=this.getFirstInvalidEndStateLineNumber();if(t===null)return null;const i=this.getStartState(t,e);if(!i)throw new pt("Start state must be defined");return{lineNumber:t,startState:i}}}class ehe{constructor(){this._lineEndStates=new Zde(null)}getEndState(e){return this._lineEndStates.get(e)}setEndState(e,t){const i=this._lineEndStates.get(e);return i&&i.equals(t)?!1:(this._lineEndStates.set(e,t),!0)}acceptChange(e,t){let i=e.length;t>0&&i>0&&(i--,t--),this._lineEndStates.replace(e.startLineNumber,i,t)}}class the{constructor(){this._ranges=[]}get min(){return this._ranges.length===0?null:this._ranges[0].start}delete(e){const t=this._ranges.findIndex(i=>i.contains(e));if(t!==-1){const i=this._ranges[t];i.start===e?i.endExclusive===e+1?this._ranges.splice(t,1):this._ranges[t]=new je(e+1,i.endExclusive):i.endExclusive===e+1?this._ranges[t]=new je(i.start,e):this._ranges.splice(t,1,new je(i.start,e),new je(e+1,i.endExclusive))}}addRange(e){je.addRange(e,this._ranges)}addRangeAndResize(e,t){let i=0;for(;!(i>=this._ranges.length||e.start<=this._ranges[i].endExclusive);)i++;let n=i;for(;!(n>=this._ranges.length||e.endExclusive<this._ranges[n].start);)n++;const s=t-e.length;for(let r=n;r<this._ranges.length;r++)this._ranges[r]=this._ranges[r].delta(s);if(i===n){const r=new je(e.start,e.start+t);r.isEmpty||this._ranges.splice(i,0,r)}else{const r=Math.min(e.start,this._ranges[i].start),a=Math.max(e.endExclusive,this._ranges[n-1].endExclusive),l=new je(r,a+s);l.isEmpty?this._ranges.splice(i,n-i):this._ranges.splice(i,n-i,l)}}toString(){return this._ranges.map(e=>e.toString()).join(" + ")}}function qb(o,e,t,i,n,s){let r=null;if(t)try{r=t.tokenizeEncoded(i,n,s.clone())}catch(a){Ae(a)}return r||(r=BT(o.encodeLanguageId(e),s)),an.convertToEndOffset(r.tokens,i.length),r}class ihe{constructor(e,t){this._tokenizerWithStateStore=e,this._backgroundTokenStore=t,this._isDisposed=!1,this._isScheduled=!1}dispose(){this._isDisposed=!0}handleChanges(){this._beginBackgroundTokenization()}_beginBackgroundTokenization(){this._isScheduled||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._isScheduled=!0,Mz(e=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(e)}))}_backgroundTokenizeWithDeadline(e){const t=Date.now()+e.timeRemaining(),i=()=>{this._isDisposed||!this._tokenizerWithStateStore._textModel.isAttachedToEditor()||!this._hasLinesToTokenize()||(this._backgroundTokenizeForAtLeast1ms(),Date.now()<t?ez(i):this._beginBackgroundTokenization())};i()}_backgroundTokenizeForAtLeast1ms(){const e=this._tokenizerWithStateStore._textModel.getLineCount(),t=new $A,i=rn.create(!1);do if(i.elapsed()>1||this._tokenizeOneInvalidLine(t)>=e)break;while(this._hasLinesToTokenize());this._backgroundTokenStore.setTokens(t.finalize()),this.checkFinished()}_hasLinesToTokenize(){return this._tokenizerWithStateStore?!this._tokenizerWithStateStore.store.allStatesValid():!1}_tokenizeOneInvalidLine(e){const t=this._tokenizerWithStateStore?.getFirstInvalidLine();return t?(this._tokenizerWithStateStore.updateTokensUntilLine(e,t.lineNumber),t.lineNumber):this._tokenizerWithStateStore._textModel.getLineCount()+1}checkFinished(){this._isDisposed||this._tokenizerWithStateStore.store.allStatesValid()&&this._backgroundTokenStore.backgroundTokenizationFinished()}requestTokens(e,t){this._tokenizerWithStateStore.store.invalidateEndStateRange(new Be(e,t))}}class nhe{constructor(){this._onDidChangeVisibleRanges=new O,this.onDidChangeVisibleRanges=this._onDidChangeVisibleRanges.event,this._views=new Set}attachView(){const e=new she(t=>{this._onDidChangeVisibleRanges.fire({view:e,state:t})});return this._views.add(e),e}detachView(e){this._views.delete(e),this._onDidChangeVisibleRanges.fire({view:e,state:void 0})}}class she{constructor(e){this.handleStateChange=e}setVisibleLines(e,t){const i=e.map(n=>new Be(n.startLineNumber,n.endLineNumber+1));this.handleStateChange({visibleLineRanges:i,stabilized:t})}}class ohe extends F{get lineRanges(){return this._lineRanges}constructor(e){super(),this._refreshTokens=e,this.runner=this._register(new xt(()=>this.update(),50)),this._computedLineRanges=[],this._lineRanges=[]}update(){ei(this._computedLineRanges,this._lineRanges,(e,t)=>e.equals(t))||(this._computedLineRanges=this._lineRanges,this._refreshTokens())}handleStateChange(e){this._lineRanges=e.visibleLineRanges,e.stabilized?(this.runner.cancel(),this.update()):this.runner.schedule()}}class F$ extends F{get backgroundTokenizationState(){return this._backgroundTokenizationState}constructor(e,t,i){super(),this._languageIdCodec=e,this._textModel=t,this.getLanguageId=i,this._backgroundTokenizationState=1,this._onDidChangeBackgroundTokenizationState=this._register(new O),this.onDidChangeBackgroundTokenizationState=this._onDidChangeBackgroundTokenizationState.event,this._onDidChangeTokens=this._register(new O),this.onDidChangeTokens=this._onDidChangeTokens.event}tokenizeIfCheap(e){this.isCheapToTokenize(e)&&this.forceTokenization(e)}}class r7 extends F${constructor(e,t,i,n){super(t,i,n),this._treeSitterService=e,this._tokenizationSupport=null,this._initialize()}_initialize(){const e=this.getLanguageId();(!this._tokenizationSupport||this._lastLanguageId!==e)&&(this._lastLanguageId=e,this._tokenizationSupport=aR.get(e))}getLineTokens(e){const t=this._textModel.getLineContent(e);if(this._tokenizationSupport){const i=this._tokenizationSupport.tokenizeEncoded(e,this._textModel);if(i)return new an(i,t,this._languageIdCodec)}return an.createEmpty(t,this._languageIdCodec)}resetTokenization(e=!0){e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]}),this._initialize()}handleDidChangeAttached(){}handleDidChangeContent(e){e.isFlush&&this.resetTokenization(!1)}forceTokenization(e){}hasAccurateTokensForLine(e){return!0}isCheapToTokenize(e){return!0}getTokenTypeIfInsertingCharacter(e,t,i){return 0}tokenizeLineWithEdit(e,t,i){return null}get hasTokens(){return this._treeSitterService.getParseResult(this._textModel)!==void 0}}const B$=Je("treeSitterParserService"),sc=new Uint32Array(0).buffer;class ll{static deleteBeginning(e,t){return e===null||e===sc?e:ll.delete(e,0,t)}static deleteEnding(e,t){if(e===null||e===sc)return e;const i=Cc(e),n=i[i.length-2];return ll.delete(e,t,n)}static delete(e,t,i){if(e===null||e===sc||t===i)return e;const n=Cc(e),s=n.length>>>1;if(t===0&&n[n.length-2]===i)return sc;const r=an.findIndexInTokensArray(n,t),a=r>0?n[r-1<<1]:0,l=n[r<<1];if(i<l){const g=i-t;for(let f=r;f<s;f++)n[f<<1]-=g;return e}let c,d;a!==t?(n[r<<1]=t,c=r+1<<1,d=t):(c=r<<1,d=a);const h=i-t;for(let g=r+1;g<s;g++){const f=n[g<<1]-h;f>d&&(n[c++]=f,n[c++]=n[(g<<1)+1],d=f)}if(c===n.length)return e;const u=new Uint32Array(c);return u.set(n.subarray(0,c),0),u.buffer}static append(e,t){if(t===sc)return e;if(e===sc)return t;if(e===null)return e;if(t===null)return null;const i=Cc(e),n=Cc(t),s=n.length>>>1,r=new Uint32Array(i.length+n.length);r.set(i,0);let a=i.length;const l=i[i.length-2];for(let c=0;c<s;c++)r[a++]=n[c<<1]+l,r[a++]=n[(c<<1)+1];return r.buffer}static insert(e,t,i){if(e===null||e===sc)return e;const n=Cc(e),s=n.length>>>1;let r=an.findIndexInTokensArray(n,t);r>0&&n[r-1<<1]===t&&r--;for(let a=r;a<s;a++)n[a<<1]+=i;return e}}function Cc(o){return o instanceof Uint32Array?o:new Uint32Array(o)}class Sy{constructor(e){this._lineTokens=[],this._len=0,this._languageIdCodec=e}flush(){this._lineTokens=[],this._len=0}get hasTokens(){return this._lineTokens.length>0}getTokens(e,t,i){let n=null;if(t<this._len&&(n=this._lineTokens[t]),n!==null&&n!==sc)return new an(Cc(n),i,this._languageIdCodec);const s=new Uint32Array(2);return s[0]=i.length,s[1]=a7(this._languageIdCodec.encodeLanguageId(e)),new an(s,i,this._languageIdCodec)}static _massageTokens(e,t,i){const n=i?Cc(i):null;if(t===0){let s=!1;if(n&&n.length>1&&(s=ks.getLanguageId(n[1])!==e),!s)return sc}if(!n||n.length===0){const s=new Uint32Array(2);return s[0]=t,s[1]=a7(e),s.buffer}return n[n.length-2]=t,n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n}_ensureLine(e){for(;e>=this._len;)this._lineTokens[this._len]=null,this._len++}_deleteLines(e,t){t!==0&&(e+t>this._len&&(t=this._len-e),this._lineTokens.splice(e,t),this._len-=t)}_insertLines(e,t){if(t===0)return;const i=[];for(let n=0;n<t;n++)i[n]=null;this._lineTokens=YE(this._lineTokens,e,i),this._len+=t}setTokens(e,t,i,n,s){const r=Sy._massageTokens(this._languageIdCodec.encodeLanguageId(e),i,n);this._ensureLine(t);const a=this._lineTokens[t];return this._lineTokens[t]=r,s?!Sy._equals(a,r):!1}static _equals(e,t){if(!e||!t)return!e&&!t;const i=Cc(e),n=Cc(t);if(i.length!==n.length)return!1;for(let s=0,r=i.length;s<r;s++)if(i[s]!==n[s])return!1;return!0}acceptEdit(e,t,i){this._acceptDeleteRange(e),this._acceptInsertText(new A(e.startLineNumber,e.startColumn),t,i)}_acceptDeleteRange(e){const t=e.startLineNumber-1;if(t>=this._len)return;if(e.startLineNumber===e.endLineNumber){if(e.startColumn===e.endColumn)return;this._lineTokens[t]=ll.delete(this._lineTokens[t],e.startColumn-1,e.endColumn-1);return}this._lineTokens[t]=ll.deleteEnding(this._lineTokens[t],e.startColumn-1);const i=e.endLineNumber-1;let n=null;i<this._len&&(n=ll.deleteBeginning(this._lineTokens[i],e.endColumn-1)),this._lineTokens[t]=ll.append(this._lineTokens[t],n),this._deleteLines(e.startLineNumber,e.endLineNumber-e.startLineNumber)}_acceptInsertText(e,t,i){if(t===0&&i===0)return;const n=e.lineNumber-1;if(!(n>=this._len)){if(t===0){this._lineTokens[n]=ll.insert(this._lineTokens[n],e.column-1,i);return}this._lineTokens[n]=ll.deleteEnding(this._lineTokens[n],e.column-1),this._lineTokens[n]=ll.insert(this._lineTokens[n],e.column-1,i),this._insertLines(e.lineNumber,t)}}setMultilineTokens(e,t){if(e.length===0)return{changes:[]};const i=[];for(let n=0,s=e.length;n<s;n++){const r=e[n];let a=0,l=0,c=!1;for(let d=r.startLineNumber;d<=r.endLineNumber;d++)c?(this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!1),l=d):this.setTokens(t.getLanguageId(),d-1,t.getLineLength(d),r.getLineTokens(d),!0)&&(c=!0,a=d,l=d);c&&i.push({fromLineNumber:a,toLineNumber:l})}return{changes:i}}}function a7(o){return(o<<0|0|0|32768|2<<24|1024)>>>0}class X5{constructor(e){this._pieces=[],this._isComplete=!1,this._languageIdCodec=e}flush(){this._pieces=[],this._isComplete=!1}isEmpty(){return this._pieces.length===0}set(e,t){this._pieces=e||[],this._isComplete=t}setPartial(e,t){let i=e;if(t.length>0){const s=t[0].getRange(),r=t[t.length-1].getRange();if(!s||!r)return e;i=e.plusRange(s).plusRange(r)}let n=null;for(let s=0,r=this._pieces.length;s<r;s++){const a=this._pieces[s];if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:s};break}if(a.removeTokens(i),a.isEmpty()){this._pieces.splice(s,1),s--,r--;continue}if(a.endLineNumber<i.startLineNumber)continue;if(a.startLineNumber>i.endLineNumber){n=n||{index:s};continue}const[l,c]=a.split(i);if(l.isEmpty()){n=n||{index:s};continue}c.isEmpty()||(this._pieces.splice(s,1,l,c),s++,r++,n=n||{index:s})}return n=n||{index:this._pieces.length},t.length>0&&(this._pieces=YE(this._pieces,n.index,t)),i}isComplete(){return this._isComplete}addSparseTokens(e,t){if(t.getLineContent().length===0)return t;const i=this._pieces;if(i.length===0)return t;const n=X5._findFirstPieceWithLine(i,e),s=i[n].getLineTokens(e);if(!s)return t;const r=t.getCount(),a=s.getCount();let l=0;const c=[];let d=0,h=0;const u=(g,f)=>{g!==h&&(h=g,c[d++]=g,c[d++]=f)};for(let g=0;g<a;g++){const f=s.getStartCharacter(g),m=s.getEndCharacter(g),_=s.getMetadata(g),b=((_&1?2048:0)|(_&2?4096:0)|(_&4?8192:0)|(_&8?16384:0)|(_&16?16744448:0)|(_&32?4278190080:0))>>>0,v=~b>>>0;for(;l<r&&t.getEndOffset(l)<=f;)u(t.getEndOffset(l),t.getMetadata(l)),l++;for(l<r&&t.getStartOffset(l)<f&&u(f,t.getMetadata(l));l<r&&t.getEndOffset(l)<m;)u(t.getEndOffset(l),t.getMetadata(l)&v|_&b),l++;if(l<r)u(m,t.getMetadata(l)&v|_&b),t.getEndOffset(l)===m&&l++;else{const y=Math.min(Math.max(0,l-1),r-1);u(m,t.getMetadata(y)&v|_&b)}}for(;l<r;)u(t.getEndOffset(l),t.getMetadata(l)),l++;return new an(new Uint32Array(c),t.getLineContent(),this._languageIdCodec)}static _findFirstPieceWithLine(e,t){let i=0,n=e.length-1;for(;i<n;){let s=i+Math.floor((n-i)/2);if(e[s].endLineNumber<t)i=s+1;else if(e[s].startLineNumber>t)n=s-1;else{for(;s>i&&e[s-1].startLineNumber<=t&&t<=e[s-1].endLineNumber;)s--;return s}}return i}acceptEdit(e,t,i,n,s){for(const r of this._pieces)r.acceptEdit(e,t,i,n,s)}}var rhe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},VI=function(o,e){return function(t,i){e(t,i,o)}},U1;let jA=U1=class extends T${constructor(e,t,i,n,s,r,a){super(),this._textModel=e,this._bracketPairsTextModelPart=t,this._languageId=i,this._attachedViews=n,this._languageService=s,this._languageConfigurationService=r,this._treeSitterService=a,this._semanticTokens=new X5(this._languageService.languageIdCodec),this._onDidChangeLanguage=this._register(new O),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new O),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new O),this.onDidChangeTokens=this._onDidChangeTokens.event,this._tokensDisposables=this._register(new $),this._register(this._languageConfigurationService.onDidChange(l=>{l.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})})),this._register(se.filter(aR.onDidChange,l=>l.changedLanguages.includes(this._languageId))(()=>{this.createPreferredTokenProvider()})),this.createPreferredTokenProvider()}createGrammarTokens(){return this._register(new l7(this._languageService.languageIdCodec,this._textModel,()=>this._languageId,this._attachedViews))}createTreeSitterTokens(){return this._register(new r7(this._treeSitterService,this._languageService.languageIdCodec,this._textModel,()=>this._languageId))}createTokens(e){const t=this._tokens!==void 0;this._tokens?.dispose(),this._tokens=e?this.createTreeSitterTokens():this.createGrammarTokens(),this._tokensDisposables.clear(),this._tokensDisposables.add(this._tokens.onDidChangeTokens(i=>{this._emitModelTokensChangedEvent(i)})),this._tokensDisposables.add(this._tokens.onDidChangeBackgroundTokenizationState(i=>{this._bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState()})),t&&this._tokens.resetTokenization()}createPreferredTokenProvider(){aR.get(this._languageId)?this._tokens instanceof r7||this.createTokens(!0):this._tokens instanceof l7||this.createTokens(!1)}handleLanguageConfigurationServiceChange(e){e.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}handleDidChangeContent(e){if(e.isFlush)this._semanticTokens.flush();else if(!e.isEolChange)for(const t of e.changes){const[i,n,s]=Mh(t.text);this._semanticTokens.acceptEdit(t.range,i,n,s,t.text.length>0?t.text.charCodeAt(0):0)}this._tokens.handleDidChangeContent(e)}handleDidChangeAttached(){this._tokens.handleDidChangeAttached()}getLineTokens(e){this.validateLineNumber(e);const t=this._tokens.getLineTokens(e);return this._semanticTokens.addSparseTokens(e,t)}_emitModelTokensChangedEvent(e){this._textModel._isDisposing()||(this._bracketPairsTextModelPart.handleDidChangeTokens(e),this._onDidChangeTokens.fire(e))}validateLineNumber(e){if(e<1||e>this._textModel.getLineCount())throw new pt("Illegal value for lineNumber")}get hasTokens(){return this._tokens.hasTokens}resetTokenization(){this._tokens.resetTokenization()}get backgroundTokenizationState(){return this._tokens.backgroundTokenizationState}forceTokenization(e){this.validateLineNumber(e),this._tokens.forceTokenization(e)}hasAccurateTokensForLine(e){return this.validateLineNumber(e),this._tokens.hasAccurateTokensForLine(e)}isCheapToTokenize(e){return this.validateLineNumber(e),this._tokens.isCheapToTokenize(e)}tokenizeIfCheap(e){this.validateLineNumber(e),this._tokens.tokenizeIfCheap(e)}getTokenTypeIfInsertingCharacter(e,t,i){return this._tokens.getTokenTypeIfInsertingCharacter(e,t,i)}tokenizeLineWithEdit(e,t,i){return this._tokens.tokenizeLineWithEdit(e,t,i)}setSemanticTokens(e,t){this._semanticTokens.set(e,t),this._emitModelTokensChangedEvent({semanticTokensApplied:e!==null,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(e,t){if(this.hasCompleteSemanticTokens())return;const i=this._textModel.validateRange(this._semanticTokens.setPartial(e,t));this._emitModelTokensChangedEvent({semanticTokensApplied:!0,ranges:[{fromLineNumber:i.startLineNumber,toLineNumber:i.endLineNumber}]})}getWordAtPosition(e){this.assertNotDisposed();const t=this._textModel.validatePosition(e),i=this._textModel.getLineContent(t.lineNumber),n=this.getLineTokens(t.lineNumber),s=n.findTokenIndexAtOffset(t.column-1),[r,a]=U1._findLanguageBoundaries(n,s),l=HC(t.column,this.getLanguageConfiguration(n.getLanguageId(s)).getWordDefinition(),i.substring(r,a),r);if(l&&l.startColumn<=e.column&&e.column<=l.endColumn)return l;if(s>0&&r===t.column-1){const[c,d]=U1._findLanguageBoundaries(n,s-1),h=HC(t.column,this.getLanguageConfiguration(n.getLanguageId(s-1)).getWordDefinition(),i.substring(c,d),c);if(h&&h.startColumn<=e.column&&e.column<=h.endColumn)return h}return null}getLanguageConfiguration(e){return this._languageConfigurationService.getLanguageConfiguration(e)}static _findLanguageBoundaries(e,t){const i=e.getLanguageId(t);let n=0;for(let r=t;r>=0&&e.getLanguageId(r)===i;r--)n=e.getStartOffset(r);let s=e.getLineContent().length;for(let r=t,a=e.getCount();r<a&&e.getLanguageId(r)===i;r++)s=e.getEndOffset(r);return[n,s]}getWordUntilPosition(e){const t=this.getWordAtPosition(e);return t?{word:t.word.substr(0,e.column-t.startColumn),startColumn:t.startColumn,endColumn:e.column}:{word:"",startColumn:e.column,endColumn:e.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(e,t){const i=this._textModel.validatePosition(new A(e,t)),n=this.getLineTokens(i.lineNumber);return n.getLanguageId(n.findTokenIndexAtOffset(i.column-1))}setLanguageId(e,t="api"){if(this._languageId===e)return;const i={oldLanguage:this._languageId,newLanguage:e,source:t};this._languageId=e,this._bracketPairsTextModelPart.handleDidChangeLanguage(i),this._tokens.resetTokenization(),this.createPreferredTokenProvider(),this._onDidChangeLanguage.fire(i),this._onDidChangeLanguageConfiguration.fire({})}};jA=U1=rhe([VI(4,ti),VI(5,li),VI(6,B$)],jA);class l7 extends F${constructor(e,t,i,n){super(e,t,i),this._tokenizer=null,this._defaultBackgroundTokenizer=null,this._backgroundTokenizer=this._register(new Yi),this._tokens=new Sy(this._languageIdCodec),this._debugBackgroundTokenizer=this._register(new Yi),this._attachedViewStates=this._register(new L4),this._register(gi.onDidChange(s=>{const r=this.getLanguageId();s.changedLanguages.indexOf(r)!==-1&&this.resetTokenization()})),this.resetTokenization(),this._register(n.onDidChangeVisibleRanges(({view:s,state:r})=>{if(r){let a=this._attachedViewStates.get(s);a||(a=new ohe(()=>this.refreshRanges(a.lineRanges)),this._attachedViewStates.set(s,a)),a.handleStateChange(r)}else this._attachedViewStates.deleteAndDispose(s)}))}resetTokenization(e=!0){this._tokens.flush(),this._debugBackgroundTokens?.flush(),this._debugBackgroundStates&&(this._debugBackgroundStates=new KA(this._textModel.getLineCount())),e&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]});const t=()=>{if(this._textModel.isTooLargeForTokenization())return[null,null];const s=gi.get(this.getLanguageId());if(!s)return[null,null];let r;try{r=s.getInitialState()}catch(a){return Ae(a),[null,null]}return[s,r]},[i,n]=t();if(i&&n?this._tokenizer=new Jde(this._textModel.getLineCount(),i,this._textModel,this._languageIdCodec):this._tokenizer=null,this._backgroundTokenizer.clear(),this._defaultBackgroundTokenizer=null,this._tokenizer){const s={setTokens:r=>{this.setTokens(r)},backgroundTokenizationFinished:()=>{if(this._backgroundTokenizationState===2)return;const r=2;this._backgroundTokenizationState=r,this._onDidChangeBackgroundTokenizationState.fire()},setEndState:(r,a)=>{if(!this._tokenizer)return;const l=this._tokenizer.store.getFirstInvalidEndStateLineNumber();l!==null&&r>=l&&this._tokenizer?.store.setEndState(r,a)}};i&&i.createBackgroundTokenizer&&!i.backgroundTokenizerShouldOnlyVerifyTokens&&(this._backgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,s)),!this._backgroundTokenizer.value&&!this._textModel.isTooLargeForTokenization()&&(this._backgroundTokenizer.value=this._defaultBackgroundTokenizer=new ihe(this._tokenizer,s),this._defaultBackgroundTokenizer.handleChanges()),i?.backgroundTokenizerShouldOnlyVerifyTokens&&i.createBackgroundTokenizer?(this._debugBackgroundTokens=new Sy(this._languageIdCodec),this._debugBackgroundStates=new KA(this._textModel.getLineCount()),this._debugBackgroundTokenizer.clear(),this._debugBackgroundTokenizer.value=i.createBackgroundTokenizer(this._textModel,{setTokens:r=>{this._debugBackgroundTokens?.setMultilineTokens(r,this._textModel)},backgroundTokenizationFinished(){},setEndState:(r,a)=>{this._debugBackgroundStates?.setEndState(r,a)}})):(this._debugBackgroundTokens=void 0,this._debugBackgroundStates=void 0,this._debugBackgroundTokenizer.value=void 0)}this.refreshAllVisibleLineTokens()}handleDidChangeAttached(){this._defaultBackgroundTokenizer?.handleChanges()}handleDidChangeContent(e){if(e.isFlush)this.resetTokenization(!1);else if(!e.isEolChange){for(const t of e.changes){const[i,n]=Mh(t.text);this._tokens.acceptEdit(t.range,i,n),this._debugBackgroundTokens?.acceptEdit(t.range,i,n)}this._debugBackgroundStates?.acceptChanges(e.changes),this._tokenizer&&this._tokenizer.store.acceptChanges(e.changes),this._defaultBackgroundTokenizer?.handleChanges()}}setTokens(e){const{changes:t}=this._tokens.setMultilineTokens(e,this._textModel);return t.length>0&&this._onDidChangeTokens.fire({semanticTokensApplied:!1,ranges:t}),{changes:t}}refreshAllVisibleLineTokens(){const e=Be.joinMany([...this._attachedViewStates].map(([t,i])=>i.lineRanges));this.refreshRanges(e)}refreshRanges(e){for(const t of e)this.refreshRange(t.startLineNumber,t.endLineNumberExclusive-1)}refreshRange(e,t){if(!this._tokenizer)return;e=Math.max(1,Math.min(this._textModel.getLineCount(),e)),t=Math.min(this._textModel.getLineCount(),t);const i=new $A,{heuristicTokens:n}=this._tokenizer.tokenizeHeuristically(i,e,t),s=this.setTokens(i.finalize());if(n)for(const r of s.changes)this._backgroundTokenizer.value?.requestTokens(r.fromLineNumber,r.toLineNumber+1);this._defaultBackgroundTokenizer?.checkFinished()}forceTokenization(e){const t=new $A;this._tokenizer?.updateTokensUntilLine(t,e),this.setTokens(t.finalize()),this._defaultBackgroundTokenizer?.checkFinished()}hasAccurateTokensForLine(e){return this._tokenizer?this._tokenizer.hasAccurateTokensForLine(e):!0}isCheapToTokenize(e){return this._tokenizer?this._tokenizer.isCheapToTokenize(e):!0}getLineTokens(e){const t=this._textModel.getLineContent(e),i=this._tokens.getTokens(this._textModel.getLanguageId(),e-1,t);if(this._debugBackgroundTokens&&this._debugBackgroundStates&&this._tokenizer&&this._debugBackgroundStates.getFirstInvalidEndStateLineNumberOrMax()>e&&this._tokenizer.store.getFirstInvalidEndStateLineNumberOrMax()>e){const n=this._debugBackgroundTokens.getTokens(this._textModel.getLanguageId(),e-1,t);!i.equals(n)&&this._debugBackgroundTokenizer.value?.reportMismatchingTokens&&this._debugBackgroundTokenizer.value.reportMismatchingTokens(e)}return i}getTokenTypeIfInsertingCharacter(e,t,i){if(!this._tokenizer)return 0;const n=this._textModel.validatePosition(new A(e,t));return this.forceTokenization(n.lineNumber),this._tokenizer.getTokenTypeIfInsertingCharacter(n,i)}tokenizeLineWithEdit(e,t,i){if(!this._tokenizer)return null;const n=this._textModel.validatePosition(e);return this.forceTokenization(n.lineNumber),this._tokenizer.tokenizeLineWithEdit(n,t,i)}get hasTokens(){return this._tokens.hasTokens}}class ahe{constructor(){this.changeType=1}}class Na{static applyInjectedText(e,t){if(!t||t.length===0)return e;let i="",n=0;for(const s of t)i+=e.substring(n,s.column-1),n=s.column-1,i+=s.options.content;return i+=e.substring(n),i}static fromDecorations(e){const t=[];for(const i of e)i.options.before&&i.options.before.content.length>0&&t.push(new Na(i.ownerId,i.range.startLineNumber,i.range.startColumn,i.options.before,0)),i.options.after&&i.options.after.content.length>0&&t.push(new Na(i.ownerId,i.range.endLineNumber,i.range.endColumn,i.options.after,1));return t.sort((i,n)=>i.lineNumber===n.lineNumber?i.column===n.column?i.order-n.order:i.column-n.column:i.lineNumber-n.lineNumber),t}constructor(e,t,i,n,s){this.ownerId=e,this.lineNumber=t,this.column=i,this.options=n,this.order=s}}class c7{constructor(e,t,i){this.changeType=2,this.lineNumber=e,this.detail=t,this.injectedText=i}}class lhe{constructor(e,t){this.changeType=3,this.fromLineNumber=e,this.toLineNumber=t}}class che{constructor(e,t,i,n){this.changeType=4,this.injectedTexts=n,this.fromLineNumber=e,this.toLineNumber=t,this.detail=i}}class dhe{constructor(){this.changeType=5}}class Um{constructor(e,t,i,n){this.changes=e,this.versionId=t,this.isUndoing=i,this.isRedoing=n,this.resultingSelection=null}containsEvent(e){for(let t=0,i=this.changes.length;t<i;t++)if(this.changes[t].changeType===e)return!0;return!1}static merge(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.versionId,s=e.isUndoing||t.isUndoing,r=e.isRedoing||t.isRedoing;return new Um(i,n,s,r)}}class W${constructor(e){this.changes=e}}class hg{constructor(e,t){this.rawContentChangedEvent=e,this.contentChangedEvent=t}merge(e){const t=Um.merge(this.rawContentChangedEvent,e.rawContentChangedEvent),i=hg._mergeChangeEvents(this.contentChangedEvent,e.contentChangedEvent);return new hg(t,i)}static _mergeChangeEvents(e,t){const i=[].concat(e.changes).concat(t.changes),n=t.eol,s=t.versionId,r=e.isUndoing||t.isUndoing,a=e.isRedoing||t.isRedoing,l=e.isFlush||t.isFlush,c=e.isEolChange&&t.isEolChange;return{changes:i,eol:n,isEolChange:c,versionId:s,isUndoing:r,isRedoing:a,isFlush:l}}}var hhe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},HS=function(o,e){return function(t,i){e(t,i,o)}},xu;function uhe(o){const e=new O$;return e.acceptChunk(o),e.finish()}function ghe(o){const e=new O$;let t;for(;typeof(t=o.read())=="string";)e.acceptChunk(t);return e.finish()}function d7(o,e){let t;return typeof o=="string"?t=uhe(o):iie(o)?t=ghe(o):t=o,t.create(e)}let zS=0;const fhe=999,phe=1e4;class mhe{constructor(e){this._source=e,this._eos=!1}read(){if(this._eos)return null;const e=[];let t=0,i=0;do{const n=this._source.read();if(n===null)return this._eos=!0,t===0?null:e.join("");if(n.length>0&&(e[t++]=n,i+=n.length),i>=64*1024)return e.join("")}while(!0)}}const Zb=()=>{throw new Error("Invalid change accessor")};var fa;let Ca=(fa=class extends F{static resolveOptions(e,t){if(t.detectIndentation){const i=QH(e,t.tabSize,t.insertSpaces);return new P1({tabSize:i.tabSize,indentSize:"tabSize",insertSpaces:i.insertSpaces,trimAutoWhitespace:t.trimAutoWhitespace,defaultEOL:t.defaultEOL,bracketPairColorizationOptions:t.bracketPairColorizationOptions})}return new P1(t)}get onDidChangeLanguage(){return this._tokenizationTextModelPart.onDidChangeLanguage}get onDidChangeLanguageConfiguration(){return this._tokenizationTextModelPart.onDidChangeLanguageConfiguration}get onDidChangeTokens(){return this._tokenizationTextModelPart.onDidChangeTokens}onDidChangeContent(e){return this._eventEmitter.slowEvent(t=>e(t.contentChangedEvent))}onDidChangeContentOrInjectedText(e){return Wr(this._eventEmitter.fastEvent(t=>e(t)),this._onDidChangeInjectedText.event(t=>e(t)))}_isDisposing(){return this.__isDisposing}get tokenization(){return this._tokenizationTextModelPart}get bracketPairs(){return this._bracketPairs}get guides(){return this._guidesTextModelPart}constructor(e,t,i,n=null,s,r,a,l){super(),this._undoRedoService=s,this._languageService=r,this._languageConfigurationService=a,this.instantiationService=l,this._onWillDispose=this._register(new O),this.onWillDispose=this._onWillDispose.event,this._onDidChangeDecorations=this._register(new whe(f=>this.handleBeforeFireDecorationsChangedEvent(f))),this.onDidChangeDecorations=this._onDidChangeDecorations.event,this._onDidChangeOptions=this._register(new O),this.onDidChangeOptions=this._onDidChangeOptions.event,this._onDidChangeAttached=this._register(new O),this.onDidChangeAttached=this._onDidChangeAttached.event,this._onDidChangeInjectedText=this._register(new O),this._eventEmitter=this._register(new She),this._languageSelectionListener=this._register(new Yi),this._deltaDecorationCallCnt=0,this._attachedViews=new nhe,zS++,this.id="$model"+zS,this.isForSimpleWidget=i.isForSimpleWidget,typeof n>"u"||n===null?this._associatedResource=ye.parse("inmemory://model/"+zS):this._associatedResource=n,this._attachedEditorCount=0;const{textBuffer:c,disposable:d}=d7(e,i.defaultEOL);this._buffer=c,this._bufferDisposable=d,this._options=xu.resolveOptions(this._buffer,i);const h=typeof t=="string"?t:t.languageId;typeof t!="string"&&(this._languageSelectionListener.value=t.onDidChange(()=>this._setLanguage(t.languageId))),this._bracketPairs=this._register(new wde(this,this._languageConfigurationService)),this._guidesTextModelPart=this._register(new Ede(this,this._languageConfigurationService)),this._decorationProvider=this._register(new xde(this)),this._tokenizationTextModelPart=this.instantiationService.createInstance(jA,this,this._bracketPairs,h,this._attachedViews);const u=this._buffer.getLineCount(),g=this._buffer.getValueLengthInRange(new L(1,1,u,this._buffer.getLineLength(u)+1),0);i.largeFileOptimizations?(this._isTooLargeForTokenization=g>xu.LARGE_FILE_SIZE_THRESHOLD||u>xu.LARGE_FILE_LINE_COUNT_THRESHOLD,this._isTooLargeForHeapOperation=g>xu.LARGE_FILE_HEAP_OPERATION_THRESHOLD):(this._isTooLargeForTokenization=!1,this._isTooLargeForHeapOperation=!1),this._isTooLargeForSyncing=g>xu._MODEL_SYNC_LIMIT,this._versionId=1,this._alternativeVersionId=1,this._initialUndoRedoSnapshot=null,this._isDisposed=!1,this.__isDisposing=!1,this._instanceId=Dz(zS),this._lastDecorationId=0,this._decorations=Object.create(null),this._decorationsTree=new h7,this._commandManager=new j5(this,this._undoRedoService),this._isUndoing=!1,this._isRedoing=!1,this._trimAutoWhitespaceLines=null,this._register(this._decorationProvider.onDidChange(()=>{this._onDidChangeDecorations.beginDeferredEmit(),this._onDidChangeDecorations.fire(),this._onDidChangeDecorations.endDeferredEmit()})),this._languageService.requestRichLanguageFeatures(h),this._register(this._languageConfigurationService.onDidChange(f=>{this._bracketPairs.handleLanguageConfigurationServiceChange(f),this._tokenizationTextModelPart.handleLanguageConfigurationServiceChange(f)}))}dispose(){this.__isDisposing=!0,this._onWillDispose.fire(),this._tokenizationTextModelPart.dispose(),this._isDisposed=!0,super.dispose(),this._bufferDisposable.dispose(),this.__isDisposing=!1;const e=new zm([],"",`
`,!1,!1,!0,!0);e.dispose(),this._buffer=e,this._bufferDisposable=F.None}_assertNotDisposed(){if(this._isDisposed)throw new pt("Model is disposed!")}_emitContentChangedEvent(e,t){this.__isDisposing||(this._tokenizationTextModelPart.handleDidChangeContent(t),this._bracketPairs.handleDidChangeContent(t),this._eventEmitter.fire(new hg(e,t)))}setValue(e){if(this._assertNotDisposed(),e==null)throw ar();const{textBuffer:t,disposable:i}=d7(e,this._options.defaultEOL);this._setValueFromTextBuffer(t,i)}_createContentChanged2(e,t,i,n,s,r,a,l){return{changes:[{range:e,rangeOffset:t,rangeLength:i,text:n}],eol:this._buffer.getEOL(),isEolChange:l,versionId:this.getVersionId(),isUndoing:s,isRedoing:r,isFlush:a}}_setValueFromTextBuffer(e,t){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),s=this.getLineCount(),r=this.getLineMaxColumn(s);this._buffer=e,this._bufferDisposable.dispose(),this._bufferDisposable=t,this._increaseVersionId(),this._decorations=Object.create(null),this._decorationsTree=new h7,this._commandManager.clear(),this._trimAutoWhitespaceLines=null,this._emitContentChangedEvent(new Um([new ahe],this._versionId,!1,!1),this._createContentChanged2(new L(1,1,s,r),0,n,this.getValue(),!1,!1,!0,!1))}setEOL(e){this._assertNotDisposed();const t=e===1?`\r
`:`
`;if(this._buffer.getEOL()===t)return;const i=this.getFullModelRange(),n=this.getValueLengthInRange(i),s=this.getLineCount(),r=this.getLineMaxColumn(s);this._onBeforeEOLChange(),this._buffer.setEOL(t),this._increaseVersionId(),this._onAfterEOLChange(),this._emitContentChangedEvent(new Um([new dhe],this._versionId,!1,!1),this._createContentChanged2(new L(1,1,s,r),0,n,this.getValue(),!1,!1,!1,!0))}_onBeforeEOLChange(){this._decorationsTree.ensureAllNodesHaveRanges(this)}_onAfterEOLChange(){const e=this.getVersionId(),t=this._decorationsTree.collectNodesPostOrder();for(let i=0,n=t.length;i<n;i++){const s=t[i],r=s.range,a=s.cachedAbsoluteStart-s.start,l=this._buffer.getOffsetAt(r.startLineNumber,r.startColumn),c=this._buffer.getOffsetAt(r.endLineNumber,r.endColumn);s.cachedAbsoluteStart=l,s.cachedAbsoluteEnd=c,s.cachedVersionId=e,s.start=l-a,s.end=c-a,Bh(s)}}onBeforeAttached(){return this._attachedEditorCount++,this._attachedEditorCount===1&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.attachView()}onBeforeDetached(e){this._attachedEditorCount--,this._attachedEditorCount===0&&(this._tokenizationTextModelPart.handleDidChangeAttached(),this._onDidChangeAttached.fire(void 0)),this._attachedViews.detachView(e)}isAttachedToEditor(){return this._attachedEditorCount>0}getAttachedEditorCount(){return this._attachedEditorCount}isTooLargeForSyncing(){return this._isTooLargeForSyncing}isTooLargeForTokenization(){return this._isTooLargeForTokenization}isTooLargeForHeapOperation(){return this._isTooLargeForHeapOperation}isDisposed(){return this._isDisposed}isDominatedByLongLines(){if(this._assertNotDisposed(),this.isTooLargeForTokenization())return!1;let e=0,t=0;const i=this._buffer.getLineCount();for(let n=1;n<=i;n++){const s=this._buffer.getLineLength(n);s>=phe?t+=s:e+=s}return t>e}get uri(){return this._associatedResource}getOptions(){return this._assertNotDisposed(),this._options}getFormattingOptions(){return{tabSize:this._options.indentSize,insertSpaces:this._options.insertSpaces}}updateOptions(e){this._assertNotDisposed();const t=typeof e.tabSize<"u"?e.tabSize:this._options.tabSize,i=typeof e.indentSize<"u"?e.indentSize:this._options.originalIndentSize,n=typeof e.insertSpaces<"u"?e.insertSpaces:this._options.insertSpaces,s=typeof e.trimAutoWhitespace<"u"?e.trimAutoWhitespace:this._options.trimAutoWhitespace,r=typeof e.bracketColorizationOptions<"u"?e.bracketColorizationOptions:this._options.bracketPairColorizationOptions,a=new P1({tabSize:t,indentSize:i,insertSpaces:n,defaultEOL:this._options.defaultEOL,trimAutoWhitespace:s,bracketPairColorizationOptions:r});if(this._options.equals(a))return;const l=this._options.createChangeEvent(a);this._options=a,this._bracketPairs.handleDidChangeOptions(l),this._decorationProvider.handleDidChangeOptions(l),this._onDidChangeOptions.fire(l)}detectIndentation(e,t){this._assertNotDisposed();const i=QH(this._buffer,t,e);this.updateOptions({insertSpaces:i.insertSpaces,tabSize:i.tabSize,indentSize:i.tabSize})}normalizeIndentation(e){return this._assertNotDisposed(),z5(e,this._options.indentSize,this._options.insertSpaces)}getVersionId(){return this._assertNotDisposed(),this._versionId}mightContainRTL(){return this._buffer.mightContainRTL()}mightContainUnusualLineTerminators(){return this._buffer.mightContainUnusualLineTerminators()}removeUnusualLineTerminators(e=null){const t=this.findMatches(Ez.source,!1,!0,!1,null,!1,1073741824);this._buffer.resetMightContainUnusualLineTerminators(),this.pushEditOperations(e,t.map(i=>({range:i.range,text:null})),()=>null)}mightContainNonBasicASCII(){return this._buffer.mightContainNonBasicASCII()}getAlternativeVersionId(){return this._assertNotDisposed(),this._alternativeVersionId}getInitialUndoRedoSnapshot(){return this._assertNotDisposed(),this._initialUndoRedoSnapshot}getOffsetAt(e){this._assertNotDisposed();const t=this._validatePosition(e.lineNumber,e.column,0);return this._buffer.getOffsetAt(t.lineNumber,t.column)}getPositionAt(e){this._assertNotDisposed();const t=Math.min(this._buffer.getLength(),Math.max(0,e));return this._buffer.getPositionAt(t)}_increaseVersionId(){this._versionId=this._versionId+1,this._alternativeVersionId=this._versionId}_overwriteVersionId(e){this._versionId=e}_overwriteAlternativeVersionId(e){this._alternativeVersionId=e}_overwriteInitialUndoRedoSnapshot(e){this._initialUndoRedoSnapshot=e}getValue(e,t=!1){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new pt("Operation would exceed heap memory limits");const i=this.getFullModelRange(),n=this.getValueInRange(i,e);return t?this._buffer.getBOM()+n:n}createSnapshot(e=!1){return new mhe(this._buffer.createSnapshot(e))}getValueLength(e,t=!1){this._assertNotDisposed();const i=this.getFullModelRange(),n=this.getValueLengthInRange(i,e);return t?this._buffer.getBOM().length+n:n}getValueInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueInRange(this.validateRange(e),t)}getValueLengthInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getValueLengthInRange(this.validateRange(e),t)}getCharacterCountInRange(e,t=0){return this._assertNotDisposed(),this._buffer.getCharacterCountInRange(this.validateRange(e),t)}getLineCount(){return this._assertNotDisposed(),this._buffer.getLineCount()}getLineContent(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new pt("Illegal value for lineNumber");return this._buffer.getLineContent(e)}getLineLength(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new pt("Illegal value for lineNumber");return this._buffer.getLineLength(e)}getLinesContent(){if(this._assertNotDisposed(),this.isTooLargeForHeapOperation())throw new pt("Operation would exceed heap memory limits");return this._buffer.getLinesContent()}getEOL(){return this._assertNotDisposed(),this._buffer.getEOL()}getEndOfLineSequence(){return this._assertNotDisposed(),this._buffer.getEOL()===`
`?0:1}getLineMinColumn(e){return this._assertNotDisposed(),1}getLineMaxColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new pt("Illegal value for lineNumber");return this._buffer.getLineLength(e)+1}getLineFirstNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new pt("Illegal value for lineNumber");return this._buffer.getLineFirstNonWhitespaceColumn(e)}getLineLastNonWhitespaceColumn(e){if(this._assertNotDisposed(),e<1||e>this.getLineCount())throw new pt("Illegal value for lineNumber");return this._buffer.getLineLastNonWhitespaceColumn(e)}_validateRangeRelaxedNoAllocations(e){const t=this._buffer.getLineCount(),i=e.startLineNumber,n=e.startColumn;let s=Math.floor(typeof i=="number"&&!isNaN(i)?i:1),r=Math.floor(typeof n=="number"&&!isNaN(n)?n:1);if(s<1)s=1,r=1;else if(s>t)s=t,r=this.getLineMaxColumn(s);else if(r<=1)r=1;else{const h=this.getLineMaxColumn(s);r>=h&&(r=h)}const a=e.endLineNumber,l=e.endColumn;let c=Math.floor(typeof a=="number"&&!isNaN(a)?a:1),d=Math.floor(typeof l=="number"&&!isNaN(l)?l:1);if(c<1)c=1,d=1;else if(c>t)c=t,d=this.getLineMaxColumn(c);else if(d<=1)d=1;else{const h=this.getLineMaxColumn(c);d>=h&&(d=h)}return i===s&&n===r&&a===c&&l===d&&e instanceof L&&!(e instanceof pe)?e:new L(s,r,c,d)}_isValidPosition(e,t,i){if(typeof e!="number"||typeof t!="number"||isNaN(e)||isNaN(t)||e<1||t<1||(e|0)!==e||(t|0)!==t)return!1;const n=this._buffer.getLineCount();if(e>n)return!1;if(t===1)return!0;const s=this.getLineMaxColumn(e);if(t>s)return!1;if(i===1){const r=this._buffer.getLineCharCode(e,t-2);if($i(r))return!1}return!0}_validatePosition(e,t,i){const n=Math.floor(typeof e=="number"&&!isNaN(e)?e:1),s=Math.floor(typeof t=="number"&&!isNaN(t)?t:1),r=this._buffer.getLineCount();if(n<1)return new A(1,1);if(n>r)return new A(r,this.getLineMaxColumn(r));if(s<=1)return new A(n,1);const a=this.getLineMaxColumn(n);if(s>=a)return new A(n,a);if(i===1){const l=this._buffer.getLineCharCode(n,s-2);if($i(l))return new A(n,s-1)}return new A(n,s)}validatePosition(e){return this._assertNotDisposed(),e instanceof A&&this._isValidPosition(e.lineNumber,e.column,1)?e:this._validatePosition(e.lineNumber,e.column,1)}_isValidRange(e,t){const i=e.startLineNumber,n=e.startColumn,s=e.endLineNumber,r=e.endColumn;if(!this._isValidPosition(i,n,0)||!this._isValidPosition(s,r,0))return!1;if(t===1){const a=n>1?this._buffer.getLineCharCode(i,n-2):0,l=r>1&&r<=this._buffer.getLineLength(s)?this._buffer.getLineCharCode(s,r-2):0,c=$i(a),d=$i(l);return!c&&!d}return!0}validateRange(e){if(this._assertNotDisposed(),e instanceof L&&!(e instanceof pe)&&this._isValidRange(e,1))return e;const i=this._validatePosition(e.startLineNumber,e.startColumn,0),n=this._validatePosition(e.endLineNumber,e.endColumn,0),s=i.lineNumber,r=i.column,a=n.lineNumber,l=n.column;{const c=r>1?this._buffer.getLineCharCode(s,r-2):0,d=l>1&&l<=this._buffer.getLineLength(a)?this._buffer.getLineCharCode(a,l-2):0,h=$i(c),u=$i(d);return!h&&!u?new L(s,r,a,l):s===a&&r===l?new L(s,r-1,a,l-1):h&&u?new L(s,r-1,a,l+1):h?new L(s,r-1,a,l):new L(s,r,a,l+1)}}modifyPosition(e,t){this._assertNotDisposed();const i=this.getOffsetAt(e)+t;return this.getPositionAt(Math.min(this._buffer.getLength(),Math.max(0,i)))}getFullModelRange(){this._assertNotDisposed();const e=this.getLineCount();return new L(1,1,e,this.getLineMaxColumn(e))}findMatchesLineByLine(e,t,i,n){return this._buffer.findMatchesLineByLine(e,t,i,n)}findMatches(e,t,i,n,s,r,a=fhe){this._assertNotDisposed();let l=null;t!==null&&(Array.isArray(t)||(t=[t]),t.every(h=>L.isIRange(h))&&(l=t.map(h=>this.validateRange(h)))),l===null&&(l=[this.getFullModelRange()]),l=l.sort((h,u)=>h.startLineNumber-u.startLineNumber||h.startColumn-u.startColumn);const c=[];c.push(l.reduce((h,u)=>L.areIntersecting(h,u)?h.plusRange(u):(c.push(h),u)));let d;if(!i&&e.indexOf(`
`)<0){const u=new Su(e,i,n,s).parseSearchRequest();if(!u)return[];d=g=>this.findMatchesLineByLine(g,u,r,a)}else d=h=>wS.findMatches(this,new Su(e,i,n,s),h,r,a);return c.map(d).reduce((h,u)=>h.concat(u),[])}findNextMatch(e,t,i,n,s,r){this._assertNotDisposed();const a=this.validatePosition(t);if(!i&&e.indexOf(`
`)<0){const c=new Su(e,i,n,s).parseSearchRequest();if(!c)return null;const d=this.getLineCount();let h=new L(a.lineNumber,a.column,d,this.getLineMaxColumn(d)),u=this.findMatchesLineByLine(h,c,r,1);return wS.findNextMatch(this,new Su(e,i,n,s),a,r),u.length>0||(h=new L(1,1,a.lineNumber,this.getLineMaxColumn(a.lineNumber)),u=this.findMatchesLineByLine(h,c,r,1),u.length>0)?u[0]:null}return wS.findNextMatch(this,new Su(e,i,n,s),a,r)}findPreviousMatch(e,t,i,n,s,r){this._assertNotDisposed();const a=this.validatePosition(t);return wS.findPreviousMatch(this,new Su(e,i,n,s),a,r)}pushStackElement(){this._commandManager.pushStackElement()}popStackElement(){this._commandManager.popStackElement()}pushEOL(e){if((this.getEOL()===`
`?0:1)!==e)try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEOL(e)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_validateEditOperation(e){return e instanceof gI?e:new gI(e.identifier||null,this.validateRange(e.range),e.text,e.forceMoveMarkers||!1,e.isAutoWhitespaceEdit||!1,e._isTracked||!1)}_validateEditOperations(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this._validateEditOperation(e[i]);return t}pushEditOperations(e,t,i,n){try{return this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._pushEditOperations(e,this._validateEditOperations(t),i,n)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_pushEditOperations(e,t,i,n){if(this._options.trimAutoWhitespace&&this._trimAutoWhitespaceLines){const s=t.map(a=>({range:this.validateRange(a.range),text:a.text}));let r=!0;if(e)for(let a=0,l=e.length;a<l;a++){const c=e[a];let d=!1;for(let h=0,u=s.length;h<u;h++){const g=s[h].range,f=g.startLineNumber>c.endLineNumber,m=c.startLineNumber>g.endLineNumber;if(!f&&!m){d=!0;break}}if(!d){r=!1;break}}if(r)for(let a=0,l=this._trimAutoWhitespaceLines.length;a<l;a++){const c=this._trimAutoWhitespaceLines[a],d=this.getLineMaxColumn(c);let h=!0;for(let u=0,g=s.length;u<g;u++){const f=s[u].range,m=s[u].text;if(!(c<f.startLineNumber||c>f.endLineNumber)&&!(c===f.startLineNumber&&f.startColumn===d&&f.isEmpty()&&m&&m.length>0&&m.charAt(0)===`
`)&&!(c===f.startLineNumber&&f.startColumn===1&&f.isEmpty()&&m&&m.length>0&&m.charAt(m.length-1)===`
`)){h=!1;break}}if(h){const u=new L(c,1,c,d);t.push(new gI(null,u,null,!1,!1,!1))}}this._trimAutoWhitespaceLines=null}return this._initialUndoRedoSnapshot===null&&(this._initialUndoRedoSnapshot=this._undoRedoService.createSnapshot(this.uri)),this._commandManager.pushEditOperation(e,t,i,n)}_applyUndo(e,t,i,n){const s=e.map(r=>{const a=this.getPositionAt(r.newPosition),l=this.getPositionAt(r.newEnd);return{range:new L(a.lineNumber,a.column,l.lineNumber,l.column),text:r.oldText}});this._applyUndoRedoEdits(s,t,!0,!1,i,n)}_applyRedo(e,t,i,n){const s=e.map(r=>{const a=this.getPositionAt(r.oldPosition),l=this.getPositionAt(r.oldEnd);return{range:new L(a.lineNumber,a.column,l.lineNumber,l.column),text:r.newText}});this._applyUndoRedoEdits(s,t,!1,!0,i,n)}_applyUndoRedoEdits(e,t,i,n,s,r){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit(),this._isUndoing=i,this._isRedoing=n,this.applyEdits(e,!1),this.setEOL(t),this._overwriteAlternativeVersionId(s)}finally{this._isUndoing=!1,this._isRedoing=!1,this._eventEmitter.endDeferredEmit(r),this._onDidChangeDecorations.endDeferredEmit()}}applyEdits(e,t=!1){try{this._onDidChangeDecorations.beginDeferredEmit(),this._eventEmitter.beginDeferredEmit();const i=this._validateEditOperations(e);return this._doApplyEdits(i,t)}finally{this._eventEmitter.endDeferredEmit(),this._onDidChangeDecorations.endDeferredEmit()}}_doApplyEdits(e,t){const i=this._buffer.getLineCount(),n=this._buffer.applyEdits(e,this._options.trimAutoWhitespace,t),s=this._buffer.getLineCount(),r=n.changes;if(this._trimAutoWhitespaceLines=n.trimAutoWhitespaceLineNumbers,r.length!==0){for(let c=0,d=r.length;c<d;c++){const h=r[c];this._decorationsTree.acceptReplace(h.rangeOffset,h.rangeLength,h.text.length,h.forceMoveMarkers)}const a=[];this._increaseVersionId();let l=i;for(let c=0,d=r.length;c<d;c++){const h=r[c],[u]=Mh(h.text);this._onDidChangeDecorations.fire();const g=h.range.startLineNumber,f=h.range.endLineNumber,m=f-g,_=u,b=Math.min(m,_),v=_-m,y=s-l-v+g,C=y,w=y+_,x=this._decorationsTree.getInjectedTextInInterval(this,this.getOffsetAt(new A(C,1)),this.getOffsetAt(new A(w,this.getLineMaxColumn(w))),0),k=Na.fromDecorations(x),E=new Gc(k);for(let N=b;N>=0;N--){const z=g+N,B=y+N;E.takeFromEndWhile(Z=>Z.lineNumber>B);const U=E.takeFromEndWhile(Z=>Z.lineNumber===B);a.push(new c7(z,this.getLineContent(B),U))}if(b<m){const N=g+b;a.push(new lhe(N+1,f))}if(b<_){const N=new Gc(k),z=g+b,B=_-b,U=s-l-B+z+1,Z=[],V=[];for(let Q=0;Q<B;Q++){const le=U+Q;V[Q]=this.getLineContent(le),N.takeWhile(ge=>ge.lineNumber<le),Z[Q]=N.takeWhile(ge=>ge.lineNumber===le)}a.push(new che(z+1,g+_,V,Z))}l+=v}this._emitContentChangedEvent(new Um(a,this.getVersionId(),this._isUndoing,this._isRedoing),{changes:r,eol:this._buffer.getEOL(),isEolChange:!1,versionId:this.getVersionId(),isUndoing:this._isUndoing,isRedoing:this._isRedoing,isFlush:!1})}return n.reverseEdits===null?void 0:n.reverseEdits}undo(){return this._undoRedoService.undo(this.uri)}canUndo(){return this._undoRedoService.canUndo(this.uri)}redo(){return this._undoRedoService.redo(this.uri)}canRedo(){return this._undoRedoService.canRedo(this.uri)}handleBeforeFireDecorationsChangedEvent(e){if(e===null||e.size===0)return;const i=Array.from(e).map(n=>new c7(n,this.getLineContent(n),this._getInjectedTextInLine(n)));this._onDidChangeInjectedText.fire(new W$(i))}changeDecorations(e,t=0){this._assertNotDisposed();try{return this._onDidChangeDecorations.beginDeferredEmit(),this._changeDecorations(t,e)}finally{this._onDidChangeDecorations.endDeferredEmit()}}_changeDecorations(e,t){const i={addDecoration:(s,r)=>this._deltaDecorationsImpl(e,[],[{range:s,options:r}])[0],changeDecoration:(s,r)=>{this._changeDecorationImpl(s,r)},changeDecorationOptions:(s,r)=>{this._changeDecorationOptionsImpl(s,g7(r))},removeDecoration:s=>{this._deltaDecorationsImpl(e,[s],[])},deltaDecorations:(s,r)=>s.length===0&&r.length===0?[]:this._deltaDecorationsImpl(e,s,r)};let n=null;try{n=t(i)}catch(s){Ae(s)}return i.addDecoration=Zb,i.changeDecoration=Zb,i.changeDecorationOptions=Zb,i.removeDecoration=Zb,i.deltaDecorations=Zb,n}deltaDecorations(e,t,i=0){if(this._assertNotDisposed(),e||(e=[]),e.length===0&&t.length===0)return[];try{return this._deltaDecorationCallCnt++,this._deltaDecorationCallCnt>1&&(console.warn("Invoking deltaDecorations recursively could lead to leaking decorations."),Ae(new Error("Invoking deltaDecorations recursively could lead to leaking decorations."))),this._onDidChangeDecorations.beginDeferredEmit(),this._deltaDecorationsImpl(i,e,t)}finally{this._onDidChangeDecorations.endDeferredEmit(),this._deltaDecorationCallCnt--}}_getTrackedRange(e){return this.getDecorationRange(e)}_setTrackedRange(e,t,i){const n=e?this._decorations[e]:null;if(!n)return t?this._deltaDecorationsImpl(0,[],[{range:t,options:u7[i]}],!0)[0]:null;if(!t)return this._decorationsTree.delete(n),delete this._decorations[n.id],null;const s=this._validateRangeRelaxedNoAllocations(t),r=this._buffer.getOffsetAt(s.startLineNumber,s.startColumn),a=this._buffer.getOffsetAt(s.endLineNumber,s.endColumn);return this._decorationsTree.delete(n),n.reset(this.getVersionId(),r,a,s),n.setOptions(u7[i]),this._decorationsTree.insert(n),n.id}removeAllDecorationsWithOwnerId(e){if(this._isDisposed)return;const t=this._decorationsTree.collectNodesFromOwner(e);for(let i=0,n=t.length;i<n;i++){const s=t[i];this._decorationsTree.delete(s),delete this._decorations[s.id]}}getDecorationOptions(e){const t=this._decorations[e];return t?t.options:null}getDecorationRange(e){const t=this._decorations[e];return t?this._decorationsTree.getNodeRange(this,t):null}getLineDecorations(e,t=0,i=!1){return e<1||e>this.getLineCount()?[]:this.getLinesDecorations(e,e,t,i)}getLinesDecorations(e,t,i=0,n=!1,s=!1){const r=this.getLineCount(),a=Math.min(r,Math.max(1,e)),l=Math.min(r,Math.max(1,t)),c=this.getLineMaxColumn(l),d=new L(a,1,l,c),h=this._getDecorationsInRange(d,i,n,s);return KN(h,this._decorationProvider.getDecorationsInRange(d,i,n)),h}getDecorationsInRange(e,t=0,i=!1,n=!1,s=!1){const r=this.validateRange(e),a=this._getDecorationsInRange(r,t,i,s);return KN(a,this._decorationProvider.getDecorationsInRange(r,t,i,n)),a}getOverviewRulerDecorations(e=0,t=!1){return this._decorationsTree.getAll(this,e,t,!0,!1)}getInjectedTextDecorations(e=0){return this._decorationsTree.getAllInjectedText(this,e)}_getInjectedTextInLine(e){const t=this._buffer.getOffsetAt(e,1),i=t+this._buffer.getLineLength(e),n=this._decorationsTree.getInjectedTextInInterval(this,t,i,0);return Na.fromDecorations(n).filter(s=>s.lineNumber===e)}getAllDecorations(e=0,t=!1){let i=this._decorationsTree.getAll(this,e,t,!1,!1);return i=i.concat(this._decorationProvider.getAllDecorations(e,t)),i}getAllMarginDecorations(e=0){return this._decorationsTree.getAll(this,e,!1,!1,!0)}_getDecorationsInRange(e,t,i,n){const s=this._buffer.getOffsetAt(e.startLineNumber,e.startColumn),r=this._buffer.getOffsetAt(e.endLineNumber,e.endColumn);return this._decorationsTree.getAllInInterval(this,s,r,t,i,n)}getRangeAt(e,t){return this._buffer.getRangeAt(e,t-e)}_changeDecorationImpl(e,t){const i=this._decorations[e];if(!i)return;if(i.options.after){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.endLineNumber)}if(i.options.before){const a=this.getDecorationRange(e);this._onDidChangeDecorations.recordLineAffectedByInjectedText(a.startLineNumber)}const n=this._validateRangeRelaxedNoAllocations(t),s=this._buffer.getOffsetAt(n.startLineNumber,n.startColumn),r=this._buffer.getOffsetAt(n.endLineNumber,n.endColumn);this._decorationsTree.delete(i),i.reset(this.getVersionId(),s,r,n),this._decorationsTree.insert(i),this._onDidChangeDecorations.checkAffectedAndFire(i.options),i.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.endLineNumber),i.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(n.startLineNumber)}_changeDecorationOptionsImpl(e,t){const i=this._decorations[e];if(!i)return;const n=!!(i.options.overviewRuler&&i.options.overviewRuler.color),s=!!(t.overviewRuler&&t.overviewRuler.color);if(this._onDidChangeDecorations.checkAffectedAndFire(i.options),this._onDidChangeDecorations.checkAffectedAndFire(t),i.options.after||t.after){const l=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.endLineNumber)}if(i.options.before||t.before){const l=this._decorationsTree.getNodeRange(this,i);this._onDidChangeDecorations.recordLineAffectedByInjectedText(l.startLineNumber)}const r=n!==s,a=bhe(t)!==G1(i);r||a?(this._decorationsTree.delete(i),i.setOptions(t),this._decorationsTree.insert(i)):i.setOptions(t)}_deltaDecorationsImpl(e,t,i,n=!1){const s=this.getVersionId(),r=t.length;let a=0;const l=i.length;let c=0;this._onDidChangeDecorations.beginDeferredEmit();try{const d=new Array(l);for(;a<r||c<l;){let h=null;if(a<r){do h=this._decorations[t[a++]];while(!h&&a<r);if(h){if(h.options.after){const u=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(u.endLineNumber)}if(h.options.before){const u=this._decorationsTree.getNodeRange(this,h);this._onDidChangeDecorations.recordLineAffectedByInjectedText(u.startLineNumber)}this._decorationsTree.delete(h),n||this._onDidChangeDecorations.checkAffectedAndFire(h.options)}}if(c<l){if(!h){const b=++this._lastDecorationId,v=`${this._instanceId};${b}`;h=new R$(v,0,0),this._decorations[v]=h}const u=i[c],g=this._validateRangeRelaxedNoAllocations(u.range),f=g7(u.options),m=this._buffer.getOffsetAt(g.startLineNumber,g.startColumn),_=this._buffer.getOffsetAt(g.endLineNumber,g.endColumn);h.ownerId=e,h.reset(s,m,_,g),h.setOptions(f),h.options.after&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.endLineNumber),h.options.before&&this._onDidChangeDecorations.recordLineAffectedByInjectedText(g.startLineNumber),n||this._onDidChangeDecorations.checkAffectedAndFire(f),this._decorationsTree.insert(h),d[c]=h.id,c++}else h&&delete this._decorations[h.id]}return d}finally{this._onDidChangeDecorations.endDeferredEmit()}}getLanguageId(){return this.tokenization.getLanguageId()}setLanguage(e,t){typeof e=="string"?(this._languageSelectionListener.clear(),this._setLanguage(e,t)):(this._languageSelectionListener.value=e.onDidChange(()=>this._setLanguage(e.languageId,t)),this._setLanguage(e.languageId,t))}_setLanguage(e,t){this.tokenization.setLanguageId(e,t),this._languageService.requestRichLanguageFeatures(e)}getLanguageIdAtPosition(e,t){return this.tokenization.getLanguageIdAtPosition(e,t)}getWordAtPosition(e){return this._tokenizationTextModelPart.getWordAtPosition(e)}getWordUntilPosition(e){return this._tokenizationTextModelPart.getWordUntilPosition(e)}normalizePosition(e,t){return e}getLineIndentColumn(e){return _he(this.getLineContent(e))+1}},xu=fa,fa._MODEL_SYNC_LIMIT=50*1024*1024,fa.LARGE_FILE_SIZE_THRESHOLD=20*1024*1024,fa.LARGE_FILE_LINE_COUNT_THRESHOLD=300*1e3,fa.LARGE_FILE_HEAP_OPERATION_THRESHOLD=256*1024*1024,fa.DEFAULT_CREATION_OPTIONS={isForSimpleWidget:!1,tabSize:Rn.tabSize,indentSize:Rn.indentSize,insertSpaces:Rn.insertSpaces,detectIndentation:!1,defaultEOL:1,trimAutoWhitespace:Rn.trimAutoWhitespace,largeFileOptimizations:Rn.largeFileOptimizations,bracketPairColorizationOptions:Rn.bracketPairColorizationOptions},fa);Ca=xu=hhe([HS(4,s5),HS(5,ti),HS(6,li),HS(7,Ce)],Ca);function _he(o){let e=0;for(const t of o)if(t===" "||t==="	")e++;else break;return e}function HI(o){return!!(o.options.overviewRuler&&o.options.overviewRuler.color)}function bhe(o){return!!o.after||!!o.before}function G1(o){return!!o.options.after||!!o.options.before}class h7{constructor(){this._decorationsTree0=new FI,this._decorationsTree1=new FI,this._injectedTextDecorationsTree=new FI}ensureAllNodesHaveRanges(e){this.getAll(e,0,!1,!1,!1)}_ensureNodesHaveRanges(e,t){for(const i of t)i.range===null&&(i.range=e.getRangeAt(i.cachedAbsoluteStart,i.cachedAbsoluteEnd));return t}getAllInInterval(e,t,i,n,s,r){const a=e.getVersionId(),l=this._intervalSearch(t,i,n,s,a,r);return this._ensureNodesHaveRanges(e,l)}_intervalSearch(e,t,i,n,s,r){const a=this._decorationsTree0.intervalSearch(e,t,i,n,s,r),l=this._decorationsTree1.intervalSearch(e,t,i,n,s,r),c=this._injectedTextDecorationsTree.intervalSearch(e,t,i,n,s,r);return a.concat(l).concat(c)}getInjectedTextInInterval(e,t,i,n){const s=e.getVersionId(),r=this._injectedTextDecorationsTree.intervalSearch(t,i,n,!1,s,!1);return this._ensureNodesHaveRanges(e,r).filter(a=>a.options.showIfCollapsed||!a.range.isEmpty())}getAllInjectedText(e,t){const i=e.getVersionId(),n=this._injectedTextDecorationsTree.search(t,!1,i,!1);return this._ensureNodesHaveRanges(e,n).filter(s=>s.options.showIfCollapsed||!s.range.isEmpty())}getAll(e,t,i,n,s){const r=e.getVersionId(),a=this._search(t,i,n,r,s);return this._ensureNodesHaveRanges(e,a)}_search(e,t,i,n,s){if(i)return this._decorationsTree1.search(e,t,n,s);{const r=this._decorationsTree0.search(e,t,n,s),a=this._decorationsTree1.search(e,t,n,s),l=this._injectedTextDecorationsTree.search(e,t,n,s);return r.concat(a).concat(l)}}collectNodesFromOwner(e){const t=this._decorationsTree0.collectNodesFromOwner(e),i=this._decorationsTree1.collectNodesFromOwner(e),n=this._injectedTextDecorationsTree.collectNodesFromOwner(e);return t.concat(i).concat(n)}collectNodesPostOrder(){const e=this._decorationsTree0.collectNodesPostOrder(),t=this._decorationsTree1.collectNodesPostOrder(),i=this._injectedTextDecorationsTree.collectNodesPostOrder();return e.concat(t).concat(i)}insert(e){G1(e)?this._injectedTextDecorationsTree.insert(e):HI(e)?this._decorationsTree1.insert(e):this._decorationsTree0.insert(e)}delete(e){G1(e)?this._injectedTextDecorationsTree.delete(e):HI(e)?this._decorationsTree1.delete(e):this._decorationsTree0.delete(e)}getNodeRange(e,t){const i=e.getVersionId();return t.cachedVersionId!==i&&this._resolveNode(t,i),t.range===null&&(t.range=e.getRangeAt(t.cachedAbsoluteStart,t.cachedAbsoluteEnd)),t.range}_resolveNode(e,t){G1(e)?this._injectedTextDecorationsTree.resolveNode(e,t):HI(e)?this._decorationsTree1.resolveNode(e,t):this._decorationsTree0.resolveNode(e,t)}acceptReplace(e,t,i,n){this._decorationsTree0.acceptReplace(e,t,i,n),this._decorationsTree1.acceptReplace(e,t,i,n),this._injectedTextDecorationsTree.acceptReplace(e,t,i,n)}}function ja(o){return o.replace(/[^a-z0-9\-_]/gi," ")}class V${constructor(e){this.color=e.color||"",this.darkColor=e.darkColor||""}}class vhe extends V${constructor(e){super(e),this._resolvedColor=null,this.position=typeof e.position=="number"?e.position:Ao.Center}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=null}_resolveColor(e,t){if(typeof e=="string")return e;const i=e?t.getColor(e.id):null;return i?i.toString():""}}class Che{constructor(e){this.position=e?.position??Ur.Center,this.persistLane=e?.persistLane}}class yhe extends V${constructor(e){super(e),this.position=e.position,this.sectionHeaderStyle=e.sectionHeaderStyle??null,this.sectionHeaderText=e.sectionHeaderText??null}getColor(e){return this._resolvedColor||(e.type!=="light"&&this.darkColor?this._resolvedColor=this._resolveColor(this.darkColor,e):this._resolvedColor=this._resolveColor(this.color,e)),this._resolvedColor}invalidateCachedColor(){this._resolvedColor=void 0}_resolveColor(e,t){return typeof e=="string"?j.fromHex(e):t.getColor(e.id)}}class Wh{static from(e){return e instanceof Wh?e:new Wh(e)}constructor(e){this.content=e.content||"",this.inlineClassName=e.inlineClassName||null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.attachedData=e.attachedData||null,this.cursorStops=e.cursorStops||null}}class Fe{static register(e){return new Fe(e)}static createDynamic(e){return new Fe(e)}constructor(e){this.description=e.description,this.blockClassName=e.blockClassName?ja(e.blockClassName):null,this.blockDoesNotCollapse=e.blockDoesNotCollapse??null,this.blockIsAfterEnd=e.blockIsAfterEnd??null,this.blockPadding=e.blockPadding??null,this.stickiness=e.stickiness||0,this.zIndex=e.zIndex||0,this.className=e.className?ja(e.className):null,this.shouldFillLineOnLineBreak=e.shouldFillLineOnLineBreak??null,this.hoverMessage=e.hoverMessage||null,this.glyphMarginHoverMessage=e.glyphMarginHoverMessage||null,this.lineNumberHoverMessage=e.lineNumberHoverMessage||null,this.isWholeLine=e.isWholeLine||!1,this.showIfCollapsed=e.showIfCollapsed||!1,this.collapseOnReplaceEdit=e.collapseOnReplaceEdit||!1,this.overviewRuler=e.overviewRuler?new vhe(e.overviewRuler):null,this.minimap=e.minimap?new yhe(e.minimap):null,this.glyphMargin=e.glyphMarginClassName?new Che(e.glyphMargin):null,this.glyphMarginClassName=e.glyphMarginClassName?ja(e.glyphMarginClassName):null,this.linesDecorationsClassName=e.linesDecorationsClassName?ja(e.linesDecorationsClassName):null,this.lineNumberClassName=e.lineNumberClassName?ja(e.lineNumberClassName):null,this.linesDecorationsTooltip=e.linesDecorationsTooltip?FQ(e.linesDecorationsTooltip):null,this.firstLineDecorationClassName=e.firstLineDecorationClassName?ja(e.firstLineDecorationClassName):null,this.marginClassName=e.marginClassName?ja(e.marginClassName):null,this.inlineClassName=e.inlineClassName?ja(e.inlineClassName):null,this.inlineClassNameAffectsLetterSpacing=e.inlineClassNameAffectsLetterSpacing||!1,this.beforeContentClassName=e.beforeContentClassName?ja(e.beforeContentClassName):null,this.afterContentClassName=e.afterContentClassName?ja(e.afterContentClassName):null,this.after=e.after?Wh.from(e.after):null,this.before=e.before?Wh.from(e.before):null,this.hideInCommentTokens=e.hideInCommentTokens??!1,this.hideInStringTokens=e.hideInStringTokens??!1}}Fe.EMPTY=Fe.register({description:"empty"});const u7=[Fe.register({description:"tracked-range-always-grows-when-typing-at-edges",stickiness:0}),Fe.register({description:"tracked-range-never-grows-when-typing-at-edges",stickiness:1}),Fe.register({description:"tracked-range-grows-only-when-typing-before",stickiness:2}),Fe.register({description:"tracked-range-grows-only-when-typing-after",stickiness:3})];function g7(o){return o instanceof Fe?o:Fe.createDynamic(o)}class whe extends F{constructor(e){super(),this.handleBeforeFire=e,this._actual=this._register(new O),this.event=this._actual.event,this._affectedInjectedTextLines=null,this._deferredCnt=0,this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._affectsLineNumber=!1}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(){this._deferredCnt--,this._deferredCnt===0&&(this._shouldFireDeferred&&this.doFire(),this._affectedInjectedTextLines?.clear(),this._affectedInjectedTextLines=null)}recordLineAffectedByInjectedText(e){this._affectedInjectedTextLines||(this._affectedInjectedTextLines=new Set),this._affectedInjectedTextLines.add(e)}checkAffectedAndFire(e){this._affectsMinimap||=!!e.minimap?.position,this._affectsOverviewRuler||=!!e.overviewRuler?.color,this._affectsGlyphMargin||=!!e.glyphMarginClassName,this._affectsLineNumber||=!!e.lineNumberClassName,this.tryFire()}fire(){this._affectsMinimap=!0,this._affectsOverviewRuler=!0,this._affectsGlyphMargin=!0,this.tryFire()}tryFire(){this._deferredCnt===0?this.doFire():this._shouldFireDeferred=!0}doFire(){this.handleBeforeFire(this._affectedInjectedTextLines);const e={affectsMinimap:this._affectsMinimap,affectsOverviewRuler:this._affectsOverviewRuler,affectsGlyphMargin:this._affectsGlyphMargin,affectsLineNumber:this._affectsLineNumber};this._shouldFireDeferred=!1,this._affectsMinimap=!1,this._affectsOverviewRuler=!1,this._affectsGlyphMargin=!1,this._actual.fire(e)}}class She extends F{constructor(){super(),this._fastEmitter=this._register(new O),this.fastEvent=this._fastEmitter.event,this._slowEmitter=this._register(new O),this.slowEvent=this._slowEmitter.event,this._deferredCnt=0,this._deferredEvent=null}beginDeferredEmit(){this._deferredCnt++}endDeferredEmit(e=null){if(this._deferredCnt--,this._deferredCnt===0&&this._deferredEvent!==null){this._deferredEvent.rawContentChangedEvent.resultingSelection=e;const t=this._deferredEvent;this._deferredEvent=null,this._fastEmitter.fire(t),this._slowEmitter.fire(t)}}fire(e){if(this._deferredCnt>0){this._deferredEvent?this._deferredEvent=this._deferredEvent.merge(e):this._deferredEvent=e;return}this._fastEmitter.fire(e),this._slowEmitter.fire(e)}}var xhe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},US=function(o,e){return function(t,i){e(t,i,o)}},Mp;function uu(o){return o.toString()}let Lhe=class{constructor(e,t,i){this.model=e,this._modelEventListeners=new $,this.model=e,this._modelEventListeners.add(e.onWillDispose(()=>t(e))),this._modelEventListeners.add(e.onDidChangeLanguage(n=>i(e,n)))}dispose(){this._modelEventListeners.dispose()}};const khe=us||Qe?1:2;class Ehe{constructor(e,t,i,n,s,r,a,l){this.uri=e,this.initialUndoRedoSnapshot=t,this.time=i,this.sharesUndoRedoStack=n,this.heapSize=s,this.sha1=r,this.versionId=a,this.alternativeVersionId=l}}var vg;let qA=(vg=class extends F{constructor(e,t,i,n){super(),this._configurationService=e,this._resourcePropertiesService=t,this._undoRedoService=i,this._instantiationService=n,this._onModelAdded=this._register(new O),this.onModelAdded=this._onModelAdded.event,this._onModelRemoved=this._register(new O),this.onModelRemoved=this._onModelRemoved.event,this._onModelModeChanged=this._register(new O),this.onModelLanguageChanged=this._onModelModeChanged.event,this._modelCreationOptionsByLanguageAndResource=Object.create(null),this._models={},this._disposedModels=new Map,this._disposedModelsHeapSize=0,this._register(this._configurationService.onDidChangeConfiguration(s=>this._updateModelOptions(s))),this._updateModelOptions(void 0)}static _readModelOptions(e,t){let i=Rn.tabSize;if(e.editor&&typeof e.editor.tabSize<"u"){const u=parseInt(e.editor.tabSize,10);isNaN(u)||(i=u),i<1&&(i=1)}let n="tabSize";if(e.editor&&typeof e.editor.indentSize<"u"&&e.editor.indentSize!=="tabSize"){const u=parseInt(e.editor.indentSize,10);isNaN(u)||(n=Math.max(u,1))}let s=Rn.insertSpaces;e.editor&&typeof e.editor.insertSpaces<"u"&&(s=e.editor.insertSpaces==="false"?!1:!!e.editor.insertSpaces);let r=khe;const a=e.eol;a===`\r
`?r=2:a===`
`&&(r=1);let l=Rn.trimAutoWhitespace;e.editor&&typeof e.editor.trimAutoWhitespace<"u"&&(l=e.editor.trimAutoWhitespace==="false"?!1:!!e.editor.trimAutoWhitespace);let c=Rn.detectIndentation;e.editor&&typeof e.editor.detectIndentation<"u"&&(c=e.editor.detectIndentation==="false"?!1:!!e.editor.detectIndentation);let d=Rn.largeFileOptimizations;e.editor&&typeof e.editor.largeFileOptimizations<"u"&&(d=e.editor.largeFileOptimizations==="false"?!1:!!e.editor.largeFileOptimizations);let h=Rn.bracketPairColorizationOptions;return e.editor?.bracketPairColorization&&typeof e.editor.bracketPairColorization=="object"&&(h={enabled:!!e.editor.bracketPairColorization.enabled,independentColorPoolPerBracketType:!!e.editor.bracketPairColorization.independentColorPoolPerBracketType}),{isForSimpleWidget:t,tabSize:i,indentSize:n,insertSpaces:s,detectIndentation:c,defaultEOL:r,trimAutoWhitespace:l,largeFileOptimizations:d,bracketPairColorizationOptions:h}}_getEOL(e,t){if(e)return this._resourcePropertiesService.getEOL(e,t);const i=this._configurationService.getValue("files.eol",{overrideIdentifier:t});return i&&typeof i=="string"&&i!=="auto"?i:Js===3||Js===2?`
`:`\r
`}_shouldRestoreUndoStack(){const e=this._configurationService.getValue("files.restoreUndoStack");return typeof e=="boolean"?e:!0}getCreationOptions(e,t,i){const n=typeof e=="string"?e:e.languageId;let s=this._modelCreationOptionsByLanguageAndResource[n+t];if(!s){const r=this._configurationService.getValue("editor",{overrideIdentifier:n,resource:t}),a=this._getEOL(t,n);s=Mp._readModelOptions({editor:r,eol:a},i),this._modelCreationOptionsByLanguageAndResource[n+t]=s}return s}_updateModelOptions(e){const t=this._modelCreationOptionsByLanguageAndResource;this._modelCreationOptionsByLanguageAndResource=Object.create(null);const i=Object.keys(this._models);for(let n=0,s=i.length;n<s;n++){const r=i[n],a=this._models[r],l=a.model.getLanguageId(),c=a.model.uri;if(e&&!e.affectsConfiguration("editor",{overrideIdentifier:l,resource:c})&&!e.affectsConfiguration("files.eol",{overrideIdentifier:l,resource:c}))continue;const d=t[l+c],h=this.getCreationOptions(l,c,a.model.isForSimpleWidget);Mp._setModelOptionsForModel(a.model,h,d)}}static _setModelOptionsForModel(e,t,i){i&&i.defaultEOL!==t.defaultEOL&&e.getLineCount()===1&&e.setEOL(t.defaultEOL===1?0:1),!(i&&i.detectIndentation===t.detectIndentation&&i.insertSpaces===t.insertSpaces&&i.tabSize===t.tabSize&&i.indentSize===t.indentSize&&i.trimAutoWhitespace===t.trimAutoWhitespace&&eo(i.bracketPairColorizationOptions,t.bracketPairColorizationOptions))&&(t.detectIndentation?(e.detectIndentation(t.insertSpaces,t.tabSize),e.updateOptions({trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions})):e.updateOptions({insertSpaces:t.insertSpaces,tabSize:t.tabSize,indentSize:t.indentSize,trimAutoWhitespace:t.trimAutoWhitespace,bracketColorizationOptions:t.bracketPairColorizationOptions}))}_insertDisposedModel(e){this._disposedModels.set(uu(e.uri),e),this._disposedModelsHeapSize+=e.heapSize}_removeDisposedModel(e){const t=this._disposedModels.get(uu(e));return t&&(this._disposedModelsHeapSize-=t.heapSize),this._disposedModels.delete(uu(e)),t}_ensureDisposedModelsHeapSize(e){if(this._disposedModelsHeapSize>e){const t=[];for(this._disposedModels.forEach(i=>{i.sharesUndoRedoStack||t.push(i)}),t.sort((i,n)=>i.time-n.time);t.length>0&&this._disposedModelsHeapSize>e;){const i=t.shift();this._removeDisposedModel(i.uri),i.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(i.initialUndoRedoSnapshot)}}}_createModelData(e,t,i,n){const s=this.getCreationOptions(t,i,n),r=this._instantiationService.createInstance(Ca,e,t,s,i);if(i&&this._disposedModels.has(uu(i))){const c=this._removeDisposedModel(i),d=this._undoRedoService.getElements(i),h=this._getSHA1Computer(),u=h.canComputeSHA1(r)?h.computeSHA1(r)===c.sha1:!1;if(u||c.sharesUndoRedoStack){for(const g of d.past)mc(g)&&g.matchesResource(i)&&g.setModel(r);for(const g of d.future)mc(g)&&g.matchesResource(i)&&g.setModel(r);this._undoRedoService.setElementsValidFlag(i,!0,g=>mc(g)&&g.matchesResource(i)),u&&(r._overwriteVersionId(c.versionId),r._overwriteAlternativeVersionId(c.alternativeVersionId),r._overwriteInitialUndoRedoSnapshot(c.initialUndoRedoSnapshot))}else c.initialUndoRedoSnapshot!==null&&this._undoRedoService.restoreSnapshot(c.initialUndoRedoSnapshot)}const a=uu(r.uri);if(this._models[a])throw new Error("ModelService: Cannot add model because it already exists!");const l=new Lhe(r,c=>this._onWillDispose(c),(c,d)=>this._onDidChangeLanguage(c,d));return this._models[a]=l,l}createModel(e,t,i,n=!1){let s;return t?s=this._createModelData(e,t,i,n):s=this._createModelData(e,hs,i,n),this._onModelAdded.fire(s.model),s.model}getModels(){const e=[],t=Object.keys(this._models);for(let i=0,n=t.length;i<n;i++){const s=t[i];e.push(this._models[s].model)}return e}getModel(e){const t=uu(e),i=this._models[t];return i?i.model:null}_schemaShouldMaintainUndoRedoElements(e){return e.scheme===Oe.file||e.scheme===Oe.vscodeRemote||e.scheme===Oe.vscodeUserData||e.scheme===Oe.vscodeNotebookCell||e.scheme==="fake-fs"}_onWillDispose(e){const t=uu(e.uri),i=this._models[t],n=this._undoRedoService.getUriComparisonKey(e.uri)!==e.uri.toString();let s=!1,r=0;if(n||this._shouldRestoreUndoStack()&&this._schemaShouldMaintainUndoRedoElements(e.uri)){const c=this._undoRedoService.getElements(e.uri);if(c.past.length>0||c.future.length>0){for(const d of c.past)mc(d)&&d.matchesResource(e.uri)&&(s=!0,r+=d.heapSize(e.uri),d.setModel(e.uri));for(const d of c.future)mc(d)&&d.matchesResource(e.uri)&&(s=!0,r+=d.heapSize(e.uri),d.setModel(e.uri))}}const a=Mp.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK,l=this._getSHA1Computer();if(s)if(!n&&(r>a||!l.canComputeSHA1(e))){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}else this._ensureDisposedModelsHeapSize(a-r),this._undoRedoService.setElementsValidFlag(e.uri,!1,c=>mc(c)&&c.matchesResource(e.uri)),this._insertDisposedModel(new Ehe(e.uri,i.model.getInitialUndoRedoSnapshot(),Date.now(),n,r,l.computeSHA1(e),e.getVersionId(),e.getAlternativeVersionId()));else if(!n){const c=i.model.getInitialUndoRedoSnapshot();c!==null&&this._undoRedoService.restoreSnapshot(c)}delete this._models[t],i.dispose(),delete this._modelCreationOptionsByLanguageAndResource[e.getLanguageId()+e.uri],this._onModelRemoved.fire(e)}_onDidChangeLanguage(e,t){const i=t.oldLanguage,n=e.getLanguageId(),s=this.getCreationOptions(i,e.uri,e.isForSimpleWidget),r=this.getCreationOptions(n,e.uri,e.isForSimpleWidget);Mp._setModelOptionsForModel(e,r,s),this._onModelModeChanged.fire({model:e,oldLanguageId:i})}_getSHA1Computer(){return new ZA}},Mp=vg,vg.MAX_MEMORY_FOR_CLOSED_FILES_UNDO_STACK=20*1024*1024,vg);qA=Mp=xhe([US(0,Ke),US(1,OU),US(2,s5),US(3,Ce)],qA);const Ak=class Ak{canComputeSHA1(e){return e.getValueLength()<=Ak.MAX_MODEL_SIZE}computeSHA1(e){const t=new dP,i=e.createSnapshot();let n;for(;n=i.read();)t.update(n);return t.digest()}};Ak.MAX_MODEL_SIZE=10*1024*1024;let ZA=Ak;var YA;(function(o){o[o.PRESERVE=0]="PRESERVE",o[o.LAST=1]="LAST"})(YA||(YA={}));const Yf={Quickaccess:"workbench.contributions.quickaccess"};class The{constructor(){this.providers=[],this.defaultProvider=void 0}registerQuickAccessProvider(e){return e.prefix.length===0?this.defaultProvider=e:this.providers.push(e),this.providers.sort((t,i)=>i.prefix.length-t.prefix.length),ve(()=>{this.providers.splice(this.providers.indexOf(e),1),this.defaultProvider===e&&(this.defaultProvider=void 0)})}getQuickAccessProviders(){return Vr([this.defaultProvider,...this.providers])}getQuickAccessProvider(e){return e&&this.providers.find(i=>e.startsWith(i.prefix))||void 0||this.defaultProvider}}ai.add(Yf.Quickaccess,new The);const Dhe={ctrlCmd:!1,alt:!1};var N_;(function(o){o[o.Blur=1]="Blur",o[o.Gesture=2]="Gesture",o[o.Other=3]="Other"})(N_||(N_={}));var ca;(function(o){o[o.NONE=0]="NONE",o[o.FIRST=1]="FIRST",o[o.SECOND=2]="SECOND",o[o.LAST=3]="LAST"})(ca||(ca={}));var Wt;(function(o){o[o.First=1]="First",o[o.Second=2]="Second",o[o.Last=3]="Last",o[o.Next=4]="Next",o[o.Previous=5]="Previous",o[o.NextPage=6]="NextPage",o[o.PreviousPage=7]="PreviousPage",o[o.NextSeparator=8]="NextSeparator",o[o.PreviousSeparator=9]="PreviousSeparator"})(Wt||(Wt={}));var wx;(function(o){o[o.Title=1]="Title",o[o.Inline=2]="Inline"})(wx||(wx={}));const vr=Je("quickInputService");var Ihe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},f7=function(o,e){return function(t,i){e(t,i,o)}};let XA=class extends F{constructor(e,t){super(),this.quickInputService=e,this.instantiationService=t,this.registry=ai.as(Yf.Quickaccess),this.mapProviderToDescriptor=new Map,this.lastAcceptedPickerValues=new Map,this.visibleQuickAccess=void 0}show(e="",t){this.doShowOrPick(e,!1,t)}doShowOrPick(e,t,i){const[n,s]=this.getOrInstantiateProvider(e,i?.enabledProviderPrefixes),r=this.visibleQuickAccess,a=r?.descriptor;if(r&&s&&a===s){e!==s.prefix&&!i?.preserveValue&&(r.picker.value=e),this.adjustValueSelection(r.picker,s,i);return}if(s&&!i?.preserveValue){let f;if(r&&a&&a!==s){const m=r.value.substr(a.prefix.length);m&&(f=`${s.prefix}${m}`)}if(!f){const m=n?.defaultFilterValue;m===YA.LAST?f=this.lastAcceptedPickerValues.get(s):typeof m=="string"&&(f=`${s.prefix}${m}`)}typeof f=="string"&&(e=f)}const l=r?.picker?.valueSelection,c=r?.picker?.value,d=new $,h=d.add(this.quickInputService.createQuickPick({useSeparators:!0}));h.value=e,this.adjustValueSelection(h,s,i),h.placeholder=i?.placeholder??s?.placeholder,h.quickNavigate=i?.quickNavigateConfiguration,h.hideInput=!!h.quickNavigate&&!r,(typeof i?.itemActivation=="number"||i?.quickNavigateConfiguration)&&(h.itemActivation=i?.itemActivation??ca.SECOND),h.contextKey=s?.contextKey,h.filterValue=f=>f.substring(s?s.prefix.length:0);let u;t&&(u=new ib,d.add(se.once(h.onWillAccept)(f=>{f.veto(),h.hide()}))),d.add(this.registerPickerListeners(h,n,s,e,i));const g=d.add(new ri);if(n&&d.add(n.provide(h,g.token,i?.providerOptions)),se.once(h.onDidHide)(()=>{h.selectedItems.length===0&&g.cancel(),d.dispose(),u?.complete(h.selectedItems.slice(0))}),h.show(),l&&c===e&&(h.valueSelection=l),t)return u?.p}adjustValueSelection(e,t,i){let n;i?.preserveValue?n=[e.value.length,e.value.length]:n=[t?.prefix.length??0,e.value.length],e.valueSelection=n}registerPickerListeners(e,t,i,n,s){const r=new $,a=this.visibleQuickAccess={picker:e,descriptor:i,value:n};return r.add(ve(()=>{a===this.visibleQuickAccess&&(this.visibleQuickAccess=void 0)})),r.add(e.onDidChangeValue(l=>{const[c]=this.getOrInstantiateProvider(l,s?.enabledProviderPrefixes);c!==t?this.show(l,{enabledProviderPrefixes:s?.enabledProviderPrefixes,preserveValue:!0,providerOptions:s?.providerOptions}):a.value=l})),i&&r.add(e.onDidAccept(()=>{this.lastAcceptedPickerValues.set(i,e.value)})),r}getOrInstantiateProvider(e,t){const i=this.registry.getQuickAccessProvider(e);if(!i||t&&!t?.includes(i.prefix))return[void 0,void 0];let n=this.mapProviderToDescriptor.get(i);return n||(n=this.instantiationService.createInstance(i.ctor),this.mapProviderToDescriptor.set(i,n)),[n,i]}};XA=Ihe([f7(0,vr),f7(1,Ce)],XA);class pb extends Go{constructor(e){super(),this._onChange=this._register(new O),this.onChange=this._onChange.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._opts=e,this._checked=this._opts.isChecked;const t=["monaco-custom-toggle"];this._opts.icon&&(this._icon=this._opts.icon,t.push(...ke.asClassNameArray(this._icon))),this._opts.actionClassName&&t.push(...this._opts.actionClassName.split(" ")),this._checked&&t.push("checked"),this.domNode=document.createElement("div"),this._hover=this._register(Ba().setupManagedHover(e.hoverDelegate??bs("mouse"),this.domNode,this._opts.title)),this.domNode.classList.add(...t),this._opts.notFocusable||(this.domNode.tabIndex=0),this.domNode.setAttribute("role","checkbox"),this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.setAttribute("aria-label",this._opts.title),this.applyStyles(),this.onclick(this.domNode,i=>{this.enabled&&(this.checked=!this._checked,this._onChange.fire(!1),i.preventDefault())}),this._register(this.ignoreGesture(this.domNode)),this.onkeydown(this.domNode,i=>{if(i.keyCode===10||i.keyCode===3){this.checked=!this._checked,this._onChange.fire(!0),i.preventDefault(),i.stopPropagation();return}this._onKeyDown.fire(i)})}get enabled(){return this.domNode.getAttribute("aria-disabled")!=="true"}focus(){this.domNode.focus()}get checked(){return this._checked}set checked(e){this._checked=e,this.domNode.setAttribute("aria-checked",String(this._checked)),this.domNode.classList.toggle("checked",this._checked),this.applyStyles()}width(){return 22}applyStyles(){this.domNode&&(this.domNode.style.borderColor=this._checked&&this._opts.inputActiveOptionBorder||"",this.domNode.style.color=this._checked&&this._opts.inputActiveOptionForeground||"inherit",this.domNode.style.backgroundColor=this._checked&&this._opts.inputActiveOptionBackground||"")}enable(){this.domNode.setAttribute("aria-disabled",String(!1))}disable(){this.domNode.setAttribute("aria-disabled",String(!0))}}var Nhe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};class H${constructor(e){this.nodes=e}toString(){return this.nodes.map(e=>typeof e=="string"?e:e.label).join("")}}Nhe([Ti],H$.prototype,"toString",null);const Rhe=/\[([^\]]+)\]\(((?:https?:\/\/|command:|file:)[^\)\s]+)(?: (["'])(.+?)(\3))?\)/gi;function Phe(o){const e=[];let t=0,i;for(;i=Rhe.exec(o);){i.index-t>0&&e.push(o.substring(t,i.index));const[,n,s,,r]=i;r?e.push({label:n,href:s,title:r}):e.push({label:n,href:s}),t=i.index+i[0].length}return t<o.length&&e.push(o.substring(t)),new H$(e)}const zI={},Ahe=new T5("quick-input-button-icon-");function Mhe(o){if(!o)return;let e;const t=o.dark.toString();return zI[t]?e=zI[t]:(e=Ahe.nextId(),A0(`.${e}, .hc-light .${e}`,`background-image: ${jc(o.light||o.dark)}`),A0(`.vs-dark .${e}, .hc-black .${e}`,`background-image: ${jc(o.dark)}`),zI[t]=e),e}function qv(o,e,t){let i=o.iconClass||Mhe(o.iconPath);return o.alwaysVisible&&(i=i?`${i} always-visible`:"always-visible"),{id:e,label:"",tooltip:o.tooltip||"",class:i,enabled:!0,run:t}}function Ohe(o,e,t){pn(e);const i=Phe(o);let n=0;for(const s of i.nodes)if(typeof s=="string")e.append(...nh(s));else{let r=s.title;!r&&s.href.startsWith("command:")?r=p("executeCommand","Click to execute command '{0}'",s.href.substring(8)):r||(r=s.href);const a=ie("a",{href:s.href,title:r,tabIndex:n++},s.label);a.style.textDecoration="underline";const l=g=>{iee(g)&&tt.stop(g,!0),t.callback(s.href)},c=t.disposables.add(new et(a,ee.CLICK)).event,d=t.disposables.add(new et(a,ee.KEY_DOWN)).event,h=se.chain(d,g=>g.filter(f=>{const m=new Pt(f);return m.equals(10)||m.equals(3)}));t.disposables.add(Mn.addTarget(a));const u=t.disposables.add(new et(a,Ot.Tap)).event;se.any(c,u,h)(l,null,t.disposables),e.appendChild(a)}}var Fhe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},p7=function(o,e){return function(t,i){e(t,i,o)}};const z$="inQuickInput",Bhe=new re(z$,!1,p("inQuickInput","Whether keyboard focus is inside the quick input control")),Whe=K.has(z$),U$="quickInputType",Vhe=new re(U$,void 0,p("quickInputType","The type of the currently visible quick input")),G$="cursorAtEndOfQuickInputBox",Hhe=new re(G$,!1,p("cursorAtEndOfQuickInputBox","Whether the cursor in the quick input is at the end of the input box")),zhe=K.has(G$),QA={iconClass:ke.asClassName(J.quickInputBack),tooltip:p("quickInput.back","Back")},Mk=class Mk extends F{constructor(e){super(),this.ui=e,this._widgetUpdated=!1,this.visible=!1,this._enabled=!0,this._busy=!1,this._ignoreFocusOut=!1,this._leftButtons=[],this._rightButtons=[],this._inlineButtons=[],this.buttonsUpdated=!1,this._toggles=[],this.togglesUpdated=!1,this.noValidationMessage=Mk.noPromptMessage,this._severity=ki.Ignore,this.onDidTriggerButtonEmitter=this._register(new O),this.onDidHideEmitter=this._register(new O),this.onWillHideEmitter=this._register(new O),this.onDisposeEmitter=this._register(new O),this.visibleDisposables=this._register(new $),this.onDidHide=this.onDidHideEmitter.event}get title(){return this._title}set title(e){this._title=e,this.update()}get description(){return this._description}set description(e){this._description=e,this.update()}get step(){return this._steps}set step(e){this._steps=e,this.update()}get totalSteps(){return this._totalSteps}set totalSteps(e){this._totalSteps=e,this.update()}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.update()}get contextKey(){return this._contextKey}set contextKey(e){this._contextKey=e,this.update()}get busy(){return this._busy}set busy(e){this._busy=e,this.update()}get ignoreFocusOut(){return this._ignoreFocusOut}set ignoreFocusOut(e){const t=this._ignoreFocusOut!==e&&!Ta;this._ignoreFocusOut=e&&!Ta,t&&this.update()}get titleButtons(){return this._leftButtons.length?[...this._leftButtons,this._rightButtons]:this._rightButtons}get buttons(){return[...this._leftButtons,...this._rightButtons,...this._inlineButtons]}set buttons(e){this._leftButtons=e.filter(t=>t===QA),this._rightButtons=e.filter(t=>t!==QA&&t.location!==wx.Inline),this._inlineButtons=e.filter(t=>t.location===wx.Inline),this.buttonsUpdated=!0,this.update()}get toggles(){return this._toggles}set toggles(e){this._toggles=e??[],this.togglesUpdated=!0,this.update()}get validationMessage(){return this._validationMessage}set validationMessage(e){this._validationMessage=e,this.update()}get severity(){return this._severity}set severity(e){this._severity=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.onDidTriggerButton(e=>{this.buttons.indexOf(e)!==-1&&this.onDidTriggerButtonEmitter.fire(e)})),this.ui.show(this),this.visible=!0,this._lastValidationMessage=void 0,this._lastSeverity=void 0,this.buttons.length&&(this.buttonsUpdated=!0),this.toggles.length&&(this.togglesUpdated=!0),this.update())}hide(){this.visible&&this.ui.hide()}didHide(e=N_.Other){this.visible=!1,this.visibleDisposables.clear(),this.onDidHideEmitter.fire({reason:e})}willHide(e=N_.Other){this.onWillHideEmitter.fire({reason:e})}update(){if(!this.visible)return;const e=this.getTitle();e&&this.ui.title.textContent!==e?this.ui.title.textContent=e:!e&&this.ui.title.innerHTML!=="&nbsp;"&&(this.ui.title.innerText=" ");const t=this.getDescription();if(this.ui.description1.textContent!==t&&(this.ui.description1.textContent=t),this.ui.description2.textContent!==t&&(this.ui.description2.textContent=t),this._widgetUpdated&&(this._widgetUpdated=!1,this._widget?pn(this.ui.widget,this._widget):pn(this.ui.widget)),this.busy&&!this.busyDelay&&(this.busyDelay=new qr,this.busyDelay.setIfNotSet(()=>{this.visible&&this.ui.progressBar.infinite()},800)),!this.busy&&this.busyDelay&&(this.ui.progressBar.stop(),this.busyDelay.cancel(),this.busyDelay=void 0),this.buttonsUpdated){this.buttonsUpdated=!1,this.ui.leftActionBar.clear();const n=this._leftButtons.map((a,l)=>qv(a,`id-${l}`,async()=>this.onDidTriggerButtonEmitter.fire(a)));this.ui.leftActionBar.push(n,{icon:!0,label:!1}),this.ui.rightActionBar.clear();const s=this._rightButtons.map((a,l)=>qv(a,`id-${l}`,async()=>this.onDidTriggerButtonEmitter.fire(a)));this.ui.rightActionBar.push(s,{icon:!0,label:!1}),this.ui.inlineActionBar.clear();const r=this._inlineButtons.map((a,l)=>qv(a,`id-${l}`,async()=>this.onDidTriggerButtonEmitter.fire(a)));this.ui.inlineActionBar.push(r,{icon:!0,label:!1})}if(this.togglesUpdated){this.togglesUpdated=!1;const n=this.toggles?.filter(s=>s instanceof pb)??[];this.ui.inputBox.toggles=n}this.ui.ignoreFocusOut=this.ignoreFocusOut,this.ui.setEnabled(this.enabled),this.ui.setContextKey(this.contextKey);const i=this.validationMessage||this.noValidationMessage;this._lastValidationMessage!==i&&(this._lastValidationMessage=i,pn(this.ui.message),Ohe(i,this.ui.message,{callback:n=>{this.ui.linkOpenerDelegate(n)},disposables:this.visibleDisposables})),this._lastSeverity!==this.severity&&(this._lastSeverity=this.severity,this.showMessageDecoration(this.severity))}getTitle(){return this.title&&this.step?`${this.title} (${this.getSteps()})`:this.title?this.title:this.step?this.getSteps():""}getDescription(){return this.description||""}getSteps(){return this.step&&this.totalSteps?p("quickInput.steps","{0}/{1}",this.step,this.totalSteps):this.step?String(this.step):""}showMessageDecoration(e){if(this.ui.inputBox.showDecoration(e),e!==ki.Ignore){const t=this.ui.inputBox.stylesForType(e);this.ui.message.style.color=t.foreground?`${t.foreground}`:"",this.ui.message.style.backgroundColor=t.background?`${t.background}`:"",this.ui.message.style.border=t.border?`1px solid ${t.border}`:"",this.ui.message.style.marginBottom="-2px"}else this.ui.message.style.color="",this.ui.message.style.backgroundColor="",this.ui.message.style.border="",this.ui.message.style.marginBottom=""}dispose(){this.hide(),this.onDisposeEmitter.fire(),super.dispose()}};Mk.noPromptMessage=p("inputModeEntry","Press 'Enter' to confirm your input or 'Escape' to cancel");let Sx=Mk;const Ok=class Ok extends Sx{constructor(){super(...arguments),this._value="",this.onDidChangeValueEmitter=this._register(new O),this.onWillAcceptEmitter=this._register(new O),this.onDidAcceptEmitter=this._register(new O),this.onDidCustomEmitter=this._register(new O),this._items=[],this.itemsUpdated=!1,this._canSelectMany=!1,this._canAcceptInBackground=!1,this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._keepScrollPosition=!1,this._itemActivation=ca.FIRST,this._activeItems=[],this.activeItemsUpdated=!1,this.activeItemsToConfirm=[],this.onDidChangeActiveEmitter=this._register(new O),this._selectedItems=[],this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=[],this.onDidChangeSelectionEmitter=this._register(new O),this.onDidTriggerItemButtonEmitter=this._register(new O),this.onDidTriggerSeparatorButtonEmitter=this._register(new O),this.valueSelectionUpdated=!0,this._ok="default",this._customButton=!1,this._focusEventBufferer=new Cw,this.type="quickPick",this.filterValue=e=>e,this.onDidChangeValue=this.onDidChangeValueEmitter.event,this.onWillAccept=this.onWillAcceptEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event,this.onDidChangeActive=this.onDidChangeActiveEmitter.event,this.onDidChangeSelection=this.onDidChangeSelectionEmitter.event,this.onDidTriggerItemButton=this.onDidTriggerItemButtonEmitter.event,this.onDidTriggerSeparatorButton=this.onDidTriggerSeparatorButtonEmitter.event}get quickNavigate(){return this._quickNavigate}set quickNavigate(e){this._quickNavigate=e,this.update()}get value(){return this._value}set value(e){this.doSetValue(e)}doSetValue(e,t){this._value!==e&&(this._value=e,t||this.update(),this.visible&&this.ui.list.filter(this.filterValue(this._value))&&this.trySelectFirst(),this.onDidChangeValueEmitter.fire(this._value))}set ariaLabel(e){this._ariaLabel=e,this.update()}get ariaLabel(){return this._ariaLabel}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get items(){return this._items}get scrollTop(){return this.ui.list.scrollTop}set scrollTop(e){this.ui.list.scrollTop=e}set items(e){this._items=e,this.itemsUpdated=!0,this.update()}get canSelectMany(){return this._canSelectMany}set canSelectMany(e){this._canSelectMany=e,this.update()}get canAcceptInBackground(){return this._canAcceptInBackground}set canAcceptInBackground(e){this._canAcceptInBackground=e}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e,this.update()}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e,this.update()}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e,this.update()}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e,this.update()}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e,this.update()}get keepScrollPosition(){return this._keepScrollPosition}set keepScrollPosition(e){this._keepScrollPosition=e}get itemActivation(){return this._itemActivation}set itemActivation(e){this._itemActivation=e}get activeItems(){return this._activeItems}set activeItems(e){this._activeItems=e,this.activeItemsUpdated=!0,this.update()}get selectedItems(){return this._selectedItems}set selectedItems(e){this._selectedItems=e,this.selectedItemsUpdated=!0,this.update()}get keyMods(){return this._quickNavigate?Dhe:this.ui.keyMods}get valueSelection(){const e=this.ui.inputBox.getSelection();if(e)return[e.start,e.end]}set valueSelection(e){this._valueSelection=e,this.valueSelectionUpdated=!0,this.update()}get customButton(){return this._customButton}set customButton(e){this._customButton=e,this.update()}get customLabel(){return this._customButtonLabel}set customLabel(e){this._customButtonLabel=e,this.update()}get customHover(){return this._customButtonHover}set customHover(e){this._customButtonHover=e,this.update()}get ok(){return this._ok}set ok(e){this._ok=e,this.update()}get hideInput(){return!!this._hideInput}set hideInput(e){this._hideInput=e,this.update()}trySelectFirst(){this.canSelectMany||this.ui.list.focus(Wt.First)}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{this.doSetValue(e,!0)})),this.visibleDisposables.add(this.ui.onDidAccept(()=>{this.canSelectMany?this.ui.list.getCheckedElements().length||(this._selectedItems=[],this.onDidChangeSelectionEmitter.fire(this.selectedItems)):this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems)),this.handleAccept(!1)})),this.visibleDisposables.add(this.ui.onDidCustom(()=>{this.onDidCustomEmitter.fire()})),this.visibleDisposables.add(this._focusEventBufferer.wrapEvent(this.ui.list.onDidChangeFocus,(e,t)=>t)(e=>{this.activeItemsUpdated||this.activeItemsToConfirm!==this._activeItems&&ei(e,this._activeItems,(t,i)=>t===i)||(this._activeItems=e,this.onDidChangeActiveEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onDidChangeSelection(({items:e,event:t})=>{if(this.canSelectMany){e.length&&this.ui.list.setSelectedElements([]);return}this.selectedItemsToConfirm!==this._selectedItems&&ei(e,this._selectedItems,(i,n)=>i===n)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e),e.length&&this.handleAccept(U4(t)&&t.button===1))})),this.visibleDisposables.add(this.ui.list.onChangedCheckedElements(e=>{!this.canSelectMany||!this.visible||this.selectedItemsToConfirm!==this._selectedItems&&ei(e,this._selectedItems,(t,i)=>t===i)||(this._selectedItems=e,this.onDidChangeSelectionEmitter.fire(e))})),this.visibleDisposables.add(this.ui.list.onButtonTriggered(e=>this.onDidTriggerItemButtonEmitter.fire(e))),this.visibleDisposables.add(this.ui.list.onSeparatorButtonTriggered(e=>this.onDidTriggerSeparatorButtonEmitter.fire(e))),this.visibleDisposables.add(this.registerQuickNavigation()),this.valueSelectionUpdated=!0),super.show()}handleAccept(e){let t=!1;this.onWillAcceptEmitter.fire({veto:()=>t=!0}),t||this.onDidAcceptEmitter.fire({inBackground:e})}registerQuickNavigation(){return H(this.ui.container,ee.KEY_UP,e=>{if(this.canSelectMany||!this._quickNavigate)return;const t=new Pt(e),i=t.keyCode;this._quickNavigate.keybindings.some(r=>{const a=r.getChords();return a.length>1?!1:a[0].shiftKey&&i===4?!(t.ctrlKey||t.altKey||t.metaKey):!!(a[0].altKey&&i===6||a[0].ctrlKey&&i===5||a[0].metaKey&&i===57)})&&(this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(!1)),this._quickNavigate=void 0)})}update(){if(!this.visible)return;const e=this.keepScrollPosition?this.scrollTop:0,t=!!this.description,i={title:!!this.title||!!this.step||!!this.titleButtons.length,description:t,checkAll:this.canSelectMany&&!this._hideCheckAll,checkBox:this.canSelectMany,inputBox:!this._hideInput,progressBar:!this._hideInput||t,visibleCount:!0,count:this.canSelectMany&&!this._hideCountBadge,ok:this.ok==="default"?this.canSelectMany:this.ok,list:!0,message:!!this.validationMessage,customButton:this.customButton};this.ui.setVisibilities(i),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||"");let n=this.ariaLabel;!n&&i.inputBox&&(n=this.placeholder||Ok.DEFAULT_ARIA_LABEL,this.title&&(n+=` - ${this.title}`)),this.ui.list.ariaLabel!==n&&(this.ui.list.ariaLabel=n??null),this.ui.list.matchOnDescription=this.matchOnDescription,this.ui.list.matchOnDetail=this.matchOnDetail,this.ui.list.matchOnLabel=this.matchOnLabel,this.ui.list.matchOnLabelMode=this.matchOnLabelMode,this.ui.list.sortByLabel=this.sortByLabel,this.itemsUpdated&&(this.itemsUpdated=!1,this._focusEventBufferer.bufferEvents(()=>{switch(this.ui.list.setElements(this.items),this.ui.list.shouldLoop=!this.canSelectMany,this.ui.list.filter(this.filterValue(this.ui.inputBox.value)),this._itemActivation){case ca.NONE:this._itemActivation=ca.FIRST;break;case ca.SECOND:this.ui.list.focus(Wt.Second),this._itemActivation=ca.FIRST;break;case ca.LAST:this.ui.list.focus(Wt.Last),this._itemActivation=ca.FIRST;break;default:this.trySelectFirst();break}})),this.ui.container.classList.contains("show-checkboxes")!==!!this.canSelectMany&&(this.canSelectMany?this.ui.list.clearFocus():this.trySelectFirst()),this.activeItemsUpdated&&(this.activeItemsUpdated=!1,this.activeItemsToConfirm=this._activeItems,this.ui.list.setFocusedElements(this.activeItems),this.activeItemsToConfirm===this._activeItems&&(this.activeItemsToConfirm=null)),this.selectedItemsUpdated&&(this.selectedItemsUpdated=!1,this.selectedItemsToConfirm=this._selectedItems,this.canSelectMany?this.ui.list.setCheckedElements(this.selectedItems):this.ui.list.setSelectedElements(this.selectedItems),this.selectedItemsToConfirm===this._selectedItems&&(this.selectedItemsToConfirm=null)),this.ui.customButton.label=this.customLabel||"",this.ui.customButton.element.title=this.customHover||"",i.inputBox||(this.ui.list.domFocus(),this.canSelectMany&&this.ui.list.focus(Wt.First)),this.keepScrollPosition&&(this.scrollTop=e)}focus(e){this.ui.list.focus(e),this.canSelectMany&&this.ui.list.domFocus()}accept(e){e&&!this._canAcceptInBackground||this.activeItems[0]&&(this._selectedItems=[this.activeItems[0]],this.onDidChangeSelectionEmitter.fire(this.selectedItems),this.handleAccept(e??!1))}};Ok.DEFAULT_ARIA_LABEL=p("quickInputBox.ariaLabel","Type to narrow down results.");let xx=Ok,Uhe=class extends Sx{constructor(){super(...arguments),this._value="",this.valueSelectionUpdated=!0,this._password=!1,this.onDidValueChangeEmitter=this._register(new O),this.onDidAcceptEmitter=this._register(new O),this.type="inputBox",this.onDidChangeValue=this.onDidValueChangeEmitter.event,this.onDidAccept=this.onDidAcceptEmitter.event}get value(){return this._value}set value(e){this._value=e||"",this.update()}get placeholder(){return this._placeholder}set placeholder(e){this._placeholder=e,this.update()}get password(){return this._password}set password(e){this._password=e,this.update()}show(){this.visible||(this.visibleDisposables.add(this.ui.inputBox.onDidChange(e=>{e!==this.value&&(this._value=e,this.onDidValueChangeEmitter.fire(e))})),this.visibleDisposables.add(this.ui.onDidAccept(()=>this.onDidAcceptEmitter.fire())),this.valueSelectionUpdated=!0),super.show()}update(){if(!this.visible)return;this.ui.container.classList.remove("hidden-input");const e={title:!!this.title||!!this.step||!!this.titleButtons.length,description:!!this.description||!!this.step,inputBox:!0,message:!0,progressBar:!0};this.ui.setVisibilities(e),super.update(),this.ui.inputBox.value!==this.value&&(this.ui.inputBox.value=this.value),this.valueSelectionUpdated&&(this.valueSelectionUpdated=!1,this.ui.inputBox.select(this._valueSelection&&{start:this._valueSelection[0],end:this._valueSelection[1]})),this.ui.inputBox.placeholder!==(this.placeholder||"")&&(this.ui.inputBox.placeholder=this.placeholder||""),this.ui.inputBox.password!==this.password&&(this.ui.inputBox.password=this.password)}},JA=class extends w_{constructor(e,t){super("element",!1,i=>this.getOverrideOptions(i),e,t)}getOverrideOptions(e){const t=(qi(e.content)?e.content.textContent??"":typeof e.content=="string"?e.content:e.content.value).includes(`
`);return{persistence:{hideOnKeyDown:!1},appearance:{showHoverHint:t,skipFadeInAnimation:!0}}}};JA=Fhe([p7(0,Ke),p7(1,zl)],JA);j.white.toString(),j.white.toString();class Lx extends F{get onDidClick(){return this._onDidClick.event}constructor(e,t){super(),this._label="",this._onDidClick=this._register(new O),this._onDidEscape=this._register(new O),this.options=t,this._element=document.createElement("a"),this._element.classList.add("monaco-button"),this._element.tabIndex=0,this._element.setAttribute("role","button"),this._element.classList.toggle("secondary",!!t.secondary);const i=t.secondary?t.buttonSecondaryBackground:t.buttonBackground,n=t.secondary?t.buttonSecondaryForeground:t.buttonForeground;this._element.style.color=n||"",this._element.style.backgroundColor=i||"",t.supportShortLabel&&(this._labelShortElement=document.createElement("div"),this._labelShortElement.classList.add("monaco-button-label-short"),this._element.appendChild(this._labelShortElement),this._labelElement=document.createElement("div"),this._labelElement.classList.add("monaco-button-label"),this._element.appendChild(this._labelElement),this._element.classList.add("monaco-text-button-with-short-label")),typeof t.title=="string"&&this.setTitle(t.title),typeof t.ariaLabel=="string"&&this._element.setAttribute("aria-label",t.ariaLabel),e.appendChild(this._element),this._register(Mn.addTarget(this._element)),[ee.CLICK,Ot.Tap].forEach(s=>{this._register(H(this._element,s,r=>{if(!this.enabled){tt.stop(r);return}this._onDidClick.fire(r)}))}),this._register(H(this._element,ee.KEY_DOWN,s=>{const r=new Pt(s);let a=!1;this.enabled&&(r.equals(3)||r.equals(10))?(this._onDidClick.fire(s),a=!0):r.equals(9)&&(this._onDidEscape.fire(s),this._element.blur(),a=!0),a&&tt.stop(r,!0)})),this._register(H(this._element,ee.MOUSE_OVER,s=>{this._element.classList.contains("disabled")||this.updateBackground(!0)})),this._register(H(this._element,ee.MOUSE_OUT,s=>{this.updateBackground(!1)})),this.focusTracker=this._register(Ia(this._element)),this._register(this.focusTracker.onDidFocus(()=>{this.enabled&&this.updateBackground(!0)})),this._register(this.focusTracker.onDidBlur(()=>{this.enabled&&this.updateBackground(!1)}))}dispose(){super.dispose(),this._element.remove()}getContentElements(e){const t=[];for(let i of nh(e))if(typeof i=="string"){if(i=i.trim(),i==="")continue;const n=document.createElement("span");n.textContent=i,t.push(n)}else t.push(i);return t}updateBackground(e){let t;this.options.secondary?t=e?this.options.buttonSecondaryHoverBackground:this.options.buttonSecondaryBackground:t=e?this.options.buttonHoverBackground:this.options.buttonBackground,t&&(this._element.style.backgroundColor=t)}get element(){return this._element}set label(e){if(this._label===e||Ea(this._label)&&Ea(e)&&wre(this._label,e))return;this._element.classList.add("monaco-text-button");const t=this.options.supportShortLabel?this._labelElement:this._element;if(Ea(e)){const n=FT(e,{inline:!0});n.dispose();const s=n.element.querySelector("p")?.innerHTML;if(s){const r=zz(s,{ADD_TAGS:["b","i","u","code","span"],ALLOWED_ATTR:["class"],RETURN_TRUSTED_TYPE:!0});t.innerHTML=r}else pn(t)}else this.options.supportIcons?pn(t,...this.getContentElements(e)):t.textContent=e;let i="";typeof this.options.title=="string"?i=this.options.title:this.options.title&&(i=Pre(e)),this.setTitle(i),typeof this.options.ariaLabel=="string"?this._element.setAttribute("aria-label",this.options.ariaLabel):this.options.ariaLabel&&this._element.setAttribute("aria-label",i),this._label=e}get label(){return this._label}set icon(e){this._element.classList.add(...ke.asClassNameArray(e))}set enabled(e){e?(this._element.classList.remove("disabled"),this._element.setAttribute("aria-disabled",String(!1)),this._element.tabIndex=0):(this._element.classList.add("disabled"),this._element.setAttribute("aria-disabled",String(!0)))}get enabled(){return!this._element.classList.contains("disabled")}setTitle(e){!this._hover&&e!==""?this._hover=this._register(Ba().setupManagedHover(this.options.hoverDelegate??bs("mouse"),this._element,e)):this._hover&&this._hover.update(e)}}class eM{constructor(e,t,i){this.options=t,this.styles=i,this.count=0,this.element=Y(e,ie(".monaco-count-badge")),this.countFormat=this.options.countFormat||"{0}",this.titleFormat=this.options.titleFormat||"",this.setCount(this.options.count||0)}setCount(e){this.count=e,this.render()}setTitleFormat(e){this.titleFormat=e,this.render()}render(){this.element.textContent=mf(this.countFormat,this.count),this.element.title=mf(this.titleFormat,this.count),this.element.style.backgroundColor=this.styles.badgeBackground??"",this.element.style.color=this.styles.badgeForeground??"",this.styles.badgeBorder&&(this.element.style.border=`1px solid ${this.styles.badgeBorder}`)}}const m7="done",_7="active",UI="infinite",GI="infinite-long-running",b7="discrete",Fk=class Fk extends F{constructor(e,t){super(),this.progressSignal=this._register(new Yi),this.workedVal=0,this.showDelayedScheduler=this._register(new xt(()=>Ys(this.element),0)),this.longRunningScheduler=this._register(new xt(()=>this.infiniteLongRunning(),Fk.LONG_RUNNING_INFINITE_THRESHOLD)),this.create(e,t)}create(e,t){this.element=document.createElement("div"),this.element.classList.add("monaco-progress-container"),this.element.setAttribute("role","progressbar"),this.element.setAttribute("aria-valuemin","0"),e.appendChild(this.element),this.bit=document.createElement("div"),this.bit.classList.add("progress-bit"),this.bit.style.backgroundColor=t?.progressBarBackground||"#0E70C0",this.element.appendChild(this.bit)}off(){this.bit.style.width="inherit",this.bit.style.opacity="1",this.element.classList.remove(_7,UI,GI,b7),this.workedVal=0,this.totalWork=void 0,this.longRunningScheduler.cancel(),this.progressSignal.clear()}stop(){return this.doDone(!1)}doDone(e){return this.element.classList.add(m7),this.element.classList.contains(UI)?(this.bit.style.opacity="0",e?setTimeout(()=>this.off(),200):this.off()):(this.bit.style.width="inherit",e?setTimeout(()=>this.off(),200):this.off()),this}infinite(){return this.bit.style.width="2%",this.bit.style.opacity="1",this.element.classList.remove(b7,m7,GI),this.element.classList.add(_7,UI),this.longRunningScheduler.schedule(),this}infiniteLongRunning(){this.element.classList.add(GI)}getContainer(){return this.element}};Fk.LONG_RUNNING_INFINITE_THRESHOLD=1e4;let tM=Fk;const Ghe=p("caseDescription","Match Case"),$he=p("wordsDescription","Match Whole Word"),Khe=p("regexDescription","Use Regular Expression");class $$ extends pb{constructor(e){super({icon:J.caseSensitive,title:Ghe+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??bs("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class K$ extends pb{constructor(e){super({icon:J.wholeWord,title:$he+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??bs("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class j$ extends pb{constructor(e){super({icon:J.regex,title:Khe+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??bs("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class jhe{constructor(e,t=0,i=e.length,n=t-1){this.items=e,this.start=t,this.end=i,this.index=n}current(){return this.index===this.start-1||this.index===this.end?null:this.items[this.index]}next(){return this.index=Math.min(this.index+1,this.end),this.current()}previous(){return this.index=Math.max(this.index-1,this.start-1),this.current()}first(){return this.index=this.start,this.current()}last(){return this.index=this.end-1,this.current()}}class qhe{constructor(e=[],t=10){this._initialize(e),this._limit=t,this._onChange()}getHistory(){return this._elements}add(e){this._history.delete(e),this._history.add(e),this._onChange()}next(){return this._navigator.next()}previous(){return this._currentPosition()!==0?this._navigator.previous():null}current(){return this._navigator.current()}first(){return this._navigator.first()}last(){return this._navigator.last()}isLast(){return this._currentPosition()>=this._elements.length-1}isNowhere(){return this._navigator.current()===null}has(e){return this._history.has(e)}_onChange(){this._reduceToLimit();const e=this._elements;this._navigator=new jhe(e,0,e.length,e.length)}_reduceToLimit(){const e=this._elements;e.length>this._limit&&this._initialize(e.slice(e.length-this._limit))}_currentPosition(){const e=this._navigator.current();return e?this._elements.indexOf(e):-1}_initialize(e){this._history=new Set;for(const t of e)this._history.add(t)}get _elements(){const e=[];return this._history.forEach(t=>e.push(t)),e}}const Yb=ie;class Zhe extends Go{constructor(e,t,i){super(),this.state="idle",this.maxHeight=Number.POSITIVE_INFINITY,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._onDidHeightChange=this._register(new O),this.onDidHeightChange=this._onDidHeightChange.event,this.contextViewProvider=t,this.options=i,this.message=null,this.placeholder=this.options.placeholder||"",this.tooltip=this.options.tooltip??(this.placeholder||""),this.ariaLabel=this.options.ariaLabel||"",this.options.validationOptions&&(this.validation=this.options.validationOptions.validation),this.element=Y(e,Yb(".monaco-inputbox.idle"));const n=this.options.flexibleHeight?"textarea":"input",s=Y(this.element,Yb(".ibwrapper"));if(this.input=Y(s,Yb(n+".input.empty")),this.input.setAttribute("autocorrect","off"),this.input.setAttribute("autocapitalize","off"),this.input.setAttribute("spellcheck","false"),this.onfocus(this.input,()=>this.element.classList.add("synthetic-focus")),this.onblur(this.input,()=>this.element.classList.remove("synthetic-focus")),this.options.flexibleHeight){this.maxHeight=typeof this.options.flexibleMaxHeight=="number"?this.options.flexibleMaxHeight:Number.POSITIVE_INFINITY,this.mirror=Y(s,Yb("div.mirror")),this.mirror.innerText=" ",this.scrollableElement=new vG(this.element,{vertical:1}),this.options.flexibleWidth&&(this.input.setAttribute("wrap","off"),this.mirror.style.whiteSpace="pre",this.mirror.style.wordWrap="initial"),Y(e,this.scrollableElement.getDomNode()),this._register(this.scrollableElement),this._register(this.scrollableElement.onScroll(l=>this.input.scrollTop=l.scrollTop));const r=this._register(new et(e.ownerDocument,"selectionchange")),a=se.filter(r.event,()=>e.ownerDocument.getSelection()?.anchorNode===s);this._register(a(this.updateScrollDimensions,this)),this._register(this.onDidHeightChange(this.updateScrollDimensions,this))}else this.input.type=this.options.type||"text",this.input.setAttribute("wrap","off");this.ariaLabel&&this.input.setAttribute("aria-label",this.ariaLabel),this.placeholder&&!this.options.showPlaceholderOnFocus&&this.setPlaceHolder(this.placeholder),this.tooltip&&this.setTooltip(this.tooltip),this.oninput(this.input,()=>this.onValueChange()),this.onblur(this.input,()=>this.onBlur()),this.onfocus(this.input,()=>this.onFocus()),this._register(this.ignoreGesture(this.input)),setTimeout(()=>this.updateMirror(),0),this.options.actions&&(this.actionbar=this._register(new Oo(this.element)),this.actionbar.push(this.options.actions,{icon:!0,label:!1})),this.applyStyles()}onBlur(){this._hideMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder","")}onFocus(){this._showMessage(),this.options.showPlaceholderOnFocus&&this.input.setAttribute("placeholder",this.placeholder||"")}setPlaceHolder(e){this.placeholder=e,this.input.setAttribute("placeholder",e)}setTooltip(e){this.tooltip=e,this.hover?this.hover.update(e):this.hover=this._register(Ba().setupManagedHover(bs("mouse"),this.input,e))}get inputElement(){return this.input}get value(){return this.input.value}set value(e){this.input.value!==e&&(this.input.value=e,this.onValueChange())}get height(){return typeof this.cachedHeight=="number"?this.cachedHeight:xc(this.element)}focus(){this.input.focus()}blur(){this.input.blur()}hasFocus(){return lT(this.input)}select(e=null){this.input.select(),e&&(this.input.setSelectionRange(e.start,e.end),e.end===this.input.value.length&&(this.input.scrollLeft=this.input.scrollWidth))}isSelectionAtEnd(){return this.input.selectionEnd===this.input.value.length&&this.input.selectionStart===this.input.selectionEnd}getSelection(){const e=this.input.selectionStart;if(e===null)return null;const t=this.input.selectionEnd??e;return{start:e,end:t}}enable(){this.input.removeAttribute("disabled")}disable(){this.blur(),this.input.disabled=!0,this._hideMessage()}set paddingRight(e){this.input.style.width=`calc(100% - ${e}px)`,this.mirror&&(this.mirror.style.paddingRight=e+"px")}updateScrollDimensions(){if(typeof this.cachedContentHeight!="number"||typeof this.cachedHeight!="number"||!this.scrollableElement)return;const e=this.cachedContentHeight,t=this.cachedHeight,i=this.input.scrollTop;this.scrollableElement.setScrollDimensions({scrollHeight:e,height:t}),this.scrollableElement.setScrollPosition({scrollTop:i})}showMessage(e,t){if(this.state==="open"&&eo(this.message,e))return;this.message=e,this.element.classList.remove("idle"),this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add(this.classForType(e.type));const i=this.stylesForType(this.message.type);this.element.style.border=`1px solid ${Bc(i.border,"transparent")}`,this.message.content&&(this.hasFocus()||t)&&this._showMessage()}hideMessage(){this.message=null,this.element.classList.remove("info"),this.element.classList.remove("warning"),this.element.classList.remove("error"),this.element.classList.add("idle"),this._hideMessage(),this.applyStyles()}validate(){let e=null;return this.validation&&(e=this.validation(this.value),e?(this.inputElement.setAttribute("aria-invalid","true"),this.showMessage(e)):this.inputElement.hasAttribute("aria-invalid")&&(this.inputElement.removeAttribute("aria-invalid"),this.hideMessage())),e?.type}stylesForType(e){const t=this.options.inputBoxStyles;switch(e){case 1:return{border:t.inputValidationInfoBorder,background:t.inputValidationInfoBackground,foreground:t.inputValidationInfoForeground};case 2:return{border:t.inputValidationWarningBorder,background:t.inputValidationWarningBackground,foreground:t.inputValidationWarningForeground};default:return{border:t.inputValidationErrorBorder,background:t.inputValidationErrorBackground,foreground:t.inputValidationErrorForeground}}}classForType(e){switch(e){case 1:return"info";case 2:return"warning";default:return"error"}}_showMessage(){if(!this.contextViewProvider||!this.message)return;let e;const t=()=>e.style.width=Ks(this.element)+"px";this.contextViewProvider.showContextView({getAnchor:()=>this.element,anchorAlignment:1,render:n=>{if(!this.message)return null;e=Y(n,Yb(".monaco-inputbox-container")),t();const s={inline:!0,className:"monaco-inputbox-message"},r=this.message.formatContent?Voe(this.message.content,s):Woe(this.message.content,s);r.classList.add(this.classForType(this.message.type));const a=this.stylesForType(this.message.type);return r.style.backgroundColor=a.background??"",r.style.color=a.foreground??"",r.style.border=a.border?`1px solid ${a.border}`:"",Y(e,r),null},onHide:()=>{this.state="closed"},layout:t});let i;this.message.type===3?i=p("alertErrorMessage","Error: {0}",this.message.content):this.message.type===2?i=p("alertWarningMessage","Warning: {0}",this.message.content):i=p("alertInfoMessage","Info: {0}",this.message.content),ps(i),this.state="open"}_hideMessage(){this.contextViewProvider&&(this.state==="open"&&this.contextViewProvider.hideContextView(),this.state="idle")}onValueChange(){this._onDidChange.fire(this.value),this.validate(),this.updateMirror(),this.input.classList.toggle("empty",!this.value),this.state==="open"&&this.contextViewProvider&&this.contextViewProvider.layout()}updateMirror(){if(!this.mirror)return;const e=this.value,i=e.charCodeAt(e.length-1)===10?" ":"";(e+i).replace(/\u000c/g,"")?this.mirror.textContent=e+i:this.mirror.innerText=" ",this.layout()}applyStyles(){const e=this.options.inputBoxStyles,t=e.inputBackground??"",i=e.inputForeground??"",n=e.inputBorder??"";this.element.style.backgroundColor=t,this.element.style.color=i,this.input.style.backgroundColor="inherit",this.input.style.color=i,this.element.style.border=`1px solid ${Bc(n,"transparent")}`}layout(){if(!this.mirror)return;const e=this.cachedContentHeight;this.cachedContentHeight=xc(this.mirror),e!==this.cachedContentHeight&&(this.cachedHeight=Math.min(this.cachedContentHeight,this.maxHeight),this.input.style.height=this.cachedHeight+"px",this._onDidHeightChange.fire(this.cachedContentHeight))}insertAtCursor(e){const t=this.inputElement,i=t.selectionStart,n=t.selectionEnd,s=t.value;i!==null&&n!==null&&(this.value=s.substr(0,i)+e+s.substr(n),t.setSelectionRange(i+1,i+1),this.layout())}dispose(){this._hideMessage(),this.message=null,this.actionbar?.dispose(),super.dispose()}}class q$ extends Zhe{constructor(e,t,i){const n=p({key:"history.inputbox.hint.suffix.noparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field ends in a closing parenthesis ")", for example "Filter (e.g. text, !exclude)". The character inserted into the final string is ⇅ to represent the up and down arrow keys.']}," or {0} for history","⇅"),s=p({key:"history.inputbox.hint.suffix.inparens",comment:['Text is the suffix of an input field placeholder coming after the action the input field performs, this will be used when the input field does NOT end in a closing parenthesis (eg. "Find"). The character inserted into the final string is ⇅ to represent the up and down arrow keys.']}," ({0} for history)","⇅");super(e,t,i),this._onDidFocus=this._register(new O),this.onDidFocus=this._onDidFocus.event,this._onDidBlur=this._register(new O),this.onDidBlur=this._onDidBlur.event,this.history=new qhe(i.history,100);const r=()=>{if(i.showHistoryHint&&i.showHistoryHint()&&!this.placeholder.endsWith(n)&&!this.placeholder.endsWith(s)&&this.history.getHistory().length){const a=this.placeholder.endsWith(")")?n:s,l=this.placeholder+a;i.showPlaceholderOnFocus&&!lT(this.input)?this.placeholder=l:this.setPlaceHolder(l)}};this.observer=new MutationObserver((a,l)=>{a.forEach(c=>{c.target.textContent||r()})}),this.observer.observe(this.input,{attributeFilter:["class"]}),this.onfocus(this.input,()=>r()),this.onblur(this.input,()=>{const a=l=>{if(this.placeholder.endsWith(l)){const c=this.placeholder.slice(0,this.placeholder.length-l.length);return i.showPlaceholderOnFocus?this.placeholder=c:this.setPlaceHolder(c),!0}else return!1};a(s)||a(n)})}dispose(){super.dispose(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addToHistory(e){this.value&&(e||this.value!==this.getCurrentValue())&&this.history.add(this.value)}isAtLastInHistory(){return this.history.isLast()}isNowhereInHistory(){return this.history.isNowhere()}showNextValue(){this.history.has(this.value)||this.addToHistory();let e=this.getNextValue();e&&(e=e===this.value?this.getNextValue():e),this.value=e??"",Rl(this.value?this.value:p("clearedInput","Cleared Input"))}showPreviousValue(){this.history.has(this.value)||this.addToHistory();let e=this.getPreviousValue();e&&(e=e===this.value?this.getPreviousValue():e),e&&(this.value=e,Rl(this.value))}setPlaceHolder(e){super.setPlaceHolder(e),this.setTooltip(e)}onBlur(){super.onBlur(),this._onDidBlur.fire()}onFocus(){super.onFocus(),this._onDidFocus.fire()}getCurrentValue(){let e=this.history.current();return e||(e=this.history.last(),this.history.next()),e}getPreviousValue(){return this.history.previous()||this.history.first()}getNextValue(){return this.history.next()}}const Yhe=p("defaultLabel","input");class Z$ extends Go{constructor(e,t,i){super(),this.fixFocusOnOptionClickEnabled=!0,this.imeSessionInProgress=!1,this.additionalTogglesDisposables=this._register(new Yi),this.additionalToggles=[],this._onDidOptionChange=this._register(new O),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new O),this.onMouseDown=this._onMouseDown.event,this._onInput=this._register(new O),this._onKeyUp=this._register(new O),this._onCaseSensitiveKeyDown=this._register(new O),this.onCaseSensitiveKeyDown=this._onCaseSensitiveKeyDown.event,this._onRegexKeyDown=this._register(new O),this.onRegexKeyDown=this._onRegexKeyDown.event,this._lastHighlightFindOptions=0,this.placeholder=i.placeholder||"",this.validation=i.validation,this.label=i.label||Yhe,this.showCommonFindToggles=!!i.showCommonFindToggles;const n=i.appendCaseSensitiveLabel||"",s=i.appendWholeWordsLabel||"",r=i.appendRegexLabel||"",a=i.history||[],l=!!i.flexibleHeight,c=!!i.flexibleWidth,d=i.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new q$(this.domNode,t,{placeholder:this.placeholder||"",ariaLabel:this.label||"",validationOptions:{validation:this.validation},history:a,showHistoryHint:i.showHistoryHint,flexibleHeight:l,flexibleWidth:c,flexibleMaxHeight:d,inputBoxStyles:i.inputBoxStyles}));const h=this._register(D_());if(this.showCommonFindToggles){this.regex=this._register(new j$({appendTitle:r,isChecked:!1,hoverDelegate:h,...i.toggleStyles})),this._register(this.regex.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.regex.onKeyDown(g=>{this._onRegexKeyDown.fire(g)})),this.wholeWords=this._register(new K$({appendTitle:s,isChecked:!1,hoverDelegate:h,...i.toggleStyles})),this._register(this.wholeWords.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this.caseSensitive=this._register(new $$({appendTitle:n,isChecked:!1,hoverDelegate:h,...i.toggleStyles})),this._register(this.caseSensitive.onChange(g=>{this._onDidOptionChange.fire(g),!g&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.caseSensitive.onKeyDown(g=>{this._onCaseSensitiveKeyDown.fire(g)}));const u=[this.caseSensitive.domNode,this.wholeWords.domNode,this.regex.domNode];this.onkeydown(this.domNode,g=>{if(g.equals(15)||g.equals(17)||g.equals(9)){const f=u.indexOf(this.domNode.ownerDocument.activeElement);if(f>=0){let m=-1;g.equals(17)?m=(f+1)%u.length:g.equals(15)&&(f===0?m=u.length-1:m=f-1),g.equals(9)?(u[f].blur(),this.inputBox.focus()):m>=0&&u[m].focus(),tt.stop(g,!0)}}})}this.controls=document.createElement("div"),this.controls.className="controls",this.controls.style.display=this.showCommonFindToggles?"":"none",this.caseSensitive&&this.controls.append(this.caseSensitive.domNode),this.wholeWords&&this.controls.appendChild(this.wholeWords.domNode),this.regex&&this.controls.appendChild(this.regex.domNode),this.setAdditionalToggles(i?.additionalToggles),this.controls&&this.domNode.appendChild(this.controls),e?.appendChild(this.domNode),this._register(H(this.inputBox.inputElement,"compositionstart",u=>{this.imeSessionInProgress=!0})),this._register(H(this.inputBox.inputElement,"compositionend",u=>{this.imeSessionInProgress=!1,this._onInput.fire()})),this.onkeydown(this.inputBox.inputElement,u=>this._onKeyDown.fire(u)),this.onkeyup(this.inputBox.inputElement,u=>this._onKeyUp.fire(u)),this.oninput(this.inputBox.inputElement,u=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,u=>this._onMouseDown.fire(u))}get onDidChange(){return this.inputBox.onDidChange}layout(e){this.inputBox.layout(),this.updateInputBoxPadding(e.collapsedFindWidget)}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.regex?.enable(),this.wholeWords?.enable(),this.caseSensitive?.enable();for(const e of this.additionalToggles)e.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.regex?.disable(),this.wholeWords?.disable(),this.caseSensitive?.disable();for(const e of this.additionalToggles)e.disable()}setFocusInputOnOptionClick(e){this.fixFocusOnOptionClickEnabled=e}setEnabled(e){e?this.enable():this.disable()}setAdditionalToggles(e){for(const t of this.additionalToggles)t.domNode.remove();this.additionalToggles=[],this.additionalTogglesDisposables.value=new $;for(const t of e??[])this.additionalTogglesDisposables.value.add(t),this.controls.appendChild(t.domNode),this.additionalTogglesDisposables.value.add(t.onChange(i=>{this._onDidOptionChange.fire(i),!i&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus()})),this.additionalToggles.push(t);this.additionalToggles.length>0&&(this.controls.style.display=""),this.updateInputBoxPadding()}updateInputBoxPadding(e=!1){e?this.inputBox.paddingRight=0:this.inputBox.paddingRight=(this.caseSensitive?.width()??0)+(this.wholeWords?.width()??0)+(this.regex?.width()??0)+this.additionalToggles.reduce((t,i)=>t+i.width(),0)}getValue(){return this.inputBox.value}setValue(e){this.inputBox.value!==e&&(this.inputBox.value=e)}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getCaseSensitive(){return this.caseSensitive?.checked??!1}setCaseSensitive(e){this.caseSensitive&&(this.caseSensitive.checked=e)}getWholeWords(){return this.wholeWords?.checked??!1}setWholeWords(e){this.wholeWords&&(this.wholeWords.checked=e)}getRegex(){return this.regex?.checked??!1}setRegex(e){this.regex&&(this.regex.checked=e,this.validate())}focusOnCaseSensitive(){this.caseSensitive?.focus()}highlightFindOptions(){this.domNode.classList.remove("highlight-"+this._lastHighlightFindOptions),this._lastHighlightFindOptions=1-this._lastHighlightFindOptions,this.domNode.classList.add("highlight-"+this._lastHighlightFindOptions)}validate(){this.inputBox.validate()}showMessage(e){this.inputBox.showMessage(e)}clearMessage(){this.inputBox.hideMessage()}}const Xhe=ie;class Qhe extends F{constructor(e,t,i){super(),this.parent=e,this.onKeyDown=s=>ci(this.findInput.inputBox.inputElement,ee.KEY_DOWN,s),this.onDidChange=s=>this.findInput.onDidChange(s),this.container=Y(this.parent,Xhe(".quick-input-box")),this.findInput=this._register(new Z$(this.container,void 0,{label:"",inputBoxStyles:t,toggleStyles:i}));const n=this.findInput.inputBox.inputElement;n.role="combobox",n.ariaHasPopup="menu",n.ariaAutoComplete="list",n.ariaExpanded="true"}get value(){return this.findInput.getValue()}set value(e){this.findInput.setValue(e)}select(e=null){this.findInput.inputBox.select(e)}getSelection(){return this.findInput.inputBox.getSelection()}isSelectionAtEnd(){return this.findInput.inputBox.isSelectionAtEnd()}get placeholder(){return this.findInput.inputBox.inputElement.getAttribute("placeholder")||""}set placeholder(e){this.findInput.inputBox.setPlaceHolder(e)}get password(){return this.findInput.inputBox.inputElement.type==="password"}set password(e){this.findInput.inputBox.inputElement.type=e?"password":"text"}set enabled(e){this.findInput.inputBox.inputElement.toggleAttribute("readonly",!e)}set toggles(e){this.findInput.setAdditionalToggles(e)}setAttribute(e,t){this.findInput.inputBox.inputElement.setAttribute(e,t)}showDecoration(e){e===ki.Ignore?this.findInput.clearMessage():this.findInput.showMessage({type:e===ki.Info?1:e===ki.Warning?2:3,content:""})}stylesForType(e){return this.findInput.inputBox.stylesForType(e===ki.Info?1:e===ki.Warning?2:3)}setFocus(){this.findInput.focus()}layout(){this.findInput.inputBox.layout()}}class Jhe{get templateId(){return this.renderer.templateId}constructor(e,t){this.renderer=e,this.modelProvider=t}renderTemplate(e){return{data:this.renderer.renderTemplate(e),disposable:F.None}}renderElement(e,t,i,n){if(i.disposable?.dispose(),!i.data)return;const s=this.modelProvider();if(s.isResolved(e))return this.renderer.renderElement(s.get(e),e,i.data,n);const r=new ri,a=s.resolve(e,r.token);i.disposable={dispose:()=>r.cancel()},this.renderer.renderPlaceholder(e,i.data),a.then(l=>this.renderer.renderElement(l,e,i.data,n))}disposeTemplate(e){e.disposable&&(e.disposable.dispose(),e.disposable=void 0),e.data&&(this.renderer.disposeTemplate(e.data),e.data=void 0)}}class eue{constructor(e,t){this.modelProvider=e,this.accessibilityProvider=t}getWidgetAriaLabel(){return this.accessibilityProvider.getWidgetAriaLabel()}getAriaLabel(e){const t=this.modelProvider();return t.isResolved(e)?this.accessibilityProvider.getAriaLabel(t.get(e)):null}}function tue(o,e){return{...e,accessibilityProvider:e.accessibilityProvider&&new eue(o,e.accessibilityProvider)}}class iue{constructor(e,t,i,n,s={}){const r=()=>this.model,a=n.map(l=>new Jhe(l,r));this.list=new $o(e,t,i,a,tue(r,s))}updateOptions(e){this.list.updateOptions(e)}getHTMLElement(){return this.list.getHTMLElement()}get onDidFocus(){return this.list.onDidFocus}get widget(){return this.list}get onDidDispose(){return this.list.onDidDispose}get onMouseDblClick(){return se.map(this.list.onMouseDblClick,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onPointer(){return se.map(this.list.onPointer,({element:e,index:t,browserEvent:i})=>({element:e===void 0?void 0:this._model.get(e),index:t,browserEvent:i}))}get onDidChangeSelection(){return se.map(this.list.onDidChangeSelection,({elements:e,indexes:t,browserEvent:i})=>({elements:e.map(n=>this._model.get(n)),indexes:t,browserEvent:i}))}get model(){return this._model}set model(e){this._model=e,this.list.splice(0,this.list.length,Ss(e.length))}getFocus(){return this.list.getFocus()}getSelection(){return this.list.getSelection()}getSelectedElements(){return this.getSelection().map(e=>this.model.get(e))}style(e){this.list.style(e)}dispose(){this.list.dispose()}}var mb=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};const nue=!1;var kx;(function(o){o.North="north",o.South="south",o.East="east",o.West="west"})(kx||(kx={}));let sue=4;const oue=new O;let rue=300;const aue=new O;class Q5{constructor(e){this.el=e,this.disposables=new $}get onPointerMove(){return this.disposables.add(new et(xe(this.el),"mousemove")).event}get onPointerUp(){return this.disposables.add(new et(xe(this.el),"mouseup")).event}dispose(){this.disposables.dispose()}}mb([Ti],Q5.prototype,"onPointerMove",null);mb([Ti],Q5.prototype,"onPointerUp",null);class J5{get onPointerMove(){return this.disposables.add(new et(this.el,Ot.Change)).event}get onPointerUp(){return this.disposables.add(new et(this.el,Ot.End)).event}constructor(e){this.el=e,this.disposables=new $}dispose(){this.disposables.dispose()}}mb([Ti],J5.prototype,"onPointerMove",null);mb([Ti],J5.prototype,"onPointerUp",null);class Ex{get onPointerMove(){return this.factory.onPointerMove}get onPointerUp(){return this.factory.onPointerUp}constructor(e){this.factory=e}dispose(){}}mb([Ti],Ex.prototype,"onPointerMove",null);mb([Ti],Ex.prototype,"onPointerUp",null);const v7="pointer-events-disabled";class Nn extends F{get state(){return this._state}get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}set state(e){this._state!==e&&(this.el.classList.toggle("disabled",e===0),this.el.classList.toggle("minimum",e===1),this.el.classList.toggle("maximum",e===2),this._state=e,this.onDidEnablementChange.fire(e))}set orthogonalStartSash(e){if(this._orthogonalStartSash!==e){if(this.orthogonalStartDragHandleDisposables.clear(),this.orthogonalStartSashDisposables.clear(),e){const t=i=>{this.orthogonalStartDragHandleDisposables.clear(),i!==0&&(this._orthogonalStartDragHandle=Y(this.el,ie(".orthogonal-drag-handle.start")),this.orthogonalStartDragHandleDisposables.add(ve(()=>this._orthogonalStartDragHandle.remove())),this.orthogonalStartDragHandleDisposables.add(new et(this._orthogonalStartDragHandle,"mouseenter")).event(()=>Nn.onMouseEnter(e),void 0,this.orthogonalStartDragHandleDisposables),this.orthogonalStartDragHandleDisposables.add(new et(this._orthogonalStartDragHandle,"mouseleave")).event(()=>Nn.onMouseLeave(e),void 0,this.orthogonalStartDragHandleDisposables))};this.orthogonalStartSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalStartSash=e}}set orthogonalEndSash(e){if(this._orthogonalEndSash!==e){if(this.orthogonalEndDragHandleDisposables.clear(),this.orthogonalEndSashDisposables.clear(),e){const t=i=>{this.orthogonalEndDragHandleDisposables.clear(),i!==0&&(this._orthogonalEndDragHandle=Y(this.el,ie(".orthogonal-drag-handle.end")),this.orthogonalEndDragHandleDisposables.add(ve(()=>this._orthogonalEndDragHandle.remove())),this.orthogonalEndDragHandleDisposables.add(new et(this._orthogonalEndDragHandle,"mouseenter")).event(()=>Nn.onMouseEnter(e),void 0,this.orthogonalEndDragHandleDisposables),this.orthogonalEndDragHandleDisposables.add(new et(this._orthogonalEndDragHandle,"mouseleave")).event(()=>Nn.onMouseLeave(e),void 0,this.orthogonalEndDragHandleDisposables))};this.orthogonalEndSashDisposables.add(e.onDidEnablementChange.event(t,this)),t(e.state)}this._orthogonalEndSash=e}}constructor(e,t,i){super(),this.hoverDelay=rue,this.hoverDelayer=this._register(new hr(this.hoverDelay)),this._state=3,this.onDidEnablementChange=this._register(new O),this._onDidStart=this._register(new O),this._onDidChange=this._register(new O),this._onDidReset=this._register(new O),this._onDidEnd=this._register(new O),this.orthogonalStartSashDisposables=this._register(new $),this.orthogonalStartDragHandleDisposables=this._register(new $),this.orthogonalEndSashDisposables=this._register(new $),this.orthogonalEndDragHandleDisposables=this._register(new $),this.onDidStart=this._onDidStart.event,this.onDidChange=this._onDidChange.event,this.onDidReset=this._onDidReset.event,this.onDidEnd=this._onDidEnd.event,this.linkedSash=void 0,this.el=Y(e,ie(".monaco-sash")),i.orthogonalEdge&&this.el.classList.add(`orthogonal-edge-${i.orthogonalEdge}`),Qe&&this.el.classList.add("mac");const n=this._register(new et(this.el,"mousedown")).event;this._register(n(h=>this.onPointerStart(h,new Q5(e)),this));const s=this._register(new et(this.el,"dblclick")).event;this._register(s(this.onPointerDoublePress,this));const r=this._register(new et(this.el,"mouseenter")).event;this._register(r(()=>Nn.onMouseEnter(this)));const a=this._register(new et(this.el,"mouseleave")).event;this._register(a(()=>Nn.onMouseLeave(this))),this._register(Mn.addTarget(this.el));const l=this._register(new et(this.el,Ot.Start)).event;this._register(l(h=>this.onPointerStart(h,new J5(this.el)),this));const c=this._register(new et(this.el,Ot.Tap)).event;let d;this._register(c(h=>{if(d){clearTimeout(d),d=void 0,this.onPointerDoublePress(h);return}clearTimeout(d),d=setTimeout(()=>d=void 0,250)},this)),typeof i.size=="number"?(this.size=i.size,i.orientation===0?this.el.style.width=`${this.size}px`:this.el.style.height=`${this.size}px`):(this.size=sue,this._register(oue.event(h=>{this.size=h,this.layout()}))),this._register(aue.event(h=>this.hoverDelay=h)),this.layoutProvider=t,this.orthogonalStartSash=i.orthogonalStartSash,this.orthogonalEndSash=i.orthogonalEndSash,this.orientation=i.orientation||0,this.orientation===1?(this.el.classList.add("horizontal"),this.el.classList.remove("vertical")):(this.el.classList.remove("horizontal"),this.el.classList.add("vertical")),this.el.classList.toggle("debug",nue),this.layout()}onPointerStart(e,t){tt.stop(e);let i=!1;if(!e.__orthogonalSashEvent){const f=this.getOrthogonalSash(e);f&&(i=!0,e.__orthogonalSashEvent=!0,f.onPointerStart(e,new Ex(t)))}if(this.linkedSash&&!e.__linkedSashEvent&&(e.__linkedSashEvent=!0,this.linkedSash.onPointerStart(e,new Ex(t))),!this.state)return;const n=this.el.ownerDocument.getElementsByTagName("iframe");for(const f of n)f.classList.add(v7);const s=e.pageX,r=e.pageY,a=e.altKey,l={startX:s,currentX:s,startY:r,currentY:r,altKey:a};this.el.classList.add("active"),this._onDidStart.fire(l);const c=Bo(this.el),d=()=>{let f="";i?f="all-scroll":this.orientation===1?this.state===1?f="s-resize":this.state===2?f="n-resize":f=Qe?"row-resize":"ns-resize":this.state===1?f="e-resize":this.state===2?f="w-resize":f=Qe?"col-resize":"ew-resize",c.textContent=`* { cursor: ${f} !important; }`},h=new $;d(),i||this.onDidEnablementChange.event(d,null,h);const u=f=>{tt.stop(f,!1);const m={startX:s,currentX:f.pageX,startY:r,currentY:f.pageY,altKey:a};this._onDidChange.fire(m)},g=f=>{tt.stop(f,!1),c.remove(),this.el.classList.remove("active"),this._onDidEnd.fire(),h.dispose();for(const m of n)m.classList.remove(v7)};t.onPointerMove(u,null,h),t.onPointerUp(g,null,h),h.add(t)}onPointerDoublePress(e){const t=this.getOrthogonalSash(e);t&&t._onDidReset.fire(),this.linkedSash&&this.linkedSash._onDidReset.fire(),this._onDidReset.fire()}static onMouseEnter(e,t=!1){e.el.classList.contains("active")?(e.hoverDelayer.cancel(),e.el.classList.add("hover")):e.hoverDelayer.trigger(()=>e.el.classList.add("hover"),e.hoverDelay).then(void 0,()=>{}),!t&&e.linkedSash&&Nn.onMouseEnter(e.linkedSash,!0)}static onMouseLeave(e,t=!1){e.hoverDelayer.cancel(),e.el.classList.remove("hover"),!t&&e.linkedSash&&Nn.onMouseLeave(e.linkedSash,!0)}clearSashHoverState(){Nn.onMouseLeave(this)}layout(){if(this.orientation===0){const e=this.layoutProvider;this.el.style.left=e.getVerticalSashLeft(this)-this.size/2+"px",e.getVerticalSashTop&&(this.el.style.top=e.getVerticalSashTop(this)+"px"),e.getVerticalSashHeight&&(this.el.style.height=e.getVerticalSashHeight(this)+"px")}else{const e=this.layoutProvider;this.el.style.top=e.getHorizontalSashTop(this)-this.size/2+"px",e.getHorizontalSashLeft&&(this.el.style.left=e.getHorizontalSashLeft(this)+"px"),e.getHorizontalSashWidth&&(this.el.style.width=e.getHorizontalSashWidth(this)+"px")}}getOrthogonalSash(e){const t=e.initialTarget??e.target;if(!(!t||!qi(t))&&t.classList.contains("orthogonal-drag-handle"))return t.classList.contains("start")?this.orthogonalStartSash:this.orthogonalEndSash}dispose(){super.dispose(),this.el.remove()}}const lue={separatorBorder:j.transparent};class Y${set size(e){this._size=e}get size(){return this._size}get visible(){return typeof this._cachedVisibleSize>"u"}setVisible(e,t){if(e!==this.visible){e?(this.size=ts(this._cachedVisibleSize,this.viewMinimumSize,this.viewMaximumSize),this._cachedVisibleSize=void 0):(this._cachedVisibleSize=typeof t=="number"?t:this.size,this.size=0),this.container.classList.toggle("visible",e);try{this.view.setVisible?.(e)}catch(i){console.error("Splitview: Failed to set visible view"),console.error(i)}}}get minimumSize(){return this.visible?this.view.minimumSize:0}get viewMinimumSize(){return this.view.minimumSize}get maximumSize(){return this.visible?this.view.maximumSize:0}get viewMaximumSize(){return this.view.maximumSize}get priority(){return this.view.priority}get proportionalLayout(){return this.view.proportionalLayout??!0}get snap(){return!!this.view.snap}set enabled(e){this.container.style.pointerEvents=e?"":"none"}constructor(e,t,i,n){this.container=e,this.view=t,this.disposable=n,this._cachedVisibleSize=void 0,typeof i=="number"?(this._size=i,this._cachedVisibleSize=void 0,e.classList.add("visible")):(this._size=0,this._cachedVisibleSize=i.cachedVisibleSize)}layout(e,t){this.layoutContainer(e);try{this.view.layout(this.size,e,t)}catch(i){console.error("Splitview: Failed to layout view"),console.error(i)}}dispose(){this.disposable.dispose()}}class cue extends Y${layoutContainer(e){this.container.style.top=`${e}px`,this.container.style.height=`${this.size}px`}}class due extends Y${layoutContainer(e){this.container.style.left=`${e}px`,this.container.style.width=`${this.size}px`}}var oc;(function(o){o[o.Idle=0]="Idle",o[o.Busy=1]="Busy"})(oc||(oc={}));var Tx;(function(o){o.Distribute={type:"distribute"};function e(n){return{type:"split",index:n}}o.Split=e;function t(n){return{type:"auto",index:n}}o.Auto=t;function i(n){return{type:"invisible",cachedVisibleSize:n}}o.Invisible=i})(Tx||(Tx={}));class X$ extends F{get orthogonalStartSash(){return this._orthogonalStartSash}get orthogonalEndSash(){return this._orthogonalEndSash}get startSnappingEnabled(){return this._startSnappingEnabled}get endSnappingEnabled(){return this._endSnappingEnabled}set orthogonalStartSash(e){for(const t of this.sashItems)t.sash.orthogonalStartSash=e;this._orthogonalStartSash=e}set orthogonalEndSash(e){for(const t of this.sashItems)t.sash.orthogonalEndSash=e;this._orthogonalEndSash=e}set startSnappingEnabled(e){this._startSnappingEnabled!==e&&(this._startSnappingEnabled=e,this.updateSashEnablement())}set endSnappingEnabled(e){this._endSnappingEnabled!==e&&(this._endSnappingEnabled=e,this.updateSashEnablement())}constructor(e,t={}){super(),this.size=0,this._contentSize=0,this.proportions=void 0,this.viewItems=[],this.sashItems=[],this.state=oc.Idle,this._onDidSashChange=this._register(new O),this._onDidSashReset=this._register(new O),this._startSnappingEnabled=!0,this._endSnappingEnabled=!0,this.onDidSashChange=this._onDidSashChange.event,this.onDidSashReset=this._onDidSashReset.event,this.orientation=t.orientation??0,this.inverseAltBehavior=t.inverseAltBehavior??!1,this.proportionalLayout=t.proportionalLayout??!0,this.getSashOrthogonalSize=t.getSashOrthogonalSize,this.el=document.createElement("div"),this.el.classList.add("monaco-split-view2"),this.el.classList.add(this.orientation===0?"vertical":"horizontal"),e.appendChild(this.el),this.sashContainer=Y(this.el,ie(".sash-container")),this.viewContainer=ie(".split-view-container"),this.scrollable=this._register(new db({forceIntegerValues:!0,smoothScrollDuration:125,scheduleAtNextAnimationFrame:n=>ao(xe(this.el),n)})),this.scrollableElement=this._register(new RT(this.viewContainer,{vertical:this.orientation===0?t.scrollbarVisibility??1:2,horizontal:this.orientation===1?t.scrollbarVisibility??1:2},this.scrollable));const i=this._register(new et(this.viewContainer,"scroll")).event;this._register(i(n=>{const s=this.scrollableElement.getScrollPosition(),r=Math.abs(this.viewContainer.scrollLeft-s.scrollLeft)<=1?void 0:this.viewContainer.scrollLeft,a=Math.abs(this.viewContainer.scrollTop-s.scrollTop)<=1?void 0:this.viewContainer.scrollTop;(r!==void 0||a!==void 0)&&this.scrollableElement.setScrollPosition({scrollLeft:r,scrollTop:a})})),this.onDidScroll=this.scrollableElement.onScroll,this._register(this.onDidScroll(n=>{n.scrollTopChanged&&(this.viewContainer.scrollTop=n.scrollTop),n.scrollLeftChanged&&(this.viewContainer.scrollLeft=n.scrollLeft)})),Y(this.el,this.scrollableElement.getDomNode()),this.style(t.styles||lue),t.descriptor&&(this.size=t.descriptor.size,t.descriptor.views.forEach((n,s)=>{const r=Zn(n.visible)||n.visible?n.size:{type:"invisible",cachedVisibleSize:n.size},a=n.view;this.doAddView(a,r,s,!0)}),this._contentSize=this.viewItems.reduce((n,s)=>n+s.size,0),this.saveProportions())}style(e){e.separatorBorder.isTransparent()?(this.el.classList.remove("separator-border"),this.el.style.removeProperty("--separator-border")):(this.el.classList.add("separator-border"),this.el.style.setProperty("--separator-border",e.separatorBorder.toString()))}addView(e,t,i=this.viewItems.length,n){this.doAddView(e,t,i,n)}layout(e,t){const i=Math.max(this.size,this._contentSize);if(this.size=e,this.layoutContext=t,this.proportions){let n=0;for(let s=0;s<this.viewItems.length;s++){const r=this.viewItems[s],a=this.proportions[s];typeof a=="number"?n+=a:e-=r.size}for(let s=0;s<this.viewItems.length;s++){const r=this.viewItems[s],a=this.proportions[s];typeof a=="number"&&n>0&&(r.size=ts(Math.round(a*e/n),r.minimumSize,r.maximumSize))}}else{const n=Ss(this.viewItems.length),s=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);this.resize(this.viewItems.length-1,e-i,void 0,s,r)}this.distributeEmptySpace(),this.layoutViews()}saveProportions(){this.proportionalLayout&&this._contentSize>0&&(this.proportions=this.viewItems.map(e=>e.proportionalLayout&&e.visible?e.size/this._contentSize:void 0))}onSashStart({sash:e,start:t,alt:i}){for(const a of this.viewItems)a.enabled=!1;const n=this.sashItems.findIndex(a=>a.sash===e),s=Wr(H(this.el.ownerDocument.body,"keydown",a=>r(this.sashDragState.current,a.altKey)),H(this.el.ownerDocument.body,"keyup",()=>r(this.sashDragState.current,!1))),r=(a,l)=>{const c=this.viewItems.map(f=>f.size);let d=Number.NEGATIVE_INFINITY,h=Number.POSITIVE_INFINITY;if(this.inverseAltBehavior&&(l=!l),l)if(n===this.sashItems.length-1){const m=this.viewItems[n];d=(m.minimumSize-m.size)/2,h=(m.maximumSize-m.size)/2}else{const m=this.viewItems[n+1];d=(m.size-m.maximumSize)/2,h=(m.size-m.minimumSize)/2}let u,g;if(!l){const f=Ss(n,-1),m=Ss(n+1,this.viewItems.length),_=f.reduce((E,N)=>E+(this.viewItems[N].minimumSize-c[N]),0),b=f.reduce((E,N)=>E+(this.viewItems[N].viewMaximumSize-c[N]),0),v=m.length===0?Number.POSITIVE_INFINITY:m.reduce((E,N)=>E+(c[N]-this.viewItems[N].minimumSize),0),y=m.length===0?Number.NEGATIVE_INFINITY:m.reduce((E,N)=>E+(c[N]-this.viewItems[N].viewMaximumSize),0),C=Math.max(_,y),w=Math.min(v,b),x=this.findFirstSnapIndex(f),k=this.findFirstSnapIndex(m);if(typeof x=="number"){const E=this.viewItems[x],N=Math.floor(E.viewMinimumSize/2);u={index:x,limitDelta:E.visible?C-N:C+N,size:E.size}}if(typeof k=="number"){const E=this.viewItems[k],N=Math.floor(E.viewMinimumSize/2);g={index:k,limitDelta:E.visible?w+N:w-N,size:E.size}}}this.sashDragState={start:a,current:a,index:n,sizes:c,minDelta:d,maxDelta:h,alt:l,snapBefore:u,snapAfter:g,disposable:s}};r(t,i)}onSashChange({current:e}){const{index:t,start:i,sizes:n,alt:s,minDelta:r,maxDelta:a,snapBefore:l,snapAfter:c}=this.sashDragState;this.sashDragState.current=e;const d=e-i,h=this.resize(t,d,n,void 0,void 0,r,a,l,c);if(s){const u=t===this.sashItems.length-1,g=this.viewItems.map(y=>y.size),f=u?t:t+1,m=this.viewItems[f],_=m.size-m.maximumSize,b=m.size-m.minimumSize,v=u?t-1:t+1;this.resize(v,-h,g,void 0,void 0,_,b)}this.distributeEmptySpace(),this.layoutViews()}onSashEnd(e){this._onDidSashChange.fire(e),this.sashDragState.disposable.dispose(),this.saveProportions();for(const t of this.viewItems)t.enabled=!0}onViewChange(e,t){const i=this.viewItems.indexOf(e);i<0||i>=this.viewItems.length||(t=typeof t=="number"?t:e.size,t=ts(t,e.minimumSize,e.maximumSize),this.inverseAltBehavior&&i>0?(this.resize(i-1,Math.floor((e.size-t)/2)),this.distributeEmptySpace(),this.layoutViews()):(e.size=t,this.relayout([i],void 0)))}resizeView(e,t){if(!(e<0||e>=this.viewItems.length)){if(this.state!==oc.Idle)throw new Error("Cant modify splitview");this.state=oc.Busy;try{const i=Ss(this.viewItems.length).filter(a=>a!==e),n=[...i.filter(a=>this.viewItems[a].priority===1),e],s=i.filter(a=>this.viewItems[a].priority===2),r=this.viewItems[e];t=Math.round(t),t=ts(t,r.minimumSize,Math.min(r.maximumSize,this.size)),r.size=t,this.relayout(n,s)}finally{this.state=oc.Idle}}}distributeViewSizes(){const e=[];let t=0;for(const a of this.viewItems)a.maximumSize-a.minimumSize>0&&(e.push(a),t+=a.size);const i=Math.floor(t/e.length);for(const a of e)a.size=ts(i,a.minimumSize,a.maximumSize);const n=Ss(this.viewItems.length),s=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);this.relayout(s,r)}getViewSize(e){return e<0||e>=this.viewItems.length?-1:this.viewItems[e].size}doAddView(e,t,i=this.viewItems.length,n){if(this.state!==oc.Idle)throw new Error("Cant modify splitview");this.state=oc.Busy;try{const s=ie(".split-view-view");i===this.viewItems.length?this.viewContainer.appendChild(s):this.viewContainer.insertBefore(s,this.viewContainer.children.item(i));const r=e.onDidChange(u=>this.onViewChange(d,u)),a=ve(()=>s.remove()),l=Wr(r,a);let c;typeof t=="number"?c=t:(t.type==="auto"&&(this.areViewsDistributed()?t={type:"distribute"}:t={type:"split",index:t.index}),t.type==="split"?c=this.getViewSize(t.index)/2:t.type==="invisible"?c={cachedVisibleSize:t.cachedVisibleSize}:c=e.minimumSize);const d=this.orientation===0?new cue(s,e,c,l):new due(s,e,c,l);if(this.viewItems.splice(i,0,d),this.viewItems.length>1){const u={orthogonalStartSash:this.orthogonalStartSash,orthogonalEndSash:this.orthogonalEndSash},g=this.orientation===0?new Nn(this.sashContainer,{getHorizontalSashTop:E=>this.getSashPosition(E),getHorizontalSashWidth:this.getSashOrthogonalSize},{...u,orientation:1}):new Nn(this.sashContainer,{getVerticalSashLeft:E=>this.getSashPosition(E),getVerticalSashHeight:this.getSashOrthogonalSize},{...u,orientation:0}),f=this.orientation===0?E=>({sash:g,start:E.startY,current:E.currentY,alt:E.altKey}):E=>({sash:g,start:E.startX,current:E.currentX,alt:E.altKey}),_=se.map(g.onDidStart,f)(this.onSashStart,this),v=se.map(g.onDidChange,f)(this.onSashChange,this),C=se.map(g.onDidEnd,()=>this.sashItems.findIndex(E=>E.sash===g))(this.onSashEnd,this),w=g.onDidReset(()=>{const E=this.sashItems.findIndex(Z=>Z.sash===g),N=Ss(E,-1),z=Ss(E+1,this.viewItems.length),B=this.findFirstSnapIndex(N),U=this.findFirstSnapIndex(z);typeof B=="number"&&!this.viewItems[B].visible||typeof U=="number"&&!this.viewItems[U].visible||this._onDidSashReset.fire(E)}),x=Wr(_,v,C,w,g),k={sash:g,disposable:x};this.sashItems.splice(i-1,0,k)}s.appendChild(e.element);let h;typeof t!="number"&&t.type==="split"&&(h=[t.index]),n||this.relayout([i],h),!n&&typeof t!="number"&&t.type==="distribute"&&this.distributeViewSizes()}finally{this.state=oc.Idle}}relayout(e,t){const i=this.viewItems.reduce((n,s)=>n+s.size,0);this.resize(this.viewItems.length-1,this.size-i,void 0,e,t),this.distributeEmptySpace(),this.layoutViews(),this.saveProportions()}resize(e,t,i=this.viewItems.map(d=>d.size),n,s,r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,l,c){if(e<0||e>=this.viewItems.length)return 0;const d=Ss(e,-1),h=Ss(e+1,this.viewItems.length);if(s)for(const k of s)WD(d,k),WD(h,k);if(n)for(const k of n)uS(d,k),uS(h,k);const u=d.map(k=>this.viewItems[k]),g=d.map(k=>i[k]),f=h.map(k=>this.viewItems[k]),m=h.map(k=>i[k]),_=d.reduce((k,E)=>k+(this.viewItems[E].minimumSize-i[E]),0),b=d.reduce((k,E)=>k+(this.viewItems[E].maximumSize-i[E]),0),v=h.length===0?Number.POSITIVE_INFINITY:h.reduce((k,E)=>k+(i[E]-this.viewItems[E].minimumSize),0),y=h.length===0?Number.NEGATIVE_INFINITY:h.reduce((k,E)=>k+(i[E]-this.viewItems[E].maximumSize),0),C=Math.max(_,y,r),w=Math.min(v,b,a);let x=!1;if(l){const k=this.viewItems[l.index],E=t>=l.limitDelta;x=E!==k.visible,k.setVisible(E,l.size)}if(!x&&c){const k=this.viewItems[c.index],E=t<c.limitDelta;x=E!==k.visible,k.setVisible(E,c.size)}if(x)return this.resize(e,t,i,n,s,r,a);t=ts(t,C,w);for(let k=0,E=t;k<u.length;k++){const N=u[k],z=ts(g[k]+E,N.minimumSize,N.maximumSize),B=z-g[k];E-=B,N.size=z}for(let k=0,E=t;k<f.length;k++){const N=f[k],z=ts(m[k]-E,N.minimumSize,N.maximumSize),B=z-m[k];E+=B,N.size=z}return t}distributeEmptySpace(e){const t=this.viewItems.reduce((a,l)=>a+l.size,0);let i=this.size-t;const n=Ss(this.viewItems.length-1,-1),s=n.filter(a=>this.viewItems[a].priority===1),r=n.filter(a=>this.viewItems[a].priority===2);for(const a of r)WD(n,a);for(const a of s)uS(n,a);typeof e=="number"&&uS(n,e);for(let a=0;i!==0&&a<n.length;a++){const l=this.viewItems[n[a]],c=ts(l.size+i,l.minimumSize,l.maximumSize),d=c-l.size;i-=d,l.size=c}}layoutViews(){this._contentSize=this.viewItems.reduce((t,i)=>t+i.size,0);let e=0;for(const t of this.viewItems)t.layout(e,this.layoutContext),e+=t.size;this.sashItems.forEach(t=>t.sash.layout()),this.updateSashEnablement(),this.updateScrollableElement()}updateScrollableElement(){this.orientation===0?this.scrollableElement.setScrollDimensions({height:this.size,scrollHeight:this._contentSize}):this.scrollableElement.setScrollDimensions({width:this.size,scrollWidth:this._contentSize})}updateSashEnablement(){let e=!1;const t=this.viewItems.map(l=>e=l.size-l.minimumSize>0||e);e=!1;const i=this.viewItems.map(l=>e=l.maximumSize-l.size>0||e),n=[...this.viewItems].reverse();e=!1;const s=n.map(l=>e=l.size-l.minimumSize>0||e).reverse();e=!1;const r=n.map(l=>e=l.maximumSize-l.size>0||e).reverse();let a=0;for(let l=0;l<this.sashItems.length;l++){const{sash:c}=this.sashItems[l],d=this.viewItems[l];a+=d.size;const h=!(t[l]&&r[l+1]),u=!(i[l]&&s[l+1]);if(h&&u){const g=Ss(l,-1),f=Ss(l+1,this.viewItems.length),m=this.findFirstSnapIndex(g),_=this.findFirstSnapIndex(f),b=typeof m=="number"&&!this.viewItems[m].visible,v=typeof _=="number"&&!this.viewItems[_].visible;b&&s[l]&&(a>0||this.startSnappingEnabled)?c.state=1:v&&t[l]&&(a<this._contentSize||this.endSnappingEnabled)?c.state=2:c.state=0}else h&&!u?c.state=1:!h&&u?c.state=2:c.state=3}}getSashPosition(e){let t=0;for(let i=0;i<this.sashItems.length;i++)if(t+=this.viewItems[i].size,this.sashItems[i].sash===e)return t;return 0}findFirstSnapIndex(e){for(const t of e){const i=this.viewItems[t];if(i.visible&&i.snap)return t}for(const t of e){const i=this.viewItems[t];if(i.visible&&i.maximumSize-i.minimumSize>0)return;if(!i.visible&&i.snap)return t}}areViewsDistributed(){let e,t;for(const i of this.viewItems)if(e=e===void 0?i.size:Math.min(e,i.size),t=t===void 0?i.size:Math.max(t,i.size),t-e>2)return!1;return!0}dispose(){this.sashDragState?.disposable.dispose(),Dt(this.viewItems),this.viewItems=[],this.sashItems.forEach(e=>e.disposable.dispose()),this.sashItems=[],super.dispose()}}const Bk=class Bk{constructor(e,t,i){this.columns=e,this.getColumnSize=i,this.templateId=Bk.TemplateId,this.renderedTemplates=new Set;const n=new Map(t.map(s=>[s.templateId,s]));this.renderers=[];for(const s of e){const r=n.get(s.templateId);if(!r)throw new Error(`Table cell renderer for template id ${s.templateId} not found.`);this.renderers.push(r)}}renderTemplate(e){const t=Y(e,ie(".monaco-table-tr")),i=[],n=[];for(let r=0;r<this.columns.length;r++){const a=this.renderers[r],l=Y(t,ie(".monaco-table-td",{"data-col-index":r}));l.style.width=`${this.getColumnSize(r)}px`,i.push(l),n.push(a.renderTemplate(l))}const s={container:e,cellContainers:i,cellTemplateData:n};return this.renderedTemplates.add(s),s}renderElement(e,t,i,n){for(let s=0;s<this.columns.length;s++){const a=this.columns[s].project(e);this.renderers[s].renderElement(a,t,i.cellTemplateData[s],n)}}disposeElement(e,t,i,n){for(let s=0;s<this.columns.length;s++){const r=this.renderers[s];if(r.disposeElement){const l=this.columns[s].project(e);r.disposeElement(l,t,i.cellTemplateData[s],n)}}}disposeTemplate(e){for(let t=0;t<this.columns.length;t++)this.renderers[t].disposeTemplate(e.cellTemplateData[t]);fn(e.container),this.renderedTemplates.delete(e)}layoutColumn(e,t){for(const{cellContainers:i}of this.renderedTemplates)i[e].style.width=`${t}px`}};Bk.TemplateId="row";let Dx=Bk;function hue(o){return{getHeight(e){return o.getHeight(e)},getTemplateId(){return Dx.TemplateId}}}class uue extends F{get minimumSize(){return this.column.minimumWidth??120}get maximumSize(){return this.column.maximumWidth??Number.POSITIVE_INFINITY}get onDidChange(){return this.column.onDidChangeWidthConstraints??se.None}constructor(e,t){super(),this.column=e,this.index=t,this._onDidLayout=new O,this.onDidLayout=this._onDidLayout.event,this.element=ie(".monaco-table-th",{"data-col-index":t},e.label),e.tooltip&&this._register(Ba().setupManagedHover(bs("mouse"),this.element,e.tooltip))}layout(e){this._onDidLayout.fire([this.index,e])}}const Wk=class Wk{get onDidChangeFocus(){return this.list.onDidChangeFocus}get onDidChangeSelection(){return this.list.onDidChangeSelection}get onDidScroll(){return this.list.onDidScroll}get onMouseDblClick(){return this.list.onMouseDblClick}get onPointer(){return this.list.onPointer}get onDidFocus(){return this.list.onDidFocus}get scrollTop(){return this.list.scrollTop}set scrollTop(e){this.list.scrollTop=e}get scrollHeight(){return this.list.scrollHeight}get renderHeight(){return this.list.renderHeight}get onDidDispose(){return this.list.onDidDispose}constructor(e,t,i,n,s,r){this.virtualDelegate=i,this.columns=n,this.domId=`table_id_${++Wk.InstanceCount}`,this.disposables=new $,this.cachedWidth=0,this.cachedHeight=0,this.domNode=Y(t,ie(`.monaco-table.${this.domId}`));const a=n.map((d,h)=>this.disposables.add(new uue(d,h))),l={size:a.reduce((d,h)=>d+h.column.weight,0),views:a.map(d=>({size:d.column.weight,view:d}))};this.splitview=this.disposables.add(new X$(this.domNode,{orientation:1,scrollbarVisibility:2,getSashOrthogonalSize:()=>this.cachedHeight,descriptor:l})),this.splitview.el.style.height=`${i.headerRowHeight}px`,this.splitview.el.style.lineHeight=`${i.headerRowHeight}px`;const c=new Dx(n,s,d=>this.splitview.getViewSize(d));this.list=this.disposables.add(new $o(e,this.domNode,hue(i),[c],r)),se.any(...a.map(d=>d.onDidLayout))(([d,h])=>c.layoutColumn(d,h),null,this.disposables),this.splitview.onDidSashReset(d=>{const h=n.reduce((g,f)=>g+f.weight,0),u=n[d].weight/h*this.cachedWidth;this.splitview.resizeView(d,u)},null,this.disposables),this.styleElement=Bo(this.domNode),this.style(Fle)}updateOptions(e){this.list.updateOptions(e)}splice(e,t,i=[]){this.list.splice(e,t,i)}getHTMLElement(){return this.domNode}style(e){const t=[];t.push(`.monaco-table.${this.domId} > .monaco-split-view2 .monaco-sash.vertical::before {
			top: ${this.virtualDelegate.headerRowHeight+1}px;
			height: calc(100% - ${this.virtualDelegate.headerRowHeight}px);
		}`),this.styleElement.textContent=t.join(`
`),this.list.style(e)}getSelectedElements(){return this.list.getSelectedElements()}getSelection(){return this.list.getSelection()}getFocus(){return this.list.getFocus()}dispose(){this.disposables.dispose()}};Wk.InstanceCount=0;let iM=Wk;var yo;(function(o){o[o.Expanded=0]="Expanded",o[o.Collapsed=1]="Collapsed",o[o.PreserveOrExpanded=2]="PreserveOrExpanded",o[o.PreserveOrCollapsed=3]="PreserveOrCollapsed"})(yo||(yo={}));var tg;(function(o){o[o.Unknown=0]="Unknown",o[o.Twistie=1]="Twistie",o[o.Element=2]="Element",o[o.Filter=3]="Filter"})(tg||(tg={}));class To extends Error{constructor(e,t){super(`TreeError [${e}] ${t}`)}}class eB{constructor(e){this.fn=e,this._map=new WeakMap}map(e){let t=this._map.get(e);return t||(t=this.fn(e),this._map.set(e,t)),t}}function tB(o){return typeof o=="object"&&"visibility"in o&&"data"in o}function xy(o){switch(o){case!0:return 1;case!1:return 0;default:return o}}function $I(o){return typeof o.collapsible=="boolean"}class gue{constructor(e,t,i,n={}){this.user=e,this.list=t,this.rootRef=[],this.eventBufferer=new Cw,this._onDidChangeCollapseState=new O,this.onDidChangeCollapseState=this.eventBufferer.wrapEvent(this._onDidChangeCollapseState.event),this._onDidChangeRenderNodeCount=new O,this.onDidChangeRenderNodeCount=this.eventBufferer.wrapEvent(this._onDidChangeRenderNodeCount.event),this._onDidSplice=new O,this.onDidSplice=this._onDidSplice.event,this.refilterDelayer=new hr(Pz),this.collapseByDefault=typeof n.collapseByDefault>"u"?!1:n.collapseByDefault,this.allowNonCollapsibleParents=n.allowNonCollapsibleParents??!1,this.filter=n.filter,this.autoExpandSingleChildren=typeof n.autoExpandSingleChildren>"u"?!1:n.autoExpandSingleChildren,this.root={parent:void 0,element:i,children:[],depth:0,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:!1,collapsed:!1,renderNodeCount:0,visibility:1,visible:!0,filterData:void 0}}splice(e,t,i=nt.empty(),n={}){if(e.length===0)throw new To(this.user,"Invalid tree location");n.diffIdentityProvider?this.spliceSmart(n.diffIdentityProvider,e,t,i,n):this.spliceSimple(e,t,i,n)}spliceSmart(e,t,i,n=nt.empty(),s,r=s.diffDepth??0){const{parentNode:a}=this.getParentNodeWithListIndex(t);if(!a.lastDiffIds)return this.spliceSimple(t,i,n,s);const l=[...n],c=t[t.length-1],d=new pl({getElements:()=>a.lastDiffIds},{getElements:()=>[...a.children.slice(0,c),...l,...a.children.slice(c+i)].map(m=>e.getId(m.element).toString())}).ComputeDiff(!1);if(d.quitEarly)return a.lastDiffIds=void 0,this.spliceSimple(t,i,l,s);const h=t.slice(0,-1),u=(m,_,b)=>{if(r>0)for(let v=0;v<b;v++)m--,_--,this.spliceSmart(e,[...h,m,0],Number.MAX_SAFE_INTEGER,l[_].children,s,r-1)};let g=Math.min(a.children.length,c+i),f=l.length;for(const m of d.changes.sort((_,b)=>b.originalStart-_.originalStart))u(g,f,g-(m.originalStart+m.originalLength)),g=m.originalStart,f=m.modifiedStart-c,this.spliceSimple([...h,g],m.originalLength,nt.slice(l,f,f+m.modifiedLength),s);u(g,f,g)}spliceSimple(e,t,i=nt.empty(),{onDidCreateNode:n,onDidDeleteNode:s,diffIdentityProvider:r}){const{parentNode:a,listIndex:l,revealed:c,visible:d}=this.getParentNodeWithListIndex(e),h=[],u=nt.map(i,w=>this.createTreeNode(w,a,a.visible?1:0,c,h,n)),g=e[e.length-1];let f=0;for(let w=g;w>=0&&w<a.children.length;w--){const x=a.children[w];if(x.visible){f=x.visibleChildIndex;break}}const m=[];let _=0,b=0;for(const w of u)m.push(w),b+=w.renderNodeCount,w.visible&&(w.visibleChildIndex=f+_++);const v=m3(a.children,g,t,m);r?a.lastDiffIds?m3(a.lastDiffIds,g,t,m.map(w=>r.getId(w.element).toString())):a.lastDiffIds=a.children.map(w=>r.getId(w.element).toString()):a.lastDiffIds=void 0;let y=0;for(const w of v)w.visible&&y++;if(y!==0)for(let w=g+m.length;w<a.children.length;w++){const x=a.children[w];x.visible&&(x.visibleChildIndex-=y)}if(a.visibleChildrenCount+=_-y,c&&d){const w=v.reduce((x,k)=>x+(k.visible?k.renderNodeCount:0),0);this._updateAncestorsRenderNodeCount(a,b-w),this.list.splice(l,w,h)}if(v.length>0&&s){const w=x=>{s(x),x.children.forEach(w)};v.forEach(w)}this._onDidSplice.fire({insertedNodes:m,deletedNodes:v});let C=a;for(;C;){if(C.visibility===2){this.refilterDelayer.trigger(()=>this.refilter());break}C=C.parent}}rerender(e){if(e.length===0)throw new To(this.user,"Invalid tree location");const{node:t,listIndex:i,revealed:n}=this.getTreeNodeWithListIndex(e);t.visible&&n&&this.list.splice(i,1,[t])}has(e){return this.hasTreeNode(e)}getListIndex(e){const{listIndex:t,visible:i,revealed:n}=this.getTreeNodeWithListIndex(e);return i&&n?t:-1}getListRenderCount(e){return this.getTreeNode(e).renderNodeCount}isCollapsible(e){return this.getTreeNode(e).collapsible}setCollapsible(e,t){const i=this.getTreeNode(e);typeof t>"u"&&(t=!i.collapsible);const n={collapsible:t};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,n))}isCollapsed(e){return this.getTreeNode(e).collapsed}setCollapsed(e,t,i){const n=this.getTreeNode(e);typeof t>"u"&&(t=!n.collapsed);const s={collapsed:t,recursive:i||!1};return this.eventBufferer.bufferEvents(()=>this._setCollapseState(e,s))}_setCollapseState(e,t){const{node:i,listIndex:n,revealed:s}=this.getTreeNodeWithListIndex(e),r=this._setListNodeCollapseState(i,n,s,t);if(i!==this.root&&this.autoExpandSingleChildren&&r&&!$I(t)&&i.collapsible&&!i.collapsed&&!t.recursive){let a=-1;for(let l=0;l<i.children.length;l++)if(i.children[l].visible)if(a>-1){a=-1;break}else a=l;a>-1&&this._setCollapseState([...e,a],t)}return r}_setListNodeCollapseState(e,t,i,n){const s=this._setNodeCollapseState(e,n,!1);if(!i||!e.visible||!s)return s;const r=e.renderNodeCount,a=this.updateNodeAfterCollapseChange(e),l=r-(t===-1?0:1);return this.list.splice(t+1,l,a.slice(1)),s}_setNodeCollapseState(e,t,i){let n;if(e===this.root?n=!1:($I(t)?(n=e.collapsible!==t.collapsible,e.collapsible=t.collapsible):e.collapsible?(n=e.collapsed!==t.collapsed,e.collapsed=t.collapsed):n=!1,n&&this._onDidChangeCollapseState.fire({node:e,deep:i})),!$I(t)&&t.recursive)for(const s of e.children)n=this._setNodeCollapseState(s,t,!0)||n;return n}expandTo(e){this.eventBufferer.bufferEvents(()=>{let t=this.getTreeNode(e);for(;t.parent;)t=t.parent,e=e.slice(0,e.length-1),t.collapsed&&this._setCollapseState(e,{collapsed:!1,recursive:!1})})}refilter(){const e=this.root.renderNodeCount,t=this.updateNodeAfterFilterChange(this.root);this.list.splice(0,e,t),this.refilterDelayer.cancel()}createTreeNode(e,t,i,n,s,r){const a={parent:t,element:e.element,children:[],depth:t.depth+1,visibleChildrenCount:0,visibleChildIndex:-1,collapsible:typeof e.collapsible=="boolean"?e.collapsible:typeof e.collapsed<"u",collapsed:typeof e.collapsed>"u"?this.collapseByDefault:e.collapsed,renderNodeCount:1,visibility:1,visible:!0,filterData:void 0},l=this._filterNode(a,i);a.visibility=l,n&&s.push(a);const c=e.children||nt.empty(),d=n&&l!==0&&!a.collapsed;let h=0,u=1;for(const g of c){const f=this.createTreeNode(g,a,l,d,s,r);a.children.push(f),u+=f.renderNodeCount,f.visible&&(f.visibleChildIndex=h++)}return this.allowNonCollapsibleParents||(a.collapsible=a.collapsible||a.children.length>0),a.visibleChildrenCount=h,a.visible=l===2?h>0:l===1,a.visible?a.collapsed||(a.renderNodeCount=u):(a.renderNodeCount=0,n&&s.pop()),r?.(a),a}updateNodeAfterCollapseChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterCollapseChange(e,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterCollapseChange(e,t){if(e.visible===!1)return 0;if(t.push(e),e.renderNodeCount=1,!e.collapsed)for(const i of e.children)e.renderNodeCount+=this._updateNodeAfterCollapseChange(i,t);return this._onDidChangeRenderNodeCount.fire(e),e.renderNodeCount}updateNodeAfterFilterChange(e){const t=e.renderNodeCount,i=[];return this._updateNodeAfterFilterChange(e,e.visible?1:0,i),this._updateAncestorsRenderNodeCount(e.parent,i.length-t),i}_updateNodeAfterFilterChange(e,t,i,n=!0){let s;if(e!==this.root){if(s=this._filterNode(e,t),s===0)return e.visible=!1,e.renderNodeCount=0,!1;n&&i.push(e)}const r=i.length;e.renderNodeCount=e===this.root?0:1;let a=!1;if(!e.collapsed||s!==0){let l=0;for(const c of e.children)a=this._updateNodeAfterFilterChange(c,s,i,n&&!e.collapsed)||a,c.visible&&(c.visibleChildIndex=l++);e.visibleChildrenCount=l}else e.visibleChildrenCount=0;return e!==this.root&&(e.visible=s===2?a:s===1,e.visibility=s),e.visible?e.collapsed||(e.renderNodeCount+=i.length-r):(e.renderNodeCount=0,n&&i.pop()),this._onDidChangeRenderNodeCount.fire(e),e.visible}_updateAncestorsRenderNodeCount(e,t){if(t!==0)for(;e;)e.renderNodeCount+=t,this._onDidChangeRenderNodeCount.fire(e),e=e.parent}_filterNode(e,t){const i=this.filter?this.filter.filter(e.element,t):1;return typeof i=="boolean"?(e.filterData=void 0,i?1:0):tB(i)?(e.filterData=i.data,xy(i.visibility)):(e.filterData=void 0,xy(i))}hasTreeNode(e,t=this.root){if(!e||e.length===0)return!0;const[i,...n]=e;return i<0||i>t.children.length?!1:this.hasTreeNode(n,t.children[i])}getTreeNode(e,t=this.root){if(!e||e.length===0)return t;const[i,...n]=e;if(i<0||i>t.children.length)throw new To(this.user,"Invalid tree location");return this.getTreeNode(n,t.children[i])}getTreeNodeWithListIndex(e){if(e.length===0)return{node:this.root,listIndex:-1,revealed:!0,visible:!1};const{parentNode:t,listIndex:i,revealed:n,visible:s}=this.getParentNodeWithListIndex(e),r=e[e.length-1];if(r<0||r>t.children.length)throw new To(this.user,"Invalid tree location");const a=t.children[r];return{node:a,listIndex:i,revealed:n,visible:s&&a.visible}}getParentNodeWithListIndex(e,t=this.root,i=0,n=!0,s=!0){const[r,...a]=e;if(r<0||r>t.children.length)throw new To(this.user,"Invalid tree location");for(let l=0;l<r;l++)i+=t.children[l].renderNodeCount;return n=n&&!t.collapsed,s=s&&t.visible,a.length===0?{parentNode:t,listIndex:i,revealed:n,visible:s}:this.getParentNodeWithListIndex(a,t.children[r],i+1,n,s)}getNode(e=[]){return this.getTreeNode(e)}getNodeLocation(e){const t=[];let i=e;for(;i.parent;)t.push(i.parent.children.indexOf(i)),i=i.parent;return t.reverse()}getParentNodeLocation(e){if(e.length!==0)return e.length===1?[]:kY(e)[0]}getFirstElementChild(e){const t=this.getTreeNode(e);if(t.children.length!==0)return t.children[0].element}}class fue extends Ww{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function KI(o){return o instanceof Ww?new fue(o):o}class pue{constructor(e,t){this.modelProvider=e,this.dnd=t,this.autoExpandDisposable=F.None,this.disposables=new $}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(KI(e),t)}onDragOver(e,t,i,n,s,r=!0){const a=this.dnd.onDragOver(KI(e),t&&t.element,i,n,s),l=this.autoExpandNode!==t;if(l&&(this.autoExpandDisposable.dispose(),this.autoExpandNode=t),typeof t>"u")return a;if(l&&typeof a!="boolean"&&a.autoExpand&&(this.autoExpandDisposable=Rh(()=>{const g=this.modelProvider(),f=g.getNodeLocation(t);g.isCollapsed(f)&&g.setCollapsed(f,!1),this.autoExpandNode=void 0},500,this.disposables)),typeof a=="boolean"||!a.accept||typeof a.bubble>"u"||a.feedback){if(!r){const g=typeof a=="boolean"?a:a.accept,f=typeof a=="boolean"?void 0:a.effect;return{accept:g,effect:f,feedback:[i]}}return a}if(a.bubble===1){const g=this.modelProvider(),f=g.getNodeLocation(t),m=g.getParentNodeLocation(f),_=g.getNode(m),b=m&&g.getListIndex(m);return this.onDragOver(e,_,b,n,s,!1)}const c=this.modelProvider(),d=c.getNodeLocation(t),h=c.getListIndex(d),u=c.getListRenderCount(d);return{...a,feedback:Ss(h,h+u)}}drop(e,t,i,n,s){this.autoExpandDisposable.dispose(),this.autoExpandNode=void 0,this.dnd.drop(KI(e),t&&t.element,i,n,s)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.disposables.dispose(),this.dnd.dispose()}}function mue(o,e){return e&&{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(t.element)}},dnd:e.dnd&&new pue(o,e.dnd),multipleSelectionController:e.multipleSelectionController&&{isSelectionSingleChangeEvent(t){return e.multipleSelectionController.isSelectionSingleChangeEvent({...t,element:t.element})},isSelectionRangeChangeEvent(t){return e.multipleSelectionController.isSelectionRangeChangeEvent({...t,element:t.element})}},accessibilityProvider:e.accessibilityProvider&&{...e.accessibilityProvider,getSetSize(t){const i=o(),n=i.getNodeLocation(t),s=i.getParentNodeLocation(n);return i.getNode(s).visibleChildrenCount},getPosInSet(t){return t.visibleChildIndex+1},isChecked:e.accessibilityProvider&&e.accessibilityProvider.isChecked?t=>e.accessibilityProvider.isChecked(t.element):void 0,getRole:e.accessibilityProvider&&e.accessibilityProvider.getRole?t=>e.accessibilityProvider.getRole(t.element):()=>"treeitem",getAriaLabel(t){return e.accessibilityProvider.getAriaLabel(t.element)},getWidgetAriaLabel(){return e.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:e.accessibilityProvider&&e.accessibilityProvider.getWidgetRole?()=>e.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:e.accessibilityProvider&&e.accessibilityProvider.getAriaLevel?t=>e.accessibilityProvider.getAriaLevel(t.element):t=>t.depth,getActiveDescendantId:e.accessibilityProvider.getActiveDescendantId&&(t=>e.accessibilityProvider.getActiveDescendantId(t.element))},keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(t){return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t.element)}}}}class iB{constructor(e){this.delegate=e}getHeight(e){return this.delegate.getHeight(e.element)}getTemplateId(e){return this.delegate.getTemplateId(e.element)}hasDynamicHeight(e){return!!this.delegate.hasDynamicHeight&&this.delegate.hasDynamicHeight(e.element)}setDynamicHeight(e,t){this.delegate.setDynamicHeight?.(e.element,t)}}var R_;(function(o){o.None="none",o.OnHover="onHover",o.Always="always"})(R_||(R_={}));class _ue{get elements(){return this._elements}constructor(e,t=[]){this._elements=t,this.disposables=new $,this.onDidChange=se.forEach(e,i=>this._elements=i,this.disposables)}dispose(){this.disposables.dispose()}}const EC=class EC{constructor(e,t,i,n,s,r={}){this.renderer=e,this.modelProvider=t,this.activeNodes=n,this.renderedIndentGuides=s,this.renderedElements=new Map,this.renderedNodes=new Map,this.indent=EC.DefaultIndent,this.hideTwistiesOfChildlessElements=!1,this.shouldRenderIndentGuides=!1,this.activeIndentNodes=new Set,this.indentGuidesDisposable=F.None,this.disposables=new $,this.templateId=e.templateId,this.updateOptions(r),se.map(i,a=>a.node)(this.onDidChangeNodeTwistieState,this,this.disposables),e.onDidChangeTwistieState?.(this.onDidChangeTwistieState,this,this.disposables)}updateOptions(e={}){if(typeof e.indent<"u"){const t=ts(e.indent,0,40);if(t!==this.indent){this.indent=t;for(const[i,n]of this.renderedNodes)this.renderTreeElement(i,n)}}if(typeof e.renderIndentGuides<"u"){const t=e.renderIndentGuides!==R_.None;if(t!==this.shouldRenderIndentGuides){this.shouldRenderIndentGuides=t;for(const[i,n]of this.renderedNodes)this._renderIndentGuides(i,n);if(this.indentGuidesDisposable.dispose(),t){const i=new $;this.activeNodes.onDidChange(this._onDidChangeActiveNodes,this,i),this.indentGuidesDisposable=i,this._onDidChangeActiveNodes(this.activeNodes.elements)}}}typeof e.hideTwistiesOfChildlessElements<"u"&&(this.hideTwistiesOfChildlessElements=e.hideTwistiesOfChildlessElements)}renderTemplate(e){const t=Y(e,ie(".monaco-tl-row")),i=Y(t,ie(".monaco-tl-indent")),n=Y(t,ie(".monaco-tl-twistie")),s=Y(t,ie(".monaco-tl-contents")),r=this.renderer.renderTemplate(s);return{container:e,indent:i,twistie:n,indentGuidesDisposable:F.None,templateData:r}}renderElement(e,t,i,n){this.renderedNodes.set(e,i),this.renderedElements.set(e.element,e),this.renderTreeElement(e,i),this.renderer.renderElement(e,t,i.templateData,n)}disposeElement(e,t,i,n){i.indentGuidesDisposable.dispose(),this.renderer.disposeElement?.(e,t,i.templateData,n),typeof n=="number"&&(this.renderedNodes.delete(e),this.renderedElements.delete(e.element))}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}onDidChangeTwistieState(e){const t=this.renderedElements.get(e);t&&this.onDidChangeNodeTwistieState(t)}onDidChangeNodeTwistieState(e){const t=this.renderedNodes.get(e);t&&(this._onDidChangeActiveNodes(this.activeNodes.elements),this.renderTreeElement(e,t))}renderTreeElement(e,t){const i=EC.DefaultIndent+(e.depth-1)*this.indent;t.twistie.style.paddingLeft=`${i}px`,t.indent.style.width=`${i+this.indent-16}px`,e.collapsible?t.container.setAttribute("aria-expanded",String(!e.collapsed)):t.container.removeAttribute("aria-expanded"),t.twistie.classList.remove(...ke.asClassNameArray(J.treeItemExpanded));let n=!1;this.renderer.renderTwistie&&(n=this.renderer.renderTwistie(e.element,t.twistie)),e.collapsible&&(!this.hideTwistiesOfChildlessElements||e.visibleChildrenCount>0)?(n||t.twistie.classList.add(...ke.asClassNameArray(J.treeItemExpanded)),t.twistie.classList.add("collapsible"),t.twistie.classList.toggle("collapsed",e.collapsed)):t.twistie.classList.remove("collapsible","collapsed"),this._renderIndentGuides(e,t)}_renderIndentGuides(e,t){if(fn(t.indent),t.indentGuidesDisposable.dispose(),!this.shouldRenderIndentGuides)return;const i=new $,n=this.modelProvider();for(;;){const s=n.getNodeLocation(e),r=n.getParentNodeLocation(s);if(!r)break;const a=n.getNode(r),l=ie(".indent-guide",{style:`width: ${this.indent}px`});this.activeIndentNodes.has(a)&&l.classList.add("active"),t.indent.childElementCount===0?t.indent.appendChild(l):t.indent.insertBefore(l,t.indent.firstElementChild),this.renderedIndentGuides.add(a,l),i.add(ve(()=>this.renderedIndentGuides.delete(a,l))),e=a}t.indentGuidesDisposable=i}_onDidChangeActiveNodes(e){if(!this.shouldRenderIndentGuides)return;const t=new Set,i=this.modelProvider();e.forEach(n=>{const s=i.getNodeLocation(n);try{const r=i.getParentNodeLocation(s);n.collapsible&&n.children.length>0&&!n.collapsed?t.add(n):r&&t.add(i.getNode(r))}catch{}}),this.activeIndentNodes.forEach(n=>{t.has(n)||this.renderedIndentGuides.forEach(n,s=>s.classList.remove("active"))}),t.forEach(n=>{this.activeIndentNodes.has(n)||this.renderedIndentGuides.forEach(n,s=>s.classList.add("active"))}),this.activeIndentNodes=t}dispose(){this.renderedNodes.clear(),this.renderedElements.clear(),this.indentGuidesDisposable.dispose(),Dt(this.disposables)}};EC.DefaultIndent=8;let nM=EC;class bue{get totalCount(){return this._totalCount}get matchCount(){return this._matchCount}constructor(e,t,i){this.tree=e,this.keyboardNavigationLabelProvider=t,this._filter=i,this._totalCount=0,this._matchCount=0,this._pattern="",this._lowercasePattern="",this.disposables=new $,e.onWillRefilter(this.reset,this,this.disposables)}filter(e,t){let i=1;if(this._filter){const r=this._filter.filter(e,t);if(typeof r=="boolean"?i=r?1:0:tB(r)?i=xy(r.visibility):i=r,i===0)return!1}if(this._totalCount++,!this._pattern)return this._matchCount++,{data:ka.Default,visibility:i};const n=this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e),s=Array.isArray(n)?n:[n];for(const r of s){const a=r&&r.toString();if(typeof a>"u")return{data:ka.Default,visibility:i};let l;if(this.tree.findMatchType===Tf.Contiguous){const c=a.toLowerCase().indexOf(this._lowercasePattern);if(c>-1){l=[Number.MAX_SAFE_INTEGER,0];for(let d=this._lowercasePattern.length;d>0;d--)l.push(c+d-1)}}else l=xf(this._pattern,this._lowercasePattern,0,a,a.toLowerCase(),0,{firstMatchCanBeWeak:!0,boostFullMatch:!0});if(l)return this._matchCount++,s.length===1?{data:l,visibility:i}:{data:{label:a,score:l},visibility:i}}return this.tree.findMode===Dc.Filter?typeof this.tree.options.defaultFindVisibility=="number"?this.tree.options.defaultFindVisibility:this.tree.options.defaultFindVisibility?this.tree.options.defaultFindVisibility(e):2:{data:ka.Default,visibility:i}}reset(){this._totalCount=0,this._matchCount=0}dispose(){Dt(this.disposables)}}var Dc;(function(o){o[o.Highlight=0]="Highlight",o[o.Filter=1]="Filter"})(Dc||(Dc={}));var Tf;(function(o){o[o.Fuzzy=0]="Fuzzy",o[o.Contiguous=1]="Contiguous"})(Tf||(Tf={}));let vue=class{get pattern(){return this._pattern}get mode(){return this._mode}set mode(e){e!==this._mode&&(this._mode=e,this.widget&&(this.widget.mode=this._mode),this.tree.refilter(),this.render(),this._onDidChangeMode.fire(e))}get matchType(){return this._matchType}set matchType(e){e!==this._matchType&&(this._matchType=e,this.widget&&(this.widget.matchType=this._matchType),this.tree.refilter(),this.render(),this._onDidChangeMatchType.fire(e))}constructor(e,t,i,n,s,r={}){this.tree=e,this.view=i,this.filter=n,this.contextViewProvider=s,this.options=r,this._pattern="",this.width=0,this._onDidChangeMode=new O,this.onDidChangeMode=this._onDidChangeMode.event,this._onDidChangeMatchType=new O,this.onDidChangeMatchType=this._onDidChangeMatchType.event,this._onDidChangePattern=new O,this._onDidChangeOpenState=new O,this.onDidChangeOpenState=this._onDidChangeOpenState.event,this.enabledDisposables=new $,this.disposables=new $,this._mode=e.options.defaultFindMode??Dc.Highlight,this._matchType=e.options.defaultFindMatchType??Tf.Fuzzy,t.onDidSplice(this.onDidSpliceModel,this,this.disposables)}updateOptions(e={}){e.defaultFindMode!==void 0&&(this.mode=e.defaultFindMode),e.defaultFindMatchType!==void 0&&(this.matchType=e.defaultFindMatchType)}onDidSpliceModel(){!this.widget||this.pattern.length===0||(this.tree.refilter(),this.render())}render(){const e=this.filter.totalCount>0&&this.filter.matchCount===0;this.pattern&&e?(ps(p("replFindNoResults","No results")),this.tree.options.showNotFoundMessage??!0?this.widget?.showMessage({type:2,content:p("not found","No elements found.")}):this.widget?.showMessage({type:2})):(this.widget?.clearMessage(),this.pattern&&ps(p("replFindResults","{0} results",this.filter.matchCount)))}shouldAllowFocus(e){return!this.widget||!this.pattern||this.filter.totalCount>0&&this.filter.matchCount<=1?!0:!ka.isDefault(e.filterData)}layout(e){this.width=e,this.widget?.layout(e)}dispose(){this._history=void 0,this._onDidChangePattern.dispose(),this.enabledDisposables.dispose(),this.disposables.dispose()}};function Cue(o,e){return o.position===e.position&&Q$(o,e)}function Q$(o,e){return o.node.element===e.node.element&&o.startIndex===e.startIndex&&o.height===e.height&&o.endIndex===e.endIndex}class yue{constructor(e=[]){this.stickyNodes=e}get count(){return this.stickyNodes.length}equal(e){return ei(this.stickyNodes,e.stickyNodes,Cue)}lastNodePartiallyVisible(){if(this.count===0)return!1;const e=this.stickyNodes[this.count-1];if(this.count===1)return e.position!==0;const t=this.stickyNodes[this.count-2];return t.position+t.height!==e.position}animationStateChanged(e){if(!ei(this.stickyNodes,e.stickyNodes,Q$)||this.count===0)return!1;const t=this.stickyNodes[this.count-1],i=e.stickyNodes[e.count-1];return t.position!==i.position}}class wue{constrainStickyScrollNodes(e,t,i){for(let n=0;n<e.length;n++){const s=e[n];if(s.position+s.height>i||n>=t)return e.slice(0,n)}return e}}let C7=class extends F{constructor(e,t,i,n,s,r={}){super(),this.tree=e,this.model=t,this.view=i,this.treeDelegate=s,this.maxWidgetViewRatio=.4;const a=this.validateStickySettings(r);this.stickyScrollMaxItemCount=a.stickyScrollMaxItemCount,this.stickyScrollDelegate=r.stickyScrollDelegate??new wue,this._widget=this._register(new Sue(i.getScrollableElement(),i,e,n,s,r.accessibilityProvider)),this.onDidChangeHasFocus=this._widget.onDidChangeHasFocus,this.onContextMenu=this._widget.onContextMenu,this._register(i.onDidScroll(()=>this.update())),this._register(i.onDidChangeContentHeight(()=>this.update())),this._register(e.onDidChangeCollapseState(()=>this.update())),this.update()}get height(){return this._widget.height}getNodeAtHeight(e){let t;if(e===0?t=this.view.firstVisibleIndex:t=this.view.indexAt(e+this.view.scrollTop),!(t<0||t>=this.view.length))return this.view.element(t)}update(){const e=this.getNodeAtHeight(0);if(!e||this.tree.scrollTop===0){this._widget.setState(void 0);return}const t=this.findStickyState(e);this._widget.setState(t)}findStickyState(e){const t=[];let i=e,n=0,s=this.getNextStickyNode(i,void 0,n);for(;s&&(t.push(s),n+=s.height,!(t.length<=this.stickyScrollMaxItemCount&&(i=this.getNextVisibleNode(s),!i)));)s=this.getNextStickyNode(i,s.node,n);const r=this.constrainStickyNodes(t);return r.length?new yue(r):void 0}getNextVisibleNode(e){return this.getNodeAtHeight(e.position+e.height)}getNextStickyNode(e,t,i){const n=this.getAncestorUnderPrevious(e,t);if(n&&!(n===e&&(!this.nodeIsUncollapsedParent(e)||this.nodeTopAlignsWithStickyNodesBottom(e,i))))return this.createStickyScrollNode(n,i)}nodeTopAlignsWithStickyNodesBottom(e,t){const i=this.getNodeIndex(e),n=this.view.getElementTop(i),s=t;return this.view.scrollTop===n-s}createStickyScrollNode(e,t){const i=this.treeDelegate.getHeight(e),{startIndex:n,endIndex:s}=this.getNodeRange(e),r=this.calculateStickyNodePosition(s,t,i);return{node:e,position:r,height:i,startIndex:n,endIndex:s}}getAncestorUnderPrevious(e,t=void 0){let i=e,n=this.getParentNode(i);for(;n;){if(n===t)return i;i=n,n=this.getParentNode(i)}if(t===void 0)return i}calculateStickyNodePosition(e,t,i){let n=this.view.getRelativeTop(e);if(n===null&&this.view.firstVisibleIndex===e&&e+1<this.view.length){const c=this.treeDelegate.getHeight(this.view.element(e)),d=this.view.getRelativeTop(e+1);n=d?d-c/this.view.renderHeight:null}if(n===null)return t;const s=this.view.element(e),r=this.treeDelegate.getHeight(s),l=n*this.view.renderHeight+r;return t+i>l&&t<=l?l-i:t}constrainStickyNodes(e){if(e.length===0)return[];const t=this.view.renderHeight*this.maxWidgetViewRatio,i=e[e.length-1];if(e.length<=this.stickyScrollMaxItemCount&&i.position+i.height<=t)return e;const n=this.stickyScrollDelegate.constrainStickyScrollNodes(e,this.stickyScrollMaxItemCount,t);if(!n.length)return[];const s=n[n.length-1];if(n.length>this.stickyScrollMaxItemCount||s.position+s.height>t)throw new Error("stickyScrollDelegate violates constraints");return n}getParentNode(e){const t=this.model.getNodeLocation(e),i=this.model.getParentNodeLocation(t);return i?this.model.getNode(i):void 0}nodeIsUncollapsedParent(e){const t=this.model.getNodeLocation(e);return this.model.getListRenderCount(t)>1}getNodeIndex(e){const t=this.model.getNodeLocation(e);return this.model.getListIndex(t)}getNodeRange(e){const t=this.model.getNodeLocation(e),i=this.model.getListIndex(t);if(i<0)throw new Error("Node not found in tree");const n=this.model.getListRenderCount(t),s=i+n-1;return{startIndex:i,endIndex:s}}nodePositionTopBelowWidget(e){const t=[];let i=this.getParentNode(e);for(;i;)t.push(i),i=this.getParentNode(i);let n=0;for(let s=0;s<t.length&&s<this.stickyScrollMaxItemCount;s++)n+=this.treeDelegate.getHeight(t[s]);return n}domFocus(){this._widget.domFocus()}focusedLast(){return this._widget.focusedLast()}updateOptions(e={}){if(!e.stickyScrollMaxItemCount)return;const t=this.validateStickySettings(e);this.stickyScrollMaxItemCount!==t.stickyScrollMaxItemCount&&(this.stickyScrollMaxItemCount=t.stickyScrollMaxItemCount,this.update())}validateStickySettings(e){let t=7;return typeof e.stickyScrollMaxItemCount=="number"&&(t=Math.max(e.stickyScrollMaxItemCount,1)),{stickyScrollMaxItemCount:t}}},Sue=class{constructor(e,t,i,n,s,r){this.view=t,this.tree=i,this.treeRenderers=n,this.treeDelegate=s,this.accessibilityProvider=r,this._previousElements=[],this._previousStateDisposables=new $,this._rootDomNode=ie(".monaco-tree-sticky-container.empty"),e.appendChild(this._rootDomNode);const a=ie(".monaco-tree-sticky-container-shadow");this._rootDomNode.appendChild(a),this.stickyScrollFocus=new xue(this._rootDomNode,t),this.onDidChangeHasFocus=this.stickyScrollFocus.onDidChangeHasFocus,this.onContextMenu=this.stickyScrollFocus.onContextMenu}get height(){if(!this._previousState)return 0;const e=this._previousState.stickyNodes[this._previousState.count-1];return e.position+e.height}setState(e){const t=!!this._previousState&&this._previousState.count>0,i=!!e&&e.count>0;if(!t&&!i||t&&i&&this._previousState.equal(e))return;if(t!==i&&this.setVisible(i),!i){this._previousState=void 0,this._previousElements=[],this._previousStateDisposables.clear();return}const n=e.stickyNodes[e.count-1];if(this._previousState&&e.animationStateChanged(this._previousState))this._previousElements[this._previousState.count-1].style.top=`${n.position}px`;else{this._previousStateDisposables.clear();const s=Array(e.count);for(let r=e.count-1;r>=0;r--){const a=e.stickyNodes[r],{element:l,disposable:c}=this.createElement(a,r,e.count);s[r]=l,this._rootDomNode.appendChild(l),this._previousStateDisposables.add(c)}this.stickyScrollFocus.updateElements(s,e),this._previousElements=s}this._previousState=e,this._rootDomNode.style.height=`${n.position+n.height}px`}createElement(e,t,i){const n=e.startIndex,s=document.createElement("div");s.style.top=`${e.position}px`,this.tree.options.setRowHeight!==!1&&(s.style.height=`${e.height}px`),this.tree.options.setRowLineHeight!==!1&&(s.style.lineHeight=`${e.height}px`),s.classList.add("monaco-tree-sticky-row"),s.classList.add("monaco-list-row"),s.setAttribute("data-index",`${n}`),s.setAttribute("data-parity",n%2===0?"even":"odd"),s.setAttribute("id",this.view.getElementID(n));const r=this.setAccessibilityAttributes(s,e.node.element,t,i),a=this.treeDelegate.getTemplateId(e.node),l=this.treeRenderers.find(u=>u.templateId===a);if(!l)throw new Error(`No renderer found for template id ${a}`);let c=e.node;c===this.tree.getNode(this.tree.getNodeLocation(e.node))&&(c=new Proxy(e.node,{}));const d=l.renderTemplate(s);l.renderElement(c,e.startIndex,d,e.height);const h=ve(()=>{r.dispose(),l.disposeElement(c,e.startIndex,d,e.height),l.disposeTemplate(d),s.remove()});return{element:s,disposable:h}}setAccessibilityAttributes(e,t,i,n){if(!this.accessibilityProvider)return F.None;this.accessibilityProvider.getSetSize&&e.setAttribute("aria-setsize",String(this.accessibilityProvider.getSetSize(t,i,n))),this.accessibilityProvider.getPosInSet&&e.setAttribute("aria-posinset",String(this.accessibilityProvider.getPosInSet(t,i))),this.accessibilityProvider.getRole&&e.setAttribute("role",this.accessibilityProvider.getRole(t)??"treeitem");const s=this.accessibilityProvider.getAriaLabel(t),r=s&&typeof s!="string"?s:rr(s),a=Re(c=>{const d=c.readObservable(r);d?e.setAttribute("aria-label",d):e.removeAttribute("aria-label")});typeof s=="string"||s&&e.setAttribute("aria-label",s.get());const l=this.accessibilityProvider.getAriaLevel&&this.accessibilityProvider.getAriaLevel(t);return typeof l=="number"&&e.setAttribute("aria-level",`${l}`),e.setAttribute("aria-selected",String(!1)),a}setVisible(e){this._rootDomNode.classList.toggle("empty",!e),e||this.stickyScrollFocus.updateElements([],void 0)}domFocus(){this.stickyScrollFocus.domFocus()}focusedLast(){return this.stickyScrollFocus.focusedLast()}dispose(){this.stickyScrollFocus.dispose(),this._previousStateDisposables.dispose(),this._rootDomNode.remove()}};class xue extends F{get domHasFocus(){return this._domHasFocus}set domHasFocus(e){e!==this._domHasFocus&&(this._onDidChangeHasFocus.fire(e),this._domHasFocus=e)}constructor(e,t){super(),this.container=e,this.view=t,this.focusedIndex=-1,this.elements=[],this._onDidChangeHasFocus=new O,this.onDidChangeHasFocus=this._onDidChangeHasFocus.event,this._onContextMenu=new O,this.onContextMenu=this._onContextMenu.event,this._domHasFocus=!1,this._register(H(this.container,"focus",()=>this.onFocus())),this._register(H(this.container,"blur",()=>this.onBlur())),this._register(this.view.onDidFocus(()=>this.toggleStickyScrollFocused(!1))),this._register(this.view.onKeyDown(i=>this.onKeyDown(i))),this._register(this.view.onMouseDown(i=>this.onMouseDown(i))),this._register(this.view.onContextMenu(i=>this.handleContextMenu(i)))}handleContextMenu(e){const t=e.browserEvent.target;if(!by(t)&&!Hv(t)){this.focusedLast()&&this.view.domFocus();return}if(!fc(e.browserEvent)){if(!this.state)throw new Error("Context menu should not be triggered when state is undefined");const r=this.state.stickyNodes.findIndex(a=>a.node.element===e.element?.element);if(r===-1)throw new Error("Context menu should not be triggered when element is not in sticky scroll widget");this.container.focus(),this.setFocus(r);return}if(!this.state||this.focusedIndex<0)throw new Error("Context menu key should not be triggered when focus is not in sticky scroll widget");const n=this.state.stickyNodes[this.focusedIndex].node.element,s=this.elements[this.focusedIndex];this._onContextMenu.fire({element:n,anchor:s,browserEvent:e.browserEvent,isStickyScroll:!0})}onKeyDown(e){if(this.domHasFocus&&this.state){if(e.key==="ArrowUp")this.setFocusedElement(Math.max(0,this.focusedIndex-1)),e.preventDefault(),e.stopPropagation();else if(e.key==="ArrowDown"||e.key==="ArrowRight"){if(this.focusedIndex>=this.state.count-1){const t=this.state.stickyNodes[this.state.count-1].startIndex+1;this.view.domFocus(),this.view.setFocus([t]),this.scrollNodeUnderWidget(t,this.state)}else this.setFocusedElement(this.focusedIndex+1);e.preventDefault(),e.stopPropagation()}}}onMouseDown(e){const t=e.browserEvent.target;!by(t)&&!Hv(t)||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation())}updateElements(e,t){if(t&&t.count===0)throw new Error("Sticky scroll state must be undefined when there are no sticky nodes");if(t&&t.count!==e.length)throw new Error("Sticky scroll focus received illigel state");const i=this.focusedIndex;if(this.removeFocus(),this.elements=e,this.state=t,t){const n=ts(i,0,t.count-1);this.setFocus(n)}else this.domHasFocus&&this.view.domFocus();this.container.tabIndex=t?0:-1}setFocusedElement(e){const t=this.state;if(!t)throw new Error("Cannot set focus when state is undefined");if(this.setFocus(e),!(e<t.count-1)&&t.lastNodePartiallyVisible()){const i=t.stickyNodes[e];this.scrollNodeUnderWidget(i.endIndex+1,t)}}scrollNodeUnderWidget(e,t){const i=t.stickyNodes[t.count-1],n=t.count>1?t.stickyNodes[t.count-2]:void 0,s=this.view.getElementTop(e),r=n?n.position+n.height+i.height:i.height;this.view.scrollTop=s-r}domFocus(){if(!this.state)throw new Error("Cannot focus when state is undefined");this.container.focus()}focusedLast(){return this.state?this.view.getHTMLElement().classList.contains("sticky-scroll-focused"):!1}removeFocus(){this.focusedIndex!==-1&&(this.toggleElementFocus(this.elements[this.focusedIndex],!1),this.focusedIndex=-1)}setFocus(e){if(0>e)throw new Error("addFocus() can not remove focus");if(!this.state&&e>=0)throw new Error("Cannot set focus index when state is undefined");if(this.state&&e>=this.state.count)throw new Error("Cannot set focus index to an index that does not exist");const t=this.focusedIndex;t>=0&&this.toggleElementFocus(this.elements[t],!1),e>=0&&this.toggleElementFocus(this.elements[e],!0),this.focusedIndex=e}toggleElementFocus(e,t){this.toggleElementActiveFocus(e,t&&this.domHasFocus),this.toggleElementPassiveFocus(e,t)}toggleCurrentElementActiveFocus(e){this.focusedIndex!==-1&&this.toggleElementActiveFocus(this.elements[this.focusedIndex],e)}toggleElementActiveFocus(e,t){e.classList.toggle("focused",t)}toggleElementPassiveFocus(e,t){e.classList.toggle("passive-focused",t)}toggleStickyScrollFocused(e){this.view.getHTMLElement().classList.toggle("sticky-scroll-focused",e)}onFocus(){if(!this.state||this.elements.length===0)throw new Error("Cannot focus when state is undefined or elements are empty");this.domHasFocus=!0,this.toggleStickyScrollFocused(!0),this.toggleCurrentElementActiveFocus(!0),this.focusedIndex===-1&&this.setFocus(0)}onBlur(){this.domHasFocus=!1,this.toggleCurrentElementActiveFocus(!1)}dispose(){this.toggleStickyScrollFocused(!1),this._onDidChangeHasFocus.fire(!1),super.dispose()}}function GS(o){let e=tg.Unknown;return eI(o.browserEvent.target,"monaco-tl-twistie","monaco-tl-row")?e=tg.Twistie:eI(o.browserEvent.target,"monaco-tl-contents","monaco-tl-row")?e=tg.Element:eI(o.browserEvent.target,"monaco-tree-type-filter","monaco-list")&&(e=tg.Filter),{browserEvent:o.browserEvent,element:o.element?o.element.element:null,target:e}}function Lue(o){const e=by(o.browserEvent.target);return{element:o.element?o.element.element:null,browserEvent:o.browserEvent,anchor:o.anchor,isStickyScroll:e}}function $1(o,e){e(o),o.children.forEach(t=>$1(t,e))}class jI{get nodeSet(){return this._nodeSet||(this._nodeSet=this.createNodeSet()),this._nodeSet}constructor(e,t){this.getFirstViewElementWithTrait=e,this.identityProvider=t,this.nodes=[],this._onDidChange=new O,this.onDidChange=this._onDidChange.event}set(e,t){!t?.__forceEvent&&ei(this.nodes,e)||this._set(e,!1,t)}_set(e,t,i){if(this.nodes=[...e],this.elements=void 0,this._nodeSet=void 0,!t){const n=this;this._onDidChange.fire({get elements(){return n.get()},browserEvent:i})}}get(){return this.elements||(this.elements=this.nodes.map(e=>e.element)),[...this.elements]}getNodes(){return this.nodes}has(e){return this.nodeSet.has(e)}onDidModelSplice({insertedNodes:e,deletedNodes:t}){if(!this.identityProvider){const l=this.createNodeSet(),c=d=>l.delete(d);t.forEach(d=>$1(d,c)),this.set([...l.values()]);return}const i=new Set,n=l=>i.add(this.identityProvider.getId(l.element).toString());t.forEach(l=>$1(l,n));const s=new Map,r=l=>s.set(this.identityProvider.getId(l.element).toString(),l);e.forEach(l=>$1(l,r));const a=[];for(const l of this.nodes){const c=this.identityProvider.getId(l.element).toString();if(!i.has(c))a.push(l);else{const h=s.get(c);h&&h.visible&&a.push(h)}}if(this.nodes.length>0&&a.length===0){const l=this.getFirstViewElementWithTrait();l&&a.push(l)}this._set(a,!0)}createNodeSet(){const e=new Set;for(const t of this.nodes)e.add(t);return e}}class kue extends i${constructor(e,t,i){super(e),this.tree=t,this.stickyScrollProvider=i}onViewPointer(e){if(QG(e.browserEvent.target)||oh(e.browserEvent.target)||mv(e.browserEvent.target)||e.browserEvent.isHandledByList)return;const t=e.element;if(!t)return super.onViewPointer(e);if(this.isSelectionRangeChangeEvent(e)||this.isSelectionSingleChangeEvent(e))return super.onViewPointer(e);const i=e.browserEvent.target,n=i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&e.browserEvent.offsetX<16,s=Hv(e.browserEvent.target);let r=!1;if(s?r=!0:typeof this.tree.expandOnlyOnTwistieClick=="function"?r=this.tree.expandOnlyOnTwistieClick(t.element):r=!!this.tree.expandOnlyOnTwistieClick,s)this.handleStickyScrollMouseEvent(e,t);else{if(r&&!n&&e.browserEvent.detail!==2)return super.onViewPointer(e);if(!this.tree.expandOnDoubleClick&&e.browserEvent.detail===2)return super.onViewPointer(e)}if(t.collapsible&&(!s||n)){const a=this.tree.getNodeLocation(t),l=e.browserEvent.altKey;if(this.tree.setFocus([a]),this.tree.toggleCollapsed(a,l),n){e.browserEvent.isHandledByList=!0;return}}s||super.onViewPointer(e)}handleStickyScrollMouseEvent(e,t){if(Nle(e.browserEvent.target)||Rle(e.browserEvent.target))return;const i=this.stickyScrollProvider();if(!i)throw new Error("Sticky scroll controller not found");const n=this.list.indexOf(t),s=this.list.getElementTop(n),r=i.nodePositionTopBelowWidget(t);this.tree.scrollTop=s-r,this.list.domFocus(),this.list.setFocus([n]),this.list.setSelection([n])}onDoubleClick(e){e.browserEvent.target.classList.contains("monaco-tl-twistie")||!this.tree.expandOnDoubleClick||e.browserEvent.isHandledByList||super.onDoubleClick(e)}onMouseDown(e){const t=e.browserEvent.target;if(!by(t)&&!Hv(t)){super.onMouseDown(e);return}}onContextMenu(e){const t=e.browserEvent.target;if(!by(t)&&!Hv(t)){super.onContextMenu(e);return}}}class Eue extends $o{constructor(e,t,i,n,s,r,a,l){super(e,t,i,n,l),this.focusTrait=s,this.selectionTrait=r,this.anchorTrait=a}createMouseController(e){return new kue(this,e.tree,e.stickyScrollProvider)}splice(e,t,i=[]){if(super.splice(e,t,i),i.length===0)return;const n=[],s=[];let r;i.forEach((a,l)=>{this.focusTrait.has(a)&&n.push(e+l),this.selectionTrait.has(a)&&s.push(e+l),this.anchorTrait.has(a)&&(r=e+l)}),n.length>0&&super.setFocus(Uc([...super.getFocus(),...n])),s.length>0&&super.setSelection(Uc([...super.getSelection(),...s])),typeof r=="number"&&super.setAnchor(r)}setFocus(e,t,i=!1){super.setFocus(e,t),i||this.focusTrait.set(e.map(n=>this.element(n)),t)}setSelection(e,t,i=!1){super.setSelection(e,t),i||this.selectionTrait.set(e.map(n=>this.element(n)),t)}setAnchor(e,t=!1){super.setAnchor(e),t||(typeof e>"u"?this.anchorTrait.set([]):this.anchorTrait.set([this.element(e)]))}}class J${get onDidScroll(){return this.view.onDidScroll}get onDidChangeFocus(){return this.eventBufferer.wrapEvent(this.focus.onDidChange)}get onDidChangeSelection(){return this.eventBufferer.wrapEvent(this.selection.onDidChange)}get onMouseDblClick(){return se.filter(se.map(this.view.onMouseDblClick,GS),e=>e.target!==tg.Filter)}get onMouseOver(){return se.map(this.view.onMouseOver,GS)}get onMouseOut(){return se.map(this.view.onMouseOut,GS)}get onContextMenu(){return se.any(se.filter(se.map(this.view.onContextMenu,Lue),e=>!e.isStickyScroll),this.stickyScrollController?.onContextMenu??se.None)}get onPointer(){return se.map(this.view.onPointer,GS)}get onKeyDown(){return this.view.onKeyDown}get onDidFocus(){return this.view.onDidFocus}get onDidChangeModel(){return se.signal(this.model.onDidSplice)}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get findMode(){return this.findController?.mode??Dc.Highlight}set findMode(e){this.findController&&(this.findController.mode=e)}get findMatchType(){return this.findController?.matchType??Tf.Fuzzy}set findMatchType(e){this.findController&&(this.findController.matchType=e)}get expandOnDoubleClick(){return typeof this._options.expandOnDoubleClick>"u"?!0:this._options.expandOnDoubleClick}get expandOnlyOnTwistieClick(){return typeof this._options.expandOnlyOnTwistieClick>"u"?!0:this._options.expandOnlyOnTwistieClick}get onDidDispose(){return this.view.onDidDispose}constructor(e,t,i,n,s={}){this._user=e,this._options=s,this.eventBufferer=new Cw,this.onDidChangeFindOpenState=se.None,this.onDidChangeStickyScrollFocused=se.None,this.disposables=new $,this._onWillRefilter=new O,this.onWillRefilter=this._onWillRefilter.event,this._onDidUpdateOptions=new O,this.treeDelegate=new iB(i);const r=new S3,a=new S3,l=this.disposables.add(new _ue(a.event)),c=new Y4;this.renderers=n.map(f=>new nM(f,()=>this.model,r.event,l,c,s));for(const f of this.renderers)this.disposables.add(f);let d;s.keyboardNavigationLabelProvider&&(d=new bue(this,s.keyboardNavigationLabelProvider,s.filter),s={...s,filter:d},this.disposables.add(d)),this.focus=new jI(()=>this.view.getFocusedElements()[0],s.identityProvider),this.selection=new jI(()=>this.view.getSelectedElements()[0],s.identityProvider),this.anchor=new jI(()=>this.view.getAnchorElement(),s.identityProvider),this.view=new Eue(e,t,this.treeDelegate,this.renderers,this.focus,this.selection,this.anchor,{...mue(()=>this.model,s),tree:this,stickyScrollProvider:()=>this.stickyScrollController}),this.model=this.createModel(e,this.view,s),r.input=this.model.onDidChangeCollapseState;const h=se.forEach(this.model.onDidSplice,f=>{this.eventBufferer.bufferEvents(()=>{this.focus.onDidModelSplice(f),this.selection.onDidModelSplice(f)})},this.disposables);h(()=>null,null,this.disposables);const u=this.disposables.add(new O),g=this.disposables.add(new hr(0));if(this.disposables.add(se.any(h,this.focus.onDidChange,this.selection.onDidChange)(()=>{g.trigger(()=>{const f=new Set;for(const m of this.focus.getNodes())f.add(m);for(const m of this.selection.getNodes())f.add(m);u.fire([...f.values()])})})),a.input=u.event,s.keyboardSupport!==!1){const f=se.chain(this.view.onKeyDown,m=>m.filter(_=>!oh(_.target)).map(_=>new Pt(_)));se.chain(f,m=>m.filter(_=>_.keyCode===15))(this.onLeftArrow,this,this.disposables),se.chain(f,m=>m.filter(_=>_.keyCode===17))(this.onRightArrow,this,this.disposables),se.chain(f,m=>m.filter(_=>_.keyCode===10))(this.onSpace,this,this.disposables)}if((s.findWidgetEnabled??!0)&&s.keyboardNavigationLabelProvider&&s.contextViewProvider){const f=this.options.findWidgetStyles?{styles:this.options.findWidgetStyles}:void 0;this.findController=new vue(this,this.model,this.view,d,s.contextViewProvider,f),this.focusNavigationFilter=m=>this.findController.shouldAllowFocus(m),this.onDidChangeFindOpenState=this.findController.onDidChangeOpenState,this.disposables.add(this.findController),this.onDidChangeFindMode=this.findController.onDidChangeMode,this.onDidChangeFindMatchType=this.findController.onDidChangeMatchType}else this.onDidChangeFindMode=se.None,this.onDidChangeFindMatchType=se.None;s.enableStickyScroll&&(this.stickyScrollController=new C7(this,this.model,this.view,this.renderers,this.treeDelegate,s),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus),this.styleElement=Bo(this.view.getHTMLElement()),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===R_.Always)}updateOptions(e={}){this._options={...this._options,...e};for(const t of this.renderers)t.updateOptions(e);this.view.updateOptions(this._options),this.findController?.updateOptions(e),this.updateStickyScroll(e),this._onDidUpdateOptions.fire(this._options),this.getHTMLElement().classList.toggle("always",this._options.renderIndentGuides===R_.Always)}get options(){return this._options}updateStickyScroll(e){!this.stickyScrollController&&this._options.enableStickyScroll?(this.stickyScrollController=new C7(this,this.model,this.view,this.renderers,this.treeDelegate,this._options),this.onDidChangeStickyScrollFocused=this.stickyScrollController.onDidChangeHasFocus):this.stickyScrollController&&!this._options.enableStickyScroll&&(this.onDidChangeStickyScrollFocused=se.None,this.stickyScrollController.dispose(),this.stickyScrollController=void 0),this.stickyScrollController?.updateOptions(e)}getHTMLElement(){return this.view.getHTMLElement()}get scrollTop(){return this.view.scrollTop}set scrollTop(e){this.view.scrollTop=e}get scrollHeight(){return this.view.scrollHeight}get renderHeight(){return this.view.renderHeight}get ariaLabel(){return this.view.ariaLabel}set ariaLabel(e){this.view.ariaLabel=e}domFocus(){this.stickyScrollController?.focusedLast()?this.stickyScrollController.domFocus():this.view.domFocus()}layout(e,t){this.view.layout(e,t),Lh(t)&&this.findController?.layout(t)}style(e){const t=`.${this.view.domId}`,i=[];e.treeIndentGuidesStroke&&(i.push(`.monaco-list${t}:hover .monaco-tl-indent > .indent-guide, .monaco-list${t}.always .monaco-tl-indent > .indent-guide  { border-color: ${e.treeInactiveIndentGuidesStroke}; }`),i.push(`.monaco-list${t} .monaco-tl-indent > .indent-guide.active { border-color: ${e.treeIndentGuidesStroke}; }`));const n=e.treeStickyScrollBackground??e.listBackground;n&&(i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { background-color: ${n}; }`),i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-row { background-color: ${n}; }`)),e.treeStickyScrollBorder&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container { border-bottom: 1px solid ${e.treeStickyScrollBorder}; }`),e.treeStickyScrollShadow&&i.push(`.monaco-list${t} .monaco-scrollable-element .monaco-tree-sticky-container .monaco-tree-sticky-container-shadow { box-shadow: ${e.treeStickyScrollShadow} 0 6px 6px -6px inset; height: 3px; }`),e.listFocusForeground&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { color: ${e.listFocusForeground}; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { color: inherit; }`));const s=Bc(e.listFocusAndSelectionOutline,Bc(e.listSelectionOutline,e.listFocusOutline??""));s&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused.selected { outline: 1px solid ${s}; outline-offset: -1px;}`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused.selected { outline: inherit;}`)),e.listFocusOutline&&(i.push(`.monaco-list${t}.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container:focus .monaco-list-row.focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-list${t}:not(.sticky-scroll-focused) .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-scrollable-element .monaco-tree-sticky-container .monaco-list-row.passive-focused { outline: 1px solid ${e.listFocusOutline}; outline-offset: -1px; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused.sticky-scroll-focused .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`),i.push(`.monaco-workbench.context-menu-visible .monaco-list${t}.last-focused:not(.sticky-scroll-focused) .monaco-tree-sticky-container .monaco-list-rows .monaco-list-row.focused { outline: inherit; }`)),this.styleElement.textContent=i.join(`
`),this.view.style(e)}getParentElement(e){const t=this.model.getParentNodeLocation(e);return this.model.getNode(t).element}getFirstElementChild(e){return this.model.getFirstElementChild(e)}getNode(e){return this.model.getNode(e)}getNodeLocation(e){return this.model.getNodeLocation(e)}collapse(e,t=!1){return this.model.setCollapsed(e,!0,t)}expand(e,t=!1){return this.model.setCollapsed(e,!1,t)}toggleCollapsed(e,t=!1){return this.model.setCollapsed(e,void 0,t)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}refilter(){this._onWillRefilter.fire(void 0),this.model.refilter()}setSelection(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(s=>this.model.getNode(s));this.selection.set(i,t);const n=e.map(s=>this.model.getListIndex(s)).filter(s=>s>-1);this.view.setSelection(n,t,!0)})}getSelection(){return this.selection.get()}setFocus(e,t){this.eventBufferer.bufferEvents(()=>{const i=e.map(s=>this.model.getNode(s));this.focus.set(i,t);const n=e.map(s=>this.model.getListIndex(s)).filter(s=>s>-1);this.view.setFocus(n,t,!0)})}focusNext(e=1,t=!1,i,n=fc(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusNext(e,t,i,n)}focusPrevious(e=1,t=!1,i,n=fc(i)&&i.altKey?void 0:this.focusNavigationFilter){this.view.focusPrevious(e,t,i,n)}focusNextPage(e,t=fc(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusNextPage(e,t)}focusPreviousPage(e,t=fc(e)&&e.altKey?void 0:this.focusNavigationFilter){return this.view.focusPreviousPage(e,t,()=>this.stickyScrollController?.height??0)}focusLast(e,t=fc(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusLast(e,t)}focusFirst(e,t=fc(e)&&e.altKey?void 0:this.focusNavigationFilter){this.view.focusFirst(e,t)}getFocus(){return this.focus.get()}reveal(e,t){this.model.expandTo(e);const i=this.model.getListIndex(e);if(i!==-1)if(!this.stickyScrollController)this.view.reveal(i,t);else{const n=this.stickyScrollController.nodePositionTopBelowWidget(this.getNode(e));this.view.reveal(i,t,n)}}onLeftArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!0)){const r=this.model.getParentNodeLocation(n);if(!r)return;const a=this.model.getListIndex(r);this.view.reveal(a),this.view.setFocus([a])}}onRightArrow(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i);if(!this.model.setCollapsed(n,!1)){if(!i.children.some(l=>l.visible))return;const[r]=this.view.getFocus(),a=r+1;this.view.reveal(a),this.view.setFocus([a])}}onSpace(e){e.preventDefault(),e.stopPropagation();const t=this.view.getFocusedElements();if(t.length===0)return;const i=t[0],n=this.model.getNodeLocation(i),s=e.browserEvent.altKey;this.model.setCollapsed(n,void 0,s)}dispose(){Dt(this.disposables),this.stickyScrollController?.dispose(),this.view.dispose()}}class nB{constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.nodesByIdentity=new Map,this.model=new gue(e,t,null,i),this.onDidSplice=this.model.onDidSplice,this.onDidChangeCollapseState=this.model.onDidChangeCollapseState,this.onDidChangeRenderNodeCount=this.model.onDidChangeRenderNodeCount,i.sorter&&(this.sorter={compare(n,s){return i.sorter.compare(n.element,s.element)}}),this.identityProvider=i.identityProvider}setChildren(e,t=nt.empty(),i={}){const n=this.getElementLocation(e);this._setChildren(n,this.preserveCollapseState(t),i)}_setChildren(e,t=nt.empty(),i){const n=new Set,s=new Set,r=l=>{if(l.element===null)return;const c=l;if(n.add(c.element),this.nodes.set(c.element,c),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();s.add(d),this.nodesByIdentity.set(d,c)}i.onDidCreateNode?.(c)},a=l=>{if(l.element===null)return;const c=l;if(n.has(c.element)||this.nodes.delete(c.element),this.identityProvider){const d=this.identityProvider.getId(c.element).toString();s.has(d)||this.nodesByIdentity.delete(d)}i.onDidDeleteNode?.(c)};this.model.splice([...e,0],Number.MAX_VALUE,t,{...i,onDidCreateNode:r,onDidDeleteNode:a})}preserveCollapseState(e=nt.empty()){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),nt.map(e,t=>{let i=this.nodes.get(t.element);if(!i&&this.identityProvider){const r=this.identityProvider.getId(t.element).toString();i=this.nodesByIdentity.get(r)}if(!i){let r;return typeof t.collapsed>"u"?r=void 0:t.collapsed===yo.Collapsed||t.collapsed===yo.PreserveOrCollapsed?r=!0:t.collapsed===yo.Expanded||t.collapsed===yo.PreserveOrExpanded?r=!1:r=!!t.collapsed,{...t,children:this.preserveCollapseState(t.children),collapsed:r}}const n=typeof t.collapsible=="boolean"?t.collapsible:i.collapsible;let s;return typeof t.collapsed>"u"||t.collapsed===yo.PreserveOrCollapsed||t.collapsed===yo.PreserveOrExpanded?s=i.collapsed:t.collapsed===yo.Collapsed?s=!0:t.collapsed===yo.Expanded?s=!1:s=!!t.collapsed,{...t,collapsible:n,collapsed:s,children:this.preserveCollapseState(t.children)}})}rerender(e){const t=this.getElementLocation(e);this.model.rerender(t)}getFirstElementChild(e=null){const t=this.getElementLocation(e);return this.model.getFirstElementChild(t)}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getElementLocation(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getElementLocation(e);return this.model.getListRenderCount(t)}isCollapsible(e){const t=this.getElementLocation(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getElementLocation(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getElementLocation(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getElementLocation(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getElementLocation(e);this.model.expandTo(t)}refilter(){this.model.refilter()}getNode(e=null){if(e===null)return this.model.getNode(this.model.rootRef);const t=this.nodes.get(e);if(!t)throw new To(this.user,`Tree element not found: ${e}`);return t}getNodeLocation(e){return e.element}getParentNodeLocation(e){if(e===null)throw new To(this.user,"Invalid getParentNodeLocation call");const t=this.nodes.get(e);if(!t)throw new To(this.user,`Tree element not found: ${e}`);const i=this.model.getNodeLocation(t),n=this.model.getParentNodeLocation(i);return this.model.getNode(n).element}getElementLocation(e){if(e===null)return[];const t=this.nodes.get(e);if(!t)throw new To(this.user,`Tree element not found: ${e}`);return this.model.getNodeLocation(t)}}function K1(o){const e=[o.element],t=o.incompressible||!1;return{element:{elements:e,incompressible:t},children:nt.map(nt.from(o.children),K1),collapsible:o.collapsible,collapsed:o.collapsed}}function j1(o){const e=[o.element],t=o.incompressible||!1;let i,n;for(;[n,i]=nt.consume(nt.from(o.children),2),!(n.length!==1||n[0].incompressible);)o=n[0],e.push(o.element);return{element:{elements:e,incompressible:t},children:nt.map(nt.concat(n,i),j1),collapsible:o.collapsible,collapsed:o.collapsed}}function sM(o,e=0){let t;return e<o.element.elements.length-1?t=[sM(o,e+1)]:t=nt.map(nt.from(o.children),i=>sM(i,0)),e===0&&o.element.incompressible?{element:o.element.elements[e],children:t,incompressible:!0,collapsible:o.collapsible,collapsed:o.collapsed}:{element:o.element.elements[e],children:t,collapsible:o.collapsible,collapsed:o.collapsed}}function y7(o){return sM(o,0)}function eK(o,e,t){return o.element===e?{...o,children:t}:{...o,children:nt.map(nt.from(o.children),i=>eK(i,e,t))}}const Tue=o=>({getId(e){return e.elements.map(t=>o.getId(t).toString()).join("\0")}});class Due{get onDidSplice(){return this.model.onDidSplice}get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}get onDidChangeRenderNodeCount(){return this.model.onDidChangeRenderNodeCount}constructor(e,t,i={}){this.user=e,this.rootRef=null,this.nodes=new Map,this.model=new nB(e,t,i),this.enabled=typeof i.compressionEnabled>"u"?!0:i.compressionEnabled,this.identityProvider=i.identityProvider}setChildren(e,t=nt.empty(),i){const n=i.diffIdentityProvider&&Tue(i.diffIdentityProvider);if(e===null){const f=nt.map(t,this.enabled?j1:K1);this._setChildren(null,f,{diffIdentityProvider:n,diffDepth:1/0});return}const s=this.nodes.get(e);if(!s)throw new To(this.user,"Unknown compressed tree node");const r=this.model.getNode(s),a=this.model.getParentNodeLocation(s),l=this.model.getNode(a),c=y7(r),d=eK(c,e,t),h=(this.enabled?j1:K1)(d),u=i.diffIdentityProvider?(f,m)=>i.diffIdentityProvider.getId(f)===i.diffIdentityProvider.getId(m):void 0;if(ei(h.element.elements,r.element.elements,u)){this._setChildren(s,h.children||nt.empty(),{diffIdentityProvider:n,diffDepth:1});return}const g=l.children.map(f=>f===r?h:f);this._setChildren(l.element,g,{diffIdentityProvider:n,diffDepth:r.depth-l.depth})}isCompressionEnabled(){return this.enabled}setCompressionEnabled(e){if(e===this.enabled)return;this.enabled=e;const i=this.model.getNode().children,n=nt.map(i,y7),s=nt.map(n,e?j1:K1);this._setChildren(null,s,{diffIdentityProvider:this.identityProvider,diffDepth:1/0})}_setChildren(e,t,i){const n=new Set,s=a=>{for(const l of a.element.elements)n.add(l),this.nodes.set(l,a.element)},r=a=>{for(const l of a.element.elements)n.has(l)||this.nodes.delete(l)};this.model.setChildren(e,t,{...i,onDidCreateNode:s,onDidDeleteNode:r})}has(e){return this.nodes.has(e)}getListIndex(e){const t=this.getCompressedNode(e);return this.model.getListIndex(t)}getListRenderCount(e){const t=this.getCompressedNode(e);return this.model.getListRenderCount(t)}getNode(e){if(typeof e>"u")return this.model.getNode();const t=this.getCompressedNode(e);return this.model.getNode(t)}getNodeLocation(e){const t=this.model.getNodeLocation(e);return t===null?null:t.elements[t.elements.length-1]}getParentNodeLocation(e){const t=this.getCompressedNode(e),i=this.model.getParentNodeLocation(t);return i===null?null:i.elements[i.elements.length-1]}getFirstElementChild(e){const t=this.getCompressedNode(e);return this.model.getFirstElementChild(t)}isCollapsible(e){const t=this.getCompressedNode(e);return this.model.isCollapsible(t)}setCollapsible(e,t){const i=this.getCompressedNode(e);return this.model.setCollapsible(i,t)}isCollapsed(e){const t=this.getCompressedNode(e);return this.model.isCollapsed(t)}setCollapsed(e,t,i){const n=this.getCompressedNode(e);return this.model.setCollapsed(n,t,i)}expandTo(e){const t=this.getCompressedNode(e);this.model.expandTo(t)}rerender(e){const t=this.getCompressedNode(e);this.model.rerender(t)}refilter(){this.model.refilter()}getCompressedNode(e){if(e===null)return null;const t=this.nodes.get(e);if(!t)throw new To(this.user,`Tree element not found: ${e}`);return t}}const Iue=o=>o[o.length-1];class sB{get element(){return this.node.element===null?null:this.unwrapper(this.node.element)}get children(){return this.node.children.map(e=>new sB(this.unwrapper,e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e,t){this.unwrapper=e,this.node=t}}function Nue(o,e){return{splice(t,i,n){e.splice(t,i,n.map(s=>o.map(s)))},updateElementHeight(t,i){e.updateElementHeight(t,i)}}}function Rue(o,e){return{...e,identityProvider:e.identityProvider&&{getId(t){return e.identityProvider.getId(o(t))}},sorter:e.sorter&&{compare(t,i){return e.sorter.compare(t.elements[0],i.elements[0])}},filter:e.filter&&{filter(t,i){return e.filter.filter(o(t),i)}}}}class Pue{get onDidSplice(){return se.map(this.model.onDidSplice,({insertedNodes:e,deletedNodes:t})=>({insertedNodes:e.map(i=>this.nodeMapper.map(i)),deletedNodes:t.map(i=>this.nodeMapper.map(i))}))}get onDidChangeCollapseState(){return se.map(this.model.onDidChangeCollapseState,({node:e,deep:t})=>({node:this.nodeMapper.map(e),deep:t}))}get onDidChangeRenderNodeCount(){return se.map(this.model.onDidChangeRenderNodeCount,e=>this.nodeMapper.map(e))}constructor(e,t,i={}){this.rootRef=null,this.elementMapper=i.elementMapper||Iue;const n=s=>this.elementMapper(s.elements);this.nodeMapper=new eB(s=>new sB(n,s)),this.model=new Due(e,Nue(this.nodeMapper,t),Rue(n,i))}setChildren(e,t=nt.empty(),i={}){this.model.setChildren(e,t,i)}isCompressionEnabled(){return this.model.isCompressionEnabled()}setCompressionEnabled(e){this.model.setCompressionEnabled(e)}has(e){return this.model.has(e)}getListIndex(e){return this.model.getListIndex(e)}getListRenderCount(e){return this.model.getListRenderCount(e)}getNode(e){return this.nodeMapper.map(this.model.getNode(e))}getNodeLocation(e){return e.element}getParentNodeLocation(e){return this.model.getParentNodeLocation(e)}getFirstElementChild(e){const t=this.model.getFirstElementChild(e);return t===null||typeof t>"u"?t:this.elementMapper(t.elements)}isCollapsible(e){return this.model.isCollapsible(e)}setCollapsible(e,t){return this.model.setCollapsible(e,t)}isCollapsed(e){return this.model.isCollapsed(e)}setCollapsed(e,t,i){return this.model.setCollapsed(e,t,i)}expandTo(e){return this.model.expandTo(e)}rerender(e){return this.model.rerender(e)}refilter(){return this.model.refilter()}getCompressedTreeNode(e=null){return this.model.getNode(e)}}var Aue=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s};class oB extends J${get onDidChangeCollapseState(){return this.model.onDidChangeCollapseState}constructor(e,t,i,n,s={}){super(e,t,i,n,s),this.user=e}setChildren(e,t=nt.empty(),i){this.model.setChildren(e,t,i)}rerender(e){if(e===void 0){this.view.rerender();return}this.model.rerender(e)}hasElement(e){return this.model.has(e)}createModel(e,t,i){return new nB(e,t,i)}}class tK{get compressedTreeNodeProvider(){return this._compressedTreeNodeProvider()}constructor(e,t,i){this._compressedTreeNodeProvider=e,this.stickyScrollDelegate=t,this.renderer=i,this.templateId=i.templateId,i.onDidChangeTwistieState&&(this.onDidChangeTwistieState=i.onDidChangeTwistieState)}renderTemplate(e){return{compressedTreeNode:void 0,data:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){let s=this.stickyScrollDelegate.getCompressedNode(e);s||(s=this.compressedTreeNodeProvider.getCompressedTreeNode(e.element)),s.element.elements.length===1?(i.compressedTreeNode=void 0,this.renderer.renderElement(e,t,i.data,n)):(i.compressedTreeNode=s,this.renderer.renderCompressedElements(s,t,i.data,n))}disposeElement(e,t,i,n){i.compressedTreeNode?this.renderer.disposeCompressedElements?.(i.compressedTreeNode,t,i.data,n):this.renderer.disposeElement?.(e,t,i.data,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.data)}renderTwistie(e,t){return this.renderer.renderTwistie?this.renderer.renderTwistie(e,t):!1}}Aue([Ti],tK.prototype,"compressedTreeNodeProvider",null);class Mue{constructor(e){this.modelProvider=e,this.compressedStickyNodes=new Map}getCompressedNode(e){return this.compressedStickyNodes.get(e)}constrainStickyScrollNodes(e,t,i){if(this.compressedStickyNodes.clear(),e.length===0)return[];for(let n=0;n<e.length;n++){const s=e[n],r=s.position+s.height;if(n+1<e.length&&r+e[n+1].height>i||n>=t-1&&t<e.length){const l=e.slice(0,n),c=e.slice(n),d=this.compressStickyNodes(c);return[...l,d]}}return e}compressStickyNodes(e){if(e.length===0)throw new Error("Can't compress empty sticky nodes");const t=this.modelProvider();if(!t.isCompressionEnabled())return e[0];const i=[];for(let c=0;c<e.length;c++){const d=e[c],h=t.getCompressedTreeNode(d.node.element);if(h.element){if(c!==0&&h.element.incompressible)break;i.push(...h.element.elements)}}if(i.length<2)return e[0];const n=e[e.length-1],s={elements:i,incompressible:!1},r={...n.node,children:[],element:s},a=new Proxy(e[0].node,{}),l={node:a,startIndex:e[0].startIndex,endIndex:n.endIndex,position:e[0].position,height:e[0].height};return this.compressedStickyNodes.set(a,r),l}}function Oue(o,e){return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{getKeyboardNavigationLabel(t){let i;try{i=o().getCompressedTreeNode(t)}catch{return e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t)}return i.element.elements.length===1?e.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(t):e.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(i.element.elements)}}}}class iK extends oB{constructor(e,t,i,n,s={}){const r=()=>this,a=new Mue(()=>this.model),l=n.map(c=>new tK(r,a,c));super(e,t,i,l,{...Oue(r,s),stickyScrollDelegate:a})}setChildren(e,t=nt.empty(),i){this.model.setChildren(e,t,i)}createModel(e,t,i){return new Pue(e,t,i)}updateOptions(e={}){super.updateOptions(e),typeof e.compressionEnabled<"u"&&this.model.setCompressionEnabled(e.compressionEnabled)}getCompressedTreeNode(e=null){return this.model.getCompressedTreeNode(e)}}function qI(o){return{...o,children:[],refreshPromise:void 0,stale:!0,slow:!1,forceExpanded:!1}}function oM(o,e){return e.parent?e.parent===o?!0:oM(o,e.parent):!1}function Fue(o,e){return o===e||oM(o,e)||oM(e,o)}class rB{get element(){return this.node.element.element}get children(){return this.node.children.map(e=>new rB(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class Bue{constructor(e,t,i){this.renderer=e,this.nodeMapper=t,this.onDidChangeTwistieState=i,this.renderedNodes=new Map,this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...ke.asClassNameArray(J.treeItemLoading)),!0):(t.classList.remove(...ke.asClassNameArray(J.treeItemLoading)),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear()}}function w7(o){return{browserEvent:o.browserEvent,elements:o.elements.map(e=>e.element)}}function S7(o){return{browserEvent:o.browserEvent,element:o.element&&o.element.element,target:o.target}}class Wue extends Ww{constructor(e){super(e.elements.map(t=>t.element)),this.data=e}}function ZI(o){return o instanceof Ww?new Wue(o):o}class Vue{constructor(e){this.dnd=e}getDragURI(e){return this.dnd.getDragURI(e.element)}getDragLabel(e,t){if(this.dnd.getDragLabel)return this.dnd.getDragLabel(e.map(i=>i.element),t)}onDragStart(e,t){this.dnd.onDragStart?.(ZI(e),t)}onDragOver(e,t,i,n,s,r=!0){return this.dnd.onDragOver(ZI(e),t&&t.element,i,n,s)}drop(e,t,i,n,s){this.dnd.drop(ZI(e),t&&t.element,i,n,s)}onDragEnd(e){this.dnd.onDragEnd?.(e)}dispose(){this.dnd.dispose()}}function nK(o){return o&&{...o,collapseByDefault:!0,identityProvider:o.identityProvider&&{getId(e){return o.identityProvider.getId(e.element)}},dnd:o.dnd&&new Vue(o.dnd),multipleSelectionController:o.multipleSelectionController&&{isSelectionSingleChangeEvent(e){return o.multipleSelectionController.isSelectionSingleChangeEvent({...e,element:e.element})},isSelectionRangeChangeEvent(e){return o.multipleSelectionController.isSelectionRangeChangeEvent({...e,element:e.element})}},accessibilityProvider:o.accessibilityProvider&&{...o.accessibilityProvider,getPosInSet:void 0,getSetSize:void 0,getRole:o.accessibilityProvider.getRole?e=>o.accessibilityProvider.getRole(e.element):()=>"treeitem",isChecked:o.accessibilityProvider.isChecked?e=>!!o.accessibilityProvider?.isChecked(e.element):void 0,getAriaLabel(e){return o.accessibilityProvider.getAriaLabel(e.element)},getWidgetAriaLabel(){return o.accessibilityProvider.getWidgetAriaLabel()},getWidgetRole:o.accessibilityProvider.getWidgetRole?()=>o.accessibilityProvider.getWidgetRole():()=>"tree",getAriaLevel:o.accessibilityProvider.getAriaLevel&&(e=>o.accessibilityProvider.getAriaLevel(e.element)),getActiveDescendantId:o.accessibilityProvider.getActiveDescendantId&&(e=>o.accessibilityProvider.getActiveDescendantId(e.element))},filter:o.filter&&{filter(e,t){return o.filter.filter(e.element,t)}},keyboardNavigationLabelProvider:o.keyboardNavigationLabelProvider&&{...o.keyboardNavigationLabelProvider,getKeyboardNavigationLabel(e){return o.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(e.element)}},sorter:void 0,expandOnlyOnTwistieClick:typeof o.expandOnlyOnTwistieClick>"u"?void 0:typeof o.expandOnlyOnTwistieClick!="function"?o.expandOnlyOnTwistieClick:e=>o.expandOnlyOnTwistieClick(e.element),defaultFindVisibility:e=>e.hasChildren&&e.stale?1:typeof o.defaultFindVisibility=="number"?o.defaultFindVisibility:typeof o.defaultFindVisibility>"u"?2:o.defaultFindVisibility(e.element)}}function rM(o,e){e(o),o.children.forEach(t=>rM(t,e))}class sK{get onDidScroll(){return this.tree.onDidScroll}get onDidChangeFocus(){return se.map(this.tree.onDidChangeFocus,w7)}get onDidChangeSelection(){return se.map(this.tree.onDidChangeSelection,w7)}get onMouseDblClick(){return se.map(this.tree.onMouseDblClick,S7)}get onPointer(){return se.map(this.tree.onPointer,S7)}get onDidFocus(){return this.tree.onDidFocus}get onDidChangeModel(){return this.tree.onDidChangeModel}get onDidChangeCollapseState(){return this.tree.onDidChangeCollapseState}get onDidChangeFindOpenState(){return this.tree.onDidChangeFindOpenState}get onDidChangeStickyScrollFocused(){return this.tree.onDidChangeStickyScrollFocused}get onDidDispose(){return this.tree.onDidDispose}constructor(e,t,i,n,s,r={}){this.user=e,this.dataSource=s,this.nodes=new Map,this.subTreeRefreshPromises=new Map,this.refreshPromises=new Map,this._onDidRender=new O,this._onDidChangeNodeSlowState=new O,this.nodeMapper=new eB(a=>new rB(a)),this.disposables=new $,this.identityProvider=r.identityProvider,this.autoExpandSingleChildren=typeof r.autoExpandSingleChildren>"u"?!1:r.autoExpandSingleChildren,this.sorter=r.sorter,this.getDefaultCollapseState=a=>r.collapseByDefault?r.collapseByDefault(a)?yo.PreserveOrCollapsed:yo.PreserveOrExpanded:void 0,this.tree=this.createTree(e,t,i,n,r),this.onDidChangeFindMode=this.tree.onDidChangeFindMode,this.onDidChangeFindMatchType=this.tree.onDidChangeFindMatchType,this.root=qI({element:void 0,parent:null,hasChildren:!0,defaultCollapseState:void 0}),this.identityProvider&&(this.root={...this.root,id:null}),this.nodes.set(null,this.root),this.tree.onDidChangeCollapseState(this._onDidChangeCollapseState,this,this.disposables)}createTree(e,t,i,n,s){const r=new iB(i),a=n.map(c=>new Bue(c,this.nodeMapper,this._onDidChangeNodeSlowState.event)),l=nK(s)||{};return new oB(e,t,r,a,l)}updateOptions(e={}){this.tree.updateOptions(e)}getHTMLElement(){return this.tree.getHTMLElement()}get scrollTop(){return this.tree.scrollTop}set scrollTop(e){this.tree.scrollTop=e}get scrollHeight(){return this.tree.scrollHeight}get renderHeight(){return this.tree.renderHeight}domFocus(){this.tree.domFocus()}layout(e,t){this.tree.layout(e,t)}style(e){this.tree.style(e)}getInput(){return this.root.element}async setInput(e,t){this.refreshPromises.forEach(n=>n.cancel()),this.refreshPromises.clear(),this.root.element=e;const i=t&&{viewState:t,focus:[],selection:[]};await this._updateChildren(e,!0,!1,i),i&&(this.tree.setFocus(i.focus),this.tree.setSelection(i.selection)),t&&typeof t.scrollTop=="number"&&(this.scrollTop=t.scrollTop)}async _updateChildren(e=this.root.element,t=!0,i=!1,n,s){if(typeof this.root.element>"u")throw new To(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event));const r=this.getDataNode(e);if(await this.refreshAndRenderNode(r,t,n,s),i)try{this.tree.rerender(r)}catch{}}rerender(e){if(e===void 0||e===this.root.element){this.tree.rerender();return}const t=this.getDataNode(e);this.tree.rerender(t)}getNode(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getNode(t===this.root?null:t);return this.nodeMapper.map(i)}collapse(e,t=!1){const i=this.getDataNode(e);return this.tree.collapse(i===this.root?null:i,t)}async expand(e,t=!1){if(typeof this.root.element>"u")throw new To(this.user,"Tree input not set");this.root.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event));const i=this.getDataNode(e);if(this.tree.hasElement(i)&&!this.tree.isCollapsible(i)||(i.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event)),i!==this.root&&!i.refreshPromise&&!this.tree.isCollapsed(i)))return!1;const n=this.tree.expand(i===this.root?null:i,t);return i.refreshPromise&&(await this.root.refreshPromise,await se.toPromise(this._onDidRender.event)),n}setSelection(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setSelection(i,t)}getSelection(){return this.tree.getSelection().map(t=>t.element)}setFocus(e,t){const i=e.map(n=>this.getDataNode(n));this.tree.setFocus(i,t)}getFocus(){return this.tree.getFocus().map(t=>t.element)}reveal(e,t){this.tree.reveal(this.getDataNode(e),t)}getParentElement(e){const t=this.tree.getParentElement(this.getDataNode(e));return t&&t.element}getFirstElementChild(e=this.root.element){const t=this.getDataNode(e),i=this.tree.getFirstElementChild(t===this.root?null:t);return i&&i.element}getDataNode(e){const t=this.nodes.get(e===this.root.element?null:e);if(!t)throw new To(this.user,`Data tree node not found: ${e}`);return t}async refreshAndRenderNode(e,t,i,n){await this.refreshNode(e,t,i),!this.disposables.isDisposed&&this.render(e,i,n)}async refreshNode(e,t,i){let n;if(this.subTreeRefreshPromises.forEach((s,r)=>{!n&&Fue(r,e)&&(n=s.then(()=>this.refreshNode(e,t,i)))}),n)return n;if(e!==this.root&&this.tree.getNode(e).collapsed){e.hasChildren=!!this.dataSource.hasChildren(e.element),e.stale=!0,this.setChildren(e,[],t,i);return}return this.doRefreshSubTree(e,t,i)}async doRefreshSubTree(e,t,i){let n;e.refreshPromise=new Promise(s=>n=s),this.subTreeRefreshPromises.set(e,e.refreshPromise),e.refreshPromise.finally(()=>{e.refreshPromise=void 0,this.subTreeRefreshPromises.delete(e)});try{const s=await this.doRefreshNode(e,t,i);e.stale=!1,await sP.settled(s.map(r=>this.doRefreshSubTree(r,t,i)))}finally{n()}}async doRefreshNode(e,t,i){e.hasChildren=!!this.dataSource.hasChildren(e.element);let n;if(!e.hasChildren)n=Promise.resolve(nt.empty());else{const s=this.doGetChildren(e);if(_3(s))n=Promise.resolve(s);else{const r=Kc(800);r.then(()=>{e.slow=!0,this._onDidChangeNodeSlowState.fire(e)},a=>null),n=s.finally(()=>r.cancel())}}try{const s=await n;return this.setChildren(e,s,t,i)}catch(s){if(e!==this.root&&this.tree.hasElement(e)&&this.tree.collapse(e),_r(s))return[];throw s}finally{e.slow&&(e.slow=!1,this._onDidChangeNodeSlowState.fire(e))}}doGetChildren(e){let t=this.refreshPromises.get(e);if(t)return t;const i=this.dataSource.getChildren(e.element);return _3(i)?this.processChildren(i):(t=ji(async()=>this.processChildren(await i)),this.refreshPromises.set(e,t),t.finally(()=>{this.refreshPromises.delete(e)}))}_onDidChangeCollapseState({node:e,deep:t}){e.element!==null&&!e.collapsed&&e.element.stale&&(t?this.collapse(e.element.element):this.refreshAndRenderNode(e.element,!1).catch(Ae))}setChildren(e,t,i,n){const s=[...t];if(e.children.length===0&&s.length===0)return[];const r=new Map,a=new Map;for(const d of e.children)r.set(d.element,d),this.identityProvider&&a.set(d.id,{node:d,collapsed:this.tree.hasElement(d)&&this.tree.isCollapsed(d)});const l=[],c=s.map(d=>{const h=!!this.dataSource.hasChildren(d);if(!this.identityProvider){const m=qI({element:d,parent:e,hasChildren:h,defaultCollapseState:this.getDefaultCollapseState(d)});return h&&m.defaultCollapseState===yo.PreserveOrExpanded&&l.push(m),m}const u=this.identityProvider.getId(d).toString(),g=a.get(u);if(g){const m=g.node;return r.delete(m.element),this.nodes.delete(m.element),this.nodes.set(d,m),m.element=d,m.hasChildren=h,i?g.collapsed?(m.children.forEach(_=>rM(_,b=>this.nodes.delete(b.element))),m.children.splice(0,m.children.length),m.stale=!0):l.push(m):h&&!g.collapsed&&l.push(m),m}const f=qI({element:d,parent:e,id:u,hasChildren:h,defaultCollapseState:this.getDefaultCollapseState(d)});return n&&n.viewState.focus&&n.viewState.focus.indexOf(u)>-1&&n.focus.push(f),n&&n.viewState.selection&&n.viewState.selection.indexOf(u)>-1&&n.selection.push(f),(n&&n.viewState.expanded&&n.viewState.expanded.indexOf(u)>-1||h&&f.defaultCollapseState===yo.PreserveOrExpanded)&&l.push(f),f});for(const d of r.values())rM(d,h=>this.nodes.delete(h.element));for(const d of c)this.nodes.set(d.element,d);return e.children.splice(0,e.children.length,...c),e!==this.root&&this.autoExpandSingleChildren&&c.length===1&&l.length===0&&(c[0].forceExpanded=!0,l.push(c[0])),l}render(e,t,i){const n=e.children.map(r=>this.asTreeElement(r,t)),s=i&&{...i,diffIdentityProvider:i.diffIdentityProvider&&{getId(r){return i.diffIdentityProvider.getId(r.element)}}};this.tree.setChildren(e===this.root?null:e,n,s),e!==this.root&&this.tree.setCollapsible(e,e.hasChildren),this._onDidRender.fire()}asTreeElement(e,t){if(e.stale)return{element:e,collapsible:e.hasChildren,collapsed:!0};let i;return t&&t.viewState.expanded&&e.id&&t.viewState.expanded.indexOf(e.id)>-1?i=!1:e.forceExpanded?(i=!1,e.forceExpanded=!1):i=e.defaultCollapseState,{element:e,children:e.hasChildren?nt.map(e.children,n=>this.asTreeElement(n,t)):[],collapsible:e.hasChildren,collapsed:i}}processChildren(e){return this.sorter&&(e=[...e].sort(this.sorter.compare.bind(this.sorter))),e}dispose(){this.disposables.dispose(),this.tree.dispose()}}class aB{get element(){return{elements:this.node.element.elements.map(e=>e.element),incompressible:this.node.element.incompressible}}get children(){return this.node.children.map(e=>new aB(e))}get depth(){return this.node.depth}get visibleChildrenCount(){return this.node.visibleChildrenCount}get visibleChildIndex(){return this.node.visibleChildIndex}get collapsible(){return this.node.collapsible}get collapsed(){return this.node.collapsed}get visible(){return this.node.visible}get filterData(){return this.node.filterData}constructor(e){this.node=e}}class Hue{constructor(e,t,i,n){this.renderer=e,this.nodeMapper=t,this.compressibleNodeMapperProvider=i,this.onDidChangeTwistieState=n,this.renderedNodes=new Map,this.disposables=[],this.templateId=e.templateId}renderTemplate(e){return{templateData:this.renderer.renderTemplate(e)}}renderElement(e,t,i,n){this.renderer.renderElement(this.nodeMapper.map(e),t,i.templateData,n)}renderCompressedElements(e,t,i,n){this.renderer.renderCompressedElements(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}renderTwistie(e,t){return e.slow?(t.classList.add(...ke.asClassNameArray(J.treeItemLoading)),!0):(t.classList.remove(...ke.asClassNameArray(J.treeItemLoading)),!1)}disposeElement(e,t,i,n){this.renderer.disposeElement?.(this.nodeMapper.map(e),t,i.templateData,n)}disposeCompressedElements(e,t,i,n){this.renderer.disposeCompressedElements?.(this.compressibleNodeMapperProvider().map(e),t,i.templateData,n)}disposeTemplate(e){this.renderer.disposeTemplate(e.templateData)}dispose(){this.renderedNodes.clear(),this.disposables=Dt(this.disposables)}}function zue(o){const e=o&&nK(o);return e&&{...e,keyboardNavigationLabelProvider:e.keyboardNavigationLabelProvider&&{...e.keyboardNavigationLabelProvider,getCompressedNodeKeyboardNavigationLabel(t){return o.keyboardNavigationLabelProvider.getCompressedNodeKeyboardNavigationLabel(t.map(i=>i.element))}}}}class Uue extends sK{constructor(e,t,i,n,s,r,a={}){super(e,t,i,s,r,a),this.compressionDelegate=n,this.compressibleNodeMapper=new eB(l=>new aB(l)),this.filter=a.filter}createTree(e,t,i,n,s){const r=new iB(i),a=n.map(c=>new Hue(c,this.nodeMapper,()=>this.compressibleNodeMapper,this._onDidChangeNodeSlowState.event)),l=zue(s)||{};return new iK(e,t,r,a,l)}asTreeElement(e,t){return{incompressible:this.compressionDelegate.isIncompressible(e.element),...super.asTreeElement(e,t)}}updateOptions(e={}){this.tree.updateOptions(e)}render(e,t,i){if(!this.identityProvider)return super.render(e,t);const n=g=>this.identityProvider.getId(g).toString(),s=g=>{const f=new Set;for(const m of g){const _=this.tree.getCompressedTreeNode(m===this.root?null:m);if(_.element)for(const b of _.element.elements)f.add(n(b.element))}return f},r=s(this.tree.getSelection()),a=s(this.tree.getFocus());super.render(e,t,i);const l=this.getSelection();let c=!1;const d=this.getFocus();let h=!1;const u=g=>{const f=g.element;if(f)for(let m=0;m<f.elements.length;m++){const _=n(f.elements[m].element),b=f.elements[f.elements.length-1].element;r.has(_)&&l.indexOf(b)===-1&&(l.push(b),c=!0),a.has(_)&&d.indexOf(b)===-1&&(d.push(b),h=!0)}g.children.forEach(u)};u(this.tree.getCompressedTreeNode(e===this.root?null:e)),c&&this.setSelection(l),h&&this.setFocus(d)}processChildren(e){return this.filter&&(e=nt.filter(e,t=>{const i=this.filter.filter(t,1),n=Gue(i);if(n===2)throw new Error("Recursive tree visibility not supported in async data compressed trees");return n===1})),super.processChildren(e)}}function Gue(o){return typeof o=="boolean"?o?1:0:tB(o)?xy(o.visibility):xy(o)}class $ue extends J${constructor(e,t,i,n,s,r={}){super(e,t,i,n,r),this.user=e,this.dataSource=s,this.identityProvider=r.identityProvider}createModel(e,t,i){return new nB(e,t,i)}}new re("isMac",Qe,p("isMac","Whether the operating system is macOS"));new re("isLinux",us,p("isLinux","Whether the operating system is Linux"));const qT=new re("isWindows",En,p("isWindows","Whether the operating system is Windows")),oK=new re("isWeb",Uf,p("isWeb","Whether the platform is a web browser"));new re("isMacNative",Qe&&!Uf,p("isMacNative","Whether the operating system is macOS on a non-browser platform"));new re("isIOS",Ta,p("isIOS","Whether the operating system is iOS"));new re("isMobile",J6,p("isMobile","Whether the platform is a mobile web browser"));new re("isDevelopment",!1,!0);new re("productQualityType","",p("productQualityType","Quality type of VS Code"));const rK="inputFocus",aK=new re(rK,!1,p("inputFocus","Whether keyboard focus is inside an input box"));var rd=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},zt=function(o,e){return function(t,i){e(t,i,o)}};const Cr=Je("listService");class Kue{get lastFocusedList(){return this._lastFocusedWidget}constructor(){this.disposables=new $,this.lists=[],this._lastFocusedWidget=void 0,this._hasCreatedStyleController=!1}setLastFocusedList(e){e!==this._lastFocusedWidget&&(this._lastFocusedWidget?.getHTMLElement().classList.remove("last-focused"),this._lastFocusedWidget=e,this._lastFocusedWidget?.getHTMLElement().classList.add("last-focused"))}register(e,t){if(this._hasCreatedStyleController||(this._hasCreatedStyleController=!0,new n$(Bo(),"").style(qf)),this.lists.some(n=>n.widget===e))throw new Error("Cannot register the same widget multiple times");const i={widget:e,extraContextKeys:t};return this.lists.push(i),lT(e.getHTMLElement())&&this.setLastFocusedList(e),Wr(e.onDidFocus(()=>this.setLastFocusedList(e)),ve(()=>this.lists.splice(this.lists.indexOf(i),1)),e.onDidDispose(()=>{this.lists=this.lists.filter(n=>n!==i),this._lastFocusedWidget===e&&this.setLastFocusedList(void 0)}))}dispose(){this.disposables.dispose()}}const Ly=new re("listScrollAtBoundary","none");K.or(Ly.isEqualTo("top"),Ly.isEqualTo("both"));K.or(Ly.isEqualTo("bottom"),Ly.isEqualTo("both"));const lK=new re("listFocus",!0),cK=new re("treestickyScrollFocused",!1),ZT=new re("listSupportsMultiselect",!0),dK=K.and(lK,K.not(rK),cK.negate()),lB=new re("listHasSelectionOrFocus",!1),cB=new re("listDoubleSelection",!1),dB=new re("listMultiSelection",!1),YT=new re("listSelectionNavigation",!1),jue=new re("listSupportsFind",!0),hB=new re("treeElementCanCollapse",!1),que=new re("treeElementHasParent",!1),uB=new re("treeElementCanExpand",!1),Zue=new re("treeElementHasChild",!1),Yue=new re("treeFindOpen",!1),hK="listTypeNavigationMode",uK="listAutomaticKeyboardNavigation";function XT(o,e){const t=o.createScoped(e.getHTMLElement());return lK.bindTo(t),t}function QT(o,e){const t=Ly.bindTo(o),i=()=>{const n=e.scrollTop===0,s=e.scrollHeight-e.renderHeight-e.scrollTop<1;n&&s?t.set("both"):n?t.set("top"):s?t.set("bottom"):t.set("none")};return i(),e.onDidScroll(i)}const Xf="workbench.list.multiSelectModifier",q1="workbench.list.openMode",cr="workbench.list.horizontalScrolling",gB="workbench.list.defaultFindMode",fB="workbench.list.typeNavigationMode",Ix="workbench.list.keyboardNavigation",Ra="workbench.list.scrollByPage",pB="workbench.list.defaultFindMatchType",ky="workbench.tree.indent",Nx="workbench.tree.renderIndentGuides",Pa="workbench.list.smoothScrolling",Al="workbench.list.mouseWheelScrollSensitivity",Ml="workbench.list.fastScrollSensitivity",Rx="workbench.tree.expandMode",Px="workbench.tree.enableStickyScroll",Ax="workbench.tree.stickyScrollMaxItemCount";function Ol(o){return o.getValue(Xf)==="alt"}class Xue extends F{constructor(e){super(),this.configurationService=e,this.useAltAsMultipleSelectionModifier=Ol(e),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>{e.affectsConfiguration(Xf)&&(this.useAltAsMultipleSelectionModifier=Ol(this.configurationService))}))}isSelectionSingleChangeEvent(e){return this.useAltAsMultipleSelectionModifier?e.browserEvent.altKey:e$(e)}isSelectionRangeChangeEvent(e){return t$(e)}}function JT(o,e){const t=o.get(Ke),i=o.get(vt),n=new $;return[{...e,keyboardNavigationDelegate:{mightProducePrintableCharacter(r){return i.mightProducePrintableCharacter(r)}},smoothScrolling:!!t.getValue(Pa),mouseWheelScrollSensitivity:t.getValue(Al),fastScrollSensitivity:t.getValue(Ml),multipleSelectionController:e.multipleSelectionController??n.add(new Xue(t)),keyboardNavigationEventFilter:ege(i),scrollByPage:!!t.getValue(Ra)},n]}let x7=class extends $o{constructor(e,t,i,n,s,r,a,l,c){const d=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!l.getValue(cr),[h,u]=c.invokeFunction(JT,s);super(e,t,i,n,{keyboardSupport:!1,...h,horizontalScrolling:d}),this.disposables.add(u),this.contextKeyService=XT(r,this),this.disposables.add(QT(this.contextKeyService,this)),this.listSupportsMultiSelect=ZT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),YT.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this.listHasSelectionOrFocus=lB.bindTo(this.contextKeyService),this.listDoubleSelection=cB.bindTo(this.contextKeyService),this.listMultiSelection=dB.bindTo(this.contextKeyService),this.horizontalScrolling=s.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Ol(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(s.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const f=this.getSelection(),m=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(f.length>0||m.length>0),this.listMultiSelection.set(f.length>1),this.listDoubleSelection.set(f.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const f=this.getSelection(),m=this.getFocus();this.listHasSelectionOrFocus.set(f.length>0||m.length>0)})),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(Xf)&&(this._useAltAsMultipleSelectionModifier=Ol(l));let m={};if(f.affectsConfiguration(cr)&&this.horizontalScrolling===void 0){const _=!!l.getValue(cr);m={...m,horizontalScrolling:_}}if(f.affectsConfiguration(Ra)){const _=!!l.getValue(Ra);m={...m,scrollByPage:_}}if(f.affectsConfiguration(Pa)){const _=!!l.getValue(Pa);m={...m,smoothScrolling:_}}if(f.affectsConfiguration(Al)){const _=l.getValue(Al);m={...m,mouseWheelScrollSensitivity:_}}if(f.affectsConfiguration(Ml)){const _=l.getValue(Ml);m={...m,fastScrollSensitivity:_}}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new gK(this,{configurationService:l,...s}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Zf(e):qf)}};x7=rd([zt(5,Ee),zt(6,Cr),zt(7,Ke),zt(8,Ce)],x7);let L7=class extends iue{constructor(e,t,i,n,s,r,a,l,c){const d=typeof s.horizontalScrolling<"u"?s.horizontalScrolling:!!l.getValue(cr),[h,u]=c.invokeFunction(JT,s);super(e,t,i,n,{keyboardSupport:!1,...h,horizontalScrolling:d}),this.disposables=new $,this.disposables.add(u),this.contextKeyService=XT(r,this),this.disposables.add(QT(this.contextKeyService,this.widget)),this.horizontalScrolling=s.horizontalScrolling,this.listSupportsMultiSelect=ZT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(s.multipleSelectionSupport!==!1),YT.bindTo(this.contextKeyService).set(!!s.selectionNavigation),this._useAltAsMultipleSelectionModifier=Ol(l),this.disposables.add(this.contextKeyService),this.disposables.add(a.register(this)),this.updateStyles(s.overrideStyles),this.disposables.add(l.onDidChangeConfiguration(f=>{f.affectsConfiguration(Xf)&&(this._useAltAsMultipleSelectionModifier=Ol(l));let m={};if(f.affectsConfiguration(cr)&&this.horizontalScrolling===void 0){const _=!!l.getValue(cr);m={...m,horizontalScrolling:_}}if(f.affectsConfiguration(Ra)){const _=!!l.getValue(Ra);m={...m,scrollByPage:_}}if(f.affectsConfiguration(Pa)){const _=!!l.getValue(Pa);m={...m,smoothScrolling:_}}if(f.affectsConfiguration(Al)){const _=l.getValue(Al);m={...m,mouseWheelScrollSensitivity:_}}if(f.affectsConfiguration(Ml)){const _=l.getValue(Ml);m={...m,fastScrollSensitivity:_}}Object.keys(m).length>0&&this.updateOptions(m)})),this.navigator=new gK(this,{configurationService:l,...s}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Zf(e):qf)}dispose(){this.disposables.dispose(),super.dispose()}};L7=rd([zt(5,Ee),zt(6,Cr),zt(7,Ke),zt(8,Ce)],L7);let k7=class extends iM{constructor(e,t,i,n,s,r,a,l,c,d){const h=typeof r.horizontalScrolling<"u"?r.horizontalScrolling:!!c.getValue(cr),[u,g]=d.invokeFunction(JT,r);super(e,t,i,n,s,{keyboardSupport:!1,...u,horizontalScrolling:h}),this.disposables.add(g),this.contextKeyService=XT(a,this),this.disposables.add(QT(this.contextKeyService,this)),this.listSupportsMultiSelect=ZT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(r.multipleSelectionSupport!==!1),YT.bindTo(this.contextKeyService).set(!!r.selectionNavigation),this.listHasSelectionOrFocus=lB.bindTo(this.contextKeyService),this.listDoubleSelection=cB.bindTo(this.contextKeyService),this.listMultiSelection=dB.bindTo(this.contextKeyService),this.horizontalScrolling=r.horizontalScrolling,this._useAltAsMultipleSelectionModifier=Ol(c),this.disposables.add(this.contextKeyService),this.disposables.add(l.register(this)),this.updateStyles(r.overrideStyles),this.disposables.add(this.onDidChangeSelection(()=>{const m=this.getSelection(),_=this.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.listHasSelectionOrFocus.set(m.length>0||_.length>0),this.listMultiSelection.set(m.length>1),this.listDoubleSelection.set(m.length===2)})})),this.disposables.add(this.onDidChangeFocus(()=>{const m=this.getSelection(),_=this.getFocus();this.listHasSelectionOrFocus.set(m.length>0||_.length>0)})),this.disposables.add(c.onDidChangeConfiguration(m=>{m.affectsConfiguration(Xf)&&(this._useAltAsMultipleSelectionModifier=Ol(c));let _={};if(m.affectsConfiguration(cr)&&this.horizontalScrolling===void 0){const b=!!c.getValue(cr);_={..._,horizontalScrolling:b}}if(m.affectsConfiguration(Ra)){const b=!!c.getValue(Ra);_={..._,scrollByPage:b}}if(m.affectsConfiguration(Pa)){const b=!!c.getValue(Pa);_={..._,smoothScrolling:b}}if(m.affectsConfiguration(Al)){const b=c.getValue(Al);_={..._,mouseWheelScrollSensitivity:b}}if(m.affectsConfiguration(Ml)){const b=c.getValue(Ml);_={..._,fastScrollSensitivity:b}}Object.keys(_).length>0&&this.updateOptions(_)})),this.navigator=new Que(this,{configurationService:c,...r}),this.disposables.add(this.navigator)}updateOptions(e){super.updateOptions(e),e.overrideStyles!==void 0&&this.updateStyles(e.overrideStyles),e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyles(e){this.style(e?Zf(e):qf)}dispose(){this.disposables.dispose(),super.dispose()}};k7=rd([zt(6,Ee),zt(7,Cr),zt(8,Ke),zt(9,Ce)],k7);class mB extends F{constructor(e,t){super(),this.widget=e,this._onDidOpen=this._register(new O),this.onDidOpen=this._onDidOpen.event,this._register(se.filter(this.widget.onDidChangeSelection,i=>fc(i.browserEvent))(i=>this.onSelectionFromKeyboard(i))),this._register(this.widget.onPointer(i=>this.onPointer(i.element,i.browserEvent))),this._register(this.widget.onMouseDblClick(i=>this.onMouseDblClick(i.element,i.browserEvent))),typeof t?.openOnSingleClick!="boolean"&&t?.configurationService?(this.openOnSingleClick=t?.configurationService.getValue(q1)!=="doubleClick",this._register(t?.configurationService.onDidChangeConfiguration(i=>{i.affectsConfiguration(q1)&&(this.openOnSingleClick=t?.configurationService.getValue(q1)!=="doubleClick")}))):this.openOnSingleClick=t?.openOnSingleClick??!0}onSelectionFromKeyboard(e){if(e.elements.length!==1)return;const t=e.browserEvent,i=typeof t.preserveFocus=="boolean"?t.preserveFocus:!0,n=typeof t.pinned=="boolean"?t.pinned:!i;this._open(this.getSelectedElement(),i,n,!1,e.browserEvent)}onPointer(e,t){if(!this.openOnSingleClick||t.detail===2)return;const n=t.button===1,s=!0,r=n,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,s,r,a,t)}onMouseDblClick(e,t){if(!t)return;const i=t.target;if(i.classList.contains("monaco-tl-twistie")||i.classList.contains("monaco-icon-label")&&i.classList.contains("folder-icon")&&t.offsetX<16)return;const s=!1,r=!0,a=t.ctrlKey||t.metaKey||t.altKey;this._open(e,s,r,a,t)}_open(e,t,i,n,s){e&&this._onDidOpen.fire({editorOptions:{preserveFocus:t,pinned:i,revealIfVisible:!0},sideBySide:n,element:e,browserEvent:s})}}class gK extends mB{constructor(e,t){super(e,t),this.widget=e}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class Que extends mB{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelectedElements()[0]}}class Jue extends mB{constructor(e,t){super(e,t)}getSelectedElement(){return this.widget.getSelection()[0]??void 0}}function ege(o){let e=!1;return t=>{if(t.toKeyCodeChord().isModifierKey())return!1;if(e)return e=!1,!1;const i=o.softDispatch(t,t.target);return i.kind===1?(e=!0,!1):(e=!1,i.kind===0)}}let aM=class extends oB{constructor(e,t,i,n,s,r,a,l,c){const{options:d,getTypeNavigationMode:h,disposable:u}=r.invokeFunction(Uw,s);super(e,t,i,n,d),this.disposables.add(u),this.internals=new Df(this,s,h,s.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};aM=rd([zt(5,Ce),zt(6,Ee),zt(7,Cr),zt(8,Ke)],aM);let E7=class extends iK{constructor(e,t,i,n,s,r,a,l,c){const{options:d,getTypeNavigationMode:h,disposable:u}=r.invokeFunction(Uw,s);super(e,t,i,n,d),this.disposables.add(u),this.internals=new Df(this,s,h,s.overrideStyles,a,l,c),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};E7=rd([zt(5,Ce),zt(6,Ee),zt(7,Cr),zt(8,Ke)],E7);let T7=class extends $ue{constructor(e,t,i,n,s,r,a,l,c,d){const{options:h,getTypeNavigationMode:u,disposable:g}=a.invokeFunction(Uw,r);super(e,t,i,n,s,h),this.disposables.add(g),this.internals=new Df(this,r,u,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles!==void 0&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};T7=rd([zt(6,Ce),zt(7,Ee),zt(8,Cr),zt(9,Ke)],T7);let lM=class extends sK{get onDidOpen(){return this.internals.onDidOpen}constructor(e,t,i,n,s,r,a,l,c,d){const{options:h,getTypeNavigationMode:u,disposable:g}=a.invokeFunction(Uw,r);super(e,t,i,n,s,h),this.disposables.add(g),this.internals=new Df(this,r,u,r.overrideStyles,l,c,d),this.disposables.add(this.internals)}updateOptions(e={}){super.updateOptions(e),e.overrideStyles&&this.internals.updateStyleOverrides(e.overrideStyles),this.internals.updateOptions(e)}};lM=rd([zt(6,Ce),zt(7,Ee),zt(8,Cr),zt(9,Ke)],lM);let D7=class extends Uue{constructor(e,t,i,n,s,r,a,l,c,d,h){const{options:u,getTypeNavigationMode:g,disposable:f}=l.invokeFunction(Uw,a);super(e,t,i,n,s,r,u),this.disposables.add(f),this.internals=new Df(this,a,g,a.overrideStyles,c,d,h),this.disposables.add(this.internals)}updateOptions(e){super.updateOptions(e),this.internals.updateOptions(e)}};D7=rd([zt(7,Ce),zt(8,Ee),zt(9,Cr),zt(10,Ke)],D7);function fK(o){const e=o.getValue(gB);if(e==="highlight")return Dc.Highlight;if(e==="filter")return Dc.Filter;const t=o.getValue(Ix);if(t==="simple"||t==="highlight")return Dc.Highlight;if(t==="filter")return Dc.Filter}function pK(o){const e=o.getValue(pB);if(e==="fuzzy")return Tf.Fuzzy;if(e==="contiguous")return Tf.Contiguous}function Uw(o,e){const t=o.get(Ke),i=o.get(sd),n=o.get(Ee),s=o.get(Ce),r=()=>{const u=n.getContextKeyValue(hK);if(u==="automatic")return ml.Automatic;if(u==="trigger"||n.getContextKeyValue(uK)===!1)return ml.Trigger;const f=t.getValue(fB);if(f==="automatic")return ml.Automatic;if(f==="trigger")return ml.Trigger},a=e.horizontalScrolling!==void 0?e.horizontalScrolling:!!t.getValue(cr),[l,c]=s.invokeFunction(JT,e),d=e.paddingBottom,h=e.renderIndentGuides!==void 0?e.renderIndentGuides:t.getValue(Nx);return{getTypeNavigationMode:r,disposable:c,options:{keyboardSupport:!1,...l,indent:typeof t.getValue(ky)=="number"?t.getValue(ky):void 0,renderIndentGuides:h,smoothScrolling:!!t.getValue(Pa),defaultFindMode:fK(t),defaultFindMatchType:pK(t),horizontalScrolling:a,scrollByPage:!!t.getValue(Ra),paddingBottom:d,hideTwistiesOfChildlessElements:e.hideTwistiesOfChildlessElements,expandOnlyOnTwistieClick:e.expandOnlyOnTwistieClick??t.getValue(Rx)==="doubleClick",contextViewProvider:i,findWidgetStyles:sce,enableStickyScroll:!!t.getValue(Px),stickyScrollMaxItemCount:Number(t.getValue(Ax))}}}let Df=class{get onDidOpen(){return this.navigator.onDidOpen}constructor(e,t,i,n,s,r,a){this.tree=e,this.disposables=[],this.contextKeyService=XT(s,e),this.disposables.push(QT(this.contextKeyService,e)),this.listSupportsMultiSelect=ZT.bindTo(this.contextKeyService),this.listSupportsMultiSelect.set(t.multipleSelectionSupport!==!1),YT.bindTo(this.contextKeyService).set(!!t.selectionNavigation),this.listSupportFindWidget=jue.bindTo(this.contextKeyService),this.listSupportFindWidget.set(t.findWidgetEnabled??!0),this.hasSelectionOrFocus=lB.bindTo(this.contextKeyService),this.hasDoubleSelection=cB.bindTo(this.contextKeyService),this.hasMultiSelection=dB.bindTo(this.contextKeyService),this.treeElementCanCollapse=hB.bindTo(this.contextKeyService),this.treeElementHasParent=que.bindTo(this.contextKeyService),this.treeElementCanExpand=uB.bindTo(this.contextKeyService),this.treeElementHasChild=Zue.bindTo(this.contextKeyService),this.treeFindOpen=Yue.bindTo(this.contextKeyService),this.treeStickyScrollFocused=cK.bindTo(this.contextKeyService),this._useAltAsMultipleSelectionModifier=Ol(a),this.updateStyleOverrides(n);const c=()=>{const h=e.getFocus()[0];if(!h)return;const u=e.getNode(h);this.treeElementCanCollapse.set(u.collapsible&&!u.collapsed),this.treeElementHasParent.set(!!e.getParentElement(h)),this.treeElementCanExpand.set(u.collapsible&&u.collapsed),this.treeElementHasChild.set(!!e.getFirstElementChild(h))},d=new Set;d.add(hK),d.add(uK),this.disposables.push(this.contextKeyService,r.register(e),e.onDidChangeSelection(()=>{const h=e.getSelection(),u=e.getFocus();this.contextKeyService.bufferChangeEvents(()=>{this.hasSelectionOrFocus.set(h.length>0||u.length>0),this.hasMultiSelection.set(h.length>1),this.hasDoubleSelection.set(h.length===2)})}),e.onDidChangeFocus(()=>{const h=e.getSelection(),u=e.getFocus();this.hasSelectionOrFocus.set(h.length>0||u.length>0),c()}),e.onDidChangeCollapseState(c),e.onDidChangeModel(c),e.onDidChangeFindOpenState(h=>this.treeFindOpen.set(h)),e.onDidChangeStickyScrollFocused(h=>this.treeStickyScrollFocused.set(h)),a.onDidChangeConfiguration(h=>{let u={};if(h.affectsConfiguration(Xf)&&(this._useAltAsMultipleSelectionModifier=Ol(a)),h.affectsConfiguration(ky)){const g=a.getValue(ky);u={...u,indent:g}}if(h.affectsConfiguration(Nx)&&t.renderIndentGuides===void 0){const g=a.getValue(Nx);u={...u,renderIndentGuides:g}}if(h.affectsConfiguration(Pa)){const g=!!a.getValue(Pa);u={...u,smoothScrolling:g}}if(h.affectsConfiguration(gB)||h.affectsConfiguration(Ix)){const g=fK(a);u={...u,defaultFindMode:g}}if(h.affectsConfiguration(fB)||h.affectsConfiguration(Ix)){const g=i();u={...u,typeNavigationMode:g}}if(h.affectsConfiguration(pB)){const g=pK(a);u={...u,defaultFindMatchType:g}}if(h.affectsConfiguration(cr)&&t.horizontalScrolling===void 0){const g=!!a.getValue(cr);u={...u,horizontalScrolling:g}}if(h.affectsConfiguration(Ra)){const g=!!a.getValue(Ra);u={...u,scrollByPage:g}}if(h.affectsConfiguration(Rx)&&t.expandOnlyOnTwistieClick===void 0&&(u={...u,expandOnlyOnTwistieClick:a.getValue(Rx)==="doubleClick"}),h.affectsConfiguration(Px)){const g=a.getValue(Px);u={...u,enableStickyScroll:g}}if(h.affectsConfiguration(Ax)){const g=Math.max(1,a.getValue(Ax));u={...u,stickyScrollMaxItemCount:g}}if(h.affectsConfiguration(Al)){const g=a.getValue(Al);u={...u,mouseWheelScrollSensitivity:g}}if(h.affectsConfiguration(Ml)){const g=a.getValue(Ml);u={...u,fastScrollSensitivity:g}}Object.keys(u).length>0&&e.updateOptions(u)}),this.contextKeyService.onDidChangeContext(h=>{h.affectsSome(d)&&e.updateOptions({typeNavigationMode:i()})})),this.navigator=new Jue(e,{configurationService:a,...t}),this.disposables.push(this.navigator)}updateOptions(e){e.multipleSelectionSupport!==void 0&&this.listSupportsMultiSelect.set(!!e.multipleSelectionSupport)}updateStyleOverrides(e){this.tree.style(e?Zf(e):qf)}dispose(){this.disposables=Dt(this.disposables)}};Df=rd([zt(4,Ee),zt(5,Cr),zt(6,Ke)],Df);const tge=ai.as(Zr.Configuration);tge.registerConfiguration({id:"workbench",order:7,title:p("workbenchConfigurationTitle","Workbench"),type:"object",properties:{[Xf]:{type:"string",enum:["ctrlCmd","alt"],markdownEnumDescriptions:[p("multiSelectModifier.ctrlCmd","Maps to `Control` on Windows and Linux and to `Command` on macOS."),p("multiSelectModifier.alt","Maps to `Alt` on Windows and Linux and to `Option` on macOS.")],default:"ctrlCmd",description:p({key:"multiSelectModifier",comment:["- `ctrlCmd` refers to a value the setting can take and should not be localized.","- `Control` and `Command` refer to the modifier keys Ctrl or Cmd on the keyboard and can be localized."]},"The modifier to be used to add an item in trees and lists to a multi-selection with the mouse (for example in the explorer, open editors and scm view). The 'Open to Side' mouse gestures - if supported - will adapt such that they do not conflict with the multiselect modifier.")},[q1]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:p({key:"openModeModifier",comment:["`singleClick` and `doubleClick` refers to a value the setting can take and should not be localized."]},"Controls how to open items in trees and lists using the mouse (if supported). Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[cr]:{type:"boolean",default:!1,description:p("horizontalScrolling setting","Controls whether lists and trees support horizontal scrolling in the workbench. Warning: turning on this setting has a performance implication.")},[Ra]:{type:"boolean",default:!1,description:p("list.scrollByPage","Controls whether clicks in the scrollbar scroll page by page.")},[ky]:{type:"number",default:8,minimum:4,maximum:40,description:p("tree indent setting","Controls tree indentation in pixels.")},[Nx]:{type:"string",enum:["none","onHover","always"],default:"onHover",description:p("render tree indent guides","Controls whether the tree should render indent guides.")},[Pa]:{type:"boolean",default:!1,description:p("list smoothScrolling setting","Controls whether lists and trees have smooth scrolling.")},[Al]:{type:"number",default:1,markdownDescription:p("Mouse Wheel Scroll Sensitivity","A multiplier to be used on the `deltaX` and `deltaY` of mouse wheel scroll events.")},[Ml]:{type:"number",default:5,markdownDescription:p("Fast Scroll Sensitivity","Scrolling speed multiplier when pressing `Alt`.")},[gB]:{type:"string",enum:["highlight","filter"],enumDescriptions:[p("defaultFindModeSettingKey.highlight","Highlight elements when searching. Further up and down navigation will traverse only the highlighted elements."),p("defaultFindModeSettingKey.filter","Filter elements when searching.")],default:"highlight",description:p("defaultFindModeSettingKey","Controls the default find mode for lists and trees in the workbench.")},[Ix]:{type:"string",enum:["simple","highlight","filter"],enumDescriptions:[p("keyboardNavigationSettingKey.simple","Simple keyboard navigation focuses elements which match the keyboard input. Matching is done only on prefixes."),p("keyboardNavigationSettingKey.highlight","Highlight keyboard navigation highlights elements which match the keyboard input. Further up and down navigation will traverse only the highlighted elements."),p("keyboardNavigationSettingKey.filter","Filter keyboard navigation will filter out and hide all the elements which do not match the keyboard input.")],default:"highlight",description:p("keyboardNavigationSettingKey","Controls the keyboard navigation style for lists and trees in the workbench. Can be simple, highlight and filter."),deprecated:!0,deprecationMessage:p("keyboardNavigationSettingKeyDeprecated","Please use 'workbench.list.defaultFindMode' and	'workbench.list.typeNavigationMode' instead.")},[pB]:{type:"string",enum:["fuzzy","contiguous"],enumDescriptions:[p("defaultFindMatchTypeSettingKey.fuzzy","Use fuzzy matching when searching."),p("defaultFindMatchTypeSettingKey.contiguous","Use contiguous matching when searching.")],default:"fuzzy",description:p("defaultFindMatchTypeSettingKey","Controls the type of matching used when searching lists and trees in the workbench.")},[Rx]:{type:"string",enum:["singleClick","doubleClick"],default:"singleClick",description:p("expand mode","Controls how tree folders are expanded when clicking the folder names. Note that some trees and lists might choose to ignore this setting if it is not applicable.")},[Px]:{type:"boolean",default:!0,description:p("sticky scroll","Controls whether sticky scrolling is enabled in trees.")},[Ax]:{type:"number",minimum:1,default:7,markdownDescription:p("sticky scroll maximum items","Controls the number of sticky elements displayed in the tree when {0} is enabled.","`#workbench.tree.enableStickyScroll#`")},[fB]:{type:"string",enum:["automatic","trigger"],default:"automatic",markdownDescription:p("typeNavigationMode2","Controls how type navigation works in lists and trees in the workbench. When set to `trigger`, type navigation begins once the `list.triggerTypeNavigation` command is run.")}}});class rh extends F{constructor(e,t){super(),this.options=t,this.text="",this.title="",this.highlights=[],this.didEverRender=!1,this.supportIcons=t?.supportIcons??!1,this.domNode=Y(e,ie("span.monaco-highlighted-label"))}get element(){return this.domNode}set(e,t=[],i="",n){e||(e=""),n&&(e=rh.escapeNewLines(e,t)),!(this.didEverRender&&this.text===e&&this.title===i&&eo(this.highlights,t))&&(this.text=e,this.title=i,this.highlights=t,this.render())}render(){const e=[];let t=0;for(const i of this.highlights){if(i.end===i.start)continue;if(t<i.start){const r=this.text.substring(t,i.start);this.supportIcons?e.push(...nh(r)):e.push(r),t=i.start}const n=this.text.substring(t,i.end),s=ie("span.highlight",void 0,...this.supportIcons?nh(n):[n]);i.extraClasses&&s.classList.add(...i.extraClasses),e.push(s),t=i.end}if(t<this.text.length){const i=this.text.substring(t);this.supportIcons?e.push(...nh(i)):e.push(i)}if(pn(this.domNode,...e),this.options?.hoverDelegate?.showNativeHover)this.domNode.title=this.title;else if(!this.customHover&&this.title!==""){const i=this.options?.hoverDelegate??bs("mouse");this.customHover=this._register(Ba().setupManagedHover(i,this.domNode,this.title))}else this.customHover&&this.customHover.update(this.title);this.didEverRender=!0}static escapeNewLines(e,t){let i=0,n=0;return e.replace(/\r\n|\r|\n/g,(s,r)=>{n=s===`\r
`?-1:0,r+=i;for(const a of t)a.end<=r||(a.start>=r&&(a.start+=n),a.end>=r&&(a.end+=n));return i+=n,"⏎"})}}class Xb{constructor(e){this._element=e}get element(){return this._element}set textContent(e){this.disposed||e===this._textContent||(this._textContent=e,this._element.textContent=e)}set classNames(e){this.disposed||eo(e,this._classNames)||(this._classNames=e,this._element.classList.value="",this._element.classList.add(...e))}set empty(e){this.disposed||e===this._empty||(this._empty=e,this._element.style.marginLeft=e?"0":"")}dispose(){this.disposed=!0}}class Mx extends F{constructor(e,t){super(),this.customHovers=new Map,this.creationOptions=t,this.domNode=this._register(new Xb(Y(e,ie(".monaco-icon-label")))),this.labelContainer=Y(this.domNode.element,ie(".monaco-icon-label-container")),this.nameContainer=Y(this.labelContainer,ie("span.monaco-icon-name-container")),t?.supportHighlights||t?.supportIcons?this.nameNode=this._register(new sge(this.nameContainer,!!t.supportIcons)):this.nameNode=new ige(this.nameContainer),this.hoverDelegate=t?.hoverDelegate??bs("mouse")}get element(){return this.domNode.element}setLabel(e,t,i){const n=["monaco-icon-label"],s=["monaco-icon-label-container"];let r="";i&&(i.extraClasses&&n.push(...i.extraClasses),i.italic&&n.push("italic"),i.strikethrough&&n.push("strikethrough"),i.disabledCommand&&s.push("disabled"),i.title&&(typeof i.title=="string"?r+=i.title:r+=e));const a=this.domNode.element.querySelector(".monaco-icon-label-iconpath");if(i?.iconPath){let l;!a||!qi(a)?(l=ie(".monaco-icon-label-iconpath"),this.domNode.element.prepend(l)):l=a,l.style.backgroundImage=jc(i?.iconPath)}else a&&a.remove();if(this.domNode.classNames=n,this.domNode.element.setAttribute("aria-label",r),this.labelContainer.classList.value="",this.labelContainer.classList.add(...s),this.setupHover(i?.descriptionTitle?this.labelContainer:this.element,i?.title),this.nameNode.setLabel(e,i),t||this.descriptionNode){const l=this.getOrCreateDescriptionNode();l instanceof rh?(l.set(t||"",i?i.descriptionMatches:void 0,void 0,i?.labelEscapeNewLines),this.setupHover(l.element,i?.descriptionTitle)):(l.textContent=t&&i?.labelEscapeNewLines?rh.escapeNewLines(t,[]):t||"",this.setupHover(l.element,i?.descriptionTitle||""),l.empty=!t)}if(i?.suffix||this.suffixNode){const l=this.getOrCreateSuffixNode();l.textContent=i?.suffix??""}}setupHover(e,t){const i=this.customHovers.get(e);if(i&&(i.dispose(),this.customHovers.delete(e)),!t){e.removeAttribute("title");return}if(this.hoverDelegate.showNativeHover)(function(s,r){Ds(r)?s.title=E5(r):r?.markdownNotSupportedFallback?s.title=r.markdownNotSupportedFallback:s.removeAttribute("title")})(e,t);else{const n=Ba().setupManagedHover(this.hoverDelegate,e,t);n&&this.customHovers.set(e,n)}}dispose(){super.dispose();for(const e of this.customHovers.values())e.dispose();this.customHovers.clear()}getOrCreateSuffixNode(){if(!this.suffixNode){const e=this._register(new Xb(oee(this.nameContainer,ie("span.monaco-icon-suffix-container"))));this.suffixNode=this._register(new Xb(Y(e.element,ie("span.label-suffix"))))}return this.suffixNode}getOrCreateDescriptionNode(){if(!this.descriptionNode){const e=this._register(new Xb(Y(this.labelContainer,ie("span.monaco-icon-description-container"))));this.creationOptions?.supportDescriptionHighlights?this.descriptionNode=this._register(new rh(Y(e.element,ie("span.label-description")),{supportIcons:!!this.creationOptions.supportIcons})):this.descriptionNode=this._register(new Xb(Y(e.element,ie("span.label-description"))))}return this.descriptionNode}}class ige{constructor(e){this.container=e,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&eo(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=Y(this.container,ie("a.label-name",{id:t?.domId}))),this.singleLabel.textContent=e;else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;for(let i=0;i<e.length;i++){const n=e[i],s=t?.domId&&`${t?.domId}_${i}`;Y(this.container,ie("a.label-name",{id:s,"data-icon-label-count":e.length,"data-icon-label-index":i,role:"treeitem"},n)),i<e.length-1&&Y(this.container,ie("span.label-separator",void 0,t?.separator||"/"))}}}}function nge(o,e,t){if(!t)return;let i=0;return o.map(n=>{const s={start:i,end:i+n.length},r=t.map(a=>In.intersect(s,a)).filter(a=>!In.isEmpty(a)).map(({start:a,end:l})=>({start:a-i,end:l-i}));return i=s.end+e.length,r})}class sge extends F{constructor(e,t){super(),this.container=e,this.supportIcons=t,this.label=void 0,this.singleLabel=void 0}setLabel(e,t){if(!(this.label===e&&eo(this.options,t)))if(this.label=e,this.options=t,typeof e=="string")this.singleLabel||(this.container.innerText="",this.container.classList.remove("multiple"),this.singleLabel=this._register(new rh(Y(this.container,ie("a.label-name",{id:t?.domId})),{supportIcons:this.supportIcons}))),this.singleLabel.set(e,t?.matches,void 0,t?.labelEscapeNewLines);else{this.container.innerText="",this.container.classList.add("multiple"),this.singleLabel=void 0;const i=t?.separator||"/",n=nge(e,i,t?.matches);for(let s=0;s<e.length;s++){const r=e[s],a=n?n[s]:void 0,l=t?.domId&&`${t?.domId}_${s}`,c=ie("a.label-name",{id:l,"data-icon-label-count":e.length,"data-icon-label-index":s,role:"treeitem"});this._register(new rh(Y(this.container,c),{supportIcons:this.supportIcons})).set(r,a,void 0,t?.labelEscapeNewLines),s<e.length-1&&Y(c,ie("span.label-separator",void 0,i))}}}}const $S=ie,mK={keybindingLabelBackground:void 0,keybindingLabelForeground:void 0,keybindingLabelBorder:void 0,keybindingLabelBottomBorder:void 0,keybindingLabelShadow:void 0};class _b extends F{constructor(e,t,i){super(),this.os=t,this.keyElements=new Set,this.options=i||Object.create(null);const n=this.options.keybindingLabelForeground;this.domNode=Y(e,$S(".monaco-keybinding")),n&&(this.domNode.style.color=n),this.hover=this._register(Ba().setupManagedHover(bs("mouse"),this.domNode,"")),this.didEverRender=!1,e.appendChild(this.domNode)}get element(){return this.domNode}set(e,t){this.didEverRender&&this.keybinding===e&&_b.areSame(this.matches,t)||(this.keybinding=e,this.matches=t,this.render())}render(){if(this.clear(),this.keybinding){const e=this.keybinding.getChords();e[0]&&this.renderChord(this.domNode,e[0],this.matches?this.matches.firstPart:null);for(let i=1;i<e.length;i++)Y(this.domNode,$S("span.monaco-keybinding-key-chord-separator",void 0," ")),this.renderChord(this.domNode,e[i],this.matches?this.matches.chordPart:null);const t=this.options.disableTitle??!1?void 0:this.keybinding.getAriaLabel()||void 0;this.hover.update(t),this.domNode.setAttribute("aria-label",t||"")}else this.options&&this.options.renderUnboundKeybindings&&this.renderUnbound(this.domNode);this.didEverRender=!0}clear(){fn(this.domNode),this.keyElements.clear()}renderChord(e,t,i){const n=P5.modifierLabels[this.os];t.ctrlKey&&this.renderKey(e,n.ctrlKey,!!i?.ctrlKey,n.separator),t.shiftKey&&this.renderKey(e,n.shiftKey,!!i?.shiftKey,n.separator),t.altKey&&this.renderKey(e,n.altKey,!!i?.altKey,n.separator),t.metaKey&&this.renderKey(e,n.metaKey,!!i?.metaKey,n.separator);const s=t.keyLabel;s&&this.renderKey(e,s,!!i?.keyCode,"")}renderKey(e,t,i,n){Y(e,this.createKeyElement(t,i?".highlight":"")),n&&Y(e,$S("span.monaco-keybinding-key-separator",void 0,n))}renderUnbound(e){Y(e,this.createKeyElement(p("unbound","Unbound")))}createKeyElement(e,t=""){const i=$S("span.monaco-keybinding-key"+t,void 0,e);return this.keyElements.add(i),this.options.keybindingLabelBackground&&(i.style.backgroundColor=this.options.keybindingLabelBackground),this.options.keybindingLabelBorder&&(i.style.borderColor=this.options.keybindingLabelBorder),this.options.keybindingLabelBottomBorder&&(i.style.borderBottomColor=this.options.keybindingLabelBottomBorder),this.options.keybindingLabelShadow&&(i.style.boxShadow=`inset 0 -1px 0 ${this.options.keybindingLabelShadow}`),i}static areSame(e,t){return e===t||!e&&!t?!0:!!e&&!!t&&eo(e.firstPart,t.firstPart)&&eo(e.chordPart,t.chordPart)}}const I7=new Da(()=>{const o=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return{collator:o,collatorIsNumeric:o.resolvedOptions().numeric}});function oge(o,e,t=!1){const i=o||"",n=e||"",s=I7.value.collator.compare(i,n);return I7.value.collatorIsNumeric&&s===0&&i!==n?i<n?-1:1:s}function rge(o,e,t){const i=o.toLowerCase(),n=e.toLowerCase(),s=age(o,e,t);if(s)return s;const r=i.endsWith(t),a=n.endsWith(t);if(r!==a)return r?-1:1;const l=oge(i,n);return l!==0?l:i.localeCompare(n)}function age(o,e,t){const i=o.toLowerCase(),n=e.toLowerCase(),s=i.startsWith(t),r=n.startsWith(t);if(s!==r)return s?-1:1;if(s&&r){if(i.length<n.length)return-1;if(i.length>n.length)return 1}return 0}var eD=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},cM=function(o,e){return function(t,i){e(t,i,o)}},dM;const ea=ie;class _K{constructor(e,t,i){this.index=e,this.hasCheckbox=t,this._hidden=!1,this._init=new Da(()=>{const n=i.label??"",s=fv(n).text.trim(),r=i.ariaLabel||[n,this.saneDescription,this.saneDetail].map(a=>pre(a)).filter(a=>!!a).join(", ");return{saneLabel:n,saneSortLabel:s,saneAriaLabel:r}}),this._saneDescription=i.description,this._saneTooltip=i.tooltip}get saneLabel(){return this._init.value.saneLabel}get saneSortLabel(){return this._init.value.saneSortLabel}get saneAriaLabel(){return this._init.value.saneAriaLabel}get element(){return this._element}set element(e){this._element=e}get hidden(){return this._hidden}set hidden(e){this._hidden=e}get saneDescription(){return this._saneDescription}set saneDescription(e){this._saneDescription=e}get saneDetail(){return this._saneDetail}set saneDetail(e){this._saneDetail=e}get saneTooltip(){return this._saneTooltip}set saneTooltip(e){this._saneTooltip=e}get labelHighlights(){return this._labelHighlights}set labelHighlights(e){this._labelHighlights=e}get descriptionHighlights(){return this._descriptionHighlights}set descriptionHighlights(e){this._descriptionHighlights=e}get detailHighlights(){return this._detailHighlights}set detailHighlights(e){this._detailHighlights=e}}class vn extends _K{constructor(e,t,i,n,s,r){super(e,t,s),this.fireButtonTriggered=i,this._onChecked=n,this.item=s,this._separator=r,this._checked=!1,this.onChecked=t?se.map(se.filter(this._onChecked.event,a=>a.element===this),a=>a.checked):se.None,this._saneDetail=s.detail,this._labelHighlights=s.highlights?.label,this._descriptionHighlights=s.highlights?.description,this._detailHighlights=s.highlights?.detail}get separator(){return this._separator}set separator(e){this._separator=e}get checked(){return this._checked}set checked(e){e!==this._checked&&(this._checked=e,this._onChecked.fire({element:this,checked:e}))}get checkboxDisabled(){return!!this.item.disabled}}var cl;(function(o){o[o.NONE=0]="NONE",o[o.MOUSE_HOVER=1]="MOUSE_HOVER",o[o.ACTIVE_ITEM=2]="ACTIVE_ITEM"})(cl||(cl={}));class Lu extends _K{constructor(e,t,i){super(e,!1,i),this.fireSeparatorButtonTriggered=t,this.separator=i,this.children=new Array,this.focusInsideSeparator=cl.NONE}}class lge{getHeight(e){return e instanceof Lu?30:e.saneDetail?44:22}getTemplateId(e){return e instanceof vn?Ox.ID:Fx.ID}}class cge{getWidgetAriaLabel(){return p("quickInput","Quick Input")}getAriaLabel(e){return e.separator?.label?`${e.saneAriaLabel}, ${e.separator.label}`:e.saneAriaLabel}getWidgetRole(){return"listbox"}getRole(e){return e.hasCheckbox?"checkbox":"option"}isChecked(e){if(!(!e.hasCheckbox||!(e instanceof vn)))return{get value(){return e.checked},onDidChange:t=>e.onChecked(()=>t())}}}class bK{constructor(e){this.hoverDelegate=e}renderTemplate(e){const t=Object.create(null);t.toDisposeElement=new $,t.toDisposeTemplate=new $,t.entry=Y(e,ea(".quick-input-list-entry"));const i=Y(t.entry,ea("label.quick-input-list-label"));t.toDisposeTemplate.add(ci(i,ee.CLICK,c=>{t.checkbox.offsetParent||c.preventDefault()})),t.checkbox=Y(i,ea("input.quick-input-list-checkbox")),t.checkbox.type="checkbox";const n=Y(i,ea(".quick-input-list-rows")),s=Y(n,ea(".quick-input-list-row")),r=Y(n,ea(".quick-input-list-row"));t.label=new Mx(s,{supportHighlights:!0,supportDescriptionHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.label),t.icon=G4(t.label.element,ea(".quick-input-list-icon"));const a=Y(s,ea(".quick-input-list-entry-keybinding"));t.keybinding=new _b(a,Js),t.toDisposeTemplate.add(t.keybinding);const l=Y(r,ea(".quick-input-list-label-meta"));return t.detail=new Mx(l,{supportHighlights:!0,supportIcons:!0,hoverDelegate:this.hoverDelegate}),t.toDisposeTemplate.add(t.detail),t.separator=Y(t.entry,ea(".quick-input-list-separator")),t.actionBar=new Oo(t.entry,this.hoverDelegate?{hoverDelegate:this.hoverDelegate}:void 0),t.actionBar.domNode.classList.add("quick-input-list-entry-action-bar"),t.toDisposeTemplate.add(t.actionBar),t}disposeTemplate(e){e.toDisposeElement.dispose(),e.toDisposeTemplate.dispose()}disposeElement(e,t,i){i.toDisposeElement.clear(),i.actionBar.clear()}}var Cg;let Ox=(Cg=class extends bK{constructor(e,t){super(e),this.themeService=t,this._itemsWithSeparatorsFrequency=new Map}get templateId(){return dM.ID}renderTemplate(e){const t=super.renderTemplate(e);return t.toDisposeTemplate.add(ci(t.checkbox,ee.CHANGE,i=>{t.element.checked=t.checkbox.checked})),t}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0;const s=n.item;i.checkbox.checked=n.checked,i.toDisposeElement.add(n.onChecked(u=>i.checkbox.checked=u)),i.checkbox.disabled=n.checkboxDisabled;const{labelHighlights:r,descriptionHighlights:a,detailHighlights:l}=n;if(s.iconPath){const u=v_(this.themeService.getColorTheme().type)?s.iconPath.dark:s.iconPath.light??s.iconPath.dark,g=ye.revive(u);i.icon.className="quick-input-list-icon",i.icon.style.backgroundImage=jc(g)}else i.icon.style.backgroundImage="",i.icon.className=s.iconClass?`quick-input-list-icon ${s.iconClass}`:"";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:n.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const d={matches:r||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(d.extraClasses=s.iconClasses,d.italic=s.italic,d.strikethrough=s.strikethrough,i.entry.classList.remove("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,d),i.keybinding.set(s.keybinding),n.saneDetail){let u;n.saneTooltip||(u={markdown:{value:n.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:u,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";n.separator?.label?(i.separator.textContent=n.separator.label,i.separator.style.display="",this.addItemWithSeparator(n)):i.separator.style.display="none",i.entry.classList.toggle("quick-input-list-separator-border",!!n.separator);const h=s.buttons;h&&h.length?(i.actionBar.push(h.map((u,g)=>qv(u,`id-${g}`,()=>n.fireButtonTriggered({button:u,item:n.item}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions")}disposeElement(e,t,i){this.removeItemWithSeparator(e.element),super.disposeElement(e,t,i)}isItemWithSeparatorVisible(e){return this._itemsWithSeparatorsFrequency.has(e)}addItemWithSeparator(e){this._itemsWithSeparatorsFrequency.set(e,(this._itemsWithSeparatorsFrequency.get(e)||0)+1)}removeItemWithSeparator(e){const t=this._itemsWithSeparatorsFrequency.get(e)||0;t>1?this._itemsWithSeparatorsFrequency.set(e,t-1):this._itemsWithSeparatorsFrequency.delete(e)}},dM=Cg,Cg.ID="quickpickitem",Cg);Ox=dM=eD([cM(1,zi)],Ox);const Vk=class Vk extends bK{constructor(){super(...arguments),this._visibleSeparatorsFrequency=new Map}get templateId(){return Vk.ID}get visibleSeparators(){return[...this._visibleSeparatorsFrequency.keys()]}isSeparatorVisible(e){return this._visibleSeparatorsFrequency.has(e)}renderTemplate(e){const t=super.renderTemplate(e);return t.checkbox.style.display="none",t}renderElement(e,t,i){const n=e.element;i.element=n,n.element=i.entry??void 0,n.element.classList.toggle("focus-inside",!!n.focusInsideSeparator);const s=n.separator,{labelHighlights:r,descriptionHighlights:a,detailHighlights:l}=n;i.icon.style.backgroundImage="",i.icon.className="";let c;!n.saneTooltip&&n.saneDescription&&(c={markdown:{value:n.saneDescription,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDescription});const d={matches:r||[],descriptionTitle:c,descriptionMatches:a||[],labelEscapeNewLines:!0};if(i.entry.classList.add("quick-input-list-separator-as-item"),i.label.setLabel(n.saneLabel,n.saneDescription,d),n.saneDetail){let u;n.saneTooltip||(u={markdown:{value:n.saneDetail,supportThemeIcons:!0},markdownNotSupportedFallback:n.saneDetail}),i.detail.element.style.display="",i.detail.setLabel(n.saneDetail,void 0,{matches:l,title:u,labelEscapeNewLines:!0})}else i.detail.element.style.display="none";i.separator.style.display="none",i.entry.classList.add("quick-input-list-separator-border");const h=s.buttons;h&&h.length?(i.actionBar.push(h.map((u,g)=>qv(u,`id-${g}`,()=>n.fireSeparatorButtonTriggered({button:u,separator:n.separator}))),{icon:!0,label:!1}),i.entry.classList.add("has-actions")):i.entry.classList.remove("has-actions"),this.addSeparator(n)}disposeElement(e,t,i){this.removeSeparator(e.element),this.isSeparatorVisible(e.element)||e.element.element?.classList.remove("focus-inside"),super.disposeElement(e,t,i)}addSeparator(e){this._visibleSeparatorsFrequency.set(e,(this._visibleSeparatorsFrequency.get(e)||0)+1)}removeSeparator(e){const t=this._visibleSeparatorsFrequency.get(e)||0;t>1?this._visibleSeparatorsFrequency.set(e,t-1):this._visibleSeparatorsFrequency.delete(e)}};Vk.ID="quickpickseparator";let Fx=Vk,Ey=class extends F{constructor(e,t,i,n,s,r){super(),this.parent=e,this.hoverDelegate=t,this.linkOpenerDelegate=i,this.accessibilityService=r,this._onKeyDown=new O,this._onLeave=new O,this.onLeave=this._onLeave.event,this._visibleCountObservable=$e("VisibleCount",0),this.onChangedVisibleCount=se.fromObservable(this._visibleCountObservable,this._store),this._allVisibleCheckedObservable=$e("AllVisibleChecked",!1),this.onChangedAllVisibleChecked=se.fromObservable(this._allVisibleCheckedObservable,this._store),this._checkedCountObservable=$e("CheckedCount",0),this.onChangedCheckedCount=se.fromObservable(this._checkedCountObservable,this._store),this._checkedElementsObservable=SA({equalsFn:ei},new Array),this.onChangedCheckedElements=se.fromObservable(this._checkedElementsObservable,this._store),this._onButtonTriggered=new O,this.onButtonTriggered=this._onButtonTriggered.event,this._onSeparatorButtonTriggered=new O,this.onSeparatorButtonTriggered=this._onSeparatorButtonTriggered.event,this._elementChecked=new O,this._elementCheckedEventBufferer=new Cw,this._hasCheckboxes=!1,this._inputElements=new Array,this._elementTree=new Array,this._itemElements=new Array,this._elementDisposable=this._register(new $),this._matchOnDescription=!1,this._matchOnDetail=!1,this._matchOnLabel=!0,this._matchOnLabelMode="fuzzy",this._sortByLabel=!0,this._shouldLoop=!0,this._container=Y(this.parent,ea(".quick-input-list")),this._separatorRenderer=new Fx(t),this._itemRenderer=s.createInstance(Ox,t),this._tree=this._register(s.createInstance(aM,"QuickInput",this._container,new lge,[this._itemRenderer,this._separatorRenderer],{filter:{filter(a){return a.hidden?0:a instanceof Lu?2:1}},sorter:{compare:(a,l)=>{if(!this.sortByLabel||!this._lastQueryString)return 0;const c=this._lastQueryString.toLowerCase();return hge(a,l,c)}},accessibilityProvider:new cge,setRowLineHeight:!1,multipleSelectionSupport:!1,hideTwistiesOfChildlessElements:!0,renderIndentGuides:R_.None,findWidgetEnabled:!1,indent:0,horizontalScrolling:!1,allowNonCollapsibleParents:!0,alwaysConsumeMouseWheel:!0})),this._tree.getHTMLElement().id=n,this._registerListeners()}get onDidChangeFocus(){return se.map(this._tree.onDidChangeFocus,e=>e.elements.filter(t=>t instanceof vn).map(t=>t.item),this._store)}get onDidChangeSelection(){return se.map(this._tree.onDidChangeSelection,e=>({items:e.elements.filter(t=>t instanceof vn).map(t=>t.item),event:e.browserEvent}),this._store)}get displayed(){return this._container.style.display!=="none"}set displayed(e){this._container.style.display=e?"":"none"}get scrollTop(){return this._tree.scrollTop}set scrollTop(e){this._tree.scrollTop=e}get ariaLabel(){return this._tree.ariaLabel}set ariaLabel(e){this._tree.ariaLabel=e??""}set enabled(e){this._tree.getHTMLElement().style.pointerEvents=e?"":"none"}get matchOnDescription(){return this._matchOnDescription}set matchOnDescription(e){this._matchOnDescription=e}get matchOnDetail(){return this._matchOnDetail}set matchOnDetail(e){this._matchOnDetail=e}get matchOnLabel(){return this._matchOnLabel}set matchOnLabel(e){this._matchOnLabel=e}get matchOnLabelMode(){return this._matchOnLabelMode}set matchOnLabelMode(e){this._matchOnLabelMode=e}get sortByLabel(){return this._sortByLabel}set sortByLabel(e){this._sortByLabel=e}get shouldLoop(){return this._shouldLoop}set shouldLoop(e){this._shouldLoop=e}_registerListeners(){this._registerOnKeyDown(),this._registerOnContainerClick(),this._registerOnMouseMiddleClick(),this._registerOnTreeModelChanged(),this._registerOnElementChecked(),this._registerOnContextMenu(),this._registerHoverListeners(),this._registerSelectionChangeListener(),this._registerSeparatorActionShowingListeners()}_registerOnKeyDown(){this._register(this._tree.onKeyDown(e=>{const t=new Pt(e);switch(t.keyCode){case 10:this.toggleCheckbox();break}this._onKeyDown.fire(t)}))}_registerOnContainerClick(){this._register(H(this._container,ee.CLICK,e=>{(e.x||e.y)&&this._onLeave.fire()}))}_registerOnMouseMiddleClick(){this._register(H(this._container,ee.AUXCLICK,e=>{e.button===1&&this._onLeave.fire()}))}_registerOnTreeModelChanged(){this._register(this._tree.onDidChangeModel(()=>{const e=this._itemElements.filter(t=>!t.hidden).length;this._visibleCountObservable.set(e,void 0),this._hasCheckboxes&&this._updateCheckedObservables()}))}_registerOnElementChecked(){this._register(this._elementCheckedEventBufferer.wrapEvent(this._elementChecked.event,(e,t)=>t)(e=>this._updateCheckedObservables()))}_registerOnContextMenu(){this._register(this._tree.onContextMenu(e=>{e.element&&(e.browserEvent.preventDefault(),this._tree.setSelection([e.element]))}))}_registerHoverListeners(){const e=this._register(new Az(this.hoverDelegate.delay));this._register(this._tree.onMouseOver(async t=>{if(H3(t.browserEvent.target)){e.cancel();return}if(!(!H3(t.browserEvent.relatedTarget)&&Ki(t.browserEvent.relatedTarget,t.element?.element)))try{await e.trigger(async()=>{t.element instanceof vn&&this.showHover(t.element)})}catch(i){if(!_r(i))throw i}})),this._register(this._tree.onMouseOut(t=>{Ki(t.browserEvent.relatedTarget,t.element?.element)||e.cancel()}))}_registerSeparatorActionShowingListeners(){this._register(this._tree.onDidChangeFocus(e=>{const t=e.elements[0]?this._tree.getParentElement(e.elements[0]):null;for(const i of this._separatorRenderer.visibleSeparators){const n=i===t;!!(i.focusInsideSeparator&cl.ACTIVE_ITEM)!==n&&(n?i.focusInsideSeparator|=cl.ACTIVE_ITEM:i.focusInsideSeparator&=~cl.ACTIVE_ITEM,this._tree.rerender(i))}})),this._register(this._tree.onMouseOver(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&cl.MOUSE_HOVER)||(i.focusInsideSeparator|=cl.MOUSE_HOVER,this._tree.rerender(i))}})),this._register(this._tree.onMouseOut(e=>{const t=e.element?this._tree.getParentElement(e.element):null;for(const i of this._separatorRenderer.visibleSeparators){if(i!==t)continue;!!(i.focusInsideSeparator&cl.MOUSE_HOVER)&&(i.focusInsideSeparator&=~cl.MOUSE_HOVER,this._tree.rerender(i))}}))}_registerSelectionChangeListener(){this._register(this._tree.onDidChangeSelection(e=>{const t=e.elements.filter(i=>i instanceof vn);t.length!==e.elements.length&&(e.elements.length===1&&e.elements[0]instanceof Lu&&(this._tree.setFocus([e.elements[0].children[0]]),this._tree.reveal(e.elements[0],0)),this._tree.setSelection(t))}))}setAllVisibleChecked(e){this._elementCheckedEventBufferer.bufferEvents(()=>{this._itemElements.forEach(t=>{!t.hidden&&!t.checkboxDisabled&&(t.checked=e)})})}setElements(e){this._elementDisposable.clear(),this._lastQueryString=void 0,this._inputElements=e,this._hasCheckboxes=this.parent.classList.contains("show-checkboxes");let t;this._itemElements=new Array,this._elementTree=e.reduce((i,n,s)=>{let r;if(n.type==="separator"){if(!n.buttons)return i;t=new Lu(s,a=>this._onSeparatorButtonTriggered.fire(a),n),r=t}else{const a=s>0?e[s-1]:void 0;let l;a&&a.type==="separator"&&!a.buttons&&(t=void 0,l=a);const c=new vn(s,this._hasCheckboxes,d=>this._onButtonTriggered.fire(d),this._elementChecked,n,l);if(this._itemElements.push(c),t)return t.children.push(c),i;r=c}return i.push(r),i},new Array),this._setElementsToTree(this._elementTree),this.accessibilityService.isScreenReaderOptimized()&&setTimeout(()=>{const i=this._tree.getHTMLElement().querySelector(".monaco-list-row.focused"),n=i?.parentNode;if(i&&n){const s=i.nextSibling;i.remove(),n.insertBefore(i,s)}},0)}setFocusedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i).filter(i=>!i.hidden);if(this._tree.setFocus(t),e.length>0){const i=this._tree.getFocus()[0];i&&this._tree.reveal(i)}}getActiveDescendant(){return this._tree.getHTMLElement().getAttribute("aria-activedescendant")}setSelectedElements(e){const t=e.map(i=>this._itemElements.find(n=>n.item===i)).filter(i=>!!i);this._tree.setSelection(t)}getCheckedElements(){return this._itemElements.filter(e=>e.checked).map(e=>e.item)}setCheckedElements(e){this._elementCheckedEventBufferer.bufferEvents(()=>{const t=new Set;for(const i of e)t.add(i);for(const i of this._itemElements)i.checked=t.has(i.item)})}focus(e){if(this._itemElements.length)switch(e===Wt.Second&&this._itemElements.length<2&&(e=Wt.First),e){case Wt.First:this._tree.scrollTop=0,this._tree.focusFirst(void 0,t=>t.element instanceof vn);break;case Wt.Second:{this._tree.scrollTop=0;let t=!1;this._tree.focusFirst(void 0,i=>i.element instanceof vn?t?!0:(t=!t,!1):!1);break}case Wt.Last:this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,t=>t.element instanceof vn);break;case Wt.Next:{const t=this._tree.getFocus();this._tree.focusNext(void 0,this._shouldLoop,void 0,n=>n.element instanceof vn?(this._tree.reveal(n.element),!0):!1);const i=this._tree.getFocus();t.length&&t[0]===i[0]&&t[0]===this._itemElements[this._itemElements.length-1]&&this._onLeave.fire();break}case Wt.Previous:{const t=this._tree.getFocus();this._tree.focusPrevious(void 0,this._shouldLoop,void 0,n=>{if(!(n.element instanceof vn))return!1;const s=this._tree.getParentElement(n.element);return s===null||s.children[0]!==n.element?this._tree.reveal(n.element):this._tree.reveal(s),!0});const i=this._tree.getFocus();t.length&&t[0]===i[0]&&t[0]===this._itemElements[0]&&this._onLeave.fire();break}case Wt.NextPage:this._tree.focusNextPage(void 0,t=>t.element instanceof vn?(this._tree.reveal(t.element),!0):!1);break;case Wt.PreviousPage:this._tree.focusPreviousPage(void 0,t=>{if(!(t.element instanceof vn))return!1;const i=this._tree.getParentElement(t.element);return i===null||i.children[0]!==t.element?this._tree.reveal(t.element):this._tree.reveal(i),!0});break;case Wt.NextSeparator:{let t=!1;const i=this._tree.getFocus()[0];this._tree.focusNext(void 0,!0,void 0,s=>{if(t)return!0;if(s.element instanceof Lu)t=!0,this._separatorRenderer.isSeparatorVisible(s.element)?this._tree.reveal(s.element.children[0]):this._tree.reveal(s.element,0);else if(s.element instanceof vn){if(s.element.separator)return this._itemRenderer.isItemWithSeparatorVisible(s.element)?this._tree.reveal(s.element):this._tree.reveal(s.element,0),!0;if(s.element===this._elementTree[0])return this._tree.reveal(s.element,0),!0}return!1});const n=this._tree.getFocus()[0];i===n&&(this._tree.scrollTop=this._tree.scrollHeight,this._tree.focusLast(void 0,s=>s.element instanceof vn));break}case Wt.PreviousSeparator:{let t,i=!!this._tree.getFocus()[0]?.separator;this._tree.focusPrevious(void 0,!0,void 0,n=>{if(n.element instanceof Lu)i?t||(this._separatorRenderer.isSeparatorVisible(n.element)?this._tree.reveal(n.element):this._tree.reveal(n.element,0),t=n.element.children[0]):i=!0;else if(n.element instanceof vn&&!t){if(n.element.separator)this._itemRenderer.isItemWithSeparatorVisible(n.element)?this._tree.reveal(n.element):this._tree.reveal(n.element,0),t=n.element;else if(n.element===this._elementTree[0])return this._tree.reveal(n.element,0),!0}return!1}),t&&this._tree.setFocus([t]);break}}}clearFocus(){this._tree.setFocus([])}domFocus(){this._tree.domFocus()}layout(e){this._tree.getHTMLElement().style.maxHeight=e?`${Math.floor(e/44)*44+6}px`:"",this._tree.layout()}filter(e){if(this._lastQueryString=e,!(this._sortByLabel||this._matchOnLabel||this._matchOnDescription||this._matchOnDetail))return this._tree.layout(),!1;const t=e;if(e=e.trim(),!e||!(this.matchOnLabel||this.matchOnDescription||this.matchOnDetail))this._itemElements.forEach(i=>{i.labelHighlights=void 0,i.descriptionHighlights=void 0,i.detailHighlights=void 0,i.hidden=!1;const n=i.index&&this._inputElements[i.index-1];i.item&&(i.separator=n&&n.type==="separator"&&!n.buttons?n:void 0)});else{let i;this._itemElements.forEach(n=>{let s;this.matchOnLabelMode==="fuzzy"?s=this.matchOnLabel?EI(e,fv(n.saneLabel))??void 0:void 0:s=this.matchOnLabel?dge(t,fv(n.saneLabel))??void 0:void 0;const r=this.matchOnDescription?EI(e,fv(n.saneDescription||""))??void 0:void 0,a=this.matchOnDetail?EI(e,fv(n.saneDetail||""))??void 0:void 0;if(s||r||a?(n.labelHighlights=s,n.descriptionHighlights=r,n.detailHighlights=a,n.hidden=!1):(n.labelHighlights=void 0,n.descriptionHighlights=void 0,n.detailHighlights=void 0,n.hidden=n.item?!n.item.alwaysShow:!0),n.item?n.separator=void 0:n.separator&&(n.hidden=!0),!this.sortByLabel){const l=n.index&&this._inputElements[n.index-1]||void 0;l?.type==="separator"&&!l.buttons&&(i=l),i&&!n.hidden&&(n.separator=i,i=void 0)}})}return this._setElementsToTree(this._sortByLabel&&e?this._itemElements:this._elementTree),this._tree.layout(),!0}toggleCheckbox(){this._elementCheckedEventBufferer.bufferEvents(()=>{const e=this._tree.getFocus().filter(i=>i instanceof vn),t=this._allVisibleChecked(e);for(const i of e)i.checkboxDisabled||(i.checked=!t)})}style(e){this._tree.style(e)}toggleHover(){const e=this._tree.getFocus()[0];if(!e?.saneTooltip||!(e instanceof vn))return;if(this._lastHover&&!this._lastHover.isDisposed){this._lastHover.dispose();return}this.showHover(e);const t=new $;t.add(this._tree.onDidChangeFocus(i=>{i.elements[0]instanceof vn&&this.showHover(i.elements[0])})),this._lastHover&&t.add(this._lastHover),this._elementDisposable.add(t)}_setElementsToTree(e){const t=new Array;for(const i of e)i instanceof Lu?t.push({element:i,collapsible:!1,collapsed:!1,children:i.children.map(n=>({element:n,collapsible:!1,collapsed:!1}))}):t.push({element:i,collapsible:!1,collapsed:!1});this._tree.setChildren(null,t)}_allVisibleChecked(e,t=!0){for(let i=0,n=e.length;i<n;i++){const s=e[i];if(!s.hidden)if(s.checked)t=!0;else return!1}return t}_updateCheckedObservables(){oi(e=>{this._allVisibleCheckedObservable.set(this._allVisibleChecked(this._itemElements,!1),e);const t=this._itemElements.filter(i=>i.checked).length;this._checkedCountObservable.set(t,e),this._checkedElementsObservable.set(this.getCheckedElements(),e)})}showHover(e){this._lastHover&&!this._lastHover.isDisposed&&(this.hoverDelegate.onDidHideHover?.(),this._lastHover?.dispose()),!(!e.element||!e.saneTooltip)&&(this._lastHover=this.hoverDelegate.showHover({content:e.saneTooltip,target:e.element,linkHandler:t=>{this.linkOpenerDelegate(t)},appearance:{showPointer:!0},container:this._container,position:{hoverPosition:1}},!1))}};eD([Ti],Ey.prototype,"onDidChangeFocus",null);eD([Ti],Ey.prototype,"onDidChangeSelection",null);Ey=eD([cM(4,Ce),cM(5,ho)],Ey);function dge(o,e){const{text:t,iconOffsets:i}=e;if(!i||i.length===0)return N7(o,t);const n=yw(t," "),s=t.length-n.length,r=N7(o,n);if(r)for(const a of r){const l=i[a.start+s]+s;a.start+=l,a.end+=l}return r}function N7(o,e){const t=e.toLowerCase().indexOf(o.toLowerCase());return t!==-1?[{start:t,end:t+o.length}]:null}function hge(o,e,t){const i=o.labelHighlights||[],n=e.labelHighlights||[];return i.length&&!n.length?-1:!i.length&&n.length?1:i.length===0&&n.length===0?0:rge(o.saneSortLabel,e.saneSortLabel,t)}const vK={weight:200,when:K.and(K.equals(U$,"quickPick"),Whe),metadata:{description:p("quickPick","Used while in the context of the quick pick. If you change one keybinding for this command, you should change all of the other keybindings (modifier variants) of this command as well.")}};function js(o,e={}){fs.registerCommandAndKeybindingRule({...vK,...o,secondary:uge(o.primary,o.secondary??[],e)})}const Bx=Qe?256:2048;function uge(o,e,t={}){return t.withAltMod&&e.push(512+o),t.withCtrlMod&&(e.push(Bx+o),t.withAltMod&&e.push(512+Bx+o)),t.withCmdMod&&Qe&&(e.push(2048+o),t.withCtrlMod&&e.push(2304+o),t.withAltMod&&(e.push(2560+o),t.withCtrlMod&&e.push(2816+o))),e}function wo(o,e){return t=>{const i=t.get(vr).currentQuickInput;if(i)return e&&i.quickNavigate?i.focus(e):i.focus(o)}}js({id:"quickInput.pageNext",primary:12,handler:wo(Wt.NextPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});js({id:"quickInput.pagePrevious",primary:11,handler:wo(Wt.PreviousPage)},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});js({id:"quickInput.first",primary:Bx+14,handler:wo(Wt.First)},{withAltMod:!0,withCmdMod:!0});js({id:"quickInput.last",primary:Bx+13,handler:wo(Wt.Last)},{withAltMod:!0,withCmdMod:!0});js({id:"quickInput.next",primary:18,handler:wo(Wt.Next)},{withCtrlMod:!0});js({id:"quickInput.previous",primary:16,handler:wo(Wt.Previous)},{withCtrlMod:!0});const R7=p("quickInput.nextSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the next item. If we are not in quick access mode, this will navigate to the next separator."),P7=p("quickInput.previousSeparatorWithQuickAccessFallback","If we're in quick access mode, this will navigate to the previous item. If we are not in quick access mode, this will navigate to the previous separator.");Qe?(js({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:2066,handler:wo(Wt.NextSeparator,Wt.Next),metadata:{description:R7}}),js({id:"quickInput.nextSeparator",primary:2578,secondary:[2322],handler:wo(Wt.NextSeparator)},{withCtrlMod:!0}),js({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:2064,handler:wo(Wt.PreviousSeparator,Wt.Previous),metadata:{description:P7}}),js({id:"quickInput.previousSeparator",primary:2576,secondary:[2320],handler:wo(Wt.PreviousSeparator)},{withCtrlMod:!0})):(js({id:"quickInput.nextSeparatorWithQuickAccessFallback",primary:530,handler:wo(Wt.NextSeparator,Wt.Next),metadata:{description:R7}}),js({id:"quickInput.nextSeparator",primary:2578,handler:wo(Wt.NextSeparator)}),js({id:"quickInput.previousSeparatorWithQuickAccessFallback",primary:528,handler:wo(Wt.PreviousSeparator,Wt.Previous),metadata:{description:P7}}),js({id:"quickInput.previousSeparator",primary:2576,handler:wo(Wt.PreviousSeparator)}));js({id:"quickInput.acceptInBackground",when:K.and(vK.when,K.or(aK.negate(),zhe)),primary:17,weight:250,handler:o=>{o.get(vr).currentQuickInput?.accept(!0)}},{withAltMod:!0,withCtrlMod:!0,withCmdMod:!0});var gge=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},YI=function(o,e){return function(t,i){e(t,i,o)}},hM;const Us=ie;var yg;let uM=(yg=class extends F{get currentQuickInput(){return this.controller??void 0}get container(){return this._container}constructor(e,t,i,n){super(),this.options=e,this.layoutService=t,this.instantiationService=i,this.contextKeyService=n,this.enabled=!0,this.onDidAcceptEmitter=this._register(new O),this.onDidCustomEmitter=this._register(new O),this.onDidTriggerButtonEmitter=this._register(new O),this.keyMods={ctrlCmd:!1,alt:!1},this.controller=null,this.onShowEmitter=this._register(new O),this.onShow=this.onShowEmitter.event,this.onHideEmitter=this._register(new O),this.onHide=this.onHideEmitter.event,this.inQuickInputContext=Bhe.bindTo(this.contextKeyService),this.quickInputTypeContext=Vhe.bindTo(this.contextKeyService),this.endOfQuickInputBoxContext=Hhe.bindTo(this.contextKeyService),this.idPrefix=e.idPrefix,this._container=e.container,this.styles=e.styles,this._register(se.runAndSubscribe(rT,({window:s,disposables:r})=>this.registerKeyModsListeners(s,r),{window:It,disposables:this._store})),this._register(zJ(s=>{this.ui&&xe(this.ui.container)===s&&(this.reparentUI(this.layoutService.mainContainer),this.layout(this.layoutService.mainContainerDimension,this.layoutService.mainContainerOffset.quickPickTop))}))}registerKeyModsListeners(e,t){const i=n=>{this.keyMods.ctrlCmd=n.ctrlKey||n.metaKey,this.keyMods.alt=n.altKey};for(const n of[ee.KEY_DOWN,ee.KEY_UP,ee.MOUSE_DOWN])t.add(H(e,n,i,!0))}getUI(e){if(this.ui)return e&&xe(this._container)!==xe(this.layoutService.activeContainer)&&(this.reparentUI(this.layoutService.activeContainer),this.layout(this.layoutService.activeContainerDimension,this.layoutService.activeContainerOffset.quickPickTop)),this.ui;const t=Y(this._container,Us(".quick-input-widget.show-file-icons"));t.tabIndex=-1,t.style.display="none";const i=Bo(t),n=Y(t,Us(".quick-input-titlebar")),s=this._register(new Oo(n,{hoverDelegate:this.options.hoverDelegate}));s.domNode.classList.add("quick-input-left-action-bar");const r=Y(n,Us(".quick-input-title")),a=this._register(new Oo(n,{hoverDelegate:this.options.hoverDelegate}));a.domNode.classList.add("quick-input-right-action-bar");const l=Y(t,Us(".quick-input-header")),c=Y(l,Us("input.quick-input-check-all"));c.type="checkbox",c.setAttribute("aria-label",p("quickInput.checkAll","Toggle all checkboxes")),this._register(ci(c,ee.CHANGE,V=>{const Q=c.checked;U.setAllVisibleChecked(Q)})),this._register(H(c,ee.CLICK,V=>{(V.x||V.y)&&g.setFocus()}));const d=Y(l,Us(".quick-input-description")),h=Y(l,Us(".quick-input-and-message")),u=Y(h,Us(".quick-input-filter")),g=this._register(new Qhe(u,this.styles.inputBox,this.styles.toggle));g.setAttribute("aria-describedby",`${this.idPrefix}message`);const f=Y(u,Us(".quick-input-visible-count"));f.setAttribute("aria-live","polite"),f.setAttribute("aria-atomic","true");const m=new eM(f,{countFormat:p({key:"quickInput.visibleCount",comment:["This tells the user how many items are shown in a list of items to select from. The items can be anything. Currently not visible, but read by screen readers."]},"{0} Results")},this.styles.countBadge),_=Y(u,Us(".quick-input-count"));_.setAttribute("aria-live","polite");const b=new eM(_,{countFormat:p({key:"quickInput.countSelected",comment:["This tells the user how many items are selected in a list of items to select from. The items can be anything."]},"{0} Selected")},this.styles.countBadge),v=this._register(new Oo(l,{hoverDelegate:this.options.hoverDelegate}));v.domNode.classList.add("quick-input-inline-action-bar");const y=Y(l,Us(".quick-input-action")),C=this._register(new Lx(y,this.styles.button));C.label=p("ok","OK"),this._register(C.onDidClick(V=>{this.onDidAcceptEmitter.fire()}));const w=Y(l,Us(".quick-input-action")),x=this._register(new Lx(w,{...this.styles.button,supportIcons:!0}));x.label=p("custom","Custom"),this._register(x.onDidClick(V=>{this.onDidCustomEmitter.fire()}));const k=Y(h,Us(`#${this.idPrefix}message.quick-input-message`)),E=this._register(new tM(t,this.styles.progressBar));E.getContainer().classList.add("quick-input-progress");const N=Y(t,Us(".quick-input-html-widget"));N.tabIndex=-1;const z=Y(t,Us(".quick-input-description")),B=this.idPrefix+"list",U=this._register(this.instantiationService.createInstance(Ey,t,this.options.hoverDelegate,this.options.linkOpenerDelegate,B));g.setAttribute("aria-controls",B),this._register(U.onDidChangeFocus(()=>{g.setAttribute("aria-activedescendant",U.getActiveDescendant()??"")})),this._register(U.onChangedAllVisibleChecked(V=>{c.checked=V})),this._register(U.onChangedVisibleCount(V=>{m.setCount(V)})),this._register(U.onChangedCheckedCount(V=>{b.setCount(V)})),this._register(U.onLeave(()=>{setTimeout(()=>{this.controller&&(g.setFocus(),this.controller instanceof xx&&this.controller.canSelectMany&&U.clearFocus())},0)}));const Z=Ia(t);return this._register(Z),this._register(H(t,ee.FOCUS,V=>{const Q=this.getUI();if(Ki(V.relatedTarget,Q.inputContainer)){const le=Q.inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==le&&this.endOfQuickInputBoxContext.set(le)}Ki(V.relatedTarget,Q.container)||(this.inQuickInputContext.set(!0),this.previousFocusElement=qi(V.relatedTarget)?V.relatedTarget:void 0)},!0)),this._register(Z.onDidBlur(()=>{!this.getUI().ignoreFocusOut&&!this.options.ignoreFocusOut()&&this.hide(N_.Blur),this.inQuickInputContext.set(!1),this.endOfQuickInputBoxContext.set(!1),this.previousFocusElement=void 0})),this._register(g.onKeyDown(V=>{const Q=this.getUI().inputBox.isSelectionAtEnd();this.endOfQuickInputBoxContext.get()!==Q&&this.endOfQuickInputBoxContext.set(Q)})),this._register(H(t,ee.FOCUS,V=>{g.setFocus()})),this._register(ci(t,ee.KEY_DOWN,V=>{if(!Ki(V.target,N))switch(V.keyCode){case 3:tt.stop(V,!0),this.enabled&&this.onDidAcceptEmitter.fire();break;case 9:tt.stop(V,!0),this.hide(N_.Gesture);break;case 2:if(!V.altKey&&!V.ctrlKey&&!V.metaKey){const Q=[".quick-input-list .monaco-action-bar .always-visible",".quick-input-list-entry:hover .monaco-action-bar",".monaco-list-row.focused .monaco-action-bar"];if(t.classList.contains("show-checkboxes")?Q.push("input"):Q.push("input[type=text]"),this.getUI().list.displayed&&Q.push(".monaco-list"),this.getUI().message&&Q.push(".quick-input-message a"),this.getUI().widget){if(Ki(V.target,this.getUI().widget))break;Q.push(".quick-input-html-widget")}const le=t.querySelectorAll(Q.join(", "));V.shiftKey&&V.target===le[0]?(tt.stop(V,!0),U.clearFocus()):!V.shiftKey&&Ki(V.target,le[le.length-1])&&(tt.stop(V,!0),le[0].focus())}break;case 10:V.ctrlKey&&(tt.stop(V,!0),this.getUI().list.toggleHover());break}})),this.ui={container:t,styleSheet:i,leftActionBar:s,titleBar:n,title:r,description1:z,description2:d,widget:N,rightActionBar:a,inlineActionBar:v,checkAll:c,inputContainer:h,filterContainer:u,inputBox:g,visibleCountContainer:f,visibleCount:m,countContainer:_,count:b,okContainer:y,ok:C,message:k,customButtonContainer:w,customButton:x,list:U,progressBar:E,onDidAccept:this.onDidAcceptEmitter.event,onDidCustom:this.onDidCustomEmitter.event,onDidTriggerButton:this.onDidTriggerButtonEmitter.event,ignoreFocusOut:!1,keyMods:this.keyMods,show:V=>this.show(V),hide:()=>this.hide(),setVisibilities:V=>this.setVisibilities(V),setEnabled:V=>this.setEnabled(V),setContextKey:V=>this.options.setContextKey(V),linkOpenerDelegate:V=>this.options.linkOpenerDelegate(V)},this.updateStyles(),this.ui}reparentUI(e){this.ui&&(this._container=e,Y(this._container,this.ui.container))}pick(e,t={},i=He.None){return new Promise((n,s)=>{let r=d=>{r=n,t.onKeyMods?.(a.keyMods),n(d)};if(i.isCancellationRequested){r(void 0);return}const a=this.createQuickPick({useSeparators:!0});let l;const c=[a,a.onDidAccept(()=>{if(a.canSelectMany)r(a.selectedItems.slice()),a.hide();else{const d=a.activeItems[0];d&&(r(d),a.hide())}}),a.onDidChangeActive(d=>{const h=d[0];h&&t.onDidFocus&&t.onDidFocus(h)}),a.onDidChangeSelection(d=>{if(!a.canSelectMany){const h=d[0];h&&(r(h),a.hide())}}),a.onDidTriggerItemButton(d=>t.onDidTriggerItemButton&&t.onDidTriggerItemButton({...d,removeItem:()=>{const h=a.items.indexOf(d.item);if(h!==-1){const u=a.items.slice(),g=u.splice(h,1),f=a.activeItems.filter(_=>_!==g[0]),m=a.keepScrollPosition;a.keepScrollPosition=!0,a.items=u,f&&(a.activeItems=f),a.keepScrollPosition=m}}})),a.onDidTriggerSeparatorButton(d=>t.onDidTriggerSeparatorButton?.(d)),a.onDidChangeValue(d=>{l&&!d&&(a.activeItems.length!==1||a.activeItems[0]!==l)&&(a.activeItems=[l])}),i.onCancellationRequested(()=>{a.hide()}),a.onDidHide(()=>{Dt(c),r(void 0)})];a.title=t.title,t.value&&(a.value=t.value),a.canSelectMany=!!t.canPickMany,a.placeholder=t.placeHolder,a.ignoreFocusOut=!!t.ignoreFocusLost,a.matchOnDescription=!!t.matchOnDescription,a.matchOnDetail=!!t.matchOnDetail,a.matchOnLabel=t.matchOnLabel===void 0||t.matchOnLabel,a.quickNavigate=t.quickNavigate,a.hideInput=!!t.hideInput,a.contextKey=t.contextKey,a.busy=!0,Promise.all([e,t.activeItem]).then(([d,h])=>{l=h,a.busy=!1,a.items=d,a.canSelectMany&&(a.selectedItems=d.filter(u=>u.type!=="separator"&&u.picked)),l&&(a.activeItems=[l])}),a.show(),Promise.resolve(e).then(void 0,d=>{s(d),a.hide()})})}createQuickPick(e={useSeparators:!1}){const t=this.getUI(!0);return new xx(t)}createInputBox(){const e=this.getUI(!0);return new Uhe(e)}show(e){const t=this.getUI(!0);this.onShowEmitter.fire();const i=this.controller;this.controller=e,i?.didHide(),this.setEnabled(!0),t.leftActionBar.clear(),t.title.textContent="",t.description1.textContent="",t.description2.textContent="",pn(t.widget),t.rightActionBar.clear(),t.inlineActionBar.clear(),t.checkAll.checked=!1,t.inputBox.placeholder="",t.inputBox.password=!1,t.inputBox.showDecoration(ki.Ignore),t.visibleCount.setCount(0),t.count.setCount(0),pn(t.message),t.progressBar.stop(),t.list.setElements([]),t.list.matchOnDescription=!1,t.list.matchOnDetail=!1,t.list.matchOnLabel=!0,t.list.sortByLabel=!0,t.ignoreFocusOut=!1,t.inputBox.toggles=void 0;const n=this.options.backKeybindingLabel();QA.tooltip=n?p("quickInput.backWithKeybinding","Back ({0})",n):p("quickInput.back","Back"),t.container.style.display="",this.updateLayout(),t.inputBox.setFocus(),this.quickInputTypeContext.set(e.type)}isVisible(){return!!this.ui&&this.ui.container.style.display!=="none"}setVisibilities(e){const t=this.getUI();t.title.style.display=e.title?"":"none",t.description1.style.display=e.description&&(e.inputBox||e.checkAll)?"":"none",t.description2.style.display=e.description&&!(e.inputBox||e.checkAll)?"":"none",t.checkAll.style.display=e.checkAll?"":"none",t.inputContainer.style.display=e.inputBox?"":"none",t.filterContainer.style.display=e.inputBox?"":"none",t.visibleCountContainer.style.display=e.visibleCount?"":"none",t.countContainer.style.display=e.count?"":"none",t.okContainer.style.display=e.ok?"":"none",t.customButtonContainer.style.display=e.customButton?"":"none",t.message.style.display=e.message?"":"none",t.progressBar.getContainer().style.display=e.progressBar?"":"none",t.list.displayed=!!e.list,t.container.classList.toggle("show-checkboxes",!!e.checkBox),t.container.classList.toggle("hidden-input",!e.inputBox&&!e.description),this.updateLayout()}setEnabled(e){if(e!==this.enabled){this.enabled=e;for(const t of this.getUI().leftActionBar.viewItems)t.action.enabled=e;for(const t of this.getUI().rightActionBar.viewItems)t.action.enabled=e;this.getUI().checkAll.disabled=!e,this.getUI().inputBox.enabled=e,this.getUI().ok.enabled=e,this.getUI().list.enabled=e}}hide(e){const t=this.controller;if(!t)return;t.willHide(e);const i=this.ui?.container,n=i&&!Xz(i);if(this.controller=null,this.onHideEmitter.fire(),i&&(i.style.display="none"),!n){let s=this.previousFocusElement;for(;s&&!s.offsetParent;)s=s.parentElement??void 0;s?.offsetParent?(s.focus(),this.previousFocusElement=void 0):this.options.returnFocus()}t.didHide(e)}layout(e,t){this.dimension=e,this.titleBarOffset=t,this.updateLayout()}updateLayout(){if(this.ui&&this.isVisible()){this.ui.container.style.top=`${this.titleBarOffset}px`;const e=this.ui.container.style,t=Math.min(this.dimension.width*.62,hM.MAX_WIDTH);e.width=t+"px",e.marginLeft="-"+t/2+"px",this.ui.inputBox.layout(),this.ui.list.layout(this.dimension&&this.dimension.height*.4)}}applyStyles(e){this.styles=e,this.updateStyles()}updateStyles(){if(this.ui){const{quickInputTitleBackground:e,quickInputBackground:t,quickInputForeground:i,widgetBorder:n,widgetShadow:s}=this.styles.widget;this.ui.titleBar.style.backgroundColor=e??"",this.ui.container.style.backgroundColor=t??"",this.ui.container.style.color=i??"",this.ui.container.style.border=n?`1px solid ${n}`:"",this.ui.container.style.boxShadow=s?`0 0 8px 2px ${s}`:"",this.ui.list.style(this.styles.list);const r=[];this.styles.pickerGroup.pickerGroupBorder&&r.push(`.quick-input-list .quick-input-list-entry { border-top-color:  ${this.styles.pickerGroup.pickerGroupBorder}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(`.quick-input-list .quick-input-list-separator { color:  ${this.styles.pickerGroup.pickerGroupForeground}; }`),this.styles.pickerGroup.pickerGroupForeground&&r.push(".quick-input-list .quick-input-list-separator-as-item { color: var(--vscode-descriptionForeground); }"),(this.styles.keybindingLabel.keybindingLabelBackground||this.styles.keybindingLabel.keybindingLabelBorder||this.styles.keybindingLabel.keybindingLabelBottomBorder||this.styles.keybindingLabel.keybindingLabelShadow||this.styles.keybindingLabel.keybindingLabelForeground)&&(r.push(".quick-input-list .monaco-keybinding > .monaco-keybinding-key {"),this.styles.keybindingLabel.keybindingLabelBackground&&r.push(`background-color: ${this.styles.keybindingLabel.keybindingLabelBackground};`),this.styles.keybindingLabel.keybindingLabelBorder&&r.push(`border-color: ${this.styles.keybindingLabel.keybindingLabelBorder};`),this.styles.keybindingLabel.keybindingLabelBottomBorder&&r.push(`border-bottom-color: ${this.styles.keybindingLabel.keybindingLabelBottomBorder};`),this.styles.keybindingLabel.keybindingLabelShadow&&r.push(`box-shadow: inset 0 -1px 0 ${this.styles.keybindingLabel.keybindingLabelShadow};`),this.styles.keybindingLabel.keybindingLabelForeground&&r.push(`color: ${this.styles.keybindingLabel.keybindingLabelForeground};`),r.push("}"));const a=r.join(`
`);a!==this.ui.styleSheet.textContent&&(this.ui.styleSheet.textContent=a)}}},hM=yg,yg.MAX_WIDTH=600,yg);uM=hM=gge([YI(1,qh),YI(2,Ce),YI(3,Ee)],uM);var fge=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Qb=function(o,e){return function(t,i){e(t,i,o)}};let gM=class extends one{get controller(){return this._controller||(this._controller=this._register(this.createController())),this._controller}get hasController(){return!!this._controller}get currentQuickInput(){return this.controller.currentQuickInput}get quickAccess(){return this._quickAccess||(this._quickAccess=this._register(this.instantiationService.createInstance(XA))),this._quickAccess}constructor(e,t,i,n,s){super(i),this.instantiationService=e,this.contextKeyService=t,this.layoutService=n,this.configurationService=s,this._onShow=this._register(new O),this._onHide=this._register(new O),this.contexts=new Map}createController(e=this.layoutService,t){const i={idPrefix:"quickInput_",container:e.activeContainer,ignoreFocusOut:()=>!1,backKeybindingLabel:()=>{},setContextKey:s=>this.setContextKey(s),linkOpenerDelegate:s=>{this.instantiationService.invokeFunction(r=>{r.get(Fs).open(s,{allowCommands:!0,fromUserGesture:!0})})},returnFocus:()=>e.focus(),styles:this.computeStyles(),hoverDelegate:this._register(this.instantiationService.createInstance(JA))},n=this._register(this.instantiationService.createInstance(uM,{...i,...t}));return n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop),this._register(e.onDidLayoutActiveContainer(s=>{xe(e.activeContainer)===xe(n.container)&&n.layout(s,e.activeContainerOffset.quickPickTop)})),this._register(e.onDidChangeActiveContainer(()=>{n.isVisible()||n.layout(e.activeContainerDimension,e.activeContainerOffset.quickPickTop)})),this._register(n.onShow(()=>{this.resetContextKeys(),this._onShow.fire()})),this._register(n.onHide(()=>{this.resetContextKeys(),this._onHide.fire()})),n}setContextKey(e){let t;e&&(t=this.contexts.get(e),t||(t=new re(e,!1).bindTo(this.contextKeyService),this.contexts.set(e,t))),!(t&&t.get())&&(this.resetContextKeys(),t?.set(!0))}resetContextKeys(){this.contexts.forEach(e=>{e.get()&&e.reset()})}pick(e,t,i=He.None){return this.controller.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.controller.createQuickPick(e)}createInputBox(){return this.controller.createInputBox()}updateStyles(){this.hasController&&this.controller.applyStyles(this.computeStyles())}computeStyles(){return{widget:{quickInputBackground:ce(rH),quickInputForeground:ce(yoe),quickInputTitleBackground:ce(woe),widgetBorder:ce(aG),widgetShadow:ce(lb)},inputBox:gx,toggle:ux,countBadge:o$,button:ice,progressBar:nce,keybindingLabel:tce,list:Zf({listBackground:rH,listFocusBackground:cy,listFocusForeground:ly,listInactiveFocusForeground:ly,listInactiveSelectionIconForeground:_5,listInactiveFocusBackground:cy,listFocusOutline:qt,listInactiveFocusOutline:qt}),pickerGroup:{pickerGroupBorder:ce(Soe),pickerGroupForeground:ce(_G)}}}};gM=fge([Qb(0,Ce),Qb(1,Ee),Qb(2,zi),Qb(3,qh),Qb(4,Ke)],gM);var CK=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Wu=function(o,e){return function(t,i){e(t,i,o)}};let fM=class extends gM{constructor(e,t,i,n,s,r){super(t,i,n,new AP(e.getContainerDomNode(),s),r),this.host=void 0;const a=Ty.get(e);if(a){const l=a.widget;this.host={_serviceBrand:void 0,get mainContainer(){return l.getDomNode()},getContainer(){return l.getDomNode()},whenContainerStylesLoaded(){},get containers(){return[l.getDomNode()]},get activeContainer(){return l.getDomNode()},get mainContainerDimension(){return e.getLayoutInfo()},get activeContainerDimension(){return e.getLayoutInfo()},get onDidLayoutMainContainer(){return e.onDidLayoutChange},get onDidLayoutActiveContainer(){return e.onDidLayoutChange},get onDidLayoutContainer(){return se.map(e.onDidLayoutChange,c=>({container:l.getDomNode(),dimension:c}))},get onDidChangeActiveContainer(){return se.None},get onDidAddContainer(){return se.None},get mainContainerOffset(){return{top:0,quickPickTop:0}},get activeContainerOffset(){return{top:0,quickPickTop:0}},focus:()=>e.focus()}}else this.host=void 0}createController(){return super.createController(this.host)}};fM=CK([Wu(1,Ce),Wu(2,Ee),Wu(3,zi),Wu(4,gt),Wu(5,Ke)],fM);let pM=class{get activeService(){const e=this.codeEditorService.getFocusedCodeEditor();if(!e)throw new Error("Quick input service needs a focused editor to work.");let t=this.mapEditorToService.get(e);if(!t){const i=t=this.instantiationService.createInstance(fM,e);this.mapEditorToService.set(e,t),Eh(e.onDidDispose)(()=>{i.dispose(),this.mapEditorToService.delete(e)})}return t}get currentQuickInput(){return this.activeService.currentQuickInput}get quickAccess(){return this.activeService.quickAccess}constructor(e,t){this.instantiationService=e,this.codeEditorService=t,this.mapEditorToService=new Map}pick(e,t,i=He.None){return this.activeService.pick(e,t,i)}createQuickPick(e={useSeparators:!1}){return this.activeService.createQuickPick(e)}createInputBox(){return this.activeService.createInputBox()}};pM=CK([Wu(0,Ce),Wu(1,gt)],pM);const Hk=class Hk{static get(e){return e.getContribution(Hk.ID)}constructor(e){this.editor=e,this.widget=new mM(this.editor)}dispose(){this.widget.dispose()}};Hk.ID="editor.controller.quickInput";let Ty=Hk;const zk=class zk{constructor(e){this.codeEditor=e,this.domNode=document.createElement("div"),this.codeEditor.addOverlayWidget(this)}getId(){return zk.ID}getDomNode(){return this.domNode}getPosition(){return{preference:2}}dispose(){this.codeEditor.removeOverlayWidget(this)}};zk.ID="editor.contrib.quickInputWidget";let mM=zk;at(Ty.ID,Ty,4);class pge{constructor(e,t,i,n,s){this._parsedThemeRuleBrand=void 0,this.token=e,this.index=t,this.fontStyle=i,this.foreground=n,this.background=s}}function mge(o){if(!o||!Array.isArray(o))return[];const e=[];let t=0;for(let i=0,n=o.length;i<n;i++){const s=o[i];let r=-1;if(typeof s.fontStyle=="string"){r=0;const c=s.fontStyle.split(" ");for(let d=0,h=c.length;d<h;d++)switch(c[d]){case"italic":r=r|1;break;case"bold":r=r|2;break;case"underline":r=r|4;break;case"strikethrough":r=r|8;break}}let a=null;typeof s.foreground=="string"&&(a=s.foreground);let l=null;typeof s.background=="string"&&(l=s.background),e[t++]=new pge(s.token||"",i,r,a,l)}return e}function _ge(o,e){o.sort((d,h)=>{const u=wge(d.token,h.token);return u!==0?u:d.index-h.index});let t=0,i="000000",n="ffffff";for(;o.length>=1&&o[0].token==="";){const d=o.shift();d.fontStyle!==-1&&(t=d.fontStyle),d.foreground!==null&&(i=d.foreground),d.background!==null&&(n=d.background)}const s=new vge;for(const d of e)s.getId(d);const r=s.getId(i),a=s.getId(n),l=new _B(t,r,a),c=new bB(l);for(let d=0,h=o.length;d<h;d++){const u=o[d];c.insert(u.token,u.fontStyle,s.getId(u.foreground),s.getId(u.background))}return new yK(s,c)}const bge=/^#?([0-9A-Fa-f]{6})([0-9A-Fa-f]{2})?$/;class vge{constructor(){this._lastColorId=0,this._id2color=[],this._color2id=new Map}getId(e){if(e===null)return 0;const t=e.match(bge);if(!t)throw new Error("Illegal value for token color: "+e);e=t[1].toUpperCase();let i=this._color2id.get(e);return i||(i=++this._lastColorId,this._color2id.set(e,i),this._id2color[i]=j.fromHex("#"+e),i)}getColorMap(){return this._id2color.slice(0)}}class yK{static createFromRawTokenTheme(e,t){return this.createFromParsedTokenTheme(mge(e),t)}static createFromParsedTokenTheme(e,t){return _ge(e,t)}constructor(e,t){this._colorMap=e,this._root=t,this._cache=new Map}getColorMap(){return this._colorMap.getColorMap()}_match(e){return this._root.match(e)}match(e,t){let i=this._cache.get(t);if(typeof i>"u"){const n=this._match(t),s=yge(t);i=(n.metadata|s<<8)>>>0,this._cache.set(t,i)}return(i|e<<0)>>>0}}const Cge=/\b(comment|string|regex|regexp)\b/;function yge(o){const e=o.match(Cge);if(!e)return 0;switch(e[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"regexp":return 3}throw new Error("Unexpected match for standard token type!")}function wge(o,e){return o<e?-1:o>e?1:0}class _B{constructor(e,t,i){this._themeTrieElementRuleBrand=void 0,this._fontStyle=e,this._foreground=t,this._background=i,this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}clone(){return new _B(this._fontStyle,this._foreground,this._background)}acceptOverwrite(e,t,i){e!==-1&&(this._fontStyle=e),t!==0&&(this._foreground=t),i!==0&&(this._background=i),this.metadata=(this._fontStyle<<11|this._foreground<<15|this._background<<24)>>>0}}class bB{constructor(e){this._themeTrieElementBrand=void 0,this._mainRule=e,this._children=new Map}match(e){if(e==="")return this._mainRule;const t=e.indexOf(".");let i,n;t===-1?(i=e,n=""):(i=e.substring(0,t),n=e.substring(t+1));const s=this._children.get(i);return typeof s<"u"?s.match(n):this._mainRule}insert(e,t,i,n){if(e===""){this._mainRule.acceptOverwrite(t,i,n);return}const s=e.indexOf(".");let r,a;s===-1?(r=e,a=""):(r=e.substring(0,s),a=e.substring(s+1));let l=this._children.get(r);typeof l>"u"&&(l=new bB(this._mainRule.clone()),this._children.set(r,l)),l.insert(a,t,i,n)}}function Sge(o){const e=[];for(let t=1,i=o.length;t<i;t++){const n=o[t];e[t]=`.mtk${t} { color: ${n}; }`}return e.push(".mtki { font-style: italic; }"),e.push(".mtkb { font-weight: bold; }"),e.push(".mtku { text-decoration: underline; text-underline-position: under; }"),e.push(".mtks { text-decoration: line-through; }"),e.push(".mtks.mtku { text-decoration: underline line-through; text-underline-position: under; }"),e.join(`
`)}const xge={base:"vs",inherit:!1,rules:[{token:"",foreground:"000000",background:"fffffe"},{token:"invalid",foreground:"cd3131"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"001188"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"delimiter.xml",foreground:"0000FF"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"FF0000"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"FF0000"},{token:"attribute.value",foreground:"0451A5"},{token:"attribute.value.number",foreground:"098658"},{token:"attribute.value.unit",foreground:"098658"},{token:"attribute.value.html",foreground:"0000FF"},{token:"attribute.value.xml",foreground:"0000FF"},{token:"string",foreground:"A31515"},{token:"string.html",foreground:"0000FF"},{token:"string.sql",foreground:"FF0000"},{token:"string.yaml",foreground:"0451A5"},{token:"keyword",foreground:"0000FF"},{token:"keyword.json",foreground:"0451A5"},{token:"keyword.flow",foreground:"AF00DB"},{token:"keyword.flow.scss",foreground:"0000FF"},{token:"operator.scss",foreground:"666666"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[$r]:"#FFFFFE",[Hl]:"#000000",[oG]:"#E5EBF1",[Hw]:"#D3D3D3",[zw]:"#939393",[h5]:"#ADD6FF4D"}},Lge={base:"vs-dark",inherit:!1,rules:[{token:"",foreground:"D4D4D4",background:"1E1E1E"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"74B0DF"},{token:"variable.predefined",foreground:"4864AA"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"B5CEA8"},{token:"number.hex",foreground:"5BB498"},{token:"regexp",foreground:"B46695"},{token:"annotation",foreground:"cc6666"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"DCDCDC"},{token:"delimiter.html",foreground:"808080"},{token:"delimiter.xml",foreground:"808080"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"A79873"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"DD6A6F"},{token:"metatag.content.html",foreground:"9CDCFE"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key.json",foreground:"9CDCFE"},{token:"string.value.json",foreground:"CE9178"},{token:"attribute.name",foreground:"9CDCFE"},{token:"attribute.value",foreground:"CE9178"},{token:"attribute.value.number.css",foreground:"B5CEA8"},{token:"attribute.value.unit.css",foreground:"B5CEA8"},{token:"attribute.value.hex.css",foreground:"D4D4D4"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"keyword.json",foreground:"CE9178"},{token:"keyword.flow.scss",foreground:"569CD6"},{token:"operator.scss",foreground:"909090"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[$r]:"#1E1E1E",[Hl]:"#D4D4D4",[oG]:"#3A3D41",[Hw]:"#404040",[zw]:"#707070",[h5]:"#ADD6FF26"}},kge={base:"hc-black",inherit:!1,rules:[{token:"",foreground:"FFFFFF",background:"000000"},{token:"invalid",foreground:"f44747"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"1AEBFF"},{token:"variable.parameter",foreground:"9CDCFE"},{token:"constant",foreground:"569CD6"},{token:"comment",foreground:"608B4E"},{token:"number",foreground:"FFFFFF"},{token:"regexp",foreground:"C0C0C0"},{token:"annotation",foreground:"569CD6"},{token:"type",foreground:"3DC9B0"},{token:"delimiter",foreground:"FFFF00"},{token:"delimiter.html",foreground:"FFFF00"},{token:"tag",foreground:"569CD6"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta",foreground:"D4D4D4"},{token:"meta.tag",foreground:"CE9178"},{token:"metatag",foreground:"569CD6"},{token:"metatag.content.html",foreground:"1AEBFF"},{token:"metatag.html",foreground:"569CD6"},{token:"metatag.xml",foreground:"569CD6"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"9CDCFE"},{token:"string.key",foreground:"9CDCFE"},{token:"string.value",foreground:"CE9178"},{token:"attribute.name",foreground:"569CD6"},{token:"attribute.value",foreground:"3FF23F"},{token:"string",foreground:"CE9178"},{token:"string.sql",foreground:"FF0000"},{token:"keyword",foreground:"569CD6"},{token:"keyword.flow",foreground:"C586C0"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"909090"},{token:"predefined.sql",foreground:"FF00FF"}],colors:{[$r]:"#000000",[Hl]:"#FFFFFF",[Hw]:"#FFFFFF",[zw]:"#FFFFFF"}},Ege={base:"hc-light",inherit:!1,rules:[{token:"",foreground:"292929",background:"FFFFFF"},{token:"invalid",foreground:"B5200D"},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:"264F70"},{token:"variable.predefined",foreground:"4864AA"},{token:"constant",foreground:"dd0000"},{token:"comment",foreground:"008000"},{token:"number",foreground:"098658"},{token:"number.hex",foreground:"3030c0"},{token:"regexp",foreground:"800000"},{token:"annotation",foreground:"808080"},{token:"type",foreground:"008080"},{token:"delimiter",foreground:"000000"},{token:"delimiter.html",foreground:"383838"},{token:"tag",foreground:"800000"},{token:"tag.id.pug",foreground:"4F76AC"},{token:"tag.class.pug",foreground:"4F76AC"},{token:"meta.scss",foreground:"800000"},{token:"metatag",foreground:"e00000"},{token:"metatag.content.html",foreground:"B5200D"},{token:"metatag.html",foreground:"808080"},{token:"metatag.xml",foreground:"808080"},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:"863B00"},{token:"string.key.json",foreground:"A31515"},{token:"string.value.json",foreground:"0451A5"},{token:"attribute.name",foreground:"264F78"},{token:"attribute.value",foreground:"0451A5"},{token:"string",foreground:"A31515"},{token:"string.sql",foreground:"B5200D"},{token:"keyword",foreground:"0000FF"},{token:"keyword.flow",foreground:"AF00DB"},{token:"operator.sql",foreground:"778899"},{token:"operator.swift",foreground:"666666"},{token:"predefined.sql",foreground:"C700C7"}],colors:{[$r]:"#FFFFFF",[Hl]:"#292929",[Hw]:"#292929",[zw]:"#292929"}},Tge={IconContribution:"base.contributions.icons"};var A7;(function(o){function e(t,i){let n=t.defaults;for(;ke.isThemeIcon(n);){const s=Qf.getIcon(n.id);if(!s)return;n=s.defaults}return n}o.getDefinition=e})(A7||(A7={}));var M7;(function(o){function e(i){return{weight:i.weight,style:i.style,src:i.src.map(n=>({format:n.format,location:n.location.toString()}))}}o.toJSONObject=e;function t(i){const n=s=>Ds(s)?s:void 0;if(i&&Array.isArray(i.src)&&i.src.every(s=>Ds(s.format)&&Ds(s.location)))return{weight:n(i.weight),style:n(i.style),src:i.src.map(s=>({format:s.format,location:ye.parse(s.location)}))}}o.fromJSONObject=t})(M7||(M7={}));class Dge{constructor(){this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this.iconSchema={definitions:{icons:{type:"object",properties:{fontId:{type:"string",description:p("iconDefinition.fontId","The id of the font to use. If not set, the font that is defined first is used.")},fontCharacter:{type:"string",description:p("iconDefinition.fontCharacter","The font character associated with the icon definition.")}},additionalProperties:!1,defaultSnippets:[{body:{fontCharacter:"\\\\e030"}}]}},type:"object",properties:{}},this.iconReferenceSchema={type:"string",pattern:`^${ke.iconNameExpression}$`,enum:[],enumDescriptions:[]},this.iconsById={},this.iconFontsById={}}registerIcon(e,t,i,n){const s=this.iconsById[e];if(s){if(i&&!s.description){s.description=i,this.iconSchema.properties[e].markdownDescription=`${i} $(${e})`;const l=this.iconReferenceSchema.enum.indexOf(e);l!==-1&&(this.iconReferenceSchema.enumDescriptions[l]=i),this._onDidChange.fire()}return s}const r={id:e,description:i,defaults:t,deprecationMessage:n};this.iconsById[e]=r;const a={$ref:"#/definitions/icons"};return n&&(a.deprecationMessage=n),i&&(a.markdownDescription=`${i}: $(${e})`),this.iconSchema.properties[e]=a,this.iconReferenceSchema.enum.push(e),this.iconReferenceSchema.enumDescriptions.push(i||""),this._onDidChange.fire(),{id:e}}getIcons(){return Object.keys(this.iconsById).map(e=>this.iconsById[e])}getIcon(e){return this.iconsById[e]}getIconSchema(){return this.iconSchema}toString(){const e=(s,r)=>s.id.localeCompare(r.id),t=s=>{for(;ke.isThemeIcon(s.defaults);)s=this.iconsById[s.defaults.id];return`codicon codicon-${s?s.id:""}`},i=[];i.push("| preview     | identifier                        | default codicon ID                | description"),i.push("| ----------- | --------------------------------- | --------------------------------- | --------------------------------- |");const n=Object.keys(this.iconsById).map(s=>this.iconsById[s]);for(const s of n.filter(r=>!!r.description).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|${ke.isThemeIcon(s.defaults)?s.defaults.id:s.id}|${s.description||""}|`);i.push("| preview     | identifier                        "),i.push("| ----------- | --------------------------------- |");for(const s of n.filter(r=>!ke.isThemeIcon(r.defaults)).sort(e))i.push(`|<i class="${t(s)}"></i>|${s.id}|`);return i.join(`
`)}}const Qf=new Dge;ai.add(Tge.IconContribution,Qf);function Gt(o,e,t,i){return Qf.registerIcon(o,e,t,i)}function wK(){return Qf}function Ige(){const o=bz();for(const e in o){const t="\\"+o[e].toString(16);Qf.registerIcon(e,{fontCharacter:t})}}Ige();const SK="vscode://schemas/icons",xK=ai.as(yT.JSONContribution);xK.registerSchema(SK,Qf.getIconSchema());const O7=new xt(()=>xK.notifySchemaChanged(SK),200);Qf.onDidChange(()=>{O7.isScheduled()||O7.schedule()});const LK=Gt("widget-close",J.close,p("widgetClose","Icon for the close action in widgets."));Gt("goto-previous-location",J.arrowUp,p("previousChangeIcon","Icon for goto previous editor location."));Gt("goto-next-location",J.arrowDown,p("nextChangeIcon","Icon for goto next editor location."));ke.modify(J.sync,"spin");ke.modify(J.loading,"spin");function Nge(o){const e=new $,t=e.add(new O),i=wK();return e.add(i.onDidChange(()=>t.fire())),o&&e.add(o.onDidProductIconThemeChange(()=>t.fire())),{dispose:()=>e.dispose(),onDidChange:t.event,getCSS(){const n=o?o.getProductIconTheme():new kK,s={},r=[],a=[];for(const l of i.getIcons()){const c=n.getIcon(l);if(!c)continue;const d=c.font,h=`--vscode-icon-${l.id}-font-family`,u=`--vscode-icon-${l.id}-content`;d?(s[d.id]=d.definition,a.push(`${h}: ${iI(d.id)};`,`${u}: '${c.fontCharacter}';`),r.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; font-family: ${iI(d.id)}; }`)):(a.push(`${u}: '${c.fontCharacter}'; ${h}: 'codicon';`),r.push(`.codicon-${l.id}:before { content: '${c.fontCharacter}'; }`))}for(const l in s){const c=s[l],d=c.weight?`font-weight: ${c.weight};`:"",h=c.style?`font-style: ${c.style};`:"",u=c.src.map(g=>`${jc(g.location)} format('${g.format}')`).join(", ");r.push(`@font-face { src: ${u}; font-family: ${iI(l)};${d}${h} font-display: block; }`)}return r.push(`:root { ${a.join(" ")} }`),r.join(`
`)}}}class kK{getIcon(e){const t=wK();let i=e.defaults;for(;ke.isThemeIcon(i);){const n=t.getIcon(i.id);if(!n)return;i=n.defaults}return i}}const yc="vs",Gm="vs-dark",ug="hc-black",gg="hc-light",EK=ai.as(JU.ColorContribution),Rge=ai.as(FU.ThemingContribution);class TK{constructor(e,t){this.semanticHighlighting=!1,this.themeData=t;const i=t.base;e.length>0?(Z1(e)?this.id=e:this.id=i+" "+e,this.themeName=e):(this.id=i,this.themeName=i),this.colors=null,this.defaultColors=Object.create(null),this._tokenTheme=null}get base(){return this.themeData.base}notifyBaseUpdated(){this.themeData.inherit&&(this.colors=null,this._tokenTheme=null)}getColors(){if(!this.colors){const e=new Map;for(const t in this.themeData.colors)e.set(t,j.fromHex(this.themeData.colors[t]));if(this.themeData.inherit){const t=_M(this.themeData.base);for(const i in t.colors)e.has(i)||e.set(i,j.fromHex(t.colors[i]))}this.colors=e}return this.colors}getColor(e,t){const i=this.getColors().get(e);if(i)return i;if(t!==!1)return this.getDefault(e)}getDefault(e){let t=this.defaultColors[e];return t||(t=EK.resolveDefaultColor(e,this),this.defaultColors[e]=t,t)}defines(e){return this.getColors().has(e)}get type(){switch(this.base){case yc:return or.LIGHT;case ug:return or.HIGH_CONTRAST_DARK;case gg:return or.HIGH_CONTRAST_LIGHT;default:return or.DARK}}get tokenTheme(){if(!this._tokenTheme){let e=[],t=[];if(this.themeData.inherit){const s=_M(this.themeData.base);e=s.rules,s.encodedTokensColors&&(t=s.encodedTokensColors)}const i=this.themeData.colors["editor.foreground"],n=this.themeData.colors["editor.background"];if(i||n){const s={token:""};i&&(s.foreground=i),n&&(s.background=n),e.push(s)}e=e.concat(this.themeData.rules),this.themeData.encodedTokensColors&&(t=this.themeData.encodedTokensColors),this._tokenTheme=yK.createFromRawTokenTheme(e,t)}return this._tokenTheme}getTokenStyleMetadata(e,t,i){const s=this.tokenTheme._match([e].concat(t).join(".")).metadata,r=ks.getForeground(s),a=ks.getFontStyle(s);return{foreground:r,italic:!!(a&1),bold:!!(a&2),underline:!!(a&4),strikethrough:!!(a&8)}}}function Z1(o){return o===yc||o===Gm||o===ug||o===gg}function _M(o){switch(o){case yc:return xge;case Gm:return Lge;case ug:return kge;case gg:return Ege}}function KS(o){const e=_M(o);return new TK(o,e)}class Pge extends F{constructor(){super(),this._onColorThemeChange=this._register(new O),this.onDidColorThemeChange=this._onColorThemeChange.event,this._onProductIconThemeChange=this._register(new O),this.onDidProductIconThemeChange=this._onProductIconThemeChange.event,this._environment=Object.create(null),this._builtInProductIconTheme=new kK,this._autoDetectHighContrast=!0,this._knownThemes=new Map,this._knownThemes.set(yc,KS(yc)),this._knownThemes.set(Gm,KS(Gm)),this._knownThemes.set(ug,KS(ug)),this._knownThemes.set(gg,KS(gg));const e=this._register(Nge(this));this._codiconCSS=e.getCSS(),this._themeCSS="",this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._globalStyleElement=null,this._styleElements=[],this._colorMapOverride=null,this.setTheme(yc),this._onOSSchemeChanged(),this._register(e.onDidChange(()=>{this._codiconCSS=e.getCSS(),this._updateCSS()})),Nz(It,"(forced-colors: active)",()=>{this._onOSSchemeChanged()})}registerEditorContainer(e){return P0(e)?this._registerShadowDomContainer(e):this._registerRegularEditorContainer()}_registerRegularEditorContainer(){return this._globalStyleElement||(this._globalStyleElement=Bo(void 0,e=>{e.className="monaco-colors",e.textContent=this._allCSS}),this._styleElements.push(this._globalStyleElement)),F.None}_registerShadowDomContainer(e){const t=Bo(e,i=>{i.className="monaco-colors",i.textContent=this._allCSS});return this._styleElements.push(t),{dispose:()=>{for(let i=0;i<this._styleElements.length;i++)if(this._styleElements[i]===t){this._styleElements.splice(i,1);return}}}}defineTheme(e,t){if(!/^[a-z0-9\-]+$/i.test(e))throw new Error("Illegal theme name!");if(!Z1(t.base)&&!Z1(e))throw new Error("Illegal theme base!");this._knownThemes.set(e,new TK(e,t)),Z1(e)&&this._knownThemes.forEach(i=>{i.base===e&&i.notifyBaseUpdated()}),this._theme.themeName===e&&this.setTheme(e)}getColorTheme(){return this._theme}setColorMapOverride(e){this._colorMapOverride=e,this._updateThemeOrColorMap()}setTheme(e){let t;this._knownThemes.has(e)?t=this._knownThemes.get(e):t=this._knownThemes.get(yc),this._updateActualTheme(t)}_updateActualTheme(e){!e||this._theme===e||(this._theme=e,this._updateThemeOrColorMap())}_onOSSchemeChanged(){if(this._autoDetectHighContrast){const e=It.matchMedia("(forced-colors: active)").matches;if(e!==xa(this._theme.type)){let t;v_(this._theme.type)?t=e?ug:Gm:t=e?gg:yc,this._updateActualTheme(this._knownThemes.get(t))}}}setAutoDetectHighContrast(e){this._autoDetectHighContrast=e,this._onOSSchemeChanged()}_updateThemeOrColorMap(){const e=[],t={},i={addRule:r=>{t[r]||(e.push(r),t[r]=!0)}};Rge.getThemingParticipants().forEach(r=>r(this._theme,i,this._environment));const n=[];for(const r of EK.getColors()){const a=this._theme.getColor(r.id,!0);a&&n.push(`${l5(r.id)}: ${a.toString()};`)}i.addRule(`.monaco-editor, .monaco-diff-editor, .monaco-component { ${n.join(`
`)} }`);const s=this._colorMapOverride||this._theme.tokenTheme.getColorMap();i.addRule(Sge(s)),this._themeCSS=e.join(`
`),this._updateCSS(),gi.setColorMap(s),this._onColorThemeChange.fire(this._theme)}_updateCSS(){this._allCSS=`${this._codiconCSS}
${this._themeCSS}`,this._styleElements.forEach(e=>e.textContent=this._allCSS)}getFileIconTheme(){return{hasFileIcons:!1,hasFolderIcons:!1,hidesExplorerArrows:!1}}getProductIconTheme(){return this._builtInProductIconTheme}}const Ko=Je("themeService");var Age=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},XI=function(o,e){return function(t,i){e(t,i,o)}};let bM=class extends F{constructor(e,t,i){super(),this._contextKeyService=e,this._layoutService=t,this._configurationService=i,this._accessibilitySupport=0,this._onDidChangeScreenReaderOptimized=new O,this._onDidChangeReducedMotion=new O,this._onDidChangeLinkUnderline=new O,this._accessibilityModeEnabledContext=Rw.bindTo(this._contextKeyService);const n=()=>this._accessibilityModeEnabledContext.set(this.isScreenReaderOptimized());this._register(this._configurationService.onDidChangeConfiguration(r=>{r.affectsConfiguration("editor.accessibilitySupport")&&(n(),this._onDidChangeScreenReaderOptimized.fire()),r.affectsConfiguration("workbench.reduceMotion")&&(this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._onDidChangeReducedMotion.fire())})),n(),this._register(this.onDidChangeScreenReaderOptimized(()=>n()));const s=It.matchMedia("(prefers-reduced-motion: reduce)");this._systemMotionReduced=s.matches,this._configMotionReduced=this._configurationService.getValue("workbench.reduceMotion"),this._linkUnderlinesEnabled=this._configurationService.getValue("accessibility.underlineLinks"),this.initReducedMotionListeners(s),this.initLinkUnderlineListeners()}initReducedMotionListeners(e){this._register(H(e,"change",()=>{this._systemMotionReduced=e.matches,this._configMotionReduced==="auto"&&this._onDidChangeReducedMotion.fire()}));const t=()=>{const i=this.isMotionReduced();this._layoutService.mainContainer.classList.toggle("reduce-motion",i),this._layoutService.mainContainer.classList.toggle("enable-motion",!i)};t(),this._register(this.onDidChangeReducedMotion(()=>t()))}initLinkUnderlineListeners(){this._register(this._configurationService.onDidChangeConfiguration(t=>{if(t.affectsConfiguration("accessibility.underlineLinks")){const i=this._configurationService.getValue("accessibility.underlineLinks");this._linkUnderlinesEnabled=i,this._onDidChangeLinkUnderline.fire()}}));const e=()=>{const t=this._linkUnderlinesEnabled;this._layoutService.mainContainer.classList.toggle("underline-links",t)};e(),this._register(this.onDidChangeLinkUnderlines(()=>e()))}onDidChangeLinkUnderlines(e){return this._onDidChangeLinkUnderline.event(e)}get onDidChangeScreenReaderOptimized(){return this._onDidChangeScreenReaderOptimized.event}isScreenReaderOptimized(){const e=this._configurationService.getValue("editor.accessibilitySupport");return e==="on"||e==="auto"&&this._accessibilitySupport===2}get onDidChangeReducedMotion(){return this._onDidChangeReducedMotion.event}isMotionReduced(){const e=this._configMotionReduced;return e==="on"||e==="auto"&&this._systemMotionReduced}getAccessibilitySupport(){return this._accessibilitySupport}};bM=Age([XI(0,Ee),XI(1,qh),XI(2,Ke)],bM);var tD=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},kl=function(o,e){return function(t,i){e(t,i,o)}},Op,vv;let vM=class{constructor(e,t,i){this._commandService=e,this._keybindingService=t,this._hiddenStates=new CM(i)}createMenu(e,t,i){return new Wx(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t)}getMenuActions(e,t,i){const n=new Wx(e,this._hiddenStates,{emitEventsForSubmenuChanges:!1,eventDebounceDelay:50,...i},this._commandService,this._keybindingService,t),s=n.getActions(i);return n.dispose(),s}resetHiddenStates(e){this._hiddenStates.reset(e)}};vM=tD([kl(0,Ft),kl(1,vt),kl(2,Yr)],vM);var wg;let CM=(wg=class{constructor(e){this._storageService=e,this._disposables=new $,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._ignoreChangeEvent=!1,this._hiddenByDefaultCache=new Map;try{const t=e.get(Op._key,0,"{}");this._data=JSON.parse(t)}catch{this._data=Object.create(null)}this._disposables.add(e.onDidChangeValue(0,Op._key,this._disposables)(()=>{if(!this._ignoreChangeEvent)try{const t=e.get(Op._key,0,"{}");this._data=JSON.parse(t)}catch(t){console.log("FAILED to read storage after UPDATE",t)}this._onDidChange.fire()}))}dispose(){this._onDidChange.dispose(),this._disposables.dispose()}_isHiddenByDefault(e,t){return this._hiddenByDefaultCache.get(`${e.id}/${t}`)??!1}setDefaultState(e,t,i){this._hiddenByDefaultCache.set(`${e.id}/${t}`,i)}isHidden(e,t){const i=this._isHiddenByDefault(e,t),n=this._data[e.id]?.includes(t)??!1;return i?!n:n}updateHidden(e,t,i){this._isHiddenByDefault(e,t)&&(i=!i);const s=this._data[e.id];if(i)s?s.indexOf(t)<0&&s.push(t):this._data[e.id]=[t];else if(s){const r=s.indexOf(t);r>=0&&EY(s,r),s.length===0&&delete this._data[e.id]}this._persist()}reset(e){if(e===void 0)this._data=Object.create(null),this._persist();else{for(const{id:t}of e)this._data[t]&&delete this._data[t];this._persist()}}_persist(){try{this._ignoreChangeEvent=!0;const e=JSON.stringify(this._data);this._storageService.store(Op._key,e,0,0)}finally{this._ignoreChangeEvent=!1}}},Op=wg,wg._key="menu.hiddenCommands",wg);CM=Op=tD([kl(0,Yr)],CM);class Zv{constructor(e,t){this._id=e,this._collectContextKeysForSubmenus=t,this._menuGroups=[],this._allMenuIds=new Set,this._structureContextKeys=new Set,this._preconditionContextKeys=new Set,this._toggledContextKeys=new Set,this.refresh()}get allMenuIds(){return this._allMenuIds}get structureContextKeys(){return this._structureContextKeys}get preconditionContextKeys(){return this._preconditionContextKeys}get toggledContextKeys(){return this._toggledContextKeys}refresh(){this._menuGroups.length=0,this._allMenuIds.clear(),this._structureContextKeys.clear(),this._preconditionContextKeys.clear(),this._toggledContextKeys.clear();const e=this._sort(sn.getMenuItems(this._id));let t;for(const i of e){const n=i.group||"";(!t||t[0]!==n)&&(t=[n,[]],this._menuGroups.push(t)),t[1].push(i),this._collectContextKeysAndSubmenuIds(i)}this._allMenuIds.add(this._id)}_sort(e){return e}_collectContextKeysAndSubmenuIds(e){if(Zv._fillInKbExprKeys(e.when,this._structureContextKeys),Rm(e)){if(e.command.precondition&&Zv._fillInKbExprKeys(e.command.precondition,this._preconditionContextKeys),e.command.toggled){const t=e.command.toggled.condition||e.command.toggled;Zv._fillInKbExprKeys(t,this._toggledContextKeys)}}else this._collectContextKeysForSubmenus&&(sn.getMenuItems(e.submenu).forEach(this._collectContextKeysAndSubmenuIds,this),this._allMenuIds.add(e.submenu))}static _fillInKbExprKeys(e,t){if(e)for(const i of e.keys())t.add(i)}}let yM=vv=class extends Zv{constructor(e,t,i,n,s,r){super(e,i),this._hiddenStates=t,this._commandService=n,this._keybindingService=s,this._contextKeyService=r,this.refresh()}createActionGroups(e){const t=[];for(const i of this._menuGroups){const[n,s]=i;let r;for(const a of s)if(this._contextKeyService.contextMatchesRules(a.when)){const l=Rm(a);l&&this._hiddenStates.setDefaultState(this._id,a.command.id,!!a.isHiddenByDefault);const c=Mge(this._id,l?a.command:a,this._hiddenStates);if(l){const d=DK(this._commandService,this._keybindingService,a.command.id,a.when);(r??=[]).push(new io(a.command,a.alt,e,c,d,this._contextKeyService,this._commandService))}else{const d=new vv(a.submenu,this._hiddenStates,this._collectContextKeysForSubmenus,this._commandService,this._keybindingService,this._contextKeyService).createActionGroups(e),h=Zi.join(...d.map(u=>u[1]));h.length>0&&(r??=[]).push(new Pm(a,c,h))}}r&&r.length>0&&t.push([n,r])}return t}_sort(e){return e.sort(vv._compareMenuItems)}static _compareMenuItems(e,t){const i=e.group,n=t.group;if(i!==n){if(i){if(!n)return-1}else return 1;if(i==="navigation")return-1;if(n==="navigation")return 1;const a=i.localeCompare(n);if(a!==0)return a}const s=e.order||0,r=t.order||0;return s<r?-1:s>r?1:vv._compareTitles(Rm(e)?e.command.title:e.title,Rm(t)?t.command.title:t.title)}static _compareTitles(e,t){const i=typeof e=="string"?e:e.original,n=typeof t=="string"?t:t.original;return i.localeCompare(n)}};yM=vv=tD([kl(3,Ft),kl(4,vt),kl(5,Ee)],yM);let Wx=class{constructor(e,t,i,n,s,r){this._disposables=new $,this._menuInfo=new yM(e,t,i.emitEventsForSubmenuChanges,n,s,r);const a=new xt(()=>{this._menuInfo.refresh(),this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!0,isToggleChange:!0})},i.eventDebounceDelay);this._disposables.add(a),this._disposables.add(sn.onDidChangeMenu(h=>{for(const u of this._menuInfo.allMenuIds)if(h.has(u)){a.schedule();break}}));const l=this._disposables.add(new $),c=h=>{let u=!1,g=!1,f=!1;for(const m of h)if(u=u||m.isStructuralChange,g=g||m.isEnablementChange,f=f||m.isToggleChange,u&&g&&f)break;return{menu:this,isStructuralChange:u,isEnablementChange:g,isToggleChange:f}},d=()=>{l.add(r.onDidChangeContext(h=>{const u=h.affectsSome(this._menuInfo.structureContextKeys),g=h.affectsSome(this._menuInfo.preconditionContextKeys),f=h.affectsSome(this._menuInfo.toggledContextKeys);(u||g||f)&&this._onDidChange.fire({menu:this,isStructuralChange:u,isEnablementChange:g,isToggleChange:f})})),l.add(t.onDidChange(h=>{this._onDidChange.fire({menu:this,isStructuralChange:!0,isEnablementChange:!1,isToggleChange:!1})}))};this._onDidChange=new lz({onWillAddFirstListener:d,onDidRemoveLastListener:l.clear.bind(l),delay:i.eventDebounceDelay,merge:c}),this.onDidChange=this._onDidChange.event}getActions(e){return this._menuInfo.createActionGroups(e)}dispose(){this._disposables.dispose(),this._onDidChange.dispose()}};Wx=tD([kl(3,Ft),kl(4,vt),kl(5,Ee)],Wx);function Mge(o,e,t){const i=Wee(e)?e.submenu.id:e.id,n=typeof e.title=="string"?e.title:e.title.value,s=ag({id:`hide/${o.id}/${i}`,label:p("hide.label","Hide '{0}'",n),run(){t.updateHidden(o,i,!0)}}),r=ag({id:`toggle/${o.id}/${i}`,label:n,get checked(){return!t.isHidden(o,i)},run(){t.updateHidden(o,i,!!this.checked)}});return{hide:s,toggle:r,get isHidden(){return!r.checked}}}function DK(o,e,t,i=void 0,n=!0){return ag({id:`configureKeybinding/${t}`,label:p("configure keybinding","Configure Keybinding"),enabled:n,run(){const r=!!!e.lookupKeybinding(t)&&i?i.serialize():void 0;o.executeCommand("workbench.action.openGlobalKeybindings",`@command:${t}`+(r?` +when:${r}`:""))}})}var Oge=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},F7=function(o,e){return function(t,i){e(t,i,o)}},wM;const B7="application/vnd.code.resources";var Sg;let SM=(Sg=class extends F{constructor(e,t){super(),this.layoutService=e,this.logService=t,this.mapTextToType=new Map,this.findText="",this.resources=[],this.resourcesStateHash=void 0,(Nh||Rz)&&this.installWebKitWriteTextWorkaround(),this._register(se.runAndSubscribe(rT,({window:i,disposables:n})=>{n.add(H(i.document,"copy",()=>this.clearResourcesState()))},{window:It,disposables:this._store}))}installWebKitWriteTextWorkaround(){const e=()=>{const t=new ib;this.webKitPendingClipboardWritePromise&&!this.webKitPendingClipboardWritePromise.isSettled&&this.webKitPendingClipboardWritePromise.cancel(),this.webKitPendingClipboardWritePromise=t,dv().navigator.clipboard.write([new ClipboardItem({"text/plain":t.p})]).catch(async i=>{(!(i instanceof Error)||i.name!=="NotAllowedError"||!t.isRejected)&&this.logService.error(i)})};this._register(se.runAndSubscribe(this.layoutService.onDidAddContainer,({container:t,disposables:i})=>{i.add(H(t,"click",e)),i.add(H(t,"keydown",e))},{container:this.layoutService.mainContainer,disposables:this._store}))}async writeText(e,t){if(this.clearResourcesState(),t){this.mapTextToType.set(t,e);return}if(this.webKitPendingClipboardWritePromise)return this.webKitPendingClipboardWritePromise.complete(e);try{return await dv().navigator.clipboard.writeText(e)}catch(i){console.error(i)}this.fallbackWriteText(e)}fallbackWriteText(e){const t=nb(),i=t.activeElement,n=t.body.appendChild(ie("textarea",{"aria-hidden":!0}));n.style.height="1px",n.style.width="1px",n.style.position="absolute",n.value=e,n.focus(),n.select(),t.execCommand("copy"),qi(i)&&i.focus(),n.remove()}async readText(e){if(e)return this.mapTextToType.get(e)||"";try{return await dv().navigator.clipboard.readText()}catch(t){console.error(t)}return""}async readFindText(){return this.findText}async writeFindText(e){this.findText=e}async readResources(){try{const t=await dv().navigator.clipboard.read();for(const i of t)if(i.types.includes(`web ${B7}`)){const n=await i.getType(`web ${B7}`);return JSON.parse(await n.text()).map(r=>ye.from(r))}}catch{}const e=await this.computeResourcesStateHash();return this.resourcesStateHash!==e&&this.clearResourcesState(),this.resources}async computeResourcesStateHash(){if(this.resources.length===0)return;const e=await this.readText();return sT(e.substring(0,wM.MAX_RESOURCE_STATE_SOURCE_LENGTH))}clearInternalState(){this.clearResourcesState()}clearResourcesState(){this.resources=[],this.resourcesStateHash=void 0}},wM=Sg,Sg.MAX_RESOURCE_STATE_SOURCE_LENGTH=1e3,Sg);SM=wM=Oge([F7(0,qh),F7(1,Tn)],SM);const ad=Je("clipboardService");var Fge=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Bge=function(o,e){return function(t,i){e(t,i,o)}};const Yv="data-keybinding-context";let vB=class{constructor(e,t){this._id=e,this._parent=t,this._value=Object.create(null),this._value._contextId=e}get value(){return{...this._value}}setValue(e,t){return this._value[e]!==t?(this._value[e]=t,!0):!1}removeValue(e){return e in this._value?(delete this._value[e],!0):!1}getValue(e){const t=this._value[e];return typeof t>"u"&&this._parent?this._parent.getValue(e):t}};const Uk=class Uk extends vB{constructor(){super(-1,null)}setValue(e,t){return!1}removeValue(e){return!1}getValue(e){}};Uk.INSTANCE=new Uk;let P_=Uk;const TC=class TC extends vB{constructor(e,t,i){super(e,null),this._configurationService=t,this._values=Fm.forConfigKeys(),this._listener=this._configurationService.onDidChangeConfiguration(n=>{if(n.source===7){const s=Array.from(this._values,([r])=>r);this._values.clear(),i.fire(new V7(s))}else{const s=[];for(const r of n.affectedKeys){const a=`config.${r}`,l=this._values.findSuperstr(a);l!==void 0&&(s.push(...nt.map(l,([c])=>c)),this._values.deleteSuperstr(a)),this._values.has(a)&&(s.push(a),this._values.delete(a))}i.fire(new V7(s))}})}dispose(){this._listener.dispose()}getValue(e){if(e.indexOf(TC._keyPrefix)!==0)return super.getValue(e);if(this._values.has(e))return this._values.get(e);const t=e.substr(TC._keyPrefix.length),i=this._configurationService.getValue(t);let n;switch(typeof i){case"number":case"boolean":case"string":n=i;break;default:Array.isArray(i)?n=JSON.stringify(i):n=i}return this._values.set(e,n),n}setValue(e,t){return super.setValue(e,t)}removeValue(e){return super.removeValue(e)}};TC._keyPrefix="config.";let xM=TC;class Wge{constructor(e,t,i){this._service=e,this._key=t,this._defaultValue=i,this.reset()}set(e){this._service.setContext(this._key,e)}reset(){typeof this._defaultValue>"u"?this._service.removeContext(this._key):this._service.setContext(this._key,this._defaultValue)}get(){return this._service.getContextKeyValue(this._key)}}class W7{constructor(e){this.key=e}affectsSome(e){return e.has(this.key)}allKeysContainedIn(e){return this.affectsSome(e)}}class V7{constructor(e){this.keys=e}affectsSome(e){for(const t of this.keys)if(e.has(t))return!0;return!1}allKeysContainedIn(e){return this.keys.every(t=>e.has(t))}}class Vge{constructor(e){this.events=e}affectsSome(e){for(const t of this.events)if(t.affectsSome(e))return!0;return!1}allKeysContainedIn(e){return this.events.every(t=>t.allKeysContainedIn(e))}}function Hge(o,e){return o.allKeysContainedIn(new Set(Object.keys(e)))}class IK extends F{constructor(e){super(),this._onDidChangeContext=this._register(new pf({merge:t=>new Vge(t)})),this.onDidChangeContext=this._onDidChangeContext.event,this._isDisposed=!1,this._myContextId=e}createKey(e,t){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new Wge(this,e,t)}bufferChangeEvents(e){this._onDidChangeContext.pause();try{e()}finally{this._onDidChangeContext.resume()}}createScoped(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");return new zge(this,e)}contextMatchesRules(e){if(this._isDisposed)throw new Error("AbstractContextKeyService has been disposed");const t=this.getContextValuesContainer(this._myContextId);return e?e.evaluate(t):!0}getContextKeyValue(e){if(!this._isDisposed)return this.getContextValuesContainer(this._myContextId).getValue(e)}setContext(e,t){if(this._isDisposed)return;const i=this.getContextValuesContainer(this._myContextId);i&&i.setValue(e,t)&&this._onDidChangeContext.fire(new W7(e))}removeContext(e){this._isDisposed||this.getContextValuesContainer(this._myContextId).removeValue(e)&&this._onDidChangeContext.fire(new W7(e))}getContext(e){return this._isDisposed?P_.INSTANCE:this.getContextValuesContainer(Uge(e))}dispose(){super.dispose(),this._isDisposed=!0}}let LM=class extends IK{constructor(e){super(0),this._contexts=new Map,this._lastContextId=0;const t=this._register(new xM(this._myContextId,e,this._onDidChangeContext));this._contexts.set(this._myContextId,t)}getContextValuesContainer(e){return this._isDisposed?P_.INSTANCE:this._contexts.get(e)||P_.INSTANCE}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ContextKeyService has been disposed");const t=++this._lastContextId;return this._contexts.set(t,new vB(t,this.getContextValuesContainer(e))),t}disposeContext(e){this._isDisposed||this._contexts.delete(e)}};LM=Fge([Bge(0,Ke)],LM);class zge extends IK{constructor(e,t){if(super(e.createChildContext()),this._parentChangeListener=this._register(new Yi),this._parent=e,this._updateParentChangeListener(),this._domNode=t,this._domNode.hasAttribute(Yv)){let i="";this._domNode.classList&&(i=Array.from(this._domNode.classList.values()).join(", ")),console.error(`Element already has context attribute${i?": "+i:""}`)}this._domNode.setAttribute(Yv,String(this._myContextId))}_updateParentChangeListener(){this._parentChangeListener.value=this._parent.onDidChangeContext(e=>{const i=this._parent.getContextValuesContainer(this._myContextId).value;Hge(e,i)||this._onDidChangeContext.fire(e)})}dispose(){this._isDisposed||(this._parent.disposeContext(this._myContextId),this._domNode.removeAttribute(Yv),super.dispose())}getContextValuesContainer(e){return this._isDisposed?P_.INSTANCE:this._parent.getContextValuesContainer(e)}createChildContext(e=this._myContextId){if(this._isDisposed)throw new Error("ScopedContextKeyService has been disposed");return this._parent.createChildContext(e)}disposeContext(e){this._isDisposed||this._parent.disposeContext(e)}}function Uge(o){for(;o;){if(o.hasAttribute(Yv)){const e=o.getAttribute(Yv);return e?parseInt(e,10):NaN}o=o.parentElement}return 0}function Gge(o,e,t){o.get(Ee).createKey(String(e),$ge(t))}function $ge(o){return q6(o,e=>{if(typeof e=="object"&&e.$mid===1)return ye.revive(e).toString();if(e instanceof ye)return e.toString()})}st.registerCommand("_setContext",Gge);st.registerCommand({id:"getContextKeyInfo",handler(){return[...re.all()].sort((o,e)=>o.key.localeCompare(e.key))},metadata:{description:p("getContextKeyInfo","A command that returns information about context keys"),args:[]}});st.registerCommand("_generateContextKeyInfo",function(){const o=[],e=new Set;for(const t of re.all())e.has(t.key)||(e.add(t.key),o.push(t));o.sort((t,i)=>t.key.localeCompare(i.key)),console.log(JSON.stringify(o,void 0,2))});let Kge=class{constructor(e,t){this.key=e,this.data=t,this.incoming=new Map,this.outgoing=new Map}};class H7{constructor(e){this._hashFn=e,this._nodes=new Map}roots(){const e=[];for(const t of this._nodes.values())t.outgoing.size===0&&e.push(t);return e}insertEdge(e,t){const i=this.lookupOrInsertNode(e),n=this.lookupOrInsertNode(t);i.outgoing.set(n.key,n),n.incoming.set(i.key,i)}removeNode(e){const t=this._hashFn(e);this._nodes.delete(t);for(const i of this._nodes.values())i.outgoing.delete(t),i.incoming.delete(t)}lookupOrInsertNode(e){const t=this._hashFn(e);let i=this._nodes.get(t);return i||(i=new Kge(t,e),this._nodes.set(t,i)),i}isEmpty(){return this._nodes.size===0}toString(){const e=[];for(const[t,i]of this._nodes)e.push(`${t}
	(-> incoming)[${[...i.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...i.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(const[e,t]of this._nodes){const i=new Set([e]),n=this._findCycle(t,i);if(n)return n}}_findCycle(e,t){for(const[i,n]of e.outgoing){if(t.has(i))return[...t,i].join(" -> ");t.add(i);const s=this._findCycle(n,t);if(s)return s;t.delete(i)}}}class bb{constructor(...e){this._entries=new Map;for(const[t,i]of e)this.set(t,i)}set(e,t){const i=this._entries.get(e);return this._entries.set(e,t),i}get(e){return this._entries.get(e)}}const jge=!1;class z7 extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}}class Vx{constructor(e=new bb,t=!1,i,n=jge){this._services=e,this._strict=t,this._parent=i,this._enableTracing=n,this._isDisposed=!1,this._servicesToMaybeDispose=new Set,this._children=new Set,this._activeInstantiations=new Set,this._services.set(Ce,this),this._globalGraph=n?i?._globalGraph??new H7(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Dt(this._children),this._children.clear();for(const e of this._servicesToMaybeDispose)JE(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,t){this._throwIfDisposed();const i=this,n=new class extends Vx{dispose(){i._children.delete(n),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(n),t?.add(n),n}invokeFunction(e,...t){this._throwIfDisposed();const i=Xv.traceInvocation(this._enableTracing,e);let n=!1;try{return e({get:r=>{if(n)throw x4("service accessor is only valid during the invocation of its target method");const a=this._getOrCreateServiceInstance(r,i);if(!a)throw new Error(`[invokeFunction] unknown service '${r}'`);return a}},...t)}finally{n=!0,i.stop()}}createInstance(e,...t){this._throwIfDisposed();let i,n;return e instanceof hl?(i=Xv.traceCreation(this._enableTracing,e.ctor),n=this._createInstance(e.ctor,e.staticArguments.concat(t),i)):(i=Xv.traceCreation(this._enableTracing,e),n=this._createInstance(e,t,i)),i.stop(),n}_createInstance(e,t=[],i){const n=ba.getServiceDependencies(e).sort((a,l)=>a.index-l.index),s=[];for(const a of n){const l=this._getOrCreateServiceInstance(a.id,i);l||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${a.id}.`,!1),s.push(l)}const r=n.length>0?n[0].index:t.length;if(t.length!==r){console.trace(`[createInstance] First service dependency of ${e.name} at position ${r+1} conflicts with ${t.length} static arguments`);const a=r-t.length;a>0?t=t.concat(new Array(a)):t=t.slice(0,r)}return Reflect.construct(e,t.concat(s))}_setCreatedServiceInstance(e,t){if(this._services.get(e)instanceof hl)this._services.set(e,t);else if(this._parent)this._parent._setCreatedServiceInstance(e,t);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){const t=this._services.get(e);return!t&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):t}_getOrCreateServiceInstance(e,t){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));const i=this._getServiceInstanceOrDescriptor(e);return i instanceof hl?this._safeCreateAndCacheServiceInstance(e,i,t.branch(e,!0)):(t.branch(e,!1),i)}_safeCreateAndCacheServiceInstance(e,t,i){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,t,i)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,t,i){const n=new H7(l=>l.id.toString());let s=0;const r=[{id:e,desc:t,_trace:i}],a=new Set;for(;r.length;){const l=r.pop();if(!a.has(String(l.id))){if(a.add(String(l.id)),n.lookupOrInsertNode(l),s++>1e3)throw new z7(n);for(const c of ba.getServiceDependencies(l.desc.ctor)){const d=this._getServiceInstanceOrDescriptor(c.id);if(d||this._throwIfStrict(`[createInstance] ${e} depends on ${c.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(l.id),String(c.id)),d instanceof hl){const h={id:c.id,desc:d,_trace:l._trace.branch(c.id,!0)};n.insertEdge(l,h),r.push(h)}}}}for(;;){const l=n.roots();if(l.length===0){if(!n.isEmpty())throw new z7(n);break}for(const{data:c}of l){if(this._getServiceInstanceOrDescriptor(c.id)instanceof hl){const h=this._createServiceInstanceWithOwner(c.id,c.desc.ctor,c.desc.staticArguments,c.desc.supportsDelayedInstantiation,c._trace);this._setCreatedServiceInstance(c.id,h)}n.removeNode(c)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,t,i=[],n,s){if(this._services.get(e)instanceof hl)return this._createServiceInstance(e,t,i,n,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,t,i,n,s);throw new Error(`illegalState - creating UNKNOWN service instance ${t.name}`)}_createServiceInstance(e,t,i=[],n,s,r){if(n){const a=new Vx(void 0,this._strict,this,this._enableTracing);a._globalGraphImplicitDependency=String(e);const l=new Map,c=new uJ(()=>{const d=a._createInstance(t,i,s);for(const[h,u]of l){const g=d[h];if(typeof g=="function")for(const f of u)f.disposable=g.apply(d,f.listener)}return l.clear(),r.add(d),d});return new Proxy(Object.create(null),{get(d,h){if(!c.isInitialized&&typeof h=="string"&&(h.startsWith("onDid")||h.startsWith("onWill"))){let f=l.get(h);return f||(f=new os,l.set(h,f)),(_,b,v)=>{if(c.isInitialized)return c.value[h](_,b,v);{const y={listener:[_,b,v],disposable:void 0},C=f.push(y);return ve(()=>{C(),y.disposable?.dispose()})}}}if(h in d)return d[h];const u=c.value;let g=u[h];return typeof g!="function"||(g=g.bind(u),d[h]=g),g},set(d,h,u){return c.value[h]=u,!0},getPrototypeOf(d){return t.prototype}})}else{const a=this._createInstance(t,i,s);return r.add(a),a}}_throwIfStrict(e,t){if(t&&console.warn(e),this._strict)throw new Error(e)}}const bo=class bo{static traceInvocation(e,t){return e?new bo(2,t.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):bo._None}static traceCreation(e,t){return e?new bo(1,t.name):bo._None}constructor(e,t){this.type=e,this.name=t,this._start=Date.now(),this._dep=[]}branch(e,t){const i=new bo(3,e.toString());return this._dep.push([e,t,i]),i}stop(){const e=Date.now()-this._start;bo._totals+=e;let t=!1;function i(s,r){const a=[],l=new Array(s+1).join("	");for(const[c,d,h]of r._dep)if(d&&h){t=!0,a.push(`${l}CREATES -> ${c}`);const u=i(s+1,h);u&&a.push(u)}else a.push(`${l}uses -> ${c}`);return a.join(`
`)}const n=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${i(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${bo._totals.toFixed(2)}ms)`];(e>2||t)&&bo.all.add(n.join(`
`))}};bo.all=new Set,bo._None=new class extends bo{constructor(){super(0,null)}stop(){}branch(){return this}},bo._totals=0;let Xv=bo;const qge=new Set([Oe.inMemory,Oe.vscodeSourceControl,Oe.walkThrough,Oe.walkThroughSnippet,Oe.vscodeChatCodeBlock]);class Zge{constructor(){this._byResource=new on,this._byOwner=new Map}set(e,t,i){let n=this._byResource.get(e);n||(n=new Map,this._byResource.set(e,n)),n.set(t,i);let s=this._byOwner.get(t);s||(s=new on,this._byOwner.set(t,s)),s.set(e,i)}get(e,t){return this._byResource.get(e)?.get(t)}delete(e,t){let i=!1,n=!1;const s=this._byResource.get(e);s&&(i=s.delete(t));const r=this._byOwner.get(t);if(r&&(n=r.delete(e)),i!==n)throw new Error("illegal state");return i&&n}values(e){return typeof e=="string"?this._byOwner.get(e)?.values()??nt.empty():ye.isUri(e)?this._byResource.get(e)?.values()??nt.empty():nt.map(nt.concat(...this._byOwner.values()),t=>t[1])}}class Yge{constructor(e){this.errors=0,this.infos=0,this.warnings=0,this.unknowns=0,this._data=new on,this._service=e,this._subscription=e.onMarkerChanged(this._update,this)}dispose(){this._subscription.dispose()}_update(e){for(const t of e){const i=this._data.get(t);i&&this._substract(i);const n=this._resourceStats(t);this._add(n),this._data.set(t,n)}}_resourceStats(e){const t={errors:0,warnings:0,infos:0,unknowns:0};if(qge.has(e.scheme))return t;for(const{severity:i}of this._service.read({resource:e}))i===pi.Error?t.errors+=1:i===pi.Warning?t.warnings+=1:i===pi.Info?t.infos+=1:t.unknowns+=1;return t}_substract(e){this.errors-=e.errors,this.warnings-=e.warnings,this.infos-=e.infos,this.unknowns-=e.unknowns}_add(e){this.errors+=e.errors,this.warnings+=e.warnings,this.infos+=e.infos,this.unknowns+=e.unknowns}}class xd{constructor(){this._onMarkerChanged=new lz({delay:0,merge:xd._merge}),this.onMarkerChanged=this._onMarkerChanged.event,this._data=new Zge,this._stats=new Yge(this)}dispose(){this._stats.dispose(),this._onMarkerChanged.dispose()}remove(e,t){for(const i of t||[])this.changeOne(e,i,[])}changeOne(e,t,i){if(U6(i))this._data.delete(t,e)&&this._onMarkerChanged.fire([t]);else{const n=[];for(const s of i){const r=xd._toMarker(e,t,s);r&&n.push(r)}this._data.set(t,e,n),this._onMarkerChanged.fire([t])}}static _toMarker(e,t,i){let{code:n,severity:s,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:g}=i;if(r)return l=l>0?l:1,c=c>0?c:1,d=d>=l?d:l,h=h>0?h:c,{resource:t,owner:e,code:n,severity:s,message:r,source:a,startLineNumber:l,startColumn:c,endLineNumber:d,endColumn:h,relatedInformation:u,tags:g}}changeAll(e,t){const i=[],n=this._data.values(e);if(n)for(const s of n){const r=nt.first(s);r&&(i.push(r.resource),this._data.delete(r.resource,e))}if(Yn(t)){const s=new on;for(const{resource:r,marker:a}of t){const l=xd._toMarker(e,r,a);if(!l)continue;const c=s.get(r);c?c.push(l):(s.set(r,[l]),i.push(r))}for(const[r,a]of s)this._data.set(r,e,a)}i.length>0&&this._onMarkerChanged.fire(i)}read(e=Object.create(null)){let{owner:t,resource:i,severities:n,take:s}=e;if((!s||s<0)&&(s=-1),t&&i){const r=this._data.get(i,t);if(r){const a=[];for(const l of r)if(xd._accept(l,n)){const c=a.push(l);if(s>0&&c===s)break}return a}else return[]}else if(!t&&!i){const r=[];for(const a of this._data.values())for(const l of a)if(xd._accept(l,n)){const c=r.push(l);if(s>0&&c===s)return r}return r}else{const r=this._data.values(i??t),a=[];for(const l of r)for(const c of l)if(xd._accept(c,n)){const d=a.push(c);if(s>0&&d===s)return a}return a}}static _accept(e,t){return t===void 0||(t&e.severity)===e.severity}static _merge(e){const t=new on;for(const i of e)for(const n of i)t.set(n,!0);return Array.from(t.keys())}}class Xge extends F{get configurationModel(){return this._configurationModel}constructor(e){super(),this.logService=e,this._configurationModel=gn.createEmptyModel(this.logService)}reload(){return this.resetConfigurationModel(),this.configurationModel}getConfigurationDefaultOverrides(){return{}}resetConfigurationModel(){this._configurationModel=gn.createEmptyModel(this.logService);const e=ai.as(Zr.Configuration).getConfigurationProperties();this.updateConfigurationModel(Object.keys(e),e)}updateConfigurationModel(e,t){const i=this.getConfigurationDefaultOverrides();for(const n of e){const s=i[n],r=t[n];s!==void 0?this._configurationModel.setValue(n,s):r?this._configurationModel.setValue(n,r.default):this._configurationModel.removeValue(n)}}}const Jh=Je("accessibilitySignalService"),ft=class ft{static register(e){return new ft(e.fileName)}constructor(e){this.fileName=e}};ft.error=ft.register({fileName:"error.mp3"}),ft.warning=ft.register({fileName:"warning.mp3"}),ft.success=ft.register({fileName:"success.mp3"}),ft.foldedArea=ft.register({fileName:"foldedAreas.mp3"}),ft.break=ft.register({fileName:"break.mp3"}),ft.quickFixes=ft.register({fileName:"quickFixes.mp3"}),ft.taskCompleted=ft.register({fileName:"taskCompleted.mp3"}),ft.taskFailed=ft.register({fileName:"taskFailed.mp3"}),ft.terminalBell=ft.register({fileName:"terminalBell.mp3"}),ft.diffLineInserted=ft.register({fileName:"diffLineInserted.mp3"}),ft.diffLineDeleted=ft.register({fileName:"diffLineDeleted.mp3"}),ft.diffLineModified=ft.register({fileName:"diffLineModified.mp3"}),ft.chatRequestSent=ft.register({fileName:"chatRequestSent.mp3"}),ft.chatResponseReceived1=ft.register({fileName:"chatResponseReceived1.mp3"}),ft.chatResponseReceived2=ft.register({fileName:"chatResponseReceived2.mp3"}),ft.chatResponseReceived3=ft.register({fileName:"chatResponseReceived3.mp3"}),ft.chatResponseReceived4=ft.register({fileName:"chatResponseReceived4.mp3"}),ft.clear=ft.register({fileName:"clear.mp3"}),ft.save=ft.register({fileName:"save.mp3"}),ft.format=ft.register({fileName:"format.mp3"}),ft.voiceRecordingStarted=ft.register({fileName:"voiceRecordingStarted.mp3"}),ft.voiceRecordingStopped=ft.register({fileName:"voiceRecordingStopped.mp3"}),ft.progress=ft.register({fileName:"progress.mp3"});let Qt=ft;class Qge{constructor(e){this.randomOneOf=e}}const Ge=class Ge{constructor(e,t,i,n,s,r){this.sound=e,this.name=t,this.legacySoundSettingsKey=i,this.settingsKey=n,this.legacyAnnouncementSettingsKey=s,this.announcementMessage=r}static register(e){const t=new Qge("randomOneOf"in e.sound?e.sound.randomOneOf:[e.sound]),i=new Ge(t,e.name,e.legacySoundSettingsKey,e.settingsKey,e.legacyAnnouncementSettingsKey,e.announcementMessage);return Ge._signals.add(i),i}};Ge._signals=new Set,Ge.errorAtPosition=Ge.register({name:p("accessibilitySignals.positionHasError.name","Error at Position"),sound:Qt.error,announcementMessage:p("accessibility.signals.positionHasError","Error"),settingsKey:"accessibility.signals.positionHasError",delaySettingsKey:"accessibility.signalOptions.delays.errorAtPosition"}),Ge.warningAtPosition=Ge.register({name:p("accessibilitySignals.positionHasWarning.name","Warning at Position"),sound:Qt.warning,announcementMessage:p("accessibility.signals.positionHasWarning","Warning"),settingsKey:"accessibility.signals.positionHasWarning",delaySettingsKey:"accessibility.signalOptions.delays.warningAtPosition"}),Ge.errorOnLine=Ge.register({name:p("accessibilitySignals.lineHasError.name","Error on Line"),sound:Qt.error,legacySoundSettingsKey:"audioCues.lineHasError",legacyAnnouncementSettingsKey:"accessibility.alert.error",announcementMessage:p("accessibility.signals.lineHasError","Error on Line"),settingsKey:"accessibility.signals.lineHasError"}),Ge.warningOnLine=Ge.register({name:p("accessibilitySignals.lineHasWarning.name","Warning on Line"),sound:Qt.warning,legacySoundSettingsKey:"audioCues.lineHasWarning",legacyAnnouncementSettingsKey:"accessibility.alert.warning",announcementMessage:p("accessibility.signals.lineHasWarning","Warning on Line"),settingsKey:"accessibility.signals.lineHasWarning"}),Ge.foldedArea=Ge.register({name:p("accessibilitySignals.lineHasFoldedArea.name","Folded Area on Line"),sound:Qt.foldedArea,legacySoundSettingsKey:"audioCues.lineHasFoldedArea",legacyAnnouncementSettingsKey:"accessibility.alert.foldedArea",announcementMessage:p("accessibility.signals.lineHasFoldedArea","Folded"),settingsKey:"accessibility.signals.lineHasFoldedArea"}),Ge.break=Ge.register({name:p("accessibilitySignals.lineHasBreakpoint.name","Breakpoint on Line"),sound:Qt.break,legacySoundSettingsKey:"audioCues.lineHasBreakpoint",legacyAnnouncementSettingsKey:"accessibility.alert.breakpoint",announcementMessage:p("accessibility.signals.lineHasBreakpoint","Breakpoint"),settingsKey:"accessibility.signals.lineHasBreakpoint"}),Ge.inlineSuggestion=Ge.register({name:p("accessibilitySignals.lineHasInlineSuggestion.name","Inline Suggestion on Line"),sound:Qt.quickFixes,legacySoundSettingsKey:"audioCues.lineHasInlineSuggestion",settingsKey:"accessibility.signals.lineHasInlineSuggestion"}),Ge.terminalQuickFix=Ge.register({name:p("accessibilitySignals.terminalQuickFix.name","Terminal Quick Fix"),sound:Qt.quickFixes,legacySoundSettingsKey:"audioCues.terminalQuickFix",legacyAnnouncementSettingsKey:"accessibility.alert.terminalQuickFix",announcementMessage:p("accessibility.signals.terminalQuickFix","Quick Fix"),settingsKey:"accessibility.signals.terminalQuickFix"}),Ge.onDebugBreak=Ge.register({name:p("accessibilitySignals.onDebugBreak.name","Debugger Stopped on Breakpoint"),sound:Qt.break,legacySoundSettingsKey:"audioCues.onDebugBreak",legacyAnnouncementSettingsKey:"accessibility.alert.onDebugBreak",announcementMessage:p("accessibility.signals.onDebugBreak","Breakpoint"),settingsKey:"accessibility.signals.onDebugBreak"}),Ge.noInlayHints=Ge.register({name:p("accessibilitySignals.noInlayHints","No Inlay Hints on Line"),sound:Qt.error,legacySoundSettingsKey:"audioCues.noInlayHints",legacyAnnouncementSettingsKey:"accessibility.alert.noInlayHints",announcementMessage:p("accessibility.signals.noInlayHints","No Inlay Hints"),settingsKey:"accessibility.signals.noInlayHints"}),Ge.taskCompleted=Ge.register({name:p("accessibilitySignals.taskCompleted","Task Completed"),sound:Qt.taskCompleted,legacySoundSettingsKey:"audioCues.taskCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.taskCompleted",announcementMessage:p("accessibility.signals.taskCompleted","Task Completed"),settingsKey:"accessibility.signals.taskCompleted"}),Ge.taskFailed=Ge.register({name:p("accessibilitySignals.taskFailed","Task Failed"),sound:Qt.taskFailed,legacySoundSettingsKey:"audioCues.taskFailed",legacyAnnouncementSettingsKey:"accessibility.alert.taskFailed",announcementMessage:p("accessibility.signals.taskFailed","Task Failed"),settingsKey:"accessibility.signals.taskFailed"}),Ge.terminalCommandFailed=Ge.register({name:p("accessibilitySignals.terminalCommandFailed","Terminal Command Failed"),sound:Qt.error,legacySoundSettingsKey:"audioCues.terminalCommandFailed",legacyAnnouncementSettingsKey:"accessibility.alert.terminalCommandFailed",announcementMessage:p("accessibility.signals.terminalCommandFailed","Command Failed"),settingsKey:"accessibility.signals.terminalCommandFailed"}),Ge.terminalCommandSucceeded=Ge.register({name:p("accessibilitySignals.terminalCommandSucceeded","Terminal Command Succeeded"),sound:Qt.success,announcementMessage:p("accessibility.signals.terminalCommandSucceeded","Command Succeeded"),settingsKey:"accessibility.signals.terminalCommandSucceeded"}),Ge.terminalBell=Ge.register({name:p("accessibilitySignals.terminalBell","Terminal Bell"),sound:Qt.terminalBell,legacySoundSettingsKey:"audioCues.terminalBell",legacyAnnouncementSettingsKey:"accessibility.alert.terminalBell",announcementMessage:p("accessibility.signals.terminalBell","Terminal Bell"),settingsKey:"accessibility.signals.terminalBell"}),Ge.notebookCellCompleted=Ge.register({name:p("accessibilitySignals.notebookCellCompleted","Notebook Cell Completed"),sound:Qt.taskCompleted,legacySoundSettingsKey:"audioCues.notebookCellCompleted",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellCompleted",announcementMessage:p("accessibility.signals.notebookCellCompleted","Notebook Cell Completed"),settingsKey:"accessibility.signals.notebookCellCompleted"}),Ge.notebookCellFailed=Ge.register({name:p("accessibilitySignals.notebookCellFailed","Notebook Cell Failed"),sound:Qt.taskFailed,legacySoundSettingsKey:"audioCues.notebookCellFailed",legacyAnnouncementSettingsKey:"accessibility.alert.notebookCellFailed",announcementMessage:p("accessibility.signals.notebookCellFailed","Notebook Cell Failed"),settingsKey:"accessibility.signals.notebookCellFailed"}),Ge.diffLineInserted=Ge.register({name:p("accessibilitySignals.diffLineInserted","Diff Line Inserted"),sound:Qt.diffLineInserted,legacySoundSettingsKey:"audioCues.diffLineInserted",settingsKey:"accessibility.signals.diffLineInserted"}),Ge.diffLineDeleted=Ge.register({name:p("accessibilitySignals.diffLineDeleted","Diff Line Deleted"),sound:Qt.diffLineDeleted,legacySoundSettingsKey:"audioCues.diffLineDeleted",settingsKey:"accessibility.signals.diffLineDeleted"}),Ge.diffLineModified=Ge.register({name:p("accessibilitySignals.diffLineModified","Diff Line Modified"),sound:Qt.diffLineModified,legacySoundSettingsKey:"audioCues.diffLineModified",settingsKey:"accessibility.signals.diffLineModified"}),Ge.chatRequestSent=Ge.register({name:p("accessibilitySignals.chatRequestSent","Chat Request Sent"),sound:Qt.chatRequestSent,legacySoundSettingsKey:"audioCues.chatRequestSent",legacyAnnouncementSettingsKey:"accessibility.alert.chatRequestSent",announcementMessage:p("accessibility.signals.chatRequestSent","Chat Request Sent"),settingsKey:"accessibility.signals.chatRequestSent"}),Ge.chatResponseReceived=Ge.register({name:p("accessibilitySignals.chatResponseReceived","Chat Response Received"),legacySoundSettingsKey:"audioCues.chatResponseReceived",sound:{randomOneOf:[Qt.chatResponseReceived1,Qt.chatResponseReceived2,Qt.chatResponseReceived3,Qt.chatResponseReceived4]},settingsKey:"accessibility.signals.chatResponseReceived"}),Ge.progress=Ge.register({name:p("accessibilitySignals.progress","Progress"),sound:Qt.progress,legacySoundSettingsKey:"audioCues.chatResponsePending",legacyAnnouncementSettingsKey:"accessibility.alert.progress",announcementMessage:p("accessibility.signals.progress","Progress"),settingsKey:"accessibility.signals.progress"}),Ge.clear=Ge.register({name:p("accessibilitySignals.clear","Clear"),sound:Qt.clear,legacySoundSettingsKey:"audioCues.clear",legacyAnnouncementSettingsKey:"accessibility.alert.clear",announcementMessage:p("accessibility.signals.clear","Clear"),settingsKey:"accessibility.signals.clear"}),Ge.save=Ge.register({name:p("accessibilitySignals.save","Save"),sound:Qt.save,legacySoundSettingsKey:"audioCues.save",legacyAnnouncementSettingsKey:"accessibility.alert.save",announcementMessage:p("accessibility.signals.save","Save"),settingsKey:"accessibility.signals.save"}),Ge.format=Ge.register({name:p("accessibilitySignals.format","Format"),sound:Qt.format,legacySoundSettingsKey:"audioCues.format",legacyAnnouncementSettingsKey:"accessibility.alert.format",announcementMessage:p("accessibility.signals.format","Format"),settingsKey:"accessibility.signals.format"}),Ge.voiceRecordingStarted=Ge.register({name:p("accessibilitySignals.voiceRecordingStarted","Voice Recording Started"),sound:Qt.voiceRecordingStarted,legacySoundSettingsKey:"audioCues.voiceRecordingStarted",settingsKey:"accessibility.signals.voiceRecordingStarted"}),Ge.voiceRecordingStopped=Ge.register({name:p("accessibilitySignals.voiceRecordingStopped","Voice Recording Stopped"),sound:Qt.voiceRecordingStopped,legacySoundSettingsKey:"audioCues.voiceRecordingStopped",settingsKey:"accessibility.signals.voiceRecordingStopped"});let xo=Ge;class Jge extends F{constructor(e,t=[]){super(),this.logger=new Hee([e,...t]),this._register(e.onDidChangeLogLevel(i=>this.setLevel(i)))}get onDidChangeLogLevel(){return this.logger.onDidChangeLogLevel}setLevel(e){this.logger.setLevel(e)}getLevel(){return this.logger.getLevel()}trace(e,...t){this.logger.trace(e,...t)}debug(e,...t){this.logger.debug(e,...t)}info(e,...t){this.logger.info(e,...t)}warn(e,...t){this.logger.warn(e,...t)}error(e,...t){this.logger.error(e,...t)}}const NK=[];function vb(o){NK.push(o)}function efe(){return NK.slice(0)}class tfe{getParseResult(e){}}var Gl=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Pi=function(o,e){return function(t,i){e(t,i,o)}};class ife{constructor(e){this.disposed=!1,this.model=e,this._onWillDispose=new O}get textEditorModel(){return this.model}dispose(){this.disposed=!0,this._onWillDispose.fire()}}let kM=class{constructor(e){this.modelService=e}createModelReference(e){const t=this.modelService.getModel(e);return t?Promise.resolve(new qX(new ife(t))):Promise.reject(new Error("Model not found"))}};kM=Gl([Pi(0,Ut)],kM);const Gk=class Gk{show(){return Gk.NULL_PROGRESS_RUNNER}async showWhile(e,t){await e}};Gk.NULL_PROGRESS_RUNNER={done:()=>{},total:()=>{},worked:()=>{}};let EM=Gk;class nfe{withProgress(e,t,i){return t({report:()=>{}})}}class sfe{constructor(){this.isExtensionDevelopment=!1,this.isBuilt=!1}}class ofe{async confirm(e){return{confirmed:this.doConfirm(e.message,e.detail),checkboxChecked:!1}}doConfirm(e,t){let i=e;return t&&(i=i+`

`+t),It.confirm(i)}async prompt(e){let t;if(this.doConfirm(e.message,e.detail)){const n=[...e.buttons??[]];e.cancelButton&&typeof e.cancelButton!="string"&&typeof e.cancelButton!="boolean"&&n.push(e.cancelButton),t=await n[0]?.run({checkboxChecked:!1})}return{result:t}}async error(e,t){await this.prompt({type:ki.Error,message:e,detail:t})}}const DC=class DC{info(e){return this.notify({severity:ki.Info,message:e})}warn(e){return this.notify({severity:ki.Warning,message:e})}error(e){return this.notify({severity:ki.Error,message:e})}notify(e){switch(e.severity){case ki.Error:console.error(e.message);break;case ki.Warning:console.warn(e.message);break;default:console.log(e.message);break}return DC.NO_OP}prompt(e,t,i,n){return DC.NO_OP}status(e,t){return F.None}};DC.NO_OP=new cne;let TM=DC,DM=class{constructor(e){this._onWillExecuteCommand=new O,this._onDidExecuteCommand=new O,this.onDidExecuteCommand=this._onDidExecuteCommand.event,this._instantiationService=e}executeCommand(e,...t){const i=st.getCommand(e);if(!i)return Promise.reject(new Error(`command '${e}' not found`));try{this._onWillExecuteCommand.fire({commandId:e,args:t});const n=this._instantiationService.invokeFunction.apply(this._instantiationService,[i.handler,...t]);return this._onDidExecuteCommand.fire({commandId:e,args:t}),Promise.resolve(n)}catch(n){return Promise.reject(n)}}};DM=Gl([Pi(0,Ce)],DM);let A_=class extends kae{constructor(e,t,i,n,s,r){super(e,t,i,n,s),this._cachedResolver=null,this._dynamicKeybindings=[],this._domNodeListeners=[];const a=g=>{const f=new $;f.add(H(g,ee.KEY_DOWN,m=>{const _=new Pt(m);this._dispatch(_,_.target)&&(_.preventDefault(),_.stopPropagation())})),f.add(H(g,ee.KEY_UP,m=>{const _=new Pt(m);this._singleModifierDispatch(_,_.target)&&_.preventDefault()})),this._domNodeListeners.push(new rfe(g,f))},l=g=>{for(let f=0;f<this._domNodeListeners.length;f++){const m=this._domNodeListeners[f];m.domNode===g&&(this._domNodeListeners.splice(f,1),m.dispose())}},c=g=>{g.getOption(61)||a(g.getContainerDomNode())},d=g=>{g.getOption(61)||l(g.getContainerDomNode())};this._register(r.onCodeEditorAdd(c)),this._register(r.onCodeEditorRemove(d)),r.listCodeEditors().forEach(c);const h=g=>{a(g.getContainerDomNode())},u=g=>{l(g.getContainerDomNode())};this._register(r.onDiffEditorAdd(h)),this._register(r.onDiffEditorRemove(u)),r.listDiffEditors().forEach(h)}addDynamicKeybinding(e,t,i,n){return Wr(st.registerCommand(e,i),this.addDynamicKeybindings([{keybinding:t,command:e,when:n}]))}addDynamicKeybindings(e){const t=e.map(i=>({keybinding:iP(i.keybinding,Js),command:i.command??null,commandArgs:i.commandArgs,when:i.when,weight1:1e3,weight2:0,extensionId:null,isBuiltinExtension:!1}));return this._dynamicKeybindings=this._dynamicKeybindings.concat(t),this.updateResolver(),ve(()=>{for(let i=0;i<this._dynamicKeybindings.length;i++)if(this._dynamicKeybindings[i]===t[0]){this._dynamicKeybindings.splice(i,t.length),this.updateResolver();return}})}updateResolver(){this._cachedResolver=null,this._onDidUpdateKeybindings.fire()}_getResolver(){if(!this._cachedResolver){const e=this._toNormalizedKeybindingItems(fs.getDefaultKeybindings(),!0),t=this._toNormalizedKeybindingItems(this._dynamicKeybindings,!1);this._cachedResolver=new Vv(e,t,i=>this._log(i))}return this._cachedResolver}_documentHasFocus(){return It.document.hasFocus()}_toNormalizedKeybindingItems(e,t){const i=[];let n=0;for(const s of e){const r=s.when||void 0,a=s.keybinding;if(!a)i[n++]=new IH(void 0,s.command,s.commandArgs,r,t,null,!1);else{const l=fy.resolveKeybinding(a,Js);for(const c of l)i[n++]=new IH(c,s.command,s.commandArgs,r,t,null,!1)}}return i}resolveKeyboardEvent(e){const t=new $c(e.ctrlKey,e.shiftKey,e.altKey,e.metaKey,e.keyCode);return new fy([t],Js)}};A_=Gl([Pi(0,Ee),Pi(1,Ft),Pi(2,Fn),Pi(3,Ei),Pi(4,Tn),Pi(5,gt)],A_);class rfe extends F{constructor(e,t){super(),this.domNode=e,this._register(t)}}function U7(o){return o&&typeof o=="object"&&(!o.overrideIdentifier||typeof o.overrideIdentifier=="string")&&(!o.resource||o.resource instanceof ye)}let Hx=class{constructor(e){this.logService=e,this._onDidChangeConfiguration=new O,this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;const t=new Xge(e);this._configuration=new WT(t.reload(),gn.createEmptyModel(e),gn.createEmptyModel(e),gn.createEmptyModel(e),gn.createEmptyModel(e),gn.createEmptyModel(e),new on,gn.createEmptyModel(e),new on,e),t.dispose()}getValue(e,t){const i=typeof e=="string"?e:void 0,n=U7(e)?e:U7(t)?t:{};return this._configuration.getValue(i,n,void 0)}updateValues(e){const t={data:this._configuration.toData()},i=[];for(const n of e){const[s,r]=n;this.getValue(s)!==r&&(this._configuration.updateValue(s,r),i.push(s))}if(i.length>0){const n=new yae({keys:i,overrides:[]},t,this._configuration,void 0,this.logService);n.source=8,this._onDidChangeConfiguration.fire(n)}return Promise.resolve()}updateValue(e,t,i,n){return this.updateValues([[e,t]])}inspect(e,t={}){return this._configuration.inspect(e,t,void 0)}};Hx=Gl([Pi(0,Tn)],Hx);let IM=class{constructor(e,t,i){this.configurationService=e,this.modelService=t,this.languageService=i,this._onDidChangeConfiguration=new O,this.configurationService.onDidChangeConfiguration(n=>{this._onDidChangeConfiguration.fire({affectedKeys:n.affectedKeys,affectsConfiguration:(s,r)=>n.affectsConfiguration(r)})})}getValue(e,t,i){const n=A.isIPosition(t)?t:null,s=n?typeof i=="string"?i:void 0:typeof t=="string"?t:void 0,r=e?this.getLanguage(e,n):void 0;return typeof s>"u"?this.configurationService.getValue({resource:e,overrideIdentifier:r}):this.configurationService.getValue(s,{resource:e,overrideIdentifier:r})}getLanguage(e,t){const i=this.modelService.getModel(e);return i?t?i.getLanguageIdAtPosition(t.lineNumber,t.column):i.getLanguageId():this.languageService.guessLanguageIdByFilepathOrFirstLine(e)}};IM=Gl([Pi(0,Ke),Pi(1,Ut),Pi(2,ti)],IM);let NM=class{constructor(e){this.configurationService=e}getEOL(e,t){const i=this.configurationService.getValue("files.eol",{overrideIdentifier:t,resource:e});return i&&typeof i=="string"&&i!=="auto"?i:us||Qe?`
`:`\r
`}};NM=Gl([Pi(0,Ke)],NM);class afe{publicLog2(){}}const IC=class IC{constructor(){const e=ye.from({scheme:IC.SCHEME,authority:"model",path:"/"});this.workspace={id:VG,folders:[new Vae({uri:e,name:"",index:0})]}}getWorkspace(){return this.workspace}getWorkspaceFolder(e){return e&&e.scheme===IC.SCHEME?this.workspace.folders[0]:null}};IC.SCHEME="inmemory";let RM=IC;function zx(o,e,t){if(!e||!(o instanceof Hx))return;const i=[];Object.keys(e).forEach(n=>{mae(n)&&i.push([`editor.${n}`,e[n]]),t&&_ae(n)&&i.push([`diffEditor.${n}`,e[n]])}),i.length>0&&o.updateValues(i)}let PM=class{constructor(e){this._modelService=e}hasPreviewHandler(){return!1}async apply(e,t){const i=Array.isArray(e)?e:R5.convert(e),n=new Map;for(const a of i){if(!(a instanceof sh))throw new Error("bad edit - only text edits are supported");const l=this._modelService.getModel(a.resource);if(!l)throw new Error("bad edit - model not found");if(typeof a.versionId=="number"&&l.getVersionId()!==a.versionId)throw new Error("bad state - model changed in the meantime");let c=n.get(l);c||(c=[],n.set(l,c)),c.push(si.replaceMove(L.lift(a.textEdit.range),a.textEdit.text))}let s=0,r=0;for(const[a,l]of n)a.pushStackElement(),a.pushEditOperations([],l,()=>[]),a.pushStackElement(),r+=1,s+=l.length;return{ariaSummary:mf(bA.bulkEditServiceSummary,s,r),isApplied:s>0}}};PM=Gl([Pi(0,Ut)],PM);class lfe{getUriLabel(e,t){return e.scheme==="file"?e.fsPath:e.path}getUriBasenameLabel(e){return fr(e)}}let AM=class extends hae{constructor(e,t){super(e),this._codeEditorService=t}showContextView(e,t,i){if(!t){const n=this._codeEditorService.getFocusedCodeEditor()||this._codeEditorService.getActiveCodeEditor();n&&(t=n.getContainerDomNode())}return super.showContextView(e,t,i)}};AM=Gl([Pi(0,qh),Pi(1,gt)],AM);class cfe{constructor(){this._neverEmitter=new O,this.onDidChangeTrust=this._neverEmitter.event}isWorkspaceTrusted(){return!0}}class dfe extends xA{constructor(){super()}}class hfe extends Jge{constructor(){super(new Vee)}}let MM=class extends AA{constructor(e,t,i,n,s,r){super(e,t,i,n,s,r),this.configure({blockMouse:!1})}};MM=Gl([Pi(0,Fn),Pi(1,Ei),Pi(2,sd),Pi(3,vt),Pi(4,zo),Pi(5,Ee)],MM);const OM={amdModuleId:"vs/editor/common/services/editorSimpleWorker",esmModuleLocation:void 0,label:"editorWorkerService"};let FM=class extends IP{constructor(e,t,i,n,s){super(OM,e,t,i,n,s)}};FM=Gl([Pi(0,Ut),Pi(1,wT),Pi(2,Tn),Pi(3,li),Pi(4,ue)],FM);class ufe{async playSignal(e,t){}}it(Tn,hfe,0);it(Ke,Hx,0);it(wT,IM,0);it(OU,NM,0);it(Lf,RM,0);it(E_,lfe,0);it(Fn,afe,0);it(Tw,ofe,0);it(o5,sfe,0);it(Ei,TM,0);it(Ul,xd,0);it(ti,dfe,0);it(Ko,Pge,0);it(Ut,qA,0);it(H5,WA,0);it(Ee,LM,0);it(WG,nfe,0);it(Yh,EM,0);it(Yr,Jle,0);it(Bs,FM,0);it(Pw,PM,0);it(HG,cfe,0);it(Ms,kM,0);it(ho,bM,0);it(Cr,Kue,0);it(Ft,DM,0);it(vt,A_,0);it(vr,pM,0);it(sd,AM,0);it(Fs,BA,0);it(ad,SM,0);it(co,MM,0);it(zo,vM,0);it(Jh,ufe,0);it(B$,tfe,0);var Ie;(function(o){const e=new bb;for(const[l,c]of iV())e.set(l,c);const t=new Vx(e,!0);e.set(Ce,t);function i(l){n||r({});const c=e.get(l);if(!c)throw new Error("Missing service "+l);return c instanceof hl?t.invokeFunction(d=>d.get(l)):c}o.get=i;let n=!1;const s=new O;function r(l){if(n)return t;n=!0;for(const[d,h]of iV())e.get(d)||e.set(d,h);for(const d in l)if(l.hasOwnProperty(d)){const h=Je(d);e.get(h)instanceof hl&&e.set(h,l[d])}const c=efe();for(const d of c)try{t.createInstance(d)}catch(h){Ae(h)}return s.fire(),t}o.initialize=r;function a(l){if(n)return l();const c=new $,d=c.add(s.event(()=>{d.dispose(),c.add(l())}));return c}o.withServices=a})(Ie||(Ie={}));function gfe(o,e){return new ffe(o,e)}class ffe extends $0{constructor(e,t){const i={amdModuleId:OM.amdModuleId,esmModuleLocation:OM.esmModuleLocation,label:t.label};super(i,t.keepIdleModels||!1,e),this._foreignModuleId=t.moduleId,this._foreignModuleCreateData=t.createData||null,this._foreignModuleHost=t.host||null,this._foreignProxy=null}fhr(e,t){if(!this._foreignModuleHost||typeof this._foreignModuleHost[e]!="function")return Promise.reject(new Error("Missing method "+e+" or missing main thread foreign host."));try{return Promise.resolve(this._foreignModuleHost[e].apply(this._foreignModuleHost,t))}catch(i){return Promise.reject(i)}}_getForeignProxy(){return this._foreignProxy||(this._foreignProxy=this._getProxy().then(e=>{const t=this._foreignModuleHost?qN(this._foreignModuleHost):[];return e.$loadForeignModule(this._foreignModuleId,this._foreignModuleCreateData,t).then(i=>{this._foreignModuleCreateData=null;const n=(a,l)=>e.$fmr(a,l),s=(a,l)=>function(){const c=Array.prototype.slice.call(arguments,0);return l(a,c)},r={};for(const a of i)r[a]=s(a,n);return r})})),this._foreignProxy}getProxy(){return this._getForeignProxy()}withSyncedResources(e){return this.workerWithSyncedResources(e).then(t=>this.getProxy())}}const Gw={ICodeEditor:"vs.editor.ICodeEditor",IDiffEditor:"vs.editor.IDiffEditor"};class as{constructor(e,t,i,n){this.startColumn=e,this.endColumn=t,this.className=i,this.type=n,this._lineDecorationBrand=void 0}static _equals(e,t){return e.startColumn===t.startColumn&&e.endColumn===t.endColumn&&e.className===t.className&&e.type===t.type}static equalsArr(e,t){const i=e.length,n=t.length;if(i!==n)return!1;for(let s=0;s<i;s++)if(!as._equals(e[s],t[s]))return!1;return!0}static extractWrapped(e,t,i){if(e.length===0)return e;const n=t+1,s=i+1,r=i-t,a=[];let l=0;for(const c of e)c.endColumn<=n||c.startColumn>=s||(a[l++]=new as(Math.max(1,c.startColumn-n+1),Math.min(r+1,c.endColumn-n+1),c.className,c.type));return a}static filter(e,t,i,n){if(e.length===0)return[];const s=[];let r=0;for(let a=0,l=e.length;a<l;a++){const c=e[a],d=c.range;if(d.endLineNumber<t||d.startLineNumber>t||d.isEmpty()&&(c.type===0||c.type===3))continue;const h=d.startLineNumber===t?d.startColumn:i,u=d.endLineNumber===t?d.endColumn:n;s[r++]=new as(h,u,c.inlineClassName,c.type)}return s}static _typeCompare(e,t){const i=[2,0,1,3];return i[e]-i[t]}static compare(e,t){if(e.startColumn!==t.startColumn)return e.startColumn-t.startColumn;if(e.endColumn!==t.endColumn)return e.endColumn-t.endColumn;const i=as._typeCompare(e.type,t.type);return i!==0?i:e.className!==t.className?e.className<t.className?-1:1:0}}class G7{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.className=i,this.metadata=n}}class Ux{constructor(){this.stopOffsets=[],this.classNames=[],this.metadata=[],this.count=0}static _metadata(e){let t=0;for(let i=0,n=e.length;i<n;i++)t|=e[i];return t}consumeLowerThan(e,t,i){for(;this.count>0&&this.stopOffsets[0]<e;){let n=0;for(;n+1<this.count&&this.stopOffsets[n]===this.stopOffsets[n+1];)n++;i.push(new G7(t,this.stopOffsets[n],this.classNames.join(" "),Ux._metadata(this.metadata))),t=this.stopOffsets[n]+1,this.stopOffsets.splice(0,n+1),this.classNames.splice(0,n+1),this.metadata.splice(0,n+1),this.count-=n+1}return this.count>0&&t<e&&(i.push(new G7(t,e-1,this.classNames.join(" "),Ux._metadata(this.metadata))),t=e),t}insert(e,t,i){if(this.count===0||this.stopOffsets[this.count-1]<=e)this.stopOffsets.push(e),this.classNames.push(t),this.metadata.push(i);else for(let n=0;n<this.count;n++)if(this.stopOffsets[n]>=e){this.stopOffsets.splice(n,0,e),this.classNames.splice(n,0,t),this.metadata.splice(n,0,i);break}this.count++}}class pfe{static normalize(e,t){if(t.length===0)return[];const i=[],n=new Ux;let s=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];let c=l.startColumn,d=l.endColumn;const h=l.className,u=l.type===1?2:l.type===2?4:0;if(c>1){const m=e.charCodeAt(c-2);$i(m)&&c--}if(d>1){const m=e.charCodeAt(d-2);$i(m)&&d--}const g=c-1,f=d-2;s=n.consumeLowerThan(g,s,i),n.count===0&&(s=g),n.insert(f,h,u)}return n.consumeLowerThan(1073741824,s,i),i}}class tn{constructor(e,t,i,n){this.endIndex=e,this.type=t,this.metadata=i,this.containsRTL=n,this._linePartBrand=void 0}isWhitespace(){return!!(this.metadata&1)}isPseudoAfter(){return!!(this.metadata&4)}}class RK{constructor(e,t){this.startOffset=e,this.endOffset=t}equals(e){return this.startOffset===e.startOffset&&this.endOffset===e.endOffset}}class eu{constructor(e,t,i,n,s,r,a,l,c,d,h,u,g,f,m,_,b,v,y){this.useMonospaceOptimizations=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.continuesWithWrappedLine=n,this.isBasicASCII=s,this.containsRTL=r,this.fauxIndentLength=a,this.lineTokens=l,this.lineDecorations=c.sort(as.compare),this.tabSize=d,this.startVisibleColumn=h,this.spaceWidth=u,this.stopRenderingLineAfter=m,this.renderWhitespace=_==="all"?4:_==="boundary"?1:_==="selection"?2:_==="trailing"?3:0,this.renderControlCharacters=b,this.fontLigatures=v,this.selectionsOnLine=y&&y.sort((x,k)=>x.startOffset<k.startOffset?-1:1);const C=Math.abs(f-u),w=Math.abs(g-u);C<w?(this.renderSpaceWidth=f,this.renderSpaceCharCode=11825):(this.renderSpaceWidth=g,this.renderSpaceCharCode=183)}sameSelection(e){if(this.selectionsOnLine===null)return e===null;if(e===null||e.length!==this.selectionsOnLine.length)return!1;for(let t=0;t<this.selectionsOnLine.length;t++)if(!this.selectionsOnLine[t].equals(e[t]))return!1;return!0}equals(e){return this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineContent===e.lineContent&&this.continuesWithWrappedLine===e.continuesWithWrappedLine&&this.isBasicASCII===e.isBasicASCII&&this.containsRTL===e.containsRTL&&this.fauxIndentLength===e.fauxIndentLength&&this.tabSize===e.tabSize&&this.startVisibleColumn===e.startVisibleColumn&&this.spaceWidth===e.spaceWidth&&this.renderSpaceWidth===e.renderSpaceWidth&&this.renderSpaceCharCode===e.renderSpaceCharCode&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.fontLigatures===e.fontLigatures&&as.equalsArr(this.lineDecorations,e.lineDecorations)&&this.lineTokens.equals(e.lineTokens)&&this.sameSelection(e.selectionsOnLine)}}class PK{constructor(e,t){this.partIndex=e,this.charIndex=t}}class ul{static getPartIndex(e){return(e&4294901760)>>>16}static getCharIndex(e){return(e&65535)>>>0}constructor(e,t){this.length=e,this._data=new Uint32Array(this.length),this._horizontalOffset=new Uint32Array(this.length)}setColumnInfo(e,t,i,n){const s=(t<<16|i<<0)>>>0;this._data[e-1]=s,this._horizontalOffset[e-1]=n}getHorizontalOffset(e){return this._horizontalOffset.length===0?0:this._horizontalOffset[e-1]}charOffsetToPartData(e){return this.length===0?0:e<0?this._data[0]:e>=this.length?this._data[this.length-1]:this._data[e]}getDomPosition(e){const t=this.charOffsetToPartData(e-1),i=ul.getPartIndex(t),n=ul.getCharIndex(t);return new PK(i,n)}getColumn(e,t){return this.partDataToCharOffset(e.partIndex,t,e.charIndex)+1}partDataToCharOffset(e,t,i){if(this.length===0)return 0;const n=(e<<16|i<<0)>>>0;let s=0,r=this.length-1;for(;s+1<r;){const m=s+r>>>1,_=this._data[m];if(_===n)return m;_>n?r=m:s=m}if(s===r)return s;const a=this._data[s],l=this._data[r];if(a===n)return s;if(l===n)return r;const c=ul.getPartIndex(a),d=ul.getCharIndex(a),h=ul.getPartIndex(l);let u;c!==h?u=t:u=ul.getCharIndex(l);const g=i-d,f=u-i;return g<=f?s:r}}class BM{constructor(e,t,i){this._renderLineOutputBrand=void 0,this.characterMapping=e,this.containsRTL=t,this.containsForeignElements=i}}function $w(o,e){if(o.lineContent.length===0){if(o.lineDecorations.length>0){e.appendString("<span>");let t=0,i=0,n=0;for(const r of o.lineDecorations)(r.type===1||r.type===2)&&(e.appendString('<span class="'),e.appendString(r.className),e.appendString('"></span>'),r.type===1&&(n|=1,t++),r.type===2&&(n|=2,i++));e.appendString("</span>");const s=new ul(1,t+i);return s.setColumnInfo(1,t,0,0),new BM(s,!1,n)}return e.appendString("<span><span></span></span>"),new BM(new ul(0,0),!1,0)}return xfe(bfe(o),e)}class mfe{constructor(e,t,i,n){this.characterMapping=e,this.html=t,this.containsRTL=i,this.containsForeignElements=n}}function iD(o){const e=new rb(1e4),t=$w(o,e);return new mfe(t.characterMapping,e.build(),t.containsRTL,t.containsForeignElements)}class _fe{constructor(e,t,i,n,s,r,a,l,c,d,h,u,g,f,m,_){this.fontIsMonospace=e,this.canUseHalfwidthRightwardsArrow=t,this.lineContent=i,this.len=n,this.isOverflowing=s,this.overflowingCharCount=r,this.parts=a,this.containsForeignElements=l,this.fauxIndentLength=c,this.tabSize=d,this.startVisibleColumn=h,this.containsRTL=u,this.spaceWidth=g,this.renderSpaceCharCode=f,this.renderWhitespace=m,this.renderControlCharacters=_}}function bfe(o){const e=o.lineContent;let t,i,n;o.stopRenderingLineAfter!==-1&&o.stopRenderingLineAfter<e.length?(t=!0,i=e.length-o.stopRenderingLineAfter,n=o.stopRenderingLineAfter):(t=!1,i=0,n=e.length);let s=vfe(e,o.containsRTL,o.lineTokens,o.fauxIndentLength,n);o.renderControlCharacters&&!o.isBasicASCII&&(s=yfe(e,s)),(o.renderWhitespace===4||o.renderWhitespace===1||o.renderWhitespace===2&&o.selectionsOnLine||o.renderWhitespace===3&&!o.continuesWithWrappedLine)&&(s=wfe(o,e,n,s));let r=0;if(o.lineDecorations.length>0){for(let a=0,l=o.lineDecorations.length;a<l;a++){const c=o.lineDecorations[a];c.type===3||c.type===1?r|=1:c.type===2&&(r|=2)}s=Sfe(e,n,s,o.lineDecorations)}return o.containsRTL||(s=Cfe(e,s,!o.isBasicASCII||o.fontLigatures)),new _fe(o.useMonospaceOptimizations,o.canUseHalfwidthRightwardsArrow,e,n,t,i,s,r,o.fauxIndentLength,o.tabSize,o.startVisibleColumn,o.containsRTL,o.spaceWidth,o.renderSpaceCharCode,o.renderWhitespace,o.renderControlCharacters)}function vfe(o,e,t,i,n){const s=[];let r=0;i>0&&(s[r++]=new tn(i,"",0,!1));let a=i;for(let l=0,c=t.getCount();l<c;l++){const d=t.getEndOffset(l);if(d<=i)continue;const h=t.getClassName(l);if(d>=n){const g=e?p_(o.substring(a,n)):!1;s[r++]=new tn(n,h,0,g);break}const u=e?p_(o.substring(a,d)):!1;s[r++]=new tn(d,h,0,u),a=d}return s}function Cfe(o,e,t){let i=0;const n=[];let s=0;if(t)for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex;if(i+50<c){const d=l.type,h=l.metadata,u=l.containsRTL;let g=-1,f=i;for(let m=i;m<c;m++)o.charCodeAt(m)===32&&(g=m),g!==-1&&m-f>=50&&(n[s++]=new tn(g+1,d,h,u),f=g+1,g=-1);f!==c&&(n[s++]=new tn(c,d,h,u))}else n[s++]=l;i=c}else for(let r=0,a=e.length;r<a;r++){const l=e[r],c=l.endIndex,d=c-i;if(d>50){const h=l.type,u=l.metadata,g=l.containsRTL,f=Math.ceil(d/50);for(let m=1;m<f;m++){const _=i+m*50;n[s++]=new tn(_,h,u,g)}n[s++]=new tn(c,h,u,g)}else n[s++]=l;i=c}return n}function AK(o){return o<32?o!==9:o===127||o>=8234&&o<=8238||o>=8294&&o<=8297||o>=8206&&o<=8207||o===1564}function yfe(o,e){const t=[];let i=new tn(0,"",0,!1),n=0;for(const s of e){const r=s.endIndex;for(;n<r;n++){const a=o.charCodeAt(n);AK(a)&&(n>i.endIndex&&(i=new tn(n,s.type,s.metadata,s.containsRTL),t.push(i)),i=new tn(n+1,"mtkcontrol",s.metadata,!1),t.push(i))}n>i.endIndex&&(i=new tn(r,s.type,s.metadata,s.containsRTL),t.push(i))}return t}function wfe(o,e,t,i){const n=o.continuesWithWrappedLine,s=o.fauxIndentLength,r=o.tabSize,a=o.startVisibleColumn,l=o.useMonospaceOptimizations,c=o.selectionsOnLine,d=o.renderWhitespace===1,h=o.renderWhitespace===3,u=o.renderSpaceWidth!==o.spaceWidth,g=[];let f=0,m=0,_=i[m].type,b=i[m].containsRTL,v=i[m].endIndex;const y=i.length;let C=!1,w=Xn(e),x;w===-1?(C=!0,w=t,x=t):x=Sa(e);let k=!1,E=0,N=c&&c[E],z=a%r;for(let U=s;U<t;U++){const Z=e.charCodeAt(U);N&&U>=N.endOffset&&(E++,N=c&&c[E]);let V;if(U<w||U>x)V=!0;else if(Z===9)V=!0;else if(Z===32)if(d)if(k)V=!0;else{const Q=U+1<t?e.charCodeAt(U+1):0;V=Q===32||Q===9}else V=!0;else V=!1;if(V&&c&&(V=!!N&&N.startOffset<=U&&N.endOffset>U),V&&h&&(V=C||U>x),V&&b&&U>=w&&U<=x&&(V=!1),k){if(!V||!l&&z>=r){if(u){const Q=f>0?g[f-1].endIndex:s;for(let le=Q+1;le<=U;le++)g[f++]=new tn(le,"mtkw",1,!1)}else g[f++]=new tn(U,"mtkw",1,!1);z=z%r}}else(U===v||V&&U>s)&&(g[f++]=new tn(U,_,0,b),z=z%r);for(Z===9?z=r:Ih(Z)?z+=2:z++,k=V;U===v&&(m++,m<y);)_=i[m].type,b=i[m].containsRTL,v=i[m].endIndex}let B=!1;if(k)if(n&&d){const U=t>0?e.charCodeAt(t-1):0,Z=t>1?e.charCodeAt(t-2):0;U===32&&Z!==32&&Z!==9||(B=!0)}else B=!0;if(B)if(u){const U=f>0?g[f-1].endIndex:s;for(let Z=U+1;Z<=t;Z++)g[f++]=new tn(Z,"mtkw",1,!1)}else g[f++]=new tn(t,"mtkw",1,!1);else g[f++]=new tn(t,_,0,b);return g}function Sfe(o,e,t,i){i.sort(as.compare);const n=pfe.normalize(o,i),s=n.length;let r=0;const a=[];let l=0,c=0;for(let h=0,u=t.length;h<u;h++){const g=t[h],f=g.endIndex,m=g.type,_=g.metadata,b=g.containsRTL;for(;r<s&&n[r].startOffset<f;){const v=n[r];if(v.startOffset>c&&(c=v.startOffset,a[l++]=new tn(c,m,_,b)),v.endOffset+1<=f)c=v.endOffset+1,a[l++]=new tn(c,m+" "+v.className,_|v.metadata,b),r++;else{c=f,a[l++]=new tn(c,m+" "+v.className,_|v.metadata,b);break}}f>c&&(c=f,a[l++]=new tn(c,m,_,b))}const d=t[t.length-1].endIndex;if(r<s&&n[r].startOffset===d)for(;r<s&&n[r].startOffset===d;){const h=n[r];a[l++]=new tn(c,h.className,h.metadata,!1),r++}return a}function xfe(o,e){const t=o.fontIsMonospace,i=o.canUseHalfwidthRightwardsArrow,n=o.containsForeignElements,s=o.lineContent,r=o.len,a=o.isOverflowing,l=o.overflowingCharCount,c=o.parts,d=o.fauxIndentLength,h=o.tabSize,u=o.startVisibleColumn,g=o.containsRTL,f=o.spaceWidth,m=o.renderSpaceCharCode,_=o.renderWhitespace,b=o.renderControlCharacters,v=new ul(r+1,c.length);let y=!1,C=0,w=u,x=0,k=0,E=0;g?e.appendString('<span dir="ltr">'):e.appendString("<span>");for(let N=0,z=c.length;N<z;N++){const B=c[N],U=B.endIndex,Z=B.type,V=B.containsRTL,Q=_!==0&&B.isWhitespace(),le=Q&&!t&&(Z==="mtkw"||!n),ge=C===U&&B.isPseudoAfter();if(x=0,e.appendString("<span "),V&&e.appendString('style="unicode-bidi:isolate" '),e.appendString('class="'),e.appendString(le?"mtkz":Z),e.appendASCIICharCode(34),Q){let _e=0;{let he=C,Ne=w;for(;he<U;he++){const Xt=(s.charCodeAt(he)===9?h-Ne%h:1)|0;_e+=Xt,he>=d&&(Ne+=Xt)}}for(le&&(e.appendString(' style="width:'),e.appendString(String(f*_e)),e.appendString('px"')),e.appendASCIICharCode(62);C<U;C++){v.setColumnInfo(C+1,N-E,x,k),E=0;const he=s.charCodeAt(C);let Ne,Pe;if(he===9){Ne=h-w%h|0,Pe=Ne,!i||Pe>1?e.appendCharCode(8594):e.appendCharCode(65515);for(let Xt=2;Xt<=Pe;Xt++)e.appendCharCode(160)}else Ne=2,Pe=1,e.appendCharCode(m),e.appendCharCode(8204);x+=Ne,k+=Pe,C>=d&&(w+=Pe)}}else for(e.appendASCIICharCode(62);C<U;C++){v.setColumnInfo(C+1,N-E,x,k),E=0;const _e=s.charCodeAt(C);let he=1,Ne=1;switch(_e){case 9:he=h-w%h,Ne=he;for(let Pe=1;Pe<=he;Pe++)e.appendCharCode(160);break;case 32:e.appendCharCode(160);break;case 60:e.appendString("&lt;");break;case 62:e.appendString("&gt;");break;case 38:e.appendString("&amp;");break;case 0:b?e.appendCharCode(9216):e.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:e.appendCharCode(65533);break;default:Ih(_e)&&Ne++,b&&_e<32?e.appendCharCode(9216+_e):b&&_e===127?e.appendCharCode(9249):b&&AK(_e)?(e.appendString("[U+"),e.appendString(Lfe(_e)),e.appendString("]"),he=8,Ne=he):e.appendCharCode(_e)}x+=he,k+=Ne,C>=d&&(w+=Ne)}ge?E++:E=0,C>=r&&!y&&B.isPseudoAfter()&&(y=!0,v.setColumnInfo(C+1,N,x,k)),e.appendString("</span>")}return y||v.setColumnInfo(r+1,c.length-1,x,k),a&&(e.appendString('<span class="mtkoverflow">'),e.appendString(p("showMore","Show more ({0})",kfe(l))),e.appendString("</span>")),e.appendString("</span>"),new BM(v,g,n)}function Lfe(o){return o.toString(16).toUpperCase().padStart(4,"0")}function kfe(o){return o<1024?p("overflow.chars","{0} chars",o):o<1024*1024?`${(o/1024).toFixed(1)} KB`:`${(o/1024/1024).toFixed(1)} MB`}class $7{constructor(e,t,i,n){this._viewportBrand=void 0,this.top=e|0,this.left=t|0,this.width=i|0,this.height=n|0}}class Efe{constructor(e,t){this.tabSize=e,this.data=t}}class CB{constructor(e,t,i,n,s,r,a){this._viewLineDataBrand=void 0,this.content=e,this.continuesWithWrappedLine=t,this.minColumn=i,this.maxColumn=n,this.startVisibleColumn=s,this.tokens=r,this.inlineDecorations=a}}class Vo{constructor(e,t,i,n,s,r,a,l,c,d){this.minColumn=e,this.maxColumn=t,this.content=i,this.continuesWithWrappedLine=n,this.isBasicASCII=Vo.isBasicASCII(i,r),this.containsRTL=Vo.containsRTL(i,this.isBasicASCII,s),this.tokens=a,this.inlineDecorations=l,this.tabSize=c,this.startVisibleColumn=d}static isBasicASCII(e,t){return t?Sw(e):!0}static containsRTL(e,t,i){return!t&&i?p_(e):!1}}class Qv{constructor(e,t,i){this.range=e,this.inlineClassName=t,this.type=i}}class Tfe{constructor(e,t,i,n){this.startOffset=e,this.endOffset=t,this.inlineClassName=i,this.inlineClassNameAffectsLetterSpacing=n}toInlineDecoration(e){return new Qv(new L(e,this.startOffset+1,e,this.endOffset+1),this.inlineClassName,this.inlineClassNameAffectsLetterSpacing?3:0)}}class MK{constructor(e,t){this._viewModelDecorationBrand=void 0,this.range=e,this.options=t}}class Dy{constructor(e,t,i){this.color=e,this.zIndex=t,this.data=i}static compareByRenderingProps(e,t){return e.zIndex===t.zIndex?e.color<t.color?-1:e.color>t.color?1:0:e.zIndex-t.zIndex}static equals(e,t){return e.color===t.color&&e.zIndex===t.zIndex&&ei(e.data,t.data)}static equalsArr(e,t){return ei(e,t,Dy.equals)}}function Dfe(o){return Array.isArray(o)}function Ife(o){return!Dfe(o)}function OK(o){return typeof o=="string"}function K7(o){return!OK(o)}function Vu(o){return!o}function Vc(o,e){return o.ignoreCase&&e?e.toLowerCase():e}function j7(o){return o.replace(/[&<>'"_]/g,"-")}function Nfe(o,e){console.log(`${o.languageId}: ${e}`)}function Kt(o,e){return new Error(`${o.languageId}: ${e}`)}function Ad(o,e,t,i,n){const s=/\$((\$)|(#)|(\d\d?)|[sS](\d\d?)|@(\w+))/g;let r=null;return e.replace(s,function(a,l,c,d,h,u,g,f,m){return Vu(c)?Vu(d)?!Vu(h)&&h<i.length?Vc(o,i[h]):!Vu(g)&&o&&typeof o[g]=="string"?o[g]:(r===null&&(r=n.split("."),r.unshift(n)),!Vu(u)&&u<r.length?Vc(o,r[u]):""):Vc(o,t):"$"})}function Rfe(o,e,t){const i=/\$[sS](\d\d?)/g;let n=null;return e.replace(i,function(s,r){return n===null&&(n=t.split("."),n.unshift(t)),!Vu(r)&&r<n.length?Vc(o,n[r]):""})}function jS(o,e){let t=e;for(;t&&t.length>0;){const i=o.tokenizer[t];if(i)return i;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return null}function Pfe(o,e){let t=e;for(;t&&t.length>0;){if(o.stateNames[t])return!0;const n=t.lastIndexOf(".");n<0?t=null:t=t.substr(0,n)}return!1}var Afe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Mfe=function(o,e){return function(t,i){e(t,i,o)}},WM;const FK=5,$k=class $k{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new $m(e,t);let i=$m.getStackElementId(e);i.length>0&&(i+="|"),i+=t;let n=this._entries[i];return n||(n=new $m(e,t),this._entries[i]=n,n)}};$k._INSTANCE=new $k(FK);let Iy=$k;class $m{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}equals(e){return $m._equals(this,e)}push(e){return Iy.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return Iy.create(this.parent,e)}}class em{constructor(e,t){this.languageId=e,this.state=t}equals(e){return this.languageId===e.languageId&&this.state.equals(e.state)}clone(){return this.state.clone()===this.state?this:new em(this.languageId,this.state)}}const Kk=class Kk{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(t!==null)return new Jv(e,t);if(e!==null&&e.depth>=this._maxCacheDepth)return new Jv(e,t);const i=$m.getStackElementId(e);let n=this._entries[i];return n||(n=new Jv(e,null),this._entries[i]=n,n)}};Kk._INSTANCE=new Kk(FK);let Md=Kk;class Jv{constructor(e,t){this.stack=e,this.embeddedLanguageData=t}clone(){return(this.embeddedLanguageData?this.embeddedLanguageData.clone():null)===this.embeddedLanguageData?this:Md.create(this.stack,this.embeddedLanguageData)}equals(e){return!(e instanceof Jv)||!this.stack.equals(e.stack)?!1:this.embeddedLanguageData===null&&e.embeddedLanguageData===null?!0:this.embeddedLanguageData===null||e.embeddedLanguageData===null?!1:this.embeddedLanguageData.equals(e.embeddedLanguageData)}}class Ofe{constructor(){this._tokens=[],this._languageId=null,this._lastTokenType=null,this._lastTokenLanguage=null}enterLanguage(e){this._languageId=e}emit(e,t){this._lastTokenType===t&&this._lastTokenLanguage===this._languageId||(this._lastTokenType=t,this._lastTokenLanguage=this._languageId,this._tokens.push(new UC(e,t,this._languageId)))}nestedLanguageTokenize(e,t,i,n){const s=i.languageId,r=i.state,a=gi.get(s);if(!a)return this.enterLanguage(s),this.emit(n,""),r;const l=a.tokenize(e,t,r);if(n!==0)for(const c of l.tokens)this._tokens.push(new UC(c.offset+n,c.type,c.language));else this._tokens=this._tokens.concat(l.tokens);return this._lastTokenType=null,this._lastTokenLanguage=null,this._languageId=null,l.endState}finalize(e){return new D4(this._tokens,e)}}class Gx{constructor(e,t){this._languageService=e,this._theme=t,this._prependTokens=null,this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0}enterLanguage(e){this._currentLanguageId=this._languageService.languageIdCodec.encodeLanguageId(e)}emit(e,t){const i=this._theme.match(this._currentLanguageId,t)|1024;this._lastTokenMetadata!==i&&(this._lastTokenMetadata=i,this._tokens.push(e),this._tokens.push(i))}static _merge(e,t,i){const n=e!==null?e.length:0,s=t.length,r=i!==null?i.length:0;if(n===0&&s===0&&r===0)return new Uint32Array(0);if(n===0&&s===0)return i;if(s===0&&r===0)return e;const a=new Uint32Array(n+s+r);e!==null&&a.set(e);for(let l=0;l<s;l++)a[n+l]=t[l];return i!==null&&a.set(i,n+s),a}nestedLanguageTokenize(e,t,i,n){const s=i.languageId,r=i.state,a=gi.get(s);if(!a)return this.enterLanguage(s),this.emit(n,""),r;const l=a.tokenizeEncoded(e,t,r);if(n!==0)for(let c=0,d=l.tokens.length;c<d;c+=2)l.tokens[c]+=n;return this._prependTokens=Gx._merge(this._prependTokens,this._tokens,l.tokens),this._tokens=[],this._currentLanguageId=0,this._lastTokenMetadata=0,l.endState}finalize(e){return new eT(Gx._merge(this._prependTokens,this._tokens,null),e)}}let Ny=WM=class extends F{constructor(e,t,i,n,s){super(),this._configurationService=s,this._languageService=e,this._standaloneThemeService=t,this._languageId=i,this._lexer=n,this._embeddedLanguages=Object.create(null),this.embeddedLoaded=Promise.resolve(void 0);let r=!1;this._register(gi.onDidChange(a=>{if(r)return;let l=!1;for(let c=0,d=a.changedLanguages.length;c<d;c++){const h=a.changedLanguages[c];if(this._embeddedLanguages[h]){l=!0;break}}l&&(r=!0,gi.handleChange([this._languageId]),r=!1)})),this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}),this._register(this._configurationService.onDidChangeConfiguration(a=>{a.affectsConfiguration("editor.maxTokenizationLineLength")&&(this._maxTokenizationLineLength=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:this._languageId}))}))}getLoadStatus(){const e=[];for(const t in this._embeddedLanguages){const i=gi.get(t);if(i){if(i instanceof WM){const n=i.getLoadStatus();n.loaded===!1&&e.push(n.promise)}continue}gi.isResolved(t)||e.push(gi.getOrCreate(t))}return e.length===0?{loaded:!0}:{loaded:!1,promise:Promise.all(e).then(t=>{})}}getInitialState(){const e=Iy.create(null,this._lexer.start);return Md.create(e,null)}tokenize(e,t,i){if(e.length>=this._maxTokenizationLineLength)return I5(this._languageId,i);const n=new Ofe,s=this._tokenize(e,t,i,n);return n.finalize(s)}tokenizeEncoded(e,t,i){if(e.length>=this._maxTokenizationLineLength)return BT(this._languageService.languageIdCodec.encodeLanguageId(this._languageId),i);const n=new Gx(this._languageService,this._standaloneThemeService.getColorTheme().tokenTheme),s=this._tokenize(e,t,i,n);return n.finalize(s)}_tokenize(e,t,i,n){return i.embeddedLanguageData?this._nestedTokenize(e,t,i,0,n):this._myTokenize(e,t,i,0,n)}_findLeavingNestedLanguageOffset(e,t){let i=this._lexer.tokenizer[t.stack.state];if(!i&&(i=jS(this._lexer,t.stack.state),!i))throw Kt(this._lexer,"tokenizer state is not defined: "+t.stack.state);let n=-1,s=!1;for(const r of i){if(!K7(r.action)||r.action.nextEmbedded!=="@pop")continue;s=!0;let a=r.resolveRegex(t.stack.state);const l=a.source;if(l.substr(0,4)==="^(?:"&&l.substr(l.length-1,1)===")"){const d=(a.ignoreCase?"i":"")+(a.unicode?"u":"");a=new RegExp(l.substr(4,l.length-5),d)}const c=e.search(a);c===-1||c!==0&&r.matchOnlyAtLineStart||(n===-1||c<n)&&(n=c)}if(!s)throw Kt(this._lexer,'no rule containing nextEmbedded: "@pop" in tokenizer embedded state: '+t.stack.state);return n}_nestedTokenize(e,t,i,n,s){const r=this._findLeavingNestedLanguageOffset(e,i);if(r===-1){const c=s.nestedLanguageTokenize(e,t,i.embeddedLanguageData,n);return Md.create(i.stack,new em(i.embeddedLanguageData.languageId,c))}const a=e.substring(0,r);a.length>0&&s.nestedLanguageTokenize(a,!1,i.embeddedLanguageData,n);const l=e.substring(r);return this._myTokenize(l,t,i,n+r,s)}_safeRuleName(e){return e?e.name:"(unknown)"}_myTokenize(e,t,i,n,s){s.enterLanguage(this._languageId);const r=e.length,a=t&&this._lexer.includeLF?e+`
`:e,l=a.length;let c=i.embeddedLanguageData,d=i.stack,h=0,u=null,g=!0;for(;g||h<l;){const f=h,m=d.depth,_=u?u.groups.length:0,b=d.state;let v=null,y=null,C=null,w=null,x=null;if(u){v=u.matches;const N=u.groups.shift();y=N.matched,C=N.action,w=u.rule,u.groups.length===0&&(u=null)}else{if(!g&&h>=l)break;g=!1;let N=this._lexer.tokenizer[b];if(!N&&(N=jS(this._lexer,b),!N))throw Kt(this._lexer,"tokenizer state is not defined: "+b);const z=a.substr(h);for(const B of N)if((h===0||!B.matchOnlyAtLineStart)&&(v=z.match(B.resolveRegex(b)),v)){y=v[0],C=B.action;break}}if(v||(v=[""],y=""),C||(h<l&&(v=[a.charAt(h)],y=v[0]),C=this._lexer.defaultToken),y===null)break;for(h+=y.length;Ife(C)&&K7(C)&&C.test;)C=C.test(y,v,b,h===l);let k=null;if(typeof C=="string"||Array.isArray(C))k=C;else if(C.group)k=C.group;else if(C.token!==null&&C.token!==void 0){if(C.tokenSubst?k=Ad(this._lexer,C.token,y,v,b):k=C.token,C.nextEmbedded)if(C.nextEmbedded==="@pop"){if(!c)throw Kt(this._lexer,"cannot pop embedded language if not inside one");c=null}else{if(c)throw Kt(this._lexer,"cannot enter embedded language from within an embedded language");x=Ad(this._lexer,C.nextEmbedded,y,v,b)}if(C.goBack&&(h=Math.max(0,h-C.goBack)),C.switchTo&&typeof C.switchTo=="string"){let N=Ad(this._lexer,C.switchTo,y,v,b);if(N[0]==="@"&&(N=N.substr(1)),jS(this._lexer,N))d=d.switchTo(N);else throw Kt(this._lexer,"trying to switch to a state '"+N+"' that is undefined in rule: "+this._safeRuleName(w))}else{if(C.transform&&typeof C.transform=="function")throw Kt(this._lexer,"action.transform not supported");if(C.next)if(C.next==="@push"){if(d.depth>=this._lexer.maxStack)throw Kt(this._lexer,"maximum tokenizer stack size reached: ["+d.state+","+d.parent.state+",...]");d=d.push(b)}else if(C.next==="@pop"){if(d.depth<=1)throw Kt(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(w));d=d.pop()}else if(C.next==="@popall")d=d.popall();else{let N=Ad(this._lexer,C.next,y,v,b);if(N[0]==="@"&&(N=N.substr(1)),jS(this._lexer,N))d=d.push(N);else throw Kt(this._lexer,"trying to set a next state '"+N+"' that is undefined in rule: "+this._safeRuleName(w))}}C.log&&typeof C.log=="string"&&Nfe(this._lexer,this._lexer.languageId+": "+Ad(this._lexer,C.log,y,v,b))}if(k===null)throw Kt(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(w));const E=N=>{const z=this._languageService.getLanguageIdByLanguageName(N)||this._languageService.getLanguageIdByMimeType(N)||N,B=this._getNestedEmbeddedLanguageData(z);if(h<l){const U=e.substr(h);return this._nestedTokenize(U,t,Md.create(d,B),n+h,s)}else return Md.create(d,B)};if(Array.isArray(k)){if(u&&u.groups.length>0)throw Kt(this._lexer,"groups cannot be nested: "+this._safeRuleName(w));if(v.length!==k.length+1)throw Kt(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(w));let N=0;for(let z=1;z<v.length;z++)N+=v[z].length;if(N!==y.length)throw Kt(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(w));u={rule:w,matches:v,groups:[]};for(let z=0;z<k.length;z++)u.groups[z]={action:k[z],matched:v[z+1]};h-=y.length;continue}else{if(k==="@rematch"&&(h-=y.length,y="",v=null,k="",x!==null))return E(x);if(y.length===0){if(l===0||m!==d.depth||b!==d.state||(u?u.groups.length:0)!==_)continue;throw Kt(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(w))}let N=null;if(OK(k)&&k.indexOf("@brackets")===0){const z=k.substr(9),B=Ffe(this._lexer,y);if(!B)throw Kt(this._lexer,"@brackets token returned but no bracket defined as: "+y);N=j7(B.token+z)}else{const z=k===""?"":k+this._lexer.tokenPostfix;N=j7(z)}f<r&&s.emit(f+n,N)}if(x!==null)return E(x)}return Md.create(d,c)}_getNestedEmbeddedLanguageData(e){if(!this._languageService.isRegisteredLanguageId(e))return new em(e,k_);e!==this._languageId&&(this._languageService.requestBasicLanguageFeatures(e),gi.getOrCreate(e),this._embeddedLanguages[e]=!0);const t=gi.get(e);return t?new em(e,t.getInitialState()):new em(e,k_)}};Ny=WM=Afe([Mfe(4,Ke)],Ny);function Ffe(o,e){if(!e)return null;e=Vc(o,e);const t=o.brackets;for(const i of t){if(i.open===e)return{token:i.token,bracketType:1};if(i.close===e)return{token:i.token,bracketType:-1}}return null}const Bfe=nd("standaloneColorizer",{createHTML:o=>o});class yB{static colorizeElement(e,t,i,n){n=n||{};const s=n.theme||"vs",r=n.mimeType||i.getAttribute("lang")||i.getAttribute("data-lang");if(!r)return console.error("Mode not detected"),Promise.resolve();const a=t.getLanguageIdByMimeType(r)||r;e.setTheme(s);const l=i.firstChild?i.firstChild.nodeValue:"";i.className+=" "+s;const c=d=>{const h=Bfe?.createHTML(d)??d;i.innerHTML=h};return this.colorize(t,l||"",a,n).then(c,d=>console.error(d))}static async colorize(e,t,i,n){const s=e.languageIdCodec;let r=4;n&&typeof n.tabSize=="number"&&(r=n.tabSize),O4(t)&&(t=t.substr(1));const a=Bl(t);if(!e.isRegisteredLanguageId(i))return q7(a,r,s);const l=await gi.getOrCreate(i);return l?Wfe(a,r,l,s):q7(a,r,s)}static colorizeLine(e,t,i,n,s=4){const r=Vo.isBasicASCII(e,t),a=Vo.containsRTL(e,r,i);return iD(new eu(!1,!0,e,!1,r,a,0,n,[],s,0,0,0,0,-1,"none",!1,!1,null)).html}static colorizeModelLine(e,t,i=4){const n=e.getLineContent(t);e.tokenization.forceTokenization(t);const r=e.tokenization.getLineTokens(t).inflate();return this.colorizeLine(n,e.mightContainNonBasicASCII(),e.mightContainRTL(),r,i)}}function Wfe(o,e,t,i){return new Promise((n,s)=>{const r=()=>{const a=Vfe(o,e,t,i);if(t instanceof Ny){const l=t.getLoadStatus();if(l.loaded===!1){l.promise.then(r,s);return}}n(a)};r()})}function q7(o,e,t){let i=[];const s=new Uint32Array(2);s[0]=0,s[1]=33587200;for(let r=0,a=o.length;r<a;r++){const l=o[r];s[0]=l.length;const c=new an(s,l,t),d=Vo.isBasicASCII(l,!0),h=Vo.containsRTL(l,d,!0),u=iD(new eu(!1,!0,l,!1,d,h,0,c,[],e,0,0,0,0,-1,"none",!1,!1,null));i=i.concat(u.html),i.push("<br/>")}return i.join("")}function Vfe(o,e,t,i){let n=[],s=t.getInitialState();for(let r=0,a=o.length;r<a;r++){const l=o[r],c=t.tokenizeEncoded(l,!0,s);an.convertToEndOffset(c.tokens,l.length);const d=new an(c.tokens,l,i),h=Vo.isBasicASCII(l,!0),u=Vo.containsRTL(l,h,!0),g=iD(new eu(!1,!0,l,!1,h,u,0,d.inflate(),[],e,0,0,0,0,-1,"none",!1,!1,null));n=n.concat(g.html),n.push("<br/>"),s=c.endState}return n.join("")}var Hfe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},zfe=function(o,e){return function(t,i){e(t,i,o)}},t_;let $x=(t_=class{constructor(e,t){}dispose(){}},t_.ID="editor.contrib.markerDecorations",t_);$x=Hfe([zfe(1,H5)],$x);at($x.ID,$x,0);class BK extends F{constructor(e,t){super(),this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._referenceDomElement=e,this._width=-1,this._height=-1,this._resizeObserver=null,this.measureReferenceDomElement(!1,t)}dispose(){this.stopObserving(),super.dispose()}getWidth(){return this._width}getHeight(){return this._height}startObserving(){if(!this._resizeObserver&&this._referenceDomElement){let e=null;const t=()=>{e?this.observe({width:e.width,height:e.height}):this.observe()};let i=!1,n=!1;const s=()=>{if(i&&!n)try{i=!1,n=!0,t()}finally{ao(xe(this._referenceDomElement),()=>{n=!1,s()})}};this._resizeObserver=new ResizeObserver(r=>{r&&r[0]&&r[0].contentRect?e={width:r[0].contentRect.width,height:r[0].contentRect.height}:e=null,i=!0,s()}),this._resizeObserver.observe(this._referenceDomElement)}}stopObserving(){this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null)}observe(e){this.measureReferenceDomElement(!0,e)}measureReferenceDomElement(e,t){let i=0,n=0;t?(i=t.width,n=t.height):this._referenceDomElement&&(i=this._referenceDomElement.clientWidth,n=this._referenceDomElement.clientHeight),i=Math.max(5,i),n=Math.max(5,n),(this._width!==i||this._height!==n)&&(this._width=i,this._height=n,e&&this._onDidChange.fire())}}const ym=class ym{constructor(e,t){this.key=e,this.migrate=t}apply(e){const t=ym._read(e,this.key),i=s=>ym._read(e,s),n=(s,r)=>ym._write(e,s,r);this.migrate(t,i,n)}static _read(e,t){if(typeof e>"u")return;const i=t.indexOf(".");if(i>=0){const n=t.substring(0,i);return this._read(e[n],t.substring(i+1))}return e[t]}static _write(e,t,i){const n=t.indexOf(".");if(n>=0){const s=t.substring(0,n);e[s]=e[s]||{},this._write(e[s],t.substring(n+1),i);return}e[t]=i}};ym.items=[];let Ry=ym;function Wa(o,e){Ry.items.push(new Ry(o,e))}function uo(o,e){Wa(o,(t,i,n)=>{if(typeof t<"u"){for(const[s,r]of e)if(t===s){n(o,r);return}}})}function Ufe(o){Ry.items.forEach(e=>e.apply(o))}uo("wordWrap",[[!0,"on"],[!1,"off"]]);uo("lineNumbers",[[!0,"on"],[!1,"off"]]);uo("cursorBlinking",[["visible","solid"]]);uo("renderWhitespace",[[!0,"boundary"],[!1,"none"]]);uo("renderLineHighlight",[[!0,"line"],[!1,"none"]]);uo("acceptSuggestionOnEnter",[[!0,"on"],[!1,"off"]]);uo("tabCompletion",[[!1,"off"],[!0,"onlySnippets"]]);uo("hover",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);uo("parameterHints",[[!0,{enabled:!0}],[!1,{enabled:!1}]]);uo("autoIndent",[[!1,"advanced"],[!0,"full"]]);uo("matchBrackets",[[!0,"always"],[!1,"never"]]);uo("renderFinalNewline",[[!0,"on"],[!1,"off"]]);uo("cursorSmoothCaretAnimation",[[!0,"on"],[!1,"off"]]);uo("occurrencesHighlight",[[!0,"singleFile"],[!1,"off"]]);uo("wordBasedSuggestions",[[!0,"matchingDocuments"],[!1,"off"]]);Wa("autoClosingBrackets",(o,e,t)=>{o===!1&&(t("autoClosingBrackets","never"),typeof e("autoClosingQuotes")>"u"&&t("autoClosingQuotes","never"),typeof e("autoSurround")>"u"&&t("autoSurround","never"))});Wa("renderIndentGuides",(o,e,t)=>{typeof o<"u"&&(t("renderIndentGuides",void 0),typeof e("guides.indentation")>"u"&&t("guides.indentation",!!o))});Wa("highlightActiveIndentGuide",(o,e,t)=>{typeof o<"u"&&(t("highlightActiveIndentGuide",void 0),typeof e("guides.highlightActiveIndentation")>"u"&&t("guides.highlightActiveIndentation",!!o))});const Gfe={method:"showMethods",function:"showFunctions",constructor:"showConstructors",deprecated:"showDeprecated",field:"showFields",variable:"showVariables",class:"showClasses",struct:"showStructs",interface:"showInterfaces",module:"showModules",property:"showProperties",event:"showEvents",operator:"showOperators",unit:"showUnits",value:"showValues",constant:"showConstants",enum:"showEnums",enumMember:"showEnumMembers",keyword:"showKeywords",text:"showWords",color:"showColors",file:"showFiles",reference:"showReferences",folder:"showFolders",typeParameter:"showTypeParameters",snippet:"showSnippets"};Wa("suggest.filteredTypes",(o,e,t)=>{if(o&&typeof o=="object"){for(const i of Object.entries(Gfe))o[i[0]]===!1&&typeof e(`suggest.${i[1]}`)>"u"&&t(`suggest.${i[1]}`,!1);t("suggest.filteredTypes",void 0)}});Wa("quickSuggestions",(o,e,t)=>{if(typeof o=="boolean"){const i=o?"on":"off";t("quickSuggestions",{comments:i,strings:i,other:i})}});Wa("experimental.stickyScroll.enabled",(o,e,t)=>{typeof o=="boolean"&&(t("experimental.stickyScroll.enabled",void 0),typeof e("stickyScroll.enabled")>"u"&&t("stickyScroll.enabled",o))});Wa("experimental.stickyScroll.maxLineCount",(o,e,t)=>{typeof o=="number"&&(t("experimental.stickyScroll.maxLineCount",void 0),typeof e("stickyScroll.maxLineCount")>"u"&&t("stickyScroll.maxLineCount",o))});Wa("codeActionsOnSave",(o,e,t)=>{if(o&&typeof o=="object"){let i=!1;const n={};for(const s of Object.entries(o))typeof s[1]=="boolean"?(i=!0,n[s[0]]=s[1]?"explicit":"never"):n[s[0]]=s[1];i&&t("codeActionsOnSave",n)}});Wa("codeActionWidget.includeNearbyQuickfixes",(o,e,t)=>{typeof o=="boolean"&&(t("codeActionWidget.includeNearbyQuickfixes",void 0),typeof e("codeActionWidget.includeNearbyQuickFixes")>"u"&&t("codeActionWidget.includeNearbyQuickFixes",o))});Wa("lightbulb.enabled",(o,e,t)=>{typeof o=="boolean"&&t("lightbulb.enabled",o?void 0:"off")});class $fe{constructor(){this._tabFocus=!1,this._onDidChangeTabFocus=new O,this.onDidChangeTabFocus=this._onDidChangeTabFocus.event}getTabFocusMode(){return this._tabFocus}setTabFocusMode(e){this._tabFocus=e,this._onDidChangeTabFocus.fire(this._tabFocus)}}const M_=new $fe;var Kfe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},jfe=function(o,e){return function(t,i){e(t,i,o)}};let VM=class extends F{constructor(e,t,i,n,s){super(),this._accessibilityService=s,this._onDidChange=this._register(new O),this.onDidChange=this._onDidChange.event,this._onDidChangeFast=this._register(new O),this.onDidChangeFast=this._onDidChangeFast.event,this._isDominatedByLongLines=!1,this._viewLineCount=1,this._lineNumbersDigitCount=1,this._reservedHeight=0,this._glyphMarginDecorationLaneCount=1,this._computeOptionsMemory=new oz,this.isSimpleWidget=e,this.contextMenuId=t,this._containerObserver=this._register(new BK(n,i.dimension)),this._targetWindowId=xe(n).vscodeWindowId,this._rawOptions=Z7(i),this._validatedOptions=Od.validateOptions(this._rawOptions),this.options=this._computeOptions(),this.options.get(13)&&this._containerObserver.startObserving(),this._register(ir.onDidChangeZoomLevel(()=>this._recomputeOptions())),this._register(M_.onDidChangeTabFocus(()=>this._recomputeOptions())),this._register(this._containerObserver.onDidChange(()=>this._recomputeOptions())),this._register(gP.onDidChange(()=>this._recomputeOptions())),this._register(YC.getInstance(xe(n)).onDidChange(()=>this._recomputeOptions())),this._register(this._accessibilityService.onDidChangeScreenReaderOptimized(()=>this._recomputeOptions()))}_recomputeOptions(){const e=this._computeOptions(),t=Od.checkEquals(this.options,e);t!==null&&(this.options=e,this._onDidChangeFast.fire(t),this._onDidChange.fire(t))}_computeOptions(){const e=this._readEnvConfiguration(),t=rg.createFromValidatedSettings(this._validatedOptions,e.pixelRatio,this.isSimpleWidget),i=this._readFontInfo(t),n={memory:this._computeOptionsMemory,outerWidth:e.outerWidth,outerHeight:e.outerHeight-this._reservedHeight,fontInfo:i,extraEditorClassName:e.extraEditorClassName,isDominatedByLongLines:this._isDominatedByLongLines,viewLineCount:this._viewLineCount,lineNumbersDigitCount:this._lineNumbersDigitCount,emptySelectionClipboard:e.emptySelectionClipboard,pixelRatio:e.pixelRatio,tabFocusMode:M_.getTabFocusMode(),accessibilitySupport:e.accessibilitySupport,glyphMarginDecorationLaneCount:this._glyphMarginDecorationLaneCount};return Od.computeOptions(this._validatedOptions,n)}_readEnvConfiguration(){return{extraEditorClassName:Zfe(),outerWidth:this._containerObserver.getWidth(),outerHeight:this._containerObserver.getHeight(),emptySelectionClipboard:tT||dr,pixelRatio:YC.getInstance(V3(this._targetWindowId,!0).window).value,accessibilitySupport:this._accessibilityService.isScreenReaderOptimized()?2:this._accessibilityService.getAccessibilitySupport()}}_readFontInfo(e){return gP.readFontInfo(V3(this._targetWindowId,!0).window,e)}getRawOptions(){return this._rawOptions}updateOptions(e){const t=Z7(e);Od.applyUpdate(this._rawOptions,t)&&(this._validatedOptions=Od.validateOptions(this._rawOptions),this._recomputeOptions())}observeContainer(e){this._containerObserver.observe(e)}setIsDominatedByLongLines(e){this._isDominatedByLongLines!==e&&(this._isDominatedByLongLines=e,this._recomputeOptions())}setModelLineCount(e){const t=qfe(e);this._lineNumbersDigitCount!==t&&(this._lineNumbersDigitCount=t,this._recomputeOptions())}setViewLineCount(e){this._viewLineCount!==e&&(this._viewLineCount=e,this._recomputeOptions())}setReservedHeight(e){this._reservedHeight!==e&&(this._reservedHeight=e,this._recomputeOptions())}setGlyphMarginDecorationLaneCount(e){this._glyphMarginDecorationLaneCount!==e&&(this._glyphMarginDecorationLaneCount=e,this._recomputeOptions())}};VM=Kfe([jfe(4,ho)],VM);function qfe(o){let e=0;for(;o;)o=Math.floor(o/10),e++;return e||1}function Zfe(){let o="";return!Nh&&!Rz&&(o+="no-user-select "),Nh&&(o+="no-minimap-shadow ",o+="enable-user-select "),Qe&&(o+="mac "),o}class Yfe{constructor(){this._values=[]}_read(e){return this._values[e]}get(e){return this._values[e]}_write(e,t){this._values[e]=t}}class Xfe{constructor(){this._values=[]}_read(e){if(e>=this._values.length)throw new Error("Cannot read uninitialized value");return this._values[e]}get(e){return this._read(e)}_write(e,t){this._values[e]=t}}class Od{static validateOptions(e){const t=new Yfe;for(const i of Up){const n=i.name==="_never_"?void 0:e[i.name];t._write(i.id,i.validate(n))}return t}static computeOptions(e,t){const i=new Xfe;for(const n of Up)i._write(n.id,n.compute(t,i,e._read(n.id)));return i}static _deepEquals(e,t){if(typeof e!="object"||typeof t!="object"||!e||!t)return e===t;if(Array.isArray(e)||Array.isArray(t))return Array.isArray(e)&&Array.isArray(t)?ei(e,t):!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!Od._deepEquals(e[i],t[i]))return!1;return!0}static checkEquals(e,t){const i=[];let n=!1;for(const s of Up){const r=!Od._deepEquals(e._read(s.id),t._read(s.id));i[s.id]=r,r&&(n=!0)}return n?new sz(i):null}static applyUpdate(e,t){let i=!1;for(const n of Up)if(t.hasOwnProperty(n.name)){const s=n.applyUpdate(e[n.name],t[n.name]);e[n.name]=s.newValue,i=i||s.didChange}return i}}function Z7(o){const e=gc(o);return Ufe(e),e}var qd;(function(o){const e={total:0,min:Number.MAX_VALUE,max:0},t={...e},i={...e},n={...e};let s=0;const r={keydown:0,input:0,render:0};function a(){b(),performance.mark("inputlatency/start"),performance.mark("keydown/start"),r.keydown=1,queueMicrotask(l)}o.onKeyDown=a;function l(){r.keydown===1&&(performance.mark("keydown/end"),r.keydown=2)}function c(){performance.mark("input/start"),r.input=1,_()}o.onBeforeInput=c;function d(){r.input===0&&c(),queueMicrotask(h)}o.onInput=d;function h(){r.input===1&&(performance.mark("input/end"),r.input=2)}function u(){b()}o.onKeyUp=u;function g(){b()}o.onSelectionChange=g;function f(){r.keydown===2&&r.input===2&&r.render===0&&(performance.mark("render/start"),r.render=1,queueMicrotask(m),_())}o.onRenderStart=f;function m(){r.render===1&&(performance.mark("render/end"),r.render=2)}function _(){setTimeout(b)}function b(){r.keydown===2&&r.input===2&&r.render===2&&(performance.mark("inputlatency/end"),performance.measure("keydown","keydown/start","keydown/end"),performance.measure("input","input/start","input/end"),performance.measure("render","render/start","render/end"),performance.measure("inputlatency","inputlatency/start","inputlatency/end"),v("keydown",e),v("input",t),v("render",i),v("inputlatency",n),s++,y())}function v(k,E){const N=performance.getEntriesByName(k)[0].duration;E.total+=N,E.min=Math.min(E.min,N),E.max=Math.max(E.max,N)}function y(){performance.clearMarks("keydown/start"),performance.clearMarks("keydown/end"),performance.clearMarks("input/start"),performance.clearMarks("input/end"),performance.clearMarks("render/start"),performance.clearMarks("render/end"),performance.clearMarks("inputlatency/start"),performance.clearMarks("inputlatency/end"),performance.clearMeasures("keydown"),performance.clearMeasures("input"),performance.clearMeasures("render"),performance.clearMeasures("inputlatency"),r.keydown=0,r.input=0,r.render=0}function C(){if(s===0)return;const k={keydown:w(e),input:w(t),render:w(i),total:w(n),sampleCount:s};return x(e),x(t),x(i),x(n),s=0,k}o.getAndClearMeasurements=C;function w(k){return{average:k.total/s,max:k.max,min:k.min}}function x(k){k.total=0,k.min=Number.MAX_VALUE,k.max=0}})(qd||(qd={}));class nD{constructor(e,t){this.x=e,this.y=t,this._pageCoordinatesBrand=void 0}toClientCoordinates(e){return new WK(this.x-e.scrollX,this.y-e.scrollY)}}class WK{constructor(e,t){this.clientX=e,this.clientY=t,this._clientCoordinatesBrand=void 0}toPageCoordinates(e){return new nD(this.clientX+e.scrollX,this.clientY+e.scrollY)}}class Qfe{constructor(e,t,i,n){this.x=e,this.y=t,this.width=i,this.height=n,this._editorPagePositionBrand=void 0}}class Jfe{constructor(e,t){this.x=e,this.y=t,this._positionRelativeToEditorBrand=void 0}}function wB(o){const e=Ci(o);return new Qfe(e.left,e.top,e.width,e.height)}function SB(o,e,t){const i=e.width/o.offsetWidth,n=e.height/o.offsetHeight,s=(t.x-e.x)/i,r=(t.y-e.y)/n;return new Jfe(s,r)}class Vh extends Mr{constructor(e,t,i){super(xe(i),e),this._editorMouseEventBrand=void 0,this.isFromPointerCapture=t,this.pos=new nD(this.posx,this.posy),this.editorPos=wB(i),this.relativePos=SB(i,this.editorPos,this.pos)}}class epe{constructor(e){this._editorViewDomNode=e}_create(e){return new Vh(e,!1,this._editorViewDomNode)}onContextMenu(e,t){return H(e,"contextmenu",i=>{t(this._create(i))})}onMouseUp(e,t){return H(e,"mouseup",i=>{t(this._create(i))})}onMouseDown(e,t){return H(e,ee.MOUSE_DOWN,i=>{t(this._create(i))})}onPointerDown(e,t){return H(e,ee.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onMouseLeave(e,t){return H(e,ee.MOUSE_LEAVE,i=>{t(this._create(i))})}onMouseMove(e,t){return H(e,"mousemove",i=>t(this._create(i)))}}class tpe{constructor(e){this._editorViewDomNode=e}_create(e){return new Vh(e,!1,this._editorViewDomNode)}onPointerUp(e,t){return H(e,"pointerup",i=>{t(this._create(i))})}onPointerDown(e,t){return H(e,ee.POINTER_DOWN,i=>{t(this._create(i),i.pointerId)})}onPointerLeave(e,t){return H(e,ee.POINTER_LEAVE,i=>{t(this._create(i))})}onPointerMove(e,t){return H(e,"pointermove",i=>t(this._create(i)))}}class ipe extends F{constructor(e){super(),this._editorViewDomNode=e,this._globalPointerMoveMonitor=this._register(new cb),this._keydownListener=null}startMonitoring(e,t,i,n,s){this._keydownListener=ci(e.ownerDocument,"keydown",r=>{r.toKeyCodeChord().isModifierKey()||this._globalPointerMoveMonitor.stopMonitoring(!0,r.browserEvent)},!0),this._globalPointerMoveMonitor.startMonitoring(e,t,i,r=>{n(new Vh(r,!0,this._editorViewDomNode))},r=>{this._keydownListener.dispose(),s(r)})}stopMonitoring(){this._globalPointerMoveMonitor.stopMonitoring(!0)}}const jk=class jk{constructor(e){this._editor=e,this._instanceId=++jk._idPool,this._counter=0,this._rules=new Map,this._garbageCollectionScheduler=new xt(()=>this.garbageCollect(),1e3)}createClassNameRef(e){const t=this.getOrCreateRule(e);return t.increaseRefCount(),{className:t.className,dispose:()=>{t.decreaseRefCount(),this._garbageCollectionScheduler.schedule()}}}getOrCreateRule(e){const t=this.computeUniqueKey(e);let i=this._rules.get(t);if(!i){const n=this._counter++;i=new npe(t,`dyn-rule-${this._instanceId}-${n}`,P0(this._editor.getContainerDomNode())?this._editor.getContainerDomNode():void 0,e),this._rules.set(t,i)}return i}computeUniqueKey(e){return JSON.stringify(e)}garbageCollect(){for(const e of this._rules.values())e.hasReferences()||(this._rules.delete(e.key),e.dispose())}};jk._idPool=0;let Kx=jk;class npe{constructor(e,t,i,n){this.key=e,this.className=t,this.properties=n,this._referenceCount=0,this._styleElementDisposables=new $,this._styleElement=Bo(i,void 0,this._styleElementDisposables),this._styleElement.textContent=this.getCssText(this.className,this.properties)}getCssText(e,t){let i=`.${e} {`;for(const n in t){const s=t[n];let r;typeof s=="object"?r=ce(s.id):r=s;const a=spe(n);i+=`
	${a}: ${r};`}return i+=`
}`,i}dispose(){this._styleElementDisposables.dispose(),this._styleElement=void 0}increaseRefCount(){this._referenceCount++}decreaseRefCount(){this._referenceCount--}hasReferences(){return this._referenceCount>0}}function spe(o){return o.replace(/(^[A-Z])/,([e])=>e.toLowerCase()).replace(/([A-Z])/g,([e])=>`-${e.toLowerCase()}`)}class Kw extends F{constructor(){super(),this._shouldRender=!0}shouldRender(){return this._shouldRender}forceShouldRender(){this._shouldRender=!0}setShouldRender(){this._shouldRender=!0}onDidRender(){this._shouldRender=!1}onCompositionStart(e){return!1}onCompositionEnd(e){return!1}onConfigurationChanged(e){return!1}onCursorStateChanged(e){return!1}onDecorationsChanged(e){return!1}onFlushed(e){return!1}onFocusChanged(e){return!1}onLanguageConfigurationChanged(e){return!1}onLineMappingChanged(e){return!1}onLinesChanged(e){return!1}onLinesDeleted(e){return!1}onLinesInserted(e){return!1}onRevealRangeRequest(e){return!1}onScrollChanged(e){return!1}onThemeChanged(e){return!1}onTokensChanged(e){return!1}onTokensColorsChanged(e){return!1}onZonesChanged(e){return!1}handleEvents(e){let t=!1;for(let i=0,n=e.length;i<n;i++){const s=e[i];switch(s.type){case 0:this.onCompositionStart(s)&&(t=!0);break;case 1:this.onCompositionEnd(s)&&(t=!0);break;case 2:this.onConfigurationChanged(s)&&(t=!0);break;case 3:this.onCursorStateChanged(s)&&(t=!0);break;case 4:this.onDecorationsChanged(s)&&(t=!0);break;case 5:this.onFlushed(s)&&(t=!0);break;case 6:this.onFocusChanged(s)&&(t=!0);break;case 7:this.onLanguageConfigurationChanged(s)&&(t=!0);break;case 8:this.onLineMappingChanged(s)&&(t=!0);break;case 9:this.onLinesChanged(s)&&(t=!0);break;case 10:this.onLinesDeleted(s)&&(t=!0);break;case 11:this.onLinesInserted(s)&&(t=!0);break;case 12:this.onRevealRangeRequest(s)&&(t=!0);break;case 13:this.onScrollChanged(s)&&(t=!0);break;case 15:this.onTokensChanged(s)&&(t=!0);break;case 14:this.onThemeChanged(s)&&(t=!0);break;case 16:this.onTokensColorsChanged(s)&&(t=!0);break;case 17:this.onZonesChanged(s)&&(t=!0);break;default:console.info("View received unknown event: "),console.info(s)}}t&&(this._shouldRender=!0)}}class go extends Kw{constructor(e){super(),this._context=e,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}}class Aa{static write(e,t){e.setAttribute("data-mprt",String(t))}static read(e){const t=e.getAttribute("data-mprt");return t===null?0:parseInt(t,10)}static collect(e,t){const i=[];let n=0;for(;e&&e!==e.ownerDocument.body&&e!==t;)e.nodeType===e.ELEMENT_NODE&&(i[n++]=this.read(e)),e=e.parentElement;const s=new Uint8Array(n);for(let r=0;r<n;r++)s[r]=i[n-r-1];return s}}class ope{constructor(e,t){this._restrictedRenderingContextBrand=void 0,this._viewLayout=e,this.viewportData=t,this.scrollWidth=this._viewLayout.getScrollWidth(),this.scrollHeight=this._viewLayout.getScrollHeight(),this.visibleRange=this.viewportData.visibleRange,this.bigNumbersDelta=this.viewportData.bigNumbersDelta;const i=this._viewLayout.getCurrentViewport();this.scrollTop=i.top,this.scrollLeft=i.left,this.viewportWidth=i.width,this.viewportHeight=i.height}getScrolledTopFromAbsoluteTop(e){return e-this.scrollTop}getVerticalOffsetForLineNumber(e,t){return this._viewLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t){return this._viewLayout.getVerticalOffsetAfterLineNumber(e,t)}getDecorationsInViewport(){return this.viewportData.getDecorationsInViewport()}}class rpe extends ope{constructor(e,t,i){super(e,t),this._renderingContextBrand=void 0,this._viewLines=i}linesVisibleRangesForRange(e,t){return this._viewLines.linesVisibleRangesForRange(e,t)}visibleRangeForPosition(e){return this._viewLines.visibleRangeForPosition(e)}}class ape{constructor(e,t,i,n){this.outsideRenderedLine=e,this.lineNumber=t,this.ranges=i,this.continuesOnNextLine=n}}class sD{static from(e){const t=new Array(e.length);for(let i=0,n=e.length;i<n;i++){const s=e[i];t[i]=new sD(s.left,s.width)}return t}constructor(e,t){this._horizontalRangeBrand=void 0,this.left=Math.round(e),this.width=Math.round(t)}toString(){return`[${this.left},${this.width}]`}}class fg{constructor(e,t){this._floatHorizontalRangeBrand=void 0,this.left=e,this.width=t}toString(){return`[${this.left},${this.width}]`}static compare(e,t){return e.left-t.left}}class lpe{constructor(e,t){this.outsideRenderedLine=e,this.originalLeft=t,this.left=Math.round(this.originalLeft)}}class Y7{constructor(e,t){this.outsideRenderedLine=e,this.ranges=t}}class Y1{static _createRange(){return this._handyReadyRange||(this._handyReadyRange=document.createRange()),this._handyReadyRange}static _detachRange(e,t){e.selectNodeContents(t)}static _readClientRects(e,t,i,n,s){const r=this._createRange();try{return r.setStart(e,t),r.setEnd(i,n),r.getClientRects()}catch{return null}finally{this._detachRange(r,s)}}static _mergeAdjacentRanges(e){if(e.length===1)return e;e.sort(fg.compare);const t=[];let i=0,n=e[0];for(let s=1,r=e.length;s<r;s++){const a=e[s];n.left+n.width+.9>=a.left?n.width=Math.max(n.width,a.left+a.width-n.left):(t[i++]=n,n=a)}return t[i++]=n,t}static _createHorizontalRangesFromClientRects(e,t,i){if(!e||e.length===0)return null;const n=[];for(let s=0,r=e.length;s<r;s++){const a=e[s];n[s]=new fg(Math.max(0,(a.left-t)/i),a.width/i)}return this._mergeAdjacentRanges(n)}static readHorizontalRanges(e,t,i,n,s,r){const l=e.children.length-1;if(0>l)return null;if(t=Math.min(l,Math.max(0,t)),n=Math.min(l,Math.max(0,n)),t===n&&i===s&&i===0&&!e.children[t].firstChild){const u=e.children[t].getClientRects();return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(u,r.clientRectDeltaLeft,r.clientRectScale)}t!==n&&n>0&&s===0&&(n--,s=1073741824);let c=e.children[t].firstChild,d=e.children[n].firstChild;if((!c||!d)&&(!c&&i===0&&t>0&&(c=e.children[t-1].firstChild,i=1073741824),!d&&s===0&&n>0&&(d=e.children[n-1].firstChild,s=1073741824)),!c||!d)return null;i=Math.min(c.textContent.length,Math.max(0,i)),s=Math.min(d.textContent.length,Math.max(0,s));const h=this._readClientRects(c,i,d,s,r.endNode);return r.markDidDomLayout(),this._createHorizontalRangesFromClientRects(h,r.clientRectDeltaLeft,r.clientRectScale)}}const cpe=function(){return El?!0:!(us||dr||Nh)}();let Km=!0;class X7{constructor(e,t){this.themeType=t;const i=e.options,n=i.get(50);i.get(38)==="off"?this.renderWhitespace=i.get(100):this.renderWhitespace="none",this.renderControlCharacters=i.get(95),this.spaceWidth=n.spaceWidth,this.middotWidth=n.middotWidth,this.wsmiddotWidth=n.wsmiddotWidth,this.useMonospaceOptimizations=n.isMonospace&&!i.get(33),this.canUseHalfwidthRightwardsArrow=n.canUseHalfwidthRightwardsArrow,this.lineHeight=i.get(67),this.stopRenderingLineAfter=i.get(118),this.fontLigatures=i.get(51)}equals(e){return this.themeType===e.themeType&&this.renderWhitespace===e.renderWhitespace&&this.renderControlCharacters===e.renderControlCharacters&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.useMonospaceOptimizations===e.useMonospaceOptimizations&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter&&this.fontLigatures===e.fontLigatures}}const qk=class qk{constructor(e){this._options=e,this._isMaybeInvalid=!0,this._renderedViewLine=null}getDomNode(){return this._renderedViewLine&&this._renderedViewLine.domNode?this._renderedViewLine.domNode.domNode:null}setDomNode(e){if(this._renderedViewLine)this._renderedViewLine.domNode=bt(e);else throw new Error("I have no rendered view line to set the dom node to...")}onContentChanged(){this._isMaybeInvalid=!0}onTokensChanged(){this._isMaybeInvalid=!0}onDecorationsChanged(){this._isMaybeInvalid=!0}onOptionsChanged(e){this._isMaybeInvalid=!0,this._options=e}onSelectionChanged(){return xa(this._options.themeType)||this._options.renderWhitespace==="selection"?(this._isMaybeInvalid=!0,!0):!1}renderLine(e,t,i,n,s){if(this._isMaybeInvalid===!1)return!1;this._isMaybeInvalid=!1;const r=n.getViewLineRenderingData(e),a=this._options,l=as.filter(r.inlineDecorations,e,r.minColumn,r.maxColumn);let c=null;if(xa(a.themeType)||this._options.renderWhitespace==="selection"){const g=n.selections;for(const f of g){if(f.endLineNumber<e||f.startLineNumber>e)continue;const m=f.startLineNumber===e?f.startColumn:r.minColumn,_=f.endLineNumber===e?f.endColumn:r.maxColumn;m<_&&(xa(a.themeType)&&l.push(new as(m,_,"inline-selected-text",0)),this._options.renderWhitespace==="selection"&&(c||(c=[]),c.push(new RK(m-1,_-1))))}}const d=new eu(a.useMonospaceOptimizations,a.canUseHalfwidthRightwardsArrow,r.content,r.continuesWithWrappedLine,r.isBasicASCII,r.containsRTL,r.minColumn-1,r.tokens,l,r.tabSize,r.startVisibleColumn,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,a.stopRenderingLineAfter,a.renderWhitespace,a.renderControlCharacters,a.fontLigatures!==kh.OFF,c);if(this._renderedViewLine&&this._renderedViewLine.input.equals(d))return!1;s.appendString('<div style="top:'),s.appendString(String(t)),s.appendString("px;height:"),s.appendString(String(i)),s.appendString('px;" class="'),s.appendString(qk.CLASS_NAME),s.appendString('">');const h=$w(d,s);s.appendString("</div>");let u=null;return Km&&cpe&&r.isBasicASCII&&a.useMonospaceOptimizations&&h.containsForeignElements===0&&(u=new qS(this._renderedViewLine?this._renderedViewLine.domNode:null,d,h.characterMapping)),u||(u=HK(this._renderedViewLine?this._renderedViewLine.domNode:null,d,h.characterMapping,h.containsRTL,h.containsForeignElements)),this._renderedViewLine=u,!0}layoutLine(e,t,i){this._renderedViewLine&&this._renderedViewLine.domNode&&(this._renderedViewLine.domNode.setTop(t),this._renderedViewLine.domNode.setHeight(i))}getWidth(e){return this._renderedViewLine?this._renderedViewLine.getWidth(e):0}getWidthIsFast(){return this._renderedViewLine?this._renderedViewLine.getWidthIsFast():!0}needsMonospaceFontCheck(){return this._renderedViewLine?this._renderedViewLine instanceof qS:!1}monospaceAssumptionsAreValid(){return this._renderedViewLine&&this._renderedViewLine instanceof qS?this._renderedViewLine.monospaceAssumptionsAreValid():Km}onMonospaceAssumptionsInvalidated(){this._renderedViewLine&&this._renderedViewLine instanceof qS&&(this._renderedViewLine=this._renderedViewLine.toSlowRenderedLine())}getVisibleRangesForRange(e,t,i,n){if(!this._renderedViewLine)return null;t=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,t)),i=Math.min(this._renderedViewLine.input.lineContent.length+1,Math.max(1,i));const s=this._renderedViewLine.input.stopRenderingLineAfter;if(s!==-1&&t>s+1&&i>s+1)return new Y7(!0,[new fg(this.getWidth(n),0)]);s!==-1&&t>s+1&&(t=s+1),s!==-1&&i>s+1&&(i=s+1);const r=this._renderedViewLine.getVisibleRangesForRange(e,t,i,n);return r&&r.length>0?new Y7(!1,r):null}getColumnOfNodeOffset(e,t){return this._renderedViewLine?this._renderedViewLine.getColumnOfNodeOffset(e,t):1}};qk.CLASS_NAME="view-line";let wc=qk;class qS{constructor(e,t,i){this._cachedWidth=-1,this.domNode=e,this.input=t;const n=Math.floor(t.lineContent.length/300);if(n>0){this._keyColumnPixelOffsetCache=new Float32Array(n);for(let s=0;s<n;s++)this._keyColumnPixelOffsetCache[s]=-1}else this._keyColumnPixelOffsetCache=null;this._characterMapping=i,this._charWidth=t.spaceWidth}getWidth(e){if(!this.domNode||this.input.lineContent.length<300){const t=this._characterMapping.getHorizontalOffset(this._characterMapping.length);return Math.round(this._charWidth*t)}return this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth}getWidthIsFast(){return this.input.lineContent.length<300||this._cachedWidth!==-1}monospaceAssumptionsAreValid(){if(!this.domNode)return Km;if(this.input.lineContent.length<300){const e=this.getWidth(null),t=this.domNode.domNode.firstChild.offsetWidth;Math.abs(e-t)>=2&&(console.warn("monospace assumptions have been violated, therefore disabling monospace optimizations!"),Km=!1)}return Km}toSlowRenderedLine(){return HK(this.domNode,this.input,this._characterMapping,!1,0)}getVisibleRangesForRange(e,t,i,n){const s=this._getColumnPixelOffset(e,t,n),r=this._getColumnPixelOffset(e,i,n);return[new fg(s,r-s)]}_getColumnPixelOffset(e,t,i){if(t<=300){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const n=Math.floor((t-1)/300)-1,s=(n+1)*300+1;let r=-1;if(this._keyColumnPixelOffsetCache&&(r=this._keyColumnPixelOffsetCache[n],r===-1&&(r=this._actualReadPixelOffset(e,s,i),this._keyColumnPixelOffsetCache[n]=r)),r===-1){const c=this._characterMapping.getHorizontalOffset(t);return this._charWidth*c}const a=this._characterMapping.getHorizontalOffset(s),l=this._characterMapping.getHorizontalOffset(t);return r+this._charWidth*(l-a)}_getReadingTarget(e){return e.domNode.firstChild}_actualReadPixelOffset(e,t,i){if(!this.domNode)return-1;const n=this._characterMapping.getDomPosition(t),s=Y1.readHorizontalRanges(this._getReadingTarget(this.domNode),n.partIndex,n.charIndex,n.partIndex,n.charIndex,i);return!s||s.length===0?-1:s[0].left}getColumnOfNodeOffset(e,t){return xB(this._characterMapping,e,t)}}class VK{constructor(e,t,i,n,s){if(this.domNode=e,this.input=t,this._characterMapping=i,this._isWhitespaceOnly=/^\s*$/.test(t.lineContent),this._containsForeignElements=s,this._cachedWidth=-1,this._pixelOffsetCache=null,!n||this._characterMapping.length===0){this._pixelOffsetCache=new Float32Array(Math.max(2,this._characterMapping.length+1));for(let r=0,a=this._characterMapping.length;r<=a;r++)this._pixelOffsetCache[r]=-1}}_getReadingTarget(e){return e.domNode.firstChild}getWidth(e){return this.domNode?(this._cachedWidth===-1&&(this._cachedWidth=this._getReadingTarget(this.domNode).offsetWidth,e?.markDidDomLayout()),this._cachedWidth):0}getWidthIsFast(){return this._cachedWidth!==-1}getVisibleRangesForRange(e,t,i,n){if(!this.domNode)return null;if(this._pixelOffsetCache!==null){const s=this._readPixelOffset(this.domNode,e,t,n);if(s===-1)return null;const r=this._readPixelOffset(this.domNode,e,i,n);return r===-1?null:[new fg(s,r-s)]}return this._readVisibleRangesForRange(this.domNode,e,t,i,n)}_readVisibleRangesForRange(e,t,i,n,s){if(i===n){const r=this._readPixelOffset(e,t,i,s);return r===-1?null:[new fg(r,0)]}else return this._readRawVisibleRangesForRange(e,i,n,s)}_readPixelOffset(e,t,i,n){if(this._characterMapping.length===0){if(this._containsForeignElements===0||this._containsForeignElements===2)return 0;if(this._containsForeignElements===1)return this.getWidth(n);const s=this._getReadingTarget(e);return s.firstChild?(n.markDidDomLayout(),s.firstChild.offsetWidth):0}if(this._pixelOffsetCache!==null){const s=this._pixelOffsetCache[i];if(s!==-1)return s;const r=this._actualReadPixelOffset(e,t,i,n);return this._pixelOffsetCache[i]=r,r}return this._actualReadPixelOffset(e,t,i,n)}_actualReadPixelOffset(e,t,i,n){if(this._characterMapping.length===0){const l=Y1.readHorizontalRanges(this._getReadingTarget(e),0,0,0,0,n);return!l||l.length===0?-1:l[0].left}if(i===this._characterMapping.length&&this._isWhitespaceOnly&&this._containsForeignElements===0)return this.getWidth(n);const s=this._characterMapping.getDomPosition(i),r=Y1.readHorizontalRanges(this._getReadingTarget(e),s.partIndex,s.charIndex,s.partIndex,s.charIndex,n);if(!r||r.length===0)return-1;const a=r[0].left;if(this.input.isBasicASCII){const l=this._characterMapping.getHorizontalOffset(i),c=Math.round(this.input.spaceWidth*l);if(Math.abs(c-a)<=1)return c}return a}_readRawVisibleRangesForRange(e,t,i,n){if(t===1&&i===this._characterMapping.length)return[new fg(0,this.getWidth(n))];const s=this._characterMapping.getDomPosition(t),r=this._characterMapping.getDomPosition(i);return Y1.readHorizontalRanges(this._getReadingTarget(e),s.partIndex,s.charIndex,r.partIndex,r.charIndex,n)}getColumnOfNodeOffset(e,t){return xB(this._characterMapping,e,t)}}class dpe extends VK{_readVisibleRangesForRange(e,t,i,n,s){const r=super._readVisibleRangesForRange(e,t,i,n,s);if(!r||r.length===0||i===n||i===1&&n===this._characterMapping.length)return r;if(!this.input.containsRTL){const a=this._readPixelOffset(e,t,n,s);if(a!==-1){const l=r[r.length-1];l.left<a&&(l.width=a-l.left)}}return r}}const HK=function(){return tT?hpe:upe}();function hpe(o,e,t,i,n){return new dpe(o,e,t,i,n)}function upe(o,e,t,i,n){return new VK(o,e,t,i,n)}function xB(o,e,t){const i=e.textContent.length;let n=-1;for(;e;)e=e.previousSibling,n++;return o.getColumn(new PK(n,t),i)}class Py{static whitespaceVisibleColumn(e,t,i){const n=e.length;let s=0,r=-1,a=-1;for(let l=0;l<n;l++){if(l===t)return[r,a,s];switch(s%i===0&&(r=l,a=s),e.charCodeAt(l)){case 32:s+=1;break;case 9:s=Vi.nextRenderTabStop(s,i);break;default:return[-1,-1,-1]}}return t===n?[r,a,s]:[-1,-1,-1]}static atomicPosition(e,t,i,n){const s=e.length,[r,a,l]=Py.whitespaceVisibleColumn(e,t,i);if(l===-1)return-1;let c;switch(n){case 0:c=!0;break;case 1:c=!1;break;case 2:if(l%i===0)return t;c=l%i<=i/2;break}if(c){if(r===-1)return-1;let u=a;for(let g=r;g<s;++g){if(u===a+i)return r;switch(e.charCodeAt(g)){case 32:u+=1;break;case 9:u=Vi.nextRenderTabStop(u,i);break;default:return-1}}return u===a+i?r:-1}const d=Vi.nextRenderTabStop(l,i);let h=l;for(let u=t;u<s;u++){if(h===d)return u;switch(e.charCodeAt(u)){case 32:h+=1;break;case 9:h=Vi.nextRenderTabStop(h,i);break;default:return-1}}return h===d?s:-1}}class wd{constructor(e=null){this.hitTarget=e,this.type=0}}class zK{get hitTarget(){return this.spanNode}constructor(e,t,i){this.position=e,this.spanNode=t,this.injectedText=i,this.type=1}}var Hu;(function(o){function e(t,i,n){const s=t.getPositionFromDOMInfo(i,n);return s?new zK(s,i,null):new wd(i)}o.createFromDOMInfo=e})(Hu||(Hu={}));class gpe{constructor(e,t){this.lastViewCursorsRenderData=e,this.lastTextareaPosition=t}}class Gn{static _deduceRage(e,t=null){return!t&&e?new L(e.lineNumber,e.column,e.lineNumber,e.column):t??null}static createUnknown(e,t,i){return{type:0,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createTextarea(e,t){return{type:1,element:e,mouseColumn:t,position:null,range:null}}static createMargin(e,t,i,n,s,r){return{type:e,element:t,mouseColumn:i,position:n,range:s,detail:r}}static createViewZone(e,t,i,n,s){return{type:e,element:t,mouseColumn:i,position:n,range:this._deduceRage(n),detail:s}}static createContentText(e,t,i,n,s){return{type:6,element:e,mouseColumn:t,position:i,range:this._deduceRage(i,n),detail:s}}static createContentEmpty(e,t,i,n){return{type:7,element:e,mouseColumn:t,position:i,range:this._deduceRage(i),detail:n}}static createContentWidget(e,t,i){return{type:9,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createScrollbar(e,t,i){return{type:11,element:e,mouseColumn:t,position:i,range:this._deduceRage(i)}}static createOverlayWidget(e,t,i){return{type:12,element:e,mouseColumn:t,position:null,range:null,detail:i}}static createOutsideEditor(e,t,i,n){return{type:13,element:null,mouseColumn:e,position:t,range:this._deduceRage(t),outsidePosition:i,outsideDistance:n}}static _typeToString(e){return e===1?"TEXTAREA":e===2?"GUTTER_GLYPH_MARGIN":e===3?"GUTTER_LINE_NUMBERS":e===4?"GUTTER_LINE_DECORATIONS":e===5?"GUTTER_VIEW_ZONE":e===6?"CONTENT_TEXT":e===7?"CONTENT_EMPTY":e===8?"CONTENT_VIEW_ZONE":e===9?"CONTENT_WIDGET":e===10?"OVERVIEW_RULER":e===11?"SCROLLBAR":e===12?"OVERLAY_WIDGET":"UNKNOWN"}static toString(e){return this._typeToString(e.type)+": "+e.position+" - "+e.range+" - "+JSON.stringify(e.detail)}}class es{static isTextArea(e){return e.length===2&&e[0]===3&&e[1]===7}static isChildOfViewLines(e){return e.length>=4&&e[0]===3&&e[3]===8}static isStrictChildOfViewLines(e){return e.length>4&&e[0]===3&&e[3]===8}static isChildOfScrollableElement(e){return e.length>=2&&e[0]===3&&e[1]===6}static isChildOfMinimap(e){return e.length>=2&&e[0]===3&&e[1]===9}static isChildOfContentWidgets(e){return e.length>=4&&e[0]===3&&e[3]===1}static isChildOfOverflowGuard(e){return e.length>=1&&e[0]===3}static isChildOfOverflowingContentWidgets(e){return e.length>=1&&e[0]===2}static isChildOfOverlayWidgets(e){return e.length>=2&&e[0]===3&&e[1]===4}static isChildOfOverflowingOverlayWidgets(e){return e.length>=1&&e[0]===5}}class O_{constructor(e,t,i){this.viewModel=e.viewModel;const n=e.configuration.options;this.layoutInfo=n.get(146),this.viewDomNode=t.viewDomNode,this.lineHeight=n.get(67),this.stickyTabStops=n.get(117),this.typicalHalfwidthCharacterWidth=n.get(50).typicalHalfwidthCharacterWidth,this.lastRenderData=i,this._context=e,this._viewHelper=t}getZoneAtCoord(e){return O_.getZoneAtCoord(this._context,e)}static getZoneAtCoord(e,t){const i=e.viewLayout.getWhitespaceAtVerticalOffset(t);if(i){const n=i.verticalOffset+i.height/2,s=e.viewModel.getLineCount();let r=null,a,l=null;return i.afterLineNumber!==s&&(l=new A(i.afterLineNumber+1,1)),i.afterLineNumber>0&&(r=new A(i.afterLineNumber,e.viewModel.getLineMaxColumn(i.afterLineNumber))),l===null?a=r:r===null?a=l:t<n?a=r:a=l,{viewZoneId:i.id,afterLineNumber:i.afterLineNumber,positionBefore:r,positionAfter:l,position:a}}return null}getFullLineRangeAtCoord(e){if(this._context.viewLayout.isAfterLines(e)){const n=this._context.viewModel.getLineCount(),s=this._context.viewModel.getLineMaxColumn(n);return{range:new L(n,s,n,s),isAfterLines:!0}}const t=this._context.viewLayout.getLineNumberAtVerticalOffset(e),i=this._context.viewModel.getLineMaxColumn(t);return{range:new L(t,1,t,i),isAfterLines:!1}}getLineNumberAtVerticalOffset(e){return this._context.viewLayout.getLineNumberAtVerticalOffset(e)}isAfterLines(e){return this._context.viewLayout.isAfterLines(e)}isInTopPadding(e){return this._context.viewLayout.isInTopPadding(e)}isInBottomPadding(e){return this._context.viewLayout.isInBottomPadding(e)}getVerticalOffsetForLineNumber(e){return this._context.viewLayout.getVerticalOffsetForLineNumber(e)}findAttribute(e,t){return O_._findAttribute(e,t,this._viewHelper.viewDomNode)}static _findAttribute(e,t,i){for(;e&&e!==e.ownerDocument.body;){if(e.hasAttribute&&e.hasAttribute(t))return e.getAttribute(t);if(e===i)return null;e=e.parentNode}return null}getLineWidth(e){return this._viewHelper.getLineWidth(e)}visibleRangeForPosition(e,t){return this._viewHelper.visibleRangeForPosition(e,t)}getPositionFromDOMInfo(e,t){return this._viewHelper.getPositionFromDOMInfo(e,t)}getCurrentScrollTop(){return this._context.viewLayout.getCurrentScrollTop()}getCurrentScrollLeft(){return this._context.viewLayout.getCurrentScrollLeft()}}class fpe{constructor(e,t,i,n){this.editorPos=t,this.pos=i,this.relativePos=n,this.mouseVerticalOffset=Math.max(0,e.getCurrentScrollTop()+this.relativePos.y),this.mouseContentHorizontalOffset=e.getCurrentScrollLeft()+this.relativePos.x-e.layoutInfo.contentLeft,this.isInMarginArea=this.relativePos.x<e.layoutInfo.contentLeft&&this.relativePos.x>=e.layoutInfo.glyphMarginLeft,this.isInContentArea=!this.isInMarginArea,this.mouseColumn=Math.max(0,Un._getMouseColumn(this.mouseContentHorizontalOffset,e.typicalHalfwidthCharacterWidth))}}class ppe extends fpe{get target(){return this._useHitTestTarget?this.hitTestResult.value.hitTarget:this._eventTarget}get targetPath(){return this._targetPathCacheElement!==this.target&&(this._targetPathCacheElement=this.target,this._targetPathCacheValue=Aa.collect(this.target,this._ctx.viewDomNode)),this._targetPathCacheValue}constructor(e,t,i,n,s){super(e,t,i,n),this.hitTestResult=new Da(()=>Un.doHitTest(this._ctx,this)),this._targetPathCacheElement=null,this._targetPathCacheValue=new Uint8Array(0),this._ctx=e,this._eventTarget=s;const r=!!this._eventTarget;this._useHitTestTarget=!r}toString(){return`pos(${this.pos.x},${this.pos.y}), editorPos(${this.editorPos.x},${this.editorPos.y}), relativePos(${this.relativePos.x},${this.relativePos.y}), mouseVerticalOffset: ${this.mouseVerticalOffset}, mouseContentHorizontalOffset: ${this.mouseContentHorizontalOffset}
	target: ${this.target?this.target.outerHTML:null}`}get wouldBenefitFromHitTestTargetSwitch(){return!this._useHitTestTarget&&this.hitTestResult.value.hitTarget!==null&&this.target!==this.hitTestResult.value.hitTarget}switchToHitTestTarget(){this._useHitTestTarget=!0}_getMouseColumn(e=null){return e&&e.column<this._ctx.viewModel.getLineMaxColumn(e.lineNumber)?Vi.visibleColumnFromColumn(this._ctx.viewModel.getLineContent(e.lineNumber),e.column,this._ctx.viewModel.model.getOptions().tabSize)+1:this.mouseColumn}fulfillUnknown(e=null){return Gn.createUnknown(this.target,this._getMouseColumn(e),e)}fulfillTextarea(){return Gn.createTextarea(this.target,this._getMouseColumn())}fulfillMargin(e,t,i,n){return Gn.createMargin(e,this.target,this._getMouseColumn(t),t,i,n)}fulfillViewZone(e,t,i){return Gn.createViewZone(e,this.target,this._getMouseColumn(t),t,i)}fulfillContentText(e,t,i){return Gn.createContentText(this.target,this._getMouseColumn(e),e,t,i)}fulfillContentEmpty(e,t){return Gn.createContentEmpty(this.target,this._getMouseColumn(e),e,t)}fulfillContentWidget(e){return Gn.createContentWidget(this.target,this._getMouseColumn(),e)}fulfillScrollbar(e){return Gn.createScrollbar(this.target,this._getMouseColumn(e),e)}fulfillOverlayWidget(e){return Gn.createOverlayWidget(this.target,this._getMouseColumn(),e)}}const Q7={isAfterLines:!0};function QI(o){return{isAfterLines:!1,horizontalDistanceToText:o}}class Un{constructor(e,t){this._context=e,this._viewHelper=t}mouseTargetIsWidget(e){const t=e.target,i=Aa.collect(t,this._viewHelper.viewDomNode);return!!(es.isChildOfContentWidgets(i)||es.isChildOfOverflowingContentWidgets(i)||es.isChildOfOverlayWidgets(i)||es.isChildOfOverflowingOverlayWidgets(i))}createMouseTarget(e,t,i,n,s){const r=new O_(this._context,this._viewHelper,e),a=new ppe(r,t,i,n,s);try{const l=Un._createMouseTarget(r,a);if(l.type===6&&r.stickyTabStops&&l.position!==null){const c=Un._snapToSoftTabBoundary(l.position,r.viewModel),d=L.fromPositions(c,c).plusRange(l.range);return a.fulfillContentText(c,d,l.detail)}return l}catch{return a.fulfillUnknown()}}static _createMouseTarget(e,t){if(t.target===null)return t.fulfillUnknown();const i=t;let n=null;return!es.isChildOfOverflowGuard(t.targetPath)&&!es.isChildOfOverflowingContentWidgets(t.targetPath)&&!es.isChildOfOverflowingOverlayWidgets(t.targetPath)&&(n=n||t.fulfillUnknown()),n=n||Un._hitTestContentWidget(e,i),n=n||Un._hitTestOverlayWidget(e,i),n=n||Un._hitTestMinimap(e,i),n=n||Un._hitTestScrollbarSlider(e,i),n=n||Un._hitTestViewZone(e,i),n=n||Un._hitTestMargin(e,i),n=n||Un._hitTestViewCursor(e,i),n=n||Un._hitTestTextArea(e,i),n=n||Un._hitTestViewLines(e,i),n=n||Un._hitTestScrollbar(e,i),n||t.fulfillUnknown()}static _hitTestContentWidget(e,t){if(es.isChildOfContentWidgets(t.targetPath)||es.isChildOfOverflowingContentWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillContentWidget(i):t.fulfillUnknown()}return null}static _hitTestOverlayWidget(e,t){if(es.isChildOfOverlayWidgets(t.targetPath)||es.isChildOfOverflowingOverlayWidgets(t.targetPath)){const i=e.findAttribute(t.target,"widgetId");return i?t.fulfillOverlayWidget(i):t.fulfillUnknown()}return null}static _hitTestViewCursor(e,t){if(t.target){const i=e.lastRenderData.lastViewCursorsRenderData;for(const n of i)if(t.target===n.domNode)return t.fulfillContentText(n.position,null,{mightBeForeignElement:!1,injectedText:null})}if(t.isInContentArea){const i=e.lastRenderData.lastViewCursorsRenderData,n=t.mouseContentHorizontalOffset,s=t.mouseVerticalOffset;for(const r of i){if(n<r.contentLeft||n>r.contentLeft+r.width)continue;const a=e.getVerticalOffsetForLineNumber(r.position.lineNumber);if(a<=s&&s<=a+r.height)return t.fulfillContentText(r.position,null,{mightBeForeignElement:!1,injectedText:null})}}return null}static _hitTestViewZone(e,t){const i=e.getZoneAtCoord(t.mouseVerticalOffset);if(i){const n=t.isInContentArea?8:5;return t.fulfillViewZone(n,i.position,i)}return null}static _hitTestTextArea(e,t){return es.isTextArea(t.targetPath)?e.lastRenderData.lastTextareaPosition?t.fulfillContentText(e.lastRenderData.lastTextareaPosition,null,{mightBeForeignElement:!1,injectedText:null}):t.fulfillTextarea():null}static _hitTestMargin(e,t){if(t.isInMarginArea){const i=e.getFullLineRangeAtCoord(t.mouseVerticalOffset),n=i.range.getStartPosition();let s=Math.abs(t.relativePos.x);const r={isAfterLines:i.isAfterLines,glyphMarginLeft:e.layoutInfo.glyphMarginLeft,glyphMarginWidth:e.layoutInfo.glyphMarginWidth,lineNumbersWidth:e.layoutInfo.lineNumbersWidth,offsetX:s};if(s-=e.layoutInfo.glyphMarginLeft,s<=e.layoutInfo.glyphMarginWidth){const a=e.viewModel.coordinatesConverter.convertViewPositionToModelPosition(i.range.getStartPosition()),l=e.viewModel.glyphLanes.getLanesAtLine(a.lineNumber);return r.glyphMarginLane=l[Math.floor(s/e.lineHeight)],t.fulfillMargin(2,n,i.range,r)}return s-=e.layoutInfo.glyphMarginWidth,s<=e.layoutInfo.lineNumbersWidth?t.fulfillMargin(3,n,i.range,r):(s-=e.layoutInfo.lineNumbersWidth,t.fulfillMargin(4,n,i.range,r))}return null}static _hitTestViewLines(e,t){if(!es.isChildOfViewLines(t.targetPath))return null;if(e.isInTopPadding(t.mouseVerticalOffset))return t.fulfillContentEmpty(new A(1,1),Q7);if(e.isAfterLines(t.mouseVerticalOffset)||e.isInBottomPadding(t.mouseVerticalOffset)){const n=e.viewModel.getLineCount(),s=e.viewModel.getLineMaxColumn(n);return t.fulfillContentEmpty(new A(n,s),Q7)}if(es.isStrictChildOfViewLines(t.targetPath)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset);if(e.viewModel.getLineLength(n)===0){const r=e.getLineWidth(n),a=QI(t.mouseContentHorizontalOffset-r);return t.fulfillContentEmpty(new A(n,1),a)}const s=e.getLineWidth(n);if(t.mouseContentHorizontalOffset>=s){const r=QI(t.mouseContentHorizontalOffset-s),a=new A(n,e.viewModel.getLineMaxColumn(n));return t.fulfillContentEmpty(a,r)}}const i=t.hitTestResult.value;return i.type===1?Un.createMouseTargetFromHitTestPosition(e,t,i.spanNode,i.position,i.injectedText):t.wouldBenefitFromHitTestTargetSwitch?(t.switchToHitTestTarget(),this._createMouseTarget(e,t)):t.fulfillUnknown()}static _hitTestMinimap(e,t){if(es.isChildOfMinimap(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new A(i,n))}return null}static _hitTestScrollbarSlider(e,t){if(es.isChildOfScrollableElement(t.targetPath)&&t.target&&t.target.nodeType===1){const i=t.target.className;if(i&&/\b(slider|scrollbar)\b/.test(i)){const n=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),s=e.viewModel.getLineMaxColumn(n);return t.fulfillScrollbar(new A(n,s))}}return null}static _hitTestScrollbar(e,t){if(es.isChildOfScrollableElement(t.targetPath)){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.viewModel.getLineMaxColumn(i);return t.fulfillScrollbar(new A(i,n))}return null}getMouseColumn(e){const t=this._context.configuration.options,i=t.get(146),n=this._context.viewLayout.getCurrentScrollLeft()+e.x-i.contentLeft;return Un._getMouseColumn(n,t.get(50).typicalHalfwidthCharacterWidth)}static _getMouseColumn(e,t){return e<0?1:Math.round(e/t)+1}static createMouseTargetFromHitTestPosition(e,t,i,n,s){const r=n.lineNumber,a=n.column,l=e.getLineWidth(r);if(t.mouseContentHorizontalOffset>l){const b=QI(t.mouseContentHorizontalOffset-l);return t.fulfillContentEmpty(n,b)}const c=e.visibleRangeForPosition(r,a);if(!c)return t.fulfillUnknown(n);const d=c.left;if(Math.abs(t.mouseContentHorizontalOffset-d)<1)return t.fulfillContentText(n,null,{mightBeForeignElement:!!s,injectedText:s});const h=[];if(h.push({offset:c.left,column:a}),a>1){const b=e.visibleRangeForPosition(r,a-1);b&&h.push({offset:b.left,column:a-1})}const u=e.viewModel.getLineMaxColumn(r);if(a<u){const b=e.visibleRangeForPosition(r,a+1);b&&h.push({offset:b.left,column:a+1})}h.sort((b,v)=>b.offset-v.offset);const g=t.pos.toClientCoordinates(xe(e.viewDomNode)),f=i.getBoundingClientRect(),m=f.left<=g.clientX&&g.clientX<=f.right;let _=null;for(let b=1;b<h.length;b++){const v=h[b-1],y=h[b];if(v.offset<=t.mouseContentHorizontalOffset&&t.mouseContentHorizontalOffset<=y.offset){_=new L(r,v.column,r,y.column);const C=Math.abs(v.offset-t.mouseContentHorizontalOffset),w=Math.abs(y.offset-t.mouseContentHorizontalOffset);n=C<w?new A(r,v.column):new A(r,y.column);break}}return t.fulfillContentText(n,_,{mightBeForeignElement:!m||!!s,injectedText:s})}static _doHitTestWithCaretRangeFromPoint(e,t){const i=e.getLineNumberAtVerticalOffset(t.mouseVerticalOffset),n=e.getVerticalOffsetForLineNumber(i),s=n+e.lineHeight;if(!(i===e.viewModel.getLineCount()&&t.mouseVerticalOffset>s)){const a=Math.floor((n+s)/2);let l=t.pos.y+(a-t.mouseVerticalOffset);l<=t.editorPos.y&&(l=t.editorPos.y+1),l>=t.editorPos.y+t.editorPos.height&&(l=t.editorPos.y+t.editorPos.height-1);const c=new nD(t.pos.x,l),d=this._actualDoHitTestWithCaretRangeFromPoint(e,c.toClientCoordinates(xe(e.viewDomNode)));if(d.type===1)return d}return this._actualDoHitTestWithCaretRangeFromPoint(e,t.pos.toClientCoordinates(xe(e.viewDomNode)))}static _actualDoHitTestWithCaretRangeFromPoint(e,t){const i=vf(e.viewDomNode);let n;if(i?typeof i.caretRangeFromPoint>"u"?n=mpe(i,t.clientX,t.clientY):n=i.caretRangeFromPoint(t.clientX,t.clientY):n=e.viewDomNode.ownerDocument.caretRangeFromPoint(t.clientX,t.clientY),!n||!n.startContainer)return new wd;const s=n.startContainer;if(s.nodeType===s.TEXT_NODE){const r=s.parentNode,a=r?r.parentNode:null,l=a?a.parentNode:null;return(l&&l.nodeType===l.ELEMENT_NODE?l.className:null)===wc.CLASS_NAME?Hu.createFromDOMInfo(e,r,n.startOffset):new wd(s.parentNode)}else if(s.nodeType===s.ELEMENT_NODE){const r=s.parentNode,a=r?r.parentNode:null;return(a&&a.nodeType===a.ELEMENT_NODE?a.className:null)===wc.CLASS_NAME?Hu.createFromDOMInfo(e,s,s.textContent.length):new wd(s)}return new wd}static _doHitTestWithCaretPositionFromPoint(e,t){const i=e.viewDomNode.ownerDocument.caretPositionFromPoint(t.clientX,t.clientY);if(i.offsetNode.nodeType===i.offsetNode.TEXT_NODE){const n=i.offsetNode.parentNode,s=n?n.parentNode:null,r=s?s.parentNode:null;return(r&&r.nodeType===r.ELEMENT_NODE?r.className:null)===wc.CLASS_NAME?Hu.createFromDOMInfo(e,i.offsetNode.parentNode,i.offset):new wd(i.offsetNode.parentNode)}if(i.offsetNode.nodeType===i.offsetNode.ELEMENT_NODE){const n=i.offsetNode.parentNode,s=n&&n.nodeType===n.ELEMENT_NODE?n.className:null,r=n?n.parentNode:null,a=r&&r.nodeType===r.ELEMENT_NODE?r.className:null;if(s===wc.CLASS_NAME){const l=i.offsetNode.childNodes[Math.min(i.offset,i.offsetNode.childNodes.length-1)];if(l)return Hu.createFromDOMInfo(e,l,0)}else if(a===wc.CLASS_NAME)return Hu.createFromDOMInfo(e,i.offsetNode,0)}return new wd(i.offsetNode)}static _snapToSoftTabBoundary(e,t){const i=t.getLineContent(e.lineNumber),{tabSize:n}=t.model.getOptions(),s=Py.atomicPosition(i,e.column-1,n,2);return s!==-1?new A(e.lineNumber,s+1):e}static doHitTest(e,t){let i=new wd;if(typeof e.viewDomNode.ownerDocument.caretRangeFromPoint=="function"?i=this._doHitTestWithCaretRangeFromPoint(e,t):e.viewDomNode.ownerDocument.caretPositionFromPoint&&(i=this._doHitTestWithCaretPositionFromPoint(e,t.pos.toClientCoordinates(xe(e.viewDomNode)))),i.type===1){const n=e.viewModel.getInjectedTextAt(i.position),s=e.viewModel.normalizePosition(i.position,2);(n||!s.equals(i.position))&&(i=new zK(s,i.spanNode,n))}return i}}function mpe(o,e,t){const i=document.createRange();let n=o.elementFromPoint(e,t);if(n!==null){for(;n&&n.firstChild&&n.firstChild.nodeType!==n.firstChild.TEXT_NODE&&n.lastChild&&n.lastChild.firstChild;)n=n.lastChild;const s=n.getBoundingClientRect(),r=xe(n),a=r.getComputedStyle(n,null).getPropertyValue("font-style"),l=r.getComputedStyle(n,null).getPropertyValue("font-variant"),c=r.getComputedStyle(n,null).getPropertyValue("font-weight"),d=r.getComputedStyle(n,null).getPropertyValue("font-size"),h=r.getComputedStyle(n,null).getPropertyValue("line-height"),u=r.getComputedStyle(n,null).getPropertyValue("font-family"),g=`${a} ${l} ${c} ${d}/${h} ${u}`,f=n.innerText;let m=s.left,_=0,b;if(e>s.left+s.width)_=f.length;else{const v=HM.getInstance();for(let y=0;y<f.length+1;y++){if(b=v.getCharWidth(f.charAt(y),g)/2,m+=b,e<m){_=y;break}m+=b}}i.setStart(n.firstChild,_),i.setEnd(n.firstChild,_)}return i}const qu=class qu{static getInstance(){return qu._INSTANCE||(qu._INSTANCE=new qu),qu._INSTANCE}constructor(){this._cache={},this._canvas=document.createElement("canvas")}getCharWidth(e,t){const i=e+t;if(this._cache[i])return this._cache[i];const n=this._canvas.getContext("2d");n.font=t;const r=n.measureText(e).width;return this._cache[i]=r,r}};qu._INSTANCE=null;let HM=qu;class LB extends Kw{constructor(e,t,i){super(),this._mouseLeaveMonitor=null,this._context=e,this.viewController=t,this.viewHelper=i,this.mouseTargetFactory=new Un(this._context,i),this._mouseDownOperation=this._register(new _pe(this._context,this.viewController,this.viewHelper,this.mouseTargetFactory,(r,a)=>this._createMouseTarget(r,a),r=>this._getMouseColumn(r))),this.lastMouseLeaveTime=-1,this._height=this._context.configuration.options.get(146).height;const n=new epe(this.viewHelper.viewDomNode);this._register(n.onContextMenu(this.viewHelper.viewDomNode,r=>this._onContextMenu(r,!0))),this._register(n.onMouseMove(this.viewHelper.viewDomNode,r=>{this._onMouseMove(r),this._mouseLeaveMonitor||(this._mouseLeaveMonitor=H(this.viewHelper.viewDomNode.ownerDocument,"mousemove",a=>{this.viewHelper.viewDomNode.contains(a.target)||this._onMouseLeave(new Vh(a,!1,this.viewHelper.viewDomNode))}))})),this._register(n.onMouseUp(this.viewHelper.viewDomNode,r=>this._onMouseUp(r))),this._register(n.onMouseLeave(this.viewHelper.viewDomNode,r=>this._onMouseLeave(r)));let s=0;this._register(n.onPointerDown(this.viewHelper.viewDomNode,(r,a)=>{s=a})),this._register(H(this.viewHelper.viewDomNode,ee.POINTER_UP,r=>{this._mouseDownOperation.onPointerUp()})),this._register(n.onMouseDown(this.viewHelper.viewDomNode,r=>this._onMouseDown(r,s))),this._setupMouseWheelZoomListener(),this._context.addEventHandler(this)}_setupMouseWheelZoomListener(){const e=J0.INSTANCE;let t=0,i=ir.getZoomLevel(),n=!1,s=0;const r=l=>{if(this.viewController.emitMouseWheel(l),!this._context.configuration.options.get(76))return;const c=new bf(l);if(e.acceptStandardWheelEvent(c),e.isPhysicalMouseWheel()){if(a(l)){const d=ir.getZoomLevel(),h=c.deltaY>0?1:-1;ir.setZoomLevel(d+h),c.preventDefault(),c.stopPropagation()}}else Date.now()-t>50&&(i=ir.getZoomLevel(),n=a(l),s=0),t=Date.now(),s+=c.deltaY,n&&(ir.setZoomLevel(i+s/5),c.preventDefault(),c.stopPropagation())};this._register(H(this.viewHelper.viewDomNode,ee.MOUSE_WHEEL,r,{capture:!0,passive:!1}));function a(l){return Qe?(l.metaKey||l.ctrlKey)&&!l.shiftKey&&!l.altKey:l.ctrlKey&&!l.metaKey&&!l.shiftKey&&!l.altKey}}dispose(){this._context.removeEventHandler(this),this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),super.dispose()}onConfigurationChanged(e){if(e.hasChanged(146)){const t=this._context.configuration.options.get(146).height;this._height!==t&&(this._height=t,this._mouseDownOperation.onHeightChanged())}return!1}onCursorStateChanged(e){return this._mouseDownOperation.onCursorStateChanged(e),!1}onFocusChanged(e){return!1}getTargetAtClientPoint(e,t){const n=new WK(e,t).toPageCoordinates(xe(this.viewHelper.viewDomNode)),s=wB(this.viewHelper.viewDomNode);if(n.y<s.y||n.y>s.y+s.height||n.x<s.x||n.x>s.x+s.width)return null;const r=SB(this.viewHelper.viewDomNode,s,n);return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),s,n,r,null)}_createMouseTarget(e,t){let i=e.target;if(!this.viewHelper.viewDomNode.contains(i)){const n=vf(this.viewHelper.viewDomNode);n&&(i=n.elementsFromPoint(e.posx,e.posy).find(s=>this.viewHelper.viewDomNode.contains(s)))}return this.mouseTargetFactory.createMouseTarget(this.viewHelper.getLastRenderData(),e.editorPos,e.pos,e.relativePos,t?i:null)}_getMouseColumn(e){return this.mouseTargetFactory.getMouseColumn(e.relativePos)}_onContextMenu(e,t){this.viewController.emitContextMenu({event:e,target:this._createMouseTarget(e,t)})}_onMouseMove(e){this.mouseTargetFactory.mouseTargetIsWidget(e)||e.preventDefault(),!(this._mouseDownOperation.isActive()||e.timestamp<this.lastMouseLeaveTime)&&this.viewController.emitMouseMove({event:e,target:this._createMouseTarget(e,!0)})}_onMouseLeave(e){this._mouseLeaveMonitor&&(this._mouseLeaveMonitor.dispose(),this._mouseLeaveMonitor=null),this.lastMouseLeaveTime=new Date().getTime(),this.viewController.emitMouseLeave({event:e,target:null})}_onMouseUp(e){this.viewController.emitMouseUp({event:e,target:this._createMouseTarget(e,!0)})}_onMouseDown(e,t){const i=this._createMouseTarget(e,!0),n=i.type===6||i.type===7,s=i.type===2||i.type===3||i.type===4,r=i.type===3,a=this._context.configuration.options.get(110),l=i.type===8||i.type===5,c=i.type===9;let d=e.leftButton||e.middleButton;Qe&&e.leftButton&&e.ctrlKey&&(d=!1);const h=()=>{e.preventDefault(),this.viewHelper.focusTextArea()};if(d&&(n||r&&a))h(),this._mouseDownOperation.start(i.type,e,t);else if(s)e.preventDefault();else if(l){const u=i.detail;d&&this.viewHelper.shouldSuppressMouseDownOnViewZone(u.viewZoneId)&&(h(),this._mouseDownOperation.start(i.type,e,t),e.preventDefault())}else c&&this.viewHelper.shouldSuppressMouseDownOnWidget(i.detail)&&(h(),e.preventDefault());this.viewController.emitMouseDown({event:e,target:i})}}class _pe extends F{constructor(e,t,i,n,s,r){super(),this._context=e,this._viewController=t,this._viewHelper=i,this._mouseTargetFactory=n,this._createMouseTarget=s,this._getMouseColumn=r,this._mouseMoveMonitor=this._register(new ipe(this._viewHelper.viewDomNode)),this._topBottomDragScrolling=this._register(new bpe(this._context,this._viewHelper,this._mouseTargetFactory,(a,l,c)=>this._dispatchMouse(a,l,c))),this._mouseState=new zM,this._currentSelection=new pe(1,1,1,1),this._isActive=!1,this._lastMouseEvent=null}dispose(){super.dispose()}isActive(){return this._isActive}_onMouseDownThenMove(e){this._lastMouseEvent=e,this._mouseState.setModifiers(e);const t=this._findMousePosition(e,!1);t&&(this._mouseState.isDragAndDrop?this._viewController.emitMouseDrag({event:e,target:t}):t.type===13&&(t.outsidePosition==="above"||t.outsidePosition==="below")?this._topBottomDragScrolling.start(t,e):(this._topBottomDragScrolling.stop(),this._dispatchMouse(t,!0,1)))}start(e,t,i){this._lastMouseEvent=t,this._mouseState.setStartedOnLineNumbers(e===3),this._mouseState.setStartButtons(t),this._mouseState.setModifiers(t);const n=this._findMousePosition(t,!0);if(!n||!n.position)return;this._mouseState.trySetCount(t.detail,n.position),t.detail=this._mouseState.count;const s=this._context.configuration.options;if(!s.get(92)&&s.get(35)&&!s.get(22)&&!this._mouseState.altKey&&t.detail<2&&!this._isActive&&!this._currentSelection.isEmpty()&&n.type===6&&n.position&&this._currentSelection.containsPosition(n.position)){this._mouseState.isDragAndDrop=!0,this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),r=>{const a=this._findMousePosition(this._lastMouseEvent,!1);fc(r)?this._viewController.emitMouseDropCanceled():this._viewController.emitMouseDrop({event:this._lastMouseEvent,target:a?this._createMouseTarget(this._lastMouseEvent,!0):null}),this._stop()});return}this._mouseState.isDragAndDrop=!1,this._dispatchMouse(n,t.shiftKey,1),this._isActive||(this._isActive=!0,this._mouseMoveMonitor.startMonitoring(this._viewHelper.viewLinesDomNode,i,t.buttons,r=>this._onMouseDownThenMove(r),()=>this._stop()))}_stop(){this._isActive=!1,this._topBottomDragScrolling.stop()}onHeightChanged(){this._mouseMoveMonitor.stopMonitoring()}onPointerUp(){this._mouseMoveMonitor.stopMonitoring()}onCursorStateChanged(e){this._currentSelection=e.selections[0]}_getPositionOutsideEditor(e){const t=e.editorPos,i=this._context.viewModel,n=this._context.viewLayout,s=this._getMouseColumn(e);if(e.posy<t.y){const a=t.y-e.posy,l=Math.max(n.getCurrentScrollTop()-a,0),c=O_.getZoneAtCoord(this._context,l);if(c){const h=this._helpPositionJumpOverViewZone(c);if(h)return Gn.createOutsideEditor(s,h,"above",a)}const d=n.getLineNumberAtVerticalOffset(l);return Gn.createOutsideEditor(s,new A(d,1),"above",a)}if(e.posy>t.y+t.height){const a=e.posy-t.y-t.height,l=n.getCurrentScrollTop()+e.relativePos.y,c=O_.getZoneAtCoord(this._context,l);if(c){const h=this._helpPositionJumpOverViewZone(c);if(h)return Gn.createOutsideEditor(s,h,"below",a)}const d=n.getLineNumberAtVerticalOffset(l);return Gn.createOutsideEditor(s,new A(d,i.getLineMaxColumn(d)),"below",a)}const r=n.getLineNumberAtVerticalOffset(n.getCurrentScrollTop()+e.relativePos.y);if(e.posx<t.x){const a=t.x-e.posx;return Gn.createOutsideEditor(s,new A(r,1),"left",a)}if(e.posx>t.x+t.width){const a=e.posx-t.x-t.width;return Gn.createOutsideEditor(s,new A(r,i.getLineMaxColumn(r)),"right",a)}return null}_findMousePosition(e,t){const i=this._getPositionOutsideEditor(e);if(i)return i;const n=this._createMouseTarget(e,t);if(!n.position)return null;if(n.type===8||n.type===5){const r=this._helpPositionJumpOverViewZone(n.detail);if(r)return Gn.createViewZone(n.type,n.element,n.mouseColumn,r,n.detail)}return n}_helpPositionJumpOverViewZone(e){const t=new A(this._currentSelection.selectionStartLineNumber,this._currentSelection.selectionStartColumn),i=e.positionBefore,n=e.positionAfter;return i&&n?i.isBefore(t)?i:n:null}_dispatchMouse(e,t,i){e.position&&this._viewController.dispatchMouse({position:e.position,mouseColumn:e.mouseColumn,startedOnLineNumbers:this._mouseState.startedOnLineNumbers,revealType:i,inSelectionMode:t,mouseDownCount:this._mouseState.count,altKey:this._mouseState.altKey,ctrlKey:this._mouseState.ctrlKey,metaKey:this._mouseState.metaKey,shiftKey:this._mouseState.shiftKey,leftButton:this._mouseState.leftButton,middleButton:this._mouseState.middleButton,onInjectedText:e.type===6&&e.detail.injectedText!==null})}}class bpe extends F{constructor(e,t,i,n){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._operation=null}dispose(){super.dispose(),this.stop()}start(e,t){this._operation?this._operation.setPosition(e,t):this._operation=new vpe(this._context,this._viewHelper,this._mouseTargetFactory,this._dispatchMouse,e,t)}stop(){this._operation&&(this._operation.dispose(),this._operation=null)}}class vpe extends F{constructor(e,t,i,n,s,r){super(),this._context=e,this._viewHelper=t,this._mouseTargetFactory=i,this._dispatchMouse=n,this._position=s,this._mouseEvent=r,this._lastTime=Date.now(),this._animationFrameDisposable=ao(xe(r.browserEvent),()=>this._execute())}dispose(){this._animationFrameDisposable.dispose(),super.dispose()}setPosition(e,t){this._position=e,this._mouseEvent=t}_tick(){const e=Date.now(),t=e-this._lastTime;return this._lastTime=e,t}_getScrollSpeed(){const e=this._context.configuration.options.get(67),t=this._context.configuration.options.get(146).height/e,i=this._position.outsideDistance/e;return i<=1.5?Math.max(30,t*(1+i)):i<=3?Math.max(60,t*(2+i)):Math.max(200,t*(7+i))}_execute(){const e=this._context.configuration.options.get(67),t=this._getScrollSpeed(),i=this._tick(),n=t*(i/1e3)*e,s=this._position.outsidePosition==="above"?-n:n;this._context.viewModel.viewLayout.deltaScrollNow(0,s),this._viewHelper.renderNow();const r=this._context.viewLayout.getLinesViewportData(),a=this._position.outsidePosition==="above"?r.startLineNumber:r.endLineNumber;let l;{const c=wB(this._viewHelper.viewDomNode),d=this._context.configuration.options.get(146).horizontalScrollbarHeight,h=new nD(this._mouseEvent.pos.x,c.y+c.height-d-.1),u=SB(this._viewHelper.viewDomNode,c,h);l=this._mouseTargetFactory.createMouseTarget(this._viewHelper.getLastRenderData(),c,h,u,null)}(!l.position||l.position.lineNumber!==a)&&(this._position.outsidePosition==="above"?l=Gn.createOutsideEditor(this._position.mouseColumn,new A(a,1),"above",this._position.outsideDistance):l=Gn.createOutsideEditor(this._position.mouseColumn,new A(a,this._context.viewModel.getLineMaxColumn(a)),"below",this._position.outsideDistance)),this._dispatchMouse(l,!0,2),this._animationFrameDisposable=ao(xe(l.element),()=>this._execute())}}const Zk=class Zk{get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get metaKey(){return this._metaKey}get shiftKey(){return this._shiftKey}get leftButton(){return this._leftButton}get middleButton(){return this._middleButton}get startedOnLineNumbers(){return this._startedOnLineNumbers}constructor(){this._altKey=!1,this._ctrlKey=!1,this._metaKey=!1,this._shiftKey=!1,this._leftButton=!1,this._middleButton=!1,this._startedOnLineNumbers=!1,this._lastMouseDownPosition=null,this._lastMouseDownPositionEqualCount=0,this._lastMouseDownCount=0,this._lastSetMouseDownCountTime=0,this.isDragAndDrop=!1}get count(){return this._lastMouseDownCount}setModifiers(e){this._altKey=e.altKey,this._ctrlKey=e.ctrlKey,this._metaKey=e.metaKey,this._shiftKey=e.shiftKey}setStartButtons(e){this._leftButton=e.leftButton,this._middleButton=e.middleButton}setStartedOnLineNumbers(e){this._startedOnLineNumbers=e}trySetCount(e,t){const i=new Date().getTime();i-this._lastSetMouseDownCountTime>Zk.CLEAR_MOUSE_DOWN_COUNT_TIME&&(e=1),this._lastSetMouseDownCountTime=i,e>this._lastMouseDownCount+1&&(e=this._lastMouseDownCount+1),this._lastMouseDownPosition&&this._lastMouseDownPosition.equals(t)?this._lastMouseDownPositionEqualCount++:this._lastMouseDownPositionEqualCount=1,this._lastMouseDownPosition=t,this._lastMouseDownCount=Math.min(e,this._lastMouseDownPositionEqualCount)}};Zk.CLEAR_MOUSE_DOWN_COUNT_TIME=400;let zM=Zk;const wm=class wm{constructor(e,t,i,n,s){this.value=e,this.selectionStart=t,this.selectionEnd=i,this.selection=n,this.newlineCountBeforeSelection=s}toString(){return`[ <${this.value}>, selectionStart: ${this.selectionStart}, selectionEnd: ${this.selectionEnd}]`}static readFromTextArea(e,t){const i=e.getValue(),n=e.getSelectionStart(),s=e.getSelectionEnd();let r;if(t){const a=i.substring(0,n),l=t.value.substring(0,t.selectionStart);a===l&&(r=t.newlineCountBeforeSelection)}return new wm(i,n,s,null,r)}collapseSelection(){return this.selectionStart===this.value.length?this:new wm(this.value,this.value.length,this.value.length,null,void 0)}writeToTextArea(e,t,i){t.setValue(e,this.value),i&&t.setSelectionRange(e,this.selectionStart,this.selectionEnd)}deduceEditorPosition(e){if(e<=this.selectionStart){const n=this.value.substring(e,this.selectionStart);return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,n,-1)}if(e>=this.selectionEnd){const n=this.value.substring(this.selectionEnd,e);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,n,1)}const t=this.value.substring(this.selectionStart,e);if(t.indexOf("…")===-1)return this._finishDeduceEditorPosition(this.selection?.getStartPosition()??null,t,1);const i=this.value.substring(e,this.selectionEnd);return this._finishDeduceEditorPosition(this.selection?.getEndPosition()??null,i,-1)}_finishDeduceEditorPosition(e,t,i){let n=0,s=-1;for(;(s=t.indexOf(`
`,s+1))!==-1;)n++;return[e,i*t.length,n]}static deduceInput(e,t,i){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};const n=Math.min(Dh(e.value,t.value),e.selectionStart,t.selectionStart),s=Math.min(E0(e.value,t.value),e.value.length-e.selectionEnd,t.value.length-t.selectionEnd);e.value.substring(n,e.value.length-s);const r=t.value.substring(n,t.value.length-s),a=e.selectionStart-n,l=e.selectionEnd-n,c=t.selectionStart-n,d=t.selectionEnd-n;if(c===d){const u=e.selectionStart-n;return{text:r,replacePrevCharCnt:u,replaceNextCharCnt:0,positionDelta:0}}const h=l-a;return{text:r,replacePrevCharCnt:h,replaceNextCharCnt:0,positionDelta:0}}static deduceAndroidCompositionInput(e,t){if(!e)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:0};if(e.value===t.value)return{text:"",replacePrevCharCnt:0,replaceNextCharCnt:0,positionDelta:t.selectionEnd-e.selectionEnd};const i=Math.min(Dh(e.value,t.value),e.selectionEnd),n=Math.min(E0(e.value,t.value),e.value.length-e.selectionEnd),s=e.value.substring(i,e.value.length-n),r=t.value.substring(i,t.value.length-n);e.selectionStart-i;const a=e.selectionEnd-i;t.selectionStart-i;const l=t.selectionEnd-i;return{text:r,replacePrevCharCnt:a,replaceNextCharCnt:s.length-a,positionDelta:l-r.length}}};wm.EMPTY=new wm("",0,0,null,void 0);let $n=wm;class tm{static _getPageOfLine(e,t){return Math.floor((e-1)/t)}static _getRangeForPage(e,t){const i=e*t,n=i+1,s=i+t;return new L(n,1,s+1,1)}static fromEditorSelection(e,t,i,n){const r=tm._getPageOfLine(t.startLineNumber,i),a=tm._getRangeForPage(r,i),l=tm._getPageOfLine(t.endLineNumber,i),c=tm._getRangeForPage(l,i);let d=a.intersectRanges(new L(1,1,t.startLineNumber,t.startColumn));if(n&&e.getValueLengthInRange(d,1)>500){const b=e.modifyPosition(d.getEndPosition(),-500);d=L.fromPositions(b,d.getEndPosition())}const h=e.getValueInRange(d,1),u=e.getLineCount(),g=e.getLineMaxColumn(u);let f=c.intersectRanges(new L(t.endLineNumber,t.endColumn,u,g));if(n&&e.getValueLengthInRange(f,1)>500){const b=e.modifyPosition(f.getStartPosition(),500);f=L.fromPositions(f.getStartPosition(),b)}const m=e.getValueInRange(f,1);let _;if(r===l||r+1===l)_=e.getValueInRange(t,1);else{const b=a.intersectRanges(t),v=c.intersectRanges(t);_=e.getValueInRange(b,1)+"…"+e.getValueInRange(v,1)}return n&&_.length>2*500&&(_=_.substring(0,500)+"…"+_.substring(_.length-500,_.length)),new $n(h+_+m,h.length,h.length+_.length,t,d.endLineNumber-d.startLineNumber)}}var Cpe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},J7=function(o,e){return function(t,i){e(t,i,o)}},jx;(function(o){o.Tap="-monaco-textarea-synthetic-tap"})(jx||(jx={}));const UM={forceCopyWithSyntaxHighlighting:!1},Yk=class Yk{constructor(){this._lastState=null}set(e,t){this._lastState={lastCopiedValue:e,data:t}}get(e){return this._lastState&&this._lastState.lastCopiedValue===e?this._lastState.data:(this._lastState=null,null)}};Yk.INSTANCE=new Yk;let Ay=Yk;class ype{constructor(){this._lastTypeTextLength=0}handleCompositionUpdate(e){e=e||"";const t={text:e,replacePrevCharCnt:this._lastTypeTextLength,replaceNextCharCnt:0,positionDelta:0};return this._lastTypeTextLength=e.length,t}}let GM=class extends F{get textAreaState(){return this._textAreaState}constructor(e,t,i,n,s,r){super(),this._host=e,this._textArea=t,this._OS=i,this._browser=n,this._accessibilityService=s,this._logService=r,this._onFocus=this._register(new O),this.onFocus=this._onFocus.event,this._onBlur=this._register(new O),this.onBlur=this._onBlur.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._onKeyUp=this._register(new O),this.onKeyUp=this._onKeyUp.event,this._onCut=this._register(new O),this.onCut=this._onCut.event,this._onPaste=this._register(new O),this.onPaste=this._onPaste.event,this._onType=this._register(new O),this.onType=this._onType.event,this._onCompositionStart=this._register(new O),this.onCompositionStart=this._onCompositionStart.event,this._onCompositionUpdate=this._register(new O),this.onCompositionUpdate=this._onCompositionUpdate.event,this._onCompositionEnd=this._register(new O),this.onCompositionEnd=this._onCompositionEnd.event,this._onSelectionChangeRequest=this._register(new O),this.onSelectionChangeRequest=this._onSelectionChangeRequest.event,this._asyncFocusGainWriteScreenReaderContent=this._register(new Yi),this._asyncTriggerCut=this._register(new xt(()=>this._onCut.fire(),0)),this._textAreaState=$n.EMPTY,this._selectionChangeListener=null,this._accessibilityService.isScreenReaderOptimized()&&this.writeNativeTextAreaContent("ctor"),this._register(se.runAndSubscribe(this._accessibilityService.onDidChangeScreenReaderOptimized,()=>{this._accessibilityService.isScreenReaderOptimized()&&!this._asyncFocusGainWriteScreenReaderContent.value?this._asyncFocusGainWriteScreenReaderContent.value=this._register(new xt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)):this._asyncFocusGainWriteScreenReaderContent.clear()})),this._hasFocus=!1,this._currentComposition=null;let a=null;this._register(this._textArea.onKeyDown(l=>{const c=new Pt(l);(c.keyCode===114||this._currentComposition&&c.keyCode===1)&&c.stopPropagation(),c.equals(9)&&c.preventDefault(),a=c,this._onKeyDown.fire(c)})),this._register(this._textArea.onKeyUp(l=>{const c=new Pt(l);this._onKeyUp.fire(c)})),this._register(this._textArea.onCompositionStart(l=>{const c=new ype;if(this._currentComposition){this._currentComposition=c;return}if(this._currentComposition=c,this._OS===2&&a&&a.equals(114)&&this._textAreaState.selectionStart===this._textAreaState.selectionEnd&&this._textAreaState.selectionStart>0&&this._textAreaState.value.substr(this._textAreaState.selectionStart-1,1)===l.data&&(a.code==="ArrowRight"||a.code==="ArrowLeft")){c.handleCompositionUpdate("x"),this._onCompositionStart.fire({data:l.data});return}if(this._browser.isAndroid){this._onCompositionStart.fire({data:l.data});return}this._onCompositionStart.fire({data:l.data})})),this._register(this._textArea.onCompositionUpdate(l=>{const c=this._currentComposition;if(!c)return;if(this._browser.isAndroid){const h=$n.readFromTextArea(this._textArea,this._textAreaState),u=$n.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(u),this._onCompositionUpdate.fire(l);return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=$n.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionUpdate.fire(l)})),this._register(this._textArea.onCompositionEnd(l=>{const c=this._currentComposition;if(!c)return;if(this._currentComposition=null,this._browser.isAndroid){const h=$n.readFromTextArea(this._textArea,this._textAreaState),u=$n.deduceAndroidCompositionInput(this._textAreaState,h);this._textAreaState=h,this._onType.fire(u),this._onCompositionEnd.fire();return}const d=c.handleCompositionUpdate(l.data);this._textAreaState=$n.readFromTextArea(this._textArea,this._textAreaState),this._onType.fire(d),this._onCompositionEnd.fire()})),this._register(this._textArea.onInput(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received input event"),this._currentComposition)return;const c=$n.readFromTextArea(this._textArea,this._textAreaState),d=$n.deduceInput(this._textAreaState,c,this._OS===2);d.replacePrevCharCnt===0&&d.text.length===1&&($i(d.text.charCodeAt(0))||d.text.charCodeAt(0)===127)||(this._textAreaState=c,(d.text!==""||d.replacePrevCharCnt!==0||d.replaceNextCharCnt!==0||d.positionDelta!==0)&&this._onType.fire(d))})),this._register(this._textArea.onCut(l=>{this._textArea.setIgnoreSelectionChangeTime("received cut event"),this._ensureClipboardGetsEditorSelection(l),this._asyncTriggerCut.schedule()})),this._register(this._textArea.onCopy(l=>{this._ensureClipboardGetsEditorSelection(l)})),this._register(this._textArea.onPaste(l=>{if(this._textArea.setIgnoreSelectionChangeTime("received paste event"),l.preventDefault(),!l.clipboardData)return;let[c,d]=$M.getTextData(l.clipboardData);c&&(d=d||Ay.INSTANCE.get(c),this._onPaste.fire({text:c,metadata:d}))})),this._register(this._textArea.onFocus(()=>{const l=this._hasFocus;this._setHasFocus(!0),this._accessibilityService.isScreenReaderOptimized()&&this._browser.isSafari&&!l&&this._hasFocus&&(this._asyncFocusGainWriteScreenReaderContent.value||(this._asyncFocusGainWriteScreenReaderContent.value=new xt(()=>this.writeNativeTextAreaContent("asyncFocusGain"),0)),this._asyncFocusGainWriteScreenReaderContent.value.schedule())})),this._register(this._textArea.onBlur(()=>{this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("blurWithoutCompositionEnd"),this._onCompositionEnd.fire()),this._setHasFocus(!1)})),this._register(this._textArea.onSyntheticTap(()=>{this._browser.isAndroid&&this._currentComposition&&(this._currentComposition=null,this.writeNativeTextAreaContent("tapWithoutCompositionEnd"),this._onCompositionEnd.fire())}))}_installSelectionChangeListener(){let e=0;return H(this._textArea.ownerDocument,"selectionchange",t=>{if(qd.onSelectionChange(),!this._hasFocus||this._currentComposition||!this._browser.isChrome)return;const i=Date.now(),n=i-e;if(e=i,n<5)return;const s=i-this._textArea.getIgnoreSelectionChangeTime();if(this._textArea.resetSelectionChangeTime(),s<100||!this._textAreaState.selection)return;const r=this._textArea.getValue();if(this._textAreaState.value!==r)return;const a=this._textArea.getSelectionStart(),l=this._textArea.getSelectionEnd();if(this._textAreaState.selectionStart===a&&this._textAreaState.selectionEnd===l)return;const c=this._textAreaState.deduceEditorPosition(a),d=this._host.deduceModelPosition(c[0],c[1],c[2]),h=this._textAreaState.deduceEditorPosition(l),u=this._host.deduceModelPosition(h[0],h[1],h[2]),g=new pe(d.lineNumber,d.column,u.lineNumber,u.column);this._onSelectionChangeRequest.fire(g)})}dispose(){super.dispose(),this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null)}focusTextArea(){this._setHasFocus(!0),this.refreshFocusState()}isFocused(){return this._hasFocus}refreshFocusState(){this._setHasFocus(this._textArea.hasFocus())}_setHasFocus(e){this._hasFocus!==e&&(this._hasFocus=e,this._selectionChangeListener&&(this._selectionChangeListener.dispose(),this._selectionChangeListener=null),this._hasFocus&&(this._selectionChangeListener=this._installSelectionChangeListener()),this._hasFocus&&this.writeNativeTextAreaContent("focusgain"),this._hasFocus?this._onFocus.fire():this._onBlur.fire())}_setAndWriteTextAreaState(e,t){this._hasFocus||(t=t.collapseSelection()),t.writeToTextArea(e,this._textArea,this._hasFocus),this._textAreaState=t}writeNativeTextAreaContent(e){!this._accessibilityService.isScreenReaderOptimized()&&e==="render"||this._currentComposition||(this._logService.trace(`writeTextAreaState(reason: ${e})`),this._setAndWriteTextAreaState(e,this._host.getScreenReaderContent()))}_ensureClipboardGetsEditorSelection(e){const t=this._host.getDataToCopy(),i={version:1,isFromEmptySelection:t.isFromEmptySelection,multicursorText:t.multicursorText,mode:t.mode};Ay.INSTANCE.set(this._browser.isFirefox?t.text.replace(/\r\n/g,`
`):t.text,i),e.preventDefault(),e.clipboardData&&$M.setTextData(e.clipboardData,t.text,t.html,i)}};GM=Cpe([J7(4,ho),J7(5,Tn)],GM);const $M={getTextData(o){const e=o.getData(vi.text);let t=null;const i=o.getData("vscode-editor-data");if(typeof i=="string")try{t=JSON.parse(i),t.version!==1&&(t=null)}catch{}return e.length===0&&t===null&&o.files.length>0?[Array.prototype.slice.call(o.files,0).map(s=>s.name).join(`
`),null]:[e,t]},setTextData(o,e,t,i){o.setData(vi.text,e),typeof t=="string"&&o.setData("text/html",t),o.setData("vscode-editor-data",JSON.stringify(i))}};class wpe extends F{get ownerDocument(){return this._actual.ownerDocument}constructor(e){super(),this._actual=e,this.onKeyDown=this._register(new et(this._actual,"keydown")).event,this.onKeyUp=this._register(new et(this._actual,"keyup")).event,this.onCompositionStart=this._register(new et(this._actual,"compositionstart")).event,this.onCompositionUpdate=this._register(new et(this._actual,"compositionupdate")).event,this.onCompositionEnd=this._register(new et(this._actual,"compositionend")).event,this.onBeforeInput=this._register(new et(this._actual,"beforeinput")).event,this.onInput=this._register(new et(this._actual,"input")).event,this.onCut=this._register(new et(this._actual,"cut")).event,this.onCopy=this._register(new et(this._actual,"copy")).event,this.onPaste=this._register(new et(this._actual,"paste")).event,this.onFocus=this._register(new et(this._actual,"focus")).event,this.onBlur=this._register(new et(this._actual,"blur")).event,this._onSyntheticTap=this._register(new O),this.onSyntheticTap=this._onSyntheticTap.event,this._ignoreSelectionChangeTime=0,this._register(this.onKeyDown(()=>qd.onKeyDown())),this._register(this.onBeforeInput(()=>qd.onBeforeInput())),this._register(this.onInput(()=>qd.onInput())),this._register(this.onKeyUp(()=>qd.onKeyUp())),this._register(H(this._actual,jx.Tap,()=>this._onSyntheticTap.fire()))}hasFocus(){const e=vf(this._actual);return e?e.activeElement===this._actual:this._actual.isConnected?Ln()===this._actual:!1}setIgnoreSelectionChangeTime(e){this._ignoreSelectionChangeTime=Date.now()}getIgnoreSelectionChangeTime(){return this._ignoreSelectionChangeTime}resetSelectionChangeTime(){this._ignoreSelectionChangeTime=0}getValue(){return this._actual.value}setValue(e,t){const i=this._actual;i.value!==t&&(this.setIgnoreSelectionChangeTime("setValue"),i.value=t)}getSelectionStart(){return this._actual.selectionDirection==="backward"?this._actual.selectionEnd:this._actual.selectionStart}getSelectionEnd(){return this._actual.selectionDirection==="backward"?this._actual.selectionStart:this._actual.selectionEnd}setSelectionRange(e,t,i){const n=this._actual;let s=null;const r=vf(n);r?s=r.activeElement:s=Ln();const a=xe(s),l=s===n,c=n.selectionStart,d=n.selectionEnd;if(l&&c===t&&d===i){dr&&a.parent!==a&&n.focus();return}if(l){this.setIgnoreSelectionChangeTime("setSelectionRange"),n.setSelectionRange(t,i),dr&&a.parent!==a&&n.focus();return}try{const h=nee(n);this.setIgnoreSelectionChangeTime("setSelectionRange"),n.focus(),n.setSelectionRange(t,i),see(n,h)}catch{}}}class Spe extends LB{constructor(e,t,i){super(e,t,i),this._register(Mn.addTarget(this.viewHelper.linesContentDomNode)),this._register(H(this.viewHelper.linesContentDomNode,Ot.Tap,s=>this.onTap(s))),this._register(H(this.viewHelper.linesContentDomNode,Ot.Change,s=>this.onChange(s))),this._register(H(this.viewHelper.linesContentDomNode,Ot.Contextmenu,s=>this._onContextMenu(new Vh(s,!1,this.viewHelper.viewDomNode),!1))),this._lastPointerType="mouse",this._register(H(this.viewHelper.linesContentDomNode,"pointerdown",s=>{const r=s.pointerType;if(r==="mouse"){this._lastPointerType="mouse";return}else r==="touch"?this._lastPointerType="touch":this._lastPointerType="pen"}));const n=new tpe(this.viewHelper.viewDomNode);this._register(n.onPointerMove(this.viewHelper.viewDomNode,s=>this._onMouseMove(s))),this._register(n.onPointerUp(this.viewHelper.viewDomNode,s=>this._onMouseUp(s))),this._register(n.onPointerLeave(this.viewHelper.viewDomNode,s=>this._onMouseLeave(s))),this._register(n.onPointerDown(this.viewHelper.viewDomNode,(s,r)=>this._onMouseDown(s,r)))}onTap(e){!e.initialTarget||!this.viewHelper.linesContentDomNode.contains(e.initialTarget)||(e.preventDefault(),this.viewHelper.focusTextArea(),this._dispatchGesture(e,!1))}onChange(e){this._lastPointerType==="touch"&&this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY),this._lastPointerType==="pen"&&this._dispatchGesture(e,!0)}_dispatchGesture(e,t){const i=this._createMouseTarget(new Vh(e,!1,this.viewHelper.viewDomNode),!1);i.position&&this.viewController.dispatchMouse({position:i.position,mouseColumn:i.position.column,startedOnLineNumbers:!1,revealType:1,mouseDownCount:e.tapCount,inSelectionMode:t,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1,leftButton:!1,middleButton:!1,onInjectedText:i.type===6&&i.detail.injectedText!==null})}_onMouseDown(e,t){e.browserEvent.pointerType!=="touch"&&super._onMouseDown(e,t)}}class xpe extends LB{constructor(e,t,i){super(e,t,i),this._register(Mn.addTarget(this.viewHelper.linesContentDomNode)),this._register(H(this.viewHelper.linesContentDomNode,Ot.Tap,n=>this.onTap(n))),this._register(H(this.viewHelper.linesContentDomNode,Ot.Change,n=>this.onChange(n))),this._register(H(this.viewHelper.linesContentDomNode,Ot.Contextmenu,n=>this._onContextMenu(new Vh(n,!1,this.viewHelper.viewDomNode),!1)))}onTap(e){e.preventDefault(),this.viewHelper.focusTextArea();const t=this._createMouseTarget(new Vh(e,!1,this.viewHelper.viewDomNode),!1);if(t.position){const i=document.createEvent("CustomEvent");i.initEvent(jx.Tap,!1,!0),this.viewHelper.dispatchTextAreaEvent(i),this.viewController.moveTo(t.position,1)}}onChange(e){this._context.viewModel.viewLayout.deltaScrollNow(-e.translationX,-e.translationY)}}class Lpe extends F{constructor(e,t,i){super(),(Ta||YY&&J6)&&F4.pointerEvents?this.handler=this._register(new Spe(e,t,i)):It.TouchEvent?this.handler=this._register(new xpe(e,t,i)):this.handler=this._register(new LB(e,t,i))}getTargetAtClientPoint(e,t){return this.handler.getTargetAtClientPoint(e,t)}}class Jf extends Kw{}const Xk=class Xk extends Jf{constructor(e){super(),this._context=e,this._readConfig(),this._lastCursorModelPosition=new A(1,1),this._renderResult=null,this._activeLineNumber=1,this._context.addEventHandler(this)}_readConfig(){const e=this._context.configuration.options;this._lineHeight=e.get(67);const t=e.get(68);this._renderLineNumbers=t.renderType,this._renderCustomLineNumbers=t.renderFn,this._renderFinalNewline=e.get(96);const i=e.get(146);this._lineNumbersLeft=i.lineNumbersLeft,this._lineNumbersWidth=i.lineNumbersWidth}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return this._readConfig(),!0}onCursorStateChanged(e){const t=e.selections[0].getPosition();this._lastCursorModelPosition=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(t);let i=!1;return this._activeLineNumber!==t.lineNumber&&(this._activeLineNumber=t.lineNumber,i=!0),(this._renderLineNumbers===2||this._renderLineNumbers===3)&&(i=!0),i}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onDecorationsChanged(e){return e.affectsLineNumber}_getLineRenderLineNumber(e){const t=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(e,1));if(t.column!==1)return"";const i=t.lineNumber;if(this._renderCustomLineNumbers)return this._renderCustomLineNumbers(i);if(this._renderLineNumbers===2){const n=Math.abs(this._lastCursorModelPosition.lineNumber-i);return n===0?'<span class="relative-current-line-number">'+i+"</span>":String(n)}if(this._renderLineNumbers===3){if(this._lastCursorModelPosition.lineNumber===i||i%10===0)return String(i);const n=this._context.viewModel.getLineCount();return i===n?String(i):""}return String(i)}prepareRender(e){if(this._renderLineNumbers===0){this._renderResult=null;return}const t=us?this._lineHeight%2===0?" lh-even":" lh-odd":"",i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,s=this._context.viewModel.getDecorationsInViewport(e.visibleRange).filter(c=>!!c.options.lineNumberClassName);s.sort((c,d)=>L.compareRangesUsingEnds(c.range,d.range));let r=0;const a=this._context.viewModel.getLineCount(),l=[];for(let c=i;c<=n;c++){const d=c-i;let h=this._getLineRenderLineNumber(c),u="";for(;r<s.length&&s[r].range.endLineNumber<c;)r++;for(let g=r;g<s.length;g++){const{range:f,options:m}=s[g];f.startLineNumber<=c&&(u+=" "+m.lineNumberClassName)}if(!h&&!u){l[d]="";continue}c===a&&this._context.viewModel.getLineLength(c)===0&&(this._renderFinalNewline==="off"&&(h=""),this._renderFinalNewline==="dimmed"&&(u+=" dimmed-line-number")),c===this._activeLineNumber&&(u+=" active-line-number"),l[d]=`<div class="${Xk.CLASS_NAME}${t}${u}" style="left:${this._lineNumbersLeft}px;width:${this._lineNumbersWidth}px;">${h}</div>`}this._renderResult=l}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};Xk.CLASS_NAME="line-numbers";let qx=Xk;br((o,e)=>{const t=o.getColor(fce),i=o.getColor(Tce);i?e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${i}; }`):t&&e.addRule(`.monaco-editor .line-numbers.dimmed-line-number { color: ${t.transparent(.4)}; }`)});const Sm=class Sm extends go{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._domNode=bt(document.createElement("div")),this._domNode.setClassName(Sm.OUTER_CLASS_NAME),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._glyphMarginBackgroundDomNode=bt(document.createElement("div")),this._glyphMarginBackgroundDomNode.setClassName(Sm.CLASS_NAME),this._domNode.appendChild(this._glyphMarginBackgroundDomNode)}dispose(){super.dispose()}getDomNode(){return this._domNode}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._canUseLayerHinting=!t.get(32),this._contentLeft=i.contentLeft,this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollTopChanged}prepareRender(e){}render(e){this._domNode.setLayerHinting(this._canUseLayerHinting),this._domNode.setContain("strict");const t=e.scrollTop-e.bigNumbersDelta;this._domNode.setTop(-t);const i=Math.min(e.scrollHeight,1e6);this._domNode.setHeight(i),this._domNode.setWidth(this._contentLeft),this._glyphMarginBackgroundDomNode.setLeft(this._glyphMarginLeft),this._glyphMarginBackgroundDomNode.setWidth(this._glyphMarginWidth),this._glyphMarginBackgroundDomNode.setHeight(i)}};Sm.CLASS_NAME="glyph-margin",Sm.OUTER_CLASS_NAME="margin";let Zx=Sm;const jm="monaco-mouse-cursor-text";var kpe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},e9=function(o,e){return function(t,i){e(t,i,o)}};class Epe{constructor(e,t,i,n,s){this._context=e,this.modelLineNumber=t,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=n,this.distanceToModelLineEnd=s,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(e){const t=new A(this.modelLineNumber,this.distanceToModelLineStart+1),i=new A(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=e.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=e.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(e){return this._previousPresentation||(e?this._previousPresentation=e:this._previousPresentation={foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const JI=dr;let KM=class extends go{constructor(e,t,i,n,s){super(e),this._keybindingService=n,this._instantiationService=s,this._primaryCursorPosition=new A(1,1),this._primaryCursorVisibleRange=null,this._viewController=t,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;const r=this._context.configuration.options,a=r.get(146);this._setAccessibilityOptions(r),this._contentLeft=a.contentLeft,this._contentWidth=a.contentWidth,this._contentHeight=a.height,this._fontInfo=r.get(50),this._lineHeight=r.get(67),this._emptySelectionClipboard=r.get(37),this._copyWithSyntaxHighlighting=r.get(25),this._visibleTextArea=null,this._selections=[new pe(1,1,1,1)],this._modelSelections=[new pe(1,1,1,1)],this._lastRenderPosition=null,this.textArea=bt(document.createElement("textarea")),Aa.write(this.textArea,7),this.textArea.setClassName(`inputarea ${jm}`),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:l}=this._context.viewModel.model.getOptions();this.textArea.domNode.style.tabSize=`${l*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(r)),this.textArea.setAttribute("aria-required",r.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(r.get(125))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",p("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-autocomplete",r.get(92)?"none":"both"),this._ensureReadOnlyAttribute(),this.textAreaCover=bt(document.createElement("div")),this.textAreaCover.setPosition("absolute");const c={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:u=>this._context.viewModel.getLineMaxColumn(u),getValueInRange:(u,g)=>this._context.viewModel.getValueInRange(u,g),getValueLengthInRange:(u,g)=>this._context.viewModel.getValueLengthInRange(u,g),modifyPosition:(u,g)=>this._context.viewModel.modifyPosition(u,g)},d={getDataToCopy:()=>{const u=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,En),g=this._context.viewModel.model.getEOL(),f=this._emptySelectionClipboard&&this._modelSelections.length===1&&this._modelSelections[0].isEmpty(),m=Array.isArray(u)?u:null,_=Array.isArray(u)?u.join(g):u;let b,v=null;if(UM.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&_.length<65536){const y=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);y&&(b=y.html,v=y.mode)}return{isFromEmptySelection:f,multicursorText:m,text:_,html:b,mode:v}},getScreenReaderContent:()=>{if(this._accessibilitySupport===1){const u=this._selections[0];if(Qe&&u.isEmpty()){const f=u.getStartPosition();let m=this._getWordBeforePosition(f);if(m.length===0&&(m=this._getCharacterBeforePosition(f)),m.length>0)return new $n(m,m.length,m.length,L.fromPositions(f),0)}if(Qe&&!u.isEmpty()&&c.getValueLengthInRange(u,0)<500){const f=c.getValueInRange(u,0);return new $n(f,0,f.length,u,0)}if(Nh&&!u.isEmpty()){const f="vscode-placeholder";return new $n(f,0,f.length,null,void 0)}return $n.EMPTY}if(D3){const u=this._selections[0];if(u.isEmpty()){const g=u.getStartPosition(),[f,m]=this._getAndroidWordAtPosition(g);if(f.length>0)return new $n(f,m,m,L.fromPositions(g),0)}return $n.EMPTY}return tm.fromEditorSelection(c,this._selections[0],this._accessibilityPageSize,this._accessibilitySupport===0)},deduceModelPosition:(u,g,f)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(u,g,f)},h=this._register(new wpe(this.textArea.domNode));this._textAreaInput=this._register(this._instantiationService.createInstance(GM,d,h,Js,{isAndroid:D3,isChrome:xw,isFirefox:dr,isSafari:Nh})),this._register(this._textAreaInput.onKeyDown(u=>{this._viewController.emitKeyDown(u)})),this._register(this._textAreaInput.onKeyUp(u=>{this._viewController.emitKeyUp(u)})),this._register(this._textAreaInput.onPaste(u=>{let g=!1,f=null,m=null;u.metadata&&(g=this._emptySelectionClipboard&&!!u.metadata.isFromEmptySelection,f=typeof u.metadata.multicursorText<"u"?u.metadata.multicursorText:null,m=u.metadata.mode),this._viewController.paste(u.text,g,f,m)})),this._register(this._textAreaInput.onCut(()=>{this._viewController.cut()})),this._register(this._textAreaInput.onType(u=>{u.replacePrevCharCnt||u.replaceNextCharCnt||u.positionDelta?this._viewController.compositionType(u.text,u.replacePrevCharCnt,u.replaceNextCharCnt,u.positionDelta):this._viewController.type(u.text)})),this._register(this._textAreaInput.onSelectionChangeRequest(u=>{this._viewController.setSelection(u)})),this._register(this._textAreaInput.onCompositionStart(u=>{const g=this.textArea.domNode,f=this._modelSelections[0],{distanceToModelLineStart:m,widthOfHiddenTextBefore:_}=(()=>{const v=g.value.substring(0,Math.min(g.selectionStart,g.selectionEnd)),y=v.lastIndexOf(`
`),C=v.substring(y+1),w=C.lastIndexOf("	"),x=C.length-w-1,k=f.getStartPosition(),E=Math.min(k.column-1,x),N=k.column-1-E,z=C.substring(0,C.length-E),{tabSize:B}=this._context.viewModel.model.getOptions(),U=Tpe(this.textArea.domNode.ownerDocument,z,this._fontInfo,B);return{distanceToModelLineStart:N,widthOfHiddenTextBefore:U}})(),{distanceToModelLineEnd:b}=(()=>{const v=g.value.substring(Math.max(g.selectionStart,g.selectionEnd)),y=v.indexOf(`
`),C=y===-1?v:v.substring(0,y),w=C.indexOf("	"),x=w===-1?C.length:C.length-w-1,k=f.getEndPosition(),E=Math.min(this._context.viewModel.model.getLineMaxColumn(k.lineNumber)-k.column,x);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(k.lineNumber)-k.column-E}})();this._context.viewModel.revealRange("keyboard",!0,L.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new Epe(this._context,f.startLineNumber,m,_,b),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${jm} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()})),this._register(this._textAreaInput.onCompositionUpdate(u=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())})),this._register(this._textAreaInput.onCompositionEnd(()=>{this._visibleTextArea=null,this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off"),this._render(),this.textArea.setClassName(`inputarea ${jm}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()})),this._register(this._textAreaInput.onFocus(()=>{this._context.viewModel.setHasFocus(!0)})),this._register(this._textAreaInput.onBlur(()=>{this._context.viewModel.setHasFocus(!1)})),this._register(Wv.onDidChange(()=>{this._ensureReadOnlyAttribute()}))}writeScreenReaderContent(e){this._textAreaInput.writeNativeTextAreaContent(e)}dispose(){super.dispose()}_getAndroidWordAtPosition(e){const t='`~!@#$%^&*()-=+[{]}\\|;:",.<>/?',i=this._context.viewModel.getLineContent(e.lineNumber),n=gr(t,[]);let s=!0,r=e.column,a=!0,l=e.column,c=0;for(;c<50&&(s||a);){if(s&&r<=1&&(s=!1),s){const d=i.charCodeAt(r-2);n.get(d)!==0?s=!1:r--}if(a&&l>i.length&&(a=!1),a){const d=i.charCodeAt(l-1);n.get(d)!==0?a=!1:l++}c++}return[i.substring(r-1,l-1),e.column-r]}_getWordBeforePosition(e){const t=this._context.viewModel.getLineContent(e.lineNumber),i=gr(this._context.configuration.options.get(132),[]);let n=e.column,s=0;for(;n>1;){const r=t.charCodeAt(n-2);if(i.get(r)!==0||s>50)return t.substring(n-1,e.column-1);s++,n--}return t.substring(0,e.column-1)}_getCharacterBeforePosition(e){if(e.column>1){const i=this._context.viewModel.getLineContent(e.lineNumber).charAt(e.column-2);if(!$i(i.charCodeAt(0)))return i}return""}_getAriaLabel(e){if(e.get(2)===1){const i=this._keybindingService.lookupKeybinding("editor.action.toggleScreenReaderAccessibilityMode")?.getAriaLabel(),n=this._keybindingService.lookupKeybinding("workbench.action.showCommands")?.getAriaLabel(),s=this._keybindingService.lookupKeybinding("workbench.action.openGlobalKeybindings")?.getAriaLabel(),r=p("accessibilityModeOff","The editor is not accessible at this time.");return i?p("accessibilityOffAriaLabel","{0} To enable screen reader optimized mode, use {1}",r,i):n?p("accessibilityOffAriaLabelNoKb","{0} To enable screen reader optimized mode, open the quick pick with {1} and run the command Toggle Screen Reader Accessibility Mode, which is currently not triggerable via keyboard.",r,n):s?p("accessibilityOffAriaLabelNoKbs","{0} Please assign a keybinding for the command Toggle Screen Reader Accessibility Mode by accessing the keybindings editor with {1} and run it.",r,s):r}return e.get(4)}_setAccessibilityOptions(e){this._accessibilitySupport=e.get(2);const t=e.get(3);this._accessibilitySupport===2&&t===Oa.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=t;const n=e.get(146).wrappingColumn;if(n!==-1&&this._accessibilitySupport!==1){const s=e.get(50);this._textAreaWrapping=!0,this._textAreaWidth=Math.round(n*s.typicalHalfwidthCharacterWidth)}else this._textAreaWrapping=!1,this._textAreaWidth=JI?0:1}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);this._setAccessibilityOptions(t),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=t.get(50),this._lineHeight=t.get(67),this._emptySelectionClipboard=t.get(37),this._copyWithSyntaxHighlighting=t.get(25),this.textArea.setAttribute("wrap",this._textAreaWrapping&&!this._visibleTextArea?"on":"off");const{tabSize:n}=this._context.viewModel.model.getOptions();return this.textArea.domNode.style.tabSize=`${n*this._fontInfo.spaceWidth}px`,this.textArea.setAttribute("aria-label",this._getAriaLabel(t)),this.textArea.setAttribute("aria-required",t.get(5)?"true":"false"),this.textArea.setAttribute("tabindex",String(t.get(125))),(e.hasChanged(34)||e.hasChanged(92))&&this._ensureReadOnlyAttribute(),e.hasChanged(2)&&this._textAreaInput.writeNativeTextAreaContent("strategy changed"),!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),this._modelSelections=e.modelSelections.slice(0),this._textAreaInput.writeNativeTextAreaContent("selection changed"),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return this._scrollLeft=e.scrollLeft,this._scrollTop=e.scrollTop,!0}onZonesChanged(e){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(e){e.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",e.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),e.role&&this.textArea.setAttribute("role",e.role)}_ensureReadOnlyAttribute(){const e=this._context.configuration.options;!Wv.enabled||e.get(34)&&e.get(92)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")}prepareRender(e){this._primaryCursorPosition=new A(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=e.visibleRangeForPosition(this._primaryCursorPosition),this._visibleTextArea?.prepareRender(e)}render(e){this._textAreaInput.writeNativeTextAreaContent("render"),this._render()}_render(){if(this._visibleTextArea){const i=this._visibleTextArea.visibleTextareaStart,n=this._visibleTextArea.visibleTextareaEnd,s=this._visibleTextArea.startPosition,r=this._visibleTextArea.endPosition;if(s&&r&&i&&n&&n.left>=this._scrollLeft&&i.left<=this._scrollLeft+this._contentWidth){const a=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,l=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let c=this._visibleTextArea.widthOfHiddenLineTextBefore,d=this._contentLeft+i.left-this._scrollLeft,h=n.left-i.left+1;if(d<this._contentLeft){const b=this._contentLeft-d;d+=b,c+=b,h-=b}h>this._contentWidth&&(h=this._contentWidth);const u=this._context.viewModel.getViewLineData(s.lineNumber),g=u.tokens.findTokenIndexAtOffset(s.column-1),f=u.tokens.findTokenIndexAtOffset(r.column-1),m=g===f,_=this._visibleTextArea.definePresentation(m?u.tokens.getPresentation(g):null);this.textArea.domNode.scrollTop=l*this._lineHeight,this.textArea.domNode.scrollLeft=c,this._doRender({lastRenderPosition:null,top:a,left:d,width:h,height:this._lineHeight,useCover:!1,color:(gi.getColorMap()||[])[_.foreground],italic:_.italic,bold:_.bold,underline:_.underline,strikethrough:_.strikethrough})}return}if(!this._primaryCursorVisibleRange){this._renderAtTopLeft();return}const e=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(e<this._contentLeft||e>this._contentLeft+this._contentWidth){this._renderAtTopLeft();return}const t=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(t<0||t>this._contentHeight){this._renderAtTopLeft();return}if(Qe||this._accessibilitySupport===2){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const i=this._textAreaInput.textAreaState.newlineCountBeforeSelection??this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight;return}this._doRender({lastRenderPosition:this._primaryCursorPosition,top:t,left:this._textAreaWrapping?this._contentLeft:e,width:this._textAreaWidth,height:JI?0:1,useCover:!1})}_newlinecount(e){let t=0,i=-1;do{if(i=e.indexOf(`
`,i+1),i===-1)break;t++}while(!0);return t}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:this._textAreaWidth,height:JI?0:1,useCover:!0})}_doRender(e){this._lastRenderPosition=e.lastRenderPosition;const t=this.textArea,i=this.textAreaCover;mn(t,this._fontInfo),t.setTop(e.top),t.setLeft(e.left),t.setWidth(e.width),t.setHeight(e.height),t.setColor(e.color?j.Format.CSS.formatHex(e.color):""),t.setFontStyle(e.italic?"italic":""),e.bold&&t.setFontWeight("bold"),t.setTextDecoration(`${e.underline?" underline":""}${e.strikethrough?" line-through":""}`),i.setTop(e.useCover?e.top:0),i.setLeft(e.useCover?e.left:0),i.setWidth(e.useCover?e.width:0),i.setHeight(e.useCover?e.height:0);const n=this._context.configuration.options;n.get(57)?i.setClassName("monaco-editor-background textAreaCover "+Zx.OUTER_CLASS_NAME):n.get(68).renderType!==0?i.setClassName("monaco-editor-background textAreaCover "+qx.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}};KM=kpe([e9(3,vt),e9(4,Ce)],KM);function Tpe(o,e,t,i){if(e.length===0)return 0;const n=o.createElement("div");n.style.position="absolute",n.style.top="-50000px",n.style.width="50000px";const s=o.createElement("span");mn(s,t),s.style.whiteSpace="pre",s.style.tabSize=`${i*t.spaceWidth}px`,s.append(e),n.appendChild(s),o.body.appendChild(n);const r=s.offsetWidth;return n.remove(),r}const Dpe=()=>!0,Ipe=()=>!1,Npe=o=>o===" "||o==="	";class yp{static shouldRecreate(e){return e.hasChanged(146)||e.hasChanged(132)||e.hasChanged(37)||e.hasChanged(77)||e.hasChanged(79)||e.hasChanged(80)||e.hasChanged(6)||e.hasChanged(7)||e.hasChanged(11)||e.hasChanged(9)||e.hasChanged(10)||e.hasChanged(14)||e.hasChanged(129)||e.hasChanged(50)||e.hasChanged(92)||e.hasChanged(131)}constructor(e,t,i,n){this.languageConfigurationService=n,this._cursorMoveConfigurationBrand=void 0,this._languageId=e;const s=i.options,r=s.get(146),a=s.get(50);this.readOnly=s.get(92),this.tabSize=t.tabSize,this.indentSize=t.indentSize,this.insertSpaces=t.insertSpaces,this.stickyTabStops=s.get(117),this.lineHeight=a.lineHeight,this.typicalHalfwidthCharacterWidth=a.typicalHalfwidthCharacterWidth,this.pageSize=Math.max(1,Math.floor(r.height/this.lineHeight)-2),this.useTabStops=s.get(129),this.wordSeparators=s.get(132),this.emptySelectionClipboard=s.get(37),this.copyWithSyntaxHighlighting=s.get(25),this.multiCursorMergeOverlapping=s.get(77),this.multiCursorPaste=s.get(79),this.multiCursorLimit=s.get(80),this.autoClosingBrackets=s.get(6),this.autoClosingComments=s.get(7),this.autoClosingQuotes=s.get(11),this.autoClosingDelete=s.get(9),this.autoClosingOvertype=s.get(10),this.autoSurround=s.get(14),this.autoIndent=s.get(12),this.wordSegmenterLocales=s.get(131),this.surroundingPairs={},this._electricChars=null,this.shouldAutoCloseBefore={quote:this._getShouldAutoClose(e,this.autoClosingQuotes,!0),comment:this._getShouldAutoClose(e,this.autoClosingComments,!1),bracket:this._getShouldAutoClose(e,this.autoClosingBrackets,!1)},this.autoClosingPairs=this.languageConfigurationService.getLanguageConfiguration(e).getAutoClosingPairs();const l=this.languageConfigurationService.getLanguageConfiguration(e).getSurroundingPairs();if(l)for(const d of l)this.surroundingPairs[d.open]=d.close;const c=this.languageConfigurationService.getLanguageConfiguration(e).comments;this.blockCommentStartToken=c?.blockCommentStartToken??null}get electricChars(){if(!this._electricChars){this._electricChars={};const e=this.languageConfigurationService.getLanguageConfiguration(this._languageId).electricCharacter?.getElectricCharacters();if(e)for(const t of e)this._electricChars[t]=!0}return this._electricChars}onElectricCharacter(e,t,i){const n=Qu(t,i-1),s=this.languageConfigurationService.getLanguageConfiguration(n.languageId).electricCharacter;return s?s.onElectricCharacter(e,n,i-n.firstCharOffset):null}normalizeIndentation(e){return z5(e,this.indentSize,this.insertSpaces)}_getShouldAutoClose(e,t,i){switch(t){case"beforeWhitespace":return Npe;case"languageDefined":return this._getLanguageDefinedShouldAutoClose(e,i);case"always":return Dpe;case"never":return Ipe}}_getLanguageDefinedShouldAutoClose(e,t){const i=this.languageConfigurationService.getLanguageConfiguration(e).getAutoCloseBeforeSet(t);return n=>i.indexOf(n)!==-1}visibleColumnFromColumn(e,t){return Vi.visibleColumnFromColumn(e.getLineContent(t.lineNumber),t.column,this.tabSize)}columnFromVisibleColumn(e,t,i){const n=Vi.columnFromVisibleColumn(e.getLineContent(t),i,this.tabSize),s=e.getLineMinColumn(t);if(n<s)return s;const r=e.getLineMaxColumn(t);return n>r?r:n}}let ht=class UK{static fromModelState(e){return new Rpe(e)}static fromViewState(e){return new Ppe(e)}static fromModelSelection(e){const t=pe.liftSelection(e),i=new hn(L.fromPositions(t.getSelectionStart()),0,0,t.getPosition(),0);return UK.fromModelState(i)}static fromModelSelections(e){const t=[];for(let i=0,n=e.length;i<n;i++)t[i]=this.fromModelSelection(e[i]);return t}constructor(e,t){this._cursorStateBrand=void 0,this.modelState=e,this.viewState=t}equals(e){return this.viewState.equals(e.viewState)&&this.modelState.equals(e.modelState)}};class Rpe{constructor(e){this.modelState=e,this.viewState=null}}class Ppe{constructor(e){this.modelState=null,this.viewState=e}}class hn{constructor(e,t,i,n,s){this.selectionStart=e,this.selectionStartKind=t,this.selectionStartLeftoverVisibleColumns=i,this.position=n,this.leftoverVisibleColumns=s,this._singleCursorStateBrand=void 0,this.selection=hn._computeSelection(this.selectionStart,this.position)}equals(e){return this.selectionStartLeftoverVisibleColumns===e.selectionStartLeftoverVisibleColumns&&this.leftoverVisibleColumns===e.leftoverVisibleColumns&&this.selectionStartKind===e.selectionStartKind&&this.position.equals(e.position)&&this.selectionStart.equalsRange(e.selectionStart)}hasSelection(){return!this.selection.isEmpty()||!this.selectionStart.isEmpty()}move(e,t,i,n){return e?new hn(this.selectionStart,this.selectionStartKind,this.selectionStartLeftoverVisibleColumns,new A(t,i),n):new hn(new L(t,i,t,i),0,n,new A(t,i),n)}static _computeSelection(e,t){return e.isEmpty()||!t.isBeforeOrEqual(e.getStartPosition())?pe.fromPositions(e.getStartPosition(),t):pe.fromPositions(e.getEndPosition(),t)}}class Rs{constructor(e,t,i){this._editOperationResultBrand=void 0,this.type=e,this.commands=t,this.shouldPushStackElementBefore=i.shouldPushStackElementBefore,this.shouldPushStackElementAfter=i.shouldPushStackElementAfter}}function Hh(o){return o==="'"||o==='"'||o==="`"}class zu{static columnSelect(e,t,i,n,s,r){const a=Math.abs(s-i)+1,l=i>s,c=n>r,d=n<r,h=[];for(let u=0;u<a;u++){const g=i+(l?-u:u),f=e.columnFromVisibleColumn(t,g,n),m=e.columnFromVisibleColumn(t,g,r),_=e.visibleColumnFromColumn(t,new A(g,f)),b=e.visibleColumnFromColumn(t,new A(g,m));d&&(_>r||b<n)||c&&(b>n||_<r)||h.push(new hn(new L(g,f,g,f),0,0,new A(g,m),0))}if(h.length===0)for(let u=0;u<a;u++){const g=i+(l?-u:u),f=t.getLineMaxColumn(g);h.push(new hn(new L(g,f,g,f),0,0,new A(g,f),0))}return{viewStates:h,reversed:l,fromLineNumber:i,fromVisualColumn:n,toLineNumber:s,toVisualColumn:r}}static columnSelectLeft(e,t,i){let n=i.toViewVisualColumn;return n>0&&n--,zu.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,n)}static columnSelectRight(e,t,i){let n=0;const s=Math.min(i.fromViewLineNumber,i.toViewLineNumber),r=Math.max(i.fromViewLineNumber,i.toViewLineNumber);for(let l=s;l<=r;l++){const c=t.getLineMaxColumn(l),d=e.visibleColumnFromColumn(t,new A(l,c));n=Math.max(n,d)}let a=i.toViewVisualColumn;return a<n&&a++,this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,i.toViewLineNumber,a)}static columnSelectUp(e,t,i,n){const s=n?e.pageSize:1,r=Math.max(1,i.toViewLineNumber-s);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}static columnSelectDown(e,t,i,n){const s=n?e.pageSize:1,r=Math.min(t.getLineCount(),i.toViewLineNumber+s);return this.columnSelect(e,t,i.fromViewLineNumber,i.fromViewVisualColumn,r,i.toViewVisualColumn)}}class xn{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return pe.fromPositions(n.getEndPosition())}}class Ape{constructor(e,t){this._range=e,this._text=t}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return pe.fromRange(n,0)}}class X1{constructor(e,t,i=!1){this._range=e,this._text=t,this.insertsAutoWhitespace=i}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return pe.fromPositions(n.getStartPosition())}}class Yx{constructor(e,t,i,n,s=!1){this._range=e,this._text=t,this._columnDeltaOffset=n,this._lineNumberDeltaOffset=i,this.insertsAutoWhitespace=s}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return pe.fromPositions(n.getEndPosition().delta(this._lineNumberDeltaOffset,this._columnDeltaOffset))}}class kB{constructor(e,t,i,n=!1){this._range=e,this._text=t,this._initialSelection=i,this._forceMoveMarkers=n,this._selectionId=null}getEditOperations(e,t){t.addTrackedEditOperation(this._range,this._text,this._forceMoveMarkers),this._selectionId=t.trackSelection(this._initialSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}class eN{constructor(e,t,i){this._cursorPositionBrand=void 0,this.lineNumber=e,this.column=t,this.leftoverVisibleColumns=i}}class Ct{static leftPosition(e,t){if(t.column>e.getLineMinColumn(t.lineNumber))return t.delta(void 0,-kz(e.getLineContent(t.lineNumber),t.column-1));if(t.lineNumber>1){const i=t.lineNumber-1;return new A(i,e.getLineMaxColumn(i))}else return t}static leftPositionAtomicSoftTabs(e,t,i){if(t.column<=e.getLineIndentColumn(t.lineNumber)){const n=e.getLineMinColumn(t.lineNumber),s=e.getLineContent(t.lineNumber),r=Py.atomicPosition(s,t.column-1,i,0);if(r!==-1&&r+1>=n)return new A(t.lineNumber,r+1)}return this.leftPosition(e,t)}static left(e,t,i){const n=e.stickyTabStops?Ct.leftPositionAtomicSoftTabs(t,i,e.tabSize):Ct.leftPosition(t,i);return new eN(n.lineNumber,n.column,0)}static moveLeft(e,t,i,n,s){let r,a;if(i.hasSelection()&&!n)r=i.selection.startLineNumber,a=i.selection.startColumn;else{const l=i.position.delta(void 0,-(s-1)),c=t.normalizePosition(Ct.clipPositionColumn(l,t),0),d=Ct.left(e,t,c);r=d.lineNumber,a=d.column}return i.move(n,r,a,0)}static clipPositionColumn(e,t){return new A(e.lineNumber,Ct.clipRange(e.column,t.getLineMinColumn(e.lineNumber),t.getLineMaxColumn(e.lineNumber)))}static clipRange(e,t,i){return e<t?t:e>i?i:e}static rightPosition(e,t,i){return i<e.getLineMaxColumn(t)?i=i+A4(e.getLineContent(t),i-1):t<e.getLineCount()&&(t=t+1,i=e.getLineMinColumn(t)),new A(t,i)}static rightPositionAtomicSoftTabs(e,t,i,n,s){if(i<e.getLineIndentColumn(t)){const r=e.getLineContent(t),a=Py.atomicPosition(r,i-1,n,1);if(a!==-1)return new A(t,a+1)}return this.rightPosition(e,t,i)}static right(e,t,i){const n=e.stickyTabStops?Ct.rightPositionAtomicSoftTabs(t,i.lineNumber,i.column,e.tabSize,e.indentSize):Ct.rightPosition(t,i.lineNumber,i.column);return new eN(n.lineNumber,n.column,0)}static moveRight(e,t,i,n,s){let r,a;if(i.hasSelection()&&!n)r=i.selection.endLineNumber,a=i.selection.endColumn;else{const l=i.position.delta(void 0,s-1),c=t.normalizePosition(Ct.clipPositionColumn(l,t),1),d=Ct.right(e,t,c);r=d.lineNumber,a=d.column}return i.move(n,r,a,0)}static vertical(e,t,i,n,s,r,a,l){const c=Vi.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize)+s,d=t.getLineCount(),h=i===1&&n===1,u=i===d&&n===t.getLineMaxColumn(i),g=r<i?h:u;if(i=r,i<1?(i=1,a?n=t.getLineMinColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):i>d?(i=d,a?n=t.getLineMaxColumn(i):n=Math.min(t.getLineMaxColumn(i),n)):n=e.columnFromVisibleColumn(t,i,c),g?s=0:s=c-Vi.visibleColumnFromColumn(t.getLineContent(i),n,e.tabSize),l!==void 0){const f=new A(i,n),m=t.normalizePosition(f,l);s=s+(n-m.column),i=m.lineNumber,n=m.column}return new eN(i,n,s)}static down(e,t,i,n,s,r,a){return this.vertical(e,t,i,n,s,i+r,a,4)}static moveDown(e,t,i,n,s){let r,a;i.hasSelection()&&!n?(r=i.selection.endLineNumber,a=i.selection.endColumn):(r=i.position.lineNumber,a=i.position.column);let l=0,c;do if(c=Ct.down(e,t,r+l,a,i.leftoverVisibleColumns,s,!0),t.normalizePosition(new A(c.lineNumber,c.column),2).lineNumber>r)break;while(l++<10&&r+l<t.getLineCount());return i.move(n,c.lineNumber,c.column,c.leftoverVisibleColumns)}static translateDown(e,t,i){const n=i.selection,s=Ct.down(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=Ct.down(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new hn(new L(s.lineNumber,s.column,s.lineNumber,s.column),0,s.leftoverVisibleColumns,new A(r.lineNumber,r.column),r.leftoverVisibleColumns)}static up(e,t,i,n,s,r,a){return this.vertical(e,t,i,n,s,i-r,a,3)}static moveUp(e,t,i,n,s){let r,a;i.hasSelection()&&!n?(r=i.selection.startLineNumber,a=i.selection.startColumn):(r=i.position.lineNumber,a=i.position.column);const l=Ct.up(e,t,r,a,i.leftoverVisibleColumns,s,!0);return i.move(n,l.lineNumber,l.column,l.leftoverVisibleColumns)}static translateUp(e,t,i){const n=i.selection,s=Ct.up(e,t,n.selectionStartLineNumber,n.selectionStartColumn,i.selectionStartLeftoverVisibleColumns,1,!1),r=Ct.up(e,t,n.positionLineNumber,n.positionColumn,i.leftoverVisibleColumns,1,!1);return new hn(new L(s.lineNumber,s.column,s.lineNumber,s.column),0,s.leftoverVisibleColumns,new A(r.lineNumber,r.column),r.leftoverVisibleColumns)}static _isBlankLine(e,t){return e.getLineFirstNonWhitespaceColumn(t)===0}static moveToPrevBlankLine(e,t,i,n){let s=i.position.lineNumber;for(;s>1&&this._isBlankLine(t,s);)s--;for(;s>1&&!this._isBlankLine(t,s);)s--;return i.move(n,s,t.getLineMinColumn(s),0)}static moveToNextBlankLine(e,t,i,n){const s=t.getLineCount();let r=i.position.lineNumber;for(;r<s&&this._isBlankLine(t,r);)r++;for(;r<s&&!this._isBlankLine(t,r);)r++;return i.move(n,r,t.getLineMinColumn(r),0)}static moveToBeginningOfLine(e,t,i,n){const s=i.position.lineNumber,r=t.getLineMinColumn(s),a=t.getLineFirstNonWhitespaceColumn(s)||r;let l;return i.position.column===a?l=r:l=a,i.move(n,s,l,0)}static moveToEndOfLine(e,t,i,n,s){const r=i.position.lineNumber,a=t.getLineMaxColumn(r);return i.move(n,r,a,s?1073741824-a:0)}static moveToBeginningOfBuffer(e,t,i,n){return i.move(n,1,1,0)}static moveToEndOfBuffer(e,t,i,n){const s=t.getLineCount(),r=t.getLineMaxColumn(s);return i.move(n,s,r,0)}}class If{static deleteRight(e,t,i,n){const s=[];let r=e!==3;for(let a=0,l=n.length;a<l;a++){const c=n[a];let d=c;if(d.isEmpty()){const h=c.getPosition(),u=Ct.right(t,i,h);d=new L(u.lineNumber,u.column,h.lineNumber,h.column)}if(d.isEmpty()){s[a]=null;continue}d.startLineNumber!==d.endLineNumber&&(r=!0),s[a]=new xn(d,"")}return[r,s]}static isAutoClosingPairDelete(e,t,i,n,s,r,a){if(t==="never"&&i==="never"||e==="never")return!1;for(let l=0,c=r.length;l<c;l++){const d=r[l],h=d.getPosition();if(!d.isEmpty())return!1;const u=s.getLineContent(h.lineNumber);if(h.column<2||h.column>=u.length+1)return!1;const g=u.charAt(h.column-2),f=n.get(g);if(!f)return!1;if(Hh(g)){if(i==="never")return!1}else if(t==="never")return!1;const m=u.charAt(h.column-1);let _=!1;for(const b of f)b.open===g&&b.close===m&&(_=!0);if(!_)return!1;if(e==="auto"){let b=!1;for(let v=0,y=a.length;v<y;v++){const C=a[v];if(h.lineNumber===C.startLineNumber&&h.column===C.startColumn){b=!0;break}}if(!b)return!1}}return!0}static _runAutoClosingPairDelete(e,t,i){const n=[];for(let s=0,r=i.length;s<r;s++){const a=i[s].getPosition(),l=new L(a.lineNumber,a.column-1,a.lineNumber,a.column+1);n[s]=new xn(l,"")}return[!0,n]}static deleteLeft(e,t,i,n,s){if(this.isAutoClosingPairDelete(t.autoClosingDelete,t.autoClosingBrackets,t.autoClosingQuotes,t.autoClosingPairs.autoClosingPairsOpenByEnd,i,n,s))return this._runAutoClosingPairDelete(t,i,n);const r=[];let a=e!==2;for(let l=0,c=n.length;l<c;l++){const d=If.getDeleteRange(n[l],i,t);if(d.isEmpty()){r[l]=null;continue}d.startLineNumber!==d.endLineNumber&&(a=!0),r[l]=new xn(d,"")}return[a,r]}static getDeleteRange(e,t,i){if(!e.isEmpty())return e;const n=e.getPosition();if(i.useTabStops&&n.column>1){const s=t.getLineContent(n.lineNumber),r=Xn(s),a=r===-1?s.length+1:r+1;if(n.column<=a){const l=i.visibleColumnFromColumn(t,n),c=Vi.prevIndentTabStop(l,i.indentSize),d=i.columnFromVisibleColumn(t,n.lineNumber,c);return new L(n.lineNumber,d,n.lineNumber,n.column)}}return L.fromPositions(If.getPositionAfterDeleteLeft(n,t),n)}static getPositionAfterDeleteLeft(e,t){if(e.column>1){const i=YQ(e.column-1,t.getLineContent(e.lineNumber));return e.with(void 0,i+1)}else if(e.lineNumber>1){const i=e.lineNumber-1;return new A(i,t.getLineMaxColumn(i))}else return e}static cut(e,t,i){const n=[];let s=null;i.sort((r,a)=>A.compare(r.getStartPosition(),a.getEndPosition()));for(let r=0,a=i.length;r<a;r++){const l=i[r];if(l.isEmpty())if(e.emptySelectionClipboard){const c=l.getPosition();let d,h,u,g;c.lineNumber<t.getLineCount()?(d=c.lineNumber,h=1,u=c.lineNumber+1,g=1):c.lineNumber>1&&s?.endLineNumber!==c.lineNumber?(d=c.lineNumber-1,h=t.getLineMaxColumn(c.lineNumber-1),u=c.lineNumber,g=t.getLineMaxColumn(c.lineNumber)):(d=c.lineNumber,h=1,u=c.lineNumber,g=t.getLineMaxColumn(c.lineNumber));const f=new L(d,h,u,g);s=f,f.isEmpty()?n[r]=null:n[r]=new xn(f,"")}else n[r]=null;else n[r]=new xn(l,"")}return new Rs(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class _t{static _createWord(e,t,i,n,s){return{start:n,end:s,wordType:t,nextCharClass:i}}static _createIntlWord(e,t){return{start:e.index,end:e.index+e.segment.length,wordType:1,nextCharClass:t}}static _findPreviousWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindPreviousWordOnLine(n,e,i)}static _doFindPreviousWordOnLine(e,t,i){let n=0;const s=t.findPrevIntlWordBeforeOrAtOffset(e,i.column-2);for(let r=i.column-2;r>=0;r--){const a=e.charCodeAt(r),l=t.get(a);if(s&&r===s.index)return this._createIntlWord(s,l);if(l===0){if(n===2)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1));n=1}else if(l===2){if(n===1)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1));n=2}else if(l===1&&n!==0)return this._createWord(e,n,l,r+1,this._findEndOfWord(e,t,n,r+1))}return n!==0?this._createWord(e,n,1,0,this._findEndOfWord(e,t,n,0)):null}static _findEndOfWord(e,t,i,n){const s=t.findNextIntlWordAtOrAfterOffset(e,n),r=e.length;for(let a=n;a<r;a++){const l=e.charCodeAt(a),c=t.get(l);if(s&&a===s.index+s.segment.length||c===1||i===1&&c===2||i===2&&c===0)return a}return r}static _findNextWordOnLine(e,t,i){const n=t.getLineContent(i.lineNumber);return this._doFindNextWordOnLine(n,e,i)}static _doFindNextWordOnLine(e,t,i){let n=0;const s=e.length,r=t.findNextIntlWordAtOrAfterOffset(e,i.column-1);for(let a=i.column-1;a<s;a++){const l=e.charCodeAt(a),c=t.get(l);if(r&&a===r.index)return this._createIntlWord(r,c);if(c===0){if(n===2)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=1}else if(c===2){if(n===1)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a);n=2}else if(c===1&&n!==0)return this._createWord(e,n,c,this._findStartOfWord(e,t,n,a-1),a)}return n!==0?this._createWord(e,n,1,this._findStartOfWord(e,t,n,s-1),s):null}static _findStartOfWord(e,t,i,n){const s=t.findPrevIntlWordBeforeOrAtOffset(e,n);for(let r=n;r>=0;r--){const a=e.charCodeAt(r),l=t.get(a);if(s&&r===s.index)return r;if(l===1||i===1&&l===2||i===2&&l===0)return r+1}return 0}static moveWordLeft(e,t,i,n,s){let r=i.lineNumber,a=i.column;a===1&&r>1&&(r=r-1,a=t.getLineMaxColumn(r));let l=_t._findPreviousWordOnLine(e,t,new A(r,a));if(n===0)return new A(r,l?l.start+1:1);if(n===1)return!s&&l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=_t._findPreviousWordOnLine(e,t,new A(r,l.start+1))),new A(r,l?l.start+1:1);if(n===3){for(;l&&l.wordType===2;)l=_t._findPreviousWordOnLine(e,t,new A(r,l.start+1));return new A(r,l?l.start+1:1)}return l&&a<=l.end+1&&(l=_t._findPreviousWordOnLine(e,t,new A(r,l.start+1))),new A(r,l?l.end+1:1)}static _moveWordPartLeft(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===1)return i>1?new A(i-1,e.getLineMaxColumn(i-1)):t;const s=e.getLineContent(i);for(let r=t.column-1;r>1;r--){const a=s.charCodeAt(r-2),l=s.charCodeAt(r-1);if(a===95&&l!==95)return new A(i,r);if(a===45&&l!==45)return new A(i,r);if((Hd(a)||mS(a))&&dl(l))return new A(i,r);if(dl(a)&&dl(l)&&r+1<n){const c=s.charCodeAt(r);if(Hd(c)||mS(c))return new A(i,r)}}return new A(i,1)}static moveWordRight(e,t,i,n){let s=i.lineNumber,r=i.column,a=!1;r===t.getLineMaxColumn(s)&&s<t.getLineCount()&&(a=!0,s=s+1,r=1);let l=_t._findNextWordOnLine(e,t,new A(s,r));if(n===2)l&&l.wordType===2&&l.end-l.start===1&&l.nextCharClass===0&&(l=_t._findNextWordOnLine(e,t,new A(s,l.end+1))),l?r=l.end+1:r=t.getLineMaxColumn(s);else if(n===3){for(a&&(r=0);l&&(l.wordType===2||l.start+1<=r);)l=_t._findNextWordOnLine(e,t,new A(s,l.end+1));l?r=l.start+1:r=t.getLineMaxColumn(s)}else l&&!a&&r>=l.start+1&&(l=_t._findNextWordOnLine(e,t,new A(s,l.end+1))),l?r=l.start+1:r=t.getLineMaxColumn(s);return new A(s,r)}static _moveWordPartRight(e,t){const i=t.lineNumber,n=e.getLineMaxColumn(i);if(t.column===n)return i<e.getLineCount()?new A(i+1,1):t;const s=e.getLineContent(i);for(let r=t.column+1;r<n;r++){const a=s.charCodeAt(r-2),l=s.charCodeAt(r-1);if(a!==95&&l===95)return new A(i,r);if(a!==45&&l===45)return new A(i,r);if((Hd(a)||mS(a))&&dl(l))return new A(i,r);if(dl(a)&&dl(l)&&r+1<n){const c=s.charCodeAt(r);if(Hd(c)||mS(c))return new A(i,r)}}return new A(i,n)}static _deleteWordLeftWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-2,s=Sa(i,n);return s+1<n?new L(t.lineNumber,s+2,t.lineNumber,t.column):null}static deleteWordLeft(e,t){const i=e.wordSeparators,n=e.model,s=e.selection,r=e.whitespaceHeuristics;if(!s.isEmpty())return s;if(If.isAutoClosingPairDelete(e.autoClosingDelete,e.autoClosingBrackets,e.autoClosingQuotes,e.autoClosingPairs.autoClosingPairsOpenByEnd,e.model,[e.selection],e.autoClosedCharacters)){const h=e.selection.getPosition();return new L(h.lineNumber,h.column-1,h.lineNumber,h.column+1)}const a=new A(s.positionLineNumber,s.positionColumn);let l=a.lineNumber,c=a.column;if(l===1&&c===1)return null;if(r){const h=this._deleteWordLeftWhitespace(n,a);if(h)return h}let d=_t._findPreviousWordOnLine(i,n,a);return t===0?d?c=d.start+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l)):(d&&c<=d.end+1&&(d=_t._findPreviousWordOnLine(i,n,new A(l,d.start+1))),d?c=d.end+1:c>1?c=1:(l--,c=n.getLineMaxColumn(l))),new L(l,c,a.lineNumber,a.column)}static deleteInsideWord(e,t,i){if(!i.isEmpty())return i;const n=new A(i.positionLineNumber,i.positionColumn),s=this._deleteInsideWordWhitespace(t,n);return s||this._deleteInsideWordDetermineDeleteRange(e,t,n)}static _charAtIsWhitespace(e,t){const i=e.charCodeAt(t);return i===32||i===9}static _deleteInsideWordWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=i.length;if(n===0)return null;let s=Math.max(t.column-2,0);if(!this._charAtIsWhitespace(i,s))return null;let r=Math.min(t.column-1,n-1);if(!this._charAtIsWhitespace(i,r))return null;for(;s>0&&this._charAtIsWhitespace(i,s-1);)s--;for(;r+1<n&&this._charAtIsWhitespace(i,r+1);)r++;return new L(t.lineNumber,s+1,t.lineNumber,r+2)}static _deleteInsideWordDetermineDeleteRange(e,t,i){const n=t.getLineContent(i.lineNumber),s=n.length;if(s===0)return i.lineNumber>1?new L(i.lineNumber-1,t.getLineMaxColumn(i.lineNumber-1),i.lineNumber,1):i.lineNumber<t.getLineCount()?new L(i.lineNumber,1,i.lineNumber+1,1):new L(i.lineNumber,1,i.lineNumber,1);const r=h=>h.start+1<=i.column&&i.column<=h.end+1,a=(h,u)=>(h=Math.min(h,i.column),u=Math.max(u,i.column),new L(i.lineNumber,h,i.lineNumber,u)),l=h=>{let u=h.start+1,g=h.end+1,f=!1;for(;g-1<s&&this._charAtIsWhitespace(n,g-1);)f=!0,g++;if(!f)for(;u>1&&this._charAtIsWhitespace(n,u-2);)u--;return a(u,g)},c=_t._findPreviousWordOnLine(e,t,i);if(c&&r(c))return l(c);const d=_t._findNextWordOnLine(e,t,i);return d&&r(d)?l(d):c&&d?a(c.end+1,d.start+1):c?a(c.start+1,c.end+1):d?a(d.start+1,d.end+1):a(1,s+1)}static _deleteWordPartLeft(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=_t._moveWordPartLeft(e,i);return new L(i.lineNumber,i.column,n.lineNumber,n.column)}static _findFirstNonWhitespaceChar(e,t){const i=e.length;for(let n=t;n<i;n++){const s=e.charAt(n);if(s!==" "&&s!=="	")return n}return i}static _deleteWordRightWhitespace(e,t){const i=e.getLineContent(t.lineNumber),n=t.column-1,s=this._findFirstNonWhitespaceChar(i,n);return n+1<s?new L(t.lineNumber,t.column,t.lineNumber,s+1):null}static deleteWordRight(e,t){const i=e.wordSeparators,n=e.model,s=e.selection,r=e.whitespaceHeuristics;if(!s.isEmpty())return s;const a=new A(s.positionLineNumber,s.positionColumn);let l=a.lineNumber,c=a.column;const d=n.getLineCount(),h=n.getLineMaxColumn(l);if(l===d&&c===h)return null;if(r){const g=this._deleteWordRightWhitespace(n,a);if(g)return g}let u=_t._findNextWordOnLine(i,n,a);return t===2?u?c=u.end+1:c<h||l===d?c=h:(l++,u=_t._findNextWordOnLine(i,n,new A(l,1)),u?c=u.start+1:c=n.getLineMaxColumn(l)):(u&&c>=u.start+1&&(u=_t._findNextWordOnLine(i,n,new A(l,u.end+1))),u?c=u.start+1:c<h||l===d?c=h:(l++,u=_t._findNextWordOnLine(i,n,new A(l,1)),u?c=u.start+1:c=n.getLineMaxColumn(l))),new L(l,c,a.lineNumber,a.column)}static _deleteWordPartRight(e,t){if(!t.isEmpty())return t;const i=t.getPosition(),n=_t._moveWordPartRight(e,i);return new L(i.lineNumber,i.column,n.lineNumber,n.column)}static _createWordAtPosition(e,t,i){const n=new L(t,i.start+1,t,i.end+1);return{word:e.getValueInRange(n),startColumn:n.startColumn,endColumn:n.endColumn}}static getWordAtPosition(e,t,i,n){const s=gr(t,i),r=_t._findPreviousWordOnLine(s,e,n);if(r&&r.wordType===1&&r.start<=n.column-1&&n.column-1<=r.end)return _t._createWordAtPosition(e,n.lineNumber,r);const a=_t._findNextWordOnLine(s,e,n);return a&&a.wordType===1&&a.start<=n.column-1&&n.column-1<=a.end?_t._createWordAtPosition(e,n.lineNumber,a):null}static word(e,t,i,n,s){const r=gr(e.wordSeparators,e.wordSegmenterLocales),a=_t._findPreviousWordOnLine(r,t,s),l=_t._findNextWordOnLine(r,t,s);if(!n){let g,f;return a&&a.wordType===1&&a.start<=s.column-1&&s.column-1<=a.end?(g=a.start+1,f=a.end+1):l&&l.wordType===1&&l.start<=s.column-1&&s.column-1<=l.end?(g=l.start+1,f=l.end+1):(a?g=a.end+1:g=1,l?f=l.start+1:f=t.getLineMaxColumn(s.lineNumber)),new hn(new L(s.lineNumber,g,s.lineNumber,f),1,0,new A(s.lineNumber,f),0)}let c,d;a&&a.wordType===1&&a.start<s.column-1&&s.column-1<a.end?(c=a.start+1,d=a.end+1):l&&l.wordType===1&&l.start<s.column-1&&s.column-1<l.end?(c=l.start+1,d=l.end+1):(c=s.column,d=s.column);const h=s.lineNumber;let u;if(i.selectionStart.containsPosition(s))u=i.selectionStart.endColumn;else if(s.isBeforeOrEqual(i.selectionStart.getStartPosition())){u=c;const g=new A(h,u);i.selectionStart.containsPosition(g)&&(u=i.selectionStart.endColumn)}else{u=d;const g=new A(h,u);i.selectionStart.containsPosition(g)&&(u=i.selectionStart.startColumn)}return i.move(!0,h,u,0)}}class oD extends _t{static deleteWordPartLeft(e){const t=ZS([_t.deleteWordLeft(e,0),_t.deleteWordLeft(e,2),_t._deleteWordPartLeft(e.model,e.selection)]);return t.sort(L.compareRangesUsingEnds),t[2]}static deleteWordPartRight(e){const t=ZS([_t.deleteWordRight(e,0),_t.deleteWordRight(e,2),_t._deleteWordPartRight(e.model,e.selection)]);return t.sort(L.compareRangesUsingStarts),t[0]}static moveWordPartLeft(e,t,i,n){const s=ZS([_t.moveWordLeft(e,t,i,0,n),_t.moveWordLeft(e,t,i,2,n),_t._moveWordPartLeft(t,i)]);return s.sort(A.compare),s[2]}static moveWordPartRight(e,t,i){const n=ZS([_t.moveWordRight(e,t,i,0),_t.moveWordRight(e,t,i,2),_t._moveWordPartRight(t,i)]);return n.sort(A.compare),n[0]}}function ZS(o){return o.filter(e=>!!e)}class dn{static addCursorDown(e,t,i){const n=[];let s=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];n[s++]=new ht(l.modelState,l.viewState),i?n[s++]=ht.fromModelState(Ct.translateDown(e.cursorConfig,e.model,l.modelState)):n[s++]=ht.fromViewState(Ct.translateDown(e.cursorConfig,e,l.viewState))}return n}static addCursorUp(e,t,i){const n=[];let s=0;for(let r=0,a=t.length;r<a;r++){const l=t[r];n[s++]=new ht(l.modelState,l.viewState),i?n[s++]=ht.fromModelState(Ct.translateUp(e.cursorConfig,e.model,l.modelState)):n[s++]=ht.fromViewState(Ct.translateUp(e.cursorConfig,e,l.viewState))}return n}static moveToBeginningOfLine(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s];n[s]=this._moveToLineStart(e,a,i)}return n}static _moveToLineStart(e,t,i){const n=t.viewState.position.column,s=t.modelState.position.column,r=n===s,a=t.viewState.position.lineNumber,l=e.getLineFirstNonWhitespaceColumn(a);return!r&&!(n===l)?this._moveToLineStartByView(e,t,i):this._moveToLineStartByModel(e,t,i)}static _moveToLineStartByView(e,t,i){return ht.fromViewState(Ct.moveToBeginningOfLine(e.cursorConfig,e,t.viewState,i))}static _moveToLineStartByModel(e,t,i){return ht.fromModelState(Ct.moveToBeginningOfLine(e.cursorConfig,e.model,t.modelState,i))}static moveToEndOfLine(e,t,i,n){const s=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];s[r]=this._moveToLineEnd(e,l,i,n)}return s}static _moveToLineEnd(e,t,i,n){const s=t.viewState.position,r=e.getLineMaxColumn(s.lineNumber),a=s.column===r,l=t.modelState.position,c=e.model.getLineMaxColumn(l.lineNumber),d=r-s.column===c-l.column;return a||d?this._moveToLineEndByModel(e,t,i,n):this._moveToLineEndByView(e,t,i,n)}static _moveToLineEndByView(e,t,i,n){return ht.fromViewState(Ct.moveToEndOfLine(e.cursorConfig,e,t.viewState,i,n))}static _moveToLineEndByModel(e,t,i,n){return ht.fromModelState(Ct.moveToEndOfLine(e.cursorConfig,e.model,t.modelState,i,n))}static expandLineSelection(e,t){const i=[];for(let n=0,s=t.length;n<s;n++){const r=t[n],a=r.modelState.selection.startLineNumber,l=e.model.getLineCount();let c=r.modelState.selection.endLineNumber,d;c===l?d=e.model.getLineMaxColumn(l):(c++,d=1),i[n]=ht.fromModelState(new hn(new L(a,1,a,1),0,0,new A(c,d),0))}return i}static moveToBeginningOfBuffer(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s];n[s]=ht.fromModelState(Ct.moveToBeginningOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static moveToEndOfBuffer(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s];n[s]=ht.fromModelState(Ct.moveToEndOfBuffer(e.cursorConfig,e.model,a.modelState,i))}return n}static selectAll(e,t){const i=e.model.getLineCount(),n=e.model.getLineMaxColumn(i);return ht.fromModelState(new hn(new L(1,1,1,1),0,0,new A(i,n),0))}static line(e,t,i,n,s){const r=e.model.validatePosition(n),a=s?e.coordinatesConverter.validateViewPosition(new A(s.lineNumber,s.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);if(!i){const c=e.model.getLineCount();let d=r.lineNumber+1,h=1;return d>c&&(d=c,h=e.model.getLineMaxColumn(d)),ht.fromModelState(new hn(new L(r.lineNumber,1,d,h),2,0,new A(d,h),0))}const l=t.modelState.selectionStart.getStartPosition().lineNumber;if(r.lineNumber<l)return ht.fromViewState(t.viewState.move(!0,a.lineNumber,1,0));if(r.lineNumber>l){const c=e.getLineCount();let d=a.lineNumber+1,h=1;return d>c&&(d=c,h=e.getLineMaxColumn(d)),ht.fromViewState(t.viewState.move(!0,d,h,0))}else{const c=t.modelState.selectionStart.getEndPosition();return ht.fromModelState(t.modelState.move(!0,c.lineNumber,c.column,0))}}static word(e,t,i,n){const s=e.model.validatePosition(n);return ht.fromModelState(_t.word(e.cursorConfig,e.model,t.modelState,i,s))}static cancelSelection(e,t){if(!t.modelState.hasSelection())return new ht(t.modelState,t.viewState);const i=t.viewState.position.lineNumber,n=t.viewState.position.column;return ht.fromViewState(new hn(new L(i,n,i,n),0,0,new A(i,n),0))}static moveTo(e,t,i,n,s){if(i){if(t.modelState.selectionStartKind===1)return this.word(e,t,i,n);if(t.modelState.selectionStartKind===2)return this.line(e,t,i,n,s)}const r=e.model.validatePosition(n),a=s?e.coordinatesConverter.validateViewPosition(new A(s.lineNumber,s.column),r):e.coordinatesConverter.convertModelPositionToViewPosition(r);return ht.fromViewState(t.viewState.move(i,a.lineNumber,a.column,0))}static simpleMove(e,t,i,n,s,r){switch(i){case 0:return r===4?this._moveHalfLineLeft(e,t,n):this._moveLeft(e,t,n,s);case 1:return r===4?this._moveHalfLineRight(e,t,n):this._moveRight(e,t,n,s);case 2:return r===2?this._moveUpByViewLines(e,t,n,s):this._moveUpByModelLines(e,t,n,s);case 3:return r===2?this._moveDownByViewLines(e,t,n,s):this._moveDownByModelLines(e,t,n,s);case 4:return r===2?t.map(a=>ht.fromViewState(Ct.moveToPrevBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ht.fromModelState(Ct.moveToPrevBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 5:return r===2?t.map(a=>ht.fromViewState(Ct.moveToNextBlankLine(e.cursorConfig,e,a.viewState,n))):t.map(a=>ht.fromModelState(Ct.moveToNextBlankLine(e.cursorConfig,e.model,a.modelState,n)));case 6:return this._moveToViewMinColumn(e,t,n);case 7:return this._moveToViewFirstNonWhitespaceColumn(e,t,n);case 8:return this._moveToViewCenterColumn(e,t,n);case 9:return this._moveToViewMaxColumn(e,t,n);case 10:return this._moveToViewLastNonWhitespaceColumn(e,t,n);default:return null}}static viewportMove(e,t,i,n,s){const r=e.getCompletelyVisibleViewRange(),a=e.coordinatesConverter.convertViewRangeToModelRange(r);switch(i){case 11:{const l=this._firstLineNumberInRange(e.model,a,s),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 13:{const l=this._lastLineNumberInRange(e.model,a,s),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 12:{const l=Math.round((a.startLineNumber+a.endLineNumber)/2),c=e.model.getLineFirstNonWhitespaceColumn(l);return[this._moveToModelPosition(e,t[0],n,l,c)]}case 14:{const l=[];for(let c=0,d=t.length;c<d;c++){const h=t[c];l[c]=this.findPositionInViewportIfOutside(e,h,r,n)}return l}default:return null}}static findPositionInViewportIfOutside(e,t,i,n){const s=t.viewState.position.lineNumber;if(i.startLineNumber<=s&&s<=i.endLineNumber-1)return new ht(t.modelState,t.viewState);{let r;s>i.endLineNumber-1?r=i.endLineNumber-1:s<i.startLineNumber?r=i.startLineNumber:r=s;const a=Ct.vertical(e.cursorConfig,e,s,t.viewState.position.column,t.viewState.leftoverVisibleColumns,r,!1);return ht.fromViewState(t.viewState.move(n,a.lineNumber,a.column,a.leftoverVisibleColumns))}}static _firstLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.min(t.endLineNumber,n+i-1)}static _lastLineNumberInRange(e,t,i){let n=t.startLineNumber;return t.startColumn!==e.getLineMinColumn(n)&&n++,Math.max(n,t.endLineNumber-i+1)}static _moveLeft(e,t,i,n){return t.map(s=>ht.fromViewState(Ct.moveLeft(e.cursorConfig,e,s.viewState,i,n)))}static _moveHalfLineLeft(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[s]=ht.fromViewState(Ct.moveLeft(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveRight(e,t,i,n){return t.map(s=>ht.fromViewState(Ct.moveRight(e.cursorConfig,e,s.viewState,i,n)))}static _moveHalfLineRight(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.viewState.position.lineNumber,c=Math.round(e.getLineLength(l)/2);n[s]=ht.fromViewState(Ct.moveRight(e.cursorConfig,e,a.viewState,i,c))}return n}static _moveDownByViewLines(e,t,i,n){const s=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];s[r]=ht.fromViewState(Ct.moveDown(e.cursorConfig,e,l.viewState,i,n))}return s}static _moveDownByModelLines(e,t,i,n){const s=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];s[r]=ht.fromModelState(Ct.moveDown(e.cursorConfig,e.model,l.modelState,i,n))}return s}static _moveUpByViewLines(e,t,i,n){const s=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];s[r]=ht.fromViewState(Ct.moveUp(e.cursorConfig,e,l.viewState,i,n))}return s}static _moveUpByModelLines(e,t,i,n){const s=[];for(let r=0,a=t.length;r<a;r++){const l=t[r];s[r]=ht.fromModelState(Ct.moveUp(e.cursorConfig,e.model,l.modelState,i,n))}return s}static _moveToViewPosition(e,t,i,n,s){return ht.fromViewState(t.viewState.move(i,n,s,0))}static _moveToModelPosition(e,t,i,n,s){return ht.fromModelState(t.modelState.move(i,n,s,0))}static _moveToViewMinColumn(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineMinColumn(l);n[s]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewFirstNonWhitespaceColumn(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineFirstNonWhitespaceColumn(l);n[s]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewCenterColumn(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.viewState.position.lineNumber,c=Math.round((e.getLineMaxColumn(l)+e.getLineMinColumn(l))/2);n[s]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewMaxColumn(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineMaxColumn(l);n[s]=this._moveToViewPosition(e,a,i,l,c)}return n}static _moveToViewLastNonWhitespaceColumn(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.viewState.position.lineNumber,c=e.getLineLastNonWhitespaceColumn(l);n[s]=this._moveToViewPosition(e,a,i,l,c)}return n}}var Xx;(function(o){const e=function(i){if(!nn(i))return!1;const n=i;return!(!Ds(n.to)||!Zn(n.select)&&!K6(n.select)||!Zn(n.by)&&!Ds(n.by)||!Zn(n.value)&&!Lh(n.value))};o.metadata={description:"Move cursor to a logical position in the view",args:[{name:"Cursor move argument object",description:`Property-value pairs that can be passed through this argument:
					* 'to': A mandatory logical position value providing where to move the cursor.
						\`\`\`
						'left', 'right', 'up', 'down', 'prevBlankLine', 'nextBlankLine',
						'wrappedLineStart', 'wrappedLineEnd', 'wrappedLineColumnCenter'
						'wrappedLineFirstNonWhitespaceCharacter', 'wrappedLineLastNonWhitespaceCharacter'
						'viewPortTop', 'viewPortCenter', 'viewPortBottom', 'viewPortIfOutside'
						\`\`\`
					* 'by': Unit to move. Default is computed based on 'to' value.
						\`\`\`
						'line', 'wrappedLine', 'character', 'halfLine'
						\`\`\`
					* 'value': Number of units to move. Default is '1'.
					* 'select': If 'true' makes the selection. Default is 'false'.
				`,constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["left","right","up","down","prevBlankLine","nextBlankLine","wrappedLineStart","wrappedLineEnd","wrappedLineColumnCenter","wrappedLineFirstNonWhitespaceCharacter","wrappedLineLastNonWhitespaceCharacter","viewPortTop","viewPortCenter","viewPortBottom","viewPortIfOutside"]},by:{type:"string",enum:["line","wrappedLine","character","halfLine"]},value:{type:"number",default:1},select:{type:"boolean",default:!1}}}}]},o.RawDirection={Left:"left",Right:"right",Up:"up",Down:"down",PrevBlankLine:"prevBlankLine",NextBlankLine:"nextBlankLine",WrappedLineStart:"wrappedLineStart",WrappedLineFirstNonWhitespaceCharacter:"wrappedLineFirstNonWhitespaceCharacter",WrappedLineColumnCenter:"wrappedLineColumnCenter",WrappedLineEnd:"wrappedLineEnd",WrappedLineLastNonWhitespaceCharacter:"wrappedLineLastNonWhitespaceCharacter",ViewPortTop:"viewPortTop",ViewPortCenter:"viewPortCenter",ViewPortBottom:"viewPortBottom",ViewPortIfOutside:"viewPortIfOutside"},o.RawUnit={Line:"line",WrappedLine:"wrappedLine",Character:"character",HalfLine:"halfLine"};function t(i){if(!i.to)return null;let n;switch(i.to){case o.RawDirection.Left:n=0;break;case o.RawDirection.Right:n=1;break;case o.RawDirection.Up:n=2;break;case o.RawDirection.Down:n=3;break;case o.RawDirection.PrevBlankLine:n=4;break;case o.RawDirection.NextBlankLine:n=5;break;case o.RawDirection.WrappedLineStart:n=6;break;case o.RawDirection.WrappedLineFirstNonWhitespaceCharacter:n=7;break;case o.RawDirection.WrappedLineColumnCenter:n=8;break;case o.RawDirection.WrappedLineEnd:n=9;break;case o.RawDirection.WrappedLineLastNonWhitespaceCharacter:n=10;break;case o.RawDirection.ViewPortTop:n=11;break;case o.RawDirection.ViewPortBottom:n=13;break;case o.RawDirection.ViewPortCenter:n=12;break;case o.RawDirection.ViewPortIfOutside:n=14;break;default:return null}let s=0;switch(i.by){case o.RawUnit.Line:s=1;break;case o.RawUnit.WrappedLine:s=2;break;case o.RawUnit.Character:s=3;break;case o.RawUnit.HalfLine:s=4;break}return{direction:n,unit:s,select:!!i.select,value:i.value||1}}o.parse=t})(Xx||(Xx={}));class EB{constructor(e,t,i){this._indentRulesSupport=t,this._indentationLineProcessor=new GK(e,i)}shouldIncrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIncrease(i)}shouldDecrease(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldDecrease(i)}shouldIgnore(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIgnore(i)}shouldIndentNextLine(e,t){const i=this._indentationLineProcessor.getProcessedLine(e,t);return this._indentRulesSupport.shouldIndentNextLine(i)}}class TB{constructor(e,t){this.model=e,this.indentationLineProcessor=new GK(e,t)}getProcessedTokenContextAroundRange(e){const t=this._getProcessedTokensBeforeRange(e),i=this._getProcessedTokensAfterRange(e),n=this._getProcessedPreviousLineTokens(e);return{beforeRangeProcessedTokens:t,afterRangeProcessedTokens:i,previousLineProcessedTokens:n}}_getProcessedTokensBeforeRange(e){this.model.tokenization.forceTokenization(e.startLineNumber);const t=this.model.tokenization.getLineTokens(e.startLineNumber),i=Qu(t,e.startColumn-1);let n;if(DB(this.model,e.getStartPosition())){const r=e.startColumn-1-i.firstCharOffset,a=i.firstCharOffset,l=a+r;n=t.sliceAndInflate(a,l,0)}else{const r=e.startColumn-1;n=t.sliceAndInflate(0,r,0)}return this.indentationLineProcessor.getProcessedTokens(n)}_getProcessedTokensAfterRange(e){const t=e.isEmpty()?e.getStartPosition():e.getEndPosition();this.model.tokenization.forceTokenization(t.lineNumber);const i=this.model.tokenization.getLineTokens(t.lineNumber),n=Qu(i,t.column-1),s=t.column-1-n.firstCharOffset,r=n.firstCharOffset+s,a=n.firstCharOffset+n.getLineLength(),l=i.sliceAndInflate(r,a,0);return this.indentationLineProcessor.getProcessedTokens(l)}_getProcessedPreviousLineTokens(e){const t=g=>{this.model.tokenization.forceTokenization(g);const f=this.model.tokenization.getLineTokens(g),m=this.model.getLineMaxColumn(g)-1;return Qu(f,m)};this.model.tokenization.forceTokenization(e.startLineNumber);const i=this.model.tokenization.getLineTokens(e.startLineNumber),n=Qu(i,e.startColumn-1),s=an.createEmpty("",n.languageIdCodec),r=e.startLineNumber-1;if(r===0||!(n.firstCharOffset===0))return s;const c=t(r);if(!(n.languageId===c.languageId))return s;const h=c.toIViewLineTokens();return this.indentationLineProcessor.getProcessedTokens(h)}}class GK{constructor(e,t){this.model=e,this.languageConfigurationService=t}getProcessedLine(e,t){const i=(r,a)=>{const l=Tt(r);return a+r.substring(l.length)};this.model.tokenization.forceTokenization?.(e);const n=this.model.tokenization.getLineTokens(e);let s=this.getProcessedTokens(n).getLineContent();return t!==void 0&&(s=i(s,t)),s}getProcessedTokens(e){const t=l=>l===2||l===3||l===1,i=e.getLanguageId(0),s=this.languageConfigurationService.getLanguageConfiguration(i).bracketsNew.getBracketRegExp({global:!0}),r=[];return e.forEach(l=>{const c=e.getStandardTokenType(l);let d=e.getTokenText(l);t(c)&&(d=d.replace(s,""));const h=e.getMetadata(l);r.push({text:d,metadata:h})}),an.createFromTextAndMetadata(r,e.languageIdCodec)}}function DB(o,e){o.tokenization.forceTokenization(e.lineNumber);const t=o.tokenization.getLineTokens(e.lineNumber),i=Qu(t,e.column-1),n=i.firstCharOffset===0,s=t.getLanguageId(0)===i.languageId;return!n&&!s}function qm(o,e,t,i){e.tokenization.forceTokenization(t.startLineNumber);const n=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),s=i.getLanguageConfiguration(n);if(!s)return null;const a=new TB(e,i).getProcessedTokenContextAroundRange(t),l=a.previousLineProcessedTokens.getLineContent(),c=a.beforeRangeProcessedTokens.getLineContent(),d=a.afterRangeProcessedTokens.getLineContent(),h=s.onEnter(o,l,c,d);if(!h)return null;const u=h.indentAction;let g=h.appendText;const f=h.removeText||0;g?u===Oi.Indent&&(g="	"+g):u===Oi.Indent||u===Oi.IndentOutdent?g="	":g="";let m=LU(e,t.startLineNumber,t.startColumn);return f&&(m=m.substring(0,m.length-f)),{indentAction:u,appendText:g,removeText:f,indentation:m}}var Mpe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ope=function(o,e){return function(t,i){e(t,i,o)}},Q1;const tN=Object.create(null);function gu(o,e){if(e<=0)return"";tN[o]||(tN[o]=["",o]);const t=tN[o];for(let i=t.length;i<=e;i++)t[i]=t[i-1]+o;return t[e]}let pr=Q1=class{static unshiftIndent(e,t,i,n,s){const r=Vi.visibleColumnFromColumn(e,t,i);if(s){const a=gu(" ",n),c=Vi.prevIndentTabStop(r,n)/n;return gu(a,c)}else{const a="	",c=Vi.prevRenderTabStop(r,i)/i;return gu(a,c)}}static shiftIndent(e,t,i,n,s){const r=Vi.visibleColumnFromColumn(e,t,i);if(s){const a=gu(" ",n),c=Vi.nextIndentTabStop(r,n)/n;return gu(a,c)}else{const a="	",c=Vi.nextRenderTabStop(r,i)/i;return gu(a,c)}}constructor(e,t,i){this._languageConfigurationService=i,this._opts=t,this._selection=e,this._selectionId=null,this._useLastEditRangeForCursorEndPosition=!1,this._selectionStartColumnStaysPut=!1}_addEditOperation(e,t,i){this._useLastEditRangeForCursorEndPosition?e.addTrackedEditOperation(t,i):e.addEditOperation(t,i)}getEditOperations(e,t){const i=this._selection.startLineNumber;let n=this._selection.endLineNumber;this._selection.endColumn===1&&i!==n&&(n=n-1);const{tabSize:s,indentSize:r,insertSpaces:a}=this._opts,l=i===n;if(this._opts.useTabStops){this._selection.isEmpty()&&/^\s*$/.test(e.getLineContent(i))&&(this._useLastEditRangeForCursorEndPosition=!0);let c=0,d=0;for(let h=i;h<=n;h++,c=d){d=0;const u=e.getLineContent(h);let g=Xn(u);if(this._opts.isUnshift&&(u.length===0||g===0)||!l&&!this._opts.isUnshift&&u.length===0)continue;if(g===-1&&(g=u.length),h>1&&Vi.visibleColumnFromColumn(u,g+1,s)%r!==0&&e.tokenization.isCheapToTokenize(h-1)){const _=qm(this._opts.autoIndent,e,new L(h-1,e.getLineMaxColumn(h-1),h-1,e.getLineMaxColumn(h-1)),this._languageConfigurationService);if(_){if(d=c,_.appendText)for(let b=0,v=_.appendText.length;b<v&&d<r&&_.appendText.charCodeAt(b)===32;b++)d++;_.removeText&&(d=Math.max(0,d-_.removeText));for(let b=0;b<d&&!(g===0||u.charCodeAt(g-1)!==32);b++)g--}}if(this._opts.isUnshift&&g===0)continue;let f;this._opts.isUnshift?f=Q1.unshiftIndent(u,g+1,s,r,a):f=Q1.shiftIndent(u,g+1,s,r,a),this._addEditOperation(t,new L(h,1,h,g+1),f),h===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn<=g+1)}}else{!this._opts.isUnshift&&this._selection.isEmpty()&&e.getLineLength(i)===0&&(this._useLastEditRangeForCursorEndPosition=!0);const c=a?gu(" ",r):"	";for(let d=i;d<=n;d++){const h=e.getLineContent(d);let u=Xn(h);if(!(this._opts.isUnshift&&(h.length===0||u===0))&&!(!l&&!this._opts.isUnshift&&h.length===0)&&(u===-1&&(u=h.length),!(this._opts.isUnshift&&u===0)))if(this._opts.isUnshift){u=Math.min(u,r);for(let g=0;g<u;g++)if(h.charCodeAt(g)===9){u=g+1;break}this._addEditOperation(t,new L(d,1,d,u+1),"")}else this._addEditOperation(t,new L(d,1,d,1),c),d===i&&!this._selection.isEmpty()&&(this._selectionStartColumnStaysPut=this._selection.startColumn===1)}}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){if(this._useLastEditRangeForCursorEndPosition){const n=t.getInverseEditOperations()[0];return new pe(n.range.endLineNumber,n.range.endColumn,n.range.endLineNumber,n.range.endColumn)}const i=t.getTrackedSelection(this._selectionId);if(this._selectionStartColumnStaysPut){const n=this._selection.startColumn;return i.startColumn<=n?i:i.getDirection()===0?new pe(i.startLineNumber,n,i.endLineNumber,i.endColumn):new pe(i.endLineNumber,i.endColumn,i.startLineNumber,n)}return i}};pr=Q1=Mpe([Ope(2,li)],pr);class Fpe{constructor(e,t,i){this._range=e,this._charBeforeSelection=t,this._charAfterSelection=i}getEditOperations(e,t){t.addTrackedEditOperation(new L(this._range.startLineNumber,this._range.startColumn,this._range.startLineNumber,this._range.startColumn),this._charBeforeSelection),t.addTrackedEditOperation(new L(this._range.endLineNumber,this._range.endColumn,this._range.endLineNumber,this._range.endColumn),this._charAfterSelection)}computeCursorState(e,t){const i=t.getInverseEditOperations(),n=i[0].range,s=i[1].range;return new pe(n.endLineNumber,n.endColumn,s.endLineNumber,s.endColumn-this._charAfterSelection.length)}}class Bpe{constructor(e,t,i){this._position=e,this._text=t,this._charAfter=i}getEditOperations(e,t){t.addTrackedEditOperation(new L(this._position.lineNumber,this._position.column,this._position.lineNumber,this._position.column),this._text+this._charAfter)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return new pe(n.endLineNumber,n.startColumn,n.endLineNumber,n.endColumn-this._charAfter.length)}}function Wpe(o,e,t){const i=o.tokenization.getLanguageIdAtPosition(e,0);if(e>1){let n,s=-1;for(n=e-1;n>=1;n--){if(o.tokenization.getLanguageIdAtPosition(n,0)!==i)return s;const r=o.getLineContent(n);if(t.shouldIgnore(n)||/^\s+$/.test(r)||r===""){s=n;continue}return n}}return-1}function My(o,e,t,i=!0,n){if(o<4)return null;const s=n.getLanguageConfiguration(e.tokenization.getLanguageId()).indentRulesSupport;if(!s)return null;const r=new EB(e,s,n);if(t<=1)return{indentation:"",action:null};for(let l=t-1;l>0&&e.getLineContent(l)==="";l--)if(l===1)return{indentation:"",action:null};const a=Wpe(e,t,r);if(a<0)return null;if(a<1)return{indentation:"",action:null};if(r.shouldIncrease(a)||r.shouldIndentNextLine(a)){const l=e.getLineContent(a);return{indentation:Tt(l),action:Oi.Indent,line:a}}else if(r.shouldDecrease(a)){const l=e.getLineContent(a);return{indentation:Tt(l),action:null,line:a}}else{if(a===1)return{indentation:Tt(e.getLineContent(a)),action:null,line:a};const l=a-1,c=s.getIndentMetadata(e.getLineContent(l));if(!(c&3)&&c&4){let d=0;for(let h=l-1;h>0;h--)if(!r.shouldIndentNextLine(h)){d=h;break}return{indentation:Tt(e.getLineContent(d+1)),action:null,line:d+1}}if(i)return{indentation:Tt(e.getLineContent(a)),action:null,line:a};for(let d=a;d>0;d--){if(r.shouldIncrease(d))return{indentation:Tt(e.getLineContent(d)),action:Oi.Indent,line:d};if(r.shouldIndentNextLine(d)){let h=0;for(let u=d-1;u>0;u--)if(!r.shouldIndentNextLine(d)){h=u;break}return{indentation:Tt(e.getLineContent(h+1)),action:null,line:h+1}}else if(r.shouldDecrease(d))return{indentation:Tt(e.getLineContent(d)),action:null,line:d}}return{indentation:Tt(e.getLineContent(1)),action:null,line:1}}}function eC(o,e,t,i,n,s){if(o<4)return null;const r=s.getLanguageConfiguration(t);if(!r)return null;const a=s.getLanguageConfiguration(t).indentRulesSupport;if(!a)return null;const l=new EB(e,a,s),c=My(o,e,i,void 0,s);if(c){const d=c.line;if(d!==void 0){let h=!0;for(let u=d;u<i-1;u++)if(!/^\s*$/.test(e.getLineContent(u))){h=!1;break}if(h){const u=r.onEnter(o,"",e.getLineContent(d),"");if(u){let g=Tt(e.getLineContent(d));return u.removeText&&(g=g.substring(0,g.length-u.removeText)),u.indentAction===Oi.Indent||u.indentAction===Oi.IndentOutdent?g=n.shiftIndent(g):u.indentAction===Oi.Outdent&&(g=n.unshiftIndent(g)),l.shouldDecrease(i)&&(g=n.unshiftIndent(g)),u.appendText&&(g+=u.appendText),Tt(g)}}}return l.shouldDecrease(i)?c.action===Oi.Indent?c.indentation:n.unshiftIndent(c.indentation):c.action===Oi.Indent?n.shiftIndent(c.indentation):c.indentation}return null}function Vpe(o,e,t,i,n){if(o<4)return null;const s=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),r=n.getLanguageConfiguration(s).indentRulesSupport;if(!r)return null;e.tokenization.forceTokenization(t.startLineNumber);const l=new TB(e,n).getProcessedTokenContextAroundRange(t),c=l.afterRangeProcessedTokens,d=l.beforeRangeProcessedTokens,h=Tt(d.getLineContent()),u=zpe(e,t.startLineNumber,d),g=DB(e,t.getStartPosition()),f=e.getLineContent(t.startLineNumber),m=Tt(f),_=My(o,u,t.startLineNumber+1,void 0,n);if(!_){const v=g?m:h;return{beforeEnter:v,afterEnter:v}}let b=g?m:_.indentation;return _.action===Oi.Indent&&(b=i.shiftIndent(b)),r.shouldDecrease(c.getLineContent())&&(b=i.unshiftIndent(b)),{beforeEnter:g?m:h,afterEnter:b}}function Hpe(o,e,t,i,n,s){const r=o.autoIndent;if(r<4||DB(e,t.getStartPosition()))return null;const l=e.getLanguageIdAtPosition(t.startLineNumber,t.startColumn),c=s.getLanguageConfiguration(l).indentRulesSupport;if(!c)return null;const h=new TB(e,s).getProcessedTokenContextAroundRange(t),u=h.beforeRangeProcessedTokens.getLineContent(),g=h.afterRangeProcessedTokens.getLineContent(),f=u+g,m=u+i+g;if(!c.shouldDecrease(f)&&c.shouldDecrease(m)){const b=My(r,e,t.startLineNumber,!1,s);if(!b)return null;let v=b.indentation;return b.action!==Oi.Indent&&(v=n.unshiftIndent(v)),v}const _=t.startLineNumber-1;if(_>0){const b=e.getLineContent(_);if(c.shouldIndentNextLine(b)&&c.shouldIncrease(m)){const y=My(r,e,t.startLineNumber,!1,s)?.indentation;if(y!==void 0){const C=e.getLineContent(t.startLineNumber),w=Tt(C),k=n.shiftIndent(y)===w,E=/^\s*$/.test(f),N=o.autoClosingPairs.autoClosingPairsOpenByEnd.get(i),B=N&&N.length>0&&E;if(k&&B)return y}}}return null}function $K(o,e,t){const i=t.getLanguageConfiguration(o.getLanguageId()).indentRulesSupport;return!i||e<1||e>o.getLineCount()?null:i.getIndentMetadata(o.getLineContent(e))}function zpe(o,e,t){return{tokenization:{getLineTokens:n=>n===e?t:o.tokenization.getLineTokens(n),getLanguageId:()=>o.getLanguageId(),getLanguageIdAtPosition:(n,s)=>o.getLanguageIdAtPosition(n,s)},getLineContent:n=>n===e?t.getLineContent():o.getLineContent(n)}}class Upe{static getEdits(e,t,i,n,s){if(!s&&this._isAutoIndentType(e,t,i)){const r=[];for(const l of i){const c=this._findActualIndentationForSelection(e,t,l,n);if(c===null)return;r.push({selection:l,indentation:c})}const a=jM.getAutoClosingPairClose(e,t,i,n,!1);return this._getIndentationAndAutoClosingPairEdits(e,t,r,n,a)}}static _isAutoIndentType(e,t,i){if(e.autoIndent<4)return!1;for(let n=0,s=i.length;n<s;n++)if(!t.tokenization.isCheapToTokenize(i[n].getEndPosition().lineNumber))return!1;return!0}static _findActualIndentationForSelection(e,t,i,n){const s=Hpe(e,t,i,n,{shiftIndent:a=>RB(e,a),unshiftIndent:a=>Qx(e,a)},e.languageConfigurationService);if(s===null)return null;const r=LU(t,i.startLineNumber,i.startColumn);return s===e.normalizeIndentation(r)?null:s}static _getIndentationAndAutoClosingPairEdits(e,t,i,n,s){const r=i.map(({selection:l,indentation:c})=>{if(s!==null){const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!1);return new eme(d,l,n,s)}else{const d=this._getEditFromIndentationAndSelection(e,t,c,l,n,!0);return ku(d.range,d.text,!1)}}),a={shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1};return new Rs(4,r,a)}static _getEditFromIndentationAndSelection(e,t,i,n,s,r=!0){const a=n.startLineNumber,l=t.getLineFirstNonWhitespaceColumn(a);let c=e.normalizeIndentation(i);if(l!==0){const h=t.getLineContent(a);c+=h.substring(l-1,n.startColumn-1)}return c+=r?s:"",{range:new L(a,1,n.endLineNumber,n.endColumn),text:c}}}class Gpe{static getEdits(e,t,i,n,s,r){if(KK(t,i,n,s,r))return this._runAutoClosingOvertype(e,n,r)}static _runAutoClosingOvertype(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const l=t[s].getPosition(),c=new L(l.lineNumber,l.column,l.lineNumber,l.column+1);n[s]=new xn(c,i)}return new Rs(4,n,{shouldPushStackElementBefore:aD(e,4),shouldPushStackElementAfter:!1})}}class $pe{static getEdits(e,t,i,n,s){if(KK(e,t,i,n,s)){const r=i.map(a=>new xn(new L(a.positionLineNumber,a.positionColumn,a.positionLineNumber,a.positionColumn+1),"",!1));return new Rs(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}}class jM{static getEdits(e,t,i,n,s,r){if(!r){const a=this.getAutoClosingPairClose(e,t,i,n,s);if(a!==null)return this._runAutoClosingOpenCharType(i,n,s,a)}}static _runAutoClosingOpenCharType(e,t,i,n){const s=[];for(let r=0,a=e.length;r<a;r++){const l=e[r];s[r]=new Jpe(l,t,!i,n)}return new Rs(4,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}static getAutoClosingPairClose(e,t,i,n,s){for(const f of i)if(!f.isEmpty())return null;const r=i.map(f=>{const m=f.getPosition();return s?{lineNumber:m.lineNumber,beforeColumn:m.column-n.length,afterColumn:m.column}:{lineNumber:m.lineNumber,beforeColumn:m.column,afterColumn:m.column}}),a=this._findAutoClosingPairOpen(e,t,r.map(f=>new A(f.lineNumber,f.beforeColumn)),n);if(!a)return null;let l,c;if(Hh(n)?(l=e.autoClosingQuotes,c=e.shouldAutoCloseBefore.quote):(e.blockCommentStartToken?a.open.includes(e.blockCommentStartToken):!1)?(l=e.autoClosingComments,c=e.shouldAutoCloseBefore.comment):(l=e.autoClosingBrackets,c=e.shouldAutoCloseBefore.bracket),l==="never")return null;const h=this._findContainedAutoClosingPair(e,a),u=h?h.close:"";let g=!0;for(const f of r){const{lineNumber:m,beforeColumn:_,afterColumn:b}=f,v=t.getLineContent(m),y=v.substring(0,_-1),C=v.substring(b-1);if(C.startsWith(u)||(g=!1),C.length>0){const E=C.charAt(0);if(!this._isBeforeClosingBrace(e,C)&&!c(E))return null}if(a.open.length===1&&(n==="'"||n==='"')&&l!=="always"){const E=gr(e.wordSeparators,[]);if(y.length>0){const N=y.charCodeAt(y.length-1);if(E.get(N)===0)return null}}if(!t.tokenization.isCheapToTokenize(m))return null;t.tokenization.forceTokenization(m);const w=t.tokenization.getLineTokens(m),x=Qu(w,_-1);if(!a.shouldAutoClose(x,_-x.firstCharOffset))return null;const k=a.findNeutralCharacter();if(k){const E=t.tokenization.getTokenTypeIfInsertingCharacter(m,_,k);if(!a.isOK(E))return null}}return g?a.close.substring(0,a.close.length-u.length):a.close}static _findContainedAutoClosingPair(e,t){if(t.open.length<=1)return null;const i=t.close.charAt(t.close.length-1),n=e.autoClosingPairs.autoClosingPairsCloseByEnd.get(i)||[];let s=null;for(const r of n)r.open!==t.open&&t.open.includes(r.open)&&t.close.endsWith(r.close)&&(!s||r.open.length>s.open.length)&&(s=r);return s}static _findAutoClosingPairOpen(e,t,i,n){const s=e.autoClosingPairs.autoClosingPairsOpenByEnd.get(n);if(!s)return null;let r=null;for(const a of s)if(r===null||a.open.length>r.open.length){let l=!0;for(const c of i)if(t.getValueInRange(new L(c.lineNumber,c.column-a.open.length+1,c.lineNumber,c.column))+n!==a.open){l=!1;break}l&&(r=a)}return r}static _isBeforeClosingBrace(e,t){const i=t.charAt(0),n=e.autoClosingPairs.autoClosingPairsOpenByStart.get(i)||[],s=e.autoClosingPairs.autoClosingPairsCloseByStart.get(i)||[],r=n.some(l=>t.startsWith(l.open)),a=s.some(l=>t.startsWith(l.close));return!r&&a}}class Kpe{static getEdits(e,t,i,n,s){if(!s&&this._isSurroundSelectionType(e,t,i,n))return this._runSurroundSelectionType(e,i,n)}static _runSurroundSelectionType(e,t,i){const n=[];for(let s=0,r=t.length;s<r;s++){const a=t[s],l=e.surroundingPairs[i];n[s]=new Fpe(a,i,l)}return new Rs(0,n,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _isSurroundSelectionType(e,t,i,n){if(!jK(e,n)||!e.surroundingPairs.hasOwnProperty(n))return!1;const s=Hh(n);for(const r of i){if(r.isEmpty())return!1;let a=!0;for(let l=r.startLineNumber;l<=r.endLineNumber;l++){const c=t.getLineContent(l),d=l===r.startLineNumber?r.startColumn-1:0,h=l===r.endLineNumber?r.endColumn-1:c.length,u=c.substring(d,h);if(/[^ \t]/.test(u)){a=!1;break}}if(a)return!1;if(s&&r.startLineNumber===r.endLineNumber&&r.startColumn+1===r.endColumn){const l=t.getValueInRange(r);if(Hh(l))return!1}}return!0}}class jpe{static getEdits(e,t,i,n,s,r){if(!r&&this._isTypeInterceptorElectricChar(t,i,n)){const a=this._typeInterceptorElectricChar(e,t,i,n[0],s);if(a)return a}}static _isTypeInterceptorElectricChar(e,t,i){return!!(i.length===1&&t.tokenization.isCheapToTokenize(i[0].getEndPosition().lineNumber))}static _typeInterceptorElectricChar(e,t,i,n,s){if(!t.electricChars.hasOwnProperty(s)||!n.isEmpty())return null;const r=n.getPosition();i.tokenization.forceTokenization(r.lineNumber);const a=i.tokenization.getLineTokens(r.lineNumber);let l;try{l=t.onElectricCharacter(s,a,r.column)}catch(c){return Ae(c),null}if(!l)return null;if(l.matchOpenBracket){const c=(a.getLineContent()+s).lastIndexOf(l.matchOpenBracket)+1,d=i.bracketPairs.findMatchingBracketUp(l.matchOpenBracket,{lineNumber:r.lineNumber,column:c},500);if(d){if(d.startLineNumber===r.lineNumber)return null;const h=i.getLineContent(d.startLineNumber),u=Tt(h),g=t.normalizeIndentation(u),f=i.getLineContent(r.lineNumber),m=i.getLineFirstNonWhitespaceColumn(r.lineNumber)||r.column,_=f.substring(m-1,r.column-1),b=g+_+s,v=new L(r.lineNumber,1,r.lineNumber,r.column),y=new xn(v,b);return new Rs(NB(b,e),[y],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!0})}}return null}}class qpe{static getEdits(e,t,i){const n=[];for(let r=0,a=t.length;r<a;r++)n[r]=new xn(t[r],i);const s=NB(i,e);return new Rs(s,n,{shouldPushStackElementBefore:aD(e,s),shouldPushStackElementAfter:!1})}}class rD{static getEdits(e,t,i,n,s){if(!s&&n===`
`){const r=[];for(let a=0,l=i.length;a<l;a++)r[a]=this._enter(e,t,!1,i[a]);return new Rs(4,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}}static _enter(e,t,i,n){if(e.autoIndent===0)return ku(n,`
`,i);if(!t.tokenization.isCheapToTokenize(n.getStartPosition().lineNumber)||e.autoIndent===1){const l=t.getLineContent(n.startLineNumber),c=Tt(l).substring(0,n.startColumn-1);return ku(n,`
`+e.normalizeIndentation(c),i)}const s=qm(e.autoIndent,t,n,e.languageConfigurationService);if(s){if(s.indentAction===Oi.None)return ku(n,`
`+e.normalizeIndentation(s.indentation+s.appendText),i);if(s.indentAction===Oi.Indent)return ku(n,`
`+e.normalizeIndentation(s.indentation+s.appendText),i);if(s.indentAction===Oi.IndentOutdent){const l=e.normalizeIndentation(s.indentation),c=e.normalizeIndentation(s.indentation+s.appendText),d=`
`+c+`
`+l;return i?new X1(n,d,!0):new Yx(n,d,-1,c.length-l.length,!0)}else if(s.indentAction===Oi.Outdent){const l=Qx(e,s.indentation);return ku(n,`
`+e.normalizeIndentation(l+s.appendText),i)}}const r=t.getLineContent(n.startLineNumber),a=Tt(r).substring(0,n.startColumn-1);if(e.autoIndent>=4){const l=Vpe(e.autoIndent,t,n,{unshiftIndent:c=>Qx(e,c),shiftIndent:c=>RB(e,c),normalizeIndentation:c=>e.normalizeIndentation(c)},e.languageConfigurationService);if(l){let c=e.visibleColumnFromColumn(t,n.getEndPosition());const d=n.endColumn,h=t.getLineContent(n.endLineNumber),u=Xn(h);if(u>=0?n=n.setEndPosition(n.endLineNumber,Math.max(n.endColumn,u+1)):n=n.setEndPosition(n.endLineNumber,t.getLineMaxColumn(n.endLineNumber)),i)return new X1(n,`
`+e.normalizeIndentation(l.afterEnter),!0);{let g=0;return d<=u+1&&(e.insertSpaces||(c=Math.ceil(c/e.indentSize)),g=Math.min(c+1-e.normalizeIndentation(l.afterEnter).length-1,0)),new Yx(n,`
`+e.normalizeIndentation(l.afterEnter),0,g,!0)}}}return ku(n,`
`+e.normalizeIndentation(a),i)}static lineInsertBefore(e,t,i){if(t===null||i===null)return[];const n=[];for(let s=0,r=i.length;s<r;s++){let a=i[s].positionLineNumber;if(a===1)n[s]=new X1(new L(1,1,1,1),`
`);else{a--;const l=t.getLineMaxColumn(a);n[s]=this._enter(e,t,!1,new L(a,l,a,l))}}return n}static lineInsertAfter(e,t,i){if(t===null||i===null)return[];const n=[];for(let s=0,r=i.length;s<r;s++){const a=i[s].positionLineNumber,l=t.getLineMaxColumn(a);n[s]=this._enter(e,t,!1,new L(a,l,a,l))}return n}static lineBreakInsert(e,t,i){const n=[];for(let s=0,r=i.length;s<r;s++)n[s]=this._enter(e,t,!0,i[s]);return n}}class Zpe{static getEdits(e,t,i,n,s,r){const a=this._distributePasteToCursors(e,i,n,s,r);return a?(i=i.sort(L.compareRangesUsingStarts),this._distributedPaste(e,t,i,a)):this._simplePaste(e,t,i,n,s)}static _distributePasteToCursors(e,t,i,n,s){if(n||t.length===1)return null;if(s&&s.length===t.length)return s;if(e.multiCursorPaste==="spread"){i.charCodeAt(i.length-1)===10&&(i=i.substring(0,i.length-1)),i.charCodeAt(i.length-1)===13&&(i=i.substring(0,i.length-1));const r=Bl(i);if(r.length===t.length)return r}return null}static _distributedPaste(e,t,i,n){const s=[];for(let r=0,a=i.length;r<a;r++)s[r]=new xn(i[r],n[r]);return new Rs(0,s,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}static _simplePaste(e,t,i,n,s){const r=[];for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.getPosition();if(s&&!c.isEmpty()&&(s=!1),s&&n.indexOf(`
`)!==n.length-1&&(s=!1),s){const h=new L(d.lineNumber,1,d.lineNumber,1);r[a]=new kB(h,n,c,!0)}else r[a]=new xn(c,n)}return new Rs(0,r,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!0})}}class Ype{static getEdits(e,t,i,n,s,r,a,l){const c=n.map(d=>this._compositionType(i,d,s,r,a,l));return new Rs(4,c,{shouldPushStackElementBefore:aD(e,4),shouldPushStackElementAfter:!1})}static _compositionType(e,t,i,n,s,r){if(!t.isEmpty())return null;const a=t.getPosition(),l=Math.max(1,a.column-n),c=Math.min(e.getLineMaxColumn(a.lineNumber),a.column+s),d=new L(a.lineNumber,l,a.lineNumber,c);return e.getValueInRange(d)===i&&r===0?null:new Yx(d,i,0,r)}}class Xpe{static getEdits(e,t,i){const n=[];for(let r=0,a=t.length;r<a;r++)n[r]=new xn(t[r],i);const s=NB(i,e);return new Rs(s,n,{shouldPushStackElementBefore:aD(e,s),shouldPushStackElementAfter:!1})}}class Qpe{static getCommands(e,t,i){const n=[];for(let s=0,r=i.length;s<r;s++){const a=i[s];if(a.isEmpty()){const l=t.getLineContent(a.startLineNumber);if(/^\s*$/.test(l)&&t.tokenization.isCheapToTokenize(a.startLineNumber)){let c=this._goodIndentForLine(e,t,a.startLineNumber);c=c||"	";const d=e.normalizeIndentation(c);if(!l.startsWith(d)){n[s]=new xn(new L(a.startLineNumber,1,a.startLineNumber,l.length+1),d,!0);continue}}n[s]=this._replaceJumpToNextIndent(e,t,a,!0)}else{if(a.startLineNumber===a.endLineNumber){const l=t.getLineMaxColumn(a.startLineNumber);if(a.startColumn!==1||a.endColumn!==l){n[s]=this._replaceJumpToNextIndent(e,t,a,!1);continue}}n[s]=new pr(a,{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService)}}return n}static _goodIndentForLine(e,t,i){let n=null,s="";const r=My(e.autoIndent,t,i,!1,e.languageConfigurationService);if(r)n=r.action,s=r.indentation;else if(i>1){let a;for(a=i-1;a>=1;a--){const d=t.getLineContent(a);if(Sa(d)>=0)break}if(a<1)return null;const l=t.getLineMaxColumn(a),c=qm(e.autoIndent,t,new L(a,l,a,l),e.languageConfigurationService);c&&(s=c.indentation+c.appendText)}return n&&(n===Oi.Indent&&(s=RB(e,s)),n===Oi.Outdent&&(s=Qx(e,s)),s=e.normalizeIndentation(s)),s||null}static _replaceJumpToNextIndent(e,t,i,n){let s="";const r=i.getStartPosition();if(e.insertSpaces){const a=e.visibleColumnFromColumn(t,r),l=e.indentSize,c=l-a%l;for(let d=0;d<c;d++)s+=" "}else s="	";return new xn(i,s,n)}}class IB extends Yx{constructor(e,t,i,n,s,r){super(e,t,i,n),this._openCharacter=s,this._closeCharacter=r,this.closeCharacterRange=null,this.enclosingRange=null}_computeCursorStateWithRange(e,t,i){return this.closeCharacterRange=new L(t.startLineNumber,t.endColumn-this._closeCharacter.length,t.endLineNumber,t.endColumn),this.enclosingRange=new L(t.startLineNumber,t.endColumn-this._openCharacter.length-this._closeCharacter.length,t.endLineNumber,t.endColumn),super.computeCursorState(e,i)}}class Jpe extends IB{constructor(e,t,i,n){const s=(i?t:"")+n,r=0,a=-n.length;super(e,s,r,a,t,n)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._computeCursorStateWithRange(e,n,t)}}class eme extends IB{constructor(e,t,i,n){const s=i+n,r=0,a=i.length;super(t,s,r,a,i,n),this._autoIndentationEdit=e,this._autoClosingEdit={range:t,text:s}}getEditOperations(e,t){t.addTrackedEditOperation(this._autoIndentationEdit.range,this._autoIndentationEdit.text),t.addTrackedEditOperation(this._autoClosingEdit.range,this._autoClosingEdit.text)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length!==2)throw new Error("There should be two inverse edit operations!");const n=i[0].range,s=i[1].range,r=n.plusRange(s);return this._computeCursorStateWithRange(e,r,t)}}function NB(o,e){return o===" "?e===5||e===6?6:5:4}function aD(o,e){return i9(o)&&!i9(e)?!0:o===5?!1:t9(o)!==t9(e)}function t9(o){return o===6||o===5?"space":o}function i9(o){return o===4||o===5||o===6}function KK(o,e,t,i,n){if(o.autoClosingOvertype==="never"||!o.autoClosingPairs.autoClosingPairsCloseSingleChar.has(n))return!1;for(let s=0,r=t.length;s<r;s++){const a=t[s];if(!a.isEmpty())return!1;const l=a.getPosition(),c=e.getLineContent(l.lineNumber);if(c.charAt(l.column-1)!==n)return!1;const h=Hh(n);if((l.column>2?c.charCodeAt(l.column-2):0)===92&&h)return!1;if(o.autoClosingOvertype==="auto"){let g=!1;for(let f=0,m=i.length;f<m;f++){const _=i[f];if(l.lineNumber===_.startLineNumber&&l.column===_.startColumn){g=!0;break}}if(!g)return!1}}return!0}function ku(o,e,t){return t?new X1(o,e,!0):new xn(o,e,!0)}function RB(o,e,t){return t=t||1,pr.shiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function Qx(o,e,t){return t=t||1,pr.unshiftIndent(e,e.length+t,o.tabSize,o.indentSize,o.insertSpaces)}function jK(o,e){return Hh(e)?o.autoSurround==="quotes"||o.autoSurround==="languageDefined":o.autoSurround==="brackets"||o.autoSurround==="languageDefined"}class Fd{static indent(e,t,i){if(t===null||i===null)return[];const n=[];for(let s=0,r=i.length;s<r;s++)n[s]=new pr(i[s],{isUnshift:!1,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static outdent(e,t,i){const n=[];for(let s=0,r=i.length;s<r;s++)n[s]=new pr(i[s],{isUnshift:!0,tabSize:e.tabSize,indentSize:e.indentSize,insertSpaces:e.insertSpaces,useTabStops:e.useTabStops,autoIndent:e.autoIndent},e.languageConfigurationService);return n}static paste(e,t,i,n,s,r){return Zpe.getEdits(e,t,i,n,s,r)}static tab(e,t,i){return Qpe.getCommands(e,t,i)}static compositionType(e,t,i,n,s,r,a,l){return Ype.getEdits(e,t,i,n,s,r,a,l)}static compositionEndWithInterceptors(e,t,i,n,s,r){if(!n)return null;let a=null;for(const u of n)if(a===null)a=u.insertedText;else if(a!==u.insertedText)return null;if(!a||a.length!==1)return null;const l=a;let c=!1;for(const u of n)if(u.deletedText.length!==0){c=!0;break}if(c){if(!jK(t,l)||!t.surroundingPairs.hasOwnProperty(l))return null;const u=Hh(l);for(const m of n)if(m.deletedSelectionStart!==0||m.deletedSelectionEnd!==m.deletedText.length||/^[ \t]+$/.test(m.deletedText)||u&&Hh(m.deletedText))return null;const g=[];for(const m of s){if(!m.isEmpty())return null;g.push(m.getPosition())}if(g.length!==n.length)return null;const f=[];for(let m=0,_=g.length;m<_;m++)f.push(new Bpe(g[m],n[m].deletedText,t.surroundingPairs[l]));return new Rs(4,f,{shouldPushStackElementBefore:!0,shouldPushStackElementAfter:!1})}const d=$pe.getEdits(t,i,s,r,l);if(d!==void 0)return d;const h=jM.getEdits(t,i,s,l,!0,!1);return h!==void 0?h:null}static typeWithInterceptors(e,t,i,n,s,r,a){const l=rD.getEdits(i,n,s,a,e);if(l!==void 0)return l;const c=Upe.getEdits(i,n,s,a,e);if(c!==void 0)return c;const d=Gpe.getEdits(t,i,n,s,r,a);if(d!==void 0)return d;const h=jM.getEdits(i,n,s,a,!1,e);if(h!==void 0)return h;const u=Kpe.getEdits(i,n,s,a,e);if(u!==void 0)return u;const g=jpe.getEdits(t,i,n,s,a,e);return g!==void 0?g:qpe.getEdits(t,s,a)}static typeWithoutInterceptors(e,t,i,n,s){return Xpe.getEdits(e,n,s)}}class tme{constructor(e,t,i,n,s,r){this.deletedText=e,this.deletedSelectionStart=t,this.deletedSelectionEnd=i,this.insertedText=n,this.insertedSelectionStart=s,this.insertedSelectionEnd=r}}var T;(function(o){o.editorSimpleInput=new re("editorSimpleInput",!1,!0),o.editorTextFocus=new re("editorTextFocus",!1,p("editorTextFocus","Whether the editor text has focus (cursor is blinking)")),o.focus=new re("editorFocus",!1,p("editorFocus","Whether the editor or an editor widget has focus (e.g. focus is in the find widget)")),o.textInputFocus=new re("textInputFocus",!1,p("textInputFocus","Whether an editor or a rich text input has focus (cursor is blinking)")),o.readOnly=new re("editorReadonly",!1,p("editorReadonly","Whether the editor is read-only")),o.inDiffEditor=new re("inDiffEditor",!1,p("inDiffEditor","Whether the context is a diff editor")),o.isEmbeddedDiffEditor=new re("isEmbeddedDiffEditor",!1,p("isEmbeddedDiffEditor","Whether the context is an embedded diff editor")),o.inMultiDiffEditor=new re("inMultiDiffEditor",!1,p("inMultiDiffEditor","Whether the context is a multi diff editor")),o.multiDiffEditorAllCollapsed=new re("multiDiffEditorAllCollapsed",void 0,p("multiDiffEditorAllCollapsed","Whether all files in multi diff editor are collapsed")),o.hasChanges=new re("diffEditorHasChanges",!1,p("diffEditorHasChanges","Whether the diff editor has changes")),o.comparingMovedCode=new re("comparingMovedCode",!1,p("comparingMovedCode","Whether a moved code block is selected for comparison")),o.accessibleDiffViewerVisible=new re("accessibleDiffViewerVisible",!1,p("accessibleDiffViewerVisible","Whether the accessible diff viewer is visible")),o.diffEditorRenderSideBySideInlineBreakpointReached=new re("diffEditorRenderSideBySideInlineBreakpointReached",!1,p("diffEditorRenderSideBySideInlineBreakpointReached","Whether the diff editor render side by side inline breakpoint is reached")),o.diffEditorInlineMode=new re("diffEditorInlineMode",!1,p("diffEditorInlineMode","Whether inline mode is active")),o.diffEditorOriginalWritable=new re("diffEditorOriginalWritable",!1,p("diffEditorOriginalWritable","Whether modified is writable in the diff editor")),o.diffEditorModifiedWritable=new re("diffEditorModifiedWritable",!1,p("diffEditorModifiedWritable","Whether modified is writable in the diff editor")),o.diffEditorOriginalUri=new re("diffEditorOriginalUri","",p("diffEditorOriginalUri","The uri of the original document")),o.diffEditorModifiedUri=new re("diffEditorModifiedUri","",p("diffEditorModifiedUri","The uri of the modified document")),o.columnSelection=new re("editorColumnSelection",!1,p("editorColumnSelection","Whether `editor.columnSelection` is enabled")),o.writable=o.readOnly.toNegated(),o.hasNonEmptySelection=new re("editorHasSelection",!1,p("editorHasSelection","Whether the editor has text selected")),o.hasOnlyEmptySelection=o.hasNonEmptySelection.toNegated(),o.hasMultipleSelections=new re("editorHasMultipleSelections",!1,p("editorHasMultipleSelections","Whether the editor has multiple selections")),o.hasSingleSelection=o.hasMultipleSelections.toNegated(),o.tabMovesFocus=new re("editorTabMovesFocus",!1,p("editorTabMovesFocus","Whether `Tab` will move focus out of the editor")),o.tabDoesNotMoveFocus=o.tabMovesFocus.toNegated(),o.isInEmbeddedEditor=new re("isInEmbeddedEditor",!1,!0),o.canUndo=new re("canUndo",!1,!0),o.canRedo=new re("canRedo",!1,!0),o.hoverVisible=new re("editorHoverVisible",!1,p("editorHoverVisible","Whether the editor hover is visible")),o.hoverFocused=new re("editorHoverFocused",!1,p("editorHoverFocused","Whether the editor hover is focused")),o.stickyScrollFocused=new re("stickyScrollFocused",!1,p("stickyScrollFocused","Whether the sticky scroll is focused")),o.stickyScrollVisible=new re("stickyScrollVisible",!1,p("stickyScrollVisible","Whether the sticky scroll is visible")),o.standaloneColorPickerVisible=new re("standaloneColorPickerVisible",!1,p("standaloneColorPickerVisible","Whether the standalone color picker is visible")),o.standaloneColorPickerFocused=new re("standaloneColorPickerFocused",!1,p("standaloneColorPickerFocused","Whether the standalone color picker is focused")),o.inCompositeEditor=new re("inCompositeEditor",void 0,p("inCompositeEditor","Whether the editor is part of a larger editor (e.g. notebooks)")),o.notInCompositeEditor=o.inCompositeEditor.toNegated(),o.languageId=new re("editorLangId","",p("editorLangId","The language identifier of the editor")),o.hasCompletionItemProvider=new re("editorHasCompletionItemProvider",!1,p("editorHasCompletionItemProvider","Whether the editor has a completion item provider")),o.hasCodeActionsProvider=new re("editorHasCodeActionsProvider",!1,p("editorHasCodeActionsProvider","Whether the editor has a code actions provider")),o.hasCodeLensProvider=new re("editorHasCodeLensProvider",!1,p("editorHasCodeLensProvider","Whether the editor has a code lens provider")),o.hasDefinitionProvider=new re("editorHasDefinitionProvider",!1,p("editorHasDefinitionProvider","Whether the editor has a definition provider")),o.hasDeclarationProvider=new re("editorHasDeclarationProvider",!1,p("editorHasDeclarationProvider","Whether the editor has a declaration provider")),o.hasImplementationProvider=new re("editorHasImplementationProvider",!1,p("editorHasImplementationProvider","Whether the editor has an implementation provider")),o.hasTypeDefinitionProvider=new re("editorHasTypeDefinitionProvider",!1,p("editorHasTypeDefinitionProvider","Whether the editor has a type definition provider")),o.hasHoverProvider=new re("editorHasHoverProvider",!1,p("editorHasHoverProvider","Whether the editor has a hover provider")),o.hasDocumentHighlightProvider=new re("editorHasDocumentHighlightProvider",!1,p("editorHasDocumentHighlightProvider","Whether the editor has a document highlight provider")),o.hasDocumentSymbolProvider=new re("editorHasDocumentSymbolProvider",!1,p("editorHasDocumentSymbolProvider","Whether the editor has a document symbol provider")),o.hasReferenceProvider=new re("editorHasReferenceProvider",!1,p("editorHasReferenceProvider","Whether the editor has a reference provider")),o.hasRenameProvider=new re("editorHasRenameProvider",!1,p("editorHasRenameProvider","Whether the editor has a rename provider")),o.hasSignatureHelpProvider=new re("editorHasSignatureHelpProvider",!1,p("editorHasSignatureHelpProvider","Whether the editor has a signature help provider")),o.hasInlayHintsProvider=new re("editorHasInlayHintsProvider",!1,p("editorHasInlayHintsProvider","Whether the editor has an inline hints provider")),o.hasDocumentFormattingProvider=new re("editorHasDocumentFormattingProvider",!1,p("editorHasDocumentFormattingProvider","Whether the editor has a document formatting provider")),o.hasDocumentSelectionFormattingProvider=new re("editorHasDocumentSelectionFormattingProvider",!1,p("editorHasDocumentSelectionFormattingProvider","Whether the editor has a document selection formatting provider")),o.hasMultipleDocumentFormattingProvider=new re("editorHasMultipleDocumentFormattingProvider",!1,p("editorHasMultipleDocumentFormattingProvider","Whether the editor has multiple document formatting providers")),o.hasMultipleDocumentSelectionFormattingProvider=new re("editorHasMultipleDocumentSelectionFormattingProvider",!1,p("editorHasMultipleDocumentSelectionFormattingProvider","Whether the editor has multiple document selection formatting providers"))})(T||(T={}));const mt=0;class _i extends Hi{runEditorCommand(e,t,i){const n=t._getViewModel();n&&this.runCoreEditorCommand(n,i||{})}}var Cn;(function(o){const e=function(i){if(!nn(i))return!1;const n=i;return!(!Ds(n.to)||!Zn(n.by)&&!Ds(n.by)||!Zn(n.value)&&!Lh(n.value)||!Zn(n.revealCursor)&&!K6(n.revealCursor))};o.metadata={description:"Scroll editor in the given direction",args:[{name:"Editor scroll argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'to': A mandatory direction value.\n						```\n						'up', 'down'\n						```\n					* 'by': Unit to move. Default is computed based on 'to' value.\n						```\n						'line', 'wrappedLine', 'page', 'halfPage', 'editor'\n						```\n					* 'value': Number of units to move. Default is '1'.\n					* 'revealCursor': If 'true' reveals the cursor if it is outside view port.\n				",constraint:e,schema:{type:"object",required:["to"],properties:{to:{type:"string",enum:["up","down"]},by:{type:"string",enum:["line","wrappedLine","page","halfPage","editor"]},value:{type:"number",default:1},revealCursor:{type:"boolean"}}}}]},o.RawDirection={Up:"up",Right:"right",Down:"down",Left:"left"},o.RawUnit={Line:"line",WrappedLine:"wrappedLine",Page:"page",HalfPage:"halfPage",Editor:"editor",Column:"column"};function t(i){let n;switch(i.to){case o.RawDirection.Up:n=1;break;case o.RawDirection.Right:n=2;break;case o.RawDirection.Down:n=3;break;case o.RawDirection.Left:n=4;break;default:return null}let s;switch(i.by){case o.RawUnit.Line:s=1;break;case o.RawUnit.WrappedLine:s=2;break;case o.RawUnit.Page:s=3;break;case o.RawUnit.HalfPage:s=4;break;case o.RawUnit.Editor:s=5;break;case o.RawUnit.Column:s=6;break;default:s=2}const r=Math.floor(i.value||1),a=!!i.revealCursor;return{direction:n,unit:s,value:r,revealCursor:a,select:!!i.select}}o.parse=t})(Cn||(Cn={}));var im;(function(o){const e=function(t){if(!nn(t))return!1;const i=t;return!(!Lh(i.lineNumber)&&!Ds(i.lineNumber)||!Zn(i.at)&&!Ds(i.at))};o.metadata={description:"Reveal the given line at the given logical position",args:[{name:"Reveal line argument object",description:"Property-value pairs that can be passed through this argument:\n					* 'lineNumber': A mandatory line number value.\n					* 'at': Logical position at which line has to be revealed.\n						```\n						'top', 'center', 'bottom'\n						```\n				",constraint:e,schema:{type:"object",required:["lineNumber"],properties:{lineNumber:{type:["number","string"]},at:{type:"string",enum:["top","center","bottom"]}}}}]},o.RawAtArgument={Top:"top",Center:"center",Bottom:"bottom"}})(im||(im={}));class qM{constructor(e){e.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(gt).getFocusedCodeEditor();return n&&n.hasTextFocus()?this._runEditorCommand(t,n,i):!1}),e.addImplementation(1e3,"generic-dom-input-textarea",(t,i)=>{const n=Ln();return n&&["input","textarea"].indexOf(n.tagName.toLowerCase())>=0?(this.runDOMCommand(n),!0):!1}),e.addImplementation(0,"generic-dom",(t,i)=>{const n=t.get(gt).getActiveCodeEditor();return n?(n.focus(),this._runEditorCommand(t,n,i)):!1})}_runEditorCommand(e,t,i){const n=this.runEditorCommand(e,t,i);return n||!0}}var Qi;(function(o){class e extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){if(!y.position)return;v.model.pushStackElement(),v.setCursorStates(y.source,3,[dn.moveTo(v,v.getPrimaryCursorState(),this._inSelectionMode,y.position,y.viewPosition)])&&y.revealType!==2&&v.revealAllCursors(y.source,!0,!0)}}o.MoveTo=oe(new e({id:"_moveTo",inSelectionMode:!1,precondition:void 0})),o.MoveToSelect=oe(new e({id:"_moveToSelect",inSelectionMode:!0,precondition:void 0}));class t extends _i{runCoreEditorCommand(v,y){v.model.pushStackElement();const C=this._getColumnSelectResult(v,v.getPrimaryCursorState(),v.getCursorColumnSelectData(),y);C!==null&&(v.setCursorStates(y.source,3,C.viewStates.map(w=>ht.fromViewState(w))),v.setCursorColumnSelectData({isReal:!0,fromViewLineNumber:C.fromLineNumber,fromViewVisualColumn:C.fromVisualColumn,toViewLineNumber:C.toLineNumber,toViewVisualColumn:C.toVisualColumn}),C.reversed?v.revealTopMostCursor(y.source):v.revealBottomMostCursor(y.source))}}o.ColumnSelect=oe(new class extends t{constructor(){super({id:"columnSelect",precondition:void 0})}_getColumnSelectResult(b,v,y,C){if(typeof C.position>"u"||typeof C.viewPosition>"u"||typeof C.mouseColumn>"u")return null;const w=b.model.validatePosition(C.position),x=b.coordinatesConverter.validateViewPosition(new A(C.viewPosition.lineNumber,C.viewPosition.column),w),k=C.doColumnSelect?y.fromViewLineNumber:x.lineNumber,E=C.doColumnSelect?y.fromViewVisualColumn:C.mouseColumn-1;return zu.columnSelect(b.cursorConfig,b,k,E,x.lineNumber,C.mouseColumn-1)}}),o.CursorColumnSelectLeft=oe(new class extends t{constructor(){super({id:"cursorColumnSelectLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3599,linux:{primary:0}}})}_getColumnSelectResult(b,v,y,C){return zu.columnSelectLeft(b.cursorConfig,b,y)}}),o.CursorColumnSelectRight=oe(new class extends t{constructor(){super({id:"cursorColumnSelectRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3601,linux:{primary:0}}})}_getColumnSelectResult(b,v,y,C){return zu.columnSelectRight(b.cursorConfig,b,y)}});class i extends t{constructor(v){super(v),this._isPaged=v.isPaged}_getColumnSelectResult(v,y,C,w){return zu.columnSelectUp(v.cursorConfig,v,C,this._isPaged)}}o.CursorColumnSelectUp=oe(new i({isPaged:!1,id:"cursorColumnSelectUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3600,linux:{primary:0}}})),o.CursorColumnSelectPageUp=oe(new i({isPaged:!0,id:"cursorColumnSelectPageUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3595,linux:{primary:0}}}));class n extends t{constructor(v){super(v),this._isPaged=v.isPaged}_getColumnSelectResult(v,y,C,w){return zu.columnSelectDown(v.cursorConfig,v,C,this._isPaged)}}o.CursorColumnSelectDown=oe(new n({isPaged:!1,id:"cursorColumnSelectDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3602,linux:{primary:0}}})),o.CursorColumnSelectPageDown=oe(new n({isPaged:!0,id:"cursorColumnSelectPageDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3596,linux:{primary:0}}}));class s extends _i{constructor(){super({id:"cursorMove",precondition:void 0,metadata:Xx.metadata})}runCoreEditorCommand(v,y){const C=Xx.parse(y);C&&this._runCursorMove(v,y.source,C)}_runCursorMove(v,y,C){v.model.pushStackElement(),v.setCursorStates(y,3,s._move(v,v.getCursorStates(),C)),v.revealAllCursors(y,!0)}static _move(v,y,C){const w=C.select,x=C.value;switch(C.direction){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:return dn.simpleMove(v,y,C.direction,w,x,C.unit);case 11:case 13:case 12:case 14:return dn.viewportMove(v,y,C.direction,w,x);default:return null}}}o.CursorMoveImpl=s,o.CursorMove=oe(new s);class r extends _i{constructor(v){super(v),this._staticArgs=v.args}runCoreEditorCommand(v,y){let C=this._staticArgs;this._staticArgs.value===-1&&(C={direction:this._staticArgs.direction,unit:this._staticArgs.unit,select:this._staticArgs.select,value:y.pageSize||v.cursorConfig.pageSize}),v.model.pushStackElement(),v.setCursorStates(y.source,3,dn.simpleMove(v,v.getCursorStates(),C.direction,C.select,C.value,C.unit)),v.revealAllCursors(y.source,!0)}}o.CursorLeft=oe(new r({args:{direction:0,unit:0,select:!1,value:1},id:"cursorLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:15,mac:{primary:15,secondary:[288]}}})),o.CursorLeftSelect=oe(new r({args:{direction:0,unit:0,select:!0,value:1},id:"cursorLeftSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1039}})),o.CursorRight=oe(new r({args:{direction:1,unit:0,select:!1,value:1},id:"cursorRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:17,mac:{primary:17,secondary:[292]}}})),o.CursorRightSelect=oe(new r({args:{direction:1,unit:0,select:!0,value:1},id:"cursorRightSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1041}})),o.CursorUp=oe(new r({args:{direction:2,unit:2,select:!1,value:1},id:"cursorUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:16,mac:{primary:16,secondary:[302]}}})),o.CursorUpSelect=oe(new r({args:{direction:2,unit:2,select:!0,value:1},id:"cursorUpSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1040,secondary:[3088],mac:{primary:1040},linux:{primary:1040}}})),o.CursorPageUp=oe(new r({args:{direction:2,unit:2,select:!1,value:-1},id:"cursorPageUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:11}})),o.CursorPageUpSelect=oe(new r({args:{direction:2,unit:2,select:!0,value:-1},id:"cursorPageUpSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1035}})),o.CursorDown=oe(new r({args:{direction:3,unit:2,select:!1,value:1},id:"cursorDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:18,mac:{primary:18,secondary:[300]}}})),o.CursorDownSelect=oe(new r({args:{direction:3,unit:2,select:!0,value:1},id:"cursorDownSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1042,secondary:[3090],mac:{primary:1042},linux:{primary:1042}}})),o.CursorPageDown=oe(new r({args:{direction:3,unit:2,select:!1,value:-1},id:"cursorPageDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:12}})),o.CursorPageDownSelect=oe(new r({args:{direction:3,unit:2,select:!0,value:-1},id:"cursorPageDownSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1036}})),o.CreateCursor=oe(new class extends _i{constructor(){super({id:"createCursor",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;let y;v.wholeLine?y=dn.line(b,b.getPrimaryCursorState(),!1,v.position,v.viewPosition):y=dn.moveTo(b,b.getPrimaryCursorState(),!1,v.position,v.viewPosition);const C=b.getCursorStates();if(C.length>1){const w=y.modelState?y.modelState.position:null,x=y.viewState?y.viewState.position:null;for(let k=0,E=C.length;k<E;k++){const N=C[k];if(!(w&&!N.modelState.selection.containsPosition(w))&&!(x&&!N.viewState.selection.containsPosition(x))){C.splice(k,1),b.model.pushStackElement(),b.setCursorStates(v.source,3,C);return}}}C.push(y),b.model.pushStackElement(),b.setCursorStates(v.source,3,C)}}),o.LastCursorMoveToSelect=oe(new class extends _i{constructor(){super({id:"_lastCursorMoveToSelect",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;const y=b.getLastAddedCursorIndex(),C=b.getCursorStates(),w=C.slice(0);w[y]=dn.moveTo(b,C[y],!0,v.position,v.viewPosition),b.model.pushStackElement(),b.setCursorStates(v.source,3,w)}});class a extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){v.model.pushStackElement(),v.setCursorStates(y.source,3,dn.moveToBeginningOfLine(v,v.getCursorStates(),this._inSelectionMode)),v.revealAllCursors(y.source,!0)}}o.CursorHome=oe(new a({inSelectionMode:!1,id:"cursorHome",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:14,mac:{primary:14,secondary:[2063]}}})),o.CursorHomeSelect=oe(new a({inSelectionMode:!0,id:"cursorHomeSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1038,mac:{primary:1038,secondary:[3087]}}}));class l extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){v.model.pushStackElement(),v.setCursorStates(y.source,3,this._exec(v.getCursorStates())),v.revealAllCursors(y.source,!0)}_exec(v){const y=[];for(let C=0,w=v.length;C<w;C++){const x=v[C],k=x.modelState.position.lineNumber;y[C]=ht.fromModelState(x.modelState.move(this._inSelectionMode,k,1,0))}return y}}o.CursorLineStart=oe(new l({inSelectionMode:!1,id:"cursorLineStart",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:0,mac:{primary:287}}})),o.CursorLineStartSelect=oe(new l({inSelectionMode:!0,id:"cursorLineStartSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:0,mac:{primary:1311}}}));class c extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){v.model.pushStackElement(),v.setCursorStates(y.source,3,dn.moveToEndOfLine(v,v.getCursorStates(),this._inSelectionMode,y.sticky||!1)),v.revealAllCursors(y.source,!0)}}o.CursorEnd=oe(new c({inSelectionMode:!1,id:"cursorEnd",precondition:void 0,kbOpts:{args:{sticky:!1},weight:mt,kbExpr:T.textInputFocus,primary:13,mac:{primary:13,secondary:[2065]}},metadata:{description:"Go to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}})),o.CursorEndSelect=oe(new c({inSelectionMode:!0,id:"cursorEndSelect",precondition:void 0,kbOpts:{args:{sticky:!1},weight:mt,kbExpr:T.textInputFocus,primary:1037,mac:{primary:1037,secondary:[3089]}},metadata:{description:"Select to End",args:[{name:"args",schema:{type:"object",properties:{sticky:{description:p("stickydesc","Stick to the end even when going to longer lines"),type:"boolean",default:!1}}}}]}}));class d extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){v.model.pushStackElement(),v.setCursorStates(y.source,3,this._exec(v,v.getCursorStates())),v.revealAllCursors(y.source,!0)}_exec(v,y){const C=[];for(let w=0,x=y.length;w<x;w++){const k=y[w],E=k.modelState.position.lineNumber,N=v.model.getLineMaxColumn(E);C[w]=ht.fromModelState(k.modelState.move(this._inSelectionMode,E,N,0))}return C}}o.CursorLineEnd=oe(new d({inSelectionMode:!1,id:"cursorLineEnd",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:0,mac:{primary:291}}})),o.CursorLineEndSelect=oe(new d({inSelectionMode:!0,id:"cursorLineEndSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:0,mac:{primary:1315}}}));class h extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){v.model.pushStackElement(),v.setCursorStates(y.source,3,dn.moveToBeginningOfBuffer(v,v.getCursorStates(),this._inSelectionMode)),v.revealAllCursors(y.source,!0)}}o.CursorTop=oe(new h({inSelectionMode:!1,id:"cursorTop",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:2062,mac:{primary:2064}}})),o.CursorTopSelect=oe(new h({inSelectionMode:!0,id:"cursorTopSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3086,mac:{primary:3088}}}));class u extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){v.model.pushStackElement(),v.setCursorStates(y.source,3,dn.moveToEndOfBuffer(v,v.getCursorStates(),this._inSelectionMode)),v.revealAllCursors(y.source,!0)}}o.CursorBottom=oe(new u({inSelectionMode:!1,id:"cursorBottom",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:2061,mac:{primary:2066}}})),o.CursorBottomSelect=oe(new u({inSelectionMode:!0,id:"cursorBottomSelect",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:3085,mac:{primary:3090}}}));class g extends _i{constructor(){super({id:"editorScroll",precondition:void 0,metadata:Cn.metadata})}determineScrollMethod(v){const y=[6],C=[1,2,3,4,5,6],w=[4,2],x=[1,3];return y.includes(v.unit)&&w.includes(v.direction)?this._runHorizontalEditorScroll.bind(this):C.includes(v.unit)&&x.includes(v.direction)?this._runVerticalEditorScroll.bind(this):null}runCoreEditorCommand(v,y){const C=Cn.parse(y);if(!C)return;const w=this.determineScrollMethod(C);w&&w(v,y.source,C)}_runVerticalEditorScroll(v,y,C){const w=this._computeDesiredScrollTop(v,C);if(C.revealCursor){const x=v.getCompletelyVisibleViewRangeAtScrollTop(w);v.setCursorStates(y,3,[dn.findPositionInViewportIfOutside(v,v.getPrimaryCursorState(),x,C.select)])}v.viewLayout.setScrollPosition({scrollTop:w},0)}_computeDesiredScrollTop(v,y){if(y.unit===1){const x=v.viewLayout.getFutureViewport(),k=v.getCompletelyVisibleViewRangeAtScrollTop(x.top),E=v.coordinatesConverter.convertViewRangeToModelRange(k);let N;y.direction===1?N=Math.max(1,E.startLineNumber-y.value):N=Math.min(v.model.getLineCount(),E.startLineNumber+y.value);const z=v.coordinatesConverter.convertModelPositionToViewPosition(new A(N,1));return v.viewLayout.getVerticalOffsetForLineNumber(z.lineNumber)}if(y.unit===5){let x=0;return y.direction===3&&(x=v.model.getLineCount()-v.cursorConfig.pageSize),v.viewLayout.getVerticalOffsetForLineNumber(x)}let C;y.unit===3?C=v.cursorConfig.pageSize*y.value:y.unit===4?C=Math.round(v.cursorConfig.pageSize/2)*y.value:C=y.value;const w=(y.direction===1?-1:1)*C;return v.viewLayout.getCurrentScrollTop()+w*v.cursorConfig.lineHeight}_runHorizontalEditorScroll(v,y,C){const w=this._computeDesiredScrollLeft(v,C);v.viewLayout.setScrollPosition({scrollLeft:w},0)}_computeDesiredScrollLeft(v,y){const C=(y.direction===4?-1:1)*y.value;return v.viewLayout.getCurrentScrollLeft()+C*v.cursorConfig.typicalHalfwidthCharacterWidth}}o.EditorScrollImpl=g,o.EditorScroll=oe(new g),o.ScrollLineUp=oe(new class extends _i{constructor(){super({id:"scrollLineUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:2064,mac:{primary:267}}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Up,by:Cn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:v.source})}}),o.ScrollPageUp=oe(new class extends _i{constructor(){super({id:"scrollPageUp",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:2059,win:{primary:523},linux:{primary:523}}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Up,by:Cn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:v.source})}}),o.ScrollEditorTop=oe(new class extends _i{constructor(){super({id:"scrollEditorTop",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Up,by:Cn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:v.source})}}),o.ScrollLineDown=oe(new class extends _i{constructor(){super({id:"scrollLineDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:2066,mac:{primary:268}}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Down,by:Cn.RawUnit.WrappedLine,value:1,revealCursor:!1,select:!1,source:v.source})}}),o.ScrollPageDown=oe(new class extends _i{constructor(){super({id:"scrollPageDown",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:2060,win:{primary:524},linux:{primary:524}}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Down,by:Cn.RawUnit.Page,value:1,revealCursor:!1,select:!1,source:v.source})}}),o.ScrollEditorBottom=oe(new class extends _i{constructor(){super({id:"scrollEditorBottom",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Down,by:Cn.RawUnit.Editor,value:1,revealCursor:!1,select:!1,source:v.source})}}),o.ScrollLeft=oe(new class extends _i{constructor(){super({id:"scrollLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Left,by:Cn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:v.source})}}),o.ScrollRight=oe(new class extends _i{constructor(){super({id:"scrollRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus}})}runCoreEditorCommand(b,v){o.EditorScroll.runCoreEditorCommand(b,{to:Cn.RawDirection.Right,by:Cn.RawUnit.Column,value:2,revealCursor:!1,select:!1,source:v.source})}});class f extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){y.position&&(v.model.pushStackElement(),v.setCursorStates(y.source,3,[dn.word(v,v.getPrimaryCursorState(),this._inSelectionMode,y.position)]),y.revealType!==2&&v.revealAllCursors(y.source,!0,!0))}}o.WordSelect=oe(new f({inSelectionMode:!1,id:"_wordSelect",precondition:void 0})),o.WordSelectDrag=oe(new f({inSelectionMode:!0,id:"_wordSelectDrag",precondition:void 0})),o.LastCursorWordSelect=oe(new class extends _i{constructor(){super({id:"lastCursorWordSelect",precondition:void 0})}runCoreEditorCommand(b,v){if(!v.position)return;const y=b.getLastAddedCursorIndex(),C=b.getCursorStates(),w=C.slice(0),x=C[y];w[y]=dn.word(b,x,x.modelState.hasSelection(),v.position),b.model.pushStackElement(),b.setCursorStates(v.source,3,w)}});class m extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){y.position&&(v.model.pushStackElement(),v.setCursorStates(y.source,3,[dn.line(v,v.getPrimaryCursorState(),this._inSelectionMode,y.position,y.viewPosition)]),y.revealType!==2&&v.revealAllCursors(y.source,!1,!0))}}o.LineSelect=oe(new m({inSelectionMode:!1,id:"_lineSelect",precondition:void 0})),o.LineSelectDrag=oe(new m({inSelectionMode:!0,id:"_lineSelectDrag",precondition:void 0}));class _ extends _i{constructor(v){super(v),this._inSelectionMode=v.inSelectionMode}runCoreEditorCommand(v,y){if(!y.position)return;const C=v.getLastAddedCursorIndex(),w=v.getCursorStates(),x=w.slice(0);x[C]=dn.line(v,w[C],this._inSelectionMode,y.position,y.viewPosition),v.model.pushStackElement(),v.setCursorStates(y.source,3,x)}}o.LastCursorLineSelect=oe(new _({inSelectionMode:!1,id:"lastCursorLineSelect",precondition:void 0})),o.LastCursorLineSelectDrag=oe(new _({inSelectionMode:!0,id:"lastCursorLineSelectDrag",precondition:void 0})),o.CancelSelection=oe(new class extends _i{constructor(){super({id:"cancelSelection",precondition:T.hasNonEmptySelection,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates(v.source,3,[dn.cancelSelection(b,b.getPrimaryCursorState())]),b.revealAllCursors(v.source,!0)}}),o.RemoveSecondaryCursors=oe(new class extends _i{constructor(){super({id:"removeSecondaryCursors",precondition:T.hasMultipleSelections,kbOpts:{weight:mt+1,kbExpr:T.textInputFocus,primary:9,secondary:[1033]}})}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates(v.source,3,[b.getPrimaryCursorState()]),b.revealAllCursors(v.source,!0),Rl(p("removedCursor","Removed secondary cursors"))}}),o.RevealLine=oe(new class extends _i{constructor(){super({id:"revealLine",precondition:void 0,metadata:im.metadata})}runCoreEditorCommand(b,v){const y=v,C=y.lineNumber||0;let w=typeof C=="number"?C+1:parseInt(C)+1;w<1&&(w=1);const x=b.model.getLineCount();w>x&&(w=x);const k=new L(w,1,w,b.model.getLineMaxColumn(w));let E=0;if(y.at)switch(y.at){case im.RawAtArgument.Top:E=3;break;case im.RawAtArgument.Center:E=1;break;case im.RawAtArgument.Bottom:E=4;break}const N=b.coordinatesConverter.convertModelRangeToViewRange(k);b.revealRange(v.source,!1,N,E,0)}}),o.SelectAll=new class extends qM{constructor(){super($ee)}runDOMCommand(b){dr&&(b.focus(),b.select()),b.ownerDocument.execCommand("selectAll")}runEditorCommand(b,v,y){const C=v._getViewModel();C&&this.runCoreEditorCommand(C,y)}runCoreEditorCommand(b,v){b.model.pushStackElement(),b.setCursorStates("keyboard",3,[dn.selectAll(b,b.getPrimaryCursorState())])}},o.SetSelection=oe(new class extends _i{constructor(){super({id:"setSelection",precondition:void 0})}runCoreEditorCommand(b,v){v.selection&&(b.model.pushStackElement(),b.setCursorStates(v.source,3,[ht.fromModelSelection(v.selection)]))}})})(Qi||(Qi={}));const ime=K.and(T.textInputFocus,T.columnSelection);function Cb(o,e){fs.registerKeybindingRule({id:o,primary:e,when:ime,weight:mt+1})}Cb(Qi.CursorColumnSelectLeft.id,1039);Cb(Qi.CursorColumnSelectRight.id,1041);Cb(Qi.CursorColumnSelectUp.id,1040);Cb(Qi.CursorColumnSelectPageUp.id,1035);Cb(Qi.CursorColumnSelectDown.id,1042);Cb(Qi.CursorColumnSelectPageDown.id,1036);function n9(o){return o.register(),o}var Zm;(function(o){class e extends Hi{runEditorCommand(i,n,s){const r=n._getViewModel();r&&this.runCoreEditingCommand(n,r,s||{})}}o.CoreEditingCommand=e,o.LineBreakInsert=oe(new class extends e{constructor(){super({id:"lineBreakInsert",precondition:T.writable,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:0,mac:{primary:301}}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,rD.lineBreakInsert(i.cursorConfig,i.model,i.getCursorStates().map(s=>s.modelState.selection)))}}),o.Outdent=oe(new class extends e{constructor(){super({id:"outdent",precondition:T.writable,kbOpts:{weight:mt,kbExpr:K.and(T.editorTextFocus,T.tabDoesNotMoveFocus),primary:1026}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Fd.outdent(i.cursorConfig,i.model,i.getCursorStates().map(s=>s.modelState.selection))),t.pushUndoStop()}}),o.Tab=oe(new class extends e{constructor(){super({id:"tab",precondition:T.writable,kbOpts:{weight:mt,kbExpr:K.and(T.editorTextFocus,T.tabDoesNotMoveFocus),primary:2}})}runCoreEditingCommand(t,i,n){t.pushUndoStop(),t.executeCommands(this.id,Fd.tab(i.cursorConfig,i.model,i.getCursorStates().map(s=>s.modelState.selection))),t.pushUndoStop()}}),o.DeleteLeft=oe(new class extends e{constructor(){super({id:"deleteLeft",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:1,secondary:[1025],mac:{primary:1,secondary:[1025,294,257]}}})}runCoreEditingCommand(t,i,n){const[s,r]=If.deleteLeft(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection),i.getCursorAutoClosedCharacters());s&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(2)}}),o.DeleteRight=oe(new class extends e{constructor(){super({id:"deleteRight",precondition:void 0,kbOpts:{weight:mt,kbExpr:T.textInputFocus,primary:20,mac:{primary:20,secondary:[290,276]}}})}runCoreEditingCommand(t,i,n){const[s,r]=If.deleteRight(i.getPrevEditOperationType(),i.cursorConfig,i.model,i.getCursorStates().map(a=>a.modelState.selection));s&&t.pushUndoStop(),t.executeCommands(this.id,r),i.setPrevEditOperationType(3)}}),o.Undo=new class extends qM{constructor(){super(uU)}runDOMCommand(t){t.ownerDocument.execCommand("undo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(92)===!0))return i.getModel().undo()}},o.Redo=new class extends qM{constructor(){super(gU)}runDOMCommand(t){t.ownerDocument.execCommand("redo")}runEditorCommand(t,i,n){if(!(!i.hasModel()||i.getOption(92)===!0))return i.getModel().redo()}}})(Zm||(Zm={}));class s9 extends bT{constructor(e,t,i){super({id:e,precondition:void 0,metadata:i}),this._handlerId=t}runCommand(e,t){const i=e.get(gt).getFocusedCodeEditor();i&&i.trigger("keyboard",this._handlerId,t)}}function ep(o,e){n9(new s9("default:"+o,o)),n9(new s9(o,o,e))}ep("type",{description:"Type",args:[{name:"args",schema:{type:"object",required:["text"],properties:{text:{type:"string"}}}}]});ep("replacePreviousChar");ep("compositionType");ep("compositionStart");ep("compositionEnd");ep("paste");ep("cut");class nme{constructor(e,t,i,n){this.configuration=e,this.viewModel=t,this.userInputEvents=i,this.commandDelegate=n}paste(e,t,i,n){this.commandDelegate.paste(e,t,i,n)}type(e){this.commandDelegate.type(e)}compositionType(e,t,i,n){this.commandDelegate.compositionType(e,t,i,n)}compositionStart(){this.commandDelegate.startComposition()}compositionEnd(){this.commandDelegate.endComposition()}cut(){this.commandDelegate.cut()}setSelection(e){Qi.SetSelection.runCoreEditorCommand(this.viewModel,{source:"keyboard",selection:e})}_validateViewColumn(e){const t=this.viewModel.getLineMinColumn(e.lineNumber);return e.column<t?new A(e.lineNumber,t):e}_hasMulticursorModifier(e){switch(this.configuration.options.get(78)){case"altKey":return e.altKey;case"ctrlKey":return e.ctrlKey;case"metaKey":return e.metaKey;default:return!1}}_hasNonMulticursorModifier(e){switch(this.configuration.options.get(78)){case"altKey":return e.ctrlKey||e.metaKey;case"ctrlKey":return e.altKey||e.metaKey;case"metaKey":return e.ctrlKey||e.altKey;default:return!1}}dispatchMouse(e){const t=this.configuration.options,i=us&&t.get(108),n=t.get(22);e.middleButton&&!i?this._columnSelect(e.position,e.mouseColumn,e.inSelectionMode):e.startedOnLineNumbers?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelect(e.position,e.revealType):this._createCursor(e.position,!0):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount>=4?this._selectAll():e.mouseDownCount===3?this._hasMulticursorModifier(e)?e.inSelectionMode?this._lastCursorLineSelectDrag(e.position,e.revealType):this._lastCursorLineSelect(e.position,e.revealType):e.inSelectionMode?this._lineSelectDrag(e.position,e.revealType):this._lineSelect(e.position,e.revealType):e.mouseDownCount===2?e.onInjectedText||(this._hasMulticursorModifier(e)?this._lastCursorWordSelect(e.position,e.revealType):e.inSelectionMode?this._wordSelectDrag(e.position,e.revealType):this._wordSelect(e.position,e.revealType)):this._hasMulticursorModifier(e)?this._hasNonMulticursorModifier(e)||(e.shiftKey?this._columnSelect(e.position,e.mouseColumn,!0):e.inSelectionMode?this._lastCursorMoveToSelect(e.position,e.revealType):this._createCursor(e.position,!1)):e.inSelectionMode?e.altKey?this._columnSelect(e.position,e.mouseColumn,!0):n?this._columnSelect(e.position,e.mouseColumn,!0):this._moveToSelect(e.position,e.revealType):this.moveTo(e.position,e.revealType)}_usualArgs(e,t){return e=this._validateViewColumn(e),{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,revealType:t}}moveTo(e,t){Qi.MoveTo.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_moveToSelect(e,t){Qi.MoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_columnSelect(e,t,i){e=this._validateViewColumn(e),Qi.ColumnSelect.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,mouseColumn:t,doColumnSelect:i})}_createCursor(e,t){e=this._validateViewColumn(e),Qi.CreateCursor.runCoreEditorCommand(this.viewModel,{source:"mouse",position:this._convertViewToModelPosition(e),viewPosition:e,wholeLine:t})}_lastCursorMoveToSelect(e,t){Qi.LastCursorMoveToSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelect(e,t){Qi.WordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_wordSelectDrag(e,t){Qi.WordSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorWordSelect(e,t){Qi.LastCursorWordSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelect(e,t){Qi.LineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lineSelectDrag(e,t){Qi.LineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelect(e,t){Qi.LastCursorLineSelect.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_lastCursorLineSelectDrag(e,t){Qi.LastCursorLineSelectDrag.runCoreEditorCommand(this.viewModel,this._usualArgs(e,t))}_selectAll(){Qi.SelectAll.runCoreEditorCommand(this.viewModel,{source:"mouse"})}_convertViewToModelPosition(e){return this.viewModel.coordinatesConverter.convertViewPositionToModelPosition(e)}emitKeyDown(e){this.userInputEvents.emitKeyDown(e)}emitKeyUp(e){this.userInputEvents.emitKeyUp(e)}emitContextMenu(e){this.userInputEvents.emitContextMenu(e)}emitMouseMove(e){this.userInputEvents.emitMouseMove(e)}emitMouseLeave(e){this.userInputEvents.emitMouseLeave(e)}emitMouseUp(e){this.userInputEvents.emitMouseUp(e)}emitMouseDown(e){this.userInputEvents.emitMouseDown(e)}emitMouseDrag(e){this.userInputEvents.emitMouseDrag(e)}emitMouseDrop(e){this.userInputEvents.emitMouseDrop(e)}emitMouseDropCanceled(){this.userInputEvents.emitMouseDropCanceled()}emitMouseWheel(e){this.userInputEvents.emitMouseWheel(e)}}class qK{constructor(e){this._lineFactory=e,this._set(1,[])}flush(){this._set(1,[])}_set(e,t){this._lines=t,this._rendLineNumberStart=e}_get(){return{rendLineNumberStart:this._rendLineNumberStart,lines:this._lines}}getStartLineNumber(){return this._rendLineNumberStart}getEndLineNumber(){return this._rendLineNumberStart+this._lines.length-1}getCount(){return this._lines.length}getLine(e){const t=e-this._rendLineNumberStart;if(t<0||t>=this._lines.length)throw new pt("Illegal value for lineNumber");return this._lines[t]}onLinesDeleted(e,t){if(this.getCount()===0)return null;const i=this.getStartLineNumber(),n=this.getEndLineNumber();if(t<i){const l=t-e+1;return this._rendLineNumberStart-=l,null}if(e>n)return null;let s=0,r=0;for(let l=i;l<=n;l++){const c=l-this._rendLineNumberStart;e<=l&&l<=t&&(r===0?(s=c,r=1):r++)}if(e<i){let l=0;t<i?l=t-e+1:l=i-e,this._rendLineNumberStart-=l}return this._lines.splice(s,r)}onLinesChanged(e,t){const i=e+t-1;if(this.getCount()===0)return!1;const n=this.getStartLineNumber(),s=this.getEndLineNumber();let r=!1;for(let a=e;a<=i;a++)a>=n&&a<=s&&(this._lines[a-this._rendLineNumberStart].onContentChanged(),r=!0);return r}onLinesInserted(e,t){if(this.getCount()===0)return null;const i=t-e+1,n=this.getStartLineNumber(),s=this.getEndLineNumber();if(e<=n)return this._rendLineNumberStart+=i,null;if(e>s)return null;if(i+e>s)return this._lines.splice(e-this._rendLineNumberStart,s-e+1);const r=[];for(let h=0;h<i;h++)r[h]=this._lineFactory.createLine();const a=e-this._rendLineNumberStart,l=this._lines.slice(0,a),c=this._lines.slice(a,this._lines.length-i),d=this._lines.slice(this._lines.length-i,this._lines.length);return this._lines=l.concat(r).concat(c),d}onTokensChanged(e){if(this.getCount()===0)return!1;const t=this.getStartLineNumber(),i=this.getEndLineNumber();let n=!1;for(let s=0,r=e.length;s<r;s++){const a=e[s];if(a.toLineNumber<t||a.fromLineNumber>i)continue;const l=Math.max(t,a.fromLineNumber),c=Math.min(i,a.toLineNumber);for(let d=l;d<=c;d++){const h=d-this._rendLineNumberStart;this._lines[h].onTokensChanged(),n=!0}}return n}}class ZK{constructor(e){this._lineFactory=e,this.domNode=this._createDomNode(),this._linesCollection=new qK(this._lineFactory)}_createDomNode(){const e=bt(document.createElement("div"));return e.setClassName("view-layer"),e.setPosition("absolute"),e.domNode.setAttribute("role","presentation"),e.domNode.setAttribute("aria-hidden","true"),e}onConfigurationChanged(e){return!!e.hasChanged(146)}onFlushed(e){return this._linesCollection.flush(),!0}onLinesChanged(e){return this._linesCollection.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){const t=this._linesCollection.onLinesDeleted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++)t[i].getDomNode()?.remove();return!0}onLinesInserted(e){const t=this._linesCollection.onLinesInserted(e.fromLineNumber,e.toLineNumber);if(t)for(let i=0,n=t.length;i<n;i++)t[i].getDomNode()?.remove();return!0}onScrollChanged(e){return e.scrollTopChanged}onTokensChanged(e){return this._linesCollection.onTokensChanged(e.ranges)}onZonesChanged(e){return!0}getStartLineNumber(){return this._linesCollection.getStartLineNumber()}getEndLineNumber(){return this._linesCollection.getEndLineNumber()}getVisibleLine(e){return this._linesCollection.getLine(e)}renderLines(e){const t=this._linesCollection._get(),i=new ZM(this.domNode.domNode,this._lineFactory,e),n={rendLineNumberStart:t.rendLineNumberStart,lines:t.lines,linesLength:t.lines.length},s=i.render(n,e.startLineNumber,e.endLineNumber,e.relativeVerticalOffset);this._linesCollection._set(s.rendLineNumberStart,s.lines)}}const uc=class uc{constructor(e,t,i){this._domNode=e,this._lineFactory=t,this._viewportData=i}render(e,t,i,n){const s={rendLineNumberStart:e.rendLineNumberStart,lines:e.lines.slice(0),linesLength:e.linesLength};if(s.rendLineNumberStart+s.linesLength-1<t||i<s.rendLineNumberStart){s.rendLineNumberStart=t,s.linesLength=i-t+1,s.lines=[];for(let r=t;r<=i;r++)s.lines[r-t]=this._lineFactory.createLine();return this._finishRendering(s,!0,n),s}if(this._renderUntouchedLines(s,Math.max(t-s.rendLineNumberStart,0),Math.min(i-s.rendLineNumberStart,s.linesLength-1),n,t),s.rendLineNumberStart>t){const r=t,a=Math.min(i,s.rendLineNumberStart-1);r<=a&&(this._insertLinesBefore(s,r,a,n,t),s.linesLength+=a-r+1)}else if(s.rendLineNumberStart<t){const r=Math.min(s.linesLength,t-s.rendLineNumberStart);r>0&&(this._removeLinesBefore(s,r),s.linesLength-=r)}if(s.rendLineNumberStart=t,s.rendLineNumberStart+s.linesLength-1<i){const r=s.rendLineNumberStart+s.linesLength,a=i;r<=a&&(this._insertLinesAfter(s,r,a,n,t),s.linesLength+=a-r+1)}else if(s.rendLineNumberStart+s.linesLength-1>i){const r=Math.max(0,i-s.rendLineNumberStart+1),l=s.linesLength-1-r+1;l>0&&(this._removeLinesAfter(s,l),s.linesLength-=l)}return this._finishRendering(s,!1,n),s}_renderUntouchedLines(e,t,i,n,s){const r=e.rendLineNumberStart,a=e.lines;for(let l=t;l<=i;l++){const c=r+l;a[l].layoutLine(c,n[c-s],this._viewportData.lineHeight)}}_insertLinesBefore(e,t,i,n,s){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this._lineFactory.createLine();e.lines=r.concat(e.lines)}_removeLinesBefore(e,t){for(let i=0;i<t;i++)e.lines[i].getDomNode()?.remove();e.lines.splice(0,t)}_insertLinesAfter(e,t,i,n,s){const r=[];let a=0;for(let l=t;l<=i;l++)r[a++]=this._lineFactory.createLine();e.lines=e.lines.concat(r)}_removeLinesAfter(e,t){const i=e.linesLength-t;for(let n=0;n<t;n++)e.lines[i+n].getDomNode()?.remove();e.lines.splice(i,t)}_finishRenderingNewLines(e,t,i,n){uc._ttPolicy&&(i=uc._ttPolicy.createHTML(i));const s=this._domNode.lastChild;t||!s?this._domNode.innerHTML=i:s.insertAdjacentHTML("afterend",i);let r=this._domNode.lastChild;for(let a=e.linesLength-1;a>=0;a--){const l=e.lines[a];n[a]&&(l.setDomNode(r),r=r.previousSibling)}}_finishRenderingInvalidLines(e,t,i){const n=document.createElement("div");uc._ttPolicy&&(t=uc._ttPolicy.createHTML(t)),n.innerHTML=t;for(let s=0;s<e.linesLength;s++){const r=e.lines[s];if(i[s]){const a=n.firstChild,l=r.getDomNode();l.parentNode.replaceChild(a,l),r.setDomNode(a)}}}_finishRendering(e,t,i){const n=uc._sb,s=e.linesLength,r=e.lines,a=e.rendLineNumberStart,l=[];{n.reset();let c=!1;for(let d=0;d<s;d++){const h=r[d];l[d]=!1,!(h.getDomNode()||!h.renderLine(d+a,i[d],this._viewportData.lineHeight,this._viewportData,n))&&(l[d]=!0,c=!0)}c&&this._finishRenderingNewLines(e,t,n.build(),l)}{n.reset();let c=!1;const d=[];for(let h=0;h<s;h++){const u=r[h];d[h]=!1,!(l[h]||!u.renderLine(h+a,i[h],this._viewportData.lineHeight,this._viewportData,n))&&(d[h]=!0,c=!0)}c&&this._finishRenderingInvalidLines(e,n.build(),d)}}};uc._ttPolicy=nd("editorViewLayer",{createHTML:e=>e}),uc._sb=new rb(1e5);let ZM=uc;class YK extends go{constructor(e){super(e),this._dynamicOverlays=[],this._isFocused=!1,this._visibleLines=new ZK({createLine:()=>new sme(this._dynamicOverlays)}),this.domNode=this._visibleLines.domNode;const i=this._context.configuration.options.get(50);mn(this.domNode,i),this.domNode.setClassName("view-overlays")}shouldRender(){if(super.shouldRender())return!0;for(let e=0,t=this._dynamicOverlays.length;e<t;e++)if(this._dynamicOverlays[e].shouldRender())return!0;return!1}dispose(){super.dispose();for(let e=0,t=this._dynamicOverlays.length;e<t;e++)this._dynamicOverlays[e].dispose();this._dynamicOverlays=[]}getDomNode(){return this.domNode}addDynamicOverlay(e){this._dynamicOverlays.push(e)}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e);const i=this._context.configuration.options.get(50);return mn(this.domNode,i),!0}onFlushed(e){return this._visibleLines.onFlushed(e)}onFocusChanged(e){return this._isFocused=e.isFocused,!0}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onScrollChanged(e){return this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._visibleLines.onZonesChanged(e)}prepareRender(e){const t=this._dynamicOverlays.filter(i=>i.shouldRender());for(let i=0,n=t.length;i<n;i++){const s=t[i];s.prepareRender(e),s.onDidRender()}}render(e){this._viewOverlaysRender(e),this.domNode.toggleClassName("focused",this._isFocused)}_viewOverlaysRender(e){this._visibleLines.renderLines(e.viewportData)}}class sme{constructor(e){this._dynamicOverlays=e,this._domNode=null,this._renderedContent=null}getDomNode(){return this._domNode?this._domNode.domNode:null}setDomNode(e){this._domNode=bt(e)}onContentChanged(){}onTokensChanged(){}renderLine(e,t,i,n,s){let r="";for(let a=0,l=this._dynamicOverlays.length;a<l;a++){const c=this._dynamicOverlays[a];r+=c.render(n.startLineNumber,e)}return this._renderedContent===r?!1:(this._renderedContent=r,s.appendString('<div style="top:'),s.appendString(String(t)),s.appendString("px;height:"),s.appendString(String(i)),s.appendString('px;">'),s.appendString(r),s.appendString("</div>"),!0)}layoutLine(e,t,i){this._domNode&&(this._domNode.setTop(t),this._domNode.setHeight(i))}}class ome extends YK{constructor(e){super(e);const i=this._context.configuration.options.get(146);this._contentWidth=i.contentWidth,this.domNode.setHeight(0)}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._contentWidth=i.contentWidth,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollWidthChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e),this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth))}}class rme extends YK{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._contentLeft=i.contentLeft,this.domNode.setClassName("margin-view-overlays"),this.domNode.setWidth(1),mn(this.domNode,t.get(50))}onConfigurationChanged(e){const t=this._context.configuration.options;mn(this.domNode,t.get(50));const i=t.get(146);return this._contentLeft=i.contentLeft,super.onConfigurationChanged(e)||!0}onScrollChanged(e){return super.onScrollChanged(e)||e.scrollHeightChanged}_viewOverlaysRender(e){super._viewOverlaysRender(e);const t=Math.min(e.scrollHeight,1e6);this.domNode.setHeight(t),this.domNode.setWidth(this._contentLeft)}}class lD{constructor(e){this.onKeyDown=null,this.onKeyUp=null,this.onContextMenu=null,this.onMouseMove=null,this.onMouseLeave=null,this.onMouseDown=null,this.onMouseUp=null,this.onMouseDrag=null,this.onMouseDrop=null,this.onMouseDropCanceled=null,this.onMouseWheel=null,this._coordinatesConverter=e}emitKeyDown(e){this.onKeyDown?.(e)}emitKeyUp(e){this.onKeyUp?.(e)}emitContextMenu(e){this.onContextMenu?.(this._convertViewToModelMouseEvent(e))}emitMouseMove(e){this.onMouseMove?.(this._convertViewToModelMouseEvent(e))}emitMouseLeave(e){this.onMouseLeave?.(this._convertViewToModelMouseEvent(e))}emitMouseDown(e){this.onMouseDown?.(this._convertViewToModelMouseEvent(e))}emitMouseUp(e){this.onMouseUp?.(this._convertViewToModelMouseEvent(e))}emitMouseDrag(e){this.onMouseDrag?.(this._convertViewToModelMouseEvent(e))}emitMouseDrop(e){this.onMouseDrop?.(this._convertViewToModelMouseEvent(e))}emitMouseDropCanceled(){this.onMouseDropCanceled?.()}emitMouseWheel(e){this.onMouseWheel?.(e)}_convertViewToModelMouseEvent(e){return e.target?{event:e.event,target:this._convertViewToModelMouseTarget(e.target)}:e}_convertViewToModelMouseTarget(e){return lD.convertViewToModelMouseTarget(e,this._coordinatesConverter)}static convertViewToModelMouseTarget(e,t){const i={...e};return i.position&&(i.position=t.convertViewPositionToModelPosition(i.position)),i.range&&(i.range=t.convertViewRangeToModelRange(i.range)),(i.type===5||i.type===8)&&(i.detail=this.convertViewToModelViewZoneData(i.detail,t)),i}static convertViewToModelViewZoneData(e,t){return{viewZoneId:e.viewZoneId,positionBefore:e.positionBefore?t.convertViewPositionToModelPosition(e.positionBefore):e.positionBefore,positionAfter:e.positionAfter?t.convertViewPositionToModelPosition(e.positionAfter):e.positionAfter,position:t.convertViewPositionToModelPosition(e.position),afterLineNumber:t.convertViewPositionToModelPosition(new A(e.afterLineNumber,1)).lineNumber}}}class ame extends go{constructor(e){super(e),this.blocks=[],this.contentWidth=-1,this.contentLeft=0,this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("blockDecorations-container"),this.update()}update(){let e=!1;const i=this._context.configuration.options.get(146),n=i.contentWidth-i.verticalScrollbarWidth;this.contentWidth!==n&&(this.contentWidth=n,e=!0);const s=i.contentLeft;return this.contentLeft!==s&&(this.contentLeft=s,e=!0),e}dispose(){super.dispose()}onConfigurationChanged(e){return this.update()}onScrollChanged(e){return e.scrollTopChanged||e.scrollLeftChanged}onDecorationsChanged(e){return!0}onZonesChanged(e){return!0}prepareRender(e){}render(e){let t=0;const i=e.getDecorationsInViewport();for(const n of i){if(!n.options.blockClassName)continue;let s=this.blocks[t];s||(s=this.blocks[t]=bt(document.createElement("div")),this.domNode.appendChild(s));let r,a;n.options.blockIsAfterEnd?(r=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!1),a=e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0)):(r=e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!0),a=n.range.isEmpty()&&!n.options.blockDoesNotCollapse?e.getVerticalOffsetForLineNumber(n.range.startLineNumber,!1):e.getVerticalOffsetAfterLineNumber(n.range.endLineNumber,!0));const[l,c,d,h]=n.options.blockPadding??[0,0,0,0];s.setClassName("blockDecorations-block "+n.options.blockClassName),s.setLeft(this.contentLeft-h),s.setWidth(this.contentWidth+h+c),s.setTop(r-e.scrollTop-l),s.setHeight(a-r+l+d),t++}for(let n=t;n<this.blocks.length;n++)this.blocks[n].domNode.remove();this.blocks.length=t}}class lme extends go{constructor(e,t){super(e),this._viewDomNode=t,this._widgets={},this.domNode=bt(document.createElement("div")),Aa.write(this.domNode,1),this.domNode.setClassName("contentWidgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this.overflowingContentWidgetsDomNode=bt(document.createElement("div")),Aa.write(this.overflowingContentWidgetsDomNode,2),this.overflowingContentWidgetsDomNode.setClassName("overflowingContentWidgets")}dispose(){super.dispose(),this._widgets={}}onConfigurationChanged(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onConfigurationChanged(e);return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLineMappingChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesChanged(e){return this._updateAnchorsViewPositions(),!0}onLinesDeleted(e){return this._updateAnchorsViewPositions(),!0}onLinesInserted(e){return this._updateAnchorsViewPositions(),!0}onScrollChanged(e){return!0}onZonesChanged(e){return!0}_updateAnchorsViewPositions(){const e=Object.keys(this._widgets);for(const t of e)this._widgets[t].updateAnchorViewPosition()}addWidget(e){const t=new cme(this._context,this._viewDomNode,e);this._widgets[t.id]=t,t.allowEditorOverflow?this.overflowingContentWidgetsDomNode.appendChild(t.domNode):this.domNode.appendChild(t.domNode),this.setShouldRender()}setWidgetPosition(e,t,i,n,s){this._widgets[e.getId()].setPosition(t,i,n,s),this.setShouldRender()}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const i=this._widgets[t];delete this._widgets[t];const n=i.domNode.domNode;n.remove(),n.removeAttribute("monaco-visible-content-widget"),this.setShouldRender()}}shouldSuppressMouseDownOnWidget(e){return this._widgets.hasOwnProperty(e)?this._widgets[e].suppressMouseDown:!1}onBeforeRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].onBeforeRender(e)}prepareRender(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].prepareRender(e)}render(e){const t=Object.keys(this._widgets);for(const i of t)this._widgets[i].render(e)}}class cme{constructor(e,t,i){this._primaryAnchor=new Jb(null,null),this._secondaryAnchor=new Jb(null,null),this._context=e,this._viewDomNode=t,this._actual=i,this.domNode=bt(this._actual.getDomNode()),this.id=this._actual.getId(),this.allowEditorOverflow=this._actual.allowEditorOverflow||!1,this.suppressMouseDown=this._actual.suppressMouseDown||!1;const n=this._context.configuration.options,s=n.get(146);this._fixedOverflowWidgets=n.get(42),this._contentWidth=s.contentWidth,this._contentLeft=s.contentLeft,this._lineHeight=n.get(67),this._affinity=null,this._preference=[],this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1,this._maxWidth=this._getMaxWidth(),this._isVisible=!1,this._renderData=null,this.domNode.setPosition(this._fixedOverflowWidgets&&this.allowEditorOverflow?"fixed":"absolute"),this.domNode.setDisplay("none"),this.domNode.setVisibility("hidden"),this.domNode.setAttribute("widgetId",this.id),this.domNode.setMaxWidth(this._maxWidth)}onConfigurationChanged(e){const t=this._context.configuration.options;if(this._lineHeight=t.get(67),e.hasChanged(146)){const i=t.get(146);this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._maxWidth=this._getMaxWidth()}}updateAnchorViewPosition(){this._setPosition(this._affinity,this._primaryAnchor.modelPosition,this._secondaryAnchor.modelPosition)}_setPosition(e,t,i){this._affinity=e,this._primaryAnchor=n(t,this._context.viewModel,this._affinity),this._secondaryAnchor=n(i,this._context.viewModel,this._affinity);function n(s,r,a){if(!s)return new Jb(null,null);const l=r.model.validatePosition(s);if(r.coordinatesConverter.modelPositionIsVisible(l)){const c=r.coordinatesConverter.convertModelPositionToViewPosition(l,a??void 0);return new Jb(s,c)}return new Jb(s,null)}}_getMaxWidth(){const e=this.domNode.domNode.ownerDocument,t=e.defaultView;return this.allowEditorOverflow?t?.innerWidth||e.documentElement.offsetWidth||e.body.offsetWidth:this._contentWidth}setPosition(e,t,i,n){this._setPosition(n,e,t),this._preference=i,this._primaryAnchor.viewPosition&&this._preference&&this._preference.length>0?this.domNode.setDisplay("block"):this.domNode.setDisplay("none"),this._cachedDomNodeOffsetWidth=-1,this._cachedDomNodeOffsetHeight=-1}_layoutBoxInViewport(e,t,i,n){const s=e.top,r=s,a=e.top+e.height,l=n.viewportHeight-a,c=s-i,d=r>=i,h=a,u=l>=i;let g=e.left;return g+t>n.scrollLeft+n.viewportWidth&&(g=n.scrollLeft+n.viewportWidth-t),g<n.scrollLeft&&(g=n.scrollLeft),{fitsAbove:d,aboveTop:c,fitsBelow:u,belowTop:h,left:g}}_layoutHorizontalSegmentInPage(e,t,i,n){const a=Math.max(15,t.left-n),l=Math.min(t.left+t.width+n,e.width-15),d=this._viewDomNode.domNode.ownerDocument.defaultView;let h=t.left+i-(d?.scrollX??0);if(h+n>l){const u=h-(l-n);h-=u,i-=u}if(h<a){const u=h-a;h-=u,i-=u}return[i,h]}_layoutBoxInPage(e,t,i,n){const s=e.top-i,r=e.top+e.height,a=Ci(this._viewDomNode.domNode),l=this._viewDomNode.domNode.ownerDocument,c=l.defaultView,d=a.top+s-(c?.scrollY??0),h=a.top+r-(c?.scrollY??0),u=Ph(l.body),[g,f]=this._layoutHorizontalSegmentInPage(u,a,e.left-n.scrollLeft+this._contentLeft,t),m=22,_=22,b=d>=m,v=h+i<=u.height-_;return this._fixedOverflowWidgets?{fitsAbove:b,aboveTop:Math.max(d,m),fitsBelow:v,belowTop:h,left:f}:{fitsAbove:b,aboveTop:s,fitsBelow:v,belowTop:r,left:g}}_prepareRenderWidgetAtExactPositionOverflowing(e){return new ev(e.top,e.left+this._contentLeft)}_getAnchorsCoordinates(e){const t=s(this._primaryAnchor.viewPosition,this._affinity,this._lineHeight),i=this._secondaryAnchor.viewPosition?.lineNumber===this._primaryAnchor.viewPosition?.lineNumber?this._secondaryAnchor.viewPosition:null,n=s(i,this._affinity,this._lineHeight);return{primary:t,secondary:n};function s(r,a,l){if(!r)return null;const c=e.visibleRangeForPosition(r);if(!c)return null;const d=r.column===1&&a===3?0:c.left,h=e.getVerticalOffsetForLineNumber(r.lineNumber)-e.scrollTop;return new o9(h,d,l)}}_reduceAnchorCoordinates(e,t,i){if(!t)return e;const n=this._context.configuration.options.get(50);let s=t.left;return s<e.left?s=Math.max(s,e.left-i+n.typicalFullwidthCharacterWidth):s=Math.min(s,e.left+i-n.typicalFullwidthCharacterWidth),new o9(e.top,s,e.height)}_prepareRenderWidget(e){if(!this._preference||this._preference.length===0)return null;const{primary:t,secondary:i}=this._getAnchorsCoordinates(e);if(!t)return{kind:"offViewport",preserveFocus:this.domNode.domNode.contains(this.domNode.domNode.ownerDocument.activeElement)};if(this._cachedDomNodeOffsetWidth===-1||this._cachedDomNodeOffsetHeight===-1){let r=null;if(typeof this._actual.beforeRender=="function"&&(r=iN(this._actual.beforeRender,this._actual)),r)this._cachedDomNodeOffsetWidth=r.width,this._cachedDomNodeOffsetHeight=r.height;else{const l=this.domNode.domNode.getBoundingClientRect();this._cachedDomNodeOffsetWidth=Math.round(l.width),this._cachedDomNodeOffsetHeight=Math.round(l.height)}}const n=this._reduceAnchorCoordinates(t,i,this._cachedDomNodeOffsetWidth);let s;this.allowEditorOverflow?s=this._layoutBoxInPage(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e):s=this._layoutBoxInViewport(n,this._cachedDomNodeOffsetWidth,this._cachedDomNodeOffsetHeight,e);for(let r=1;r<=2;r++)for(const a of this._preference)if(a===1){if(!s)return null;if(r===2||s.fitsAbove)return{kind:"inViewport",coordinate:new ev(s.aboveTop,s.left),position:1}}else if(a===2){if(!s)return null;if(r===2||s.fitsBelow)return{kind:"inViewport",coordinate:new ev(s.belowTop,s.left),position:2}}else return this.allowEditorOverflow?{kind:"inViewport",coordinate:this._prepareRenderWidgetAtExactPositionOverflowing(new ev(n.top,n.left)),position:0}:{kind:"inViewport",coordinate:new ev(n.top,n.left),position:0};return null}onBeforeRender(e){!this._primaryAnchor.viewPosition||!this._preference||this._primaryAnchor.viewPosition.lineNumber<e.startLineNumber||this._primaryAnchor.viewPosition.lineNumber>e.endLineNumber||this.domNode.setMaxWidth(this._maxWidth)}prepareRender(e){this._renderData=this._prepareRenderWidget(e)}render(e){if(!this._renderData||this._renderData.kind==="offViewport"){this._isVisible&&(this.domNode.removeAttribute("monaco-visible-content-widget"),this._isVisible=!1,this._renderData?.kind==="offViewport"&&this._renderData.preserveFocus?this.domNode.setTop(-1e3):this.domNode.setVisibility("hidden")),typeof this._actual.afterRender=="function"&&iN(this._actual.afterRender,this._actual,null);return}this.allowEditorOverflow?(this.domNode.setTop(this._renderData.coordinate.top),this.domNode.setLeft(this._renderData.coordinate.left)):(this.domNode.setTop(this._renderData.coordinate.top+e.scrollTop-e.bigNumbersDelta),this.domNode.setLeft(this._renderData.coordinate.left)),this._isVisible||(this.domNode.setVisibility("inherit"),this.domNode.setAttribute("monaco-visible-content-widget","true"),this._isVisible=!0),typeof this._actual.afterRender=="function"&&iN(this._actual.afterRender,this._actual,this._renderData.position)}}class Jb{constructor(e,t){this.modelPosition=e,this.viewPosition=t}}class ev{constructor(e,t){this.top=e,this.left=t,this._coordinateBrand=void 0}}class o9{constructor(e,t,i){this.top=e,this.left=t,this.height=i,this._anchorCoordinateBrand=void 0}}function iN(o,e,...t){try{return o.call(e,...t)}catch{return null}}class XK extends Jf{constructor(e){super(),this._context=e;const t=this._context.configuration.options,i=t.get(146);this._renderLineHighlight=t.get(97),this._renderLineHighlightOnlyWhenFocus=t.get(98),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._selectionIsEmpty=!0,this._focused=!1,this._cursorLineNumbers=[1],this._selections=[new pe(1,1,1,1)],this._renderData=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}_readFromSelections(){let e=!1;const t=new Set;for(const s of this._selections)t.add(s.positionLineNumber);const i=Array.from(t);i.sort((s,r)=>s-r),ei(this._cursorLineNumbers,i)||(this._cursorLineNumbers=i,e=!0);const n=this._selections.every(s=>s.isEmpty());return this._selectionIsEmpty!==n&&(this._selectionIsEmpty=n,e=!0),e}onThemeChanged(e){return this._readFromSelections()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._renderLineHighlight=t.get(97),this._renderLineHighlightOnlyWhenFocus=t.get(98),this._wordWrap=i.isViewportWrapping,this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,!0}onCursorStateChanged(e){return this._selections=e.selections,this._readFromSelections()}onFlushed(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollWidthChanged||e.scrollTopChanged}onZonesChanged(e){return!0}onFocusChanged(e){return this._renderLineHighlightOnlyWhenFocus?(this._focused=e.isFocused,!0):!1}prepareRender(e){if(!this._shouldRenderThis()){this._renderData=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=[];for(let r=t;r<=i;r++){const a=r-t;n[a]=""}if(this._wordWrap){const r=this._renderOne(e,!1);for(const a of this._cursorLineNumbers){const l=this._context.viewModel.coordinatesConverter,c=l.convertViewPositionToModelPosition(new A(a,1)).lineNumber,d=l.convertModelPositionToViewPosition(new A(c,1)).lineNumber,h=l.convertModelPositionToViewPosition(new A(c,this._context.viewModel.model.getLineMaxColumn(c))).lineNumber,u=Math.max(d,t),g=Math.min(h,i);for(let f=u;f<=g;f++){const m=f-t;n[m]=r}}}const s=this._renderOne(e,!0);for(const r of this._cursorLineNumbers){if(r<t||r>i)continue;const a=r-t;n[a]=s}this._renderData=n}render(e,t){if(!this._renderData)return"";const i=t-e;return i>=this._renderData.length?"":this._renderData[i]}_shouldRenderInMargin(){return(this._renderLineHighlight==="gutter"||this._renderLineHighlight==="all")&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}_shouldRenderInContent(){return(this._renderLineHighlight==="line"||this._renderLineHighlight==="all")&&this._selectionIsEmpty&&(!this._renderLineHighlightOnlyWhenFocus||this._focused)}}class dme extends XK{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-both":"")+(t?" current-line-exact":"")}" style="width:${Math.max(e.scrollWidth,this._contentWidth)}px;"></div>`}_shouldRenderThis(){return this._shouldRenderInContent()}_shouldRenderOther(){return this._shouldRenderInMargin()}}class hme extends XK{_renderOne(e,t){return`<div class="${"current-line"+(this._shouldRenderInMargin()?" current-line-margin":"")+(this._shouldRenderOther()?" current-line-margin-both":"")+(this._shouldRenderInMargin()&&t?" current-line-exact-margin":"")}" style="width:${this._contentLeft}px"></div>`}_shouldRenderThis(){return!0}_shouldRenderOther(){return this._shouldRenderInContent()}}br((o,e)=>{const t=o.getColor(c$);if(t&&(e.addRule(`.monaco-editor .view-overlays .current-line { background-color: ${t}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-margin { background-color: ${t}; border: none; }`)),!t||t.isTransparent()||o.defines(KH)){const i=o.getColor(KH);i&&(e.addRule(`.monaco-editor .view-overlays .current-line-exact { border: 2px solid ${i}; }`),e.addRule(`.monaco-editor .margin-view-overlays .current-line-exact-margin { border: 2px solid ${i}; }`),xa(o.type)&&(e.addRule(".monaco-editor .view-overlays .current-line-exact { border-width: 1px; }"),e.addRule(".monaco-editor .margin-view-overlays .current-line-exact-margin { border-width: 1px; }")))}});class ume extends Jf{constructor(e){super(),this._context=e;const t=this._context.configuration.options;this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}prepareRender(e){const t=e.getDecorationsInViewport();let i=[],n=0;for(let l=0,c=t.length;l<c;l++){const d=t[l];d.options.className&&(i[n++]=d)}i=i.sort((l,c)=>{if(l.options.zIndex<c.options.zIndex)return-1;if(l.options.zIndex>c.options.zIndex)return 1;const d=l.options.className,h=c.options.className;return d<h?-1:d>h?1:L.compareRangesUsingStarts(l.range,c.range)});const s=e.visibleRange.startLineNumber,r=e.visibleRange.endLineNumber,a=[];for(let l=s;l<=r;l++){const c=l-s;a[c]=""}this._renderWholeLineDecorations(e,i,a),this._renderNormalDecorations(e,i,a),this._renderResult=a}_renderWholeLineDecorations(e,t,i){const n=e.visibleRange.startLineNumber,s=e.visibleRange.endLineNumber;for(let r=0,a=t.length;r<a;r++){const l=t[r];if(!l.options.isWholeLine)continue;const c='<div class="cdr '+l.options.className+'" style="left:0;width:100%;"></div>',d=Math.max(l.range.startLineNumber,n),h=Math.min(l.range.endLineNumber,s);for(let u=d;u<=h;u++){const g=u-n;i[g]+=c}}}_renderNormalDecorations(e,t,i){const n=e.visibleRange.startLineNumber;let s=null,r=!1,a=null,l=!1;for(let c=0,d=t.length;c<d;c++){const h=t[c];if(h.options.isWholeLine)continue;const u=h.options.className,g=!!h.options.showIfCollapsed;let f=h.range;if(g&&f.endColumn===1&&f.endLineNumber!==f.startLineNumber&&(f=new L(f.startLineNumber,f.startColumn,f.endLineNumber-1,this._context.viewModel.getLineMaxColumn(f.endLineNumber-1))),s===u&&r===g&&L.areIntersectingOrTouching(a,f)){a=L.plusRange(a,f);continue}s!==null&&this._renderNormalDecoration(e,a,s,l,r,n,i),s=u,r=g,a=f,l=h.options.shouldFillLineOnLineBreak??!1}s!==null&&this._renderNormalDecoration(e,a,s,l,r,n,i)}_renderNormalDecoration(e,t,i,n,s,r,a){const l=e.linesVisibleRangesForRange(t,i==="findMatch");if(l)for(let c=0,d=l.length;c<d;c++){const h=l[c];if(h.outsideRenderedLine)continue;const u=h.lineNumber-r;if(s&&h.ranges.length===1){const g=h.ranges[0];if(g.width<this._typicalHalfwidthCharacterWidth){const f=Math.round(g.left+g.width/2),m=Math.max(0,Math.round(f-this._typicalHalfwidthCharacterWidth/2));h.ranges[0]=new sD(m,this._typicalHalfwidthCharacterWidth)}}for(let g=0,f=h.ranges.length;g<f;g++){const m=n&&h.continuesOnNextLine&&f===1,_=h.ranges[g],b='<div class="cdr '+i+'" style="left:'+String(_.left)+"px;width:"+(m?"100%;":String(_.width)+"px;")+'"></div>';a[u]+=b}}}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class gme extends go{constructor(e,t,i,n){super(e);const s=this._context.configuration.options,r=s.get(104),a=s.get(75),l=s.get(40),c=s.get(107),d={listenOnDomNode:i.domNode,className:"editor-scrollable "+RP(e.theme.type),useShadows:!1,lazyRender:!0,vertical:r.vertical,horizontal:r.horizontal,verticalHasArrows:r.verticalHasArrows,horizontalHasArrows:r.horizontalHasArrows,verticalScrollbarSize:r.verticalScrollbarSize,verticalSliderSize:r.verticalSliderSize,horizontalScrollbarSize:r.horizontalScrollbarSize,horizontalSliderSize:r.horizontalSliderSize,handleMouseWheel:r.handleMouseWheel,alwaysConsumeMouseWheel:r.alwaysConsumeMouseWheel,arrowSize:r.arrowSize,mouseWheelScrollSensitivity:a,fastScrollSensitivity:l,scrollPredominantAxis:c,scrollByPage:r.scrollByPage};this.scrollbar=this._register(new RT(t.domNode,d,this._context.viewLayout.getScrollable())),Aa.write(this.scrollbar.getDomNode(),6),this.scrollbarDomNode=bt(this.scrollbar.getDomNode()),this.scrollbarDomNode.setPosition("absolute"),this._setLayout();const h=(u,g,f)=>{const m={};{const _=u.scrollTop;_&&(m.scrollTop=this._context.viewLayout.getCurrentScrollTop()+_,u.scrollTop=0)}if(f){const _=u.scrollLeft;_&&(m.scrollLeft=this._context.viewLayout.getCurrentScrollLeft()+_,u.scrollLeft=0)}this._context.viewModel.viewLayout.setScrollPosition(m,1)};this._register(H(i.domNode,"scroll",u=>h(i.domNode,!0,!0))),this._register(H(t.domNode,"scroll",u=>h(t.domNode,!0,!1))),this._register(H(n.domNode,"scroll",u=>h(n.domNode,!0,!1))),this._register(H(this.scrollbarDomNode.domNode,"scroll",u=>h(this.scrollbarDomNode.domNode,!0,!1)))}dispose(){super.dispose()}_setLayout(){const e=this._context.configuration.options,t=e.get(146);this.scrollbarDomNode.setLeft(t.contentLeft),e.get(73).side==="right"?this.scrollbarDomNode.setWidth(t.contentWidth+t.minimap.minimapWidth):this.scrollbarDomNode.setWidth(t.contentWidth),this.scrollbarDomNode.setHeight(t.height)}getOverviewRulerLayoutInfo(){return this.scrollbar.getOverviewRulerLayoutInfo()}getDomNode(){return this.scrollbarDomNode}delegateVerticalScrollbarPointerDown(e){this.scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this.scrollbar.delegateScrollFromMouseWheelEvent(e)}onConfigurationChanged(e){if(e.hasChanged(104)||e.hasChanged(75)||e.hasChanged(40)){const t=this._context.configuration.options,i=t.get(104),n=t.get(75),s=t.get(40),r=t.get(107),a={vertical:i.vertical,horizontal:i.horizontal,verticalScrollbarSize:i.verticalScrollbarSize,horizontalScrollbarSize:i.horizontalScrollbarSize,scrollByPage:i.scrollByPage,handleMouseWheel:i.handleMouseWheel,mouseWheelScrollSensitivity:n,fastScrollSensitivity:s,scrollPredominantAxis:r};this.scrollbar.updateOptions(a)}return e.hasChanged(146)&&this._setLayout(),!0}onScrollChanged(e){return!0}onThemeChanged(e){return this.scrollbar.updateClassName("editor-scrollable "+RP(this._context.theme.type)),!0}prepareRender(e){}render(e){this.scrollbar.renderNow()}}class YM{constructor(e,t,i,n,s){this.startLineNumber=e,this.endLineNumber=t,this.className=i,this.tooltip=n,this._decorationToRenderBrand=void 0,this.zIndex=s??0}}class fme{constructor(e,t,i){this.className=e,this.zIndex=t,this.tooltip=i}}class pme{constructor(){this.decorations=[]}add(e){this.decorations.push(e)}getDecorations(){return this.decorations}}class QK extends Jf{_render(e,t,i){const n=[];for(let a=e;a<=t;a++){const l=a-e;n[l]=new pme}if(i.length===0)return n;i.sort((a,l)=>a.className===l.className?a.startLineNumber===l.startLineNumber?a.endLineNumber-l.endLineNumber:a.startLineNumber-l.startLineNumber:a.className<l.className?-1:1);let s=null,r=0;for(let a=0,l=i.length;a<l;a++){const c=i[a],d=c.className,h=c.zIndex;let u=Math.max(c.startLineNumber,e)-e;const g=Math.min(c.endLineNumber,t)-e;s===d?(u=Math.max(r+1,u),r=Math.max(r,g)):(s=d,r=g);for(let f=u;f<=r;f++)n[f].add(new fme(d,h,c.tooltip))}return n}}class mme extends go{constructor(e){super(e),this._widgets={},this._context=e;const t=this._context.configuration.options,i=t.get(146);this.domNode=bt(document.createElement("div")),this.domNode.setClassName("glyph-margin-widgets"),this.domNode.setPosition("absolute"),this.domNode.setTop(0),this._lineHeight=t.get(67),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,this._managedDomNodes=[],this._decorationGlyphsToRender=[]}dispose(){this._managedDomNodes=[],this._decorationGlyphsToRender=[],this._widgets={},super.dispose()}getWidgets(){return Object.values(this._widgets)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._lineHeight=t.get(67),this._glyphMargin=t.get(57),this._glyphMarginLeft=i.glyphMarginLeft,this._glyphMarginWidth=i.glyphMarginWidth,this._glyphMarginDecorationLaneCount=i.glyphMarginDecorationLaneCount,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}addWidget(e){const t=bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:e.getPosition(),domNode:t,renderInfo:null},t.setPosition("absolute"),t.setDisplay("none"),t.setAttribute("widgetId",e.getId()),this.domNode.appendChild(t),this.setShouldRender()}setWidgetPosition(e,t){const i=this._widgets[e.getId()];return i.preference.lane===t.lane&&i.preference.zIndex===t.zIndex&&L.equalsRange(i.preference.range,t.range)?!1:(i.preference=t,this.setShouldRender(),!0)}removeWidget(e){const t=e.getId();if(this._widgets[t]){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender()}}_collectDecorationBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber,s=e.getDecorationsInViewport();for(const r of s){const a=r.options.glyphMarginClassName;if(!a)continue;const l=Math.max(r.range.startLineNumber,i),c=Math.min(r.range.endLineNumber,n),d=r.options.glyphMargin?.position??Ur.Center,h=r.options.zIndex??0;for(let u=l;u<=c;u++){const g=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(u,0)),f=this._context.viewModel.glyphLanes.getLanesAtLine(g.lineNumber).indexOf(d);t.push(new _me(u,f,h,a))}}}_collectWidgetBasedGlyphRenderRequest(e,t){const i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(const s of Object.values(this._widgets)){const r=s.preference.range,{startLineNumber:a,endLineNumber:l}=this._context.viewModel.coordinatesConverter.convertModelRangeToViewRange(L.lift(r));if(!a||!l||l<i||a>n)continue;const c=Math.max(a,i),d=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(c,0)),h=this._context.viewModel.glyphLanes.getLanesAtLine(d.lineNumber).indexOf(s.preference.lane);t.push(new bme(c,h,s.preference.zIndex,s))}}_collectSortedGlyphRenderRequests(e){const t=[];return this._collectDecorationBasedGlyphRenderRequest(e,t),this._collectWidgetBasedGlyphRenderRequest(e,t),t.sort((i,n)=>i.lineNumber===n.lineNumber?i.laneIndex===n.laneIndex?i.zIndex===n.zIndex?n.type===i.type?i.type===0&&n.type===0?i.className<n.className?-1:1:0:n.type-i.type:n.zIndex-i.zIndex:i.laneIndex-n.laneIndex:i.lineNumber-n.lineNumber),t}prepareRender(e){if(!this._glyphMargin){this._decorationGlyphsToRender=[];return}for(const n of Object.values(this._widgets))n.renderInfo=null;const t=new Gc(this._collectSortedGlyphRenderRequests(e)),i=[];for(;t.length>0;){const n=t.peek();if(!n)break;const s=t.takeWhile(a=>a.lineNumber===n.lineNumber&&a.laneIndex===n.laneIndex);if(!s||s.length===0)break;const r=s[0];if(r.type===0){const a=[];for(const l of s){if(l.zIndex!==r.zIndex||l.type!==r.type)break;(a.length===0||a[a.length-1]!==l.className)&&a.push(l.className)}i.push(r.accept(a.join(" ")))}else r.widget.renderInfo={lineNumber:r.lineNumber,laneIndex:r.laneIndex}}this._decorationGlyphsToRender=i}render(e){if(!this._glyphMargin){for(const i of Object.values(this._widgets))i.domNode.setDisplay("none");for(;this._managedDomNodes.length>0;)this._managedDomNodes.pop()?.domNode.remove();return}const t=Math.round(this._glyphMarginWidth/this._glyphMarginDecorationLaneCount);for(const i of Object.values(this._widgets))if(!i.renderInfo)i.domNode.setDisplay("none");else{const n=e.viewportData.relativeVerticalOffset[i.renderInfo.lineNumber-e.viewportData.startLineNumber],s=this._glyphMarginLeft+i.renderInfo.laneIndex*this._lineHeight;i.domNode.setDisplay("block"),i.domNode.setTop(n),i.domNode.setLeft(s),i.domNode.setWidth(t),i.domNode.setHeight(this._lineHeight)}for(let i=0;i<this._decorationGlyphsToRender.length;i++){const n=this._decorationGlyphsToRender[i],s=e.viewportData.relativeVerticalOffset[n.lineNumber-e.viewportData.startLineNumber],r=this._glyphMarginLeft+n.laneIndex*this._lineHeight;let a;i<this._managedDomNodes.length?a=this._managedDomNodes[i]:(a=bt(document.createElement("div")),this._managedDomNodes.push(a),this.domNode.appendChild(a)),a.setClassName("cgmr codicon "+n.combinedClassName),a.setPosition("absolute"),a.setTop(s),a.setLeft(r),a.setWidth(t),a.setHeight(this._lineHeight)}for(;this._managedDomNodes.length>this._decorationGlyphsToRender.length;)this._managedDomNodes.pop()?.domNode.remove()}}class _me{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.className=n,this.type=0}accept(e){return new vme(this.lineNumber,this.laneIndex,e)}}class bme{constructor(e,t,i,n){this.lineNumber=e,this.laneIndex=t,this.zIndex=i,this.widget=n,this.type=1}}class vme{constructor(e,t,i){this.lineNumber=e,this.laneIndex=t,this.combinedClassName=i}}class Cme extends Jf{constructor(e){super(),this._context=e,this._primaryPosition=null;const t=this._context.configuration.options,i=t.get(147),n=t.get(50);this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(147),n=t.get(50);return this._spaceWidth=n.spaceWidth,this._maxIndentLeft=i.wrappingColumn===-1?-1:i.wrappingColumn*n.typicalHalfwidthCharacterWidth,this._bracketPairGuideOptions=t.get(16),!0}onCursorStateChanged(e){const i=e.selections[0].getPosition();return this._primaryPosition?.equals(i)?!1:(this._primaryPosition=i,!0)}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}onLanguageConfigurationChanged(e){return!0}prepareRender(e){if(!this._bracketPairGuideOptions.indentation&&this._bracketPairGuideOptions.bracketPairs===!1){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=e.scrollWidth,s=this._primaryPosition,r=this.getGuidesByLine(t,Math.min(i+1,this._context.viewModel.getLineCount()),s),a=[];for(let l=t;l<=i;l++){const c=l-t,d=r[c];let h="";const u=e.visibleRangeForPosition(new A(l,1))?.left??0;for(const g of d){const f=g.column===-1?u+(g.visibleColumn-1)*this._spaceWidth:e.visibleRangeForPosition(new A(l,g.column)).left;if(f>n||this._maxIndentLeft>0&&f>this._maxIndentLeft)break;const m=g.horizontalLine?g.horizontalLine.top?"horizontal-top":"horizontal-bottom":"vertical",_=g.horizontalLine?(e.visibleRangeForPosition(new A(l,g.horizontalLine.endColumn))?.left??f+this._spaceWidth)-f:this._spaceWidth;h+=`<div class="core-guide ${g.className} ${m}" style="left:${f}px;width:${_}px"></div>`}a[c]=h}this._renderResult=a}getGuidesByLine(e,t,i){const n=this._bracketPairGuideOptions.bracketPairs!==!1?this._context.viewModel.getBracketGuidesInRangeByLine(e,t,i,{highlightActive:this._bracketPairGuideOptions.highlightActiveBracketPair,horizontalGuides:this._bracketPairGuideOptions.bracketPairsHorizontal===!0?dg.Enabled:this._bracketPairGuideOptions.bracketPairsHorizontal==="active"?dg.EnabledForActive:dg.Disabled,includeInactive:this._bracketPairGuideOptions.bracketPairs===!0}):null,s=this._bracketPairGuideOptions.indentation?this._context.viewModel.getLinesIndentGuides(e,t):null;let r=0,a=0,l=0;if(this._bracketPairGuideOptions.highlightActiveIndentation!==!1&&i){const h=this._context.viewModel.getActiveIndentGuide(i.lineNumber,e,t);r=h.startLineNumber,a=h.endLineNumber,l=h.indent}const{indentSize:c}=this._context.viewModel.model.getOptions(),d=[];for(let h=e;h<=t;h++){const u=new Array;d.push(u);const g=n?n[h-e]:[],f=new Gc(g),m=s?s[h-e]:0;for(let _=1;_<=m;_++){const b=(_-1)*c+1,v=(this._bracketPairGuideOptions.highlightActiveIndentation==="always"||g.length===0)&&r<=h&&h<=a&&_===l;u.push(...f.takeWhile(C=>C.visibleColumn<b)||[]);const y=f.peek();(!y||y.visibleColumn!==b||y.horizontalLine)&&u.push(new eg(b,-1,`core-guide-indent lvl-${(_-1)%30}`+(v?" indent-active":""),null,-1,-1))}u.push(...f.takeWhile(_=>!0)||[])}return d}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}function wp(o){if(!(o&&o.isTransparent()))return o}br((o,e)=>{const t=[{bracketColor:g$,guideColor:Bce,guideColorActive:Gce},{bracketColor:f$,guideColor:Wce,guideColorActive:$ce},{bracketColor:p$,guideColor:Vce,guideColorActive:Kce},{bracketColor:m$,guideColor:Hce,guideColorActive:jce},{bracketColor:_$,guideColor:zce,guideColorActive:qce},{bracketColor:b$,guideColor:Uce,guideColorActive:Zce}],i=new D$,n=[{indentColor:Hw,indentColorActive:zw},{indentColor:_ce,indentColorActive:wce},{indentColor:bce,indentColorActive:Sce},{indentColor:vce,indentColorActive:xce},{indentColor:Cce,indentColorActive:Lce},{indentColor:yce,indentColorActive:kce}],s=t.map(a=>{const l=o.getColor(a.bracketColor),c=o.getColor(a.guideColor),d=o.getColor(a.guideColorActive),h=wp(wp(c)??l?.transparent(.3)),u=wp(wp(d)??l);if(!(!h||!u))return{guideColor:h,guideColorActive:u}}).filter(Sl),r=n.map(a=>{const l=o.getColor(a.indentColor),c=o.getColor(a.indentColorActive),d=wp(l),h=wp(c);if(!(!d||!h))return{indentColor:d,indentColorActive:h}}).filter(Sl);if(s.length>0){for(let a=0;a<30;a++){const l=s[a%s.length];e.addRule(`.monaco-editor .${i.getInlineClassNameOfLevel(a).replace(/ /g,".")} { --guide-color: ${l.guideColor}; --guide-color-active: ${l.guideColorActive}; }`)}e.addRule(".monaco-editor .vertical { box-shadow: 1px 0 0 0 var(--guide-color) inset; }"),e.addRule(".monaco-editor .horizontal-top { border-top: 1px solid var(--guide-color); }"),e.addRule(".monaco-editor .horizontal-bottom { border-bottom: 1px solid var(--guide-color); }"),e.addRule(`.monaco-editor .vertical.${i.activeClassName} { box-shadow: 1px 0 0 0 var(--guide-color-active) inset; }`),e.addRule(`.monaco-editor .horizontal-top.${i.activeClassName} { border-top: 1px solid var(--guide-color-active); }`),e.addRule(`.monaco-editor .horizontal-bottom.${i.activeClassName} { border-bottom: 1px solid var(--guide-color-active); }`)}if(r.length>0){for(let a=0;a<30;a++){const l=r[a%r.length];e.addRule(`.monaco-editor .lines-content .core-guide-indent.lvl-${a} { --indent-color: ${l.indentColor}; --indent-color-active: ${l.indentColorActive}; }`)}e.addRule(".monaco-editor .lines-content .core-guide-indent { box-shadow: 1px 0 0 0 var(--indent-color) inset; }"),e.addRule(".monaco-editor .lines-content .core-guide-indent.indent-active { box-shadow: 1px 0 0 0 var(--indent-color-active) inset; }")}});class nN{get didDomLayout(){return this._didDomLayout}readClientRect(){if(!this._clientRectRead){this._clientRectRead=!0;const e=this._domNode.getBoundingClientRect();this.markDidDomLayout(),this._clientRectDeltaLeft=e.left,this._clientRectScale=e.width/this._domNode.offsetWidth}}get clientRectDeltaLeft(){return this._clientRectRead||this.readClientRect(),this._clientRectDeltaLeft}get clientRectScale(){return this._clientRectRead||this.readClientRect(),this._clientRectScale}constructor(e,t){this._domNode=e,this.endNode=t,this._didDomLayout=!1,this._clientRectDeltaLeft=0,this._clientRectScale=1,this._clientRectRead=!1}markDidDomLayout(){this._didDomLayout=!0}}class yme{constructor(){this._currentVisibleRange=new L(1,1,1,1)}getCurrentVisibleRange(){return this._currentVisibleRange}setCurrentVisibleRange(e){this._currentVisibleRange=e}}class wme{constructor(e,t,i,n,s,r,a){this.minimalReveal=e,this.lineNumber=t,this.startColumn=i,this.endColumn=n,this.startScrollTop=s,this.stopScrollTop=r,this.scrollType=a,this.type="range",this.minLineNumber=t,this.maxLineNumber=t}}class Sme{constructor(e,t,i,n,s){this.minimalReveal=e,this.selections=t,this.startScrollTop=i,this.stopScrollTop=n,this.scrollType=s,this.type="selections";let r=t[0].startLineNumber,a=t[0].endLineNumber;for(let l=1,c=t.length;l<c;l++){const d=t[l];r=Math.min(r,d.startLineNumber),a=Math.max(a,d.endLineNumber)}this.minLineNumber=r,this.maxLineNumber=a}}const Qk=class Qk extends go{constructor(e,t){super(e);const i=this._context.configuration,n=this._context.configuration.options,s=n.get(50),r=n.get(147);this._lineHeight=n.get(67),this._typicalHalfwidthCharacterWidth=s.typicalHalfwidthCharacterWidth,this._isViewportWrapping=r.isViewportWrapping,this._revealHorizontalRightPadding=n.get(101),this._cursorSurroundingLines=n.get(29),this._cursorSurroundingLinesStyle=n.get(30),this._canUseLayerHinting=!n.get(32),this._viewLineOptions=new X7(i,this._context.theme.type),this._linesContent=t,this._textRangeRestingSpot=document.createElement("div"),this._visibleLines=new ZK({createLine:()=>new wc(this._viewLineOptions)}),this.domNode=this._visibleLines.domNode,Aa.write(this.domNode,8),this.domNode.setClassName(`view-lines ${jm}`),mn(this.domNode,s),this._maxLineWidth=0,this._asyncUpdateLineWidths=new xt(()=>{this._updateLineWidthsSlow()},200),this._asyncCheckMonospaceFontAssumptions=new xt(()=>{this._checkMonospaceFontAssumptions()},2e3),this._lastRenderedData=new yme,this._horizontalRevealRequest=null,this._stickyScrollEnabled=n.get(116).enabled,this._maxNumberStickyLines=n.get(116).maxLineCount}dispose(){this._asyncUpdateLineWidths.dispose(),this._asyncCheckMonospaceFontAssumptions.dispose(),super.dispose()}getDomNode(){return this.domNode}onConfigurationChanged(e){this._visibleLines.onConfigurationChanged(e),e.hasChanged(147)&&(this._maxLineWidth=0);const t=this._context.configuration.options,i=t.get(50),n=t.get(147);return this._lineHeight=t.get(67),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._isViewportWrapping=n.isViewportWrapping,this._revealHorizontalRightPadding=t.get(101),this._cursorSurroundingLines=t.get(29),this._cursorSurroundingLinesStyle=t.get(30),this._canUseLayerHinting=!t.get(32),this._stickyScrollEnabled=t.get(116).enabled,this._maxNumberStickyLines=t.get(116).maxLineCount,mn(this.domNode,i),this._onOptionsMaybeChanged(),e.hasChanged(146)&&(this._maxLineWidth=0),!0}_onOptionsMaybeChanged(){const e=this._context.configuration,t=new X7(e,this._context.theme.type);if(!this._viewLineOptions.equals(t)){this._viewLineOptions=t;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let s=i;s<=n;s++)this._visibleLines.getVisibleLine(s).onOptionsChanged(this._viewLineOptions);return!0}return!1}onCursorStateChanged(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=!1;for(let s=t;s<=i;s++)n=this._visibleLines.getVisibleLine(s).onSelectionChanged()||n;return n}onDecorationsChanged(e){{const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++)this._visibleLines.getVisibleLine(n).onDecorationsChanged()}return!0}onFlushed(e){const t=this._visibleLines.onFlushed(e);return this._maxLineWidth=0,t}onLinesChanged(e){return this._visibleLines.onLinesChanged(e)}onLinesDeleted(e){return this._visibleLines.onLinesDeleted(e)}onLinesInserted(e){return this._visibleLines.onLinesInserted(e)}onRevealRangeRequest(e){const t=this._computeScrollTopToRevealRange(this._context.viewLayout.getFutureViewport(),e.source,e.minimalReveal,e.range,e.selections,e.verticalType);if(t===-1)return!1;let i=this._context.viewLayout.validateScrollPosition({scrollTop:t});e.revealHorizontal?e.range&&e.range.startLineNumber!==e.range.endLineNumber?i={scrollTop:i.scrollTop,scrollLeft:0}:e.range?this._horizontalRevealRequest=new wme(e.minimalReveal,e.range.startLineNumber,e.range.startColumn,e.range.endColumn,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType):e.selections&&e.selections.length>0&&(this._horizontalRevealRequest=new Sme(e.minimalReveal,e.selections,this._context.viewLayout.getCurrentScrollTop(),i.scrollTop,e.scrollType)):this._horizontalRevealRequest=null;const s=Math.abs(this._context.viewLayout.getCurrentScrollTop()-i.scrollTop)<=this._lineHeight?1:e.scrollType;return this._context.viewModel.viewLayout.setScrollPosition(i,s),!0}onScrollChanged(e){if(this._horizontalRevealRequest&&e.scrollLeftChanged&&(this._horizontalRevealRequest=null),this._horizontalRevealRequest&&e.scrollTopChanged){const t=Math.min(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop),i=Math.max(this._horizontalRevealRequest.startScrollTop,this._horizontalRevealRequest.stopScrollTop);(e.scrollTop<t||e.scrollTop>i)&&(this._horizontalRevealRequest=null)}return this.domNode.setWidth(e.scrollWidth),this._visibleLines.onScrollChanged(e)||!0}onTokensChanged(e){return this._visibleLines.onTokensChanged(e)}onZonesChanged(e){return this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth),this._visibleLines.onZonesChanged(e)}onThemeChanged(e){return this._onOptionsMaybeChanged()}getPositionFromDOMInfo(e,t){const i=this._getViewLineDomNode(e);if(i===null)return null;const n=this._getLineNumberFor(i);if(n===-1||n<1||n>this._context.viewModel.getLineCount())return null;if(this._context.viewModel.getLineMaxColumn(n)===1)return new A(n,1);const s=this._visibleLines.getStartLineNumber(),r=this._visibleLines.getEndLineNumber();if(n<s||n>r)return null;let a=this._visibleLines.getVisibleLine(n).getColumnOfNodeOffset(e,t);const l=this._context.viewModel.getLineMinColumn(n);return a<l&&(a=l),new A(n,a)}_getViewLineDomNode(e){for(;e&&e.nodeType===1;){if(e.className===wc.CLASS_NAME)return e;e=e.parentElement}return null}_getLineNumberFor(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();for(let n=t;n<=i;n++){const s=this._visibleLines.getVisibleLine(n);if(e===s.getDomNode())return n}return-1}getLineWidth(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();if(e<t||e>i)return-1;const n=new nN(this.domNode.domNode,this._textRangeRestingSpot),s=this._visibleLines.getVisibleLine(e).getWidth(n);return this._updateLineWidthsSlowIfDomDidLayout(n),s}linesVisibleRangesForRange(e,t){if(this.shouldRender())return null;const i=e.endLineNumber,n=L.intersectRanges(e,this._lastRenderedData.getCurrentVisibleRange());if(!n)return null;const s=[];let r=0;const a=new nN(this.domNode.domNode,this._textRangeRestingSpot);let l=0;t&&(l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(n.startLineNumber,1)).lineNumber);const c=this._visibleLines.getStartLineNumber(),d=this._visibleLines.getEndLineNumber();for(let h=n.startLineNumber;h<=n.endLineNumber;h++){if(h<c||h>d)continue;const u=h===n.startLineNumber?n.startColumn:1,g=h!==n.endLineNumber,f=g?this._context.viewModel.getLineMaxColumn(h):n.endColumn,m=this._visibleLines.getVisibleLine(h).getVisibleRangesForRange(h,u,f,a);if(m){if(t&&h<i){const _=l;l=this._context.viewModel.coordinatesConverter.convertViewPositionToModelPosition(new A(h+1,1)).lineNumber,_!==l&&(m.ranges[m.ranges.length-1].width+=this._typicalHalfwidthCharacterWidth)}s[r++]=new ape(m.outsideRenderedLine,h,sD.from(m.ranges),g)}}return this._updateLineWidthsSlowIfDomDidLayout(a),r===0?null:s}_visibleRangesForLineRange(e,t,i){if(this.shouldRender()||e<this._visibleLines.getStartLineNumber()||e>this._visibleLines.getEndLineNumber())return null;const n=new nN(this.domNode.domNode,this._textRangeRestingSpot),s=this._visibleLines.getVisibleLine(e).getVisibleRangesForRange(e,t,i,n);return this._updateLineWidthsSlowIfDomDidLayout(n),s}visibleRangeForPosition(e){const t=this._visibleRangesForLineRange(e.lineNumber,e.column,e.column);return t?new lpe(t.outsideRenderedLine,t.ranges[0].left):null}_updateLineWidthsFast(){return this._updateLineWidths(!0)}_updateLineWidthsSlow(){this._updateLineWidths(!1)}_updateLineWidthsSlowIfDomDidLayout(e){e.didDomLayout&&(this._asyncUpdateLineWidths.isScheduled()||(this._asyncUpdateLineWidths.cancel(),this._updateLineWidthsSlow()))}_updateLineWidths(e){const t=this._visibleLines.getStartLineNumber(),i=this._visibleLines.getEndLineNumber();let n=1,s=!0;for(let r=t;r<=i;r++){const a=this._visibleLines.getVisibleLine(r);if(e&&!a.getWidthIsFast()){s=!1;continue}n=Math.max(n,a.getWidth(null))}return s&&t===1&&i===this._context.viewModel.getLineCount()&&(this._maxLineWidth=0),this._ensureMaxLineWidth(n),s}_checkMonospaceFontAssumptions(){let e=-1,t=-1;const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let s=i;s<=n;s++){const r=this._visibleLines.getVisibleLine(s);if(r.needsMonospaceFontCheck()){const a=r.getWidth(null);a>t&&(t=a,e=s)}}if(e!==-1&&!this._visibleLines.getVisibleLine(e).monospaceAssumptionsAreValid())for(let s=i;s<=n;s++)this._visibleLines.getVisibleLine(s).onMonospaceAssumptionsInvalidated()}prepareRender(){throw new Error("Not supported")}render(){throw new Error("Not supported")}renderText(e){if(this._visibleLines.renderLines(e),this._lastRenderedData.setCurrentVisibleRange(e.visibleRange),this.domNode.setWidth(this._context.viewLayout.getScrollWidth()),this.domNode.setHeight(Math.min(this._context.viewLayout.getScrollHeight(),1e6)),this._horizontalRevealRequest){const i=this._horizontalRevealRequest;if(e.startLineNumber<=i.minLineNumber&&i.maxLineNumber<=e.endLineNumber){this._horizontalRevealRequest=null,this.onDidRender();const n=this._computeScrollLeftToReveal(i);n&&(this._isViewportWrapping||this._ensureMaxLineWidth(n.maxHorizontalOffset),this._context.viewModel.viewLayout.setScrollPosition({scrollLeft:n.scrollLeft},i.scrollType))}}if(this._updateLineWidthsFast()?this._asyncUpdateLineWidths.cancel():this._asyncUpdateLineWidths.schedule(),us&&!this._asyncCheckMonospaceFontAssumptions.isScheduled()){const i=this._visibleLines.getStartLineNumber(),n=this._visibleLines.getEndLineNumber();for(let s=i;s<=n;s++)if(this._visibleLines.getVisibleLine(s).needsMonospaceFontCheck()){this._asyncCheckMonospaceFontAssumptions.schedule();break}}this._linesContent.setLayerHinting(this._canUseLayerHinting),this._linesContent.setContain("strict");const t=this._context.viewLayout.getCurrentScrollTop()-e.bigNumbersDelta;this._linesContent.setTop(-t),this._linesContent.setLeft(-this._context.viewLayout.getCurrentScrollLeft())}_ensureMaxLineWidth(e){const t=Math.ceil(e);this._maxLineWidth<t&&(this._maxLineWidth=t,this._context.viewModel.viewLayout.setMaxLineWidth(this._maxLineWidth))}_computeScrollTopToRevealRange(e,t,i,n,s,r){const a=e.top,l=e.height,c=a+l;let d,h,u;if(s&&s.length>0){let b=s[0].startLineNumber,v=s[0].endLineNumber;for(let y=1,C=s.length;y<C;y++){const w=s[y];b=Math.min(b,w.startLineNumber),v=Math.max(v,w.endLineNumber)}d=!1,h=this._context.viewLayout.getVerticalOffsetForLineNumber(b),u=this._context.viewLayout.getVerticalOffsetForLineNumber(v)+this._lineHeight}else if(n)d=!0,h=this._context.viewLayout.getVerticalOffsetForLineNumber(n.startLineNumber),u=this._context.viewLayout.getVerticalOffsetForLineNumber(n.endLineNumber)+this._lineHeight;else return-1;const g=(t==="mouse"||i)&&this._cursorSurroundingLinesStyle==="default";let f=0,m=0;if(g)i||(f=this._lineHeight);else{const b=l/this._lineHeight,v=Math.max(this._cursorSurroundingLines,this._stickyScrollEnabled?this._maxNumberStickyLines:0),y=Math.min(b/2,v);f=y*this._lineHeight,m=Math.max(0,y-1)*this._lineHeight}i||(r===0||r===4)&&(m+=this._lineHeight),h-=f,u+=m;let _;if(u-h>l){if(!d)return-1;_=h}else if(r===5||r===6)if(r===6&&a<=h&&u<=c)_=a;else{const b=Math.max(5*this._lineHeight,l*.2),v=h-b,y=u-l;_=Math.max(y,v)}else if(r===1||r===2)if(r===2&&a<=h&&u<=c)_=a;else{const b=(h+u)/2;_=Math.max(0,b-l/2)}else _=this._computeMinimumScrolling(a,c,h,u,r===3,r===4);return _}_computeScrollLeftToReveal(e){const t=this._context.viewLayout.getCurrentViewport(),i=this._context.configuration.options.get(146),n=t.left,s=n+t.width-i.verticalScrollbarWidth;let r=1073741824,a=0;if(e.type==="range"){const c=this._visibleRangesForLineRange(e.lineNumber,e.startColumn,e.endColumn);if(!c)return null;for(const d of c.ranges)r=Math.min(r,Math.round(d.left)),a=Math.max(a,Math.round(d.left+d.width))}else for(const c of e.selections){if(c.startLineNumber!==c.endLineNumber)return null;const d=this._visibleRangesForLineRange(c.startLineNumber,c.startColumn,c.endColumn);if(!d)return null;for(const h of d.ranges)r=Math.min(r,Math.round(h.left)),a=Math.max(a,Math.round(h.left+h.width))}return e.minimalReveal||(r=Math.max(0,r-Qk.HORIZONTAL_EXTRA_PX),a+=this._revealHorizontalRightPadding),e.type==="selections"&&a-r>t.width?null:{scrollLeft:this._computeMinimumScrolling(n,s,r,a),maxHorizontalOffset:a}}_computeMinimumScrolling(e,t,i,n,s,r){e=e|0,t=t|0,i=i|0,n=n|0,s=!!s,r=!!r;const a=t-e;if(n-i<a){if(s)return i;if(r)return Math.max(0,n-a);if(i<e)return i;if(n>t)return Math.max(0,n-a)}else return i;return e}};Qk.HORIZONTAL_EXTRA_PX=30;let XM=Qk;class xme extends QK{constructor(e){super(),this._context=e;const i=this._context.configuration.options.get(146);this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._decorationsLeft=i.decorationsLeft,this._decorationsWidth=i.decorationsWidth,!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.options.linesDecorationsClassName,c=a.options.zIndex;l&&(i[n++]=new YM(a.range.startLineNumber,a.range.endLineNumber,l,a.options.linesDecorationsTooltip??null,c));const d=a.options.firstLineDecorationClassName;d&&(i[n++]=new YM(a.range.startLineNumber,a.range.startLineNumber,d,a.options.linesDecorationsTooltip??null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),s=this._decorationsLeft.toString(),r=this._decorationsWidth.toString(),a='" style="left:'+s+"px;width:"+r+'px;"></div>',l=[];for(let c=t;c<=i;c++){const d=c-t,h=n[d].getDecorations();let u="";for(const g of h){let f='<div class="cldr '+g.className;g.tooltip!==null&&(f+='" title="'+g.tooltip),f+=a,u+=f}l[d]=u}this._renderResult=l}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}class Lme extends QK{constructor(e){super(),this._context=e,this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){return!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_getDecorations(e){const t=e.getDecorationsInViewport(),i=[];let n=0;for(let s=0,r=t.length;s<r;s++){const a=t[s],l=a.options.marginClassName,c=a.options.zIndex;l&&(i[n++]=new YM(a.range.startLineNumber,a.range.endLineNumber,l,null,c))}return i}prepareRender(e){const t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber,n=this._render(t,i,this._getDecorations(e)),s=[];for(let r=t;r<=i;r++){const a=r-t,l=n[a].getDecorations();let c="";for(const d of l)c+='<div class="cmdr '+d.className+'" style=""></div>';s[a]=c}this._renderResult=s}render(e,t){return this._renderResult?this._renderResult[t-e]:""}}const Ed=class Ed{constructor(e,t,i,n){this._rgba8Brand=void 0,this.r=Ed._clamp(e),this.g=Ed._clamp(t),this.b=Ed._clamp(i),this.a=Ed._clamp(n)}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}static _clamp(e){return e<0?0:e>255?255:e|0}};Ed.Empty=new Ed(0,0,0,0);let Hc=Ed;const Jk=class Jk extends F{static getInstance(){return this._INSTANCE||(this._INSTANCE=new Jk),this._INSTANCE}constructor(){super(),this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._updateColorMap(),this._register(gi.onDidChange(e=>{e.changedColorMap&&this._updateColorMap()}))}_updateColorMap(){const e=gi.getColorMap();if(!e){this._colors=[Hc.Empty],this._backgroundIsLight=!0;return}this._colors=[Hc.Empty];for(let i=1;i<e.length;i++){const n=e[i].rgba;this._colors[i]=new Hc(n.r,n.g,n.b,Math.round(n.a*255))}const t=e[2].getRelativeLuminance();this._backgroundIsLight=t>=.5,this._onDidChange.fire(void 0)}getColor(e){return(e<1||e>=this._colors.length)&&(e=2),this._colors[e]}backgroundIsLight(){return this._backgroundIsLight}};Jk._INSTANCE=null;let Jx=Jk;const kme=(()=>{const o=[];for(let e=32;e<=126;e++)o.push(e);return o.push(65533),o})(),Eme=(o,e)=>(o-=32,o<0||o>96?e<=2?(o+96)%96:95:o);class Oy{constructor(e,t){this.scale=t,this._minimapCharRendererBrand=void 0,this.charDataNormal=Oy.soften(e,12/15),this.charDataLight=Oy.soften(e,50/60)}static soften(e,t){const i=new Uint8ClampedArray(e.length);for(let n=0,s=e.length;n<s;n++)i[n]=W0(e[n]*t);return i}renderChar(e,t,i,n,s,r,a,l,c,d,h){const u=1*this.scale,g=2*this.scale,f=h?1:g;if(t+u>e.width||i+f>e.height){console.warn("bad render request outside image data");return}const m=d?this.charDataLight:this.charDataNormal,_=Eme(n,c),b=e.width*4,v=a.r,y=a.g,C=a.b,w=s.r-v,x=s.g-y,k=s.b-C,E=Math.max(r,l),N=e.data;let z=_*u*g,B=i*b+t*4;for(let U=0;U<f;U++){let Z=B;for(let V=0;V<u;V++){const Q=m[z++]/255*(r/255);N[Z++]=v+w*Q,N[Z++]=y+x*Q,N[Z++]=C+k*Q,N[Z++]=E}B+=b}}blockRenderChar(e,t,i,n,s,r,a,l){const c=1*this.scale,d=2*this.scale,h=l?1:d;if(t+c>e.width||i+h>e.height){console.warn("bad render request outside image data");return}const u=e.width*4,g=.5*(s/255),f=r.r,m=r.g,_=r.b,b=n.r-f,v=n.g-m,y=n.b-_,C=f+b*g,w=m+v*g,x=_+y*g,k=Math.max(s,a),E=e.data;let N=i*u+t*4;for(let z=0;z<h;z++){let B=N;for(let U=0;U<c;U++)E[B++]=C,E[B++]=w,E[B++]=x,E[B++]=k;N+=u}}}const r9={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15},a9=o=>{const e=new Uint8ClampedArray(o.length/2);for(let t=0;t<o.length;t+=2)e[t>>1]=r9[o[t]]<<4|r9[o[t+1]]&15;return e},l9={1:Eh(()=>a9("0000511D6300CF609C709645A78432005642574171487021003C451900274D35D762755E8B629C5BA856AF57BA649530C167D1512A272A3F6038604460398526BCA2A968DB6F8957C768BE5FBE2FB467CF5D8D5B795DC7625B5DFF50DE64C466DB2FC47CD860A65E9A2EB96CB54CE06DA763AB2EA26860524D3763536601005116008177A8705E53AB738E6A982F88BAA35B5F5B626D9C636B449B737E5B7B678598869A662F6B5B8542706C704C80736A607578685B70594A49715A4522E792")),2:Eh(()=>a9("000000000000000055394F383D2800008B8B1F210002000081B1CBCBCC820000847AAF6B9AAF2119BE08B8881AD60000A44FD07DCCF107015338130C00000000385972265F390B406E2437634B4B48031B12B8A0847000001E15B29A402F0000000000004B33460B00007A752C2A0000000000004D3900000084394B82013400ABA5CFC7AD9C0302A45A3E5A98AB000089A43382D97900008BA54AA087A70A0248A6A7AE6DBE0000BF6F94987EA40A01A06DCFA7A7A9030496C32F77891D0000A99FB1A0AFA80603B29AB9CA75930D010C0948354D3900000C0948354F37460D0028BE673D8400000000AF9D7B6E00002B007AA8933400007AA642675C2700007984CFB9C3985B768772A8A6B7B20000CAAECAAFC4B700009F94A6009F840009D09F9BA4CA9C0000CC8FC76DC87F0000C991C472A2000000A894A48CA7B501079BA2C9C69BA20000B19A5D3FA89000005CA6009DA2960901B0A7F0669FB200009D009E00B7890000DAD0F5D092820000D294D4C48BD10000B5A7A4A3B1A50402CAB6CBA6A2000000B5A7A4A3B1A8044FCDADD19D9CB00000B7778F7B8AAE0803C9AB5D3F5D3F00009EA09EA0BAB006039EA0989A8C7900009B9EF4D6B7C00000A9A7816CACA80000ABAC84705D3F000096DA635CDC8C00006F486F266F263D4784006124097B00374F6D2D6D2D6D4A3A95872322000000030000000000008D8939130000000000002E22A5C9CBC70600AB25C0B5C9B400061A2DB04CA67001082AA6BEBEBFC606002321DACBC19E03087AA08B6768380000282FBAC0B8CA7A88AD25BBA5A29900004C396C5894A6000040485A6E356E9442A32CD17EADA70000B4237923628600003E2DE9C1D7B500002F25BBA5A2990000231DB6AFB4A804023025C0B5CAB588062B2CBDBEC0C706882435A75CA20000002326BD6A82A908048B4B9A5A668000002423A09CB4BB060025259C9D8A7900001C1FCAB2C7C700002A2A9387ABA200002626A4A47D6E9D14333163A0C87500004B6F9C2D643A257049364936493647358A34438355497F1A0000A24C1D590000D38DFFBDD4CD3126"))};class tC{static create(e,t){if(this.lastCreated&&e===this.lastCreated.scale&&t===this.lastFontFamily)return this.lastCreated;let i;return l9[e]?i=new Oy(l9[e](),e):i=tC.createFromSampleData(tC.createSampleData(t).data,e),this.lastFontFamily=t,this.lastCreated=i,i}static createSampleData(e){const t=document.createElement("canvas"),i=t.getContext("2d");t.style.height="16px",t.height=16,t.width=96*10,t.style.width=96*10+"px",i.fillStyle="#ffffff",i.font=`bold 16px ${e}`,i.textBaseline="middle";let n=0;for(const s of kme)i.fillText(String.fromCharCode(s),n,16/2),n+=10;return i.getImageData(0,0,96*10,16)}static createFromSampleData(e,t){if(e.length!==61440)throw new Error("Unexpected source in MinimapCharRenderer");const n=tC._downsample(e,t);return new Oy(n,t)}static _downsampleChar(e,t,i,n,s){const r=1*s,a=2*s;let l=n,c=0;for(let d=0;d<a;d++){const h=d/a*16,u=(d+1)/a*16;for(let g=0;g<r;g++){const f=g/r*10,m=(g+1)/r*10;let _=0,b=0;for(let y=h;y<u;y++){const C=t+Math.floor(y)*3840,w=1-(y-Math.floor(y));for(let x=f;x<m;x++){const k=1-(x-Math.floor(x)),E=C+Math.floor(x)*4,N=k*w;b+=N,_+=e[E]*e[E+3]/255*N}}const v=_/b;c=Math.max(c,v),i[l++]=W0(v)}}return c}static _downsample(e,t){const i=2*t*1*t,n=i*96,s=new Uint8ClampedArray(n);let r=0,a=0,l=0;for(let c=0;c<96;c++)l=Math.max(l,this._downsampleChar(e,a,s,r,t)),r+=i,a+=10*4;if(l>0){const c=255/l;for(let d=0;d<n;d++)s[d]*=c}return s}}const JK=En?'"Segoe WPC", "Segoe UI", sans-serif':Qe?"-apple-system, BlinkMacSystemFont, sans-serif":'system-ui, "Ubuntu", "Droid Sans", sans-serif',Tme=140,Dme=2;class Ym{constructor(e,t,i){const n=e.options,s=n.get(144),r=n.get(146),a=r.minimap,l=n.get(50),c=n.get(73);this.renderMinimap=a.renderMinimap,this.size=c.size,this.minimapHeightIsEditorHeight=a.minimapHeightIsEditorHeight,this.scrollBeyondLastLine=n.get(106),this.paddingTop=n.get(84).top,this.paddingBottom=n.get(84).bottom,this.showSlider=c.showSlider,this.autohide=c.autohide,this.pixelRatio=s,this.typicalHalfwidthCharacterWidth=l.typicalHalfwidthCharacterWidth,this.lineHeight=n.get(67),this.minimapLeft=a.minimapLeft,this.minimapWidth=a.minimapWidth,this.minimapHeight=r.height,this.canvasInnerWidth=a.minimapCanvasInnerWidth,this.canvasInnerHeight=a.minimapCanvasInnerHeight,this.canvasOuterWidth=a.minimapCanvasOuterWidth,this.canvasOuterHeight=a.minimapCanvasOuterHeight,this.isSampling=a.minimapIsSampling,this.editorHeight=r.height,this.fontScale=a.minimapScale,this.minimapLineHeight=a.minimapLineHeight,this.minimapCharWidth=1*this.fontScale,this.sectionHeaderFontFamily=JK,this.sectionHeaderFontSize=c.sectionHeaderFontSize*s,this.sectionHeaderLetterSpacing=c.sectionHeaderLetterSpacing,this.sectionHeaderFontColor=Ym._getSectionHeaderColor(t,i.getColor(1)),this.charRenderer=Eh(()=>tC.create(this.fontScale,l.fontFamily)),this.defaultBackgroundColor=i.getColor(2),this.backgroundColor=Ym._getMinimapBackground(t,this.defaultBackgroundColor),this.foregroundAlpha=Ym._getMinimapForegroundOpacity(t)}static _getMinimapBackground(e,t){const i=e.getColor(bse);return i?new Hc(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}static _getMinimapForegroundOpacity(e){const t=e.getColor(vse);return t?Hc._clamp(Math.round(255*t.rgba.a)):255}static _getSectionHeaderColor(e,t){const i=e.getColor(Hl);return i?new Hc(i.rgba.r,i.rgba.g,i.rgba.b,Math.round(255*i.rgba.a)):t}equals(e){return this.renderMinimap===e.renderMinimap&&this.size===e.size&&this.minimapHeightIsEditorHeight===e.minimapHeightIsEditorHeight&&this.scrollBeyondLastLine===e.scrollBeyondLastLine&&this.paddingTop===e.paddingTop&&this.paddingBottom===e.paddingBottom&&this.showSlider===e.showSlider&&this.autohide===e.autohide&&this.pixelRatio===e.pixelRatio&&this.typicalHalfwidthCharacterWidth===e.typicalHalfwidthCharacterWidth&&this.lineHeight===e.lineHeight&&this.minimapLeft===e.minimapLeft&&this.minimapWidth===e.minimapWidth&&this.minimapHeight===e.minimapHeight&&this.canvasInnerWidth===e.canvasInnerWidth&&this.canvasInnerHeight===e.canvasInnerHeight&&this.canvasOuterWidth===e.canvasOuterWidth&&this.canvasOuterHeight===e.canvasOuterHeight&&this.isSampling===e.isSampling&&this.editorHeight===e.editorHeight&&this.fontScale===e.fontScale&&this.minimapLineHeight===e.minimapLineHeight&&this.minimapCharWidth===e.minimapCharWidth&&this.sectionHeaderFontSize===e.sectionHeaderFontSize&&this.sectionHeaderLetterSpacing===e.sectionHeaderLetterSpacing&&this.defaultBackgroundColor&&this.defaultBackgroundColor.equals(e.defaultBackgroundColor)&&this.backgroundColor&&this.backgroundColor.equals(e.backgroundColor)&&this.foregroundAlpha===e.foregroundAlpha}}class iC{constructor(e,t,i,n,s,r,a,l,c){this.scrollTop=e,this.scrollHeight=t,this.sliderNeeded=i,this._computedSliderRatio=n,this.sliderTop=s,this.sliderHeight=r,this.topPaddingLineCount=a,this.startLineNumber=l,this.endLineNumber=c}getDesiredScrollTopFromDelta(e){return Math.round(this.scrollTop+e/this._computedSliderRatio)}getDesiredScrollTopFromTouchLocation(e){return Math.round((e-this.sliderHeight/2)/this._computedSliderRatio)}intersectWithViewport(e){const t=Math.max(this.startLineNumber,e.startLineNumber),i=Math.min(this.endLineNumber,e.endLineNumber);return t>i?null:[t,i]}getYForLineNumber(e,t){return+(e-this.startLineNumber+this.topPaddingLineCount)*t}static create(e,t,i,n,s,r,a,l,c,d,h){const u=e.pixelRatio,g=e.minimapLineHeight,f=Math.floor(e.canvasInnerHeight/g),m=e.lineHeight;if(e.minimapHeightIsEditorHeight){let x=l*e.lineHeight+e.paddingTop+e.paddingBottom;e.scrollBeyondLastLine&&(x+=Math.max(0,s-e.lineHeight-e.paddingBottom));const k=Math.max(1,Math.floor(s*s/x)),E=Math.max(0,e.minimapHeight-k),N=E/(d-s),z=c*N,B=E>0,U=Math.floor(e.canvasInnerHeight/e.minimapLineHeight),Z=Math.floor(e.paddingTop/e.lineHeight);return new iC(c,d,B,N,z,k,Z,1,Math.min(a,U))}let _;if(r&&i!==a){const x=i-t+1;_=Math.floor(x*g/u)}else{const x=s/m;_=Math.floor(x*g/u)}const b=Math.floor(e.paddingTop/m);let v=Math.floor(e.paddingBottom/m);if(e.scrollBeyondLastLine){const x=s/m;v=Math.max(v,x-1)}let y;if(v>0){const x=s/m;y=(b+a+v-x-1)*g/u}else y=Math.max(0,(b+a)*g/u-_);y=Math.min(e.minimapHeight-_,y);const C=y/(d-s),w=c*C;if(f>=b+a+v){const x=y>0;return new iC(c,d,x,C,w,_,b,1,a)}else{let x;t>1?x=t+b:x=Math.max(1,c/m);let k,E=Math.max(1,Math.floor(x-w*u/g));E<b?(k=b-E+1,E=1):(k=0,E=Math.max(1,E-b)),h&&h.scrollHeight===d&&(h.scrollTop>c&&(E=Math.min(E,h.startLineNumber),k=Math.max(k,h.topPaddingLineCount)),h.scrollTop<c&&(E=Math.max(E,h.startLineNumber),k=Math.min(k,h.topPaddingLineCount)));const N=Math.min(a,E-k+f-1),z=(c-n)/m;let B;return c>=e.paddingTop?B=(t-E+k+z)*g/u:B=c/e.paddingTop*(k+z)*g/u,new iC(c,d,!0,C,B,_,k,E,N)}}}const eE=class eE{constructor(e){this.dy=e}onContentChanged(){this.dy=-1}onTokensChanged(){this.dy=-1}};eE.INVALID=new eE(-1);let eL=eE;class c9{constructor(e,t,i){this.renderedLayout=e,this._imageData=t,this._renderedLines=new qK({createLine:()=>eL.INVALID}),this._renderedLines._set(e.startLineNumber,i)}linesEquals(e){if(!this.scrollEquals(e))return!1;const i=this._renderedLines._get().lines;for(let n=0,s=i.length;n<s;n++)if(i[n].dy===-1)return!1;return!0}scrollEquals(e){return this.renderedLayout.startLineNumber===e.startLineNumber&&this.renderedLayout.endLineNumber===e.endLineNumber}_get(){const e=this._renderedLines._get();return{imageData:this._imageData,rendLineNumberStart:e.rendLineNumberStart,lines:e.lines}}onLinesChanged(e,t){return this._renderedLines.onLinesChanged(e,t)}onLinesDeleted(e,t){this._renderedLines.onLinesDeleted(e,t)}onLinesInserted(e,t){this._renderedLines.onLinesInserted(e,t)}onTokensChanged(e){return this._renderedLines.onTokensChanged(e)}}class PB{constructor(e,t,i,n){this._backgroundFillData=PB._createBackgroundFillData(t,i,n),this._buffers=[e.createImageData(t,i),e.createImageData(t,i)],this._lastUsedBuffer=0}getBuffer(){this._lastUsedBuffer=1-this._lastUsedBuffer;const e=this._buffers[this._lastUsedBuffer];return e.data.set(this._backgroundFillData),e}static _createBackgroundFillData(e,t,i){const n=i.r,s=i.g,r=i.b,a=i.a,l=new Uint8ClampedArray(e*t*4);let c=0;for(let d=0;d<t;d++)for(let h=0;h<e;h++)l[c]=n,l[c+1]=s,l[c+2]=r,l[c+3]=a,c+=4;return l}}class Fy{static compute(e,t,i){if(e.renderMinimap===0||!e.isSampling)return[null,[]];const{minimapLineCount:n}=Dm.computeContainedMinimapLineCount({viewLineCount:t,scrollBeyondLastLine:e.scrollBeyondLastLine,paddingTop:e.paddingTop,paddingBottom:e.paddingBottom,height:e.editorHeight,lineHeight:e.lineHeight,pixelRatio:e.pixelRatio}),s=t/n,r=s/2;if(!i||i.minimapLines.length===0){const _=[];if(_[0]=1,n>1){for(let b=0,v=n-1;b<v;b++)_[b]=Math.round(b*s+r);_[n-1]=t}return[new Fy(s,_),[]]}const a=i.minimapLines,l=a.length,c=[];let d=0,h=0,u=1;const g=10;let f=[],m=null;for(let _=0;_<n;_++){const b=Math.max(u,Math.round(_*s)),v=Math.max(b,Math.round((_+1)*s));for(;d<l&&a[d]<b;){if(f.length<g){const C=d+1+h;m&&m.type==="deleted"&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:C,deleteToLineNumber:C},f.push(m)),h--}d++}let y;if(d<l&&a[d]<=v)y=a[d],d++;else if(_===0?y=1:_+1===n?y=t:y=Math.round(_*s+r),f.length<g){const C=d+1+h;m&&m.type==="inserted"&&m._i===_-1?m.insertToLineNumber++:(m={type:"inserted",_i:_,insertFromLineNumber:C,insertToLineNumber:C},f.push(m)),h++}c[_]=y,u=y}if(f.length<g)for(;d<l;){const _=d+1+h;m&&m.type==="deleted"&&m._oldIndex===d-1?m.deleteToLineNumber++:(m={type:"deleted",_oldIndex:d,deleteFromLineNumber:_,deleteToLineNumber:_},f.push(m)),h--,d++}else f=[{type:"flush"}];return[new Fy(s,c),f]}constructor(e,t){this.samplingRatio=e,this.minimapLines=t}modelLineToMinimapLine(e){return Math.min(this.minimapLines.length,Math.max(1,Math.round(e/this.samplingRatio)))}modelLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e)-1;for(;i>0&&this.minimapLines[i-1]>=e;)i--;let n=this.modelLineToMinimapLine(t)-1;for(;n+1<this.minimapLines.length&&this.minimapLines[n+1]<=t;)n++;if(i===n){const s=this.minimapLines[i];if(s<e||s>t)return null}return[i+1,n+1]}decorationLineRangeToMinimapLineRange(e,t){let i=this.modelLineToMinimapLine(e),n=this.modelLineToMinimapLine(t);return e!==t&&n===i&&(n===this.minimapLines.length?i>1&&i--:n++),[i,n]}onLinesDeleted(e){const t=e.toLineNumber-e.fromLineNumber+1;let i=this.minimapLines.length,n=0;for(let s=this.minimapLines.length-1;s>=0&&!(this.minimapLines[s]<e.fromLineNumber);s--)this.minimapLines[s]<=e.toLineNumber?(this.minimapLines[s]=Math.max(1,e.fromLineNumber-1),i=Math.min(i,s),n=Math.max(n,s)):this.minimapLines[s]-=t;return[i,n]}onLinesInserted(e){const t=e.toLineNumber-e.fromLineNumber+1;for(let i=this.minimapLines.length-1;i>=0&&!(this.minimapLines[i]<e.fromLineNumber);i--)this.minimapLines[i]+=t}}class Ime extends go{constructor(e){super(e),this._sectionHeaderCache=new Vl(10,1.5),this.tokensColorTracker=Jx.getInstance(),this._selections=[],this._minimapSelections=null,this.options=new Ym(this._context.configuration,this._context.theme,this.tokensColorTracker);const[t]=Fy.compute(this.options,this._context.viewModel.getLineCount(),null);this._samplingState=t,this._shouldCheckSampling=!1,this._actual=new nm(e.theme,this)}dispose(){this._actual.dispose(),super.dispose()}getDomNode(){return this._actual.getDomNode()}_onOptionsMaybeChanged(){const e=new Ym(this._context.configuration,this._context.theme,this.tokensColorTracker);return this.options.equals(e)?!1:(this.options=e,this._recreateLineSampling(),this._actual.onDidChangeOptions(),!0)}onConfigurationChanged(e){return this._onOptionsMaybeChanged()}onCursorStateChanged(e){return this._selections=e.selections,this._minimapSelections=null,this._actual.onSelectionChanged()}onDecorationsChanged(e){return e.affectsMinimap?this._actual.onDecorationsChanged():!1}onFlushed(e){return this._samplingState&&(this._shouldCheckSampling=!0),this._actual.onFlushed()}onLinesChanged(e){if(this._samplingState){const t=this._samplingState.modelLineRangeToMinimapLineRange(e.fromLineNumber,e.fromLineNumber+e.count-1);return t?this._actual.onLinesChanged(t[0],t[1]-t[0]+1):!1}else return this._actual.onLinesChanged(e.fromLineNumber,e.count)}onLinesDeleted(e){if(this._samplingState){const[t,i]=this._samplingState.onLinesDeleted(e);return t<=i&&this._actual.onLinesChanged(t+1,i-t+1),this._shouldCheckSampling=!0,!0}else return this._actual.onLinesDeleted(e.fromLineNumber,e.toLineNumber)}onLinesInserted(e){return this._samplingState?(this._samplingState.onLinesInserted(e),this._shouldCheckSampling=!0,!0):this._actual.onLinesInserted(e.fromLineNumber,e.toLineNumber)}onScrollChanged(e){return this._actual.onScrollChanged()}onThemeChanged(e){return this._actual.onThemeChanged(),this._onOptionsMaybeChanged(),!0}onTokensChanged(e){if(this._samplingState){const t=[];for(const i of e.ranges){const n=this._samplingState.modelLineRangeToMinimapLineRange(i.fromLineNumber,i.toLineNumber);n&&t.push({fromLineNumber:n[0],toLineNumber:n[1]})}return t.length?this._actual.onTokensChanged(t):!1}else return this._actual.onTokensChanged(e.ranges)}onTokensColorsChanged(e){return this._onOptionsMaybeChanged(),this._actual.onTokensColorsChanged()}onZonesChanged(e){return this._actual.onZonesChanged()}prepareRender(e){this._shouldCheckSampling&&(this._shouldCheckSampling=!1,this._recreateLineSampling())}render(e){let t=e.visibleRange.startLineNumber,i=e.visibleRange.endLineNumber;this._samplingState&&(t=this._samplingState.modelLineToMinimapLine(t),i=this._samplingState.modelLineToMinimapLine(i));const n={viewportContainsWhitespaceGaps:e.viewportData.whitespaceViewportData.length>0,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,viewportStartLineNumber:t,viewportEndLineNumber:i,viewportStartLineNumberVerticalOffset:e.getVerticalOffsetForLineNumber(t),scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,viewportWidth:e.viewportWidth,viewportHeight:e.viewportHeight};this._actual.render(n)}_recreateLineSampling(){this._minimapSelections=null;const e=!!this._samplingState,[t,i]=Fy.compute(this.options,this._context.viewModel.getLineCount(),this._samplingState);if(this._samplingState=t,e&&this._samplingState)for(const n of i)switch(n.type){case"deleted":this._actual.onLinesDeleted(n.deleteFromLineNumber,n.deleteToLineNumber);break;case"inserted":this._actual.onLinesInserted(n.insertFromLineNumber,n.insertToLineNumber);break;case"flush":this._actual.onFlushed();break}}getLineCount(){return this._samplingState?this._samplingState.minimapLines.length:this._context.viewModel.getLineCount()}getRealLineCount(){return this._context.viewModel.getLineCount()}getLineContent(e){return this._samplingState?this._context.viewModel.getLineContent(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineContent(e)}getLineMaxColumn(e){return this._samplingState?this._context.viewModel.getLineMaxColumn(this._samplingState.minimapLines[e-1]):this._context.viewModel.getLineMaxColumn(e)}getMinimapLinesRenderingData(e,t,i){if(this._samplingState){const n=[];for(let s=0,r=t-e+1;s<r;s++)i[s]?n[s]=this._context.viewModel.getViewLineData(this._samplingState.minimapLines[e+s-1]):n[s]=null;return n}return this._context.viewModel.getMinimapLinesRenderingData(e,t,i).data}getSelections(){if(this._minimapSelections===null)if(this._samplingState){this._minimapSelections=[];for(const e of this._selections){const[t,i]=this._samplingState.decorationLineRangeToMinimapLineRange(e.startLineNumber,e.endLineNumber);this._minimapSelections.push(new pe(t,e.startColumn,i,e.endColumn))}}else this._minimapSelections=this._selections;return this._minimapSelections}getMinimapDecorationsInViewport(e,t){const i=this._getMinimapDecorationsInViewport(e,t).filter(n=>!n.options.minimap?.sectionHeaderStyle);if(this._samplingState){const n=[];for(const s of i){if(!s.options.minimap)continue;const r=s.range,a=this._samplingState.modelLineToMinimapLine(r.startLineNumber),l=this._samplingState.modelLineToMinimapLine(r.endLineNumber);n.push(new MK(new L(a,r.startColumn,l,r.endColumn),s.options))}return n}return i}getSectionHeaderDecorationsInViewport(e,t){const i=this.options.minimapLineHeight,s=this.options.sectionHeaderFontSize/i;return e=Math.floor(Math.max(1,e-s)),this._getMinimapDecorationsInViewport(e,t).filter(r=>!!r.options.minimap?.sectionHeaderStyle)}_getMinimapDecorationsInViewport(e,t){let i;if(this._samplingState){const n=this._samplingState.minimapLines[e-1],s=this._samplingState.minimapLines[t-1];i=new L(n,1,s,this._context.viewModel.getLineMaxColumn(s))}else i=new L(e,1,t,this._context.viewModel.getLineMaxColumn(t));return this._context.viewModel.getMinimapDecorationsInRange(i)}getSectionHeaderText(e,t){const i=e.options.minimap?.sectionHeaderText;if(!i)return null;const n=this._sectionHeaderCache.get(i);if(n)return n;const s=t(i);return this._sectionHeaderCache.set(i,s),s}getOptions(){return this._context.viewModel.model.getOptions()}revealLineNumber(e){this._samplingState&&(e=this._samplingState.minimapLines[e-1]),this._context.viewModel.revealRange("mouse",!1,new L(e,1,e,1),1,0)}setScrollTop(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e},1)}}class nm extends F{constructor(e,t){super(),this._renderDecorations=!1,this._gestureInProgress=!1,this._theme=e,this._model=t,this._lastRenderData=null,this._buffers=null,this._selectionColor=this._theme.getColor(oH),this._domNode=bt(document.createElement("div")),Aa.write(this._domNode,9),this._domNode.setClassName(this._getMinimapDomNodeClassName()),this._domNode.setPosition("absolute"),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._shadow=bt(document.createElement("div")),this._shadow.setClassName("minimap-shadow-hidden"),this._domNode.appendChild(this._shadow),this._canvas=bt(document.createElement("canvas")),this._canvas.setPosition("absolute"),this._canvas.setLeft(0),this._domNode.appendChild(this._canvas),this._decorationsCanvas=bt(document.createElement("canvas")),this._decorationsCanvas.setPosition("absolute"),this._decorationsCanvas.setClassName("minimap-decorations-layer"),this._decorationsCanvas.setLeft(0),this._domNode.appendChild(this._decorationsCanvas),this._slider=bt(document.createElement("div")),this._slider.setPosition("absolute"),this._slider.setClassName("minimap-slider"),this._slider.setLayerHinting(!0),this._slider.setContain("strict"),this._domNode.appendChild(this._slider),this._sliderHorizontal=bt(document.createElement("div")),this._sliderHorizontal.setPosition("absolute"),this._sliderHorizontal.setClassName("minimap-slider-horizontal"),this._slider.appendChild(this._sliderHorizontal),this._applyLayout(),this._pointerDownListener=ci(this._domNode.domNode,ee.POINTER_DOWN,i=>{if(i.preventDefault(),this._model.options.renderMinimap===0||!this._lastRenderData)return;if(this._model.options.size!=="proportional"){if(i.button===0&&this._lastRenderData){const c=Ci(this._slider.domNode),d=c.top+c.height/2;this._startSliderDragging(i,d,this._lastRenderData.renderedLayout)}return}const s=this._model.options.minimapLineHeight,r=this._model.options.canvasInnerHeight/this._model.options.canvasOuterHeight*i.offsetY;let l=Math.floor(r/s)+this._lastRenderData.renderedLayout.startLineNumber-this._lastRenderData.renderedLayout.topPaddingLineCount;l=Math.min(l,this._model.getLineCount()),this._model.revealLineNumber(l)}),this._sliderPointerMoveMonitor=new cb,this._sliderPointerDownListener=ci(this._slider.domNode,ee.POINTER_DOWN,i=>{i.preventDefault(),i.stopPropagation(),i.button===0&&this._lastRenderData&&this._startSliderDragging(i,i.pageY,this._lastRenderData.renderedLayout)}),this._gestureDisposable=Mn.addTarget(this._domNode.domNode),this._sliderTouchStartListener=H(this._domNode.domNode,Ot.Start,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&(this._slider.toggleClassName("active",!0),this._gestureInProgress=!0,this.scrollDueToTouchEvent(i))},{passive:!1}),this._sliderTouchMoveListener=H(this._domNode.domNode,Ot.Change,i=>{i.preventDefault(),i.stopPropagation(),this._lastRenderData&&this._gestureInProgress&&this.scrollDueToTouchEvent(i)},{passive:!1}),this._sliderTouchEndListener=ci(this._domNode.domNode,Ot.End,i=>{i.preventDefault(),i.stopPropagation(),this._gestureInProgress=!1,this._slider.toggleClassName("active",!1)})}_startSliderDragging(e,t,i){if(!e.target||!(e.target instanceof Element))return;const n=e.pageX;this._slider.toggleClassName("active",!0);const s=(r,a)=>{const l=Ci(this._domNode.domNode),c=Math.min(Math.abs(a-n),Math.abs(a-l.left),Math.abs(a-l.left-l.width));if(En&&c>Tme){this._model.setScrollTop(i.scrollTop);return}const d=r-t;this._model.setScrollTop(i.getDesiredScrollTopFromDelta(d))};e.pageY!==t&&s(e.pageY,n),this._sliderPointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,r=>s(r.pageY,r.pageX),()=>{this._slider.toggleClassName("active",!1)})}scrollDueToTouchEvent(e){const t=this._domNode.domNode.getBoundingClientRect().top,i=this._lastRenderData.renderedLayout.getDesiredScrollTopFromTouchLocation(e.pageY-t);this._model.setScrollTop(i)}dispose(){this._pointerDownListener.dispose(),this._sliderPointerMoveMonitor.dispose(),this._sliderPointerDownListener.dispose(),this._gestureDisposable.dispose(),this._sliderTouchStartListener.dispose(),this._sliderTouchMoveListener.dispose(),this._sliderTouchEndListener.dispose(),super.dispose()}_getMinimapDomNodeClassName(){const e=["minimap"];return this._model.options.showSlider==="always"?e.push("slider-always"):e.push("slider-mouseover"),this._model.options.autohide&&e.push("autohide"),e.join(" ")}getDomNode(){return this._domNode}_applyLayout(){this._domNode.setLeft(this._model.options.minimapLeft),this._domNode.setWidth(this._model.options.minimapWidth),this._domNode.setHeight(this._model.options.minimapHeight),this._shadow.setHeight(this._model.options.minimapHeight),this._canvas.setWidth(this._model.options.canvasOuterWidth),this._canvas.setHeight(this._model.options.canvasOuterHeight),this._canvas.domNode.width=this._model.options.canvasInnerWidth,this._canvas.domNode.height=this._model.options.canvasInnerHeight,this._decorationsCanvas.setWidth(this._model.options.canvasOuterWidth),this._decorationsCanvas.setHeight(this._model.options.canvasOuterHeight),this._decorationsCanvas.domNode.width=this._model.options.canvasInnerWidth,this._decorationsCanvas.domNode.height=this._model.options.canvasInnerHeight,this._slider.setWidth(this._model.options.minimapWidth)}_getBuffer(){return this._buffers||this._model.options.canvasInnerWidth>0&&this._model.options.canvasInnerHeight>0&&(this._buffers=new PB(this._canvas.domNode.getContext("2d"),this._model.options.canvasInnerWidth,this._model.options.canvasInnerHeight,this._model.options.backgroundColor)),this._buffers?this._buffers.getBuffer():null}onDidChangeOptions(){this._lastRenderData=null,this._buffers=null,this._applyLayout(),this._domNode.setClassName(this._getMinimapDomNodeClassName())}onSelectionChanged(){return this._renderDecorations=!0,!0}onDecorationsChanged(){return this._renderDecorations=!0,!0}onFlushed(){return this._lastRenderData=null,!0}onLinesChanged(e,t){return this._lastRenderData?this._lastRenderData.onLinesChanged(e,t):!1}onLinesDeleted(e,t){return this._lastRenderData?.onLinesDeleted(e,t),!0}onLinesInserted(e,t){return this._lastRenderData?.onLinesInserted(e,t),!0}onScrollChanged(){return this._renderDecorations=!0,!0}onThemeChanged(){return this._selectionColor=this._theme.getColor(oH),this._renderDecorations=!0,!0}onTokensChanged(e){return this._lastRenderData?this._lastRenderData.onTokensChanged(e):!1}onTokensColorsChanged(){return this._lastRenderData=null,this._buffers=null,!0}onZonesChanged(){return this._lastRenderData=null,!0}render(e){if(this._model.options.renderMinimap===0){this._shadow.setClassName("minimap-shadow-hidden"),this._sliderHorizontal.setWidth(0),this._sliderHorizontal.setHeight(0);return}e.scrollLeft+e.viewportWidth>=e.scrollWidth?this._shadow.setClassName("minimap-shadow-hidden"):this._shadow.setClassName("minimap-shadow-visible");const i=iC.create(this._model.options,e.viewportStartLineNumber,e.viewportEndLineNumber,e.viewportStartLineNumberVerticalOffset,e.viewportHeight,e.viewportContainsWhitespaceGaps,this._model.getLineCount(),this._model.getRealLineCount(),e.scrollTop,e.scrollHeight,this._lastRenderData?this._lastRenderData.renderedLayout:null);this._slider.setDisplay(i.sliderNeeded?"block":"none"),this._slider.setTop(i.sliderTop),this._slider.setHeight(i.sliderHeight),this._sliderHorizontal.setLeft(0),this._sliderHorizontal.setWidth(this._model.options.minimapWidth),this._sliderHorizontal.setTop(0),this._sliderHorizontal.setHeight(i.sliderHeight),this.renderDecorations(i),this._lastRenderData=this.renderLines(i)}renderDecorations(e){if(this._renderDecorations){this._renderDecorations=!1;const t=this._model.getSelections();t.sort(L.compareRangesUsingStarts);const i=this._model.getMinimapDecorationsInViewport(e.startLineNumber,e.endLineNumber);i.sort((u,g)=>(u.options.zIndex||0)-(g.options.zIndex||0));const{canvasInnerWidth:n,canvasInnerHeight:s}=this._model.options,r=this._model.options.minimapLineHeight,a=this._model.options.minimapCharWidth,l=this._model.getOptions().tabSize,c=this._decorationsCanvas.domNode.getContext("2d");c.clearRect(0,0,n,s);const d=new d9(e.startLineNumber,e.endLineNumber,!1);this._renderSelectionLineHighlights(c,t,d,e,r),this._renderDecorationsLineHighlights(c,i,d,e,r);const h=new d9(e.startLineNumber,e.endLineNumber,null);this._renderSelectionsHighlights(c,t,h,e,r,l,a,n),this._renderDecorationsHighlights(c,i,h,e,r,l,a,n),this._renderSectionHeaders(e)}}_renderSelectionLineHighlights(e,t,i,n,s){if(!this._selectionColor||this._selectionColor.isTransparent())return;e.fillStyle=this._selectionColor.transparent(.5).toString();let r=0,a=0;for(const l of t){const c=n.intersectWithViewport(l);if(!c)continue;const[d,h]=c;for(let f=d;f<=h;f++)i.set(f,!0);const u=n.getYForLineNumber(d,s),g=n.getYForLineNumber(h,s);a>=u||(a>r&&e.fillRect(Ya,r,e.canvas.width,a-r),r=u),a=g}a>r&&e.fillRect(Ya,r,e.canvas.width,a-r)}_renderDecorationsLineHighlights(e,t,i,n,s){const r=new Map;for(let a=t.length-1;a>=0;a--){const l=t[a],c=l.options.minimap;if(!c||c.position!==1)continue;const d=n.intersectWithViewport(l.range);if(!d)continue;const[h,u]=d,g=c.getColor(this._theme.value);if(!g||g.isTransparent())continue;let f=r.get(g.toString());f||(f=g.transparent(.5).toString(),r.set(g.toString(),f)),e.fillStyle=f;for(let m=h;m<=u;m++){if(i.has(m))continue;i.set(m,!0);const _=n.getYForLineNumber(h,s);e.fillRect(Ya,_,e.canvas.width,s)}}}_renderSelectionsHighlights(e,t,i,n,s,r,a,l){if(!(!this._selectionColor||this._selectionColor.isTransparent()))for(const c of t){const d=n.intersectWithViewport(c);if(!d)continue;const[h,u]=d;for(let g=h;g<=u;g++)this.renderDecorationOnLine(e,i,c,this._selectionColor,n,g,s,s,r,a,l)}}_renderDecorationsHighlights(e,t,i,n,s,r,a,l){for(const c of t){const d=c.options.minimap;if(!d)continue;const h=n.intersectWithViewport(c.range);if(!h)continue;const[u,g]=h,f=d.getColor(this._theme.value);if(!(!f||f.isTransparent()))for(let m=u;m<=g;m++)switch(d.position){case 1:this.renderDecorationOnLine(e,i,c.range,f,n,m,s,s,r,a,l);continue;case 2:{const _=n.getYForLineNumber(m,s);this.renderDecoration(e,f,2,_,Dme,s);continue}}}}renderDecorationOnLine(e,t,i,n,s,r,a,l,c,d,h){const u=s.getYForLineNumber(r,l);if(u+a<0||u>this._model.options.canvasInnerHeight)return;const{startLineNumber:g,endLineNumber:f}=i,m=g===r?i.startColumn:1,_=f===r?i.endColumn:this._model.getLineMaxColumn(r),b=this.getXOffsetForPosition(t,r,m,c,d,h),v=this.getXOffsetForPosition(t,r,_,c,d,h);this.renderDecoration(e,n,b,u,v-b,a)}getXOffsetForPosition(e,t,i,n,s,r){if(i===1)return Ya;if((i-1)*s>=r)return r;let l=e.get(t);if(!l){const c=this._model.getLineContent(t);l=[Ya];let d=Ya;for(let h=1;h<c.length+1;h++){const u=c.charCodeAt(h-1),g=u===9?n*s:Ih(u)?2*s:s,f=d+g;if(f>=r){l[h]=r;break}l[h]=f,d=f}e.set(t,l)}return i-1<l.length?l[i-1]:r}renderDecoration(e,t,i,n,s,r){e.fillStyle=t&&t.toString()||"",e.fillRect(i,n,s,r)}_renderSectionHeaders(e){const t=this._model.options.minimapLineHeight,i=this._model.options.sectionHeaderFontSize,n=this._model.options.sectionHeaderLetterSpacing,s=i*1.5,{canvasInnerWidth:r}=this._model.options,a=this._model.options.backgroundColor,l=`rgb(${a.r} ${a.g} ${a.b} / .7)`,c=this._model.options.sectionHeaderFontColor,d=`rgb(${c.r} ${c.g} ${c.b})`,h=d,u=this._decorationsCanvas.domNode.getContext("2d");u.letterSpacing=n+"px",u.font="500 "+i+"px "+this._model.options.sectionHeaderFontFamily,u.strokeStyle=h,u.lineWidth=.2;const g=this._model.getSectionHeaderDecorationsInViewport(e.startLineNumber,e.endLineNumber);g.sort((m,_)=>m.range.startLineNumber-_.range.startLineNumber);const f=nm._fitSectionHeader.bind(null,u,r-Ya);for(const m of g){const _=e.getYForLineNumber(m.range.startLineNumber,t)+i,b=_-i,v=b+2,y=this._model.getSectionHeaderText(m,f);nm._renderSectionLabel(u,y,m.options.minimap?.sectionHeaderStyle===2,l,d,r,b,s,_,v)}}static _fitSectionHeader(e,t,i){if(!i)return i;const n="…",s=e.measureText(i).width,r=e.measureText(n).width;if(s<=t||s<=r)return i;const a=i.length,l=s/i.length,c=Math.floor((t-r)/l)-1;let d=Math.ceil(c/2);for(;d>0&&/\s/.test(i[d-1]);)--d;return i.substring(0,d)+n+i.substring(a-(c-d))}static _renderSectionLabel(e,t,i,n,s,r,a,l,c,d){t&&(e.fillStyle=n,e.fillRect(0,a,r,l),e.fillStyle=s,e.fillText(t,Ya,c)),i&&(e.beginPath(),e.moveTo(0,d),e.lineTo(r,d),e.closePath(),e.stroke())}renderLines(e){const t=e.startLineNumber,i=e.endLineNumber,n=this._model.options.minimapLineHeight;if(this._lastRenderData&&this._lastRenderData.linesEquals(e)){const Q=this._lastRenderData._get();return new c9(e,Q.imageData,Q.lines)}const s=this._getBuffer();if(!s)return null;const[r,a,l]=nm._renderUntouchedLines(s,e.topPaddingLineCount,t,i,n,this._lastRenderData),c=this._model.getMinimapLinesRenderingData(t,i,l),d=this._model.getOptions().tabSize,h=this._model.options.defaultBackgroundColor,u=this._model.options.backgroundColor,g=this._model.options.foregroundAlpha,f=this._model.tokensColorTracker,m=f.backgroundIsLight(),_=this._model.options.renderMinimap,b=this._model.options.charRenderer(),v=this._model.options.fontScale,y=this._model.options.minimapCharWidth,w=(_===1?2:3)*v,x=n>w?Math.floor((n-w)/2):0,k=u.a/255,E=new Hc(Math.round((u.r-h.r)*k+h.r),Math.round((u.g-h.g)*k+h.g),Math.round((u.b-h.b)*k+h.b),255);let N=e.topPaddingLineCount*n;const z=[];for(let Q=0,le=i-t+1;Q<le;Q++)l[Q]&&nm._renderLine(s,E,u.a,m,_,y,f,g,b,N,x,d,c[Q],v,n),z[Q]=new eL(N),N+=n;const B=r===-1?0:r,Z=(a===-1?s.height:a)-B;return this._canvas.domNode.getContext("2d").putImageData(s,0,0,0,B,s.width,Z),new c9(e,s,z)}static _renderUntouchedLines(e,t,i,n,s,r){const a=[];if(!r){for(let N=0,z=n-i+1;N<z;N++)a[N]=!0;return[-1,-1,a]}const l=r._get(),c=l.imageData.data,d=l.rendLineNumberStart,h=l.lines,u=h.length,g=e.width,f=e.data,m=(n-i+1)*s*g*4;let _=-1,b=-1,v=-1,y=-1,C=-1,w=-1,x=t*s;for(let N=i;N<=n;N++){const z=N-i,B=N-d,U=B>=0&&B<u?h[B].dy:-1;if(U===-1){a[z]=!0,x+=s;continue}const Z=U*g*4,V=(U+s)*g*4,Q=x*g*4,le=(x+s)*g*4;y===Z&&w===Q?(y=V,w=le):(v!==-1&&(f.set(c.subarray(v,y),C),_===-1&&v===0&&v===C&&(_=y),b===-1&&y===m&&v===C&&(b=v)),v=Z,y=V,C=Q,w=le),a[z]=!1,x+=s}v!==-1&&(f.set(c.subarray(v,y),C),_===-1&&v===0&&v===C&&(_=y),b===-1&&y===m&&v===C&&(b=v));const k=_===-1?-1:_/(g*4),E=b===-1?-1:b/(g*4);return[k,E,a]}static _renderLine(e,t,i,n,s,r,a,l,c,d,h,u,g,f,m){const _=g.content,b=g.tokens,v=e.width-r,y=m===1;let C=Ya,w=0,x=0;for(let k=0,E=b.getCount();k<E;k++){const N=b.getEndOffset(k),z=b.getForeground(k),B=a.getColor(z);for(;w<N;w++){if(C>v)return;const U=_.charCodeAt(w);if(U===9){const Z=u-(w+x)%u;x+=Z-1,C+=Z*r}else if(U===32)C+=r;else{const Z=Ih(U)?2:1;for(let V=0;V<Z;V++)if(s===2?c.blockRenderChar(e,C,d+h,B,l,t,i,y):c.renderChar(e,C,d+h,U,B,l,t,i,f,n,y),C+=r,C>v)return}}}}}class d9{constructor(e,t,i){this._startLineNumber=e,this._endLineNumber=t,this._defaultValue=i,this._values=[];for(let n=0,s=this._endLineNumber-this._startLineNumber+1;n<s;n++)this._values[n]=i}has(e){return this.get(e)!==this._defaultValue}set(e,t){e<this._startLineNumber||e>this._endLineNumber||(this._values[e-this._startLineNumber]=t)}get(e){return e<this._startLineNumber||e>this._endLineNumber?this._defaultValue:this._values[e-this._startLineNumber]}}class Nme extends go{constructor(e,t){super(e),this._viewDomNode=t;const n=this._context.configuration.options.get(146);this._widgets={},this._verticalScrollbarWidth=n.verticalScrollbarWidth,this._minimapWidth=n.minimap.minimapWidth,this._horizontalScrollbarHeight=n.horizontalScrollbarHeight,this._editorHeight=n.height,this._editorWidth=n.width,this._viewDomNodeRect={top:0,left:0,width:0,height:0},this._domNode=bt(document.createElement("div")),Aa.write(this._domNode,4),this._domNode.setClassName("overlayWidgets"),this.overflowingOverlayWidgetsDomNode=bt(document.createElement("div")),Aa.write(this.overflowingOverlayWidgetsDomNode,5),this.overflowingOverlayWidgetsDomNode.setClassName("overflowingOverlayWidgets")}dispose(){super.dispose(),this._widgets={}}getDomNode(){return this._domNode}onConfigurationChanged(e){const i=this._context.configuration.options.get(146);return this._verticalScrollbarWidth=i.verticalScrollbarWidth,this._minimapWidth=i.minimap.minimapWidth,this._horizontalScrollbarHeight=i.horizontalScrollbarHeight,this._editorHeight=i.height,this._editorWidth=i.width,!0}addWidget(e){const t=bt(e.getDomNode());this._widgets[e.getId()]={widget:e,preference:null,domNode:t},t.setPosition("absolute"),t.setAttribute("widgetId",e.getId()),e.allowEditorOverflow?this.overflowingOverlayWidgetsDomNode.appendChild(t):this._domNode.appendChild(t),this.setShouldRender(),this._updateMaxMinWidth()}setWidgetPosition(e,t){const i=this._widgets[e.getId()],n=t?t.preference:null,s=t?.stackOridinal;return i.preference===n&&i.stack===s?(this._updateMaxMinWidth(),!1):(i.preference=n,i.stack=s,this.setShouldRender(),this._updateMaxMinWidth(),!0)}removeWidget(e){const t=e.getId();if(this._widgets.hasOwnProperty(t)){const n=this._widgets[t].domNode.domNode;delete this._widgets[t],n.remove(),this.setShouldRender(),this._updateMaxMinWidth()}}_updateMaxMinWidth(){let e=0;const t=Object.keys(this._widgets);for(let i=0,n=t.length;i<n;i++){const s=t[i],a=this._widgets[s].widget.getMinContentWidthInPx?.();typeof a<"u"&&(e=Math.max(e,a))}this._context.viewLayout.setOverlayWidgetsMinWidth(e)}_renderWidget(e,t){const i=e.domNode;if(e.preference===null){i.setTop("");return}const n=2*this._verticalScrollbarWidth+this._minimapWidth;if(e.preference===0||e.preference===1){if(e.preference===1){const s=i.domNode.clientHeight;i.setTop(this._editorHeight-s-2*this._horizontalScrollbarHeight)}else i.setTop(0);e.stack!==void 0?(i.setTop(t[e.preference]),t[e.preference]+=i.domNode.clientWidth):i.setRight(n)}else if(e.preference===2)i.domNode.style.right="50%",e.stack!==void 0?(i.setTop(t[2]),t[2]+=i.domNode.clientHeight):i.setTop(0);else{const{top:s,left:r}=e.preference;if(this._context.configuration.options.get(42)&&e.widget.allowEditorOverflow){const l=this._viewDomNodeRect;i.setTop(s+l.top),i.setLeft(r+l.left),i.setPosition("fixed")}else i.setTop(s),i.setLeft(r),i.setPosition("absolute")}}prepareRender(e){this._viewDomNodeRect=Ci(this._viewDomNode.domNode)}render(e){this._domNode.setWidth(this._editorWidth);const t=Object.keys(this._widgets),i=Array.from({length:3},()=>0);t.sort((n,s)=>(this._widgets[n].stack||0)-(this._widgets[s].stack||0));for(let n=0,s=t.length;n<s;n++){const r=t[n];this._renderWidget(this._widgets[r],i)}}}class Rme{constructor(e,t){const i=e.options;this.lineHeight=i.get(67),this.pixelRatio=i.get(144),this.overviewRulerLanes=i.get(83),this.renderBorder=i.get(82);const n=t.getColor(Dce);this.borderColor=n?n.toString():null,this.hideCursor=i.get(59);const s=t.getColor(KT);this.cursorColorSingle=s?s.transparent(.7).toString():null;const r=t.getColor(d$);this.cursorColorPrimary=r?r.transparent(.7).toString():null;const a=t.getColor(h$);this.cursorColorSecondary=a?a.transparent(.7).toString():null,this.themeType=t.type;const l=i.get(73),c=l.enabled,d=l.side,h=t.getColor(Ice),u=gi.getDefaultBackground();h?this.backgroundColor=h:c&&d==="right"?this.backgroundColor=u:this.backgroundColor=null;const f=i.get(146).overviewRuler;this.top=f.top,this.right=f.right,this.domWidth=f.width,this.domHeight=f.height,this.overviewRulerLanes===0?(this.canvasWidth=0,this.canvasHeight=0):(this.canvasWidth=this.domWidth*this.pixelRatio|0,this.canvasHeight=this.domHeight*this.pixelRatio|0);const[m,_]=this._initLanes(1,this.canvasWidth,this.overviewRulerLanes);this.x=m,this.w=_}_initLanes(e,t,i){const n=t-e;if(i>=3){const s=Math.floor(n/3),r=Math.floor(n/3),a=n-s-r,l=e,c=l+s,d=l+s+a;return[[0,l,c,l,d,l,c,l],[0,s,a,s+a,r,s+a+r,a+r,s+a+r]]}else if(i===2){const s=Math.floor(n/2),r=n-s,a=e,l=a+s;return[[0,a,a,a,l,a,a,a],[0,s,s,s,r,s+r,s+r,s+r]]}else{const s=e,r=n;return[[0,s,s,s,s,s,s,s],[0,r,r,r,r,r,r,r]]}}equals(e){return this.lineHeight===e.lineHeight&&this.pixelRatio===e.pixelRatio&&this.overviewRulerLanes===e.overviewRulerLanes&&this.renderBorder===e.renderBorder&&this.borderColor===e.borderColor&&this.hideCursor===e.hideCursor&&this.cursorColorSingle===e.cursorColorSingle&&this.cursorColorPrimary===e.cursorColorPrimary&&this.cursorColorSecondary===e.cursorColorSecondary&&this.themeType===e.themeType&&j.equals(this.backgroundColor,e.backgroundColor)&&this.top===e.top&&this.right===e.right&&this.domWidth===e.domWidth&&this.domHeight===e.domHeight&&this.canvasWidth===e.canvasWidth&&this.canvasHeight===e.canvasHeight}}class Pme extends go{constructor(e){super(e),this._actualShouldRender=0,this._renderedDecorations=[],this._renderedCursorPositions=[],this._domNode=bt(document.createElement("canvas")),this._domNode.setClassName("decorationsOverviewRuler"),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._domNode.setAttribute("aria-hidden","true"),this._updateSettings(!1),this._tokensColorTrackerListener=gi.onDidChange(t=>{t.changedColorMap&&this._updateSettings(!0)}),this._cursorPositions=[{position:new A(1,1),color:this._settings.cursorColorSingle}]}dispose(){super.dispose(),this._tokensColorTrackerListener.dispose()}_updateSettings(e){const t=new Rme(this._context.configuration,this._context.theme);return this._settings&&this._settings.equals(t)?!1:(this._settings=t,this._domNode.setTop(this._settings.top),this._domNode.setRight(this._settings.right),this._domNode.setWidth(this._settings.domWidth),this._domNode.setHeight(this._settings.domHeight),this._domNode.domNode.width=this._settings.canvasWidth,this._domNode.domNode.height=this._settings.canvasHeight,e&&this._render(),!0)}_markRenderingIsNeeded(){return this._actualShouldRender=2,!0}_markRenderingIsMaybeNeeded(){return this._actualShouldRender=1,!0}onConfigurationChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}onCursorStateChanged(e){this._cursorPositions=[];for(let t=0,i=e.selections.length;t<i;t++){let n=this._settings.cursorColorSingle;i>1&&(n=t===0?this._settings.cursorColorPrimary:this._settings.cursorColorSecondary),this._cursorPositions.push({position:e.selections[t].getPosition(),color:n})}return this._cursorPositions.sort((t,i)=>A.compare(t.position,i.position)),this._markRenderingIsMaybeNeeded()}onDecorationsChanged(e){return e.affectsOverviewRuler?this._markRenderingIsMaybeNeeded():!1}onFlushed(e){return this._markRenderingIsNeeded()}onScrollChanged(e){return e.scrollHeightChanged?this._markRenderingIsNeeded():!1}onZonesChanged(e){return this._markRenderingIsNeeded()}onThemeChanged(e){return this._updateSettings(!1)?this._markRenderingIsNeeded():!1}getDomNode(){return this._domNode.domNode}prepareRender(e){}render(e){this._render(),this._actualShouldRender=0}_render(){const e=this._settings.backgroundColor;if(this._settings.overviewRulerLanes===0){this._domNode.setBackgroundColor(e?j.Format.CSS.formatHexA(e):""),this._domNode.setDisplay("none");return}const t=this._context.viewModel.getAllOverviewRulerDecorations(this._context.theme);if(t.sort(Dy.compareByRenderingProps),this._actualShouldRender===1&&!Dy.equalsArr(this._renderedDecorations,t)&&(this._actualShouldRender=2),this._actualShouldRender===1&&!ei(this._renderedCursorPositions,this._cursorPositions,(f,m)=>f.position.lineNumber===m.position.lineNumber&&f.color===m.color)&&(this._actualShouldRender=2),this._actualShouldRender===1)return;this._renderedDecorations=t,this._renderedCursorPositions=this._cursorPositions,this._domNode.setDisplay("block");const i=this._settings.canvasWidth,n=this._settings.canvasHeight,s=this._settings.lineHeight,r=this._context.viewLayout,a=this._context.viewLayout.getScrollHeight(),l=n/a,c=6*this._settings.pixelRatio|0,d=c/2|0,h=this._domNode.domNode.getContext("2d");e?e.isOpaque()?(h.fillStyle=j.Format.CSS.formatHexA(e),h.fillRect(0,0,i,n)):(h.clearRect(0,0,i,n),h.fillStyle=j.Format.CSS.formatHexA(e),h.fillRect(0,0,i,n)):h.clearRect(0,0,i,n);const u=this._settings.x,g=this._settings.w;for(const f of t){const m=f.color,_=f.data;h.fillStyle=m;let b=0,v=0,y=0;for(let C=0,w=_.length/3;C<w;C++){const x=_[3*C],k=_[3*C+1],E=_[3*C+2];let N=r.getVerticalOffsetForLineNumber(k)*l|0,z=(r.getVerticalOffsetForLineNumber(E)+s)*l|0;if(z-N<c){let U=(N+z)/2|0;U<d?U=d:U+d>n&&(U=n-d),N=U-d,z=U+d}N>y+1||x!==b?(C!==0&&h.fillRect(u[b],v,g[b],y-v),b=x,v=N,y=z):z>y&&(y=z)}h.fillRect(u[b],v,g[b],y-v)}if(!this._settings.hideCursor){const f=2*this._settings.pixelRatio|0,m=f/2|0,_=this._settings.x[7],b=this._settings.w[7];let v=-100,y=-100,C=null;for(let w=0,x=this._cursorPositions.length;w<x;w++){const k=this._cursorPositions[w].color;if(!k)continue;const E=this._cursorPositions[w].position;let N=r.getVerticalOffsetForLineNumber(E.lineNumber)*l|0;N<m?N=m:N+m>n&&(N=n-m);const z=N-m,B=z+f;z>y+1||k!==C?(w!==0&&C&&h.fillRect(_,v,b,y-v),v=z,y=B):B>y&&(y=B),C=k,h.fillStyle=k}C&&h.fillRect(_,v,b,y-v)}this._settings.renderBorder&&this._settings.borderColor&&this._settings.overviewRulerLanes>0&&(h.beginPath(),h.lineWidth=1,h.strokeStyle=this._settings.borderColor,h.moveTo(0,0),h.lineTo(0,n),h.moveTo(1,0),h.lineTo(i,0),h.stroke())}}class h9{constructor(e,t,i){this._colorZoneBrand=void 0,this.from=e|0,this.to=t|0,this.colorId=i|0}static compare(e,t){return e.colorId===t.colorId?e.from===t.from?e.to-t.to:e.from-t.from:e.colorId-t.colorId}}class ej{constructor(e,t,i,n){this._overviewRulerZoneBrand=void 0,this.startLineNumber=e,this.endLineNumber=t,this.heightInLines=i,this.color=n,this._colorZone=null}static compare(e,t){return e.color===t.color?e.startLineNumber===t.startLineNumber?e.heightInLines===t.heightInLines?e.endLineNumber-t.endLineNumber:e.heightInLines-t.heightInLines:e.startLineNumber-t.startLineNumber:e.color<t.color?-1:1}setColorZone(e){this._colorZone=e}getColorZones(){return this._colorZone}}class Ame{constructor(e){this._getVerticalOffsetForLine=e,this._zones=[],this._colorZonesInvalid=!1,this._lineHeight=0,this._domWidth=0,this._domHeight=0,this._outerHeight=0,this._pixelRatio=1,this._lastAssignedId=0,this._color2Id=Object.create(null),this._id2Color=[]}getId2Color(){return this._id2Color}setZones(e){this._zones=e,this._zones.sort(ej.compare)}setLineHeight(e){return this._lineHeight===e?!1:(this._lineHeight=e,this._colorZonesInvalid=!0,!0)}setPixelRatio(e){this._pixelRatio=e,this._colorZonesInvalid=!0}getDOMWidth(){return this._domWidth}getCanvasWidth(){return this._domWidth*this._pixelRatio}setDOMWidth(e){return this._domWidth===e?!1:(this._domWidth=e,this._colorZonesInvalid=!0,!0)}getDOMHeight(){return this._domHeight}getCanvasHeight(){return this._domHeight*this._pixelRatio}setDOMHeight(e){return this._domHeight===e?!1:(this._domHeight=e,this._colorZonesInvalid=!0,!0)}getOuterHeight(){return this._outerHeight}setOuterHeight(e){return this._outerHeight===e?!1:(this._outerHeight=e,this._colorZonesInvalid=!0,!0)}resolveColorZones(){const e=this._colorZonesInvalid,t=Math.floor(this._lineHeight),i=Math.floor(this.getCanvasHeight()),n=Math.floor(this._outerHeight),s=i/n,r=Math.floor(4*this._pixelRatio/2),a=[];for(let l=0,c=this._zones.length;l<c;l++){const d=this._zones[l];if(!e){const C=d.getColorZones();if(C){a.push(C);continue}}const h=this._getVerticalOffsetForLine(d.startLineNumber),u=d.heightInLines===0?this._getVerticalOffsetForLine(d.endLineNumber)+t:h+d.heightInLines*t,g=Math.floor(s*h),f=Math.floor(s*u);let m=Math.floor((g+f)/2),_=f-m;_<r&&(_=r),m-_<0&&(m=_),m+_>i&&(m=i-_);const b=d.color;let v=this._color2Id[b];v||(v=++this._lastAssignedId,this._color2Id[b]=v,this._id2Color[v]=b);const y=new h9(m-_,m+_,v);d.setColorZone(y),a.push(y)}return this._colorZonesInvalid=!1,a.sort(h9.compare),a}}class Mme extends Kw{constructor(e,t){super(),this._context=e;const i=this._context.configuration.options;this._domNode=bt(document.createElement("canvas")),this._domNode.setClassName(t),this._domNode.setPosition("absolute"),this._domNode.setLayerHinting(!0),this._domNode.setContain("strict"),this._zoneManager=new Ame(n=>this._context.viewLayout.getVerticalOffsetForLineNumber(n)),this._zoneManager.setDOMWidth(0),this._zoneManager.setDOMHeight(0),this._zoneManager.setOuterHeight(this._context.viewLayout.getScrollHeight()),this._zoneManager.setLineHeight(i.get(67)),this._zoneManager.setPixelRatio(i.get(144)),this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return e.hasChanged(67)&&(this._zoneManager.setLineHeight(t.get(67)),this._render()),e.hasChanged(144)&&(this._zoneManager.setPixelRatio(t.get(144)),this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render()),!0}onFlushed(e){return this._render(),!0}onScrollChanged(e){return e.scrollHeightChanged&&(this._zoneManager.setOuterHeight(e.scrollHeight),this._render()),!0}onZonesChanged(e){return this._render(),!0}getDomNode(){return this._domNode.domNode}setLayout(e){this._domNode.setTop(e.top),this._domNode.setRight(e.right);let t=!1;t=this._zoneManager.setDOMWidth(e.width)||t,t=this._zoneManager.setDOMHeight(e.height)||t,t&&(this._domNode.setWidth(this._zoneManager.getDOMWidth()),this._domNode.setHeight(this._zoneManager.getDOMHeight()),this._domNode.domNode.width=this._zoneManager.getCanvasWidth(),this._domNode.domNode.height=this._zoneManager.getCanvasHeight(),this._render())}setZones(e){this._zoneManager.setZones(e),this._render()}_render(){if(this._zoneManager.getOuterHeight()===0)return!1;const e=this._zoneManager.getCanvasWidth(),t=this._zoneManager.getCanvasHeight(),i=this._zoneManager.resolveColorZones(),n=this._zoneManager.getId2Color(),s=this._domNode.domNode.getContext("2d");return s.clearRect(0,0,e,t),i.length>0&&this._renderOneLane(s,i,n,e),!0}_renderOneLane(e,t,i,n){let s=0,r=0,a=0;for(const l of t){const c=l.colorId,d=l.from,h=l.to;c!==s?(e.fillRect(0,r,n,a-r),s=c,e.fillStyle=i[s],r=d,a=h):a>=d?a=Math.max(a,h):(e.fillRect(0,r,n,a-r),r=d,a=h)}e.fillRect(0,r,n,a-r)}}class Ome extends go{constructor(e){super(e),this.domNode=bt(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.domNode.setClassName("view-rulers"),this._renderedRulers=[];const t=this._context.configuration.options;this._rulers=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth}dispose(){super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._rulers=t.get(103),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onScrollChanged(e){return e.scrollHeightChanged}prepareRender(e){}_ensureRulersCount(){const e=this._renderedRulers.length,t=this._rulers.length;if(e===t)return;if(e<t){const{tabSize:n}=this._context.viewModel.model.getOptions(),s=n;let r=t-e;for(;r>0;){const a=bt(document.createElement("div"));a.setClassName("view-ruler"),a.setWidth(s),this.domNode.appendChild(a),this._renderedRulers.push(a),r--}return}let i=e-t;for(;i>0;){const n=this._renderedRulers.pop();this.domNode.removeChild(n),i--}}render(e){this._ensureRulersCount();for(let t=0,i=this._rulers.length;t<i;t++){const n=this._renderedRulers[t],s=this._rulers[t];n.setBoxShadow(s.color?`1px 0 0 0 ${s.color} inset`:""),n.setHeight(Math.min(e.scrollHeight,1e6)),n.setLeft(s.column*this._typicalHalfwidthCharacterWidth)}}}class Fme extends go{constructor(e){super(e),this._scrollTop=0,this._width=0,this._updateWidth(),this._shouldShow=!1;const i=this._context.configuration.options.get(104);this._useShadows=i.useShadows,this._domNode=bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true")}dispose(){super.dispose()}_updateShouldShow(){const e=this._useShadows&&this._scrollTop>0;return this._shouldShow!==e?(this._shouldShow=e,!0):!1}getDomNode(){return this._domNode}_updateWidth(){const t=this._context.configuration.options.get(146);t.minimap.renderMinimap===0||t.minimap.minimapWidth>0&&t.minimap.minimapLeft===0?this._width=t.width:this._width=t.width-t.verticalScrollbarWidth}onConfigurationChanged(e){const i=this._context.configuration.options.get(104);return this._useShadows=i.useShadows,this._updateWidth(),this._updateShouldShow(),!0}onScrollChanged(e){return this._scrollTop=e.scrollTop,this._updateShouldShow()}prepareRender(e){}render(e){this._domNode.setWidth(this._width),this._domNode.setClassName(this._shouldShow?"scroll-decoration":"")}}class Bme{constructor(e){this.left=e.left,this.width=e.width,this.startStyle=null,this.endStyle=null}}class Wme{constructor(e,t){this.lineNumber=e,this.ranges=t}}function Vme(o){return new Bme(o)}function Hme(o){return new Wme(o.lineNumber,o.ranges.map(Vme))}const xi=class xi extends Jf{constructor(e){super(),this._previousFrameVisibleRangesWithStyle=[],this._context=e;const t=this._context.configuration.options;this._roundedSelection=t.get(102),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,this._selections=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=this._context.configuration.options;return this._roundedSelection=t.get(102),this._typicalHalfwidthCharacterWidth=t.get(50).typicalHalfwidthCharacterWidth,!0}onCursorStateChanged(e){return this._selections=e.selections.slice(0),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}_visibleRangesHaveGaps(e){for(let t=0,i=e.length;t<i;t++)if(e[t].ranges.length>1)return!0;return!1}_enrichVisibleRangesWithStyle(e,t,i){const n=this._typicalHalfwidthCharacterWidth/4;let s=null,r=null;if(i&&i.length>0&&t.length>0){const a=t[0].lineNumber;if(a===e.startLineNumber)for(let c=0;!s&&c<i.length;c++)i[c].lineNumber===a&&(s=i[c].ranges[0]);const l=t[t.length-1].lineNumber;if(l===e.endLineNumber)for(let c=i.length-1;!r&&c>=0;c--)i[c].lineNumber===l&&(r=i[c].ranges[0]);s&&!s.startStyle&&(s=null),r&&!r.startStyle&&(r=null)}for(let a=0,l=t.length;a<l;a++){const c=t[a].ranges[0],d=c.left,h=c.left+c.width,u={top:0,bottom:0},g={top:0,bottom:0};if(a>0){const f=t[a-1].ranges[0].left,m=t[a-1].ranges[0].left+t[a-1].ranges[0].width;YS(d-f)<n?u.top=2:d>f&&(u.top=1),YS(h-m)<n?g.top=2:f<h&&h<m&&(g.top=1)}else s&&(u.top=s.startStyle.top,g.top=s.endStyle.top);if(a+1<l){const f=t[a+1].ranges[0].left,m=t[a+1].ranges[0].left+t[a+1].ranges[0].width;YS(d-f)<n?u.bottom=2:f<d&&d<m&&(u.bottom=1),YS(h-m)<n?g.bottom=2:h<m&&(g.bottom=1)}else r&&(u.bottom=r.startStyle.bottom,g.bottom=r.endStyle.bottom);c.startStyle=u,c.endStyle=g}}_getVisibleRangesWithStyle(e,t,i){const s=(t.linesVisibleRangesForRange(e,!0)||[]).map(Hme);return!this._visibleRangesHaveGaps(s)&&this._roundedSelection&&this._enrichVisibleRangesWithStyle(t.visibleRange,s,i),s}_createSelectionPiece(e,t,i,n,s){return'<div class="cslr '+i+'" style="top:'+e.toString()+"px;bottom:"+t.toString()+"px;left:"+n.toString()+"px;width:"+s.toString()+'px;"></div>'}_actualRenderOneSelection(e,t,i,n){if(n.length===0)return;const s=!!n[0].ranges[0].startStyle,r=n[0].lineNumber,a=n[n.length-1].lineNumber;for(let l=0,c=n.length;l<c;l++){const d=n[l],h=d.lineNumber,u=h-t,g=i&&h===r?1:0,f=i&&h!==r&&h===a?1:0;let m="",_="";for(let b=0,v=d.ranges.length;b<v;b++){const y=d.ranges[b];if(s){const w=y.startStyle,x=y.endStyle;if(w.top===1||w.bottom===1){m+=this._createSelectionPiece(g,f,xi.SELECTION_CLASS_NAME,y.left-xi.ROUNDED_PIECE_WIDTH,xi.ROUNDED_PIECE_WIDTH);let k=xi.EDITOR_BACKGROUND_CLASS_NAME;w.top===1&&(k+=" "+xi.SELECTION_TOP_RIGHT),w.bottom===1&&(k+=" "+xi.SELECTION_BOTTOM_RIGHT),m+=this._createSelectionPiece(g,f,k,y.left-xi.ROUNDED_PIECE_WIDTH,xi.ROUNDED_PIECE_WIDTH)}if(x.top===1||x.bottom===1){m+=this._createSelectionPiece(g,f,xi.SELECTION_CLASS_NAME,y.left+y.width,xi.ROUNDED_PIECE_WIDTH);let k=xi.EDITOR_BACKGROUND_CLASS_NAME;x.top===1&&(k+=" "+xi.SELECTION_TOP_LEFT),x.bottom===1&&(k+=" "+xi.SELECTION_BOTTOM_LEFT),m+=this._createSelectionPiece(g,f,k,y.left+y.width,xi.ROUNDED_PIECE_WIDTH)}}let C=xi.SELECTION_CLASS_NAME;if(s){const w=y.startStyle,x=y.endStyle;w.top===0&&(C+=" "+xi.SELECTION_TOP_LEFT),w.bottom===0&&(C+=" "+xi.SELECTION_BOTTOM_LEFT),x.top===0&&(C+=" "+xi.SELECTION_TOP_RIGHT),x.bottom===0&&(C+=" "+xi.SELECTION_BOTTOM_RIGHT)}_+=this._createSelectionPiece(g,f,C,y.left,y.width)}e[u][0]+=m,e[u][1]+=_}}prepareRender(e){const t=[],i=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber;for(let r=i;r<=n;r++){const a=r-i;t[a]=["",""]}const s=[];for(let r=0,a=this._selections.length;r<a;r++){const l=this._selections[r];if(l.isEmpty()){s[r]=null;continue}const c=this._getVisibleRangesWithStyle(l,e,this._previousFrameVisibleRangesWithStyle[r]);s[r]=c,this._actualRenderOneSelection(t,i,this._selections.length>1,c)}this._previousFrameVisibleRangesWithStyle=s,this._renderResult=t.map(([r,a])=>r+a)}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}};xi.SELECTION_CLASS_NAME="selected-text",xi.SELECTION_TOP_LEFT="top-left-radius",xi.SELECTION_BOTTOM_LEFT="bottom-left-radius",xi.SELECTION_TOP_RIGHT="top-right-radius",xi.SELECTION_BOTTOM_RIGHT="bottom-right-radius",xi.EDITOR_BACKGROUND_CLASS_NAME="monaco-editor-background",xi.ROUNDED_PIECE_WIDTH=10;let QM=xi;br((o,e)=>{const t=o.getColor(Yne);t&&!t.isTransparent()&&e.addRule(`.monaco-editor .view-line span.inline-selected-text { color: ${t}; }`)});function YS(o){return o<0?-o:o}class u9{constructor(e,t,i,n,s,r,a){this.top=e,this.left=t,this.paddingLeft=i,this.width=n,this.height=s,this.textContent=r,this.textContentClassName=a}}var Ic;(function(o){o[o.Single=0]="Single",o[o.MultiPrimary=1]="MultiPrimary",o[o.MultiSecondary=2]="MultiSecondary"})(Ic||(Ic={}));class g9{constructor(e,t){this._context=e;const i=this._context.configuration.options,n=i.get(50);this._cursorStyle=i.get(28),this._lineHeight=i.get(67),this._typicalHalfwidthCharacterWidth=n.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(i.get(31),this._typicalHalfwidthCharacterWidth),this._isVisible=!0,this._domNode=bt(document.createElement("div")),this._domNode.setClassName(`cursor ${jm}`),this._domNode.setHeight(this._lineHeight),this._domNode.setTop(0),this._domNode.setLeft(0),mn(this._domNode,n),this._domNode.setDisplay("none"),this._position=new A(1,1),this._pluralityClass="",this.setPlurality(t),this._lastRenderedContent="",this._renderData=null}getDomNode(){return this._domNode}getPosition(){return this._position}setPlurality(e){switch(e){default:case Ic.Single:this._pluralityClass="";break;case Ic.MultiPrimary:this._pluralityClass="cursor-primary";break;case Ic.MultiSecondary:this._pluralityClass="cursor-secondary";break}}show(){this._isVisible||(this._domNode.setVisibility("inherit"),this._isVisible=!0)}hide(){this._isVisible&&(this._domNode.setVisibility("hidden"),this._isVisible=!1)}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(50);return this._cursorStyle=t.get(28),this._lineHeight=t.get(67),this._typicalHalfwidthCharacterWidth=i.typicalHalfwidthCharacterWidth,this._lineCursorWidth=Math.min(t.get(31),this._typicalHalfwidthCharacterWidth),mn(this._domNode,i),!0}onCursorPositionChanged(e,t){return t?this._domNode.domNode.style.transitionProperty="none":this._domNode.domNode.style.transitionProperty="",this._position=e,!0}_getGraphemeAwarePosition(){const{lineNumber:e,column:t}=this._position,i=this._context.viewModel.getLineContent(e),[n,s]=GQ(i,t-1);return[new A(e,n+1),i.substring(n,s)]}_prepareRender(e){let t="",i="";const[n,s]=this._getGraphemeAwarePosition();if(this._cursorStyle===un.Line||this._cursorStyle===un.LineThin){const u=e.visibleRangeForPosition(n);if(!u||u.outsideRenderedLine)return null;const g=xe(this._domNode.domNode);let f;this._cursorStyle===un.Line?(f=z3(g,this._lineCursorWidth>0?this._lineCursorWidth:2),f>2&&(t=s,i=this._getTokenClassName(n))):f=z3(g,1);let m=u.left,_=0;f>=2&&m>=1&&(_=1,m-=_);const b=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta;return new u9(b,m,_,f,this._lineHeight,t,i)}const r=e.linesVisibleRangesForRange(new L(n.lineNumber,n.column,n.lineNumber,n.column+s.length),!1);if(!r||r.length===0)return null;const a=r[0];if(a.outsideRenderedLine||a.ranges.length===0)return null;const l=a.ranges[0],c=s==="	"?this._typicalHalfwidthCharacterWidth:l.width<1?this._typicalHalfwidthCharacterWidth:l.width;this._cursorStyle===un.Block&&(t=s,i=this._getTokenClassName(n));let d=e.getVerticalOffsetForLineNumber(n.lineNumber)-e.bigNumbersDelta,h=this._lineHeight;return(this._cursorStyle===un.Underline||this._cursorStyle===un.UnderlineThin)&&(d+=this._lineHeight-2,h=2),new u9(d,l.left,0,c,h,t,i)}_getTokenClassName(e){const t=this._context.viewModel.getViewLineData(e.lineNumber),i=t.tokens.findTokenIndexAtOffset(e.column-1);return t.tokens.getClassName(i)}prepareRender(e){this._renderData=this._prepareRender(e)}render(e){return this._renderData?(this._lastRenderedContent!==this._renderData.textContent&&(this._lastRenderedContent=this._renderData.textContent,this._domNode.domNode.textContent=this._lastRenderedContent),this._domNode.setClassName(`cursor ${this._pluralityClass} ${jm} ${this._renderData.textContentClassName}`),this._domNode.setDisplay("block"),this._domNode.setTop(this._renderData.top),this._domNode.setLeft(this._renderData.left),this._domNode.setPaddingLeft(this._renderData.paddingLeft),this._domNode.setWidth(this._renderData.width),this._domNode.setLineHeight(this._renderData.height),this._domNode.setHeight(this._renderData.height),{domNode:this._domNode.domNode,position:this._position,contentLeft:this._renderData.left,height:this._renderData.height,width:2}):(this._domNode.setDisplay("none"),null)}}const NC=class NC extends go{constructor(e){super(e);const t=this._context.configuration.options;this._readOnly=t.get(92),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._selectionIsEmpty=!0,this._isComposingInput=!1,this._isVisible=!1,this._primaryCursor=new g9(this._context,Ic.Single),this._secondaryCursors=[],this._renderData=[],this._domNode=bt(document.createElement("div")),this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true"),this._updateDomClassName(),this._domNode.appendChild(this._primaryCursor.getDomNode()),this._startCursorBlinkAnimation=new qr,this._cursorFlatBlinkInterval=new H4,this._blinkingEnabled=!1,this._editorHasFocus=!1,this._updateBlinking()}dispose(){super.dispose(),this._startCursorBlinkAnimation.dispose(),this._cursorFlatBlinkInterval.dispose()}getDomNode(){return this._domNode}onCompositionStart(e){return this._isComposingInput=!0,this._updateBlinking(),!0}onCompositionEnd(e){return this._isComposingInput=!1,this._updateBlinking(),!0}onConfigurationChanged(e){const t=this._context.configuration.options;this._readOnly=t.get(92),this._cursorBlinking=t.get(26),this._cursorStyle=t.get(28),this._cursorSmoothCaretAnimation=t.get(27),this._updateBlinking(),this._updateDomClassName(),this._primaryCursor.onConfigurationChanged(e);for(let i=0,n=this._secondaryCursors.length;i<n;i++)this._secondaryCursors[i].onConfigurationChanged(e);return!0}_onCursorPositionChanged(e,t,i){const n=this._secondaryCursors.length!==t.length||this._cursorSmoothCaretAnimation==="explicit"&&i!==3;if(this._primaryCursor.setPlurality(t.length?Ic.MultiPrimary:Ic.Single),this._primaryCursor.onCursorPositionChanged(e,n),this._updateBlinking(),this._secondaryCursors.length<t.length){const s=t.length-this._secondaryCursors.length;for(let r=0;r<s;r++){const a=new g9(this._context,Ic.MultiSecondary);this._domNode.domNode.insertBefore(a.getDomNode().domNode,this._primaryCursor.getDomNode().domNode.nextSibling),this._secondaryCursors.push(a)}}else if(this._secondaryCursors.length>t.length){const s=this._secondaryCursors.length-t.length;for(let r=0;r<s;r++)this._domNode.removeChild(this._secondaryCursors[0].getDomNode()),this._secondaryCursors.splice(0,1)}for(let s=0;s<t.length;s++)this._secondaryCursors[s].onCursorPositionChanged(t[s],n)}onCursorStateChanged(e){const t=[];for(let n=0,s=e.selections.length;n<s;n++)t[n]=e.selections[n].getPosition();this._onCursorPositionChanged(t[0],t.slice(1),e.reason);const i=e.selections[0].isEmpty();return this._selectionIsEmpty!==i&&(this._selectionIsEmpty=i,this._updateDomClassName()),!0}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onFocusChanged(e){return this._editorHasFocus=e.isFocused,this._updateBlinking(),!1}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return!0}onTokensChanged(e){const t=i=>{for(let n=0,s=e.ranges.length;n<s;n++)if(e.ranges[n].fromLineNumber<=i.lineNumber&&i.lineNumber<=e.ranges[n].toLineNumber)return!0;return!1};if(t(this._primaryCursor.getPosition()))return!0;for(const i of this._secondaryCursors)if(t(i.getPosition()))return!0;return!1}onZonesChanged(e){return!0}_getCursorBlinking(){return this._isComposingInput||!this._editorHasFocus?0:this._readOnly?5:this._cursorBlinking}_updateBlinking(){this._startCursorBlinkAnimation.cancel(),this._cursorFlatBlinkInterval.cancel();const e=this._getCursorBlinking(),t=e===0,i=e===5;t?this._hide():this._show(),this._blinkingEnabled=!1,this._updateDomClassName(),!t&&!i&&(e===1?this._cursorFlatBlinkInterval.cancelAndSet(()=>{this._isVisible?this._hide():this._show()},NC.BLINK_INTERVAL,xe(this._domNode.domNode)):this._startCursorBlinkAnimation.setIfNotSet(()=>{this._blinkingEnabled=!0,this._updateDomClassName()},NC.BLINK_INTERVAL))}_updateDomClassName(){this._domNode.setClassName(this._getClassName())}_getClassName(){let e="cursors-layer";switch(this._selectionIsEmpty||(e+=" has-selection"),this._cursorStyle){case un.Line:e+=" cursor-line-style";break;case un.Block:e+=" cursor-block-style";break;case un.Underline:e+=" cursor-underline-style";break;case un.LineThin:e+=" cursor-line-thin-style";break;case un.BlockOutline:e+=" cursor-block-outline-style";break;case un.UnderlineThin:e+=" cursor-underline-thin-style";break;default:e+=" cursor-line-style"}if(this._blinkingEnabled)switch(this._getCursorBlinking()){case 1:e+=" cursor-blink";break;case 2:e+=" cursor-smooth";break;case 3:e+=" cursor-phase";break;case 4:e+=" cursor-expand";break;case 5:e+=" cursor-solid";break;default:e+=" cursor-solid"}else e+=" cursor-solid";return(this._cursorSmoothCaretAnimation==="on"||this._cursorSmoothCaretAnimation==="explicit")&&(e+=" cursor-smooth-caret-animation"),e}_show(){this._primaryCursor.show();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].show();this._isVisible=!0}_hide(){this._primaryCursor.hide();for(let e=0,t=this._secondaryCursors.length;e<t;e++)this._secondaryCursors[e].hide();this._isVisible=!1}prepareRender(e){this._primaryCursor.prepareRender(e);for(let t=0,i=this._secondaryCursors.length;t<i;t++)this._secondaryCursors[t].prepareRender(e)}render(e){const t=[];let i=0;const n=this._primaryCursor.render(e);n&&(t[i++]=n);for(let s=0,r=this._secondaryCursors.length;s<r;s++){const a=this._secondaryCursors[s].render(e);a&&(t[i++]=a)}this._renderData=t}getLastRenderData(){return this._renderData}};NC.BLINK_INTERVAL=500;let JM=NC;br((o,e)=>{const t=[{class:".cursor",foreground:KT,background:W5},{class:".cursor-primary",foreground:d$,background:uce},{class:".cursor-secondary",foreground:h$,background:gce}];for(const i of t){const n=o.getColor(i.foreground);if(n){let s=o.getColor(i.background);s||(s=n.opposite()),e.addRule(`.monaco-editor .cursors-layer ${i.class} { background-color: ${n}; border-color: ${n}; color: ${s}; }`),xa(o.type)&&e.addRule(`.monaco-editor .cursors-layer.has-selection ${i.class} { border-left: 1px solid ${s}; border-right: 1px solid ${s}; }`)}}});const sN=()=>{throw new Error("Invalid change accessor")};class zme extends go{constructor(e){super(e);const t=this._context.configuration.options,i=t.get(146);this._lineHeight=t.get(67),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,this.domNode=bt(document.createElement("div")),this.domNode.setClassName("view-zones"),this.domNode.setPosition("absolute"),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this.marginDomNode=bt(document.createElement("div")),this.marginDomNode.setClassName("margin-view-zones"),this.marginDomNode.setPosition("absolute"),this.marginDomNode.setAttribute("role","presentation"),this.marginDomNode.setAttribute("aria-hidden","true"),this._zones={}}dispose(){super.dispose(),this._zones={}}_recomputeWhitespacesProps(){const e=this._context.viewLayout.getWhitespaces(),t=new Map;for(const n of e)t.set(n.id,n);let i=!1;return this._context.viewModel.changeWhitespace(n=>{const s=Object.keys(this._zones);for(let r=0,a=s.length;r<a;r++){const l=s[r],c=this._zones[l],d=this._computeWhitespaceProps(c.delegate);c.isInHiddenArea=d.isInHiddenArea;const h=t.get(l);h&&(h.afterLineNumber!==d.afterViewLineNumber||h.height!==d.heightInPx)&&(n.changeOneWhitespace(l,d.afterViewLineNumber,d.heightInPx),this._safeCallOnComputedHeight(c.delegate,d.heightInPx),i=!0)}}),i}onConfigurationChanged(e){const t=this._context.configuration.options,i=t.get(146);return this._lineHeight=t.get(67),this._contentWidth=i.contentWidth,this._contentLeft=i.contentLeft,e.hasChanged(67)&&this._recomputeWhitespacesProps(),!0}onLineMappingChanged(e){return this._recomputeWhitespacesProps()}onLinesDeleted(e){return!0}onScrollChanged(e){return e.scrollTopChanged||e.scrollWidthChanged}onZonesChanged(e){return!0}onLinesInserted(e){return!0}_getZoneOrdinal(e){return e.ordinal??e.afterColumn??1e4}_computeWhitespaceProps(e){if(e.afterLineNumber===0)return{isInHiddenArea:!1,afterViewLineNumber:0,heightInPx:this._heightInPixels(e),minWidthInPx:this._minWidthInPixels(e)};let t;if(typeof e.afterColumn<"u")t=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:e.afterColumn});else{const r=this._context.viewModel.model.validatePosition({lineNumber:e.afterLineNumber,column:1}).lineNumber;t=new A(r,this._context.viewModel.model.getLineMaxColumn(r))}let i;t.column===this._context.viewModel.model.getLineMaxColumn(t.lineNumber)?i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber+1,column:1}):i=this._context.viewModel.model.validatePosition({lineNumber:t.lineNumber,column:t.column+1});const n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(t,e.afterColumnAffinity,!0),s=e.showInHiddenAreas||this._context.viewModel.coordinatesConverter.modelPositionIsVisible(i);return{isInHiddenArea:!s,afterViewLineNumber:n.lineNumber,heightInPx:s?this._heightInPixels(e):0,minWidthInPx:this._minWidthInPixels(e)}}changeViewZones(e){let t=!1;return this._context.viewModel.changeWhitespace(i=>{const n={addZone:s=>(t=!0,this._addZone(i,s)),removeZone:s=>{s&&(t=this._removeZone(i,s)||t)},layoutZone:s=>{s&&(t=this._layoutZone(i,s)||t)}};Ume(e,n),n.addZone=sN,n.removeZone=sN,n.layoutZone=sN}),t}_addZone(e,t){const i=this._computeWhitespaceProps(t),s={whitespaceId:e.insertWhitespace(i.afterViewLineNumber,this._getZoneOrdinal(t),i.heightInPx,i.minWidthInPx),delegate:t,isInHiddenArea:i.isInHiddenArea,isVisible:!1,domNode:bt(t.domNode),marginDomNode:t.marginDomNode?bt(t.marginDomNode):null};return this._safeCallOnComputedHeight(s.delegate,i.heightInPx),s.domNode.setPosition("absolute"),s.domNode.domNode.style.width="100%",s.domNode.setDisplay("none"),s.domNode.setAttribute("monaco-view-zone",s.whitespaceId),this.domNode.appendChild(s.domNode),s.marginDomNode&&(s.marginDomNode.setPosition("absolute"),s.marginDomNode.domNode.style.width="100%",s.marginDomNode.setDisplay("none"),s.marginDomNode.setAttribute("monaco-view-zone",s.whitespaceId),this.marginDomNode.appendChild(s.marginDomNode)),this._zones[s.whitespaceId]=s,this.setShouldRender(),s.whitespaceId}_removeZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t];return delete this._zones[t],e.removeWhitespace(i.whitespaceId),i.domNode.removeAttribute("monaco-visible-view-zone"),i.domNode.removeAttribute("monaco-view-zone"),i.domNode.domNode.remove(),i.marginDomNode&&(i.marginDomNode.removeAttribute("monaco-visible-view-zone"),i.marginDomNode.removeAttribute("monaco-view-zone"),i.marginDomNode.domNode.remove()),this.setShouldRender(),!0}return!1}_layoutZone(e,t){if(this._zones.hasOwnProperty(t)){const i=this._zones[t],n=this._computeWhitespaceProps(i.delegate);return i.isInHiddenArea=n.isInHiddenArea,e.changeOneWhitespace(i.whitespaceId,n.afterViewLineNumber,n.heightInPx),this._safeCallOnComputedHeight(i.delegate,n.heightInPx),this.setShouldRender(),!0}return!1}shouldSuppressMouseDownOnViewZone(e){return this._zones.hasOwnProperty(e)?!!this._zones[e].delegate.suppressMouseDown:!1}_heightInPixels(e){return typeof e.heightInPx=="number"?e.heightInPx:typeof e.heightInLines=="number"?this._lineHeight*e.heightInLines:this._lineHeight}_minWidthInPixels(e){return typeof e.minWidthInPx=="number"?e.minWidthInPx:0}_safeCallOnComputedHeight(e,t){if(typeof e.onComputedHeight=="function")try{e.onComputedHeight(t)}catch(i){Ae(i)}}_safeCallOnDomNodeTop(e,t){if(typeof e.onDomNodeTop=="function")try{e.onDomNodeTop(t)}catch(i){Ae(i)}}prepareRender(e){}render(e){const t=e.viewportData.whitespaceViewportData,i={};let n=!1;for(const r of t)this._zones[r.id].isInHiddenArea||(i[r.id]=r,n=!0);const s=Object.keys(this._zones);for(let r=0,a=s.length;r<a;r++){const l=s[r],c=this._zones[l];let d=0,h=0,u="none";i.hasOwnProperty(l)?(d=i[l].verticalOffset-e.bigNumbersDelta,h=i[l].height,u="block",c.isVisible||(c.domNode.setAttribute("monaco-visible-view-zone","true"),c.isVisible=!0),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(i[l].verticalOffset))):(c.isVisible&&(c.domNode.removeAttribute("monaco-visible-view-zone"),c.isVisible=!1),this._safeCallOnDomNodeTop(c.delegate,e.getScrolledTopFromAbsoluteTop(-1e6))),c.domNode.setTop(d),c.domNode.setHeight(h),c.domNode.setDisplay(u),c.marginDomNode&&(c.marginDomNode.setTop(d),c.marginDomNode.setHeight(h),c.marginDomNode.setDisplay(u))}n&&(this.domNode.setWidth(Math.max(e.scrollWidth,this._contentWidth)),this.marginDomNode.setWidth(this._contentLeft))}}function Ume(o,e){try{return o(e)}catch(t){Ae(t)}}class Gme extends Jf{constructor(e){super(),this._context=e,this._options=new f9(this._context.configuration),this._selection=[],this._renderResult=null,this._context.addEventHandler(this)}dispose(){this._context.removeEventHandler(this),this._renderResult=null,super.dispose()}onConfigurationChanged(e){const t=new f9(this._context.configuration);return this._options.equals(t)?e.hasChanged(146):(this._options=t,!0)}onCursorStateChanged(e){return this._selection=e.selections,this._options.renderWhitespace==="selection"}onDecorationsChanged(e){return!0}onFlushed(e){return!0}onLinesChanged(e){return!0}onLinesDeleted(e){return!0}onLinesInserted(e){return!0}onScrollChanged(e){return e.scrollTopChanged}onZonesChanged(e){return!0}prepareRender(e){if(this._options.renderWhitespace==="none"){this._renderResult=null;return}const t=e.visibleRange.startLineNumber,n=e.visibleRange.endLineNumber-t+1,s=new Array(n);for(let a=0;a<n;a++)s[a]=!0;const r=this._context.viewModel.getMinimapLinesRenderingData(e.viewportData.startLineNumber,e.viewportData.endLineNumber,s);this._renderResult=[];for(let a=e.viewportData.startLineNumber;a<=e.viewportData.endLineNumber;a++){const l=a-e.viewportData.startLineNumber,c=r.data[l];let d=null;if(this._options.renderWhitespace==="selection"){const h=this._selection;for(const u of h){if(u.endLineNumber<a||u.startLineNumber>a)continue;const g=u.startLineNumber===a?u.startColumn:c.minColumn,f=u.endLineNumber===a?u.endColumn:c.maxColumn;g<f&&(d||(d=[]),d.push(new RK(g-1,f-1)))}}this._renderResult[l]=this._applyRenderWhitespace(e,a,d,c)}}_applyRenderWhitespace(e,t,i,n){if(this._options.renderWhitespace==="selection"&&!i||this._options.renderWhitespace==="trailing"&&n.continuesWithWrappedLine)return"";const s=this._context.theme.getColor(V5),r=this._options.renderWithSVG,a=n.content,l=this._options.stopRenderingLineAfter===-1?a.length:Math.min(this._options.stopRenderingLineAfter,a.length),c=n.continuesWithWrappedLine,d=n.minColumn-1,h=this._options.renderWhitespace==="boundary",u=this._options.renderWhitespace==="trailing",g=this._options.lineHeight,f=this._options.middotWidth,m=this._options.wsmiddotWidth,_=this._options.spaceWidth,b=Math.abs(m-_),v=Math.abs(f-_),y=b<v?11825:183,C=this._options.canUseHalfwidthRightwardsArrow;let w="",x=!1,k=Xn(a),E;k===-1?(x=!0,k=l,E=l):E=Sa(a);let N=0,z=i&&i[N],B=0;for(let U=d;U<l;U++){const Z=a.charCodeAt(U);if(z&&U>=z.endOffset&&(N++,z=i&&i[N]),Z!==9&&Z!==32||u&&!x&&U<=E)continue;if(h&&U>=k&&U<=E&&Z===32){const Q=U-1>=0?a.charCodeAt(U-1):0,le=U+1<l?a.charCodeAt(U+1):0;if(Q!==32&&le!==32)continue}if(h&&c&&U===l-1){const Q=U-1>=0?a.charCodeAt(U-1):0;if(Z===32&&Q!==32&&Q!==9)continue}if(i&&(!z||z.startOffset>U||z.endOffset<=U))continue;const V=e.visibleRangeForPosition(new A(t,U+1));V&&(r?(B=Math.max(B,V.left),Z===9?w+=this._renderArrow(g,_,V.left):w+=`<circle cx="${(V.left+_/2).toFixed(2)}" cy="${(g/2).toFixed(2)}" r="${(_/7).toFixed(2)}" />`):Z===9?w+=`<div class="mwh" style="left:${V.left}px;height:${g}px;">${C?"￫":"→"}</div>`:w+=`<div class="mwh" style="left:${V.left}px;height:${g}px;">${String.fromCharCode(y)}</div>`)}return r?(B=Math.round(B+_),`<svg style="bottom:0;position:absolute;width:${B}px;height:${g}px" viewBox="0 0 ${B} ${g}" xmlns="http://www.w3.org/2000/svg" fill="${s}">`+w+"</svg>"):w}_renderArrow(e,t,i){const n=t/7,s=t,r=e/2,a=i,l={x:0,y:n/2},c={x:100/125*s,y:l.y},d={x:c.x-.2*c.x,y:c.y+.2*c.x},h={x:d.x+.1*c.x,y:d.y+.1*c.x},u={x:h.x+.35*c.x,y:h.y-.35*c.x},g={x:u.x,y:-u.y},f={x:h.x,y:-h.y},m={x:d.x,y:-d.y},_={x:c.x,y:-c.y},b={x:l.x,y:-l.y};return`<path d="M ${[l,c,d,h,u,g,f,m,_,b].map(C=>`${(a+C.x).toFixed(2)} ${(r+C.y).toFixed(2)}`).join(" L ")}" />`}render(e,t){if(!this._renderResult)return"";const i=t-e;return i<0||i>=this._renderResult.length?"":this._renderResult[i]}}class f9{constructor(e){const t=e.options,i=t.get(50),n=t.get(38);n==="off"?(this.renderWhitespace="none",this.renderWithSVG=!1):n==="svg"?(this.renderWhitespace=t.get(100),this.renderWithSVG=!0):(this.renderWhitespace=t.get(100),this.renderWithSVG=!1),this.spaceWidth=i.spaceWidth,this.middotWidth=i.middotWidth,this.wsmiddotWidth=i.wsmiddotWidth,this.canUseHalfwidthRightwardsArrow=i.canUseHalfwidthRightwardsArrow,this.lineHeight=t.get(67),this.stopRenderingLineAfter=t.get(118)}equals(e){return this.renderWhitespace===e.renderWhitespace&&this.renderWithSVG===e.renderWithSVG&&this.spaceWidth===e.spaceWidth&&this.middotWidth===e.middotWidth&&this.wsmiddotWidth===e.wsmiddotWidth&&this.canUseHalfwidthRightwardsArrow===e.canUseHalfwidthRightwardsArrow&&this.lineHeight===e.lineHeight&&this.stopRenderingLineAfter===e.stopRenderingLineAfter}}class $me{constructor(e,t,i,n){this.selections=e,this.startLineNumber=t.startLineNumber|0,this.endLineNumber=t.endLineNumber|0,this.relativeVerticalOffset=t.relativeVerticalOffset,this.bigNumbersDelta=t.bigNumbersDelta|0,this.lineHeight=t.lineHeight|0,this.whitespaceViewportData=i,this._model=n,this.visibleRange=new L(t.startLineNumber,this._model.getLineMinColumn(t.startLineNumber),t.endLineNumber,this._model.getLineMaxColumn(t.endLineNumber))}getViewLineRenderingData(e){return this._model.getViewportViewLineRenderingData(this.visibleRange,e)}getDecorationsInViewport(){return this._model.getDecorationsInViewport(this.visibleRange)}}class Kme{get type(){return this._theme.type}get value(){return this._theme}constructor(e){this._theme=e}update(e){this._theme=e}getColor(e){return this._theme.getColor(e)}}class jme{constructor(e,t,i){this.configuration=e,this.theme=new Kme(t),this.viewModel=i,this.viewLayout=i.viewLayout}addEventHandler(e){this.viewModel.addViewEventHandler(e)}removeEventHandler(e){this.viewModel.removeViewEventHandler(e)}}var qme=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Zme=function(o,e){return function(t,i){e(t,i,o)}};let eO=class extends Kw{constructor(e,t,i,n,s,r,a){super(),this._instantiationService=a,this._shouldRecomputeGlyphMarginLanes=!1,this._selections=[new pe(1,1,1,1)],this._renderAnimationFrame=null;const l=new nme(t,n,s,e);this._context=new jme(t,i,n),this._context.addEventHandler(this),this._viewParts=[],this._textAreaHandler=this._instantiationService.createInstance(KM,this._context,l,this._createTextAreaHandlerHelper()),this._viewParts.push(this._textAreaHandler),this._linesContent=bt(document.createElement("div")),this._linesContent.setClassName("lines-content monaco-editor-background"),this._linesContent.setPosition("absolute"),this.domNode=bt(document.createElement("div")),this.domNode.setClassName(this._getEditorClassName()),this.domNode.setAttribute("role","code"),this._overflowGuardContainer=bt(document.createElement("div")),Aa.write(this._overflowGuardContainer,3),this._overflowGuardContainer.setClassName("overflow-guard"),this._scrollbar=new gme(this._context,this._linesContent,this.domNode,this._overflowGuardContainer),this._viewParts.push(this._scrollbar),this._viewLines=new XM(this._context,this._linesContent),this._viewZones=new zme(this._context),this._viewParts.push(this._viewZones);const c=new Pme(this._context);this._viewParts.push(c);const d=new Fme(this._context);this._viewParts.push(d);const h=new ome(this._context);this._viewParts.push(h),h.addDynamicOverlay(new dme(this._context)),h.addDynamicOverlay(new QM(this._context)),h.addDynamicOverlay(new Cme(this._context)),h.addDynamicOverlay(new ume(this._context)),h.addDynamicOverlay(new Gme(this._context));const u=new rme(this._context);this._viewParts.push(u),u.addDynamicOverlay(new hme(this._context)),u.addDynamicOverlay(new Lme(this._context)),u.addDynamicOverlay(new xme(this._context)),u.addDynamicOverlay(new qx(this._context)),this._glyphMarginWidgets=new mme(this._context),this._viewParts.push(this._glyphMarginWidgets);const g=new Zx(this._context);g.getDomNode().appendChild(this._viewZones.marginDomNode),g.getDomNode().appendChild(u.getDomNode()),g.getDomNode().appendChild(this._glyphMarginWidgets.domNode),this._viewParts.push(g),this._contentWidgets=new lme(this._context,this.domNode),this._viewParts.push(this._contentWidgets),this._viewCursors=new JM(this._context),this._viewParts.push(this._viewCursors),this._overlayWidgets=new Nme(this._context,this.domNode),this._viewParts.push(this._overlayWidgets);const f=new Ome(this._context);this._viewParts.push(f);const m=new ame(this._context);this._viewParts.push(m);const _=new Ime(this._context);if(this._viewParts.push(_),c){const b=this._scrollbar.getOverviewRulerLayoutInfo();b.parent.insertBefore(c.getDomNode(),b.insertBefore)}this._linesContent.appendChild(h.getDomNode()),this._linesContent.appendChild(f.domNode),this._linesContent.appendChild(this._viewZones.domNode),this._linesContent.appendChild(this._viewLines.getDomNode()),this._linesContent.appendChild(this._contentWidgets.domNode),this._linesContent.appendChild(this._viewCursors.getDomNode()),this._overflowGuardContainer.appendChild(g.getDomNode()),this._overflowGuardContainer.appendChild(this._scrollbar.getDomNode()),this._overflowGuardContainer.appendChild(d.getDomNode()),this._overflowGuardContainer.appendChild(this._textAreaHandler.textArea),this._overflowGuardContainer.appendChild(this._textAreaHandler.textAreaCover),this._overflowGuardContainer.appendChild(this._overlayWidgets.getDomNode()),this._overflowGuardContainer.appendChild(_.getDomNode()),this._overflowGuardContainer.appendChild(m.domNode),this.domNode.appendChild(this._overflowGuardContainer),r?(r.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode.domNode),r.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode.domNode)):(this.domNode.appendChild(this._contentWidgets.overflowingContentWidgetsDomNode),this.domNode.appendChild(this._overlayWidgets.overflowingOverlayWidgetsDomNode)),this._applyLayout(),this._pointerHandler=this._register(new Lpe(this._context,l,this._createPointerHandlerHelper()))}_computeGlyphMarginLanes(){const e=this._context.viewModel.model,t=this._context.viewModel.glyphLanes;let i=[],n=0;i=i.concat(e.getAllMarginDecorations().map(s=>{const r=s.options.glyphMargin?.position??Ur.Center;return n=Math.max(n,s.range.endLineNumber),{range:s.range,lane:r,persist:s.options.glyphMargin?.persistLane}})),i=i.concat(this._glyphMarginWidgets.getWidgets().map(s=>{const r=e.validateRange(s.preference.range);return n=Math.max(n,r.endLineNumber),{range:r,lane:s.preference.lane}})),i.sort((s,r)=>L.compareRangesUsingStarts(s.range,r.range)),t.reset(n);for(const s of i)t.push(s.lane,s.range,s.persist);return t}_createPointerHandlerHelper(){return{viewDomNode:this.domNode.domNode,linesContentDomNode:this._linesContent.domNode,viewLinesDomNode:this._viewLines.getDomNode().domNode,focusTextArea:()=>{this.focus()},dispatchTextAreaEvent:e=>{this._textAreaHandler.textArea.domNode.dispatchEvent(e)},getLastRenderData:()=>{const e=this._viewCursors.getLastRenderData()||[],t=this._textAreaHandler.getLastRenderData();return new gpe(e,t)},renderNow:()=>{this.render(!0,!1)},shouldSuppressMouseDownOnViewZone:e=>this._viewZones.shouldSuppressMouseDownOnViewZone(e),shouldSuppressMouseDownOnWidget:e=>this._contentWidgets.shouldSuppressMouseDownOnWidget(e),getPositionFromDOMInfo:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getPositionFromDOMInfo(e,t)),visibleRangeForPosition:(e,t)=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(new A(e,t))),getLineWidth:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.getLineWidth(e))}}_createTextAreaHandlerHelper(){return{visibleRangeForPosition:e=>(this._flushAccumulatedAndRenderNow(),this._viewLines.visibleRangeForPosition(e))}}_applyLayout(){const t=this._context.configuration.options.get(146);this.domNode.setWidth(t.width),this.domNode.setHeight(t.height),this._overflowGuardContainer.setWidth(t.width),this._overflowGuardContainer.setHeight(t.height),this._linesContent.setWidth(16777216),this._linesContent.setHeight(16777216)}_getEditorClassName(){const e=this._textAreaHandler.isFocused()?" focused":"";return this._context.configuration.options.get(143)+" "+RP(this._context.theme.type)+e}handleEvents(e){super.handleEvents(e),this._scheduleRender()}onConfigurationChanged(e){return this.domNode.setClassName(this._getEditorClassName()),this._applyLayout(),!1}onCursorStateChanged(e){return this._selections=e.selections,!1}onDecorationsChanged(e){return e.affectsGlyphMargin&&(this._shouldRecomputeGlyphMarginLanes=!0),!1}onFocusChanged(e){return this.domNode.setClassName(this._getEditorClassName()),!1}onThemeChanged(e){return this._context.theme.update(e.theme),this.domNode.setClassName(this._getEditorClassName()),!1}dispose(){this._renderAnimationFrame!==null&&(this._renderAnimationFrame.dispose(),this._renderAnimationFrame=null),this._contentWidgets.overflowingContentWidgetsDomNode.domNode.remove(),this._context.removeEventHandler(this),this._viewLines.dispose();for(const e of this._viewParts)e.dispose();super.dispose()}_scheduleRender(){if(this._store.isDisposed)throw new pt;if(this._renderAnimationFrame===null){const e=this._createCoordinatedRendering();this._renderAnimationFrame=tO.INSTANCE.scheduleCoordinatedRendering({window:xe(this.domNode?.domNode),prepareRenderText:()=>{if(this._store.isDisposed)throw new pt;try{return e.prepareRenderText()}finally{this._renderAnimationFrame=null}},renderText:()=>{if(this._store.isDisposed)throw new pt;return e.renderText()},prepareRender:(t,i)=>{if(this._store.isDisposed)throw new pt;return e.prepareRender(t,i)},render:(t,i)=>{if(this._store.isDisposed)throw new pt;return e.render(t,i)}})}}_flushAccumulatedAndRenderNow(){const e=this._createCoordinatedRendering();Zd(()=>e.prepareRenderText());const t=Zd(()=>e.renderText());if(t){const[i,n]=t;Zd(()=>e.prepareRender(i,n)),Zd(()=>e.render(i,n))}}_getViewPartsToRender(){const e=[];let t=0;for(const i of this._viewParts)i.shouldRender()&&(e[t++]=i);return e}_createCoordinatedRendering(){return{prepareRenderText:()=>{if(this._shouldRecomputeGlyphMarginLanes){this._shouldRecomputeGlyphMarginLanes=!1;const e=this._computeGlyphMarginLanes();this._context.configuration.setGlyphMarginDecorationLaneCount(e.requiredLanes)}qd.onRenderStart()},renderText:()=>{if(!this.domNode.domNode.isConnected)return null;let e=this._getViewPartsToRender();if(!this._viewLines.shouldRender()&&e.length===0)return null;const t=this._context.viewLayout.getLinesViewportData();this._context.viewModel.setViewport(t.startLineNumber,t.endLineNumber,t.centeredLineNumber);const i=new $me(this._selections,t,this._context.viewLayout.getWhitespaceViewportData(),this._context.viewModel);return this._contentWidgets.shouldRender()&&this._contentWidgets.onBeforeRender(i),this._viewLines.shouldRender()&&(this._viewLines.renderText(i),this._viewLines.onDidRender(),e=this._getViewPartsToRender()),[e,new rpe(this._context.viewLayout,i,this._viewLines)]},prepareRender:(e,t)=>{for(const i of e)i.prepareRender(t)},render:(e,t)=>{for(const i of e)i.render(t),i.onDidRender()}}}delegateVerticalScrollbarPointerDown(e){this._scrollbar.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){this._scrollbar.delegateScrollFromMouseWheelEvent(e)}restoreState(e){this._context.viewModel.viewLayout.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft},1),this._context.viewModel.visibleLinesStabilized()}getOffsetForColumn(e,t){const i=this._context.viewModel.model.validatePosition({lineNumber:e,column:t}),n=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i);this._flushAccumulatedAndRenderNow();const s=this._viewLines.visibleRangeForPosition(new A(n.lineNumber,n.column));return s?s.left:-1}getTargetAtClientPoint(e,t){const i=this._pointerHandler.getTargetAtClientPoint(e,t);return i?lD.convertViewToModelMouseTarget(i,this._context.viewModel.coordinatesConverter):null}createOverviewRuler(e){return new Mme(this._context,e)}change(e){this._viewZones.changeViewZones(e),this._scheduleRender()}render(e,t){if(t){this._viewLines.forceShouldRender();for(const i of this._viewParts)i.forceShouldRender()}e?this._flushAccumulatedAndRenderNow():this._scheduleRender()}writeScreenReaderContent(e){this._textAreaHandler.writeScreenReaderContent(e)}focus(){this._textAreaHandler.focusTextArea()}isFocused(){return this._textAreaHandler.isFocused()}setAriaOptions(e){this._textAreaHandler.setAriaOptions(e)}addContentWidget(e){this._contentWidgets.addWidget(e.widget),this.layoutContentWidget(e),this._scheduleRender()}layoutContentWidget(e){this._contentWidgets.setWidgetPosition(e.widget,e.position?.position??null,e.position?.secondaryPosition??null,e.position?.preference??null,e.position?.positionAffinity??null),this._scheduleRender()}removeContentWidget(e){this._contentWidgets.removeWidget(e.widget),this._scheduleRender()}addOverlayWidget(e){this._overlayWidgets.addWidget(e.widget),this.layoutOverlayWidget(e),this._scheduleRender()}layoutOverlayWidget(e){this._overlayWidgets.setWidgetPosition(e.widget,e.position)&&this._scheduleRender()}removeOverlayWidget(e){this._overlayWidgets.removeWidget(e.widget),this._scheduleRender()}addGlyphMarginWidget(e){this._glyphMarginWidgets.addWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}layoutGlyphMarginWidget(e){const t=e.position;this._glyphMarginWidgets.setWidgetPosition(e.widget,t)&&(this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender())}removeGlyphMarginWidget(e){this._glyphMarginWidgets.removeWidget(e.widget),this._shouldRecomputeGlyphMarginLanes=!0,this._scheduleRender()}};eO=qme([Zme(6,Ce)],eO);function Zd(o){try{return o()}catch(e){return Ae(e),null}}const tE=class tE{constructor(){this._coordinatedRenderings=[],this._animationFrameRunners=new Map}scheduleCoordinatedRendering(e){return this._coordinatedRenderings.push(e),this._scheduleRender(e.window),{dispose:()=>{const t=this._coordinatedRenderings.indexOf(e);if(t!==-1&&(this._coordinatedRenderings.splice(t,1),this._coordinatedRenderings.length===0)){for(const[i,n]of this._animationFrameRunners)n.dispose();this._animationFrameRunners.clear()}}}}_scheduleRender(e){if(!this._animationFrameRunners.has(e)){const t=()=>{this._animationFrameRunners.delete(e),this._onRenderScheduled()};this._animationFrameRunners.set(e,R0(e,t,100))}}_onRenderScheduled(){const e=this._coordinatedRenderings.slice(0);this._coordinatedRenderings=[];for(const i of e)Zd(()=>i.prepareRenderText());const t=[];for(let i=0,n=e.length;i<n;i++){const s=e[i];t[i]=Zd(()=>s.renderText())}for(let i=0,n=e.length;i<n;i++){const s=e[i],r=t[i];if(!r)continue;const[a,l]=r;Zd(()=>s.prepareRender(a,l))}for(let i=0,n=e.length;i<n;i++){const s=e[i],r=t[i];if(!r)continue;const[a,l]=r;Zd(()=>s.render(a,l))}}};tE.INSTANCE=new tE;let tO=tE;class nC{constructor(e,t,i,n,s){this.injectionOffsets=e,this.injectionOptions=t,this.breakOffsets=i,this.breakOffsetsVisibleColumn=n,this.wrappedTextIndentLength=s}getOutputLineCount(){return this.breakOffsets.length}getMinOutputOffset(e){return e>0?this.wrappedTextIndentLength:0}getLineLength(e){const t=e>0?this.breakOffsets[e-1]:0;let n=this.breakOffsets[e]-t;return e>0&&(n+=this.wrappedTextIndentLength),n}getMaxOutputOffset(e){return this.getLineLength(e)}translateToInputOffset(e,t){e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength));let n=e===0?t:this.breakOffsets[e-1]+t;if(this.injectionOffsets!==null)for(let s=0;s<this.injectionOffsets.length&&n>this.injectionOffsets[s];s++)n<this.injectionOffsets[s]+this.injectionOptions[s].content.length?n=this.injectionOffsets[s]:n-=this.injectionOptions[s].content.length;return n}translateToOutputPosition(e,t=2){let i=e;if(this.injectionOffsets!==null)for(let n=0;n<this.injectionOffsets.length&&!(e<this.injectionOffsets[n]||t!==1&&e===this.injectionOffsets[n]);n++)i+=this.injectionOptions[n].content.length;return this.offsetInInputWithInjectionsToOutputPosition(i,t)}offsetInInputWithInjectionsToOutputPosition(e,t=2){let i=0,n=this.breakOffsets.length-1,s=0,r=0;for(;i<=n;){s=i+(n-i)/2|0;const l=this.breakOffsets[s];if(r=s>0?this.breakOffsets[s-1]:0,t===0)if(e<=r)n=s-1;else if(e>l)i=s+1;else break;else if(e<r)n=s-1;else if(e>=l)i=s+1;else break}let a=e-r;return s>0&&(a+=this.wrappedTextIndentLength),new XS(s,a)}normalizeOutputPosition(e,t,i){if(this.injectionOffsets!==null){const n=this.outputPositionToOffsetInInputWithInjections(e,t),s=this.normalizeOffsetInInputWithInjectionsAroundInjections(n,i);if(s!==n)return this.offsetInInputWithInjectionsToOutputPosition(s,i)}if(i===0){if(e>0&&t===this.getMinOutputOffset(e))return new XS(e-1,this.getMaxOutputOffset(e-1))}else if(i===1){const n=this.getOutputLineCount()-1;if(e<n&&t===this.getMaxOutputOffset(e))return new XS(e+1,this.getMinOutputOffset(e+1))}return new XS(e,t)}outputPositionToOffsetInInputWithInjections(e,t){return e>0&&(t=Math.max(0,t-this.wrappedTextIndentLength)),(e>0?this.breakOffsets[e-1]:0)+t}normalizeOffsetInInputWithInjectionsAroundInjections(e,t){const i=this.getInjectedTextAtOffset(e);if(!i)return e;if(t===2){if(e===i.offsetInInputWithInjections+i.length&&p9(this.injectionOptions[i.injectedTextIndex].cursorStops))return i.offsetInInputWithInjections+i.length;{let n=i.offsetInInputWithInjections;if(m9(this.injectionOptions[i.injectedTextIndex].cursorStops))return n;let s=i.injectedTextIndex-1;for(;s>=0&&this.injectionOffsets[s]===this.injectionOffsets[i.injectedTextIndex]&&!(p9(this.injectionOptions[s].cursorStops)||(n-=this.injectionOptions[s].content.length,m9(this.injectionOptions[s].cursorStops)));)s--;return n}}else if(t===1||t===4){let n=i.offsetInInputWithInjections+i.length,s=i.injectedTextIndex;for(;s+1<this.injectionOffsets.length&&this.injectionOffsets[s+1]===this.injectionOffsets[s];)n+=this.injectionOptions[s+1].content.length,s++;return n}else if(t===0||t===3){let n=i.offsetInInputWithInjections,s=i.injectedTextIndex;for(;s-1>=0&&this.injectionOffsets[s-1]===this.injectionOffsets[s];)n-=this.injectionOptions[s-1].content.length,s--;return n}_T()}getInjectedText(e,t){const i=this.outputPositionToOffsetInInputWithInjections(e,t),n=this.getInjectedTextAtOffset(i);return n?{options:this.injectionOptions[n.injectedTextIndex]}:null}getInjectedTextAtOffset(e){const t=this.injectionOffsets,i=this.injectionOptions;if(t!==null){let n=0;for(let s=0;s<t.length;s++){const r=i[s].content.length,a=t[s]+n,l=t[s]+n+r;if(a>e)break;if(e<=l)return{injectedTextIndex:s,offsetInInputWithInjections:a,length:r};n+=r}}}}function p9(o){return o==null?!0:o===Or.Right||o===Or.Both}function m9(o){return o==null?!0:o===Or.Left||o===Or.Both}class XS{constructor(e,t){this.outputLineIndex=e,this.outputOffset=t}toString(){return`${this.outputLineIndex}:${this.outputOffset}`}toPosition(e){return new A(e+this.outputLineIndex,this.outputOffset+1)}}const Yme=nd("domLineBreaksComputer",{createHTML:o=>o});class AB{static create(e){return new AB(new WeakRef(e))}constructor(e){this.targetWindow=e}createLineBreaksComputer(e,t,i,n,s){const r=[],a=[];return{addRequest:(l,c,d)=>{r.push(l),a.push(c)},finalize:()=>Xme(Vd(this.targetWindow.deref()),r,e,t,i,n,s,a)}}}function Xme(o,e,t,i,n,s,r,a){function l(N){const z=a[N];if(z){const B=Na.applyInjectedText(e[N],z),U=z.map(V=>V.options),Z=z.map(V=>V.column-1);return new nC(Z,U,[B.length],[],0)}else return null}if(n===-1){const N=[];for(let z=0,B=e.length;z<B;z++)N[z]=l(z);return N}const c=Math.round(n*t.typicalHalfwidthCharacterWidth),h=Math.round(i*(s===3?2:s===2?1:0)),u=Math.ceil(t.spaceWidth*h),g=document.createElement("div");mn(g,t);const f=new rb(1e4),m=[],_=[],b=[],v=[],y=[];for(let N=0;N<e.length;N++){const z=Na.applyInjectedText(e[N],a[N]);let B=0,U=0,Z=c;if(s!==0)if(B=Xn(z),B===-1)B=0;else{for(let ge=0;ge<B;ge++){const _e=z.charCodeAt(ge)===9?i-U%i:1;U+=_e}const le=Math.ceil(t.spaceWidth*U);le+t.typicalFullwidthCharacterWidth>c?(B=0,U=0):Z=c-le}const V=z.substr(B),Q=Qme(V,U,i,Z,f,u);m[N]=B,_[N]=U,b[N]=V,v[N]=Q[0],y[N]=Q[1]}const C=f.build(),w=Yme?.createHTML(C)??C;g.innerHTML=w,g.style.position="absolute",g.style.top="10000",r==="keepAll"?(g.style.wordBreak="keep-all",g.style.overflowWrap="anywhere"):(g.style.wordBreak="inherit",g.style.overflowWrap="break-word"),o.document.body.appendChild(g);const x=document.createRange(),k=Array.prototype.slice.call(g.children,0),E=[];for(let N=0;N<e.length;N++){const z=k[N],B=Jme(x,z,b[N],v[N]);if(B===null){E[N]=l(N);continue}const U=m[N],Z=_[N]+h,V=y[N],Q=[];for(let he=0,Ne=B.length;he<Ne;he++)Q[he]=V[B[he]];if(U!==0)for(let he=0,Ne=B.length;he<Ne;he++)B[he]+=U;let le,ge;const _e=a[N];_e?(le=_e.map(he=>he.options),ge=_e.map(he=>he.column-1)):(le=null,ge=null),E[N]=new nC(ge,le,B,Q,Z)}return g.remove(),E}function Qme(o,e,t,i,n,s){if(s!==0){const u=String(s);n.appendString('<div style="text-indent: -'),n.appendString(u),n.appendString("px; padding-left: "),n.appendString(u),n.appendString("px; box-sizing: border-box; width:")}else n.appendString('<div style="width:');n.appendString(String(i)),n.appendString('px;">');const r=o.length;let a=e,l=0;const c=[],d=[];let h=0<r?o.charCodeAt(0):0;n.appendString("<span>");for(let u=0;u<r;u++){u!==0&&u%16384===0&&n.appendString("</span><span>"),c[u]=l,d[u]=a;const g=h;h=u+1<r?o.charCodeAt(u+1):0;let f=1,m=1;switch(g){case 9:f=t-a%t,m=f;for(let _=1;_<=f;_++)_<f?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 32:h===32?n.appendCharCode(160):n.appendASCIICharCode(32);break;case 60:n.appendString("&lt;");break;case 62:n.appendString("&gt;");break;case 38:n.appendString("&amp;");break;case 0:n.appendString("&#00;");break;case 65279:case 8232:case 8233:case 133:n.appendCharCode(65533);break;default:Ih(g)&&m++,g<32?n.appendCharCode(9216+g):n.appendCharCode(g)}l+=f,a+=m}return n.appendString("</span>"),c[o.length]=l,d[o.length]=a,n.appendString("</div>"),[c,d]}function Jme(o,e,t,i){if(t.length<=1)return null;const n=Array.prototype.slice.call(e.children,0),s=[];try{iO(o,n,i,0,null,t.length-1,null,s)}catch(r){return console.log(r),null}return s.length===0?null:(s.push(t.length),s)}function iO(o,e,t,i,n,s,r,a){if(i===s||(n=n||oN(o,e,t[i],t[i+1]),r=r||oN(o,e,t[s],t[s+1]),Math.abs(n[0].top-r[0].top)<=.1))return;if(i+1===s){a.push(s);return}const l=i+(s-i)/2|0,c=oN(o,e,t[l],t[l+1]);iO(o,e,t,i,n,l,c,a),iO(o,e,t,l,c,s,r,a)}function oN(o,e,t,i){return o.setStart(e[t/16384|0].firstChild,t%16384),o.setEnd(e[i/16384|0].firstChild,i%16384),o.getClientRects()}class e_e extends F{constructor(){super(),this._editor=null,this._instantiationService=null,this._instances=this._register(new L4),this._pending=new Map,this._finishedInstantiation=[],this._finishedInstantiation[0]=!1,this._finishedInstantiation[1]=!1,this._finishedInstantiation[2]=!1,this._finishedInstantiation[3]=!1}initialize(e,t,i){this._editor=e,this._instantiationService=i;for(const n of t){if(this._pending.has(n.id)){Ae(new Error(`Cannot have two contributions with the same id ${n.id}`));continue}this._pending.set(n.id,n)}this._instantiateSome(0),this._register(cv(xe(this._editor.getDomNode()),()=>{this._instantiateSome(1)})),this._register(cv(xe(this._editor.getDomNode()),()=>{this._instantiateSome(2)})),this._register(cv(xe(this._editor.getDomNode()),()=>{this._instantiateSome(3)},5e3))}saveViewState(){const e={};for(const[t,i]of this._instances)typeof i.saveViewState=="function"&&(e[t]=i.saveViewState());return e}restoreViewState(e){for(const[t,i]of this._instances)typeof i.restoreViewState=="function"&&i.restoreViewState(e[t])}get(e){return this._instantiateById(e),this._instances.get(e)||null}onBeforeInteractionEvent(){this._instantiateSome(2)}onAfterModelAttached(){return cv(xe(this._editor?.getDomNode()),()=>{this._instantiateSome(1)},50)}_instantiateSome(e){if(this._finishedInstantiation[e])return;this._finishedInstantiation[e]=!0;const t=this._findPendingContributionsByInstantiation(e);for(const i of t)this._instantiateById(i.id)}_findPendingContributionsByInstantiation(e){const t=[];for(const[,i]of this._pending)i.instantiation===e&&t.push(i);return t}_instantiateById(e){const t=this._pending.get(e);if(t){if(this._pending.delete(e),!this._instantiationService||!this._editor)throw new Error("Cannot instantiate contributions before being initialized!");try{const i=this._instantiationService.createInstance(t.ctor,this._editor);this._instances.set(t.id,i),typeof i.restoreViewState=="function"&&t.instantiation!==0&&console.warn(`Editor contribution '${t.id}' should be eager instantiated because it uses saveViewState / restoreViewState.`)}catch(i){Ae(i)}}}}class tj{constructor(e,t,i,n,s,r,a){this.id=e,this.label=t,this.alias=i,this.metadata=n,this._precondition=s,this._run=r,this._contextKeyService=a}isSupported(){return this._contextKeyService.contextMatchesRules(this._precondition)}run(e){return this.isSupported()?this._run(e):Promise.resolve(void 0)}}class MB{static create(e){return new MB(e.get(135),e.get(134))}constructor(e,t){this.classifier=new t_e(e,t)}createLineBreaksComputer(e,t,i,n,s){const r=[],a=[],l=[];return{addRequest:(c,d,h)=>{r.push(c),a.push(d),l.push(h)},finalize:()=>{const c=e.typicalFullwidthCharacterWidth/e.typicalHalfwidthCharacterWidth,d=[];for(let h=0,u=r.length;h<u;h++){const g=a[h],f=l[h];f&&!f.injectionOptions&&!g?d[h]=i_e(this.classifier,f,r[h],t,i,c,n,s):d[h]=n_e(this.classifier,r[h],g,t,i,c,n,s)}return nO.length=0,sO.length=0,d}}}}class t_e extends ab{constructor(e,t){super(0);for(let i=0;i<e.length;i++)this.set(e.charCodeAt(i),1);for(let i=0;i<t.length;i++)this.set(t.charCodeAt(i),2)}get(e){return e>=0&&e<256?this._asciiMap[e]:e>=12352&&e<=12543||e>=13312&&e<=19903||e>=19968&&e<=40959?3:this._map.get(e)||this._defaultValue}}let nO=[],sO=[];function i_e(o,e,t,i,n,s,r,a){if(n===-1)return null;const l=t.length;if(l<=1)return null;const c=a==="keepAll",d=e.breakOffsets,h=e.breakOffsetsVisibleColumn,u=ij(t,i,n,s,r),g=n-u,f=nO,m=sO;let _=0,b=0,v=0,y=n;const C=d.length;let w=0;if(w>=0){let x=Math.abs(h[w]-y);for(;w+1<C;){const k=Math.abs(h[w+1]-y);if(k>=x)break;x=k,w++}}for(;w<C;){let x=w<0?0:d[w],k=w<0?0:h[w];b>x&&(x=b,k=v);let E=0,N=0,z=0,B=0;if(k<=y){let Z=k,V=x===0?0:t.charCodeAt(x-1),Q=x===0?0:o.get(V),le=!0;for(let ge=x;ge<l;ge++){const _e=ge,he=t.charCodeAt(ge);let Ne,Pe;if($i(he)?(ge++,Ne=0,Pe=2):(Ne=o.get(he),Pe=sC(he,Z,i,s)),_e>b&&oO(V,Q,he,Ne,c)&&(E=_e,N=Z),Z+=Pe,Z>y){_e>b?(z=_e,B=Z-Pe):(z=ge+1,B=Z),Z-N>g&&(E=0),le=!1;break}V=he,Q=Ne}if(le){_>0&&(f[_]=d[d.length-1],m[_]=h[d.length-1],_++);break}}if(E===0){let Z=k,V=t.charCodeAt(x),Q=o.get(V),le=!1;for(let ge=x-1;ge>=b;ge--){const _e=ge+1,he=t.charCodeAt(ge);if(he===9){le=!0;break}let Ne,Pe;if(_f(he)?(ge--,Ne=0,Pe=2):(Ne=o.get(he),Pe=Ih(he)?s:1),Z<=y){if(z===0&&(z=_e,B=Z),Z<=y-g)break;if(oO(he,Ne,V,Q,c)){E=_e,N=Z;break}}Z-=Pe,V=he,Q=Ne}if(E!==0){const ge=g-(B-N);if(ge<=i){const _e=t.charCodeAt(z);let he;$i(_e)?he=2:he=sC(_e,B,i,s),ge-he<0&&(E=0)}}if(le){w--;continue}}if(E===0&&(E=z,N=B),E<=b){const Z=t.charCodeAt(b);$i(Z)?(E=b+2,N=v+2):(E=b+1,N=v+sC(Z,v,i,s))}for(b=E,f[_]=E,v=N,m[_]=N,_++,y=N+g;w<0||w<C&&h[w]<N;)w++;let U=Math.abs(h[w]-y);for(;w+1<C;){const Z=Math.abs(h[w+1]-y);if(Z>=U)break;U=Z,w++}}return _===0?null:(f.length=_,m.length=_,nO=e.breakOffsets,sO=e.breakOffsetsVisibleColumn,e.breakOffsets=f,e.breakOffsetsVisibleColumn=m,e.wrappedTextIndentLength=u,e)}function n_e(o,e,t,i,n,s,r,a){const l=Na.applyInjectedText(e,t);let c,d;if(t&&t.length>0?(c=t.map(N=>N.options),d=t.map(N=>N.column-1)):(c=null,d=null),n===-1)return c?new nC(d,c,[l.length],[],0):null;const h=l.length;if(h<=1)return c?new nC(d,c,[l.length],[],0):null;const u=a==="keepAll",g=ij(l,i,n,s,r),f=n-g,m=[],_=[];let b=0,v=0,y=0,C=n,w=l.charCodeAt(0),x=o.get(w),k=sC(w,0,i,s),E=1;$i(w)&&(k+=1,w=l.charCodeAt(1),x=o.get(w),E++);for(let N=E;N<h;N++){const z=N,B=l.charCodeAt(N);let U,Z;$i(B)?(N++,U=0,Z=2):(U=o.get(B),Z=sC(B,k,i,s)),oO(w,x,B,U,u)&&(v=z,y=k),k+=Z,k>C&&((v===0||k-y>f)&&(v=z,y=k-Z),m[b]=v,_[b]=y,b++,C=y+f,v=0),w=B,x=U}return b===0&&(!t||t.length===0)?null:(m[b]=h,_[b]=k,new nC(d,c,m,_,g))}function sC(o,e,t,i){return o===9?t-e%t:Ih(o)||o<32?i:1}function _9(o,e){return e-o%e}function oO(o,e,t,i,n){return t!==32&&(e===2&&i!==2||e!==1&&i===1||!n&&e===3&&i!==2||!n&&i===3&&e!==1)}function ij(o,e,t,i,n){let s=0;if(n!==0){const r=Xn(o);if(r!==-1){for(let l=0;l<r;l++){const c=o.charCodeAt(l)===9?_9(s,e):1;s+=c}const a=n===3?2:n===2?1:0;for(let l=0;l<a;l++){const c=_9(s,e);s+=c}s+i>t&&(s=0)}}return s}class tL{constructor(e){this._selTrackedRange=null,this._trackSelection=!0,this._setState(e,new hn(new L(1,1,1,1),0,0,new A(1,1),0),new hn(new L(1,1,1,1),0,0,new A(1,1),0))}dispose(e){this._removeTrackedRange(e)}startTrackingSelection(e){this._trackSelection=!0,this._updateTrackedRange(e)}stopTrackingSelection(e){this._trackSelection=!1,this._removeTrackedRange(e)}_updateTrackedRange(e){this._trackSelection&&(this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,this.modelState.selection,0))}_removeTrackedRange(e){this._selTrackedRange=e.model._setTrackedRange(this._selTrackedRange,null,0)}asCursorState(){return new ht(this.modelState,this.viewState)}readSelectionFromMarkers(e){const t=e.model._getTrackedRange(this._selTrackedRange);return this.modelState.selection.isEmpty()&&!t.isEmpty()?pe.fromRange(t.collapseToEnd(),this.modelState.selection.getDirection()):pe.fromRange(t,this.modelState.selection.getDirection())}ensureValidState(e){this._setState(e,this.modelState,this.viewState)}setState(e,t,i){this._setState(e,t,i)}static _validatePositionWithCache(e,t,i,n){return t.equals(i)?n:e.normalizePosition(t,2)}static _validateViewState(e,t){const i=t.position,n=t.selectionStart.getStartPosition(),s=t.selectionStart.getEndPosition(),r=e.normalizePosition(i,2),a=this._validatePositionWithCache(e,n,i,r),l=this._validatePositionWithCache(e,s,n,a);return i.equals(r)&&n.equals(a)&&s.equals(l)?t:new hn(L.fromPositions(a,l),t.selectionStartKind,t.selectionStartLeftoverVisibleColumns+n.column-a.column,r,t.leftoverVisibleColumns+i.column-r.column)}_setState(e,t,i){if(i&&(i=tL._validateViewState(e.viewModel,i)),t){const n=e.model.validateRange(t.selectionStart),s=t.selectionStart.equalsRange(n)?t.selectionStartLeftoverVisibleColumns:0,r=e.model.validatePosition(t.position),a=t.position.equals(r)?t.leftoverVisibleColumns:0;t=new hn(n,t.selectionStartKind,s,r,a)}else{if(!i)return;const n=e.model.validateRange(e.coordinatesConverter.convertViewRangeToModelRange(i.selectionStart)),s=e.model.validatePosition(e.coordinatesConverter.convertViewPositionToModelPosition(i.position));t=new hn(n,i.selectionStartKind,i.selectionStartLeftoverVisibleColumns,s,i.leftoverVisibleColumns)}if(i){const n=e.coordinatesConverter.validateViewRange(i.selectionStart,t.selectionStart),s=e.coordinatesConverter.validateViewPosition(i.position,t.position);i=new hn(n,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,s,t.leftoverVisibleColumns)}else{const n=e.coordinatesConverter.convertModelPositionToViewPosition(new A(t.selectionStart.startLineNumber,t.selectionStart.startColumn)),s=e.coordinatesConverter.convertModelPositionToViewPosition(new A(t.selectionStart.endLineNumber,t.selectionStart.endColumn)),r=new L(n.lineNumber,n.column,s.lineNumber,s.column),a=e.coordinatesConverter.convertModelPositionToViewPosition(t.position);i=new hn(r,t.selectionStartKind,t.selectionStartLeftoverVisibleColumns,a,t.leftoverVisibleColumns)}this.modelState=t,this.viewState=i,this._updateTrackedRange(e)}}class b9{constructor(e){this.context=e,this.cursors=[new tL(e)],this.lastAddedCursorIndex=0}dispose(){for(const e of this.cursors)e.dispose(this.context)}startTrackingSelections(){for(const e of this.cursors)e.startTrackingSelection(this.context)}stopTrackingSelections(){for(const e of this.cursors)e.stopTrackingSelection(this.context)}updateContext(e){this.context=e}ensureValidState(){for(const e of this.cursors)e.ensureValidState(this.context)}readSelectionFromMarkers(){return this.cursors.map(e=>e.readSelectionFromMarkers(this.context))}getAll(){return this.cursors.map(e=>e.asCursorState())}getViewPositions(){return this.cursors.map(e=>e.viewState.position)}getTopMostViewPosition(){return gie(this.cursors,cs(e=>e.viewState.position,A.compare)).viewState.position}getBottomMostViewPosition(){return uie(this.cursors,cs(e=>e.viewState.position,A.compare)).viewState.position}getSelections(){return this.cursors.map(e=>e.modelState.selection)}getViewSelections(){return this.cursors.map(e=>e.viewState.selection)}setSelections(e){this.setStates(ht.fromModelSelections(e))}getPrimaryCursor(){return this.cursors[0].asCursorState()}setStates(e){e!==null&&(this.cursors[0].setState(this.context,e[0].modelState,e[0].viewState),this._setSecondaryStates(e.slice(1)))}_setSecondaryStates(e){const t=this.cursors.length-1,i=e.length;if(t<i){const n=i-t;for(let s=0;s<n;s++)this._addSecondaryCursor()}else if(t>i){const n=t-i;for(let s=0;s<n;s++)this._removeSecondaryCursor(this.cursors.length-2)}for(let n=0;n<i;n++)this.cursors[n+1].setState(this.context,e[n].modelState,e[n].viewState)}killSecondaryCursors(){this._setSecondaryStates([])}_addSecondaryCursor(){this.cursors.push(new tL(this.context)),this.lastAddedCursorIndex=this.cursors.length-1}getLastAddedCursorIndex(){return this.cursors.length===1||this.lastAddedCursorIndex===0?0:this.lastAddedCursorIndex}_removeSecondaryCursor(e){this.lastAddedCursorIndex>=e+1&&this.lastAddedCursorIndex--,this.cursors[e+1].dispose(this.context),this.cursors.splice(e+1,1)}normalize(){if(this.cursors.length===1)return;const e=this.cursors.slice(0),t=[];for(let i=0,n=e.length;i<n;i++)t.push({index:i,selection:e[i].modelState.selection});t.sort(cs(i=>i.selection,L.compareRangesUsingStarts));for(let i=0;i<t.length-1;i++){const n=t[i],s=t[i+1],r=n.selection,a=s.selection;if(!this.context.cursorConfig.multiCursorMergeOverlapping)continue;let l;if(a.isEmpty()||r.isEmpty()?l=a.getStartPosition().isBeforeOrEqual(r.getEndPosition()):l=a.getStartPosition().isBefore(r.getEndPosition()),l){const c=n.index<s.index?i:i+1,d=n.index<s.index?i+1:i,h=t[d].index,u=t[c].index,g=t[d].selection,f=t[c].selection;if(!g.equalsSelection(f)){const m=g.plusRange(f),_=g.selectionStartLineNumber===g.startLineNumber&&g.selectionStartColumn===g.startColumn,b=f.selectionStartLineNumber===f.startLineNumber&&f.selectionStartColumn===f.startColumn;let v;h===this.lastAddedCursorIndex?(v=_,this.lastAddedCursorIndex=u):v=b;let y;v?y=new pe(m.startLineNumber,m.startColumn,m.endLineNumber,m.endColumn):y=new pe(m.endLineNumber,m.endColumn,m.startLineNumber,m.startColumn),t[c].selection=y;const C=ht.fromModelSelection(y);e[u].setState(this.context,C.modelState,C.viewState)}for(const m of t)m.index>h&&m.index--;e.splice(h,1),t.splice(d,1),this._removeSecondaryCursor(h-1),i--}}}}class v9{constructor(e,t,i,n){this._cursorContextBrand=void 0,this.model=e,this.viewModel=t,this.coordinatesConverter=i,this.cursorConfig=n}}class s_e{constructor(){this.type=0}}class o_e{constructor(){this.type=1}}class r_e{constructor(e){this.type=2,this._source=e}hasChanged(e){return this._source.hasChanged(e)}}class a_e{constructor(e,t,i){this.selections=e,this.modelSelections=t,this.reason=i,this.type=3}}class fu{constructor(e){this.type=4,e?(this.affectsMinimap=e.affectsMinimap,this.affectsOverviewRuler=e.affectsOverviewRuler,this.affectsGlyphMargin=e.affectsGlyphMargin,this.affectsLineNumber=e.affectsLineNumber):(this.affectsMinimap=!0,this.affectsOverviewRuler=!0,this.affectsGlyphMargin=!0,this.affectsLineNumber=!0)}}class QS{constructor(){this.type=5}}class l_e{constructor(e){this.type=6,this.isFocused=e}}class c_e{constructor(){this.type=7}}class JS{constructor(){this.type=8}}class nj{constructor(e,t){this.fromLineNumber=e,this.count=t,this.type=9}}class rO{constructor(e,t){this.type=10,this.fromLineNumber=e,this.toLineNumber=t}}class aO{constructor(e,t){this.type=11,this.fromLineNumber=e,this.toLineNumber=t}}class oC{constructor(e,t,i,n,s,r,a){this.source=e,this.minimalReveal=t,this.range=i,this.selections=n,this.verticalType=s,this.revealHorizontal=r,this.scrollType=a,this.type=12}}class d_e{constructor(e){this.type=13,this.scrollWidth=e.scrollWidth,this.scrollLeft=e.scrollLeft,this.scrollHeight=e.scrollHeight,this.scrollTop=e.scrollTop,this.scrollWidthChanged=e.scrollWidthChanged,this.scrollLeftChanged=e.scrollLeftChanged,this.scrollHeightChanged=e.scrollHeightChanged,this.scrollTopChanged=e.scrollTopChanged}}class h_e{constructor(e){this.theme=e,this.type=14}}class u_e{constructor(e){this.type=15,this.ranges=e}}class g_e{constructor(){this.type=16}}let f_e=class{constructor(){this.type=17}};class p_e extends F{constructor(){super(),this._onEvent=this._register(new O),this.onEvent=this._onEvent.event,this._eventHandlers=[],this._viewEventQueue=null,this._isConsumingViewEventQueue=!1,this._collector=null,this._collectorCnt=0,this._outgoingEvents=[]}emitOutgoingEvent(e){this._addOutgoingEvent(e),this._emitOutgoingEvents()}_addOutgoingEvent(e){for(let t=0,i=this._outgoingEvents.length;t<i;t++){const n=this._outgoingEvents[t].kind===e.kind?this._outgoingEvents[t].attemptToMerge(e):null;if(n){this._outgoingEvents[t]=n;return}}this._outgoingEvents.push(e)}_emitOutgoingEvents(){for(;this._outgoingEvents.length>0;){if(this._collector||this._isConsumingViewEventQueue)return;const e=this._outgoingEvents.shift();e.isNoOp()||this._onEvent.fire(e)}}addViewEventHandler(e){for(let t=0,i=this._eventHandlers.length;t<i;t++)this._eventHandlers[t]===e&&console.warn("Detected duplicate listener in ViewEventDispatcher",e);this._eventHandlers.push(e)}removeViewEventHandler(e){for(let t=0;t<this._eventHandlers.length;t++)if(this._eventHandlers[t]===e){this._eventHandlers.splice(t,1);break}}beginEmitViewEvents(){return this._collectorCnt++,this._collectorCnt===1&&(this._collector=new m_e),this._collector}endEmitViewEvents(){if(this._collectorCnt--,this._collectorCnt===0){const e=this._collector.outgoingEvents,t=this._collector.viewEvents;this._collector=null;for(const i of e)this._addOutgoingEvent(i);t.length>0&&this._emitMany(t)}this._emitOutgoingEvents()}emitSingleViewEvent(e){try{this.beginEmitViewEvents().emitViewEvent(e)}finally{this.endEmitViewEvents()}}_emitMany(e){this._viewEventQueue?this._viewEventQueue=this._viewEventQueue.concat(e):this._viewEventQueue=e,this._isConsumingViewEventQueue||this._consumeViewEventQueue()}_consumeViewEventQueue(){try{this._isConsumingViewEventQueue=!0,this._doConsumeQueue()}finally{this._isConsumingViewEventQueue=!1}}_doConsumeQueue(){for(;this._viewEventQueue;){const e=this._viewEventQueue;this._viewEventQueue=null;const t=this._eventHandlers.slice(0);for(const i of t)i.handleEvents(e)}}}class m_e{constructor(){this.viewEvents=[],this.outgoingEvents=[]}emitViewEvent(e){this.viewEvents.push(e)}emitOutgoingEvent(e){this.outgoingEvents.push(e)}}class OB{constructor(e,t,i,n){this.kind=0,this._oldContentWidth=e,this._oldContentHeight=t,this.contentWidth=i,this.contentHeight=n,this.contentWidthChanged=this._oldContentWidth!==this.contentWidth,this.contentHeightChanged=this._oldContentHeight!==this.contentHeight}isNoOp(){return!this.contentWidthChanged&&!this.contentHeightChanged}attemptToMerge(e){return e.kind!==this.kind?null:new OB(this._oldContentWidth,this._oldContentHeight,e.contentWidth,e.contentHeight)}}class FB{constructor(e,t){this.kind=1,this.oldHasFocus=e,this.hasFocus=t}isNoOp(){return this.oldHasFocus===this.hasFocus}attemptToMerge(e){return e.kind!==this.kind?null:new FB(this.oldHasFocus,e.hasFocus)}}class BB{constructor(e,t,i,n,s,r,a,l){this.kind=2,this._oldScrollWidth=e,this._oldScrollLeft=t,this._oldScrollHeight=i,this._oldScrollTop=n,this.scrollWidth=s,this.scrollLeft=r,this.scrollHeight=a,this.scrollTop=l,this.scrollWidthChanged=this._oldScrollWidth!==this.scrollWidth,this.scrollLeftChanged=this._oldScrollLeft!==this.scrollLeft,this.scrollHeightChanged=this._oldScrollHeight!==this.scrollHeight,this.scrollTopChanged=this._oldScrollTop!==this.scrollTop}isNoOp(){return!this.scrollWidthChanged&&!this.scrollLeftChanged&&!this.scrollHeightChanged&&!this.scrollTopChanged}attemptToMerge(e){return e.kind!==this.kind?null:new BB(this._oldScrollWidth,this._oldScrollLeft,this._oldScrollHeight,this._oldScrollTop,e.scrollWidth,e.scrollLeft,e.scrollHeight,e.scrollTop)}}class __e{constructor(){this.kind=3}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class b_e{constructor(){this.kind=4}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class iL{constructor(e,t,i,n,s,r,a){this.kind=6,this.oldSelections=e,this.selections=t,this.oldModelVersionId=i,this.modelVersionId=n,this.source=s,this.reason=r,this.reachedMaxCursorCount=a}static _selectionsAreEqual(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;const i=e.length,n=t.length;if(i!==n)return!1;for(let s=0;s<i;s++)if(!e[s].equalsSelection(t[s]))return!1;return!0}isNoOp(){return iL._selectionsAreEqual(this.oldSelections,this.selections)&&this.oldModelVersionId===this.modelVersionId}attemptToMerge(e){return e.kind!==this.kind?null:new iL(this.oldSelections,e.selections,this.oldModelVersionId,e.modelVersionId,e.source,e.reason,this.reachedMaxCursorCount||e.reachedMaxCursorCount)}}class v_e{constructor(){this.kind=5}isNoOp(){return!1}attemptToMerge(e){return e.kind!==this.kind?null:this}}class C_e{constructor(e){this.event=e,this.kind=7}isNoOp(){return!1}attemptToMerge(e){return null}}class y_e{constructor(e){this.event=e,this.kind=8}isNoOp(){return!1}attemptToMerge(e){return null}}class w_e{constructor(e){this.event=e,this.kind=9}isNoOp(){return!1}attemptToMerge(e){return null}}class S_e{constructor(e){this.event=e,this.kind=10}isNoOp(){return!1}attemptToMerge(e){return null}}class x_e{constructor(e){this.event=e,this.kind=11}isNoOp(){return!1}attemptToMerge(e){return null}}class L_e{constructor(e){this.event=e,this.kind=12}isNoOp(){return!1}attemptToMerge(e){return null}}class k_e extends F{constructor(e,t,i,n){super(),this._model=e,this._knownModelVersionId=this._model.getVersionId(),this._viewModel=t,this._coordinatesConverter=i,this.context=new v9(this._model,this._viewModel,this._coordinatesConverter,n),this._cursors=new b9(this.context),this._hasFocus=!1,this._isHandling=!1,this._compositionState=null,this._columnSelectData=null,this._autoClosedActions=[],this._prevEditOperationType=0}dispose(){this._cursors.dispose(),this._autoClosedActions=Dt(this._autoClosedActions),super.dispose()}updateConfiguration(e){this.context=new v9(this._model,this._viewModel,this._coordinatesConverter,e),this._cursors.updateContext(this.context)}onLineMappingChanged(e){this._knownModelVersionId===this._model.getVersionId()&&this.setStates(e,"viewModel",0,this.getCursorStates())}setHasFocus(e){this._hasFocus=e}_validateAutoClosedActions(){if(this._autoClosedActions.length>0){const e=this._cursors.getSelections();for(let t=0;t<this._autoClosedActions.length;t++){const i=this._autoClosedActions[t];i.isValid(e)||(i.dispose(),this._autoClosedActions.splice(t,1),t--)}}}getPrimaryCursorState(){return this._cursors.getPrimaryCursor()}getLastAddedCursorIndex(){return this._cursors.getLastAddedCursorIndex()}getCursorStates(){return this._cursors.getAll()}setStates(e,t,i,n){let s=!1;const r=this.context.cursorConfig.multiCursorLimit;n!==null&&n.length>r&&(n=n.slice(0,r),s=!0);const a=rC.from(this._model,this);return this._cursors.setStates(n),this._cursors.normalize(),this._columnSelectData=null,this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,t,i,a,s)}setCursorColumnSelectData(e){this._columnSelectData=e}revealAll(e,t,i,n,s,r){const a=this._cursors.getViewPositions();let l=null,c=null;a.length>1?c=this._cursors.getViewSelections():l=L.fromPositions(a[0],a[0]),e.emitViewEvent(new oC(t,i,l,c,n,s,r))}revealPrimary(e,t,i,n,s,r){const l=[this._cursors.getPrimaryCursor().viewState.selection];e.emitViewEvent(new oC(t,i,null,l,n,s,r))}saveState(){const e=[],t=this._cursors.getSelections();for(let i=0,n=t.length;i<n;i++){const s=t[i];e.push({inSelectionMode:!s.isEmpty(),selectionStart:{lineNumber:s.selectionStartLineNumber,column:s.selectionStartColumn},position:{lineNumber:s.positionLineNumber,column:s.positionColumn}})}return e}restoreState(e,t){const i=[];for(let n=0,s=t.length;n<s;n++){const r=t[n];let a=1,l=1;r.position&&r.position.lineNumber&&(a=r.position.lineNumber),r.position&&r.position.column&&(l=r.position.column);let c=a,d=l;r.selectionStart&&r.selectionStart.lineNumber&&(c=r.selectionStart.lineNumber),r.selectionStart&&r.selectionStart.column&&(d=r.selectionStart.column),i.push({selectionStartLineNumber:c,selectionStartColumn:d,positionLineNumber:a,positionColumn:l})}this.setStates(e,"restoreState",0,ht.fromModelSelections(i)),this.revealAll(e,"restoreState",!1,0,!0,1)}onModelContentChanged(e,t){if(t instanceof W$){if(this._isHandling)return;this._isHandling=!0;try{this.setStates(e,"modelChange",0,this.getCursorStates())}finally{this._isHandling=!1}}else{const i=t.rawContentChangedEvent;if(this._knownModelVersionId=i.versionId,this._isHandling)return;const n=i.containsEvent(1);if(this._prevEditOperationType=0,n)this._cursors.dispose(),this._cursors=new b9(this.context),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(e,"model",1,null,!1);else if(this._hasFocus&&i.resultingSelection&&i.resultingSelection.length>0){const s=ht.fromModelSelections(i.resultingSelection);this.setStates(e,"modelChange",i.isUndoing?5:i.isRedoing?6:2,s)&&this.revealAll(e,"modelChange",!1,0,!0,0)}else{const s=this._cursors.readSelectionFromMarkers();this.setStates(e,"modelChange",2,ht.fromModelSelections(s))}}}getSelection(){return this._cursors.getPrimaryCursor().modelState.selection}getTopMostViewPosition(){return this._cursors.getTopMostViewPosition()}getBottomMostViewPosition(){return this._cursors.getBottomMostViewPosition()}getCursorColumnSelectData(){if(this._columnSelectData)return this._columnSelectData;const e=this._cursors.getPrimaryCursor(),t=e.viewState.selectionStart.getStartPosition(),i=e.viewState.position;return{isReal:!1,fromViewLineNumber:t.lineNumber,fromViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,t),toViewLineNumber:i.lineNumber,toViewVisualColumn:this.context.cursorConfig.visibleColumnFromColumn(this._viewModel,i)}}getSelections(){return this._cursors.getSelections()}setSelections(e,t,i,n){this.setStates(e,t,n,ht.fromModelSelections(i))}getPrevEditOperationType(){return this._prevEditOperationType}setPrevEditOperationType(e){this._prevEditOperationType=e}_pushAutoClosedAction(e,t){const i=[],n=[];for(let a=0,l=e.length;a<l;a++)i.push({range:e[a],options:{description:"auto-closed-character",inlineClassName:"auto-closed-character",stickiness:1}}),n.push({range:t[a],options:{description:"auto-closed-enclosing",stickiness:1}});const s=this._model.deltaDecorations([],i),r=this._model.deltaDecorations([],n);this._autoClosedActions.push(new C9(this._model,s,r))}_executeEditOperation(e){if(!e)return;e.shouldPushStackElementBefore&&this._model.pushStackElement();const t=E_e.executeCommands(this._model,this._cursors.getSelections(),e.commands);if(t){this._interpretCommandResult(t);const i=[],n=[];for(let s=0;s<e.commands.length;s++){const r=e.commands[s];r instanceof IB&&r.enclosingRange&&r.closeCharacterRange&&(i.push(r.closeCharacterRange),n.push(r.enclosingRange))}i.length>0&&this._pushAutoClosedAction(i,n),this._prevEditOperationType=e.type}e.shouldPushStackElementAfter&&this._model.pushStackElement()}_interpretCommandResult(e){(!e||e.length===0)&&(e=this._cursors.readSelectionFromMarkers()),this._columnSelectData=null,this._cursors.setSelections(e),this._cursors.normalize()}_emitStateChangedIfNecessary(e,t,i,n,s){const r=rC.from(this._model,this);if(r.equals(n))return!1;const a=this._cursors.getSelections(),l=this._cursors.getViewSelections();if(e.emitViewEvent(new a_e(l,a,i)),!n||n.cursorState.length!==r.cursorState.length||r.cursorState.some((c,d)=>!c.modelState.equals(n.cursorState[d].modelState))){const c=n?n.cursorState.map(h=>h.modelState.selection):null,d=n?n.modelVersionId:0;e.emitOutgoingEvent(new iL(c,a,d,r.modelVersionId,t||"keyboard",i,s))}return!0}_findAutoClosingPairs(e){if(!e.length)return null;const t=[];for(let i=0,n=e.length;i<n;i++){const s=e[i];if(!s.text||s.text.indexOf(`
`)>=0)return null;const r=s.text.match(/([)\]}>'"`])([^)\]}>'"`]*)$/);if(!r)return null;const a=r[1],l=this.context.cursorConfig.autoClosingPairs.autoClosingPairsCloseSingleChar.get(a);if(!l||l.length!==1)return null;const c=l[0].open,d=s.text.length-r[2].length-1,h=s.text.lastIndexOf(c,d-1);if(h===-1)return null;t.push([h,d])}return t}executeEdits(e,t,i,n){let s=null;t==="snippet"&&(s=this._findAutoClosingPairs(i)),s&&(i[0]._isTracked=!0);const r=[],a=[],l=this._model.pushEditOperations(this.getSelections(),i,c=>{if(s)for(let h=0,u=s.length;h<u;h++){const[g,f]=s[h],m=c[h],_=m.range.startLineNumber,b=m.range.startColumn-1+g,v=m.range.startColumn-1+f;r.push(new L(_,v+1,_,v+2)),a.push(new L(_,b+1,_,v+2))}const d=n(c);return d&&(this._isHandling=!0),d});l&&(this._isHandling=!1,this.setSelections(e,t,l,0)),r.length>0&&this._pushAutoClosedAction(r,a)}_executeEdit(e,t,i,n=0){if(this.context.cursorConfig.readOnly)return;const s=rC.from(this._model,this);this._cursors.stopTrackingSelections(),this._isHandling=!0;try{this._cursors.ensureValidState(),e()}catch(r){Ae(r)}this._isHandling=!1,this._cursors.startTrackingSelections(),this._validateAutoClosedActions(),this._emitStateChangedIfNecessary(t,i,n,s,!1)&&this.revealAll(t,i,!1,0,!0,0)}getAutoClosedCharacters(){return C9.getAllAutoClosedCharacters(this._autoClosedActions)}startComposition(e){this._compositionState=new aC(this._model,this.getSelections())}endComposition(e,t){const i=this._compositionState?this._compositionState.deduceOutcome(this._model,this.getSelections()):null;this._compositionState=null,this._executeEdit(()=>{t==="keyboard"&&this._executeEditOperation(Fd.compositionEndWithInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,i,this.getSelections(),this.getAutoClosedCharacters()))},e,t)}type(e,t,i){this._executeEdit(()=>{if(i==="keyboard"){const n=t.length;let s=0;for(;s<n;){const r=A4(t,s),a=t.substr(s,r);this._executeEditOperation(Fd.typeWithInterceptors(!!this._compositionState,this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),this.getAutoClosedCharacters(),a)),s+=r}}else this._executeEditOperation(Fd.typeWithoutInterceptors(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t))},e,i)}compositionType(e,t,i,n,s,r){if(t.length===0&&i===0&&n===0){if(s!==0){const a=this.getSelections().map(l=>{const c=l.getPosition();return new pe(c.lineNumber,c.column+s,c.lineNumber,c.column+s)});this.setSelections(e,r,a,0)}return}this._executeEdit(()=>{this._executeEditOperation(Fd.compositionType(this._prevEditOperationType,this.context.cursorConfig,this._model,this.getSelections(),t,i,n,s))},e,r)}paste(e,t,i,n,s){this._executeEdit(()=>{this._executeEditOperation(Fd.paste(this.context.cursorConfig,this._model,this.getSelections(),t,i,n||[]))},e,s,4)}cut(e,t){this._executeEdit(()=>{this._executeEditOperation(If.cut(this.context.cursorConfig,this._model,this.getSelections()))},e,t)}executeCommand(e,t,i){this._executeEdit(()=>{this._cursors.killSecondaryCursors(),this._executeEditOperation(new Rs(0,[t],{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}executeCommands(e,t,i){this._executeEdit(()=>{this._executeEditOperation(new Rs(0,t,{shouldPushStackElementBefore:!1,shouldPushStackElementAfter:!1}))},e,i)}}class rC{static from(e,t){return new rC(e.getVersionId(),t.getCursorStates())}constructor(e,t){this.modelVersionId=e,this.cursorState=t}equals(e){if(!e||this.modelVersionId!==e.modelVersionId||this.cursorState.length!==e.cursorState.length)return!1;for(let t=0,i=this.cursorState.length;t<i;t++)if(!this.cursorState[t].equals(e.cursorState[t]))return!1;return!0}}class C9{static getAllAutoClosedCharacters(e){let t=[];for(const i of e)t=t.concat(i.getAutoClosedCharactersRanges());return t}constructor(e,t,i){this._model=e,this._autoClosedCharactersDecorations=t,this._autoClosedEnclosingDecorations=i}dispose(){this._autoClosedCharactersDecorations=this._model.deltaDecorations(this._autoClosedCharactersDecorations,[]),this._autoClosedEnclosingDecorations=this._model.deltaDecorations(this._autoClosedEnclosingDecorations,[])}getAutoClosedCharactersRanges(){const e=[];for(let t=0;t<this._autoClosedCharactersDecorations.length;t++){const i=this._model.getDecorationRange(this._autoClosedCharactersDecorations[t]);i&&e.push(i)}return e}isValid(e){const t=[];for(let i=0;i<this._autoClosedEnclosingDecorations.length;i++){const n=this._model.getDecorationRange(this._autoClosedEnclosingDecorations[i]);if(n&&(t.push(n),n.startLineNumber!==n.endLineNumber))return!1}t.sort(L.compareRangesUsingStarts),e.sort(L.compareRangesUsingStarts);for(let i=0;i<e.length;i++)if(i>=t.length||!t[i].strictContainsRange(e[i]))return!1;return!0}}class E_e{static executeCommands(e,t,i){const n={model:e,selectionsBefore:t,trackedRanges:[],trackedRangesDirection:[]},s=this._innerExecuteCommands(n,i);for(let r=0,a=n.trackedRanges.length;r<a;r++)n.model._setTrackedRange(n.trackedRanges[r],null,0);return s}static _innerExecuteCommands(e,t){if(this._arrayIsEmpty(t))return null;const i=this._getEditOperations(e,t);if(i.operations.length===0)return null;const n=i.operations,s=this._getLoserCursorMap(n);if(s.hasOwnProperty("0"))return console.warn("Ignoring commands"),null;const r=[];for(let c=0,d=n.length;c<d;c++)s.hasOwnProperty(n[c].identifier.major.toString())||r.push(n[c]);i.hadTrackedEditOperation&&r.length>0&&(r[0]._isTracked=!0);let a=e.model.pushEditOperations(e.selectionsBefore,r,c=>{const d=[];for(let g=0;g<e.selectionsBefore.length;g++)d[g]=[];for(const g of c)g.identifier&&d[g.identifier.major].push(g);const h=(g,f)=>g.identifier.minor-f.identifier.minor,u=[];for(let g=0;g<e.selectionsBefore.length;g++)d[g].length>0?(d[g].sort(h),u[g]=t[g].computeCursorState(e.model,{getInverseEditOperations:()=>d[g],getTrackedSelection:f=>{const m=parseInt(f,10),_=e.model._getTrackedRange(e.trackedRanges[m]);return e.trackedRangesDirection[m]===0?new pe(_.startLineNumber,_.startColumn,_.endLineNumber,_.endColumn):new pe(_.endLineNumber,_.endColumn,_.startLineNumber,_.startColumn)}})):u[g]=e.selectionsBefore[g];return u});a||(a=e.selectionsBefore);const l=[];for(const c in s)s.hasOwnProperty(c)&&l.push(parseInt(c,10));l.sort((c,d)=>d-c);for(const c of l)a.splice(c,1);return a}static _arrayIsEmpty(e){for(let t=0,i=e.length;t<i;t++)if(e[t])return!1;return!0}static _getEditOperations(e,t){let i=[],n=!1;for(let s=0,r=t.length;s<r;s++){const a=t[s];if(a){const l=this._getEditOperationsFromCommand(e,s,a);i=i.concat(l.operations),n=n||l.hadTrackedEditOperation}}return{operations:i,hadTrackedEditOperation:n}}static _getEditOperationsFromCommand(e,t,i){const n=[];let s=0;const r=(h,u,g=!1)=>{L.isEmpty(h)&&u===""||n.push({identifier:{major:t,minor:s++},range:h,text:u,forceMoveMarkers:g,isAutoWhitespaceEdit:i.insertsAutoWhitespace})};let a=!1;const d={addEditOperation:r,addTrackedEditOperation:(h,u,g)=>{a=!0,r(h,u,g)},trackSelection:(h,u)=>{const g=pe.liftSelection(h);let f;if(g.isEmpty())if(typeof u=="boolean")u?f=2:f=3;else{const b=e.model.getLineMaxColumn(g.startLineNumber);g.startColumn===b?f=2:f=3}else f=1;const m=e.trackedRanges.length,_=e.model._setTrackedRange(null,g,f);return e.trackedRanges[m]=_,e.trackedRangesDirection[m]=g.getDirection(),m.toString()}};try{i.getEditOperations(e.model,d)}catch(h){return Ae(h),{operations:[],hadTrackedEditOperation:!1}}return{operations:n,hadTrackedEditOperation:a}}static _getLoserCursorMap(e){e=e.slice(0),e.sort((i,n)=>-L.compareRangesUsingEnds(i.range,n.range));const t={};for(let i=1;i<e.length;i++){const n=e[i-1],s=e[i];if(L.getStartPosition(n.range).isBefore(L.getEndPosition(s.range))){let r;n.identifier.major>s.identifier.major?r=n.identifier.major:r=s.identifier.major,t[r.toString()]=!0;for(let a=0;a<e.length;a++)e[a].identifier.major===r&&(e.splice(a,1),a<i&&i--,a--);i>0&&i--}}return t}}class T_e{constructor(e,t,i){this.text=e,this.startSelection=t,this.endSelection=i}}class aC{static _capture(e,t){const i=[];for(const n of t){if(n.startLineNumber!==n.endLineNumber)return null;i.push(new T_e(e.getLineContent(n.startLineNumber),n.startColumn-1,n.endColumn-1))}return i}constructor(e,t){this._original=aC._capture(e,t)}deduceOutcome(e,t){if(!this._original)return null;const i=aC._capture(e,t);if(!i||this._original.length!==i.length)return null;const n=[];for(let s=0,r=this._original.length;s<r;s++)n.push(aC._deduceOutcome(this._original[s],i[s]));return n}static _deduceOutcome(e,t){const i=Math.min(e.startSelection,t.startSelection,Dh(e.text,t.text)),n=Math.min(e.text.length-e.endSelection,t.text.length-t.endSelection,E0(e.text,t.text)),s=e.text.substring(i,e.text.length-n),r=t.text.substring(i,t.text.length-n);return new tme(s,e.startSelection-i,e.endSelection-i,r,t.startSelection-i,t.endSelection-i)}}class D_e{constructor(){this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[]}insert(e){this._hasPending=!0,this._inserts.push(e)}change(e){this._hasPending=!0,this._changes.push(e)}remove(e){this._hasPending=!0,this._removes.push(e)}mustCommit(){return this._hasPending}commit(e){if(!this._hasPending)return;const t=this._inserts,i=this._changes,n=this._removes;this._hasPending=!1,this._inserts=[],this._changes=[],this._removes=[],e._commitPendingChanges(t,i,n)}}class I_e{constructor(e,t,i,n,s){this.id=e,this.afterLineNumber=t,this.ordinal=i,this.height=n,this.minWidth=s,this.prefixSum=0}}var lh;let N_e=(lh=class{constructor(e,t,i,n){this._instanceId=Dz(++lh.INSTANCE_COUNT),this._pendingChanges=new D_e,this._lastWhitespaceId=0,this._arr=[],this._prefixSumValidIndex=-1,this._minWidth=-1,this._lineCount=e,this._lineHeight=t,this._paddingTop=i,this._paddingBottom=n}static findInsertionIndex(e,t,i){let n=0,s=e.length;for(;n<s;){const r=n+s>>>1;t===e[r].afterLineNumber?i<e[r].ordinal?s=r:n=r+1:t<e[r].afterLineNumber?s=r:n=r+1}return n}setLineHeight(e){this._checkPendingChanges(),this._lineHeight=e}setPadding(e,t){this._paddingTop=e,this._paddingBottom=t}onFlushed(e){this._checkPendingChanges(),this._lineCount=e}changeWhitespace(e){let t=!1;try{e({insertWhitespace:(n,s,r,a)=>{t=!0,n=n|0,s=s|0,r=r|0,a=a|0;const l=this._instanceId+ ++this._lastWhitespaceId;return this._pendingChanges.insert(new I_e(l,n,s,r,a)),l},changeOneWhitespace:(n,s,r)=>{t=!0,s=s|0,r=r|0,this._pendingChanges.change({id:n,newAfterLineNumber:s,newHeight:r})},removeWhitespace:n=>{t=!0,this._pendingChanges.remove({id:n})}})}finally{this._pendingChanges.commit(this)}return t}_commitPendingChanges(e,t,i){if((e.length>0||i.length>0)&&(this._minWidth=-1),e.length+t.length+i.length<=1){for(const l of e)this._insertWhitespace(l);for(const l of t)this._changeOneWhitespace(l.id,l.newAfterLineNumber,l.newHeight);for(const l of i){const c=this._findWhitespaceIndex(l.id);c!==-1&&this._removeWhitespace(c)}return}const n=new Set;for(const l of i)n.add(l.id);const s=new Map;for(const l of t)s.set(l.id,l);const r=l=>{const c=[];for(const d of l)if(!n.has(d.id)){if(s.has(d.id)){const h=s.get(d.id);d.afterLineNumber=h.newAfterLineNumber,d.height=h.newHeight}c.push(d)}return c},a=r(this._arr).concat(r(e));a.sort((l,c)=>l.afterLineNumber===c.afterLineNumber?l.ordinal-c.ordinal:l.afterLineNumber-c.afterLineNumber),this._arr=a,this._prefixSumValidIndex=-1}_checkPendingChanges(){this._pendingChanges.mustCommit()&&this._pendingChanges.commit(this)}_insertWhitespace(e){const t=lh.findInsertionIndex(this._arr,e.afterLineNumber,e.ordinal);this._arr.splice(t,0,e),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,t-1)}_findWhitespaceIndex(e){const t=this._arr;for(let i=0,n=t.length;i<n;i++)if(t[i].id===e)return i;return-1}_changeOneWhitespace(e,t,i){const n=this._findWhitespaceIndex(e);if(n!==-1&&(this._arr[n].height!==i&&(this._arr[n].height=i,this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,n-1)),this._arr[n].afterLineNumber!==t)){const s=this._arr[n];this._removeWhitespace(n),s.afterLineNumber=t,this._insertWhitespace(s)}}_removeWhitespace(e){this._arr.splice(e,1),this._prefixSumValidIndex=Math.min(this._prefixSumValidIndex,e-1)}onLinesDeleted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount-=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const s=this._arr[i].afterLineNumber;e<=s&&s<=t?this._arr[i].afterLineNumber=e-1:s>t&&(this._arr[i].afterLineNumber-=t-e+1)}}onLinesInserted(e,t){this._checkPendingChanges(),e=e|0,t=t|0,this._lineCount+=t-e+1;for(let i=0,n=this._arr.length;i<n;i++){const s=this._arr[i].afterLineNumber;e<=s&&(this._arr[i].afterLineNumber+=t-e+1)}}getWhitespacesTotalHeight(){return this._checkPendingChanges(),this._arr.length===0?0:this.getWhitespacesAccumulatedHeight(this._arr.length-1)}getWhitespacesAccumulatedHeight(e){this._checkPendingChanges(),e=e|0;let t=Math.max(0,this._prefixSumValidIndex+1);t===0&&(this._arr[0].prefixSum=this._arr[0].height,t++);for(let i=t;i<=e;i++)this._arr[i].prefixSum=this._arr[i-1].prefixSum+this._arr[i].height;return this._prefixSumValidIndex=Math.max(this._prefixSumValidIndex,e),this._arr[e].prefixSum}getLinesTotalHeight(){this._checkPendingChanges();const e=this._lineHeight*this._lineCount,t=this.getWhitespacesTotalHeight();return e+t+this._paddingTop+this._paddingBottom}getWhitespaceAccumulatedHeightBeforeLineNumber(e){this._checkPendingChanges(),e=e|0;const t=this._findLastWhitespaceBeforeLineNumber(e);return t===-1?0:this.getWhitespacesAccumulatedHeight(t)}_findLastWhitespaceBeforeLineNumber(e){e=e|0;const t=this._arr;let i=0,n=t.length-1;for(;i<=n;){const r=(n-i|0)/2|0,a=i+r|0;if(t[a].afterLineNumber<e){if(a+1>=t.length||t[a+1].afterLineNumber>=e)return a;i=a+1|0}else n=a-1|0}return-1}_findFirstWhitespaceAfterLineNumber(e){e=e|0;const i=this._findLastWhitespaceBeforeLineNumber(e)+1;return i<this._arr.length?i:-1}getFirstWhitespaceIndexAfterLineNumber(e){return this._checkPendingChanges(),e=e|0,this._findFirstWhitespaceAfterLineNumber(e)}getVerticalOffsetForLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;let i;e>1?i=this._lineHeight*(e-1):i=0;const n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e-(t?1:0));return i+n+this._paddingTop}getVerticalOffsetAfterLineNumber(e,t=!1){this._checkPendingChanges(),e=e|0;const i=this._lineHeight*e,n=this.getWhitespaceAccumulatedHeightBeforeLineNumber(e+(t?1:0));return i+n+this._paddingTop}getWhitespaceMinWidth(){if(this._checkPendingChanges(),this._minWidth===-1){let e=0;for(let t=0,i=this._arr.length;t<i;t++)e=Math.max(e,this._arr[t].minWidth);this._minWidth=e}return this._minWidth}isAfterLines(e){this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>t}isInTopPadding(e){return this._paddingTop===0?!1:(this._checkPendingChanges(),e<this._paddingTop)}isInBottomPadding(e){if(this._paddingBottom===0)return!1;this._checkPendingChanges();const t=this.getLinesTotalHeight();return e>=t-this._paddingBottom}getLineNumberAtOrAfterVerticalOffset(e){if(this._checkPendingChanges(),e=e|0,e<0)return 1;const t=this._lineCount|0,i=this._lineHeight;let n=1,s=t;for(;n<s;){const r=(n+s)/2|0,a=this.getVerticalOffsetForLineNumber(r)|0;if(e>=a+i)n=r+1;else{if(e>=a)return r;s=r}}return n>t?t:n}getLinesViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this._lineHeight,n=this.getLineNumberAtOrAfterVerticalOffset(e)|0,s=this.getVerticalOffsetForLineNumber(n)|0;let r=this._lineCount|0,a=this.getFirstWhitespaceIndexAfterLineNumber(n)|0;const l=this.getWhitespacesCount()|0;let c,d;a===-1?(a=l,d=r+1,c=0):(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);let h=s,u=h;const g=5e5;let f=0;s>=g&&(f=Math.floor(s/g)*g,f=Math.floor(f/i)*i,u-=f);const m=[],_=e+(t-e)/2;let b=-1;for(let w=n;w<=r;w++){if(b===-1){const x=h,k=h+i;(x<=_&&_<k||x>_)&&(b=w)}for(h+=i,m[w-n]=u,u+=i;d===w;)u+=c,h+=c,a++,a>=l?d=r+1:(d=this.getAfterLineNumberForWhitespaceIndex(a)|0,c=this.getHeightForWhitespaceIndex(a)|0);if(h>=t){r=w;break}}b===-1&&(b=r);const v=this.getVerticalOffsetForLineNumber(r)|0;let y=n,C=r;return y<C&&s<e&&y++,y<C&&v+i>t&&C--,{bigNumbersDelta:f,startLineNumber:n,endLineNumber:r,relativeVerticalOffset:m,centeredLineNumber:b,completelyVisibleStartLineNumber:y,completelyVisibleEndLineNumber:C,lineHeight:this._lineHeight}}getVerticalOffsetForWhitespaceIndex(e){this._checkPendingChanges(),e=e|0;const t=this.getAfterLineNumberForWhitespaceIndex(e);let i;t>=1?i=this._lineHeight*t:i=0;let n;return e>0?n=this.getWhitespacesAccumulatedHeight(e-1):n=0,i+n+this._paddingTop}getWhitespaceIndexAtOrAfterVerticallOffset(e){this._checkPendingChanges(),e=e|0;let t=0,i=this.getWhitespacesCount()-1;if(i<0)return-1;const n=this.getVerticalOffsetForWhitespaceIndex(i),s=this.getHeightForWhitespaceIndex(i);if(e>=n+s)return-1;for(;t<i;){const r=Math.floor((t+i)/2),a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(e>=a+l)t=r+1;else{if(e>=a)return r;i=r}}return t}getWhitespaceAtVerticalOffset(e){this._checkPendingChanges(),e=e|0;const t=this.getWhitespaceIndexAtOrAfterVerticallOffset(e);if(t<0||t>=this.getWhitespacesCount())return null;const i=this.getVerticalOffsetForWhitespaceIndex(t);if(i>e)return null;const n=this.getHeightForWhitespaceIndex(t),s=this.getIdForWhitespaceIndex(t),r=this.getAfterLineNumberForWhitespaceIndex(t);return{id:s,afterLineNumber:r,verticalOffset:i,height:n}}getWhitespaceViewportData(e,t){this._checkPendingChanges(),e=e|0,t=t|0;const i=this.getWhitespaceIndexAtOrAfterVerticallOffset(e),n=this.getWhitespacesCount()-1;if(i<0)return[];const s=[];for(let r=i;r<=n;r++){const a=this.getVerticalOffsetForWhitespaceIndex(r),l=this.getHeightForWhitespaceIndex(r);if(a>=t)break;s.push({id:this.getIdForWhitespaceIndex(r),afterLineNumber:this.getAfterLineNumberForWhitespaceIndex(r),verticalOffset:a,height:l})}return s}getWhitespaces(){return this._checkPendingChanges(),this._arr.slice(0)}getWhitespacesCount(){return this._checkPendingChanges(),this._arr.length}getIdForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].id}getAfterLineNumberForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].afterLineNumber}getHeightForWhitespaceIndex(e){return this._checkPendingChanges(),e=e|0,this._arr[e].height}},lh.INSTANCE_COUNT=0,lh);const R_e=125;class Cv{constructor(e,t,i,n){e=e|0,t=t|0,i=i|0,n=n|0,e<0&&(e=0),t<0&&(t=0),i<0&&(i=0),n<0&&(n=0),this.width=e,this.contentWidth=t,this.scrollWidth=Math.max(e,t),this.height=i,this.contentHeight=n,this.scrollHeight=Math.max(i,n)}equals(e){return this.width===e.width&&this.contentWidth===e.contentWidth&&this.height===e.height&&this.contentHeight===e.contentHeight}}class P_e extends F{constructor(e,t){super(),this._onDidContentSizeChange=this._register(new O),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._dimensions=new Cv(0,0,0,0),this._scrollable=this._register(new db({forceIntegerValues:!0,smoothScrollDuration:e,scheduleAtNextAnimationFrame:t})),this.onDidScroll=this._scrollable.onScroll}getScrollable(){return this._scrollable}setSmoothScrollDuration(e){this._scrollable.setSmoothScrollDuration(e)}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}getScrollDimensions(){return this._dimensions}setScrollDimensions(e){if(this._dimensions.equals(e))return;const t=this._dimensions;this._dimensions=e,this._scrollable.setScrollDimensions({width:e.width,scrollWidth:e.scrollWidth,height:e.height,scrollHeight:e.scrollHeight},!0);const i=t.contentWidth!==e.contentWidth,n=t.contentHeight!==e.contentHeight;(i||n)&&this._onDidContentSizeChange.fire(new OB(t.contentWidth,t.contentHeight,e.contentWidth,e.contentHeight))}getFutureScrollPosition(){return this._scrollable.getFutureScrollPosition()}getCurrentScrollPosition(){return this._scrollable.getCurrentScrollPosition()}setScrollPositionNow(e){this._scrollable.setScrollPositionNow(e)}setScrollPositionSmooth(e){this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}}class A_e extends F{constructor(e,t,i){super(),this._configuration=e;const n=this._configuration.options,s=n.get(146),r=n.get(84);this._linesLayout=new N_e(t,n.get(67),r.top,r.bottom),this._maxLineWidth=0,this._overlayWidgetsMinWidth=0,this._scrollable=this._register(new P_e(0,i)),this._configureSmoothScrollDuration(),this._scrollable.setScrollDimensions(new Cv(s.contentWidth,0,s.height,0)),this.onDidScroll=this._scrollable.onDidScroll,this.onDidContentSizeChange=this._scrollable.onDidContentSizeChange,this._updateHeight()}dispose(){super.dispose()}getScrollable(){return this._scrollable.getScrollable()}onHeightMaybeChanged(){this._updateHeight()}_configureSmoothScrollDuration(){this._scrollable.setSmoothScrollDuration(this._configuration.options.get(115)?R_e:0)}onConfigurationChanged(e){const t=this._configuration.options;if(e.hasChanged(67)&&this._linesLayout.setLineHeight(t.get(67)),e.hasChanged(84)){const i=t.get(84);this._linesLayout.setPadding(i.top,i.bottom)}if(e.hasChanged(146)){const i=t.get(146),n=i.contentWidth,s=i.height,r=this._scrollable.getScrollDimensions(),a=r.contentWidth;this._scrollable.setScrollDimensions(new Cv(n,r.contentWidth,s,this._getContentHeight(n,s,a)))}else this._updateHeight();e.hasChanged(115)&&this._configureSmoothScrollDuration()}onFlushed(e){this._linesLayout.onFlushed(e)}onLinesDeleted(e,t){this._linesLayout.onLinesDeleted(e,t)}onLinesInserted(e,t){this._linesLayout.onLinesInserted(e,t)}_getHorizontalScrollbarHeight(e,t){const n=this._configuration.options.get(104);return n.horizontal===2||e>=t?0:n.horizontalScrollbarSize}_getContentHeight(e,t,i){const n=this._configuration.options;let s=this._linesLayout.getLinesTotalHeight();return n.get(106)?s+=Math.max(0,t-n.get(67)-n.get(84).bottom):n.get(104).ignoreHorizontalScrollbarInContentHeight||(s+=this._getHorizontalScrollbarHeight(e,i)),s}_updateHeight(){const e=this._scrollable.getScrollDimensions(),t=e.width,i=e.height,n=e.contentWidth;this._scrollable.setScrollDimensions(new Cv(t,e.contentWidth,i,this._getContentHeight(t,i,n)))}getCurrentViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getCurrentScrollPosition();return new $7(t.scrollTop,t.scrollLeft,e.width,e.height)}getFutureViewport(){const e=this._scrollable.getScrollDimensions(),t=this._scrollable.getFutureScrollPosition();return new $7(t.scrollTop,t.scrollLeft,e.width,e.height)}_computeContentWidth(){const e=this._configuration.options,t=this._maxLineWidth,i=e.get(147),n=e.get(50),s=e.get(146);if(i.isViewportWrapping){const r=e.get(73);return t>s.contentWidth+n.typicalHalfwidthCharacterWidth&&r.enabled&&r.side==="right"?t+s.verticalScrollbarWidth:t}else{const r=e.get(105)*n.typicalHalfwidthCharacterWidth,a=this._linesLayout.getWhitespaceMinWidth();return Math.max(t+r+s.verticalScrollbarWidth,a,this._overlayWidgetsMinWidth)}}setMaxLineWidth(e){this._maxLineWidth=e,this._updateContentWidth()}setOverlayWidgetsMinWidth(e){this._overlayWidgetsMinWidth=e,this._updateContentWidth()}_updateContentWidth(){const e=this._scrollable.getScrollDimensions();this._scrollable.setScrollDimensions(new Cv(e.width,this._computeContentWidth(),e.height,e.contentHeight)),this._updateHeight()}saveState(){const e=this._scrollable.getFutureScrollPosition(),t=e.scrollTop,i=this._linesLayout.getLineNumberAtOrAfterVerticalOffset(t),n=this._linesLayout.getWhitespaceAccumulatedHeightBeforeLineNumber(i);return{scrollTop:t,scrollTopWithoutViewZones:t-n,scrollLeft:e.scrollLeft}}changeWhitespace(e){const t=this._linesLayout.changeWhitespace(e);return t&&this.onHeightMaybeChanged(),t}getVerticalOffsetForLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetForLineNumber(e,t)}getVerticalOffsetAfterLineNumber(e,t=!1){return this._linesLayout.getVerticalOffsetAfterLineNumber(e,t)}isAfterLines(e){return this._linesLayout.isAfterLines(e)}isInTopPadding(e){return this._linesLayout.isInTopPadding(e)}isInBottomPadding(e){return this._linesLayout.isInBottomPadding(e)}getLineNumberAtVerticalOffset(e){return this._linesLayout.getLineNumberAtOrAfterVerticalOffset(e)}getWhitespaceAtVerticalOffset(e){return this._linesLayout.getWhitespaceAtVerticalOffset(e)}getLinesViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getLinesViewportData(e.top,e.top+e.height)}getLinesViewportDataAtScrollTop(e){const t=this._scrollable.getScrollDimensions();return e+t.height>t.scrollHeight&&(e=t.scrollHeight-t.height),e<0&&(e=0),this._linesLayout.getLinesViewportData(e,e+t.height)}getWhitespaceViewportData(){const e=this.getCurrentViewport();return this._linesLayout.getWhitespaceViewportData(e.top,e.top+e.height)}getWhitespaces(){return this._linesLayout.getWhitespaces()}getContentWidth(){return this._scrollable.getScrollDimensions().contentWidth}getScrollWidth(){return this._scrollable.getScrollDimensions().scrollWidth}getContentHeight(){return this._scrollable.getScrollDimensions().contentHeight}getScrollHeight(){return this._scrollable.getScrollDimensions().scrollHeight}getCurrentScrollLeft(){return this._scrollable.getCurrentScrollPosition().scrollLeft}getCurrentScrollTop(){return this._scrollable.getCurrentScrollPosition().scrollTop}validateScrollPosition(e){return this._scrollable.validateScrollPosition(e)}setScrollPosition(e,t){t===1?this._scrollable.setScrollPositionNow(e):this._scrollable.setScrollPositionSmooth(e)}hasPendingScrollAnimation(){return this._scrollable.hasPendingScrollAnimation()}deltaScrollNow(e,t){const i=this._scrollable.getCurrentScrollPosition();this._scrollable.setScrollPositionNow({scrollLeft:i.scrollLeft+e,scrollTop:i.scrollTop+t})}}class M_e{constructor(e,t,i,n,s){this.editorId=e,this.model=t,this.configuration=i,this._linesCollection=n,this._coordinatesConverter=s,this._decorationsCache=Object.create(null),this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}_clearCachedModelDecorationsResolver(){this._cachedModelDecorationsResolver=null,this._cachedModelDecorationsResolverViewRange=null}dispose(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}reset(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onModelDecorationsChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}onLineMappingChanged(){this._decorationsCache=Object.create(null),this._clearCachedModelDecorationsResolver()}_getOrCreateViewModelDecoration(e){const t=e.id;let i=this._decorationsCache[t];if(!i){const n=e.range,s=e.options;let r;if(s.isWholeLine){const a=this._coordinatesConverter.convertModelPositionToViewPosition(new A(n.startLineNumber,1),0,!1,!0),l=this._coordinatesConverter.convertModelPositionToViewPosition(new A(n.endLineNumber,this.model.getLineMaxColumn(n.endLineNumber)),1);r=new L(a.lineNumber,a.column,l.lineNumber,l.column)}else r=this._coordinatesConverter.convertModelRangeToViewRange(n,1);i=new MK(r,s),this._decorationsCache[t]=i}return i}getMinimapDecorationsInRange(e){return this._getDecorationsInRange(e,!0,!1).decorations}getDecorationsViewportData(e){let t=this._cachedModelDecorationsResolver!==null;return t=t&&e.equalsRange(this._cachedModelDecorationsResolverViewRange),t||(this._cachedModelDecorationsResolver=this._getDecorationsInRange(e,!1,!1),this._cachedModelDecorationsResolverViewRange=e),this._cachedModelDecorationsResolver}getInlineDecorationsOnLine(e,t=!1,i=!1){const n=new L(e,this._linesCollection.getViewLineMinColumn(e),e,this._linesCollection.getViewLineMaxColumn(e));return this._getDecorationsInRange(n,t,i).inlineDecorations[0]}_getDecorationsInRange(e,t,i){const n=this._linesCollection.getDecorationsInRange(e,this.editorId,v0(this.configuration.options),t,i),s=e.startLineNumber,r=e.endLineNumber,a=[];let l=0;const c=[];for(let d=s;d<=r;d++)c[d-s]=[];for(let d=0,h=n.length;d<h;d++){const u=n[d],g=u.options;if(!WB(this.model,u))continue;const f=this._getOrCreateViewModelDecoration(u),m=f.range;if(a[l++]=f,g.inlineClassName){const _=new Qv(m,g.inlineClassName,g.inlineClassNameAffectsLetterSpacing?3:0),b=Math.max(s,m.startLineNumber),v=Math.min(r,m.endLineNumber);for(let y=b;y<=v;y++)c[y-s].push(_)}if(g.beforeContentClassName&&s<=m.startLineNumber&&m.startLineNumber<=r){const _=new Qv(new L(m.startLineNumber,m.startColumn,m.startLineNumber,m.startColumn),g.beforeContentClassName,1);c[m.startLineNumber-s].push(_)}if(g.afterContentClassName&&s<=m.endLineNumber&&m.endLineNumber<=r){const _=new Qv(new L(m.endLineNumber,m.endColumn,m.endLineNumber,m.endColumn),g.afterContentClassName,2);c[m.endLineNumber-s].push(_)}}return{decorations:a,inlineDecorations:c}}}function WB(o,e){return!(e.options.hideInCommentTokens&&VB(o,e)||e.options.hideInStringTokens&&HB(o,e))}function VB(o,e){return sj(o,e.range,t=>t===1)}function HB(o,e){return sj(o,e.range,t=>t===2)}function sj(o,e,t){for(let i=e.startLineNumber;i<=e.endLineNumber;i++){const n=o.tokenization.getLineTokens(i),s=i===e.startLineNumber,r=i===e.endLineNumber;let a=s?n.findTokenIndexAtOffset(e.startColumn-1):0;for(;a<n.getCount()&&!(r&&n.getStartOffset(a)>e.endColumn-1);){if(!t(n.getStandardTokenType(a)))return!1;a++}}return!0}function rN(o,e){return o===null?e?nL.INSTANCE:sL.INSTANCE:new O_e(o,e)}class O_e{constructor(e,t){this._projectionData=e,this._isVisible=t}isVisible(){return this._isVisible}setVisible(e){return this._isVisible=e,this}getProjectionData(){return this._projectionData}getViewLineCount(){return this._isVisible?this._projectionData.getOutputLineCount():0}getViewLineContent(e,t,i){this._assertVisible();const n=i>0?this._projectionData.breakOffsets[i-1]:0,s=this._projectionData.breakOffsets[i];let r;if(this._projectionData.injectionOffsets!==null){const a=this._projectionData.injectionOffsets.map((c,d)=>new Na(0,0,c+1,this._projectionData.injectionOptions[d],0));r=Na.applyInjectedText(e.getLineContent(t),a).substring(n,s)}else r=e.getValueInRange({startLineNumber:t,startColumn:n+1,endLineNumber:t,endColumn:s+1});return i>0&&(r=y9(this._projectionData.wrappedTextIndentLength)+r),r}getViewLineLength(e,t,i){return this._assertVisible(),this._projectionData.getLineLength(i)}getViewLineMinColumn(e,t,i){return this._assertVisible(),this._projectionData.getMinOutputOffset(i)+1}getViewLineMaxColumn(e,t,i){return this._assertVisible(),this._projectionData.getMaxOutputOffset(i)+1}getViewLineData(e,t,i){const n=new Array;return this.getViewLinesData(e,t,i,1,0,[!0],n),n[0]}getViewLinesData(e,t,i,n,s,r,a){this._assertVisible();const l=this._projectionData,c=l.injectionOffsets,d=l.injectionOptions;let h=null;if(c){h=[];let g=0,f=0;for(let m=0;m<l.getOutputLineCount();m++){const _=new Array;h[m]=_;const b=m>0?l.breakOffsets[m-1]:0,v=l.breakOffsets[m];for(;f<c.length;){const y=d[f].content.length,C=c[f]+g,w=C+y;if(C>v)break;if(b<w){const x=d[f];if(x.inlineClassName){const k=m>0?l.wrappedTextIndentLength:0,E=k+Math.max(C-b,0),N=k+Math.min(w-b,v-b);E!==N&&_.push(new Tfe(E,N,x.inlineClassName,x.inlineClassNameAffectsLetterSpacing))}}if(w<=v)g+=y,f++;else break}}}let u;c?u=e.tokenization.getLineTokens(t).withInserted(c.map((g,f)=>({offset:g,text:d[f].content,tokenMetadata:an.defaultTokenMetadata}))):u=e.tokenization.getLineTokens(t);for(let g=i;g<i+n;g++){const f=s+g-i;if(!r[f]){a[f]=null;continue}a[f]=this._getViewLineData(u,h?h[g]:null,g)}}_getViewLineData(e,t,i){this._assertVisible();const n=this._projectionData,s=i>0?n.wrappedTextIndentLength:0,r=i>0?n.breakOffsets[i-1]:0,a=n.breakOffsets[i],l=e.sliceAndInflate(r,a,s);let c=l.getLineContent();i>0&&(c=y9(n.wrappedTextIndentLength)+c);const d=this._projectionData.getMinOutputOffset(i)+1,h=c.length+1,u=i+1<this.getViewLineCount(),g=i===0?0:n.breakOffsetsVisibleColumn[i-1];return new CB(c,u,d,h,g,l,t)}getModelColumnOfViewPosition(e,t){return this._assertVisible(),this._projectionData.translateToInputOffset(e,t-1)+1}getViewPositionOfModelPosition(e,t,i=2){return this._assertVisible(),this._projectionData.translateToOutputPosition(t-1,i).toPosition(e)}getViewLineNumberOfModelPosition(e,t){this._assertVisible();const i=this._projectionData.translateToOutputPosition(t-1);return e+i.outputLineIndex}normalizePosition(e,t,i){const n=t.lineNumber-e;return this._projectionData.normalizeOutputPosition(e,t.column-1,i).toPosition(n)}getInjectedTextAt(e,t){return this._projectionData.getInjectedText(e,t-1)}_assertVisible(){if(!this._isVisible)throw new Error("Not supported")}}const iE=class iE{constructor(){}isVisible(){return!0}setVisible(e){return e?this:sL.INSTANCE}getProjectionData(){return null}getViewLineCount(){return 1}getViewLineContent(e,t,i){return e.getLineContent(t)}getViewLineLength(e,t,i){return e.getLineLength(t)}getViewLineMinColumn(e,t,i){return e.getLineMinColumn(t)}getViewLineMaxColumn(e,t,i){return e.getLineMaxColumn(t)}getViewLineData(e,t,i){const n=e.tokenization.getLineTokens(t),s=n.getLineContent();return new CB(s,!1,1,s.length+1,0,n.inflate(),null)}getViewLinesData(e,t,i,n,s,r,a){if(!r[s]){a[s]=null;return}a[s]=this.getViewLineData(e,t,0)}getModelColumnOfViewPosition(e,t){return t}getViewPositionOfModelPosition(e,t){return new A(e,t)}getViewLineNumberOfModelPosition(e,t){return e}normalizePosition(e,t,i){return t}getInjectedTextAt(e,t){return null}};iE.INSTANCE=new iE;let nL=iE;const nE=class nE{constructor(){}isVisible(){return!1}setVisible(e){return e?nL.INSTANCE:this}getProjectionData(){return null}getViewLineCount(){return 0}getViewLineContent(e,t,i){throw new Error("Not supported")}getViewLineLength(e,t,i){throw new Error("Not supported")}getViewLineMinColumn(e,t,i){throw new Error("Not supported")}getViewLineMaxColumn(e,t,i){throw new Error("Not supported")}getViewLineData(e,t,i){throw new Error("Not supported")}getViewLinesData(e,t,i,n,s,r,a){throw new Error("Not supported")}getModelColumnOfViewPosition(e,t){throw new Error("Not supported")}getViewPositionOfModelPosition(e,t){throw new Error("Not supported")}getViewLineNumberOfModelPosition(e,t){throw new Error("Not supported")}normalizePosition(e,t,i){throw new Error("Not supported")}getInjectedTextAt(e,t){throw new Error("Not supported")}};nE.INSTANCE=new nE;let sL=nE;const aN=[""];function y9(o){if(o>=aN.length)for(let e=1;e<=o;e++)aN[e]=F_e(e);return aN[o]}function F_e(o){return new Array(o+1).join(" ")}class B_e{constructor(e,t,i,n,s,r,a,l,c,d){this._editorId=e,this.model=t,this._validModelVersionId=-1,this._domLineBreaksComputerFactory=i,this._monospaceLineBreaksComputerFactory=n,this.fontInfo=s,this.tabSize=r,this.wrappingStrategy=a,this.wrappingColumn=l,this.wrappingIndent=c,this.wordBreak=d,this._constructLines(!0,null)}dispose(){this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[])}createCoordinatesConverter(){return new V_e(this)}_constructLines(e,t){this.modelLineProjections=[],e&&(this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,[]));const i=this.model.getLinesContent(),n=this.model.getInjectedTextDecorations(this._editorId),s=i.length,r=this.createLineBreaksComputer(),a=new Gc(Na.fromDecorations(n));for(let m=0;m<s;m++){const _=a.takeWhile(b=>b.lineNumber===m+1);r.addRequest(i[m],_,t?t[m]:null)}const l=r.finalize(),c=[],d=this.hiddenAreasDecorationIds.map(m=>this.model.getDecorationRange(m)).sort(L.compareRangesUsingStarts);let h=1,u=0,g=-1,f=g+1<d.length?u+1:s+2;for(let m=0;m<s;m++){const _=m+1;_===f&&(g++,h=d[g].startLineNumber,u=d[g].endLineNumber,f=g+1<d.length?u+1:s+2);const b=_>=h&&_<=u,v=rN(l[m],!b);c[m]=v.getViewLineCount(),this.modelLineProjections[m]=v}this._validModelVersionId=this.model.getVersionId(),this.projectedModelLineLineCounts=new Xie(c)}getHiddenAreas(){return this.hiddenAreasDecorationIds.map(e=>this.model.getDecorationRange(e))}setHiddenAreas(e){const t=e.map(u=>this.model.validateRange(u)),i=W_e(t),n=this.hiddenAreasDecorationIds.map(u=>this.model.getDecorationRange(u)).sort(L.compareRangesUsingStarts);if(i.length===n.length){let u=!1;for(let g=0;g<i.length;g++)if(!i[g].equalsRange(n[g])){u=!0;break}if(!u)return!1}const s=i.map(u=>({range:u,options:Fe.EMPTY}));this.hiddenAreasDecorationIds=this.model.deltaDecorations(this.hiddenAreasDecorationIds,s);const r=i;let a=1,l=0,c=-1,d=c+1<r.length?l+1:this.modelLineProjections.length+2,h=!1;for(let u=0;u<this.modelLineProjections.length;u++){const g=u+1;g===d&&(c++,a=r[c].startLineNumber,l=r[c].endLineNumber,d=c+1<r.length?l+1:this.modelLineProjections.length+2);let f=!1;if(g>=a&&g<=l?this.modelLineProjections[u].isVisible()&&(this.modelLineProjections[u]=this.modelLineProjections[u].setVisible(!1),f=!0):(h=!0,this.modelLineProjections[u].isVisible()||(this.modelLineProjections[u]=this.modelLineProjections[u].setVisible(!0),f=!0)),f){const m=this.modelLineProjections[u].getViewLineCount();this.projectedModelLineLineCounts.setValue(u,m)}}return h||this.setHiddenAreas([]),!0}modelPositionIsVisible(e,t){return e<1||e>this.modelLineProjections.length?!1:this.modelLineProjections[e-1].isVisible()}getModelLineViewLineCount(e){return e<1||e>this.modelLineProjections.length?1:this.modelLineProjections[e-1].getViewLineCount()}setTabSize(e){return this.tabSize===e?!1:(this.tabSize=e,this._constructLines(!1,null),!0)}setWrappingSettings(e,t,i,n,s){const r=this.fontInfo.equals(e),a=this.wrappingStrategy===t,l=this.wrappingColumn===i,c=this.wrappingIndent===n,d=this.wordBreak===s;if(r&&a&&l&&c&&d)return!1;const h=r&&a&&!l&&c&&d;this.fontInfo=e,this.wrappingStrategy=t,this.wrappingColumn=i,this.wrappingIndent=n,this.wordBreak=s;let u=null;if(h){u=[];for(let g=0,f=this.modelLineProjections.length;g<f;g++)u[g]=this.modelLineProjections[g].getProjectionData()}return this._constructLines(!1,u),!0}createLineBreaksComputer(){return(this.wrappingStrategy==="advanced"?this._domLineBreaksComputerFactory:this._monospaceLineBreaksComputerFactory).createLineBreaksComputer(this.fontInfo,this.tabSize,this.wrappingColumn,this.wrappingIndent,this.wordBreak)}onModelFlushed(){this._constructLines(!0,null)}onModelLinesDeleted(e,t,i){if(!e||e<=this._validModelVersionId)return null;const n=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,s=this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections.splice(t-1,i-t+1),this.projectedModelLineLineCounts.removeValues(t-1,i-t+1),new rO(n,s)}onModelLinesInserted(e,t,i,n){if(!e||e<=this._validModelVersionId)return null;const s=t>2&&!this.modelLineProjections[t-2].isVisible(),r=t===1?1:this.projectedModelLineLineCounts.getPrefixSum(t-1)+1;let a=0;const l=[],c=[];for(let d=0,h=n.length;d<h;d++){const u=rN(n[d],!s);l.push(u);const g=u.getViewLineCount();a+=g,c[d]=g}return this.modelLineProjections=this.modelLineProjections.slice(0,t-1).concat(l).concat(this.modelLineProjections.slice(t-1)),this.projectedModelLineLineCounts.insertValues(t-1,c),new aO(r,r+a-1)}onModelLineChanged(e,t,i){if(e!==null&&e<=this._validModelVersionId)return[!1,null,null,null];const n=t-1,s=this.modelLineProjections[n].getViewLineCount(),r=this.modelLineProjections[n].isVisible(),a=rN(i,r);this.modelLineProjections[n]=a;const l=this.modelLineProjections[n].getViewLineCount();let c=!1,d=0,h=-1,u=0,g=-1,f=0,m=-1;s>l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+l-1,f=h+1,m=f+(s-l)-1,c=!0):s<l?(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+s-1,u=h+1,g=u+(l-s)-1,c=!0):(d=this.projectedModelLineLineCounts.getPrefixSum(t-1)+1,h=d+l-1),this.projectedModelLineLineCounts.setValue(n,l);const _=d<=h?new nj(d,h-d+1):null,b=u<=g?new aO(u,g):null,v=f<=m?new rO(f,m):null;return[c,_,b,v]}acceptVersionId(e){this._validModelVersionId=e,this.modelLineProjections.length===1&&!this.modelLineProjections[0].isVisible()&&this.setHiddenAreas([])}getViewLineCount(){return this.projectedModelLineLineCounts.getTotalSum()}_toValidViewLineNumber(e){if(e<1)return 1;const t=this.getViewLineCount();return e>t?t:e|0}getActiveIndentGuide(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t),i=this._toValidViewLineNumber(i);const n=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),s=this.convertViewPositionToModelPosition(t,this.getViewLineMinColumn(t)),r=this.convertViewPositionToModelPosition(i,this.getViewLineMinColumn(i)),a=this.model.guides.getActiveIndentGuide(n.lineNumber,s.lineNumber,r.lineNumber),l=this.convertModelPositionToViewPosition(a.startLineNumber,1),c=this.convertModelPositionToViewPosition(a.endLineNumber,this.model.getLineMaxColumn(a.endLineNumber));return{startLineNumber:l.lineNumber,endLineNumber:c.lineNumber,indent:a.indent}}getViewLineInfo(e){e=this._toValidViewLineNumber(e);const t=this.projectedModelLineLineCounts.getIndexOf(e-1),i=t.index,n=t.remainder;return new w9(i+1,n)}getMinColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getMaxColumnOfViewLine(e){return this.modelLineProjections[e.modelLineNumber-1].getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx)}getModelStartPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMinColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new A(e.modelLineNumber,n)}getModelEndPositionOfViewLine(e){const t=this.modelLineProjections[e.modelLineNumber-1],i=t.getViewLineMaxColumn(this.model,e.modelLineNumber,e.modelLineWrappedLineIdx),n=t.getModelColumnOfViewPosition(e.modelLineWrappedLineIdx,i);return new A(e.modelLineNumber,n)}getViewLineInfosGroupedByModelRanges(e,t){const i=this.getViewLineInfo(e),n=this.getViewLineInfo(t),s=new Array;let r=this.getModelStartPositionOfViewLine(i),a=new Array;for(let l=i.modelLineNumber;l<=n.modelLineNumber;l++){const c=this.modelLineProjections[l-1];if(c.isVisible()){const d=l===i.modelLineNumber?i.modelLineWrappedLineIdx:0,h=l===n.modelLineNumber?n.modelLineWrappedLineIdx+1:c.getViewLineCount();for(let u=d;u<h;u++)a.push(new w9(l,u))}if(!c.isVisible()&&r){const d=new A(l-1,this.model.getLineMaxColumn(l-1)+1),h=L.fromPositions(r,d);s.push(new S9(h,a)),a=[],r=null}else c.isVisible()&&!r&&(r=new A(l,1))}if(r){const l=L.fromPositions(r,this.getModelEndPositionOfViewLine(n));s.push(new S9(l,a))}return s}getViewLinesBracketGuides(e,t,i,n){const s=i?this.convertViewPositionToModelPosition(i.lineNumber,i.column):null,r=[];for(const a of this.getViewLineInfosGroupedByModelRanges(e,t)){const l=a.modelRange.startLineNumber,c=this.model.guides.getLinesBracketGuides(l,a.modelRange.endLineNumber,s,n);for(const d of a.viewLines){const u=c[d.modelLineNumber-l].map(g=>{if(g.forWrappedLinesAfterColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.forWrappedLinesAfterColumn).lineNumber>=d.modelLineWrappedLineIdx||g.forWrappedLinesBeforeOrAtColumn!==-1&&this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.forWrappedLinesBeforeOrAtColumn).lineNumber<d.modelLineWrappedLineIdx)return;if(!g.horizontalLine)return g;let f=-1;if(g.column!==-1){const b=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.column);if(b.lineNumber===d.modelLineWrappedLineIdx)f=b.column;else if(b.lineNumber<d.modelLineWrappedLineIdx)f=this.getMinColumnOfViewLine(d);else if(b.lineNumber>d.modelLineWrappedLineIdx)return}const m=this.convertModelPositionToViewPosition(d.modelLineNumber,g.horizontalLine.endColumn),_=this.modelLineProjections[d.modelLineNumber-1].getViewPositionOfModelPosition(0,g.horizontalLine.endColumn);return _.lineNumber===d.modelLineWrappedLineIdx?new eg(g.visibleColumn,f,g.className,new Uv(g.horizontalLine.top,m.column),-1,-1):_.lineNumber<d.modelLineWrappedLineIdx||g.visibleColumn!==-1?void 0:new eg(g.visibleColumn,f,g.className,new Uv(g.horizontalLine.top,this.getMaxColumnOfViewLine(d)),-1,-1)});r.push(u.filter(g=>!!g))}}return r}getViewLinesIndentGuides(e,t){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const i=this.convertViewPositionToModelPosition(e,this.getViewLineMinColumn(e)),n=this.convertViewPositionToModelPosition(t,this.getViewLineMaxColumn(t));let s=[];const r=[],a=[],l=i.lineNumber-1,c=n.lineNumber-1;let d=null;for(let f=l;f<=c;f++){const m=this.modelLineProjections[f];if(m.isVisible()){const _=m.getViewLineNumberOfModelPosition(0,f===l?i.column:1),b=m.getViewLineNumberOfModelPosition(0,this.model.getLineMaxColumn(f+1)),v=b-_+1;let y=0;v>1&&m.getViewLineMinColumn(this.model,f+1,b)===1&&(y=_===0?1:2),r.push(v),a.push(y),d===null&&(d=new A(f+1,0))}else d!==null&&(s=s.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,f)),d=null)}d!==null&&(s=s.concat(this.model.guides.getLinesIndentGuides(d.lineNumber,n.lineNumber)),d=null);const h=t-e+1,u=new Array(h);let g=0;for(let f=0,m=s.length;f<m;f++){let _=s[f];const b=Math.min(h-g,r[f]),v=a[f];let y;v===2?y=0:v===1?y=1:y=b;for(let C=0;C<b;C++)C===y&&(_=0),u[g++]=_}return u}getViewLineContent(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineContent(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineLength(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineLength(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMinColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMinColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineMaxColumn(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineMaxColumn(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLineData(e){const t=this.getViewLineInfo(e);return this.modelLineProjections[t.modelLineNumber-1].getViewLineData(this.model,t.modelLineNumber,t.modelLineWrappedLineIdx)}getViewLinesData(e,t,i){e=this._toValidViewLineNumber(e),t=this._toValidViewLineNumber(t);const n=this.projectedModelLineLineCounts.getIndexOf(e-1);let s=e;const r=n.index,a=n.remainder,l=[];for(let c=r,d=this.model.getLineCount();c<d;c++){const h=this.modelLineProjections[c];if(!h.isVisible())continue;const u=c===r?a:0;let g=h.getViewLineCount()-u,f=!1;if(s+g>t&&(f=!0,g=t-s+1),h.getViewLinesData(this.model,c+1,u,g,s-e,i,l),s+=g,f)break}return l}validateViewPosition(e,t,i){e=this._toValidViewLineNumber(e);const n=this.projectedModelLineLineCounts.getIndexOf(e-1),s=n.index,r=n.remainder,a=this.modelLineProjections[s],l=a.getViewLineMinColumn(this.model,s+1,r),c=a.getViewLineMaxColumn(this.model,s+1,r);t<l&&(t=l),t>c&&(t=c);const d=a.getModelColumnOfViewPosition(r,t);return this.model.validatePosition(new A(s+1,d)).equals(i)?new A(e,t):this.convertModelPositionToViewPosition(i.lineNumber,i.column)}validateViewRange(e,t){const i=this.validateViewPosition(e.startLineNumber,e.startColumn,t.getStartPosition()),n=this.validateViewPosition(e.endLineNumber,e.endColumn,t.getEndPosition());return new L(i.lineNumber,i.column,n.lineNumber,n.column)}convertViewPositionToModelPosition(e,t){const i=this.getViewLineInfo(e),n=this.modelLineProjections[i.modelLineNumber-1].getModelColumnOfViewPosition(i.modelLineWrappedLineIdx,t);return this.model.validatePosition(new A(i.modelLineNumber,n))}convertViewRangeToModelRange(e){const t=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),i=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);return new L(t.lineNumber,t.column,i.lineNumber,i.column)}convertModelPositionToViewPosition(e,t,i=2,n=!1,s=!1){const r=this.model.validatePosition(new A(e,t)),a=r.lineNumber,l=r.column;let c=a-1,d=!1;if(s)for(;c<this.modelLineProjections.length&&!this.modelLineProjections[c].isVisible();)c++,d=!0;else for(;c>0&&!this.modelLineProjections[c].isVisible();)c--,d=!0;if(c===0&&!this.modelLineProjections[c].isVisible())return new A(n?0:1,1);const h=1+this.projectedModelLineLineCounts.getPrefixSum(c);let u;return d?s?u=this.modelLineProjections[c].getViewPositionOfModelPosition(h,1,i):u=this.modelLineProjections[c].getViewPositionOfModelPosition(h,this.model.getLineMaxColumn(c+1),i):u=this.modelLineProjections[a-1].getViewPositionOfModelPosition(h,l,i),u}convertModelRangeToViewRange(e,t=0){if(e.isEmpty()){const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,t);return L.fromPositions(i)}else{const i=this.convertModelPositionToViewPosition(e.startLineNumber,e.startColumn,1),n=this.convertModelPositionToViewPosition(e.endLineNumber,e.endColumn,0);return new L(i.lineNumber,i.column,n.lineNumber,n.column)}}getViewLineNumberOfModelPosition(e,t){let i=e-1;if(this.modelLineProjections[i].isVisible()){const s=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(s,t)}for(;i>0&&!this.modelLineProjections[i].isVisible();)i--;if(i===0&&!this.modelLineProjections[i].isVisible())return 1;const n=1+this.projectedModelLineLineCounts.getPrefixSum(i);return this.modelLineProjections[i].getViewLineNumberOfModelPosition(n,this.model.getLineMaxColumn(i+1))}getDecorationsInRange(e,t,i,n,s){const r=this.convertViewPositionToModelPosition(e.startLineNumber,e.startColumn),a=this.convertViewPositionToModelPosition(e.endLineNumber,e.endColumn);if(a.lineNumber-r.lineNumber<=e.endLineNumber-e.startLineNumber)return this.model.getDecorationsInRange(new L(r.lineNumber,1,a.lineNumber,a.column),t,i,n,s);let l=[];const c=r.lineNumber-1,d=a.lineNumber-1;let h=null;for(let m=c;m<=d;m++)if(this.modelLineProjections[m].isVisible())h===null&&(h=new A(m+1,m===c?r.column:1));else if(h!==null){const b=this.model.getLineMaxColumn(m);l=l.concat(this.model.getDecorationsInRange(new L(h.lineNumber,h.column,m,b),t,i,n)),h=null}h!==null&&(l=l.concat(this.model.getDecorationsInRange(new L(h.lineNumber,h.column,a.lineNumber,a.column),t,i,n)),h=null),l.sort((m,_)=>{const b=L.compareRangesUsingStarts(m.range,_.range);return b===0?m.id<_.id?-1:m.id>_.id?1:0:b});const u=[];let g=0,f=null;for(const m of l){const _=m.id;f!==_&&(f=_,u[g++]=m)}return u}getInjectedTextAt(e){const t=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[t.modelLineNumber-1].getInjectedTextAt(t.modelLineWrappedLineIdx,e.column)}normalizePosition(e,t){const i=this.getViewLineInfo(e.lineNumber);return this.modelLineProjections[i.modelLineNumber-1].normalizePosition(i.modelLineWrappedLineIdx,e,t)}getLineIndentColumn(e){const t=this.getViewLineInfo(e);return t.modelLineWrappedLineIdx===0?this.model.getLineIndentColumn(t.modelLineNumber):0}}function W_e(o){if(o.length===0)return[];const e=o.slice();e.sort(L.compareRangesUsingStarts);const t=[];let i=e[0].startLineNumber,n=e[0].endLineNumber;for(let s=1,r=e.length;s<r;s++){const a=e[s];a.startLineNumber>n+1?(t.push(new L(i,1,n,1)),i=a.startLineNumber,n=a.endLineNumber):a.endLineNumber>n&&(n=a.endLineNumber)}return t.push(new L(i,1,n,1)),t}class w9{constructor(e,t){this.modelLineNumber=e,this.modelLineWrappedLineIdx=t}}class S9{constructor(e,t){this.modelRange=e,this.viewLines=t}}class V_e{constructor(e){this._lines=e}convertViewPositionToModelPosition(e){return this._lines.convertViewPositionToModelPosition(e.lineNumber,e.column)}convertViewRangeToModelRange(e){return this._lines.convertViewRangeToModelRange(e)}validateViewPosition(e,t){return this._lines.validateViewPosition(e.lineNumber,e.column,t)}validateViewRange(e,t){return this._lines.validateViewRange(e,t)}convertModelPositionToViewPosition(e,t,i,n){return this._lines.convertModelPositionToViewPosition(e.lineNumber,e.column,t,i,n)}convertModelRangeToViewRange(e,t){return this._lines.convertModelRangeToViewRange(e,t)}modelPositionIsVisible(e){return this._lines.modelPositionIsVisible(e.lineNumber,e.column)}getModelLineViewLineCount(e){return this._lines.getModelLineViewLineCount(e)}getViewLineNumberOfModelPosition(e,t){return this._lines.getViewLineNumberOfModelPosition(e,t)}}class H_e{constructor(e){this.model=e}dispose(){}createCoordinatesConverter(){return new z_e(this)}getHiddenAreas(){return[]}setHiddenAreas(e){return!1}setTabSize(e){return!1}setWrappingSettings(e,t,i,n){return!1}createLineBreaksComputer(){const e=[];return{addRequest:(t,i,n)=>{e.push(null)},finalize:()=>e}}onModelFlushed(){}onModelLinesDeleted(e,t,i){return new rO(t,i)}onModelLinesInserted(e,t,i,n){return new aO(t,i)}onModelLineChanged(e,t,i){return[!1,new nj(t,1),null,null]}acceptVersionId(e){}getViewLineCount(){return this.model.getLineCount()}getActiveIndentGuide(e,t,i){return{startLineNumber:e,endLineNumber:e,indent:0}}getViewLinesBracketGuides(e,t,i){return new Array(t-e+1).fill([])}getViewLinesIndentGuides(e,t){const i=t-e+1,n=new Array(i);for(let s=0;s<i;s++)n[s]=0;return n}getViewLineContent(e){return this.model.getLineContent(e)}getViewLineLength(e){return this.model.getLineLength(e)}getViewLineMinColumn(e){return this.model.getLineMinColumn(e)}getViewLineMaxColumn(e){return this.model.getLineMaxColumn(e)}getViewLineData(e){const t=this.model.tokenization.getLineTokens(e),i=t.getLineContent();return new CB(i,!1,1,i.length+1,0,t.inflate(),null)}getViewLinesData(e,t,i){const n=this.model.getLineCount();e=Math.min(Math.max(1,e),n),t=Math.min(Math.max(1,t),n);const s=[];for(let r=e;r<=t;r++){const a=r-e;s[a]=i[a]?this.getViewLineData(r):null}return s}getDecorationsInRange(e,t,i,n,s){return this.model.getDecorationsInRange(e,t,i,n,s)}normalizePosition(e,t){return this.model.normalizePosition(e,t)}getLineIndentColumn(e){return this.model.getLineIndentColumn(e)}getInjectedTextAt(e){return null}}class z_e{constructor(e){this._lines=e}_validPosition(e){return this._lines.model.validatePosition(e)}_validRange(e){return this._lines.model.validateRange(e)}convertViewPositionToModelPosition(e){return this._validPosition(e)}convertViewRangeToModelRange(e){return this._validRange(e)}validateViewPosition(e,t){return this._validPosition(t)}validateViewRange(e,t){return this._validRange(t)}convertModelPositionToViewPosition(e){return this._validPosition(e)}convertModelRangeToViewRange(e){return this._validRange(e)}modelPositionIsVisible(e){const t=this._lines.model.getLineCount();return!(e.lineNumber<1||e.lineNumber>t)}getModelLineViewLineCount(e){return 1}getViewLineNumberOfModelPosition(e,t){return e}}const pu=Ur.Right;class U_e{constructor(e){this.persist=0,this._requiredLanes=1,this.lanes=new Uint8Array(Math.ceil((e+1)*pu/8))}reset(e){const t=Math.ceil((e+1)*pu/8);this.lanes.length<t?this.lanes=new Uint8Array(t):this.lanes.fill(0),this._requiredLanes=1}get requiredLanes(){return this._requiredLanes}push(e,t,i){i&&(this.persist|=1<<e-1);for(let n=t.startLineNumber;n<=t.endLineNumber;n++){const s=pu*n+(e-1);this.lanes[s>>>3]|=1<<s%8,this._requiredLanes=Math.max(this._requiredLanes,this.countAtLine(n))}}getLanesAtLine(e){const t=[];let i=pu*e;for(let n=0;n<pu;n++)(this.persist&1<<n||this.lanes[i>>>3]&1<<i%8)&&t.push(n+1),i++;return t.length?t:[Ur.Center]}countAtLine(e){let t=pu*e,i=0;for(let n=0;n<pu;n++)(this.persist&1<<n||this.lanes[t>>>3]&1<<t%8)&&i++,t++;return i}}let G_e=class extends F{constructor(e,t,i,n,s,r,a,l,c,d){if(super(),this.languageConfigurationService=a,this._themeService=l,this._attachedView=c,this._transactionalTarget=d,this.hiddenAreasModel=new K_e,this.previousHiddenAreas=[],this._editorId=e,this._configuration=t,this.model=i,this._eventDispatcher=new p_e,this.onEvent=this._eventDispatcher.onEvent,this.cursorConfig=new yp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._updateConfigurationViewLineCount=this._register(new xt(()=>this._updateConfigurationViewLineCountNow(),0)),this._hasFocus=!1,this._viewportStart=zB.create(this.model),this.glyphLanes=new U_e(0),this.model.isTooLargeForTokenization())this._lines=new H_e(this.model);else{const h=this._configuration.options,u=h.get(50),g=h.get(140),f=h.get(147),m=h.get(139),_=h.get(130);this._lines=new B_e(this._editorId,this.model,n,s,u,this.model.getOptions().tabSize,g,f.wrappingColumn,m,_)}this.coordinatesConverter=this._lines.createCoordinatesConverter(),this._cursor=this._register(new k_e(i,this,this.coordinatesConverter,this.cursorConfig)),this.viewLayout=this._register(new A_e(this._configuration,this.getLineCount(),r)),this._register(this.viewLayout.onDidScroll(h=>{h.scrollTopChanged&&this._handleVisibleLinesChanged(),h.scrollTopChanged&&this._viewportStart.invalidate(),this._eventDispatcher.emitSingleViewEvent(new d_e(h)),this._eventDispatcher.emitOutgoingEvent(new BB(h.oldScrollWidth,h.oldScrollLeft,h.oldScrollHeight,h.oldScrollTop,h.scrollWidth,h.scrollLeft,h.scrollHeight,h.scrollTop))})),this._register(this.viewLayout.onDidContentSizeChange(h=>{this._eventDispatcher.emitOutgoingEvent(h)})),this._decorations=new M_e(this._editorId,this.model,this._configuration,this._lines,this.coordinatesConverter),this._registerModelEvents(),this._register(this._configuration.onDidChangeFast(h=>{try{const u=this._eventDispatcher.beginEmitViewEvents();this._onConfigurationChanged(u,h)}finally{this._eventDispatcher.endEmitViewEvents()}})),this._register(Jx.getInstance().onDidChange(()=>{this._eventDispatcher.emitSingleViewEvent(new g_e)})),this._register(this._themeService.onDidColorThemeChange(h=>{this._invalidateDecorationsColorCache(),this._eventDispatcher.emitSingleViewEvent(new h_e(h))})),this._updateConfigurationViewLineCountNow()}dispose(){super.dispose(),this._decorations.dispose(),this._lines.dispose(),this._viewportStart.dispose(),this._eventDispatcher.dispose()}createLineBreaksComputer(){return this._lines.createLineBreaksComputer()}addViewEventHandler(e){this._eventDispatcher.addViewEventHandler(e)}removeViewEventHandler(e){this._eventDispatcher.removeViewEventHandler(e)}_updateConfigurationViewLineCountNow(){this._configuration.setViewLineCount(this._lines.getViewLineCount())}getModelVisibleRanges(){const e=this.viewLayout.getLinesViewportData(),t=new L(e.startLineNumber,this.getLineMinColumn(e.startLineNumber),e.endLineNumber,this.getLineMaxColumn(e.endLineNumber));return this._toModelVisibleRanges(t)}visibleLinesStabilized(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!0)}_handleVisibleLinesChanged(){const e=this.getModelVisibleRanges();this._attachedView.setVisibleLines(e,!1)}setHasFocus(e){this._hasFocus=e,this._cursor.setHasFocus(e),this._eventDispatcher.emitSingleViewEvent(new l_e(e)),this._eventDispatcher.emitOutgoingEvent(new FB(!e,e))}onCompositionStart(){this._eventDispatcher.emitSingleViewEvent(new s_e)}onCompositionEnd(){this._eventDispatcher.emitSingleViewEvent(new o_e)}_captureStableViewport(){if(this._viewportStart.isValid&&this.viewLayout.getCurrentScrollTop()>0){const e=new A(this._viewportStart.viewLineNumber,this.getLineMinColumn(this._viewportStart.viewLineNumber)),t=this.coordinatesConverter.convertViewPositionToModelPosition(e);return new L9(t,this._viewportStart.startLineDelta)}return new L9(null,0)}_onConfigurationChanged(e,t){const i=this._captureStableViewport(),n=this._configuration.options,s=n.get(50),r=n.get(140),a=n.get(147),l=n.get(139),c=n.get(130);this._lines.setWrappingSettings(s,r,a.wrappingColumn,l,c)&&(e.emitViewEvent(new QS),e.emitViewEvent(new JS),e.emitViewEvent(new fu(null)),this._cursor.onLineMappingChanged(e),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this._updateConfigurationViewLineCount.schedule()),t.hasChanged(92)&&(this._decorations.reset(),e.emitViewEvent(new fu(null))),t.hasChanged(99)&&(this._decorations.reset(),e.emitViewEvent(new fu(null))),e.emitViewEvent(new r_e(t)),this.viewLayout.onConfigurationChanged(t),i.recoverViewportStart(this.coordinatesConverter,this.viewLayout),yp.shouldRecreate(t)&&(this.cursorConfig=new yp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig))}_registerModelEvents(){this._register(this.model.onDidChangeContentOrInjectedText(e=>{try{const i=this._eventDispatcher.beginEmitViewEvents();let n=!1,s=!1;const r=e instanceof hg?e.rawContentChangedEvent.changes:e.changes,a=e instanceof hg?e.rawContentChangedEvent.versionId:null,l=this._lines.createLineBreaksComputer();for(const h of r)switch(h.changeType){case 4:{for(let u=0;u<h.detail.length;u++){const g=h.detail[u];let f=h.injectedTexts[u];f&&(f=f.filter(m=>!m.ownerId||m.ownerId===this._editorId)),l.addRequest(g,f,null)}break}case 2:{let u=null;h.injectedText&&(u=h.injectedText.filter(g=>!g.ownerId||g.ownerId===this._editorId)),l.addRequest(h.detail,u,null);break}}const c=l.finalize(),d=new Gc(c);for(const h of r)switch(h.changeType){case 1:{this._lines.onModelFlushed(),i.emitViewEvent(new QS),this._decorations.reset(),this.viewLayout.onFlushed(this.getLineCount()),n=!0;break}case 3:{const u=this._lines.onModelLinesDeleted(a,h.fromLineNumber,h.toLineNumber);u!==null&&(i.emitViewEvent(u),this.viewLayout.onLinesDeleted(u.fromLineNumber,u.toLineNumber)),n=!0;break}case 4:{const u=d.takeCount(h.detail.length),g=this._lines.onModelLinesInserted(a,h.fromLineNumber,h.toLineNumber,u);g!==null&&(i.emitViewEvent(g),this.viewLayout.onLinesInserted(g.fromLineNumber,g.toLineNumber)),n=!0;break}case 2:{const u=d.dequeue(),[g,f,m,_]=this._lines.onModelLineChanged(a,h.lineNumber,u);s=g,f&&i.emitViewEvent(f),m&&(i.emitViewEvent(m),this.viewLayout.onLinesInserted(m.fromLineNumber,m.toLineNumber)),_&&(i.emitViewEvent(_),this.viewLayout.onLinesDeleted(_.fromLineNumber,_.toLineNumber));break}case 5:break}a!==null&&this._lines.acceptVersionId(a),this.viewLayout.onHeightMaybeChanged(),!n&&s&&(i.emitViewEvent(new JS),i.emitViewEvent(new fu(null)),this._cursor.onLineMappingChanged(i),this._decorations.onLineMappingChanged())}finally{this._eventDispatcher.endEmitViewEvents()}const t=this._viewportStart.isValid;if(this._viewportStart.invalidate(),this._configuration.setModelLineCount(this.model.getLineCount()),this._updateConfigurationViewLineCountNow(),!this._hasFocus&&this.model.getAttachedEditorCount()>=2&&t){const i=this.model._getTrackedRange(this._viewportStart.modelTrackedRange);if(i){const n=this.coordinatesConverter.convertModelPositionToViewPosition(i.getStartPosition()),s=this.viewLayout.getVerticalOffsetForLineNumber(n.lineNumber);this.viewLayout.setScrollPosition({scrollTop:s+this._viewportStart.startLineDelta},1)}}try{const i=this._eventDispatcher.beginEmitViewEvents();e instanceof hg&&i.emitOutgoingEvent(new S_e(e.contentChangedEvent)),this._cursor.onModelContentChanged(i,e)}finally{this._eventDispatcher.endEmitViewEvents()}this._handleVisibleLinesChanged()})),this._register(this.model.onDidChangeTokens(e=>{const t=[];for(let i=0,n=e.ranges.length;i<n;i++){const s=e.ranges[i],r=this.coordinatesConverter.convertModelPositionToViewPosition(new A(s.fromLineNumber,1)).lineNumber,a=this.coordinatesConverter.convertModelPositionToViewPosition(new A(s.toLineNumber,this.model.getLineMaxColumn(s.toLineNumber))).lineNumber;t[i]={fromLineNumber:r,toLineNumber:a}}this._eventDispatcher.emitSingleViewEvent(new u_e(t)),this._eventDispatcher.emitOutgoingEvent(new L_e(e))})),this._register(this.model.onDidChangeLanguageConfiguration(e=>{this._eventDispatcher.emitSingleViewEvent(new c_e),this.cursorConfig=new yp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new w_e(e))})),this._register(this.model.onDidChangeLanguage(e=>{this.cursorConfig=new yp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new y_e(e))})),this._register(this.model.onDidChangeOptions(e=>{if(this._lines.setTabSize(this.model.getOptions().tabSize)){try{const t=this._eventDispatcher.beginEmitViewEvents();t.emitViewEvent(new QS),t.emitViewEvent(new JS),t.emitViewEvent(new fu(null)),this._cursor.onLineMappingChanged(t),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount())}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule()}this.cursorConfig=new yp(this.model.getLanguageId(),this.model.getOptions(),this._configuration,this.languageConfigurationService),this._cursor.updateConfiguration(this.cursorConfig),this._eventDispatcher.emitOutgoingEvent(new x_e(e))})),this._register(this.model.onDidChangeDecorations(e=>{this._decorations.onModelDecorationsChanged(),this._eventDispatcher.emitSingleViewEvent(new fu(e)),this._eventDispatcher.emitOutgoingEvent(new C_e(e))}))}setHiddenAreas(e,t){this.hiddenAreasModel.setHiddenAreas(t,e);const i=this.hiddenAreasModel.getMergedRanges();if(i===this.previousHiddenAreas)return;this.previousHiddenAreas=i;const n=this._captureStableViewport();let s=!1;try{const r=this._eventDispatcher.beginEmitViewEvents();s=this._lines.setHiddenAreas(i),s&&(r.emitViewEvent(new QS),r.emitViewEvent(new JS),r.emitViewEvent(new fu(null)),this._cursor.onLineMappingChanged(r),this._decorations.onLineMappingChanged(),this.viewLayout.onFlushed(this.getLineCount()),this.viewLayout.onHeightMaybeChanged());const a=n.viewportStartModelPosition?.lineNumber;a&&i.some(c=>c.startLineNumber<=a&&a<=c.endLineNumber)||n.recoverViewportStart(this.coordinatesConverter,this.viewLayout)}finally{this._eventDispatcher.endEmitViewEvents()}this._updateConfigurationViewLineCount.schedule(),s&&this._eventDispatcher.emitOutgoingEvent(new b_e)}getVisibleRangesPlusViewportAboveBelow(){const e=this._configuration.options.get(146),t=this._configuration.options.get(67),i=Math.max(20,Math.round(e.height/t)),n=this.viewLayout.getLinesViewportData(),s=Math.max(1,n.completelyVisibleStartLineNumber-i),r=Math.min(this.getLineCount(),n.completelyVisibleEndLineNumber+i);return this._toModelVisibleRanges(new L(s,this.getLineMinColumn(s),r,this.getLineMaxColumn(r)))}getVisibleRanges(){const e=this.getCompletelyVisibleViewRange();return this._toModelVisibleRanges(e)}getHiddenAreas(){return this._lines.getHiddenAreas()}_toModelVisibleRanges(e){const t=this.coordinatesConverter.convertViewRangeToModelRange(e),i=this._lines.getHiddenAreas();if(i.length===0)return[t];const n=[];let s=0,r=t.startLineNumber,a=t.startColumn;const l=t.endLineNumber,c=t.endColumn;for(let d=0,h=i.length;d<h;d++){const u=i[d].startLineNumber,g=i[d].endLineNumber;g<r||u>l||(r<u&&(n[s++]=new L(r,a,u-1,this.model.getLineMaxColumn(u-1))),r=g+1,a=1)}return(r<l||r===l&&a<c)&&(n[s++]=new L(r,a,l,c)),n}getCompletelyVisibleViewRange(){const e=this.viewLayout.getLinesViewportData(),t=e.completelyVisibleStartLineNumber,i=e.completelyVisibleEndLineNumber;return new L(t,this.getLineMinColumn(t),i,this.getLineMaxColumn(i))}getCompletelyVisibleViewRangeAtScrollTop(e){const t=this.viewLayout.getLinesViewportDataAtScrollTop(e),i=t.completelyVisibleStartLineNumber,n=t.completelyVisibleEndLineNumber;return new L(i,this.getLineMinColumn(i),n,this.getLineMaxColumn(n))}saveState(){const e=this.viewLayout.saveState(),t=e.scrollTop,i=this.viewLayout.getLineNumberAtVerticalOffset(t),n=this.coordinatesConverter.convertViewPositionToModelPosition(new A(i,this.getLineMinColumn(i))),s=this.viewLayout.getVerticalOffsetForLineNumber(i)-t;return{scrollLeft:e.scrollLeft,firstPosition:n,firstPositionDeltaTop:s}}reduceRestoreState(e){if(typeof e.firstPosition>"u")return this._reduceRestoreStateCompatibility(e);const t=this.model.validatePosition(e.firstPosition),i=this.coordinatesConverter.convertModelPositionToViewPosition(t),n=this.viewLayout.getVerticalOffsetForLineNumber(i.lineNumber)-e.firstPositionDeltaTop;return{scrollLeft:e.scrollLeft,scrollTop:n}}_reduceRestoreStateCompatibility(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTopWithoutViewZones}}getTabSize(){return this.model.getOptions().tabSize}getLineCount(){return this._lines.getViewLineCount()}setViewport(e,t,i){this._viewportStart.update(this,e)}getActiveIndentGuide(e,t,i){return this._lines.getActiveIndentGuide(e,t,i)}getLinesIndentGuides(e,t){return this._lines.getViewLinesIndentGuides(e,t)}getBracketGuidesInRangeByLine(e,t,i,n){return this._lines.getViewLinesBracketGuides(e,t,i,n)}getLineContent(e){return this._lines.getViewLineContent(e)}getLineLength(e){return this._lines.getViewLineLength(e)}getLineMinColumn(e){return this._lines.getViewLineMinColumn(e)}getLineMaxColumn(e){return this._lines.getViewLineMaxColumn(e)}getLineFirstNonWhitespaceColumn(e){const t=Xn(this.getLineContent(e));return t===-1?0:t+1}getLineLastNonWhitespaceColumn(e){const t=Sa(this.getLineContent(e));return t===-1?0:t+2}getMinimapDecorationsInRange(e){return this._decorations.getMinimapDecorationsInRange(e)}getDecorationsInViewport(e){return this._decorations.getDecorationsViewportData(e).decorations}getInjectedTextAt(e){return this._lines.getInjectedTextAt(e)}getViewportViewLineRenderingData(e,t){const n=this._decorations.getDecorationsViewportData(e).inlineDecorations[t-e.startLineNumber];return this._getViewLineRenderingData(t,n)}getViewLineRenderingData(e){const t=this._decorations.getInlineDecorationsOnLine(e);return this._getViewLineRenderingData(e,t)}_getViewLineRenderingData(e,t){const i=this.model.mightContainRTL(),n=this.model.mightContainNonBasicASCII(),s=this.getTabSize(),r=this._lines.getViewLineData(e);return r.inlineDecorations&&(t=[...t,...r.inlineDecorations.map(a=>a.toInlineDecoration(e))]),new Vo(r.minColumn,r.maxColumn,r.content,r.continuesWithWrappedLine,i,n,r.tokens,t,s,r.startVisibleColumn)}getViewLineData(e){return this._lines.getViewLineData(e)}getMinimapLinesRenderingData(e,t,i){const n=this._lines.getViewLinesData(e,t,i);return new Efe(this.getTabSize(),n)}getAllOverviewRulerDecorations(e){const t=this.model.getOverviewRulerDecorations(this._editorId,v0(this._configuration.options)),i=new $_e;for(const n of t){const s=n.options,r=s.overviewRuler;if(!r)continue;const a=r.position;if(a===0)continue;const l=r.getColor(e.value),c=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.startLineNumber,n.range.startColumn),d=this.coordinatesConverter.getViewLineNumberOfModelPosition(n.range.endLineNumber,n.range.endColumn);i.accept(l,s.zIndex,c,d,a)}return i.asArray}_invalidateDecorationsColorCache(){const e=this.model.getOverviewRulerDecorations();for(const t of e)t.options.overviewRuler?.invalidateCachedColor(),t.options.minimap?.invalidateCachedColor()}getValueInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueInRange(i,t)}getValueLengthInRange(e,t){const i=this.coordinatesConverter.convertViewRangeToModelRange(e);return this.model.getValueLengthInRange(i,t)}modifyPosition(e,t){const i=this.coordinatesConverter.convertViewPositionToModelPosition(e),n=this.model.modifyPosition(i,t);return this.coordinatesConverter.convertModelPositionToViewPosition(n)}deduceModelPositionRelativeToViewPosition(e,t,i){const n=this.coordinatesConverter.convertViewPositionToModelPosition(e);this.model.getEOL().length===2&&(t<0?t-=i:t+=i);const r=this.model.getOffsetAt(n)+t;return this.model.getPositionAt(r)}getPlainTextToCopy(e,t,i){const n=i?`\r
`:this.model.getEOL();e=e.slice(0),e.sort(L.compareRangesUsingStarts);let s=!1,r=!1;for(const l of e)l.isEmpty()?s=!0:r=!0;if(!r){if(!t)return"";const l=e.map(d=>d.startLineNumber);let c="";for(let d=0;d<l.length;d++)d>0&&l[d-1]===l[d]||(c+=this.model.getLineContent(l[d])+n);return c}if(s&&t){const l=[];let c=0;for(const d of e){const h=d.startLineNumber;d.isEmpty()?h!==c&&l.push(this.model.getLineContent(h)):l.push(this.model.getValueInRange(d,i?2:0)),c=h}return l.length===1?l[0]:l}const a=[];for(const l of e)l.isEmpty()||a.push(this.model.getValueInRange(l,i?2:0));return a.length===1?a[0]:a}getRichTextToCopy(e,t){const i=this.model.getLanguageId();if(i===hs||e.length!==1)return null;let n=e[0];if(n.isEmpty()){if(!t)return null;const d=n.startLineNumber;n=new L(d,this.model.getLineMinColumn(d),d,this.model.getLineMaxColumn(d))}const s=this._configuration.options.get(50),r=this._getColorMap(),l=/[:;\\\/<>]/.test(s.fontFamily)||s.fontFamily===ds.fontFamily;let c;return l?c=ds.fontFamily:(c=s.fontFamily,c=c.replace(/"/g,"'"),/[,']/.test(c)||/[+ ]/.test(c)&&(c=`'${c}'`),c=`${c}, ${ds.fontFamily}`),{mode:i,html:`<div style="color: ${r[1]};background-color: ${r[2]};font-family: ${c};font-weight: ${s.fontWeight};font-size: ${s.fontSize}px;line-height: ${s.lineHeight}px;white-space: pre;">`+this._getHTMLToCopy(n,r)+"</div>"}}_getHTMLToCopy(e,t){const i=e.startLineNumber,n=e.startColumn,s=e.endLineNumber,r=e.endColumn,a=this.getTabSize();let l="";for(let c=i;c<=s;c++){const d=this.model.tokenization.getLineTokens(c),h=d.getLineContent(),u=c===i?n-1:0,g=c===s?r-1:h.length;h===""?l+="<br>":l+=tae(h,d.inflate(),t,u,g,a,En)}return l}_getColorMap(){const e=gi.getColorMap(),t=["#000000"];if(e)for(let i=1,n=e.length;i<n;i++)t[i]=j.Format.CSS.formatHex(e[i]);return t}getPrimaryCursorState(){return this._cursor.getPrimaryCursorState()}getLastAddedCursorIndex(){return this._cursor.getLastAddedCursorIndex()}getCursorStates(){return this._cursor.getCursorStates()}setCursorStates(e,t,i){return this._withViewEventsCollector(n=>this._cursor.setStates(n,e,t,i))}getCursorColumnSelectData(){return this._cursor.getCursorColumnSelectData()}getCursorAutoClosedCharacters(){return this._cursor.getAutoClosedCharacters()}setCursorColumnSelectData(e){this._cursor.setCursorColumnSelectData(e)}getPrevEditOperationType(){return this._cursor.getPrevEditOperationType()}setPrevEditOperationType(e){this._cursor.setPrevEditOperationType(e)}getSelection(){return this._cursor.getSelection()}getSelections(){return this._cursor.getSelections()}getPosition(){return this._cursor.getPrimaryCursorState().modelState.position}setSelections(e,t,i=0){this._withViewEventsCollector(n=>this._cursor.setSelections(n,e,t,i))}saveCursorState(){return this._cursor.saveState()}restoreCursorState(e){this._withViewEventsCollector(t=>this._cursor.restoreState(t,e))}_executeCursorEdit(e){if(this._cursor.context.cursorConfig.readOnly){this._eventDispatcher.emitOutgoingEvent(new v_e);return}this._withViewEventsCollector(e)}executeEdits(e,t,i){this._executeCursorEdit(n=>this._cursor.executeEdits(n,e,t,i))}startComposition(){this._executeCursorEdit(e=>this._cursor.startComposition(e))}endComposition(e){this._executeCursorEdit(t=>this._cursor.endComposition(t,e))}type(e,t){this._executeCursorEdit(i=>this._cursor.type(i,e,t))}compositionType(e,t,i,n,s){this._executeCursorEdit(r=>this._cursor.compositionType(r,e,t,i,n,s))}paste(e,t,i,n){this._executeCursorEdit(s=>this._cursor.paste(s,e,t,i,n))}cut(e){this._executeCursorEdit(t=>this._cursor.cut(t,e))}executeCommand(e,t){this._executeCursorEdit(i=>this._cursor.executeCommand(i,e,t))}executeCommands(e,t){this._executeCursorEdit(i=>this._cursor.executeCommands(i,e,t))}revealAllCursors(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealAll(n,e,i,0,t,0))}revealPrimaryCursor(e,t,i=!1){this._withViewEventsCollector(n=>this._cursor.revealPrimary(n,e,i,0,t,0))}revealTopMostCursor(e){const t=this._cursor.getTopMostViewPosition(),i=new L(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new oC(e,!1,i,null,0,!0,0)))}revealBottomMostCursor(e){const t=this._cursor.getBottomMostViewPosition(),i=new L(t.lineNumber,t.column,t.lineNumber,t.column);this._withViewEventsCollector(n=>n.emitViewEvent(new oC(e,!1,i,null,0,!0,0)))}revealRange(e,t,i,n,s){this._withViewEventsCollector(r=>r.emitViewEvent(new oC(e,!1,i,null,n,t,s)))}changeWhitespace(e){this.viewLayout.changeWhitespace(e)&&(this._eventDispatcher.emitSingleViewEvent(new f_e),this._eventDispatcher.emitOutgoingEvent(new __e))}_withViewEventsCollector(e){return this._transactionalTarget.batchChanges(()=>{try{const t=this._eventDispatcher.beginEmitViewEvents();return e(t)}finally{this._eventDispatcher.endEmitViewEvents()}})}batchEvents(e){this._withViewEventsCollector(()=>{e()})}normalizePosition(e,t){return this._lines.normalizePosition(e,t)}getLineIndentColumn(e){return this._lines.getLineIndentColumn(e)}};class zB{static create(e){const t=e._setTrackedRange(null,new L(1,1,1,1),1);return new zB(e,1,!1,t,0)}get viewLineNumber(){return this._viewLineNumber}get isValid(){return this._isValid}get modelTrackedRange(){return this._modelTrackedRange}get startLineDelta(){return this._startLineDelta}constructor(e,t,i,n,s){this._model=e,this._viewLineNumber=t,this._isValid=i,this._modelTrackedRange=n,this._startLineDelta=s}dispose(){this._model._setTrackedRange(this._modelTrackedRange,null,1)}update(e,t){const i=e.coordinatesConverter.convertViewPositionToModelPosition(new A(t,e.getLineMinColumn(t))),n=e.model._setTrackedRange(this._modelTrackedRange,new L(i.lineNumber,i.column,i.lineNumber,i.column),1),s=e.viewLayout.getVerticalOffsetForLineNumber(t),r=e.viewLayout.getCurrentScrollTop();this._viewLineNumber=t,this._isValid=!0,this._modelTrackedRange=n,this._startLineDelta=r-s}invalidate(){this._isValid=!1}}class $_e{constructor(){this._asMap=Object.create(null),this.asArray=[]}accept(e,t,i,n,s){const r=this._asMap[e];if(r){const a=r.data,l=a[a.length-3],c=a[a.length-1];if(l===s&&c+1>=i){n>c&&(a[a.length-1]=n);return}a.push(s,i,n)}else{const a=new Dy(e,t,[s,i,n]);this._asMap[e]=a,this.asArray.push(a)}}}class K_e{constructor(){this.hiddenAreas=new Map,this.shouldRecompute=!1,this.ranges=[]}setHiddenAreas(e,t){const i=this.hiddenAreas.get(e);i&&x9(i,t)||(this.hiddenAreas.set(e,t),this.shouldRecompute=!0)}getMergedRanges(){if(!this.shouldRecompute)return this.ranges;this.shouldRecompute=!1;const e=Array.from(this.hiddenAreas.values()).reduce((t,i)=>j_e(t,i),[]);return x9(this.ranges,e)?this.ranges:(this.ranges=e,this.ranges)}}function j_e(o,e){const t=[];let i=0,n=0;for(;i<o.length&&n<e.length;){const s=o[i],r=e[n];if(s.endLineNumber<r.startLineNumber-1)t.push(o[i++]);else if(r.endLineNumber<s.startLineNumber-1)t.push(e[n++]);else{const a=Math.min(s.startLineNumber,r.startLineNumber),l=Math.max(s.endLineNumber,r.endLineNumber);t.push(new L(a,1,l,1)),i++,n++}}for(;i<o.length;)t.push(o[i++]);for(;n<e.length;)t.push(e[n++]);return t}function x9(o,e){if(o.length!==e.length)return!1;for(let t=0;t<o.length;t++)if(!o[t].equalsRange(e[t]))return!1;return!0}class L9{constructor(e,t){this.viewportStartModelPosition=e,this.startLineDelta=t}recoverViewportStart(e,t){if(!this.viewportStartModelPosition)return;const i=e.convertModelPositionToViewPosition(this.viewportStartModelPosition),n=t.getVerticalOffsetForLineNumber(i.lineNumber);t.setScrollPosition({scrollTop:n+this.startLineDelta},1)}}var q_e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Xl=function(o,e){return function(t,i){e(t,i,o)}},Eu,xg;let By=(xg=class extends F{get isSimpleWidget(){return this._configuration.isSimpleWidget}get contextMenuId(){return this._configuration.contextMenuId}constructor(e,t,i,n,s,r,a,l,c,d,h,u){super(),this.languageConfigurationService=h,this._deliveryQueue=eQ(),this._contributions=this._register(new e_e),this._onDidDispose=this._register(new O),this.onDidDispose=this._onDidDispose.event,this._onDidChangeModelContent=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelContent=this._onDidChangeModelContent.event,this._onDidChangeModelLanguage=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguage=this._onDidChangeModelLanguage.event,this._onDidChangeModelLanguageConfiguration=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelLanguageConfiguration=this._onDidChangeModelLanguageConfiguration.event,this._onDidChangeModelOptions=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelOptions=this._onDidChangeModelOptions.event,this._onDidChangeModelDecorations=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelDecorations=this._onDidChangeModelDecorations.event,this._onDidChangeModelTokens=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModelTokens=this._onDidChangeModelTokens.event,this._onDidChangeConfiguration=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeConfiguration=this._onDidChangeConfiguration.event,this._onWillChangeModel=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onWillChangeModel=this._onWillChangeModel.event,this._onDidChangeModel=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeModel=this._onDidChangeModel.event,this._onDidChangeCursorPosition=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorPosition=this._onDidChangeCursorPosition.event,this._onDidChangeCursorSelection=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeCursorSelection=this._onDidChangeCursorSelection.event,this._onDidAttemptReadOnlyEdit=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onDidAttemptReadOnlyEdit=this._onDidAttemptReadOnlyEdit.event,this._onDidLayoutChange=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidLayoutChange=this._onDidLayoutChange.event,this._editorTextFocus=this._register(new k9({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorText=this._editorTextFocus.onDidChangeToTrue,this.onDidBlurEditorText=this._editorTextFocus.onDidChangeToFalse,this._editorWidgetFocus=this._register(new k9({deliveryQueue:this._deliveryQueue})),this.onDidFocusEditorWidget=this._editorWidgetFocus.onDidChangeToTrue,this.onDidBlurEditorWidget=this._editorWidgetFocus.onDidChangeToFalse,this._onWillType=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onWillType=this._onWillType.event,this._onDidType=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onDidType=this._onDidType.event,this._onDidCompositionStart=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onDidCompositionStart=this._onDidCompositionStart.event,this._onDidCompositionEnd=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onDidCompositionEnd=this._onDidCompositionEnd.event,this._onDidPaste=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onDidPaste=this._onDidPaste.event,this._onMouseUp=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseUp=this._onMouseUp.event,this._onMouseDown=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseDown=this._onMouseDown.event,this._onMouseDrag=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseDrag=this._onMouseDrag.event,this._onMouseDrop=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseDrop=this._onMouseDrop.event,this._onMouseDropCanceled=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseDropCanceled=this._onMouseDropCanceled.event,this._onDropIntoEditor=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onDropIntoEditor=this._onDropIntoEditor.event,this._onContextMenu=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onContextMenu=this._onContextMenu.event,this._onMouseMove=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseMove=this._onMouseMove.event,this._onMouseLeave=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseLeave=this._onMouseLeave.event,this._onMouseWheel=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onMouseWheel=this._onMouseWheel.event,this._onKeyUp=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onKeyUp=this._onKeyUp.event,this._onKeyDown=this._register(new Vn(this._contributions,this._deliveryQueue)),this.onKeyDown=this._onKeyDown.event,this._onDidContentSizeChange=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidContentSizeChange=this._onDidContentSizeChange.event,this._onDidScrollChange=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidScrollChange=this._onDidScrollChange.event,this._onDidChangeViewZones=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeViewZones=this._onDidChangeViewZones.event,this._onDidChangeHiddenAreas=this._register(new O({deliveryQueue:this._deliveryQueue})),this.onDidChangeHiddenAreas=this._onDidChangeHiddenAreas.event,this._updateCounter=0,this._onBeginUpdate=this._register(new O),this.onBeginUpdate=this._onBeginUpdate.event,this._onEndUpdate=this._register(new O),this.onEndUpdate=this._onEndUpdate.event,this._actions=new Map,this._bannerDomNode=null,this._dropIntoEditorDecorations=this.createDecorationsCollection(),s.willCreateCodeEditor();const g={...t};this._domElement=e,this._overflowWidgetsDomNode=g.overflowWidgetsDomNode,delete g.overflowWidgetsDomNode,this._id=++Z_e,this._decorationTypeKeysToIds={},this._decorationTypeSubtypes={},this._telemetryData=i.telemetryData,this._configuration=this._register(this._createConfiguration(i.isSimpleWidget||!1,i.contextMenuId??(i.isSimpleWidget?fe.SimpleEditorContext:fe.EditorContext),g,d)),this._register(this._configuration.onDidChange(_=>{this._onDidChangeConfiguration.fire(_);const b=this._configuration.options;if(_.hasChanged(146)){const v=b.get(146);this._onDidLayoutChange.fire(v)}})),this._contextKeyService=this._register(a.createScoped(this._domElement)),this._notificationService=c,this._codeEditorService=s,this._commandService=r,this._themeService=l,this._register(new X_e(this,this._contextKeyService)),this._register(new Q_e(this,this._contextKeyService,u)),this._instantiationService=this._register(n.createChild(new bb([Ee,this._contextKeyService]))),this._modelData=null,this._focusTracker=new J_e(e,this._overflowWidgetsDomNode),this._register(this._focusTracker.onChange(()=>{this._editorWidgetFocus.setValue(this._focusTracker.hasFocus())})),this._contentWidgets={},this._overlayWidgets={},this._glyphMarginWidgets={};let f;Array.isArray(i.contributions)?f=i.contributions:f=lg.getEditorContributions(),this._contributions.initialize(this,f,this._instantiationService);for(const _ of lg.getEditorActions()){if(this._actions.has(_.id)){Ae(new Error(`Cannot have two actions with the same id ${_.id}`));continue}const b=new tj(_.id,_.label,_.alias,_.metadata,_.precondition??void 0,v=>this._instantiationService.invokeFunction(y=>Promise.resolve(_.runEditorCommand(y,this,v))),this._contextKeyService);this._actions.set(b.id,b)}const m=()=>!this._configuration.options.get(92)&&this._configuration.options.get(36).enabled;this._register(new hee(this._domElement,{onDragOver:_=>{if(!m())return;const b=this.getTargetAtClientPoint(_.clientX,_.clientY);b?.position&&this.showDropIndicatorAt(b.position)},onDrop:async _=>{if(!m()||(this.removeDropIndicator(),!_.dataTransfer))return;const b=this.getTargetAtClientPoint(_.clientX,_.clientY);b?.position&&this._onDropIntoEditor.fire({position:b.position,event:_})},onDragLeave:()=>{this.removeDropIndicator()},onDragEnd:()=>{this.removeDropIndicator()}})),this._codeEditorService.addCodeEditor(this)}writeScreenReaderContent(e){this._modelData?.view.writeScreenReaderContent(e)}_createConfiguration(e,t,i,n){return new VM(e,t,i,this._domElement,n)}getId(){return this.getEditorType()+":"+this._id}getEditorType(){return Gw.ICodeEditor}dispose(){this._codeEditorService.removeCodeEditor(this),this._focusTracker.dispose(),this._actions.clear(),this._contentWidgets={},this._overlayWidgets={},this._removeDecorationTypes(),this._postDetachModelCleanup(this._detachModel()),this._onDidDispose.fire(),super.dispose()}invokeWithinContext(e){return this._instantiationService.invokeFunction(e)}updateOptions(e){this._configuration.updateOptions(e||{})}getOptions(){return this._configuration.options}getOption(e){return this._configuration.options.get(e)}getRawOptions(){return this._configuration.getRawOptions()}getOverflowWidgetsDomNode(){return this._overflowWidgetsDomNode}getConfiguredWordAtPosition(e){return this._modelData?_t.getWordAtPosition(this._modelData.model,this._configuration.options.get(132),this._configuration.options.get(131),e):null}getValue(e=null){if(!this._modelData)return"";const t=!!(e&&e.preserveBOM);let i=0;return e&&e.lineEnding&&e.lineEnding===`
`?i=1:e&&e.lineEnding&&e.lineEnding===`\r
`&&(i=2),this._modelData.model.getValue(i,t)}setValue(e){try{if(this._beginUpdate(),!this._modelData)return;this._modelData.model.setValue(e)}finally{this._endUpdate()}}getModel(){return this._modelData?this._modelData.model:null}setModel(e=null){try{this._beginUpdate();const t=e;if(this._modelData===null&&t===null||this._modelData&&this._modelData.model===t)return;const i={oldModelUrl:this._modelData?.model.uri||null,newModelUrl:t?.uri||null};this._onWillChangeModel.fire(i);const n=this.hasTextFocus(),s=this._detachModel();this._attachModel(t),n&&this.hasModel()&&this.focus(),this._removeDecorationTypes(),this._onDidChangeModel.fire(i),this._postDetachModelCleanup(s),this._contributionsDisposable=this._contributions.onAfterModelAttached()}finally{this._endUpdate()}}_removeDecorationTypes(){if(this._decorationTypeKeysToIds={},this._decorationTypeSubtypes){for(const e in this._decorationTypeSubtypes){const t=this._decorationTypeSubtypes[e];for(const i in t)this._removeDecorationType(e+"-"+i)}this._decorationTypeSubtypes={}}}getVisibleRanges(){return this._modelData?this._modelData.viewModel.getVisibleRanges():[]}getVisibleRangesPlusViewportAboveBelow(){return this._modelData?this._modelData.viewModel.getVisibleRangesPlusViewportAboveBelow():[]}getWhitespaces(){return this._modelData?this._modelData.viewModel.viewLayout.getWhitespaces():[]}static _getVerticalOffsetAfterPosition(e,t,i,n){const s=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return e.viewModel.viewLayout.getVerticalOffsetAfterLineNumber(r.lineNumber,n)}getTopForLineNumber(e,t=!1){return this._modelData?Eu._getVerticalOffsetForPosition(this._modelData,e,1,t):-1}getTopForPosition(e,t){return this._modelData?Eu._getVerticalOffsetForPosition(this._modelData,e,t,!1):-1}static _getVerticalOffsetForPosition(e,t,i,n=!1){const s=e.model.validatePosition({lineNumber:t,column:i}),r=e.viewModel.coordinatesConverter.convertModelPositionToViewPosition(s);return e.viewModel.viewLayout.getVerticalOffsetForLineNumber(r.lineNumber,n)}getBottomForLineNumber(e,t=!1){if(!this._modelData)return-1;const i=this._modelData.model.getLineMaxColumn(e);return Eu._getVerticalOffsetAfterPosition(this._modelData,e,i,t)}setHiddenAreas(e,t){this._modelData?.viewModel.setHiddenAreas(e.map(i=>L.lift(i)),t)}getVisibleColumnFromPosition(e){if(!this._modelData)return e.column;const t=this._modelData.model.validatePosition(e),i=this._modelData.model.getOptions().tabSize;return Vi.visibleColumnFromColumn(this._modelData.model.getLineContent(t.lineNumber),t.column,i)+1}getPosition(){return this._modelData?this._modelData.viewModel.getPosition():null}setPosition(e,t="api"){if(this._modelData){if(!A.isIPosition(e))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,[{selectionStartLineNumber:e.lineNumber,selectionStartColumn:e.column,positionLineNumber:e.lineNumber,positionColumn:e.column}])}}_sendRevealRange(e,t,i,n){if(!this._modelData)return;if(!L.isIRange(e))throw new Error("Invalid arguments");const s=this._modelData.model.validateRange(e),r=this._modelData.viewModel.coordinatesConverter.convertModelRangeToViewRange(s);this._modelData.viewModel.revealRange("api",i,r,t,n)}revealLine(e,t=0){this._revealLine(e,0,t)}revealLineInCenter(e,t=0){this._revealLine(e,1,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._revealLine(e,2,t)}revealLineNearTop(e,t=0){this._revealLine(e,5,t)}_revealLine(e,t,i){if(typeof e!="number")throw new Error("Invalid arguments");this._sendRevealRange(new L(e,1,e,1),t,!1,i)}revealPosition(e,t=0){this._revealPosition(e,0,!0,t)}revealPositionInCenter(e,t=0){this._revealPosition(e,1,!0,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._revealPosition(e,2,!0,t)}revealPositionNearTop(e,t=0){this._revealPosition(e,5,!0,t)}_revealPosition(e,t,i,n){if(!A.isIPosition(e))throw new Error("Invalid arguments");this._sendRevealRange(new L(e.lineNumber,e.column,e.lineNumber,e.column),t,i,n)}getSelection(){return this._modelData?this._modelData.viewModel.getSelection():null}getSelections(){return this._modelData?this._modelData.viewModel.getSelections():null}setSelection(e,t="api"){const i=pe.isISelection(e),n=L.isIRange(e);if(!i&&!n)throw new Error("Invalid arguments");if(i)this._setSelectionImpl(e,t);else if(n){const s={selectionStartLineNumber:e.startLineNumber,selectionStartColumn:e.startColumn,positionLineNumber:e.endLineNumber,positionColumn:e.endColumn};this._setSelectionImpl(s,t)}}_setSelectionImpl(e,t){if(!this._modelData)return;const i=new pe(e.selectionStartLineNumber,e.selectionStartColumn,e.positionLineNumber,e.positionColumn);this._modelData.viewModel.setSelections(t,[i])}revealLines(e,t,i=0){this._revealLines(e,t,0,i)}revealLinesInCenter(e,t,i=0){this._revealLines(e,t,1,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._revealLines(e,t,2,i)}revealLinesNearTop(e,t,i=0){this._revealLines(e,t,5,i)}_revealLines(e,t,i,n){if(typeof e!="number"||typeof t!="number")throw new Error("Invalid arguments");this._sendRevealRange(new L(e,1,t,1),i,!1,n)}revealRange(e,t=0,i=!1,n=!0){this._revealRange(e,i?1:0,n,t)}revealRangeInCenter(e,t=0){this._revealRange(e,1,!0,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._revealRange(e,2,!0,t)}revealRangeNearTop(e,t=0){this._revealRange(e,5,!0,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._revealRange(e,6,!0,t)}revealRangeAtTop(e,t=0){this._revealRange(e,3,!0,t)}_revealRange(e,t,i,n){if(!L.isIRange(e))throw new Error("Invalid arguments");this._sendRevealRange(L.lift(e),t,i,n)}setSelections(e,t="api",i=0){if(this._modelData){if(!e||e.length===0)throw new Error("Invalid arguments");for(let n=0,s=e.length;n<s;n++)if(!pe.isISelection(e[n]))throw new Error("Invalid arguments");this._modelData.viewModel.setSelections(t,e,i)}}getContentWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getContentWidth():-1}getScrollWidth(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollWidth():-1}getScrollLeft(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollLeft():-1}getContentHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getContentHeight():-1}getScrollHeight(){return this._modelData?this._modelData.viewModel.viewLayout.getScrollHeight():-1}getScrollTop(){return this._modelData?this._modelData.viewModel.viewLayout.getCurrentScrollTop():-1}setScrollLeft(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollLeft:e},t)}}setScrollTop(e,t=1){if(this._modelData){if(typeof e!="number")throw new Error("Invalid arguments");this._modelData.viewModel.viewLayout.setScrollPosition({scrollTop:e},t)}}setScrollPosition(e,t=1){this._modelData&&this._modelData.viewModel.viewLayout.setScrollPosition(e,t)}hasPendingScrollAnimation(){return this._modelData?this._modelData.viewModel.viewLayout.hasPendingScrollAnimation():!1}saveViewState(){if(!this._modelData)return null;const e=this._contributions.saveViewState(),t=this._modelData.viewModel.saveCursorState(),i=this._modelData.viewModel.saveState();return{cursorState:t,viewState:i,contributionsState:e}}restoreViewState(e){if(!this._modelData||!this._modelData.hasRealView)return;const t=e;if(t&&t.cursorState&&t.viewState){const i=t.cursorState;Array.isArray(i)?i.length>0&&this._modelData.viewModel.restoreCursorState(i):this._modelData.viewModel.restoreCursorState([i]),this._contributions.restoreViewState(t.contributionsState||{});const n=this._modelData.viewModel.reduceRestoreState(t.viewState);this._modelData.view.restoreState(n)}}handleInitialized(){this._getViewModel()?.visibleLinesStabilized()}getContribution(e){return this._contributions.get(e)}getActions(){return Array.from(this._actions.values())}getSupportedActions(){let e=this.getActions();return e=e.filter(t=>t.isSupported()),e}getAction(e){return this._actions.get(e)||null}trigger(e,t,i){i=i||{};try{switch(this._beginUpdate(),t){case"compositionStart":this._startComposition();return;case"compositionEnd":this._endComposition(e);return;case"type":{const s=i;this._type(e,s.text||"");return}case"replacePreviousChar":{const s=i;this._compositionType(e,s.text||"",s.replaceCharCnt||0,0,0);return}case"compositionType":{const s=i;this._compositionType(e,s.text||"",s.replacePrevCharCnt||0,s.replaceNextCharCnt||0,s.positionDelta||0);return}case"paste":{const s=i;this._paste(e,s.text||"",s.pasteOnNewLine||!1,s.multicursorText||null,s.mode||null,s.clipboardEvent);return}case"cut":this._cut(e);return}const n=this.getAction(t);if(n){Promise.resolve(n.run(i)).then(void 0,Ae);return}if(!this._modelData||this._triggerEditorCommand(e,t,i))return;this._triggerCommand(t,i)}finally{this._endUpdate()}}_triggerCommand(e,t){this._commandService.executeCommand(e,t)}_startComposition(){this._modelData&&(this._modelData.viewModel.startComposition(),this._onDidCompositionStart.fire())}_endComposition(e){this._modelData&&(this._modelData.viewModel.endComposition(e),this._onDidCompositionEnd.fire())}_type(e,t){!this._modelData||t.length===0||(e==="keyboard"&&this._onWillType.fire(t),this._modelData.viewModel.type(t,e),e==="keyboard"&&this._onDidType.fire(t))}_compositionType(e,t,i,n,s){this._modelData&&this._modelData.viewModel.compositionType(t,i,n,s,e)}_paste(e,t,i,n,s,r){if(!this._modelData)return;const a=this._modelData.viewModel,l=a.getSelection().getStartPosition();a.paste(t,i,n,e);const c=a.getSelection().getStartPosition();e==="keyboard"&&this._onDidPaste.fire({clipboardEvent:r,range:new L(l.lineNumber,l.column,c.lineNumber,c.column),languageId:s})}_cut(e){this._modelData&&this._modelData.viewModel.cut(e)}_triggerEditorCommand(e,t,i){const n=lg.getEditorCommand(t);return n?(i=i||{},i.source=e,this._instantiationService.invokeFunction(s=>{Promise.resolve(n.runEditorCommand(s,this,i)).then(void 0,Ae)}),!0):!1}_getViewModel(){return this._modelData?this._modelData.viewModel:null}pushUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.pushStackElement(),!0)}popUndoStop(){return!this._modelData||this._configuration.options.get(92)?!1:(this._modelData.model.popStackElement(),!0)}executeEdits(e,t,i){if(!this._modelData||this._configuration.options.get(92))return!1;let n;return i?Array.isArray(i)?n=()=>i:n=i:n=()=>null,this._modelData.viewModel.executeEdits(e,t,n),!0}executeCommand(e,t){this._modelData&&this._modelData.viewModel.executeCommand(t,e)}executeCommands(e,t){this._modelData&&this._modelData.viewModel.executeCommands(t,e)}createDecorationsCollection(e){return new ebe(this,e)}changeDecorations(e){return this._modelData?this._modelData.model.changeDecorations(e,this._id):null}getLineDecorations(e){return this._modelData?this._modelData.model.getLineDecorations(e,this._id,v0(this._configuration.options)):null}getDecorationsInRange(e){return this._modelData?this._modelData.model.getDecorationsInRange(e,this._id,v0(this._configuration.options)):null}deltaDecorations(e,t){return this._modelData?e.length===0&&t.length===0?e:this._modelData.model.deltaDecorations(e,t,this._id):[]}removeDecorations(e){!this._modelData||e.length===0||this._modelData.model.changeDecorations(t=>{t.deltaDecorations(e,[])})}removeDecorationsByType(e){const t=this._decorationTypeKeysToIds[e];t&&this.changeDecorations(i=>i.deltaDecorations(t,[])),this._decorationTypeKeysToIds.hasOwnProperty(e)&&delete this._decorationTypeKeysToIds[e],this._decorationTypeSubtypes.hasOwnProperty(e)&&delete this._decorationTypeSubtypes[e]}getLayoutInfo(){return this._configuration.options.get(146)}createOverviewRuler(e){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.createOverviewRuler(e)}getContainerDomNode(){return this._domElement}getDomNode(){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.domNode.domNode}delegateVerticalScrollbarPointerDown(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateVerticalScrollbarPointerDown(e)}delegateScrollFromMouseWheelEvent(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.delegateScrollFromMouseWheelEvent(e)}layout(e,t=!1){this._configuration.observeContainer(e),t||this.render()}focus(){!this._modelData||!this._modelData.hasRealView||this._modelData.view.focus()}hasTextFocus(){return!this._modelData||!this._modelData.hasRealView?!1:this._modelData.view.isFocused()}hasWidgetFocus(){return this._focusTracker&&this._focusTracker.hasFocus()}addContentWidget(e){const t={widget:e,position:e.getPosition()};this._contentWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a content widget with the same id:"+e.getId()),this._contentWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addContentWidget(t)}layoutContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutContentWidget(i)}}removeContentWidget(e){const t=e.getId();if(this._contentWidgets.hasOwnProperty(t)){const i=this._contentWidgets[t];delete this._contentWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeContentWidget(i)}}addOverlayWidget(e){const t={widget:e,position:e.getPosition()};this._overlayWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting an overlay widget with the same id."),this._overlayWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addOverlayWidget(t)}layoutOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutOverlayWidget(i)}}removeOverlayWidget(e){const t=e.getId();if(this._overlayWidgets.hasOwnProperty(t)){const i=this._overlayWidgets[t];delete this._overlayWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeOverlayWidget(i)}}addGlyphMarginWidget(e){const t={widget:e,position:e.getPosition()};this._glyphMarginWidgets.hasOwnProperty(e.getId())&&console.warn("Overwriting a glyph margin widget with the same id."),this._glyphMarginWidgets[e.getId()]=t,this._modelData&&this._modelData.hasRealView&&this._modelData.view.addGlyphMarginWidget(t)}layoutGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];i.position=e.getPosition(),this._modelData&&this._modelData.hasRealView&&this._modelData.view.layoutGlyphMarginWidget(i)}}removeGlyphMarginWidget(e){const t=e.getId();if(this._glyphMarginWidgets.hasOwnProperty(t)){const i=this._glyphMarginWidgets[t];delete this._glyphMarginWidgets[t],this._modelData&&this._modelData.hasRealView&&this._modelData.view.removeGlyphMarginWidget(i)}}changeViewZones(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.change(e)}getTargetAtClientPoint(e,t){return!this._modelData||!this._modelData.hasRealView?null:this._modelData.view.getTargetAtClientPoint(e,t)}getScrolledVisiblePosition(e){if(!this._modelData||!this._modelData.hasRealView)return null;const t=this._modelData.model.validatePosition(e),i=this._configuration.options,n=i.get(146),s=Eu._getVerticalOffsetForPosition(this._modelData,t.lineNumber,t.column)-this.getScrollTop(),r=this._modelData.view.getOffsetForColumn(t.lineNumber,t.column)+n.glyphMarginWidth+n.lineNumbersWidth+n.decorationsWidth-this.getScrollLeft();return{top:s,left:r,height:i.get(67)}}getOffsetForColumn(e,t){return!this._modelData||!this._modelData.hasRealView?-1:this._modelData.view.getOffsetForColumn(e,t)}render(e=!1){!this._modelData||!this._modelData.hasRealView||this._modelData.viewModel.batchEvents(()=>{this._modelData.view.render(!0,e)})}setAriaOptions(e){!this._modelData||!this._modelData.hasRealView||this._modelData.view.setAriaOptions(e)}applyFontInfo(e){mn(e,this._configuration.options.get(50))}setBanner(e,t){this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),this._bannerDomNode=e,this._configuration.setReservedHeight(e?t:0),this._bannerDomNode&&this._domElement.prepend(this._bannerDomNode)}_attachModel(e){if(!e){this._modelData=null;return}const t=[];this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._configuration.setIsDominatedByLongLines(e.isDominatedByLongLines()),this._configuration.setModelLineCount(e.getLineCount());const i=e.onBeforeAttached(),n=new G_e(this._id,this._configuration,e,AB.create(xe(this._domElement)),MB.create(this._configuration.options),a=>ao(xe(this._domElement),a),this.languageConfigurationService,this._themeService,i,{batchChanges:a=>{try{return this._beginUpdate(),a()}finally{this._endUpdate()}}});t.push(e.onWillDispose(()=>this.setModel(null))),t.push(n.onEvent(a=>{switch(a.kind){case 0:this._onDidContentSizeChange.fire(a);break;case 1:this._editorTextFocus.setValue(a.hasFocus);break;case 2:this._onDidScrollChange.fire(a);break;case 3:this._onDidChangeViewZones.fire();break;case 4:this._onDidChangeHiddenAreas.fire();break;case 5:this._onDidAttemptReadOnlyEdit.fire();break;case 6:{if(a.reachedMaxCursorCount){const h=this.getOption(80),u=p("cursors.maximum","The number of cursors has been limited to {0}. Consider using [find and replace](https://code.visualstudio.com/docs/editor/codebasics#_find-and-replace) for larger changes or increase the editor multi cursor limit setting.",h);this._notificationService.prompt(ST.Warning,u,[{label:"Find and Replace",run:()=>{this._commandService.executeCommand("editor.action.startFindReplaceAction")}},{label:p("goToSetting","Increase Multi Cursor Limit"),run:()=>{this._commandService.executeCommand("workbench.action.openSettings2",{query:"editor.multiCursorLimit"})}}])}const l=[];for(let h=0,u=a.selections.length;h<u;h++)l[h]=a.selections[h].getPosition();const c={position:l[0],secondaryPositions:l.slice(1),reason:a.reason,source:a.source};this._onDidChangeCursorPosition.fire(c);const d={selection:a.selections[0],secondarySelections:a.selections.slice(1),modelVersionId:a.modelVersionId,oldSelections:a.oldSelections,oldModelVersionId:a.oldModelVersionId,source:a.source,reason:a.reason};this._onDidChangeCursorSelection.fire(d);break}case 7:this._onDidChangeModelDecorations.fire(a.event);break;case 8:this._domElement.setAttribute("data-mode-id",e.getLanguageId()),this._onDidChangeModelLanguage.fire(a.event);break;case 9:this._onDidChangeModelLanguageConfiguration.fire(a.event);break;case 10:this._onDidChangeModelContent.fire(a.event);break;case 11:this._onDidChangeModelOptions.fire(a.event);break;case 12:this._onDidChangeModelTokens.fire(a.event);break}}));const[s,r]=this._createView(n);if(r){this._domElement.appendChild(s.domNode.domNode);let a=Object.keys(this._contentWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];s.addContentWidget(this._contentWidgets[d])}a=Object.keys(this._overlayWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];s.addOverlayWidget(this._overlayWidgets[d])}a=Object.keys(this._glyphMarginWidgets);for(let l=0,c=a.length;l<c;l++){const d=a[l];s.addGlyphMarginWidget(this._glyphMarginWidgets[d])}s.render(!1,!0),s.domNode.domNode.setAttribute("data-uri",e.uri.toString())}this._modelData=new Y_e(e,n,s,r,t,i)}_createView(e){let t;this.isSimpleWidget?t={paste:(s,r,a,l)=>{this._paste("keyboard",s,r,a,l)},type:s=>{this._type("keyboard",s)},compositionType:(s,r,a,l)=>{this._compositionType("keyboard",s,r,a,l)},startComposition:()=>{this._startComposition()},endComposition:()=>{this._endComposition("keyboard")},cut:()=>{this._cut("keyboard")}}:t={paste:(s,r,a,l)=>{const c={text:s,pasteOnNewLine:r,multicursorText:a,mode:l};this._commandService.executeCommand("paste",c)},type:s=>{const r={text:s};this._commandService.executeCommand("type",r)},compositionType:(s,r,a,l)=>{if(a||l){const c={text:s,replacePrevCharCnt:r,replaceNextCharCnt:a,positionDelta:l};this._commandService.executeCommand("compositionType",c)}else{const c={text:s,replaceCharCnt:r};this._commandService.executeCommand("replacePreviousChar",c)}},startComposition:()=>{this._commandService.executeCommand("compositionStart",{})},endComposition:()=>{this._commandService.executeCommand("compositionEnd",{})},cut:()=>{this._commandService.executeCommand("cut",{})}};const i=new lD(e.coordinatesConverter);return i.onKeyDown=s=>this._onKeyDown.fire(s),i.onKeyUp=s=>this._onKeyUp.fire(s),i.onContextMenu=s=>this._onContextMenu.fire(s),i.onMouseMove=s=>this._onMouseMove.fire(s),i.onMouseLeave=s=>this._onMouseLeave.fire(s),i.onMouseDown=s=>this._onMouseDown.fire(s),i.onMouseUp=s=>this._onMouseUp.fire(s),i.onMouseDrag=s=>this._onMouseDrag.fire(s),i.onMouseDrop=s=>this._onMouseDrop.fire(s),i.onMouseDropCanceled=s=>this._onMouseDropCanceled.fire(s),i.onMouseWheel=s=>this._onMouseWheel.fire(s),[new eO(t,this._configuration,this._themeService.getColorTheme(),e,i,this._overflowWidgetsDomNode,this._instantiationService),!0]}_postDetachModelCleanup(e){e?.removeAllDecorationsWithOwnerId(this._id)}_detachModel(){if(this._contributionsDisposable?.dispose(),this._contributionsDisposable=void 0,!this._modelData)return null;const e=this._modelData.model,t=this._modelData.hasRealView?this._modelData.view.domNode.domNode:null;return this._modelData.dispose(),this._modelData=null,this._domElement.removeAttribute("data-mode-id"),t&&this._domElement.contains(t)&&t.remove(),this._bannerDomNode&&this._domElement.contains(this._bannerDomNode)&&this._bannerDomNode.remove(),e}_removeDecorationType(e){this._codeEditorService.removeDecorationType(e)}hasModel(){return this._modelData!==null}showDropIndicatorAt(e){const t=[{range:new L(e.lineNumber,e.column,e.lineNumber,e.column),options:Eu.dropIntoEditorDecorationOptions}];this._dropIntoEditorDecorations.set(t),this.revealPosition(e,1)}removeDropIndicator(){this._dropIntoEditorDecorations.clear()}setContextValue(e,t){this._contextKeyService.createKey(e,t)}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&this._onBeginUpdate.fire()}_endUpdate(){this._updateCounter--,this._updateCounter===0&&this._onEndUpdate.fire()}},Eu=xg,xg.dropIntoEditorDecorationOptions=Fe.register({description:"workbench-dnd-target",className:"dnd-target"}),xg);By=Eu=q_e([Xl(3,Ce),Xl(4,gt),Xl(5,Ft),Xl(6,Ee),Xl(7,zi),Xl(8,Ei),Xl(9,ho),Xl(10,li),Xl(11,ue)],By);let Z_e=0;class Y_e{constructor(e,t,i,n,s,r){this.model=e,this.viewModel=t,this.view=i,this.hasRealView=n,this.listenersToRemove=s,this.attachedView=r}dispose(){Dt(this.listenersToRemove),this.model.onBeforeDetached(this.attachedView),this.hasRealView&&this.view.dispose(),this.viewModel.dispose()}}class k9 extends F{constructor(e){super(),this._emitterOptions=e,this._onDidChangeToTrue=this._register(new O(this._emitterOptions)),this.onDidChangeToTrue=this._onDidChangeToTrue.event,this._onDidChangeToFalse=this._register(new O(this._emitterOptions)),this.onDidChangeToFalse=this._onDidChangeToFalse.event,this._value=0}setValue(e){const t=e?2:1;this._value!==t&&(this._value=t,this._value===2?this._onDidChangeToTrue.fire():this._value===1&&this._onDidChangeToFalse.fire())}}class Vn extends O{constructor(e,t){super({deliveryQueue:t}),this._contributions=e}fire(e){this._contributions.onBeforeInteractionEvent(),super.fire(e)}}class X_e extends F{constructor(e,t){super(),this._editor=e,t.createKey("editorId",e.getId()),this._editorSimpleInput=T.editorSimpleInput.bindTo(t),this._editorFocus=T.focus.bindTo(t),this._textInputFocus=T.textInputFocus.bindTo(t),this._editorTextFocus=T.editorTextFocus.bindTo(t),this._tabMovesFocus=T.tabMovesFocus.bindTo(t),this._editorReadonly=T.readOnly.bindTo(t),this._inDiffEditor=T.inDiffEditor.bindTo(t),this._editorColumnSelection=T.columnSelection.bindTo(t),this._hasMultipleSelections=T.hasMultipleSelections.bindTo(t),this._hasNonEmptySelection=T.hasNonEmptySelection.bindTo(t),this._canUndo=T.canUndo.bindTo(t),this._canRedo=T.canRedo.bindTo(t),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromConfig())),this._register(this._editor.onDidChangeCursorSelection(()=>this._updateFromSelection())),this._register(this._editor.onDidFocusEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorWidget(()=>this._updateFromFocus())),this._register(this._editor.onDidFocusEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidBlurEditorText(()=>this._updateFromFocus())),this._register(this._editor.onDidChangeModel(()=>this._updateFromModel())),this._register(this._editor.onDidChangeConfiguration(()=>this._updateFromModel())),this._register(M_.onDidChangeTabFocus(i=>this._tabMovesFocus.set(i))),this._updateFromConfig(),this._updateFromSelection(),this._updateFromFocus(),this._updateFromModel(),this._editorSimpleInput.set(this._editor.isSimpleWidget)}_updateFromConfig(){const e=this._editor.getOptions();this._tabMovesFocus.set(M_.getTabFocusMode()),this._editorReadonly.set(e.get(92)),this._inDiffEditor.set(e.get(61)),this._editorColumnSelection.set(e.get(22))}_updateFromSelection(){const e=this._editor.getSelections();e?(this._hasMultipleSelections.set(e.length>1),this._hasNonEmptySelection.set(e.some(t=>!t.isEmpty()))):(this._hasMultipleSelections.reset(),this._hasNonEmptySelection.reset())}_updateFromFocus(){this._editorFocus.set(this._editor.hasWidgetFocus()&&!this._editor.isSimpleWidget),this._editorTextFocus.set(this._editor.hasTextFocus()&&!this._editor.isSimpleWidget),this._textInputFocus.set(this._editor.hasTextFocus())}_updateFromModel(){const e=this._editor.getModel();this._canUndo.set(!!(e&&e.canUndo())),this._canRedo.set(!!(e&&e.canRedo()))}}class Q_e extends F{constructor(e,t,i){super(),this._editor=e,this._contextKeyService=t,this._languageFeaturesService=i,this._langId=T.languageId.bindTo(t),this._hasCompletionItemProvider=T.hasCompletionItemProvider.bindTo(t),this._hasCodeActionsProvider=T.hasCodeActionsProvider.bindTo(t),this._hasCodeLensProvider=T.hasCodeLensProvider.bindTo(t),this._hasDefinitionProvider=T.hasDefinitionProvider.bindTo(t),this._hasDeclarationProvider=T.hasDeclarationProvider.bindTo(t),this._hasImplementationProvider=T.hasImplementationProvider.bindTo(t),this._hasTypeDefinitionProvider=T.hasTypeDefinitionProvider.bindTo(t),this._hasHoverProvider=T.hasHoverProvider.bindTo(t),this._hasDocumentHighlightProvider=T.hasDocumentHighlightProvider.bindTo(t),this._hasDocumentSymbolProvider=T.hasDocumentSymbolProvider.bindTo(t),this._hasReferenceProvider=T.hasReferenceProvider.bindTo(t),this._hasRenameProvider=T.hasRenameProvider.bindTo(t),this._hasSignatureHelpProvider=T.hasSignatureHelpProvider.bindTo(t),this._hasInlayHintsProvider=T.hasInlayHintsProvider.bindTo(t),this._hasDocumentFormattingProvider=T.hasDocumentFormattingProvider.bindTo(t),this._hasDocumentSelectionFormattingProvider=T.hasDocumentSelectionFormattingProvider.bindTo(t),this._hasMultipleDocumentFormattingProvider=T.hasMultipleDocumentFormattingProvider.bindTo(t),this._hasMultipleDocumentSelectionFormattingProvider=T.hasMultipleDocumentSelectionFormattingProvider.bindTo(t),this._isInEmbeddedEditor=T.isInEmbeddedEditor.bindTo(t);const n=()=>this._update();this._register(e.onDidChangeModel(n)),this._register(e.onDidChangeModelLanguage(n)),this._register(i.completionProvider.onDidChange(n)),this._register(i.codeActionProvider.onDidChange(n)),this._register(i.codeLensProvider.onDidChange(n)),this._register(i.definitionProvider.onDidChange(n)),this._register(i.declarationProvider.onDidChange(n)),this._register(i.implementationProvider.onDidChange(n)),this._register(i.typeDefinitionProvider.onDidChange(n)),this._register(i.hoverProvider.onDidChange(n)),this._register(i.documentHighlightProvider.onDidChange(n)),this._register(i.documentSymbolProvider.onDidChange(n)),this._register(i.referenceProvider.onDidChange(n)),this._register(i.renameProvider.onDidChange(n)),this._register(i.documentFormattingEditProvider.onDidChange(n)),this._register(i.documentRangeFormattingEditProvider.onDidChange(n)),this._register(i.signatureHelpProvider.onDidChange(n)),this._register(i.inlayHintsProvider.onDidChange(n)),n()}dispose(){super.dispose()}reset(){this._contextKeyService.bufferChangeEvents(()=>{this._langId.reset(),this._hasCompletionItemProvider.reset(),this._hasCodeActionsProvider.reset(),this._hasCodeLensProvider.reset(),this._hasDefinitionProvider.reset(),this._hasDeclarationProvider.reset(),this._hasImplementationProvider.reset(),this._hasTypeDefinitionProvider.reset(),this._hasHoverProvider.reset(),this._hasDocumentHighlightProvider.reset(),this._hasDocumentSymbolProvider.reset(),this._hasReferenceProvider.reset(),this._hasRenameProvider.reset(),this._hasDocumentFormattingProvider.reset(),this._hasDocumentSelectionFormattingProvider.reset(),this._hasSignatureHelpProvider.reset(),this._isInEmbeddedEditor.reset()})}_update(){const e=this._editor.getModel();if(!e){this.reset();return}this._contextKeyService.bufferChangeEvents(()=>{this._langId.set(e.getLanguageId()),this._hasCompletionItemProvider.set(this._languageFeaturesService.completionProvider.has(e)),this._hasCodeActionsProvider.set(this._languageFeaturesService.codeActionProvider.has(e)),this._hasCodeLensProvider.set(this._languageFeaturesService.codeLensProvider.has(e)),this._hasDefinitionProvider.set(this._languageFeaturesService.definitionProvider.has(e)),this._hasDeclarationProvider.set(this._languageFeaturesService.declarationProvider.has(e)),this._hasImplementationProvider.set(this._languageFeaturesService.implementationProvider.has(e)),this._hasTypeDefinitionProvider.set(this._languageFeaturesService.typeDefinitionProvider.has(e)),this._hasHoverProvider.set(this._languageFeaturesService.hoverProvider.has(e)),this._hasDocumentHighlightProvider.set(this._languageFeaturesService.documentHighlightProvider.has(e)),this._hasDocumentSymbolProvider.set(this._languageFeaturesService.documentSymbolProvider.has(e)),this._hasReferenceProvider.set(this._languageFeaturesService.referenceProvider.has(e)),this._hasRenameProvider.set(this._languageFeaturesService.renameProvider.has(e)),this._hasSignatureHelpProvider.set(this._languageFeaturesService.signatureHelpProvider.has(e)),this._hasInlayHintsProvider.set(this._languageFeaturesService.inlayHintsProvider.has(e)),this._hasDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.has(e)||this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.has(e)),this._hasMultipleDocumentFormattingProvider.set(this._languageFeaturesService.documentFormattingEditProvider.all(e).length+this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._hasMultipleDocumentSelectionFormattingProvider.set(this._languageFeaturesService.documentRangeFormattingEditProvider.all(e).length>1),this._isInEmbeddedEditor.set(e.uri.scheme===Oe.walkThroughSnippet||e.uri.scheme===Oe.vscodeChatCodeBlock)})}}class J_e extends F{constructor(e,t){super(),this._onChange=this._register(new O),this.onChange=this._onChange.event,this._hadFocus=void 0,this._hasDomElementFocus=!1,this._domFocusTracker=this._register(Ia(e)),this._overflowWidgetsDomNodeHasFocus=!1,this._register(this._domFocusTracker.onDidFocus(()=>{this._hasDomElementFocus=!0,this._update()})),this._register(this._domFocusTracker.onDidBlur(()=>{this._hasDomElementFocus=!1,this._update()})),t&&(this._overflowWidgetsDomNode=this._register(Ia(t)),this._register(this._overflowWidgetsDomNode.onDidFocus(()=>{this._overflowWidgetsDomNodeHasFocus=!0,this._update()})),this._register(this._overflowWidgetsDomNode.onDidBlur(()=>{this._overflowWidgetsDomNodeHasFocus=!1,this._update()})))}_update(){const e=this._hasDomElementFocus||this._overflowWidgetsDomNodeHasFocus;this._hadFocus!==e&&(this._hadFocus=e,this._onChange.fire(void 0))}hasFocus(){return this._hadFocus??!1}}class ebe{get length(){return this._decorationIds.length}constructor(e,t){this._editor=e,this._decorationIds=[],this._isChangingDecorations=!1,Array.isArray(t)&&t.length>0&&this.set(t)}onDidChange(e,t,i){return this._editor.onDidChangeModelDecorations(n=>{this._isChangingDecorations||e.call(t,n)},i)}getRange(e){return!this._editor.hasModel()||e>=this._decorationIds.length?null:this._editor.getModel().getDecorationRange(this._decorationIds[e])}getRanges(){if(!this._editor.hasModel())return[];const e=this._editor.getModel(),t=[];for(const i of this._decorationIds){const n=e.getDecorationRange(i);n&&t.push(n)}return t}has(e){return this._decorationIds.includes(e.id)}clear(){this._decorationIds.length!==0&&this.set([])}set(e){try{this._isChangingDecorations=!0,this._editor.changeDecorations(t=>{this._decorationIds=t.deltaDecorations(this._decorationIds,e)})}finally{this._isChangingDecorations=!1}return this._decorationIds}append(e){let t=[];try{this._isChangingDecorations=!0,this._editor.changeDecorations(i=>{t=i.deltaDecorations([],e),this._decorationIds=this._decorationIds.concat(t)})}finally{this._isChangingDecorations=!1}return t}}const tbe=encodeURIComponent("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 6 3' enable-background='new 0 0 6 3' height='3' width='6'><g fill='"),ibe=encodeURIComponent("'><polygon points='5.5,0 2.5,3 1.1,3 4.1,0'/><polygon points='4,0 6,2 6,0.6 5.4,0'/><polygon points='0,2 1,3 2.4,3 0,0.6'/></g></svg>");function lN(o){return tbe+encodeURIComponent(o.toString())+ibe}const nbe=encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" height="3" width="12"><g fill="'),sbe=encodeURIComponent('"><circle cx="1" cy="1" r="1"/><circle cx="5" cy="1" r="1"/><circle cx="9" cy="1" r="1"/></g></svg>');function obe(o){return nbe+encodeURIComponent(o.toString())+sbe}br((o,e)=>{const t=o.getColor(ET);t&&e.addRule(`.monaco-editor .squiggly-error { background: url("data:image/svg+xml,${lN(t)}") repeat-x bottom left; }`);const i=o.getColor(qc);i&&e.addRule(`.monaco-editor .squiggly-warning { background: url("data:image/svg+xml,${lN(i)}") repeat-x bottom left; }`);const n=o.getColor(Nl);n&&e.addRule(`.monaco-editor .squiggly-info { background: url("data:image/svg+xml,${lN(n)}") repeat-x bottom left; }`);const s=o.getColor(qne);s&&e.addRule(`.monaco-editor .squiggly-hint { background: url("data:image/svg+xml,${obe(s)}") no-repeat bottom left; }`);const r=o.getColor(Nce);r&&e.addRule(`.monaco-editor.showUnused .squiggly-inline-unnecessary { opacity: ${r.rgba.a}; }`)});class Ma{static capture(e){if(e.getScrollTop()===0||e.hasPendingScrollAnimation())return new Ma(e.getScrollTop(),e.getContentHeight(),null,0,null);let t=null,i=0;const n=e.getVisibleRanges();if(n.length>0){t=n[0].getStartPosition();const s=e.getTopForPosition(t.lineNumber,t.column);i=e.getScrollTop()-s}return new Ma(e.getScrollTop(),e.getContentHeight(),t,i,e.getPosition())}constructor(e,t,i,n,s){this._initialScrollTop=e,this._initialContentHeight=t,this._visiblePosition=i,this._visiblePositionScrollDelta=n,this._cursorPosition=s}restore(e){if(!(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())&&this._visiblePosition){const t=e.getTopForPosition(this._visiblePosition.lineNumber,this._visiblePosition.column);e.setScrollTop(t+this._visiblePositionScrollDelta)}}restoreRelativeVerticalPositionOfCursor(e){if(this._initialContentHeight===e.getContentHeight()&&this._initialScrollTop===e.getScrollTop())return;const t=e.getPosition();if(!this._cursorPosition||!t)return;const i=e.getTopForLineNumber(t.lineNumber)-e.getTopForLineNumber(this._cursorPosition.lineNumber);e.setScrollTop(e.getScrollTop()+i,1)}}function rbe(o,e,t,i){if(o.length===0)return e;if(e.length===0)return o;const n=[];let s=0,r=0;for(;s<o.length&&r<e.length;){const a=o[s],l=e[r],c=t(a),d=t(l);c<d?(n.push(a),s++):c>d?(n.push(l),r++):(n.push(i(a,l)),s++,r++)}for(;s<o.length;)n.push(o[s]),s++;for(;r<e.length;)n.push(e[r]),r++;return n}function oL(o,e){const t=new $,i=o.createDecorationsCollection();return t.add(Ow({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const s=e.read(n);i.set(s)})),t.add({dispose:()=>{i.clear()}}),t}function sm(o,e){return o.appendChild(e),ve(()=>{e.remove()})}function abe(o,e){return o.prepend(e),ve(()=>{e.remove()})}class oj extends F{get width(){return this._width}get height(){return this._height}get automaticLayout(){return this._automaticLayout}constructor(e,t){super(),this._automaticLayout=!1,this.elementSizeObserver=this._register(new BK(e,t)),this._width=$e(this,this.elementSizeObserver.getWidth()),this._height=$e(this,this.elementSizeObserver.getHeight()),this._register(this.elementSizeObserver.onDidChange(i=>oi(n=>{this._width.set(this.elementSizeObserver.getWidth(),n),this._height.set(this.elementSizeObserver.getHeight(),n)})))}observe(e){this.elementSizeObserver.observe(e)}setAutomaticLayout(e){this._automaticLayout=e,e?this.elementSizeObserver.startObserving():this.elementSizeObserver.stopObserving()}}function E9(o,e,t){let i=e.get(),n=i,s=i;const r=$e("animatedValue",i);let a=-1;const l=300;let c;t.add(Fw({createEmptyChangeSummary:()=>({animate:!1}),handleChange:(h,u)=>(h.didChange(e)&&(u.animate=u.animate||h.change),!0)},(h,u)=>{c!==void 0&&(o.cancelAnimationFrame(c),c=void 0),n=s,i=e.read(h),a=Date.now()-(u.animate?0:l),d()}));function d(){const h=Date.now()-a;s=Math.floor(lbe(h,n,i-n,l)),h<l?c=o.requestAnimationFrame(d):s=i,r.set(s,void 0)}return r}function lbe(o,e,t,i){return o===i?e+t:t*(-Math.pow(2,-10*o/i)+1)+e}class UB extends F{constructor(e,t,i){super(),this._register(new lO(e,i)),this._register(Yc(i,{height:t.actualHeight,top:t.actualTop}))}}class om{get afterLineNumber(){return this._afterLineNumber.get()}constructor(e,t){this._afterLineNumber=e,this.heightInPx=t,this.domNode=document.createElement("div"),this._actualTop=$e(this,void 0),this._actualHeight=$e(this,void 0),this.actualTop=this._actualTop,this.actualHeight=this._actualHeight,this.showInHiddenAreas=!0,this.onChange=this._afterLineNumber,this.onDomNodeTop=i=>{this._actualTop.set(i,void 0)},this.onComputedHeight=i=>{this._actualHeight.set(i,void 0)}}}const sE=class sE{constructor(e,t){this._editor=e,this._domElement=t,this._overlayWidgetId=`managedOverlayWidget-${sE._counter++}`,this._overlayWidget={getId:()=>this._overlayWidgetId,getDomNode:()=>this._domElement,getPosition:()=>null},this._editor.addOverlayWidget(this._overlayWidget)}dispose(){this._editor.removeOverlayWidget(this._overlayWidget)}};sE._counter=0;let lO=sE;function Yc(o,e){return Re(t=>{for(let[i,n]of Object.entries(e))n&&typeof n=="object"&&"read"in n&&(n=n.read(t)),typeof n=="number"&&(n=`${n}px`),i=i.replace(/[A-Z]/g,s=>"-"+s.toLowerCase()),o.style[i]=n})}function rL(o,e,t,i){const n=new $,s=[];return n.add(Is((r,a)=>{const l=e.read(r),c=new Map,d=new Map;t&&t(!0),o.changeViewZones(h=>{for(const u of s)h.removeZone(u),i?.delete(u);s.length=0;for(const u of l){const g=h.addZone(u);u.setZoneId&&u.setZoneId(g),s.push(g),i?.add(g),c.set(u,g)}}),t&&t(!1),a.add(Fw({createEmptyChangeSummary(){return{zoneIds:[]}},handleChange(h,u){const g=d.get(h.changedObservable);return g!==void 0&&u.zoneIds.push(g),!0}},(h,u)=>{for(const g of l)g.onChange&&(d.set(g.onChange,c.get(g)),g.onChange.read(h));t&&t(!0),o.changeViewZones(g=>{for(const f of u.zoneIds)g.layoutZone(f)}),t&&t(!1)}))})),n.add({dispose(){t&&t(!0),o.changeViewZones(r=>{for(const a of s)r.removeZone(a)}),i?.clear(),t&&t(!1)}}),n}class cbe extends ri{dispose(){super.dispose(!0)}}function T9(o,e){const t=JC(e,n=>n.original.startLineNumber<=o.lineNumber);if(!t)return L.fromPositions(o);if(t.original.endLineNumberExclusive<=o.lineNumber){const n=o.lineNumber-t.original.endLineNumberExclusive+t.modified.endLineNumberExclusive;return L.fromPositions(new A(n,o.column))}if(!t.innerChanges)return L.fromPositions(new A(t.modified.startLineNumber,1));const i=JC(t.innerChanges,n=>n.originalRange.getStartPosition().isBeforeOrEqual(o));if(!i){const n=o.lineNumber-t.original.startLineNumber+t.modified.startLineNumber;return L.fromPositions(new A(n,o.column))}if(i.originalRange.containsPosition(o))return i.modifiedRange;{const n=dbe(i.originalRange.getEndPosition(),o);return L.fromPositions(n.addToPosition(i.modifiedRange.getEndPosition()))}}function dbe(o,e){return o.lineNumber===e.lineNumber?new Gr(0,e.column-o.column):new Gr(e.lineNumber-o.lineNumber,e.column-1)}function hbe(o,e){let t;return o.filter(i=>{const n=e(i,t);return t=i,n})}class aL{static create(e,t=void 0){return new D9(e,e,t)}static createWithDisposable(e,t,i=void 0){const n=new $;return n.add(t),n.add(e),new D9(e,n,i)}}class D9 extends aL{constructor(e,t,i){super(),this.object=e,this._disposable=t,this._debugOwner=i,this._refCount=1,this._isDisposed=!1,this._owners=[],i&&this._addOwner(i)}_addOwner(e){e&&this._owners.push(e)}createNewRef(e){return this._refCount++,e&&this._addOwner(e),new ube(this,e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._decreaseRefCount(this._debugOwner))}_decreaseRefCount(e){if(this._refCount--,this._refCount===0&&this._disposable.dispose(),e){const t=this._owners.indexOf(e);t!==-1&&this._owners.splice(t,1)}}}class ube extends aL{constructor(e,t){super(),this._base=e,this._debugOwner=t,this._isDisposed=!1}get object(){return this._base.object}createNewRef(e){return this._base.createNewRef(e)}dispose(){this._isDisposed||(this._isDisposed=!0,this._base._decreaseRefCount(this._debugOwner))}}var GB=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},$B=function(o,e){return function(t,i){e(t,i,o)}};const gbe=Gt("diff-review-insert",J.add,p("accessibleDiffViewerInsertIcon","Icon for 'Insert' in accessible diff viewer.")),fbe=Gt("diff-review-remove",J.remove,p("accessibleDiffViewerRemoveIcon","Icon for 'Remove' in accessible diff viewer.")),pbe=Gt("diff-review-close",J.close,p("accessibleDiffViewerCloseIcon","Icon for 'Close' in accessible diff viewer."));var i_;let ig=(i_=class extends F{constructor(e,t,i,n,s,r,a,l,c){super(),this._parentNode=e,this._visible=t,this._setVisible=i,this._canClose=n,this._width=s,this._height=r,this._diffs=a,this._models=l,this._instantiationService=c,this._state=Xh(this,(d,h)=>{const u=this._visible.read(d);if(this._parentNode.style.visibility=u?"visible":"hidden",!u)return null;const g=h.add(this._instantiationService.createInstance(cO,this._diffs,this._models,this._setVisible,this._canClose)),f=h.add(this._instantiationService.createInstance(dO,this._parentNode,g,this._width,this._height,this._models));return{model:g,view:f}}).recomputeInitiallyAndOnChange(this._store)}next(){oi(e=>{const t=this._visible.get();this._setVisible(!0,e),t&&this._state.get().model.nextGroup(e)})}prev(){oi(e=>{this._setVisible(!0,e),this._state.get().model.previousGroup(e)})}close(){oi(e=>{this._setVisible(!1,e)})}},i_._ttPolicy=nd("diffReview",{createHTML:e=>e}),i_);ig=GB([$B(8,Ce)],ig);let cO=class extends F{constructor(e,t,i,n,s){super(),this._diffs=e,this._models=t,this._setVisible=i,this.canClose=n,this._accessibilitySignalService=s,this._groups=$e(this,[]),this._currentGroupIdx=$e(this,0),this._currentElementIdx=$e(this,0),this.groups=this._groups,this.currentGroup=this._currentGroupIdx.map((r,a)=>this._groups.read(a)[r]),this.currentGroupIndex=this._currentGroupIdx,this.currentElement=this._currentElementIdx.map((r,a)=>this.currentGroup.read(a)?.lines[r]),this._register(Re(r=>{const a=this._diffs.read(r);if(!a){this._groups.set([],void 0);return}const l=mbe(a,this._models.getOriginalModel().getLineCount(),this._models.getModifiedModel().getLineCount());oi(c=>{const d=this._models.getModifiedPosition();if(d){const h=l.findIndex(u=>d?.lineNumber<u.range.modified.endLineNumberExclusive);h!==-1&&this._currentGroupIdx.set(h,c)}this._groups.set(l,c)})})),this._register(Re(r=>{const a=this.currentElement.read(r);a?.type===ns.Deleted?this._accessibilitySignalService.playSignal(xo.diffLineDeleted,{source:"accessibleDiffViewer.currentElementChanged"}):a?.type===ns.Added&&this._accessibilitySignalService.playSignal(xo.diffLineInserted,{source:"accessibleDiffViewer.currentElementChanged"})})),this._register(Re(r=>{const a=this.currentElement.read(r);if(a&&a.type!==ns.Header){const l=a.modifiedLineNumber??a.diff.modified.startLineNumber;this._models.modifiedSetSelection(L.fromPositions(new A(l,1)))}}))}_goToGroupDelta(e,t){const i=this.groups.get();!i||i.length<=1||kf(t,n=>{this._currentGroupIdx.set(je.ofLength(i.length).clipCyclic(this._currentGroupIdx.get()+e),n),this._currentElementIdx.set(0,n)})}nextGroup(e){this._goToGroupDelta(1,e)}previousGroup(e){this._goToGroupDelta(-1,e)}_goToLineDelta(e){const t=this.currentGroup.get();!t||t.lines.length<=1||oi(i=>{this._currentElementIdx.set(je.ofLength(t.lines.length).clip(this._currentElementIdx.get()+e),i)})}goToNextLine(){this._goToLineDelta(1)}goToPreviousLine(){this._goToLineDelta(-1)}goToLine(e){const t=this.currentGroup.get();if(!t)return;const i=t.lines.indexOf(e);i!==-1&&oi(n=>{this._currentElementIdx.set(i,n)})}revealCurrentElementInEditor(){if(!this.canClose.get())return;this._setVisible(!1,void 0);const e=this.currentElement.get();e&&(e.type===ns.Deleted?this._models.originalReveal(L.fromPositions(new A(e.originalLineNumber,1))):this._models.modifiedReveal(e.type!==ns.Header?L.fromPositions(new A(e.modifiedLineNumber,1)):void 0))}close(){this.canClose.get()&&(this._setVisible(!1,void 0),this._models.modifiedFocus())}};cO=GB([$B(4,Jh)],cO);const tv=3;function mbe(o,e,t){const i=[];for(const n of m4(o,(s,r)=>r.modified.startLineNumber-s.modified.endLineNumberExclusive<2*tv)){const s=[];s.push(new bbe);const r=new Be(Math.max(1,n[0].original.startLineNumber-tv),Math.min(n[n.length-1].original.endLineNumberExclusive+tv,e+1)),a=new Be(Math.max(1,n[0].modified.startLineNumber-tv),Math.min(n[n.length-1].modified.endLineNumberExclusive+tv,t+1));z6(n,(d,h)=>{const u=new Be(d?d.original.endLineNumberExclusive:r.startLineNumber,h?h.original.startLineNumber:r.endLineNumberExclusive),g=new Be(d?d.modified.endLineNumberExclusive:a.startLineNumber,h?h.modified.startLineNumber:a.endLineNumberExclusive);u.forEach(f=>{s.push(new ybe(f,g.startLineNumber+(f-u.startLineNumber)))}),h&&(h.original.forEach(f=>{s.push(new vbe(h,f))}),h.modified.forEach(f=>{s.push(new Cbe(h,f))}))});const l=n[0].modified.join(n[n.length-1].modified),c=n[0].original.join(n[n.length-1].original);i.push(new _be(new qn(l,c),s))}return i}var ns;(function(o){o[o.Header=0]="Header",o[o.Unchanged=1]="Unchanged",o[o.Deleted=2]="Deleted",o[o.Added=3]="Added"})(ns||(ns={}));class _be{constructor(e,t){this.range=e,this.lines=t}}class bbe{constructor(){this.type=ns.Header}}class vbe{constructor(e,t){this.diff=e,this.originalLineNumber=t,this.type=ns.Deleted,this.modifiedLineNumber=void 0}}class Cbe{constructor(e,t){this.diff=e,this.modifiedLineNumber=t,this.type=ns.Added,this.originalLineNumber=void 0}}class ybe{constructor(e,t){this.originalLineNumber=e,this.modifiedLineNumber=t,this.type=ns.Unchanged}}let dO=class extends F{constructor(e,t,i,n,s,r){super(),this._element=e,this._model=t,this._width=i,this._height=n,this._models=s,this._languageService=r,this.domNode=this._element,this.domNode.className="monaco-component diff-review monaco-editor-background";const a=document.createElement("div");a.className="diff-review-actions",this._actionBar=this._register(new Oo(a)),this._register(Re(l=>{this._actionBar.clear(),this._model.canClose.read(l)&&this._actionBar.push(new to("diffreview.close",p("label.close","Close"),"close-diff-review "+ke.asClassName(pbe),!0,async()=>t.close()),{label:!1,icon:!0})})),this._content=document.createElement("div"),this._content.className="diff-review-content",this._content.setAttribute("role","code"),this._scrollbar=this._register(new Iw(this._content,{})),pn(this.domNode,this._scrollbar.getDomNode(),a),this._register(Re(l=>{this._height.read(l),this._width.read(l),this._scrollbar.scanDomNode()})),this._register(ve(()=>{pn(this.domNode)})),this._register(Yc(this.domNode,{width:this._width,height:this._height})),this._register(Yc(this._content,{width:this._width,height:this._height})),this._register(Is((l,c)=>{this._model.currentGroup.read(l),this._render(c)})),this._register(ci(this.domNode,"keydown",l=>{(l.equals(18)||l.equals(2066)||l.equals(530))&&(l.preventDefault(),this._model.goToNextLine()),(l.equals(16)||l.equals(2064)||l.equals(528))&&(l.preventDefault(),this._model.goToPreviousLine()),(l.equals(9)||l.equals(2057)||l.equals(521)||l.equals(1033))&&(l.preventDefault(),this._model.close()),(l.equals(10)||l.equals(3))&&(l.preventDefault(),this._model.revealCurrentElementInEditor())}))}_render(e){const t=this._models.getOriginalOptions(),i=this._models.getModifiedOptions(),n=document.createElement("div");n.className="diff-review-table",n.setAttribute("role","list"),n.setAttribute("aria-label",p("ariaLabel","Accessible Diff Viewer. Use arrow up and down to navigate.")),mn(n,i.get(50)),pn(this._content,n);const s=this._models.getOriginalModel(),r=this._models.getModifiedModel();if(!s||!r)return;const a=s.getOptions(),l=r.getOptions(),c=i.get(67),d=this._model.currentGroup.get();for(const h of d?.lines||[]){if(!d)break;let u;if(h.type===ns.Header){const f=document.createElement("div");f.className="diff-review-row",f.setAttribute("role","listitem");const m=d.range,_=this._model.currentGroupIndex.get(),b=this._model.groups.get().length,v=x=>x===0?p("no_lines_changed","no lines changed"):x===1?p("one_line_changed","1 line changed"):p("more_lines_changed","{0} lines changed",x),y=v(m.original.length),C=v(m.modified.length);f.setAttribute("aria-label",p({key:"header",comment:["This is the ARIA label for a git diff header.","A git diff header looks like this: @@ -154,12 +159,39 @@.","That encodes that at original line 154 (which is now line 159), 12 lines were removed/changed with 39 lines.","Variables 0 and 1 refer to the diff index out of total number of diffs.","Variables 2 and 4 will be numbers (a line number).",'Variables 3 and 5 will be "no lines changed", "1 line changed" or "X lines changed", localized separately.']},"Difference {0} of {1}: original line {2}, {3}, modified line {4}, {5}",_+1,b,m.original.startLineNumber,y,m.modified.startLineNumber,C));const w=document.createElement("div");w.className="diff-review-cell diff-review-summary",w.appendChild(document.createTextNode(`${_+1}/${b}: @@ -${m.original.startLineNumber},${m.original.length} +${m.modified.startLineNumber},${m.modified.length} @@`)),f.appendChild(w),u=f}else u=this._createRow(h,c,this._width.get(),t,s,a,i,r,l);n.appendChild(u);const g=me(f=>this._model.currentElement.read(f)===h);e.add(Re(f=>{const m=g.read(f);u.tabIndex=m?0:-1,m&&u.focus()})),e.add(H(u,"focus",()=>{this._model.goToLine(h)}))}this._scrollbar.scanDomNode()}_createRow(e,t,i,n,s,r,a,l,c){const d=n.get(146),h=d.glyphMarginWidth+d.lineNumbersWidth,u=a.get(146),g=10+u.glyphMarginWidth+u.lineNumbersWidth;let f="diff-review-row",m="";const _="diff-review-spacer";let b=null;switch(e.type){case ns.Added:f="diff-review-row line-insert",m=" char-insert",b=gbe;break;case ns.Deleted:f="diff-review-row line-delete",m=" char-delete",b=fbe;break}const v=document.createElement("div");v.style.minWidth=i+"px",v.className=f,v.setAttribute("role","listitem"),v.ariaLevel="";const y=document.createElement("div");y.className="diff-review-cell",y.style.height=`${t}px`,v.appendChild(y);const C=document.createElement("span");C.style.width=h+"px",C.style.minWidth=h+"px",C.className="diff-review-line-number"+m,e.originalLineNumber!==void 0?C.appendChild(document.createTextNode(String(e.originalLineNumber))):C.innerText=" ",y.appendChild(C);const w=document.createElement("span");w.style.width=g+"px",w.style.minWidth=g+"px",w.style.paddingRight="10px",w.className="diff-review-line-number"+m,e.modifiedLineNumber!==void 0?w.appendChild(document.createTextNode(String(e.modifiedLineNumber))):w.innerText=" ",y.appendChild(w);const x=document.createElement("span");if(x.className=_,b){const N=document.createElement("span");N.className=ke.asClassName(b),N.innerText="  ",x.appendChild(N)}else x.innerText="  ";y.appendChild(x);let k;if(e.modifiedLineNumber!==void 0){let N=this._getLineHtml(l,a,c.tabSize,e.modifiedLineNumber,this._languageService.languageIdCodec);ig._ttPolicy&&(N=ig._ttPolicy.createHTML(N)),y.insertAdjacentHTML("beforeend",N),k=l.getLineContent(e.modifiedLineNumber)}else{let N=this._getLineHtml(s,n,r.tabSize,e.originalLineNumber,this._languageService.languageIdCodec);ig._ttPolicy&&(N=ig._ttPolicy.createHTML(N)),y.insertAdjacentHTML("beforeend",N),k=s.getLineContent(e.originalLineNumber)}k.length===0&&(k=p("blankLine","blank"));let E="";switch(e.type){case ns.Unchanged:e.originalLineNumber===e.modifiedLineNumber?E=p({key:"unchangedLine",comment:["The placeholders are contents of the line and should not be translated."]},"{0} unchanged line {1}",k,e.originalLineNumber):E=p("equalLine","{0} original line {1} modified line {2}",k,e.originalLineNumber,e.modifiedLineNumber);break;case ns.Added:E=p("insertLine","+ {0} modified line {1}",k,e.modifiedLineNumber);break;case ns.Deleted:E=p("deleteLine","- {0} original line {1}",k,e.originalLineNumber);break}return v.setAttribute("aria-label",E),v}_getLineHtml(e,t,i,n,s){const r=e.getLineContent(n),a=t.get(50),l=an.createEmpty(r,s),c=Vo.isBasicASCII(r,e.mightContainNonBasicASCII()),d=Vo.containsRTL(r,c,e.mightContainRTL());return iD(new eu(a.isMonospace&&!t.get(33),a.canUseHalfwidthRightwardsArrow,r,!1,c,d,0,l,[],i,0,a.spaceWidth,a.middotWidth,a.wsmiddotWidth,t.get(118),t.get(100),t.get(95),t.get(51)!==kh.OFF,null)).html}};dO=GB([$B(5,ti)],dO);class wbe{constructor(e){this.editors=e}getOriginalModel(){return this.editors.original.getModel()}getOriginalOptions(){return this.editors.original.getOptions()}originalReveal(e){this.editors.original.revealRange(e),this.editors.original.setSelection(e),this.editors.original.focus()}getModifiedModel(){return this.editors.modified.getModel()}getModifiedOptions(){return this.editors.modified.getOptions()}modifiedReveal(e){e&&(this.editors.modified.revealRange(e),this.editors.modified.setSelection(e)),this.editors.modified.focus()}modifiedSetSelection(e){this.editors.modified.setSelection(e)}modifiedFocus(){this.editors.modified.focus()}getModifiedPosition(){return this.editors.modified.getPosition()??void 0}}D("diffEditor.move.border","#8b8b8b9c",p("diffEditor.move.border","The border color for text that got moved in the diff editor."));D("diffEditor.moveActive.border","#FFA500",p("diffEditor.moveActive.border","The active border color for text that got moved in the diff editor."));D("diffEditor.unchangedRegionShadow",{dark:"#000000",light:"#737373BF",hcDark:"#000000",hcLight:"#737373BF"},p("diffEditor.unchangedRegionShadow","The color of the shadow around unchanged region widgets."));const Sbe=Gt("diff-insert",J.add,p("diffInsertIcon","Line decoration for inserts in the diff editor.")),rj=Gt("diff-remove",J.remove,p("diffRemoveIcon","Line decoration for removals in the diff editor.")),lL=Fe.register({className:"line-insert",description:"line-insert",isWholeLine:!0,linesDecorationsClassName:"insert-sign "+ke.asClassName(Sbe),marginClassName:"gutter-insert"}),Wy=Fe.register({className:"line-delete",description:"line-delete",isWholeLine:!0,linesDecorationsClassName:"delete-sign "+ke.asClassName(rj),marginClassName:"gutter-delete"}),I9=Fe.register({className:"line-insert",description:"line-insert",isWholeLine:!0,marginClassName:"gutter-insert"}),N9=Fe.register({className:"line-delete",description:"line-delete",isWholeLine:!0,marginClassName:"gutter-delete"}),cL=Fe.register({className:"char-insert",description:"char-insert",shouldFillLineOnLineBreak:!0}),KB=Fe.register({className:"char-insert",description:"char-insert",isWholeLine:!0}),jB=Fe.register({className:"char-insert diff-range-empty",description:"char-insert diff-range-empty"}),F_=Fe.register({className:"char-delete",description:"char-delete",shouldFillLineOnLineBreak:!0}),qB=Fe.register({className:"char-delete",description:"char-delete",isWholeLine:!0}),ZB=Fe.register({className:"char-delete diff-range-empty",description:"char-delete diff-range-empty"});var aj=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},hO=function(o,e){return function(t,i){e(t,i,o)}},Tu;const jw=Je("diffProviderFactoryService");let uO=class{constructor(e){this.instantiationService=e}createDiffProvider(e){return this.instantiationService.createInstance(gO,e)}};uO=aj([hO(0,Ce)],uO);it(jw,uO,1);var Lg;let gO=(Lg=class{constructor(e,t,i){this.editorWorkerService=t,this.telemetryService=i,this.onDidChangeEventEmitter=new O,this.onDidChange=this.onDidChangeEventEmitter.event,this.diffAlgorithm="advanced",this.diffAlgorithmOnDidChangeSubscription=void 0,this.setOptions(e)}dispose(){this.diffAlgorithmOnDidChangeSubscription?.dispose()}async computeDiff(e,t,i,n){if(typeof this.diffAlgorithm!="string")return this.diffAlgorithm.computeDiff(e,t,i,n);if(e.isDisposed()||t.isDisposed())return{changes:[],identical:!0,quitEarly:!1,moves:[]};if(e.getLineCount()===1&&e.getLineMaxColumn(1)===1)return t.getLineCount()===1&&t.getLineMaxColumn(1)===1?{changes:[],identical:!0,quitEarly:!1,moves:[]}:{changes:[new Mo(new Be(1,2),new Be(1,t.getLineCount()+1),[new So(e.getFullModelRange(),t.getFullModelRange())])],identical:!1,quitEarly:!1,moves:[]};const s=JSON.stringify([e.uri.toString(),t.uri.toString()]),r=JSON.stringify([e.id,t.id,e.getAlternativeVersionId(),t.getAlternativeVersionId(),JSON.stringify(i)]),a=Tu.diffCache.get(s);if(a&&a.context===r)return a.result;const l=rn.create(),c=await this.editorWorkerService.computeDiff(e.uri,t.uri,i,this.diffAlgorithm),d=l.elapsed();if(this.telemetryService.publicLog2("diffEditor.computeDiff",{timeMs:d,timedOut:c?.quitEarly??!0,detectedMoves:i.computeMoves?c?.moves.length??0:-1}),n.isCancellationRequested)return{changes:[],identical:!1,quitEarly:!0,moves:[]};if(!c)throw new Error("no diff result available");return Tu.diffCache.size>10&&Tu.diffCache.delete(Tu.diffCache.keys().next().value),Tu.diffCache.set(s,{result:c,context:r}),c}setOptions(e){let t=!1;e.diffAlgorithm&&this.diffAlgorithm!==e.diffAlgorithm&&(this.diffAlgorithmOnDidChangeSubscription?.dispose(),this.diffAlgorithmOnDidChangeSubscription=void 0,this.diffAlgorithm=e.diffAlgorithm,typeof e.diffAlgorithm!="string"&&(this.diffAlgorithmOnDidChangeSubscription=e.diffAlgorithm.onDidChange(()=>this.onDidChangeEventEmitter.fire())),t=!0),t&&this.onDidChangeEventEmitter.fire()}},Tu=Lg,Lg.diffCache=new Map,Lg);gO=Tu=aj([hO(1,Bs),hO(2,Fn)],gO);function cD(){return tR&&!!tR.VSCODE_DEV}function lj(o){if(cD()){const e=xbe();return e.add(o),{dispose(){e.delete(o)}}}else return{dispose(){}}}function xbe(){e1||(e1=new Set);const o=globalThis;return o.$hotReload_applyNewExports||(o.$hotReload_applyNewExports=e=>{const t={config:{mode:void 0},...e},i=[];for(const n of e1){const s=n(t);s&&i.push(s)}if(i.length>0)return n=>{let s=!1;for(const r of i)r(n)&&(s=!0);return s}}),e1}let e1;cD()&&lj(({oldExports:o,newSrc:e,config:t})=>{if(t.mode==="patch-prototype")return i=>{for(const n in i){const s=i[n];if(console.log(`[hot-reload] Patching prototype methods of '${n}'`,{exportedItem:s}),typeof s=="function"&&s.prototype){const r=o[n];if(r){for(const a of Object.getOwnPropertyNames(s.prototype)){const l=Object.getOwnPropertyDescriptor(s.prototype,a),c=Object.getOwnPropertyDescriptor(r.prototype,a);l?.value?.toString()!==c?.value?.toString()&&console.log(`[hot-reload] Patching prototype method '${n}.${a}'`),Object.defineProperty(r.prototype,a,l)}i[n]=r}}}return!0}});function qs(o,e){return Lbe([o],e),o}function Lbe(o,e){cD()&&Sn("reload",i=>lj(({oldExports:n})=>{if([...Object.values(n)].some(s=>o.includes(s)))return s=>(i(void 0),!0)})).read(e)}var kbe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ebe=function(o,e){return function(t,i){e(t,i,o)}};let fO=class extends F{setActiveMovedText(e){this._activeMovedText.set(e,void 0)}constructor(e,t,i){super(),this.model=e,this._options=t,this._diffProviderFactoryService=i,this._isDiffUpToDate=$e(this,!1),this.isDiffUpToDate=this._isDiffUpToDate,this._diff=$e(this,void 0),this.diff=this._diff,this._unchangedRegions=$e(this,void 0),this.unchangedRegions=me(this,a=>this._options.hideUnchangedRegions.read(a)?this._unchangedRegions.read(a)?.regions??[]:(oi(l=>{for(const c of this._unchangedRegions.get()?.regions||[])c.collapseAll(l)}),[])),this.movedTextToCompare=$e(this,void 0),this._activeMovedText=$e(this,void 0),this._hoveredMovedText=$e(this,void 0),this.activeMovedText=me(this,a=>this.movedTextToCompare.read(a)??this._hoveredMovedText.read(a)??this._activeMovedText.read(a)),this._cancellationTokenSource=new ri,this._diffProvider=me(this,a=>{const l=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:this._options.diffAlgorithm.read(a)}),c=Sn("onDidChange",l.onDidChange);return{diffProvider:l,onChangeSignal:c}}),this._register(ve(()=>this._cancellationTokenSource.cancel()));const n=gb("contentChangedSignal"),s=this._register(new xt(()=>n.trigger(void 0),200));this._register(Re(a=>{const l=this._unchangedRegions.read(a);if(!l||l.regions.some(f=>f.isDragged.read(a)))return;const c=l.originalDecorationIds.map(f=>e.original.getDecorationRange(f)).map(f=>f?Be.fromRangeInclusive(f):void 0),d=l.modifiedDecorationIds.map(f=>e.modified.getDecorationRange(f)).map(f=>f?Be.fromRangeInclusive(f):void 0),h=l.regions.map((f,m)=>!c[m]||!d[m]?void 0:new Yd(c[m].startLineNumber,d[m].startLineNumber,c[m].length,f.visibleLineCountTop.read(a),f.visibleLineCountBottom.read(a))).filter(Sl),u=[];let g=!1;for(const f of m4(h,(m,_)=>m.getHiddenModifiedRange(a).endLineNumberExclusive===_.getHiddenModifiedRange(a).startLineNumber))if(f.length>1){g=!0;const m=f.reduce((b,v)=>b+v.lineCount,0),_=new Yd(f[0].originalLineNumber,f[0].modifiedLineNumber,m,f[0].visibleLineCountTop.get(),f[f.length-1].visibleLineCountBottom.get());u.push(_)}else u.push(f[0]);if(g){const f=e.original.deltaDecorations(l.originalDecorationIds,u.map(_=>({range:_.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),m=e.modified.deltaDecorations(l.modifiedDecorationIds,u.map(_=>({range:_.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));oi(_=>{this._unchangedRegions.set({regions:u,originalDecorationIds:f,modifiedDecorationIds:m},_)})}}));const r=(a,l,c)=>{const d=Yd.fromDiffs(a.changes,e.original.getLineCount(),e.modified.getLineCount(),this._options.hideUnchangedRegionsMinimumLineCount.read(c),this._options.hideUnchangedRegionsContextLineCount.read(c));let h;const u=this._unchangedRegions.get();if(u){const _=u.originalDecorationIds.map(C=>e.original.getDecorationRange(C)).map(C=>C?Be.fromRangeInclusive(C):void 0),b=u.modifiedDecorationIds.map(C=>e.modified.getDecorationRange(C)).map(C=>C?Be.fromRangeInclusive(C):void 0);let y=hbe(u.regions.map((C,w)=>{if(!_[w]||!b[w])return;const x=_[w].length;return new Yd(_[w].startLineNumber,b[w].startLineNumber,x,Math.min(C.visibleLineCountTop.get(),x),Math.min(C.visibleLineCountBottom.get(),x-C.visibleLineCountTop.get()))}).filter(Sl),(C,w)=>!w||C.modifiedLineNumber>=w.modifiedLineNumber+w.lineCount&&C.originalLineNumber>=w.originalLineNumber+w.lineCount).map(C=>new qn(C.getHiddenOriginalRange(c),C.getHiddenModifiedRange(c)));y=qn.clip(y,Be.ofLength(1,e.original.getLineCount()),Be.ofLength(1,e.modified.getLineCount())),h=qn.inverse(y,e.original.getLineCount(),e.modified.getLineCount())}const g=[];if(h)for(const _ of d){const b=h.filter(v=>v.original.intersectsStrict(_.originalUnchangedRange)&&v.modified.intersectsStrict(_.modifiedUnchangedRange));g.push(..._.setVisibleRanges(b,l))}else g.push(...d);const f=e.original.deltaDecorations(u?.originalDecorationIds||[],g.map(_=>({range:_.originalUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}}))),m=e.modified.deltaDecorations(u?.modifiedDecorationIds||[],g.map(_=>({range:_.modifiedUnchangedRange.toInclusiveRange(),options:{description:"unchanged"}})));this._unchangedRegions.set({regions:g,originalDecorationIds:f,modifiedDecorationIds:m},l)};this._register(e.modified.onDidChangeContent(a=>{if(this._diff.get()){const c=Tc.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(e.original.onDidChangeContent(a=>{if(this._diff.get()){const c=Tc.fromModelContentChanges(a.changes);this._lastDiff,e.original,e.modified}this._isDiffUpToDate.set(!1,void 0),s.schedule()})),this._register(Is(async(a,l)=>{this._options.hideUnchangedRegionsMinimumLineCount.read(a),this._options.hideUnchangedRegionsContextLineCount.read(a),s.cancel(),n.read(a);const c=this._diffProvider.read(a);c.onChangeSignal.read(a),qs(RU,a),qs(TP,a),this._isDiffUpToDate.set(!1,void 0);let d=[];l.add(e.original.onDidChangeContent(g=>{const f=Tc.fromModelContentChanges(g.changes);d=yx(d,f)}));let h=[];l.add(e.modified.onDidChangeContent(g=>{const f=Tc.fromModelContentChanges(g.changes);h=yx(h,f)}));let u=await c.diffProvider.computeDiff(e.original,e.modified,{ignoreTrimWhitespace:this._options.ignoreTrimWhitespace.read(a),maxComputationTimeMs:this._options.maxComputationTimeMs.read(a),computeMoves:this._options.showMoves.read(a)},this._cancellationTokenSource.token);this._cancellationTokenSource.token.isCancellationRequested||e.original.isDisposed()||e.modified.isDisposed()||(u=Tbe(u,e.original,e.modified),u=(e.original,e.modified,void 0)??u,u=(e.original,e.modified,void 0)??u,oi(g=>{r(u,g),this._lastDiff=u;const f=YB.fromDiffResult(u);this._diff.set(f,g),this._isDiffUpToDate.set(!0,g);const m=this.movedTextToCompare.get();this.movedTextToCompare.set(m?this._lastDiff.moves.find(_=>_.lineRangeMapping.modified.intersect(m.lineRangeMapping.modified)):void 0,g)}))}))}ensureModifiedLineIsVisible(e,t,i){if(this.diff.get()?.mappings.length===0)return;const n=this._unchangedRegions.get()?.regions||[];for(const s of n)if(s.getHiddenModifiedRange(void 0).contains(e)){s.showModifiedLine(e,t,i);return}}ensureOriginalLineIsVisible(e,t,i){if(this.diff.get()?.mappings.length===0)return;const n=this._unchangedRegions.get()?.regions||[];for(const s of n)if(s.getHiddenOriginalRange(void 0).contains(e)){s.showOriginalLine(e,t,i);return}}async waitForDiff(){await YG(this.isDiffUpToDate,e=>e)}serializeState(){return{collapsedRegions:this._unchangedRegions.get()?.regions.map(t=>({range:t.getHiddenModifiedRange(void 0).serialize()}))}}restoreSerializedState(e){const t=e.collapsedRegions?.map(n=>Be.deserialize(n.range)),i=this._unchangedRegions.get();!i||!t||oi(n=>{for(const s of i.regions)for(const r of t)if(s.modifiedUnchangedRange.intersect(r)){s.setHiddenModifiedRange(r,n);break}})}};fO=kbe([Ebe(2,jw)],fO);function Tbe(o,e,t){return{changes:o.changes.map(i=>new Mo(i.original,i.modified,i.innerChanges?i.innerChanges.map(n=>Dbe(n,e,t)):void 0)),moves:o.moves,identical:o.identical,quitEarly:o.quitEarly}}function Dbe(o,e,t){let i=o.originalRange,n=o.modifiedRange;return i.startColumn===1&&n.startColumn===1&&(i.endColumn!==1||n.endColumn!==1)&&i.endColumn===e.getLineMaxColumn(i.endLineNumber)&&n.endColumn===t.getLineMaxColumn(n.endLineNumber)&&i.endLineNumber<e.getLineCount()&&n.endLineNumber<t.getLineCount()&&(i=i.setEndPosition(i.endLineNumber+1,1),n=n.setEndPosition(n.endLineNumber+1,1)),new So(i,n)}class YB{static fromDiffResult(e){return new YB(e.changes.map(t=>new cj(t)),e.moves||[],e.identical,e.quitEarly)}constructor(e,t,i,n){this.mappings=e,this.movedTexts=t,this.identical=i,this.quitEarly=n}}class cj{constructor(e){this.lineRangeMapping=e}}class Yd{static fromDiffs(e,t,i,n,s){const r=Mo.inverse(e,t,i),a=[];for(const l of r){let c=l.original.startLineNumber,d=l.modified.startLineNumber,h=l.original.length;const u=c===1&&d===1,g=c+h===t+1&&d+h===i+1;(u||g)&&h>=s+n?(u&&!g&&(h-=s),g&&!u&&(c+=s,d+=s,h-=s),a.push(new Yd(c,d,h,0,0))):h>=s*2+n&&(c+=s,d+=s,h-=s*2,a.push(new Yd(c,d,h,0,0)))}return a}get originalUnchangedRange(){return Be.ofLength(this.originalLineNumber,this.lineCount)}get modifiedUnchangedRange(){return Be.ofLength(this.modifiedLineNumber,this.lineCount)}constructor(e,t,i,n,s){this.originalLineNumber=e,this.modifiedLineNumber=t,this.lineCount=i,this._visibleLineCountTop=$e(this,0),this.visibleLineCountTop=this._visibleLineCountTop,this._visibleLineCountBottom=$e(this,0),this.visibleLineCountBottom=this._visibleLineCountBottom,this._shouldHideControls=me(this,l=>this.visibleLineCountTop.read(l)+this.visibleLineCountBottom.read(l)===this.lineCount&&!this.isDragged.read(l)),this.isDragged=$e(this,void 0);const r=Math.max(Math.min(n,this.lineCount),0),a=Math.max(Math.min(s,this.lineCount-n),0);K3(n===r),K3(s===a),this._visibleLineCountTop.set(r,void 0),this._visibleLineCountBottom.set(a,void 0)}setVisibleRanges(e,t){const i=[],n=new sr(e.map(l=>l.modified)).subtractFrom(this.modifiedUnchangedRange);let s=this.originalLineNumber,r=this.modifiedLineNumber;const a=this.modifiedLineNumber+this.lineCount;if(n.ranges.length===0)this.showAll(t),i.push(this);else{let l=0;for(const c of n.ranges){const d=l===n.ranges.length-1;l++;const h=(d?a:c.endLineNumberExclusive)-r,u=new Yd(s,r,h,0,0);u.setHiddenModifiedRange(c,t),i.push(u),s=u.originalUnchangedRange.endLineNumberExclusive,r=u.modifiedUnchangedRange.endLineNumberExclusive}}return i}shouldHideControls(e){return this._shouldHideControls.read(e)}getHiddenOriginalRange(e){return Be.ofLength(this.originalLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}getHiddenModifiedRange(e){return Be.ofLength(this.modifiedLineNumber+this._visibleLineCountTop.read(e),this.lineCount-this._visibleLineCountTop.read(e)-this._visibleLineCountBottom.read(e))}setHiddenModifiedRange(e,t){const i=e.startLineNumber-this.modifiedLineNumber,n=this.modifiedLineNumber+this.lineCount-e.endLineNumberExclusive;this.setState(i,n,t)}getMaxVisibleLineCountTop(){return this.lineCount-this._visibleLineCountBottom.get()}getMaxVisibleLineCountBottom(){return this.lineCount-this._visibleLineCountTop.get()}showMoreAbove(e=10,t){const i=this.getMaxVisibleLineCountTop();this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+e,i),t)}showMoreBelow(e=10,t){const i=this.lineCount-this._visibleLineCountTop.get();this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+e,i),t)}showAll(e){this._visibleLineCountBottom.set(this.lineCount-this._visibleLineCountTop.get(),e)}showModifiedLine(e,t,i){const n=e+1-(this.modifiedLineNumber+this._visibleLineCountTop.get()),s=this.modifiedLineNumber-this._visibleLineCountBottom.get()+this.lineCount-e;t===0&&n<s||t===1?this._visibleLineCountTop.set(this._visibleLineCountTop.get()+n,i):this._visibleLineCountBottom.set(this._visibleLineCountBottom.get()+s,i)}showOriginalLine(e,t,i){const n=e-this.originalLineNumber,s=this.originalLineNumber+this.lineCount-e;t===0&&n<s||t===1?this._visibleLineCountTop.set(Math.min(this._visibleLineCountTop.get()+s-n,this.getMaxVisibleLineCountTop()),i):this._visibleLineCountBottom.set(Math.min(this._visibleLineCountBottom.get()+n-s,this.getMaxVisibleLineCountBottom()),i)}collapseAll(e){this._visibleLineCountTop.set(0,e),this._visibleLineCountBottom.set(0,e)}setState(e,t,i){e=Math.max(Math.min(e,this.lineCount),0),t=Math.max(Math.min(t,this.lineCount-e),0),this._visibleLineCountTop.set(e,i),this._visibleLineCountBottom.set(t,i)}}class Ibe extends F{get visibility(){return this._visibility}set visibility(e){this._visibility!==e&&(this._visibility=e,this._diffActions.style.visibility=e?"visible":"hidden")}constructor(e,t,i,n,s,r,a,l,c){super(),this._getViewZoneId=e,this._marginDomNode=t,this._modifiedEditor=i,this._diff=n,this._editor=s,this._viewLineCounts=r,this._originalTextModel=a,this._contextMenuService=l,this._clipboardService=c,this._visibility=!1,this._marginDomNode.style.zIndex="10",this._diffActions=document.createElement("div"),this._diffActions.className=ke.asClassName(J.lightBulb)+" lightbulb-glyph",this._diffActions.style.position="absolute";const d=this._modifiedEditor.getOption(67);this._diffActions.style.right="0px",this._diffActions.style.visibility="hidden",this._diffActions.style.height=`${d}px`,this._diffActions.style.lineHeight=`${d}px`,this._marginDomNode.appendChild(this._diffActions);let h=0;const u=i.getOption(128)&&!Ta,g=(f,m)=>{this._contextMenuService.showContextMenu({domForShadowRoot:u?i.getDomNode()??void 0:void 0,getAnchor:()=>({x:f,y:m}),getActions:()=>{const _=[],b=n.modified.isEmpty;return _.push(new to("diff.clipboard.copyDeletedContent",b?n.original.length>1?p("diff.clipboard.copyDeletedLinesContent.label","Copy deleted lines"):p("diff.clipboard.copyDeletedLinesContent.single.label","Copy deleted line"):n.original.length>1?p("diff.clipboard.copyChangedLinesContent.label","Copy changed lines"):p("diff.clipboard.copyChangedLinesContent.single.label","Copy changed line"),void 0,!0,async()=>{const y=this._originalTextModel.getValueInRange(n.original.toExclusiveRange());await this._clipboardService.writeText(y)})),n.original.length>1&&_.push(new to("diff.clipboard.copyDeletedLineContent",b?p("diff.clipboard.copyDeletedLineContent.label","Copy deleted line ({0})",n.original.startLineNumber+h):p("diff.clipboard.copyChangedLineContent.label","Copy changed line ({0})",n.original.startLineNumber+h),void 0,!0,async()=>{let y=this._originalTextModel.getLineContent(n.original.startLineNumber+h);y===""&&(y=this._originalTextModel.getEndOfLineSequence()===0?`
`:`\r
`),await this._clipboardService.writeText(y)})),i.getOption(92)||_.push(new to("diff.inline.revertChange",p("diff.inline.revertChange.label","Revert this change"),void 0,!0,async()=>{this._editor.revert(this._diff)})),_},autoSelectFirstItem:!0})};this._register(ci(this._diffActions,"mousedown",f=>{if(!f.leftButton)return;const{top:m,height:_}=Ci(this._diffActions),b=Math.floor(d/3);f.preventDefault(),g(f.posx,m+_+b)})),this._register(i.onMouseMove(f=>{(f.target.type===8||f.target.type===5)&&f.target.detail.viewZoneId===this._getViewZoneId()?(h=this._updateLightBulbPosition(this._marginDomNode,f.event.browserEvent.y,d),this.visibility=!0):this.visibility=!1})),this._register(i.onMouseDown(f=>{f.event.leftButton&&(f.target.type===8||f.target.type===5)&&f.target.detail.viewZoneId===this._getViewZoneId()&&(f.event.preventDefault(),h=this._updateLightBulbPosition(this._marginDomNode,f.event.browserEvent.y,d),g(f.event.posx,f.event.posy+d))}))}_updateLightBulbPosition(e,t,i){const{top:n}=Ci(e),s=t-n,r=Math.floor(s/i),a=r*i;if(this._diffActions.style.top=`${a}px`,this._viewLineCounts){let l=0;for(let c=0;c<this._viewLineCounts.length;c++)if(l+=this._viewLineCounts[c],r<l)return c}return r}}const R9=nd("diffEditorWidget",{createHTML:o=>o});function Nbe(o,e,t,i){mn(i,e.fontInfo);const n=t.length>0,s=new rb(1e4);let r=0,a=0;const l=[];for(let u=0;u<o.lineTokens.length;u++){const g=u+1,f=o.lineTokens[u],m=o.lineBreakData[u],_=as.filter(t,g,1,Number.MAX_SAFE_INTEGER);if(m){let b=0;for(const v of m.breakOffsets){const y=f.sliceAndInflate(b,v,0);r=Math.max(r,P9(a,y,as.extractWrapped(_,b,v),n,o.mightContainNonBasicASCII,o.mightContainRTL,e,s)),a++,b=v}l.push(m.breakOffsets.length)}else l.push(1),r=Math.max(r,P9(a,f,_,n,o.mightContainNonBasicASCII,o.mightContainRTL,e,s)),a++}r+=e.scrollBeyondLastColumn;const c=s.build(),d=R9?R9.createHTML(c):c;i.innerHTML=d;const h=r*e.typicalHalfwidthCharacterWidth;return{heightInLines:a,minWidthInPx:h,viewLineCounts:l}}class Rbe{constructor(e,t,i,n){this.lineTokens=e,this.lineBreakData=t,this.mightContainNonBasicASCII=i,this.mightContainRTL=n}}class XB{static fromEditor(e){const t=e.getOptions(),i=t.get(50),n=t.get(146);return new XB(e.getModel()?.getOptions().tabSize||0,i,t.get(33),i.typicalHalfwidthCharacterWidth,t.get(105),t.get(67),n.decorationsWidth,t.get(118),t.get(100),t.get(95),t.get(51))}constructor(e,t,i,n,s,r,a,l,c,d,h){this.tabSize=e,this.fontInfo=t,this.disableMonospaceOptimizations=i,this.typicalHalfwidthCharacterWidth=n,this.scrollBeyondLastColumn=s,this.lineHeight=r,this.lineDecorationsWidth=a,this.stopRenderingLineAfter=l,this.renderWhitespace=c,this.renderControlCharacters=d,this.fontLigatures=h}}function P9(o,e,t,i,n,s,r,a){a.appendString('<div class="view-line'),i||a.appendString(" char-delete"),a.appendString('" style="top:'),a.appendString(String(o*r.lineHeight)),a.appendString('px;width:1000000px;">');const l=e.getLineContent(),c=Vo.isBasicASCII(l,n),d=Vo.containsRTL(l,c,s),h=$w(new eu(r.fontInfo.isMonospace&&!r.disableMonospaceOptimizations,r.fontInfo.canUseHalfwidthRightwardsArrow,l,!1,c,d,0,e,t,r.tabSize,0,r.fontInfo.spaceWidth,r.fontInfo.middotWidth,r.fontInfo.wsmiddotWidth,r.stopRenderingLineAfter,r.renderWhitespace,r.renderControlCharacters,r.fontLigatures!==kh.OFF,null),a);return a.appendString("</div>"),h.characterMapping.getHorizontalOffset(h.characterMapping.length)}var Pbe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},A9=function(o,e){return function(t,i){e(t,i,o)}};let pO=class extends F{constructor(e,t,i,n,s,r,a,l,c,d){super(),this._targetWindow=e,this._editors=t,this._diffModel=i,this._options=n,this._diffEditorWidget=s,this._canIgnoreViewZoneUpdateEvent=r,this._origViewZonesToIgnore=a,this._modViewZonesToIgnore=l,this._clipboardService=c,this._contextMenuService=d,this._originalTopPadding=$e(this,0),this._originalScrollOffset=$e(this,0),this._originalScrollOffsetAnimated=E9(this._targetWindow,this._originalScrollOffset,this._store),this._modifiedTopPadding=$e(this,0),this._modifiedScrollOffset=$e(this,0),this._modifiedScrollOffsetAnimated=E9(this._targetWindow,this._modifiedScrollOffset,this._store);const h=$e("invalidateAlignmentsState",0),u=this._register(new xt(()=>{h.set(h.get()+1,void 0)},0));this._register(this._editors.original.onDidChangeViewZones(y=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.modified.onDidChangeViewZones(y=>{this._canIgnoreViewZoneUpdateEvent()||u.schedule()})),this._register(this._editors.original.onDidChangeConfiguration(y=>{(y.hasChanged(147)||y.hasChanged(67))&&u.schedule()})),this._register(this._editors.modified.onDidChangeConfiguration(y=>{(y.hasChanged(147)||y.hasChanged(67))&&u.schedule()}));const g=this._diffModel.map(y=>y?yt(this,y.model.original.onDidChangeTokens,()=>y.model.original.tokenization.backgroundTokenizationState===2):void 0).map((y,C)=>y?.read(C)),f=me(y=>{const C=this._diffModel.read(y),w=C?.diff.read(y);if(!C||!w)return null;h.read(y);const k=this._options.renderSideBySide.read(y);return M9(this._editors.original,this._editors.modified,w.mappings,this._origViewZonesToIgnore,this._modViewZonesToIgnore,k)}),m=me(y=>{const C=this._diffModel.read(y)?.movedTextToCompare.read(y);if(!C)return null;h.read(y);const w=C.changes.map(x=>new cj(x));return M9(this._editors.original,this._editors.modified,w,this._origViewZonesToIgnore,this._modViewZonesToIgnore,!0)});function _(){const y=document.createElement("div");return y.className="diagonal-fill",y}const b=this._register(new $);this.viewZones=Xh(this,(y,C)=>{b.clear();const w=f.read(y)||[],x=[],k=[],E=this._modifiedTopPadding.read(y);E>0&&k.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:E,showInHiddenAreas:!0,suppressMouseDown:!0});const N=this._originalTopPadding.read(y);N>0&&x.push({afterLineNumber:0,domNode:document.createElement("div"),heightInPx:N,showInHiddenAreas:!0,suppressMouseDown:!0});const z=this._options.renderSideBySide.read(y),B=z?void 0:this._editors.modified._getViewModel()?.createLineBreaksComputer();if(B){const he=this._editors.original.getModel();for(const Ne of w)if(Ne.diff)for(let Pe=Ne.originalRange.startLineNumber;Pe<Ne.originalRange.endLineNumberExclusive;Pe++){if(Pe>he.getLineCount())return{orig:x,mod:k};B?.addRequest(he.getLineContent(Pe),null,null)}}const U=B?.finalize()??[];let Z=0;const V=this._editors.modified.getOption(67),Q=this._diffModel.read(y)?.movedTextToCompare.read(y),le=this._editors.original.getModel()?.mightContainNonBasicASCII()??!1,ge=this._editors.original.getModel()?.mightContainRTL()??!1,_e=XB.fromEditor(this._editors.modified);for(const he of w)if(he.diff&&!z&&(!this._options.useTrueInlineDiffRendering.read(y)||!QB(he.diff))){if(!he.originalRange.isEmpty){g.read(y);const Pe=document.createElement("div");Pe.classList.add("view-lines","line-delete","monaco-mouse-cursor-text");const Xt=this._editors.original.getModel();if(he.originalRange.endLineNumberExclusive-1>Xt.getLineCount())return{orig:x,mod:k};const Lt=new Rbe(he.originalRange.mapToLineArray(Bi=>Xt.tokenization.getLineTokens(Bi)),he.originalRange.mapToLineArray(Bi=>U[Z++]),le,ge),di=[];for(const Bi of he.diff.innerChanges||[])di.push(new Qv(Bi.originalRange.delta(-(he.diff.original.startLineNumber-1)),F_.className,0));const kt=Nbe(Lt,_e,di,Pe),Di=document.createElement("div");if(Di.className="inline-deleted-margin-view-zone",mn(Di,_e.fontInfo),this._options.renderIndicators.read(y))for(let Bi=0;Bi<kt.heightInLines;Bi++){const yr=document.createElement("div");yr.className=`delete-sign ${ke.asClassName(rj)}`,yr.setAttribute("style",`position:absolute;top:${Bi*V}px;width:${_e.lineDecorationsWidth}px;height:${V}px;right:0;`),Di.appendChild(yr)}let jo;b.add(new Ibe(()=>Vd(jo),Di,this._editors.modified,he.diff,this._diffEditorWidget,kt.viewLineCounts,this._editors.original.getModel(),this._contextMenuService,this._clipboardService));for(let Bi=0;Bi<kt.viewLineCounts.length;Bi++){const yr=kt.viewLineCounts[Bi];yr>1&&x.push({afterLineNumber:he.originalRange.startLineNumber+Bi,domNode:_(),heightInPx:(yr-1)*V,showInHiddenAreas:!0,suppressMouseDown:!0})}k.push({afterLineNumber:he.modifiedRange.startLineNumber-1,domNode:Pe,heightInPx:kt.heightInLines*V,minWidthInPx:kt.minWidthInPx,marginDomNode:Di,setZoneId(Bi){jo=Bi},showInHiddenAreas:!0,suppressMouseDown:!0})}const Ne=document.createElement("div");Ne.className="gutter-delete",x.push({afterLineNumber:he.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:he.modifiedHeightInPx,marginDomNode:Ne,showInHiddenAreas:!0,suppressMouseDown:!0})}else{const Ne=he.modifiedHeightInPx-he.originalHeightInPx;if(Ne>0){if(Q?.lineRangeMapping.original.delta(-1).deltaLength(2).contains(he.originalRange.endLineNumberExclusive-1))continue;x.push({afterLineNumber:he.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:Ne,showInHiddenAreas:!0,suppressMouseDown:!0})}else{let Pe=function(){const Lt=document.createElement("div");return Lt.className="arrow-revert-change "+ke.asClassName(J.arrowRight),C.add(H(Lt,"mousedown",di=>di.stopPropagation())),C.add(H(Lt,"click",di=>{di.stopPropagation(),s.revert(he.diff)})),ie("div",{},Lt)};if(Q?.lineRangeMapping.modified.delta(-1).deltaLength(2).contains(he.modifiedRange.endLineNumberExclusive-1))continue;let Xt;he.diff&&he.diff.modified.isEmpty&&this._options.shouldRenderOldRevertArrows.read(y)&&(Xt=Pe()),k.push({afterLineNumber:he.modifiedRange.endLineNumberExclusive-1,domNode:_(),heightInPx:-Ne,marginDomNode:Xt,showInHiddenAreas:!0,suppressMouseDown:!0})}}for(const he of m.read(y)??[]){if(!Q?.lineRangeMapping.original.intersect(he.originalRange)||!Q?.lineRangeMapping.modified.intersect(he.modifiedRange))continue;const Ne=he.modifiedHeightInPx-he.originalHeightInPx;Ne>0?x.push({afterLineNumber:he.originalRange.endLineNumberExclusive-1,domNode:_(),heightInPx:Ne,showInHiddenAreas:!0,suppressMouseDown:!0}):k.push({afterLineNumber:he.modifiedRange.endLineNumberExclusive-1,domNode:_(),heightInPx:-Ne,showInHiddenAreas:!0,suppressMouseDown:!0})}return{orig:x,mod:k}});let v=!1;this._register(this._editors.original.onDidScrollChange(y=>{y.scrollLeftChanged&&!v&&(v=!0,this._editors.modified.setScrollLeft(y.scrollLeft),v=!1)})),this._register(this._editors.modified.onDidScrollChange(y=>{y.scrollLeftChanged&&!v&&(v=!0,this._editors.original.setScrollLeft(y.scrollLeft),v=!1)})),this._originalScrollTop=yt(this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=yt(this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._register(Re(y=>{const C=this._originalScrollTop.read(y)-(this._originalScrollOffsetAnimated.get()-this._modifiedScrollOffsetAnimated.read(y))-(this._originalTopPadding.get()-this._modifiedTopPadding.read(y));C!==this._editors.modified.getScrollTop()&&this._editors.modified.setScrollTop(C,1)})),this._register(Re(y=>{const C=this._modifiedScrollTop.read(y)-(this._modifiedScrollOffsetAnimated.get()-this._originalScrollOffsetAnimated.read(y))-(this._modifiedTopPadding.get()-this._originalTopPadding.read(y));C!==this._editors.original.getScrollTop()&&this._editors.original.setScrollTop(C,1)})),this._register(Re(y=>{const C=this._diffModel.read(y)?.movedTextToCompare.read(y);let w=0;if(C){const x=this._editors.original.getTopForLineNumber(C.lineRangeMapping.original.startLineNumber,!0)-this._originalTopPadding.get();w=this._editors.modified.getTopForLineNumber(C.lineRangeMapping.modified.startLineNumber,!0)-this._modifiedTopPadding.get()-x}w>0?(this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(w,void 0)):w<0?(this._modifiedTopPadding.set(-w,void 0),this._originalTopPadding.set(0,void 0)):setTimeout(()=>{this._modifiedTopPadding.set(0,void 0),this._originalTopPadding.set(0,void 0)},400),this._editors.modified.hasTextFocus()?this._originalScrollOffset.set(this._modifiedScrollOffset.get()-w,void 0,!0):this._modifiedScrollOffset.set(this._originalScrollOffset.get()+w,void 0,!0)}))}};pO=Pbe([A9(8,ad),A9(9,co)],pO);function M9(o,e,t,i,n,s){const r=new Gc(O9(o,i)),a=new Gc(O9(e,n)),l=o.getOption(67),c=e.getOption(67),d=[];let h=0,u=0;function g(f,m){for(;;){let _=r.peek(),b=a.peek();if(_&&_.lineNumber>=f&&(_=void 0),b&&b.lineNumber>=m&&(b=void 0),!_&&!b)break;const v=_?_.lineNumber-h:Number.MAX_VALUE,y=b?b.lineNumber-u:Number.MAX_VALUE;v<y?(r.dequeue(),b={lineNumber:_.lineNumber-h+u,heightInPx:0}):v>y?(a.dequeue(),_={lineNumber:b.lineNumber-u+h,heightInPx:0}):(r.dequeue(),a.dequeue()),d.push({originalRange:Be.ofLength(_.lineNumber,1),modifiedRange:Be.ofLength(b.lineNumber,1),originalHeightInPx:l+_.heightInPx,modifiedHeightInPx:c+b.heightInPx,diff:void 0})}}for(const f of t){let y=function(C,w,x=!1){if(C<v||w<b)return;if(_)_=!1;else if(!x&&(C===v||w===b))return;const k=new Be(v,C),E=new Be(b,w);if(k.isEmpty&&E.isEmpty)return;const N=r.takeWhile(B=>B.lineNumber<C)?.reduce((B,U)=>B+U.heightInPx,0)??0,z=a.takeWhile(B=>B.lineNumber<w)?.reduce((B,U)=>B+U.heightInPx,0)??0;d.push({originalRange:k,modifiedRange:E,originalHeightInPx:k.length*l+N,modifiedHeightInPx:E.length*c+z,diff:f.lineRangeMapping}),v=C,b=w};const m=f.lineRangeMapping;g(m.original.startLineNumber,m.modified.startLineNumber);let _=!0,b=m.modified.startLineNumber,v=m.original.startLineNumber;if(s)for(const C of m.innerChanges||[]){C.originalRange.startColumn>1&&C.modifiedRange.startColumn>1&&y(C.originalRange.startLineNumber,C.modifiedRange.startLineNumber);const w=o.getModel(),x=C.originalRange.endLineNumber<=w.getLineCount()?w.getLineMaxColumn(C.originalRange.endLineNumber):Number.MAX_SAFE_INTEGER;C.originalRange.endColumn<x&&y(C.originalRange.endLineNumber,C.modifiedRange.endLineNumber)}y(m.original.endLineNumberExclusive,m.modified.endLineNumberExclusive,!0),h=m.original.endLineNumberExclusive,u=m.modified.endLineNumberExclusive}return g(Number.MAX_VALUE,Number.MAX_VALUE),d}function O9(o,e){const t=[],i=[],n=o.getOption(147).wrappingColumn!==-1,s=o._getViewModel().coordinatesConverter,r=o.getOption(67);if(n)for(let l=1;l<=o.getModel().getLineCount();l++){const c=s.getModelLineViewLineCount(l);c>1&&i.push({lineNumber:l,heightInPx:r*(c-1)})}for(const l of o.getWhitespaces()){if(e.has(l.id))continue;const c=l.afterLineNumber===0?0:s.convertViewPositionToModelPosition(new A(l.afterLineNumber,1)).lineNumber;t.push({lineNumber:c,heightInPx:l.height})}return rbe(t,i,l=>l.lineNumber,(l,c)=>({lineNumber:l.lineNumber,heightInPx:l.heightInPx+c.heightInPx}))}function QB(o){return o.innerChanges?o.innerChanges.every(e=>F9(e.modifiedRange)&&F9(e.originalRange)||e.originalRange.equalsRange(new L(1,1,1,1))):!1}function F9(o){return o.startLineNumber===o.endLineNumber}const RC=class RC extends F{constructor(e,t,i,n,s){super(),this._rootElement=e,this._diffModel=t,this._originalEditorLayoutInfo=i,this._modifiedEditorLayoutInfo=n,this._editors=s,this._originalScrollTop=yt(this,this._editors.original.onDidScrollChange,()=>this._editors.original.getScrollTop()),this._modifiedScrollTop=yt(this,this._editors.modified.onDidScrollChange,()=>this._editors.modified.getScrollTop()),this._viewZonesChanged=Sn("onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this.width=$e(this,0),this._modifiedViewZonesChangedSignal=Sn("modified.onDidChangeViewZones",this._editors.modified.onDidChangeViewZones),this._originalViewZonesChangedSignal=Sn("original.onDidChangeViewZones",this._editors.original.onDidChangeViewZones),this._state=Xh(this,(d,h)=>{this._element.replaceChildren();const u=this._diffModel.read(d),g=u?.diff.read(d)?.movedTexts;if(!g||g.length===0){this.width.set(0,void 0);return}this._viewZonesChanged.read(d);const f=this._originalEditorLayoutInfo.read(d),m=this._modifiedEditorLayoutInfo.read(d);if(!f||!m){this.width.set(0,void 0);return}this._modifiedViewZonesChangedSignal.read(d),this._originalViewZonesChangedSignal.read(d);const _=g.map(k=>{function E(ge,_e){const he=_e.getTopForLineNumber(ge.startLineNumber,!0),Ne=_e.getTopForLineNumber(ge.endLineNumberExclusive,!0);return(he+Ne)/2}const N=E(k.lineRangeMapping.original,this._editors.original),z=this._originalScrollTop.read(d),B=E(k.lineRangeMapping.modified,this._editors.modified),U=this._modifiedScrollTop.read(d),Z=N-z,V=B-U,Q=Math.min(N,B),le=Math.max(N,B);return{range:new je(Q,le),from:Z,to:V,fromWithoutScroll:N,toWithoutScroll:B,move:k}});_.sort(NY(cs(k=>k.fromWithoutScroll>k.toWithoutScroll,RY),cs(k=>k.fromWithoutScroll>k.toWithoutScroll?k.fromWithoutScroll:-k.toWithoutScroll,Br)));const b=JB.compute(_.map(k=>k.range)),v=10,y=f.verticalScrollbarWidth,C=(b.getTrackCount()-1)*10+v*2,w=y+C+(m.contentLeft-RC.movedCodeBlockPadding);let x=0;for(const k of _){const E=b.getTrack(x),N=y+v+E*10,z=15,B=15,U=w,Z=m.glyphMarginWidth+m.lineNumbersWidth,V=18,Q=document.createElementNS("http://www.w3.org/2000/svg","rect");Q.classList.add("arrow-rectangle"),Q.setAttribute("x",`${U-Z}`),Q.setAttribute("y",`${k.to-V/2}`),Q.setAttribute("width",`${Z}`),Q.setAttribute("height",`${V}`),this._element.appendChild(Q);const le=document.createElementNS("http://www.w3.org/2000/svg","g"),ge=document.createElementNS("http://www.w3.org/2000/svg","path");ge.setAttribute("d",`M 0 ${k.from} L ${N} ${k.from} L ${N} ${k.to} L ${U-B} ${k.to}`),ge.setAttribute("fill","none"),le.appendChild(ge);const _e=document.createElementNS("http://www.w3.org/2000/svg","polygon");_e.classList.add("arrow"),h.add(Re(he=>{ge.classList.toggle("currentMove",k.move===u.activeMovedText.read(he)),_e.classList.toggle("currentMove",k.move===u.activeMovedText.read(he))})),_e.setAttribute("points",`${U-B},${k.to-z/2} ${U},${k.to} ${U-B},${k.to+z/2}`),le.appendChild(_e),this._element.appendChild(le),x++}this.width.set(C,void 0)}),this._element=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._element.setAttribute("class","moved-blocks-lines"),this._rootElement.appendChild(this._element),this._register(ve(()=>this._element.remove())),this._register(Re(d=>{const h=this._originalEditorLayoutInfo.read(d),u=this._modifiedEditorLayoutInfo.read(d);!h||!u||(this._element.style.left=`${h.width-h.verticalScrollbarWidth}px`,this._element.style.height=`${h.height}px`,this._element.style.width=`${h.verticalScrollbarWidth+h.contentLeft-RC.movedCodeBlockPadding+this.width.read(d)}px`)})),this._register(fb(this._state));const r=me(d=>{const u=this._diffModel.read(d)?.diff.read(d);return u?u.movedTexts.map(g=>({move:g,original:new om(rr(g.lineRangeMapping.original.startLineNumber-1),18),modified:new om(rr(g.lineRangeMapping.modified.startLineNumber-1),18)})):[]});this._register(rL(this._editors.original,r.map(d=>d.map(h=>h.original)))),this._register(rL(this._editors.modified,r.map(d=>d.map(h=>h.modified)))),this._register(Is((d,h)=>{const u=r.read(d);for(const g of u)h.add(new B9(this._editors.original,g.original,g.move,"original",this._diffModel.get())),h.add(new B9(this._editors.modified,g.modified,g.move,"modified",this._diffModel.get()))}));const a=Sn("original.onDidFocusEditorWidget",d=>this._editors.original.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0))),l=Sn("modified.onDidFocusEditorWidget",d=>this._editors.modified.onDidFocusEditorWidget(()=>setTimeout(()=>d(void 0),0)));let c="modified";this._register(Fw({createEmptyChangeSummary:()=>{},handleChange:(d,h)=>(d.didChange(a)&&(c="original"),d.didChange(l)&&(c="modified"),!0)},d=>{a.read(d),l.read(d);const h=this._diffModel.read(d);if(!h)return;const u=h.diff.read(d);let g;if(u&&c==="original"){const f=this._editors.originalCursor.read(d);f&&(g=u.movedTexts.find(m=>m.lineRangeMapping.original.contains(f.lineNumber)))}if(u&&c==="modified"){const f=this._editors.modifiedCursor.read(d);f&&(g=u.movedTexts.find(m=>m.lineRangeMapping.modified.contains(f.lineNumber)))}g!==h.movedTextToCompare.get()&&h.movedTextToCompare.set(void 0,void 0),h.setActiveMovedText(g)}))}};RC.movedCodeBlockPadding=4;let Xm=RC;class JB{static compute(e){const t=[],i=[];for(const n of e){let s=t.findIndex(r=>!r.intersectsStrict(n));s===-1&&(t.length>=6?s=fie(t,cs(a=>a.intersectWithRangeLength(n),Br)):(s=t.length,t.push(new J4))),t[s].addRange(n),i.push(s)}return new JB(t.length,i)}constructor(e,t){this._trackCount=e,this.trackPerLineIdx=t}getTrack(e){return this.trackPerLineIdx[e]}getTrackCount(){return this._trackCount}}class B9 extends UB{constructor(e,t,i,n,s){const r=Ye("div.diff-hidden-lines-widget");super(e,t,r.root),this._editor=e,this._move=i,this._kind=n,this._diffModel=s,this._nodes=Ye("div.diff-moved-code-block",{style:{marginRight:"4px"}},[Ye("div.text-content@textContent"),Ye("div.action-bar@actionBar")]),r.root.appendChild(this._nodes.root);const a=yt(this._editor.onDidLayoutChange,()=>this._editor.getLayoutInfo());this._register(Yc(this._nodes.root,{paddingRight:a.map(u=>u.verticalScrollbarWidth)}));let l;i.changes.length>0?l=this._kind==="original"?p("codeMovedToWithChanges","Code moved with changes to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):p("codeMovedFromWithChanges","Code moved with changes from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1):l=this._kind==="original"?p("codeMovedTo","Code moved to line {0}-{1}",this._move.lineRangeMapping.modified.startLineNumber,this._move.lineRangeMapping.modified.endLineNumberExclusive-1):p("codeMovedFrom","Code moved from line {0}-{1}",this._move.lineRangeMapping.original.startLineNumber,this._move.lineRangeMapping.original.endLineNumberExclusive-1);const c=this._register(new Oo(this._nodes.actionBar,{highlightToggledItems:!0})),d=new to("",l,"",!1);c.push(d,{icon:!1,label:!0});const h=new to("","Compare",ke.asClassName(J.compareChanges),!0,()=>{this._editor.focus(),this._diffModel.movedTextToCompare.set(this._diffModel.movedTextToCompare.get()===i?void 0:this._move,void 0)});this._register(Re(u=>{const g=this._diffModel.movedTextToCompare.read(u)===i;h.checked=g})),c.push(h,{icon:!1,label:!0})}}class Abe extends F{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._decorations=me(this,s=>{const r=this._diffModel.read(s),a=r?.diff.read(s);if(!a)return null;const l=this._diffModel.read(s).movedTextToCompare.read(s),c=this._options.renderIndicators.read(s),d=this._options.showEmptyDecorations.read(s),h=[],u=[];if(!l)for(const f of a.mappings)if(f.lineRangeMapping.original.isEmpty||h.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:c?Wy:N9}),f.lineRangeMapping.modified.isEmpty||u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:c?lL:I9}),f.lineRangeMapping.modified.isEmpty||f.lineRangeMapping.original.isEmpty)f.lineRangeMapping.original.isEmpty||h.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:qB}),f.lineRangeMapping.modified.isEmpty||u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:KB});else{const m=this._options.useTrueInlineDiffRendering.read(s)&&QB(f.lineRangeMapping);for(const _ of f.lineRangeMapping.innerChanges||[])if(f.lineRangeMapping.original.contains(_.originalRange.startLineNumber)&&h.push({range:_.originalRange,options:_.originalRange.isEmpty()&&d?ZB:F_}),f.lineRangeMapping.modified.contains(_.modifiedRange.startLineNumber)&&u.push({range:_.modifiedRange,options:_.modifiedRange.isEmpty()&&d&&!m?jB:cL}),m){const b=r.model.original.getValueInRange(_.originalRange);u.push({range:_.modifiedRange,options:{description:"deleted-text",before:{content:b,inlineClassName:"inline-deleted-text"},zIndex:1e5,showIfCollapsed:!0}})}}if(l)for(const f of l.changes){const m=f.original.toInclusiveRange();m&&h.push({range:m,options:c?Wy:N9});const _=f.modified.toInclusiveRange();_&&u.push({range:_,options:c?lL:I9});for(const b of f.innerChanges||[])h.push({range:b.originalRange,options:F_}),u.push({range:b.modifiedRange,options:cL})}const g=this._diffModel.read(s).activeMovedText.read(s);for(const f of a.movedTexts)h.push({range:f.lineRangeMapping.original.toInclusiveRange(),options:{description:"moved",blockClassName:"movedOriginal"+(f===g?" currentMove":""),blockPadding:[Xm.movedCodeBlockPadding,0,Xm.movedCodeBlockPadding,Xm.movedCodeBlockPadding]}}),u.push({range:f.lineRangeMapping.modified.toInclusiveRange(),options:{description:"moved",blockClassName:"movedModified"+(f===g?" currentMove":""),blockPadding:[4,0,4,4]}});return{originalDecorations:h,modifiedDecorations:u}}),this._register(oL(this._editors.original,this._decorations.map(s=>s?.originalDecorations||[]))),this._register(oL(this._editors.modified,this._decorations.map(s=>s?.modifiedDecorations||[])))}}class Mbe{resetSash(){this._sashRatio.set(void 0,void 0)}constructor(e,t){this._options=e,this.dimensions=t,this.sashLeft=Mw(this,i=>{const n=this._sashRatio.read(i)??this._options.splitViewDefaultRatio.read(i);return this._computeSashLeft(n,i)},(i,n)=>{const s=this.dimensions.width.get();this._sashRatio.set(i/s,n)}),this._sashRatio=$e(this,void 0)}_computeSashLeft(e,t){const i=this.dimensions.width.read(t),n=Math.floor(this._options.splitViewDefaultRatio.read(t)*i),s=this._options.enableSplitViewResizing.read(t)?Math.floor(e*i):n,r=100;return i<=r*2?n:s<r?r:s>i-r?i-r:s}}class dj extends F{constructor(e,t,i,n,s,r){super(),this._domNode=e,this._dimensions=t,this._enabled=i,this._boundarySashes=n,this.sashLeft=s,this._resetSash=r,this._sash=this._register(new Nn(this._domNode,{getVerticalSashTop:a=>0,getVerticalSashLeft:a=>this.sashLeft.get(),getVerticalSashHeight:a=>this._dimensions.height.get()},{orientation:0})),this._startSashPosition=void 0,this._register(this._sash.onDidStart(()=>{this._startSashPosition=this.sashLeft.get()})),this._register(this._sash.onDidChange(a=>{this.sashLeft.set(this._startSashPosition+(a.currentX-a.startX),void 0)})),this._register(this._sash.onDidEnd(()=>this._sash.layout())),this._register(this._sash.onDidReset(()=>this._resetSash())),this._register(Re(a=>{const l=this._boundarySashes.read(a);l&&(this._sash.orthogonalEndSash=l.bottom)})),this._register(Re(a=>{const l=this._enabled.read(a);this._sash.state=l?3:0,this.sashLeft.read(a),this._dimensions.height.read(a),this._sash.layout()}))}}class Obe extends F{constructor(e,t,i){super(),this._editor=e,this._domNode=t,this.itemProvider=i,this.scrollTop=yt(this,this._editor.onDidScrollChange,r=>this._editor.getScrollTop()),this.isScrollTopZero=this.scrollTop.map(r=>r===0),this.modelAttached=yt(this,this._editor.onDidChangeModel,r=>this._editor.hasModel()),this.editorOnDidChangeViewZones=Sn("onDidChangeViewZones",this._editor.onDidChangeViewZones),this.editorOnDidContentSizeChange=Sn("onDidContentSizeChange",this._editor.onDidContentSizeChange),this.domNodeSizeChanged=gb("domNodeSizeChanged"),this.views=new Map,this._domNode.className="gutter monaco-editor";const n=this._domNode.appendChild(Ye("div.scroll-decoration",{role:"presentation",ariaHidden:"true",style:{width:"100%"}}).root),s=new ResizeObserver(()=>{oi(r=>{this.domNodeSizeChanged.trigger(r)})});s.observe(this._domNode),this._register(ve(()=>s.disconnect())),this._register(Re(r=>{n.className=this.isScrollTopZero.read(r)?"":"scroll-decoration"})),this._register(Re(r=>this.render(r)))}dispose(){super.dispose(),pn(this._domNode)}render(e){if(!this.modelAttached.read(e))return;this.domNodeSizeChanged.read(e),this.editorOnDidChangeViewZones.read(e),this.editorOnDidContentSizeChange.read(e);const t=this.scrollTop.read(e),i=this._editor.getVisibleRanges(),n=new Set(this.views.keys()),s=je.ofStartAndLength(0,this._domNode.clientHeight);if(!s.isEmpty)for(const r of i){const a=new Be(r.startLineNumber,r.endLineNumber+1),l=this.itemProvider.getIntersectingGutterItems(a,e);oi(c=>{for(const d of l){if(!d.range.intersect(a))continue;n.delete(d.id);let h=this.views.get(d.id);if(h)h.item.set(d,c);else{const m=document.createElement("div");this._domNode.appendChild(m);const _=$e("item",d),b=this.itemProvider.createView(_,m);h=new Fbe(_,b,m),this.views.set(d.id,h)}const u=d.range.startLineNumber<=this._editor.getModel().getLineCount()?this._editor.getTopForLineNumber(d.range.startLineNumber,!0)-t:this._editor.getBottomForLineNumber(d.range.startLineNumber-1,!1)-t,f=(d.range.endLineNumberExclusive===1?Math.max(u,this._editor.getTopForLineNumber(d.range.startLineNumber,!1)-t):Math.max(u,this._editor.getBottomForLineNumber(d.range.endLineNumberExclusive-1,!0)-t))-u;h.domNode.style.top=`${u}px`,h.domNode.style.height=`${f}px`,h.gutterItemView.layout(je.ofStartAndLength(u,f),s)}})}for(const r of n){const a=this.views.get(r);a.gutterItemView.dispose(),a.domNode.remove(),this.views.delete(r)}}}class Fbe{constructor(e,t,i){this.item=e,this.gutterItemView=t,this.domNode=i}}class hj extends Cf{constructor(e){super(),this._getContext=e}runAction(e,t){const i=this._getContext();return super.runAction(e,i)}}class W9 extends DU{constructor(e){super(),this._textModel=e}getValueOfRange(e){return this._textModel.getValueInRange(e)}get length(){const e=this._textModel.getLineCount(),t=this._textModel.getLineLength(e);return new Gr(e-1,t)}}class Bbe extends F{constructor(e,t,i={orientation:0}){super(),this.submenuActionViewItems=[],this.hasSecondaryActions=!1,this._onDidChangeDropdownVisibility=this._register(new iQ),this.onDidChangeDropdownVisibility=this._onDidChangeDropdownVisibility.event,this.disposables=this._register(new $),i.hoverDelegate=i.hoverDelegate??this._register(D_()),this.options=i,this.toggleMenuAction=this._register(new Vy(()=>this.toggleMenuActionViewItem?.show(),i.toggleMenuTitle)),this.element=document.createElement("div"),this.element.className="monaco-toolbar",e.appendChild(this.element),this.actionBar=this._register(new Oo(this.element,{orientation:i.orientation,ariaLabel:i.ariaLabel,actionRunner:i.actionRunner,allowContextMenu:i.allowContextMenu,highlightToggledItems:i.highlightToggledItems,hoverDelegate:i.hoverDelegate,actionViewItemProvider:(n,s)=>{if(n.id===Vy.ID)return this.toggleMenuActionViewItem=new hx(n,n.menuActions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:ke.asClassNameArray(i.moreIcon??J.toolBarMore),anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,isMenu:!0,hoverDelegate:this.options.hoverDelegate}),this.toggleMenuActionViewItem.setActionContext(this.actionBar.context),this.disposables.add(this._onDidChangeDropdownVisibility.add(this.toggleMenuActionViewItem.onDidChangeVisibility)),this.toggleMenuActionViewItem;if(i.actionViewItemProvider){const r=i.actionViewItemProvider(n,s);if(r)return r}if(n instanceof m_){const r=new hx(n,n.actions,t,{actionViewItemProvider:this.options.actionViewItemProvider,actionRunner:this.actionRunner,keybindingProvider:this.options.getKeyBinding,classNames:n.class,anchorAlignmentProvider:this.options.anchorAlignmentProvider,menuAsChild:!!this.options.renderDropdownAsChildElement,skipTelemetry:this.options.skipTelemetry,hoverDelegate:this.options.hoverDelegate});return r.setActionContext(this.actionBar.context),this.submenuActionViewItems.push(r),this.disposables.add(this._onDidChangeDropdownVisibility.add(r.onDidChangeVisibility)),r}}}))}set actionRunner(e){this.actionBar.actionRunner=e}get actionRunner(){return this.actionBar.actionRunner}getElement(){return this.element}getItemAction(e){return this.actionBar.getAction(e)}setActions(e,t){this.clear();const i=e?e.slice(0):[];this.hasSecondaryActions=!!(t&&t.length>0),this.hasSecondaryActions&&t&&(this.toggleMenuAction.menuActions=t.slice(0),i.push(this.toggleMenuAction)),i.forEach(n=>{this.actionBar.push(n,{icon:this.options.icon??!0,label:this.options.label??!1,keybinding:this.getKeybindingLabel(n)})})}getKeybindingLabel(e){return this.options.getKeyBinding?.(e)?.getLabel()??void 0}clear(){this.submenuActionViewItems=[],this.disposables.clear(),this.actionBar.clear()}dispose(){this.clear(),this.disposables.dispose(),super.dispose()}}const oE=class oE extends to{constructor(e,t){t=t||p("moreActions","More Actions..."),super(oE.ID,t,void 0,!0),this._menuActions=[],this.toggleDropdownMenu=e}async run(){this.toggleDropdownMenu()}get menuActions(){return this._menuActions}set menuActions(e){this._menuActions=e}};oE.ID="toolbar.toggle.more";let Vy=oE;var uj=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Rr=function(o,e){return function(t,i){e(t,i,o)}};let Hy=class extends Bbe{constructor(e,t,i,n,s,r,a,l){super(e,s,{getKeyBinding:d=>r.lookupKeybinding(d.id)??void 0,...t,allowContextMenu:!0,skipTelemetry:typeof t?.telemetrySource=="string"}),this._options=t,this._menuService=i,this._contextKeyService=n,this._contextMenuService=s,this._keybindingService=r,this._commandService=a,this._sessionDisposables=this._store.add(new $);const c=t?.telemetrySource;c&&this._store.add(this.actionBar.onDidRun(d=>l.publicLog2("workbenchActionExecuted",{id:d.action.id,from:c})))}setActions(e,t=[],i){this._sessionDisposables.clear();const n=e.slice(),s=t.slice(),r=[];let a=0;const l=[];let c=!1;if(this._options?.hiddenItemStrategy!==-1)for(let d=0;d<n.length;d++){const h=n[d];!(h instanceof io)&&!(h instanceof Pm)||h.hideActions&&(r.push(h.hideActions.toggle),h.hideActions.toggle.checked&&a++,h.hideActions.isHidden&&(c=!0,n[d]=void 0,this._options?.hiddenItemStrategy!==0&&(l[d]=h)))}if(this._options?.overflowBehavior!==void 0){const d=Xce(new Set(this._options.overflowBehavior.exempted),nt.map(n,g=>g?.id)),h=this._options.overflowBehavior.maxItems-d.size;let u=0;for(let g=0;g<n.length;g++){const f=n[g];f&&(u++,!d.has(f.id)&&u>=h&&(n[g]=void 0,l[g]=f))}}p3(n),p3(l),super.setActions(n,Zi.join(l,s)),(r.length>0||n.length>0)&&this._sessionDisposables.add(H(this.getElement(),"contextmenu",d=>{const h=new Mr(xe(this.getElement()),d),u=this.getItemAction(h.target);if(!u)return;h.preventDefault(),h.stopPropagation();const g=[];if(u instanceof io&&u.menuKeybinding)g.push(u.menuKeybinding);else if(!(u instanceof Pm||u instanceof Vy)){const m=!!this._keybindingService.lookupKeybinding(u.id);g.push(DK(this._commandService,this._keybindingService,u.id,void 0,m))}if(r.length>0){let m=!1;if(a===1&&this._options?.hiddenItemStrategy===0){m=!0;for(let _=0;_<r.length;_++)if(r[_].checked){r[_]=ag({id:u.id,label:u.label,checked:!0,enabled:!1,run(){}});break}}if(!m&&(u instanceof io||u instanceof Pm)){if(!u.hideActions)return;g.push(u.hideActions.hide)}else g.push(ag({id:"label",label:p("hide","Hide"),enabled:!1,run(){}}))}const f=Zi.join(g,r);this._options?.resetMenu&&!i&&(i=[this._options.resetMenu]),c&&i&&(f.push(new Zi),f.push(ag({id:"resetThisMenu",label:p("resetThisMenu","Reset Menu"),run:()=>this._menuService.resetHiddenStates(i)}))),f.length!==0&&this._contextMenuService.showContextMenu({getAnchor:()=>h,getActions:()=>f,menuId:this._options?.contextMenu,menuActionOptions:{renderShortTitle:!0,...this._options?.menuOptions},skipTelemetry:typeof this._options?.telemetrySource=="string",contextKeyService:this._contextKeyService})}))}};Hy=uj([Rr(2,zo),Rr(3,Ee),Rr(4,co),Rr(5,vt),Rr(6,Ft),Rr(7,Fn)],Hy);let dL=class extends Hy{constructor(e,t,i,n,s,r,a,l,c){super(e,{resetMenu:t,...i},n,s,r,a,l,c),this._onDidChangeMenuItems=this._store.add(new O),this.onDidChangeMenuItems=this._onDidChangeMenuItems.event;const d=this._store.add(n.createMenu(t,s,{emitEventsForSubmenuChanges:!0})),h=()=>{const u=[],g=[];$T(d,i?.menuOptions,{primary:u,secondary:g},i?.toolbarOptions?.primaryGroup,i?.toolbarOptions?.shouldInlineSubmenu,i?.toolbarOptions?.useSeparatorsInPrimaryActions),e.classList.toggle("has-no-actions",u.length===0&&g.length===0),super.setActions(u,g)};this._store.add(d.onDidChange(()=>{h(),this._onDidChangeMenuItems.fire(this)})),h()}setActions(){throw new pt("This toolbar is populated from a menu.")}};dL=uj([Rr(3,zo),Rr(4,Ee),Rr(5,co),Rr(6,vt),Rr(7,Ft),Rr(8,Fn)],dL);var gj=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},J1=function(o,e){return function(t,i){e(t,i,o)}};const cN=[],t1=35;let mO=class extends F{constructor(e,t,i,n,s,r,a,l,c){super(),this._diffModel=t,this._editors=i,this._options=n,this._sashLayout=s,this._boundarySashes=r,this._instantiationService=a,this._contextKeyService=l,this._menuService=c,this._menu=this._register(this._menuService.createMenu(fe.DiffEditorHunkToolbar,this._contextKeyService)),this._actions=yt(this,this._menu.onDidChange,()=>this._menu.getActions()),this._hasActions=this._actions.map(d=>d.length>0),this._showSash=me(this,d=>this._options.renderSideBySide.read(d)&&this._hasActions.read(d)),this.width=me(this,d=>this._hasActions.read(d)?t1:0),this.elements=Ye("div.gutter@gutter",{style:{position:"absolute",height:"100%",width:t1+"px"}},[]),this._currentDiff=me(this,d=>{const h=this._diffModel.read(d);if(!h)return;const u=h.diff.read(d)?.mappings,g=this._editors.modifiedCursor.read(d);if(g)return u?.find(f=>f.lineRangeMapping.modified.contains(g.lineNumber))}),this._selectedDiffs=me(this,d=>{const u=this._diffModel.read(d)?.diff.read(d);if(!u)return cN;const g=this._editors.modifiedSelections.read(d);if(g.every(b=>b.isEmpty()))return cN;const f=new sr(g.map(b=>Be.fromRangeInclusive(b))),_=u.mappings.filter(b=>b.lineRangeMapping.innerChanges&&f.intersects(b.lineRangeMapping.modified)).map(b=>({mapping:b,rangeMappings:b.lineRangeMapping.innerChanges.filter(v=>g.some(y=>L.areIntersecting(v.modifiedRange,y)))}));return _.length===0||_.every(b=>b.rangeMappings.length===0)?cN:_}),this._register(abe(e,this.elements.root)),this._register(H(this.elements.root,"click",()=>{this._editors.modified.focus()})),this._register(Yc(this.elements.root,{display:this._hasActions.map(d=>d?"block":"none")})),Kn(this,d=>this._showSash.read(d)?new dj(e,this._sashLayout.dimensions,this._options.enableSplitViewResizing,this._boundarySashes,Mw(this,u=>this._sashLayout.sashLeft.read(u)-t1,(u,g)=>this._sashLayout.sashLeft.set(u+t1,g)),()=>this._sashLayout.resetSash()):void 0).recomputeInitiallyAndOnChange(this._store),this._register(new Obe(this._editors.modified,this.elements.root,{getIntersectingGutterItems:(d,h)=>{const u=this._diffModel.read(h);if(!u)return[];const g=u.diff.read(h);if(!g)return[];const f=this._selectedDiffs.read(h);if(f.length>0){const _=Mo.fromRangeMappings(f.flatMap(b=>b.rangeMappings));return[new V9(_,!0,fe.DiffEditorSelectionToolbar,void 0,u.model.original.uri,u.model.modified.uri)]}const m=this._currentDiff.read(h);return g.mappings.map(_=>new V9(_.lineRangeMapping.withInnerChangesFromLineRanges(),_.lineRangeMapping===m?.lineRangeMapping,fe.DiffEditorHunkToolbar,void 0,u.model.original.uri,u.model.modified.uri))},createView:(d,h)=>this._instantiationService.createInstance(_O,d,h,this)})),this._register(H(this.elements.gutter,ee.MOUSE_WHEEL,d=>{this._editors.modified.getOption(104).handleMouseWheel&&this._editors.modified.delegateScrollFromMouseWheelEvent(d)},{passive:!1}))}computeStagedValue(e){const t=e.innerChanges??[],i=new W9(this._editors.modifiedModel.get()),n=new W9(this._editors.original.getModel());return new t5(t.map(a=>a.toTextEdit(i))).apply(n)}layout(e){this.elements.gutter.style.left=e+"px"}};mO=gj([J1(6,Ce),J1(7,Ee),J1(8,zo)],mO);class V9{constructor(e,t,i,n,s,r){this.mapping=e,this.showAlways=t,this.menuId=i,this.rangeOverride=n,this.originalUri=s,this.modifiedUri=r}get id(){return this.mapping.modified.toString()}get range(){return this.rangeOverride??this.mapping.modified}}let _O=class extends F{constructor(e,t,i,n){super(),this._item=e,this._elements=Ye("div.gutterItem",{style:{height:"20px",width:"34px"}},[Ye("div.background@background",{},[]),Ye("div.buttons@buttons",{},[])]),this._showAlways=this._item.map(this,r=>r.showAlways),this._menuId=this._item.map(this,r=>r.menuId),this._isSmall=$e(this,!1),this._lastItemRange=void 0,this._lastViewRange=void 0;const s=this._register(n.createInstance(w_,"element",!0,{position:{hoverPosition:1}}));this._register(sm(t,this._elements.root)),this._register(Re(r=>{const a=this._showAlways.read(r);this._elements.root.classList.toggle("noTransition",!0),this._elements.root.classList.toggle("showAlways",a),setTimeout(()=>{this._elements.root.classList.toggle("noTransition",!1)},0)})),this._register(Is((r,a)=>{this._elements.buttons.replaceChildren();const l=a.add(n.createInstance(dL,this._elements.buttons,this._menuId.read(r),{orientation:1,hoverDelegate:s,toolbarOptions:{primaryGroup:c=>c.startsWith("primary")},overflowBehavior:{maxItems:this._isSmall.read(r)?1:3},hiddenItemStrategy:0,actionRunner:new hj(()=>{const c=this._item.get(),d=c.mapping;return{mapping:d,originalWithModifiedChanges:i.computeStagedValue(d),originalUri:c.originalUri,modifiedUri:c.modifiedUri}}),menuOptions:{shouldForwardArgs:!0}}));a.add(l.onDidChangeMenuItems(()=>{this._lastItemRange&&this.layout(this._lastItemRange,this._lastViewRange)}))}))}layout(e,t){this._lastItemRange=e,this._lastViewRange=t;let i=this._elements.buttons.clientHeight;this._isSmall.set(this._item.get().mapping.original.startLineNumber===1&&e.length<30,void 0),i=this._elements.buttons.clientHeight;const n=e.length/2-i/2,s=i;let r=e.start+n;const a=je.tryCreate(s,t.endExclusive-s-i),l=je.tryCreate(e.start+s,e.endExclusive-i-s);l&&a&&l.start<l.endExclusive&&(r=a.clip(r),r=l.clip(r)),this._elements.buttons.style.top=`${r-e.start}px`}};_O=gj([J1(3,Ce)],_O);function Qs(o){return bO.get(o)}const Td=class Td extends F{static get(e){let t=Td._map.get(e);if(!t){t=new Td(e),Td._map.set(e,t);const i=e.onDidDispose(()=>{const n=Td._map.get(e);n&&(Td._map.delete(e),n.dispose(),i.dispose())})}return t}_beginUpdate(){this._updateCounter++,this._updateCounter===1&&(this._currentTransaction=new ub(()=>{}))}_endUpdate(){if(this._updateCounter--,this._updateCounter===0){const e=this._currentTransaction;this._currentTransaction=void 0,e.finish()}}constructor(e){super(),this.editor=e,this._updateCounter=0,this._currentTransaction=void 0,this._model=$e(this,this.editor.getModel()),this.model=this._model,this.isReadonly=yt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(92)),this._versionId=SA({owner:this,lazy:!0},this.editor.getModel()?.getVersionId()??null),this.versionId=this._versionId,this._selections=SA({owner:this,equalsFn:CA(lx(pe.selectionsEqual)),lazy:!0},this.editor.getSelections()??null),this.selections=this._selections,this.isFocused=yt(this,t=>{const i=this.editor.onDidFocusEditorWidget(t),n=this.editor.onDidBlurEditorWidget(t);return{dispose(){i.dispose(),n.dispose()}}},()=>this.editor.hasWidgetFocus()),this.value=Mw(this,t=>(this.versionId.read(t),this.model.read(t)?.getValue()??""),(t,i)=>{const n=this.model.get();n!==null&&t!==n.getValue()&&n.setValue(t)}),this.valueIsEmpty=me(this,t=>(this.versionId.read(t),this.editor.getModel()?.getValueLength()===0)),this.cursorSelection=Eo({owner:this,equalsFn:CA(pe.selectionsEqual)},t=>this.selections.read(t)?.[0]??null),this.onDidType=gb(this),this.scrollTop=yt(this.editor.onDidScrollChange,()=>this.editor.getScrollTop()),this.scrollLeft=yt(this.editor.onDidScrollChange,()=>this.editor.getScrollLeft()),this.layoutInfo=yt(this.editor.onDidLayoutChange,()=>this.editor.getLayoutInfo()),this.layoutInfoContentLeft=this.layoutInfo.map(t=>t.contentLeft),this.layoutInfoDecorationsLeft=this.layoutInfo.map(t=>t.decorationsLeft),this.contentWidth=yt(this.editor.onDidContentSizeChange,()=>this.editor.getContentWidth()),this._overlayWidgetCounter=0,this._register(this.editor.onBeginUpdate(()=>this._beginUpdate())),this._register(this.editor.onEndUpdate(()=>this._endUpdate())),this._register(this.editor.onDidChangeModel(()=>{this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidType(t=>{this._beginUpdate();try{this._forceUpdate(),this.onDidType.trigger(this._currentTransaction,t)}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeModelContent(t=>{this._beginUpdate();try{this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,t),this._forceUpdate()}finally{this._endUpdate()}})),this._register(this.editor.onDidChangeCursorSelection(t=>{this._beginUpdate();try{this._selections.set(this.editor.getSelections(),this._currentTransaction,t),this._forceUpdate()}finally{this._endUpdate()}}))}forceUpdate(e){this._beginUpdate();try{return this._forceUpdate(),e?e(this._currentTransaction):void 0}finally{this._endUpdate()}}_forceUpdate(){this._beginUpdate();try{this._model.set(this.editor.getModel(),this._currentTransaction),this._versionId.set(this.editor.getModel()?.getVersionId()??null,this._currentTransaction,void 0),this._selections.set(this.editor.getSelections(),this._currentTransaction,void 0)}finally{this._endUpdate()}}getOption(e){return yt(this,t=>this.editor.onDidChangeConfiguration(i=>{i.hasChanged(e)&&t(void 0)}),()=>this.editor.getOption(e))}setDecorations(e){const t=new $,i=this.editor.createDecorationsCollection();return t.add(Ow({owner:this,debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const s=e.read(n);i.set(s)})),t.add({dispose:()=>{i.clear()}}),t}createOverlayWidget(e){const t="observableOverlayWidget"+this._overlayWidgetCounter++,i={getDomNode:()=>e.domNode,getPosition:()=>e.position.get(),getId:()=>t,allowEditorOverflow:e.allowEditorOverflow,getMinContentWidthInPx:()=>e.minContentWidthInPx.get()};this.editor.addOverlayWidget(i);const n=Re(s=>{e.position.read(s),e.minContentWidthInPx.read(s),this.editor.layoutOverlayWidget(i)});return ve(()=>{n.dispose(),this.editor.removeOverlayWidget(i)})}};Td._map=new Map;let bO=Td;function vO(o,e){return ale({createEmptyChangeSummary:()=>({deltas:[],didChange:!1}),handleChange:(t,i)=>{if(t.didChange(o)){const n=t.change;n!==void 0&&i.deltas.push(n),i.didChange=!0}return!0}},(t,i)=>{const n=o.read(t);i.didChange&&e(n,i.deltas)})}function Wbe(o,e){const t=new $,i=vO(o,(n,s)=>{t.clear(),e(n,s,t)});return{dispose(){i.dispose(),t.dispose()}}}var Vbe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Hbe=function(o,e){return function(t,i){e(t,i,o)}},e0,kg;let hL=(kg=class extends F{static setBreadcrumbsSourceFactory(e){this._breadcrumbsSourceFactory.set(e,void 0)}get isUpdatingHiddenAreas(){return this._isUpdatingHiddenAreas}constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._instantiationService=n,this._modifiedOutlineSource=Kn(this,l=>{const c=this._editors.modifiedModel.read(l),d=e0._breadcrumbsSourceFactory.read(l);return!c||!d?void 0:d(c,this._instantiationService)}),this._isUpdatingHiddenAreas=!1,this._register(this._editors.original.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();oi(d=>{for(const h of this._editors.original.getSelections()||[])c?.ensureOriginalLineIsVisible(h.getStartPosition().lineNumber,0,d),c?.ensureOriginalLineIsVisible(h.getEndPosition().lineNumber,0,d)})})),this._register(this._editors.modified.onDidChangeCursorPosition(l=>{if(l.reason===1)return;const c=this._diffModel.get();oi(d=>{for(const h of this._editors.modified.getSelections()||[])c?.ensureModifiedLineIsVisible(h.getStartPosition().lineNumber,0,d),c?.ensureModifiedLineIsVisible(h.getEndPosition().lineNumber,0,d)})}));const s=this._diffModel.map((l,c)=>{const d=l?.unchangedRegions.read(c)??[];return d.length===1&&d[0].modifiedLineNumber===1&&d[0].lineCount===this._editors.modifiedModel.read(c)?.getLineCount()?[]:d});this.viewZones=Xh(this,(l,c)=>{const d=this._modifiedOutlineSource.read(l);if(!d)return{origViewZones:[],modViewZones:[]};const h=[],u=[],g=this._options.renderSideBySide.read(l),f=this._options.compactMode.read(l),m=s.read(l);for(let _=0;_<m.length;_++){const b=m[_];if(!b.shouldHideControls(l)&&!(f&&(_===0||_===m.length-1)))if(f){{const v=me(this,C=>b.getHiddenOriginalRange(C).startLineNumber-1),y=new om(v,12);h.push(y),c.add(new H9(this._editors.original,y,b,!g))}{const v=me(this,C=>b.getHiddenModifiedRange(C).startLineNumber-1),y=new om(v,12);u.push(y),c.add(new H9(this._editors.modified,y,b))}}else{{const v=me(this,C=>b.getHiddenOriginalRange(C).startLineNumber-1),y=new om(v,24);h.push(y),c.add(new z9(this._editors.original,y,b,b.originalUnchangedRange,!g,d,C=>this._diffModel.get().ensureModifiedLineIsVisible(C,2,void 0),this._options))}{const v=me(this,C=>b.getHiddenModifiedRange(C).startLineNumber-1),y=new om(v,24);u.push(y),c.add(new z9(this._editors.modified,y,b,b.modifiedUnchangedRange,!1,d,C=>this._diffModel.get().ensureModifiedLineIsVisible(C,2,void 0),this._options))}}}return{origViewZones:h,modViewZones:u}});const r={description:"unchanged lines",className:"diff-unchanged-lines",isWholeLine:!0},a={description:"Fold Unchanged",glyphMarginHoverMessage:new Pn(void 0,{isTrusted:!0,supportThemeIcons:!0}).appendMarkdown(p("foldUnchanged","Fold Unchanged Region")),glyphMarginClassName:"fold-unchanged "+ke.asClassName(J.fold),zIndex:10001};this._register(oL(this._editors.original,me(this,l=>{const c=s.read(l),d=c.map(h=>({range:h.originalUnchangedRange.toInclusiveRange(),options:r}));for(const h of c)h.shouldHideControls(l)&&d.push({range:L.fromPositions(new A(h.originalLineNumber,1)),options:a});return d}))),this._register(oL(this._editors.modified,me(this,l=>{const c=s.read(l),d=c.map(h=>({range:h.modifiedUnchangedRange.toInclusiveRange(),options:r}));for(const h of c)h.shouldHideControls(l)&&d.push({range:Be.ofLength(h.modifiedLineNumber,1).toInclusiveRange(),options:a});return d}))),this._register(Re(l=>{const c=s.read(l);this._isUpdatingHiddenAreas=!0;try{this._editors.original.setHiddenAreas(c.map(d=>d.getHiddenOriginalRange(l).toInclusiveRange()).filter(Sl)),this._editors.modified.setHiddenAreas(c.map(d=>d.getHiddenModifiedRange(l).toInclusiveRange()).filter(Sl))}finally{this._isUpdatingHiddenAreas=!1}})),this._register(this._editors.modified.onMouseUp(l=>{if(!l.event.rightButton&&l.target.position&&l.target.element?.className.includes("fold-unchanged")){const c=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const h=d.unchangedRegions.get().find(u=>u.modifiedUnchangedRange.includes(c));if(!h)return;h.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}})),this._register(this._editors.original.onMouseUp(l=>{if(!l.event.rightButton&&l.target.position&&l.target.element?.className.includes("fold-unchanged")){const c=l.target.position.lineNumber,d=this._diffModel.get();if(!d)return;const h=d.unchangedRegions.get().find(u=>u.originalUnchangedRange.includes(c));if(!h)return;h.collapseAll(void 0),l.event.stopPropagation(),l.event.preventDefault()}}))}},e0=kg,kg._breadcrumbsSourceFactory=$e(e0,()=>({dispose(){},getBreadcrumbItems(e,t){return[]}})),kg);hL=e0=Vbe([Hbe(3,Ce)],hL);class H9 extends UB{constructor(e,t,i,n=!1){const s=Ye("div.diff-hidden-lines-widget");super(e,t,s.root),this._unchangedRegion=i,this._hide=n,this._nodes=Ye("div.diff-hidden-lines-compact",[Ye("div.line-left",[]),Ye("div.text@text",[]),Ye("div.line-right",[])]),s.root.appendChild(this._nodes.root),this._hide&&this._nodes.root.replaceChildren(),this._register(Re(r=>{if(!this._hide){const a=this._unchangedRegion.getHiddenModifiedRange(r).length,l=p("hiddenLines","{0} hidden lines",a);this._nodes.text.innerText=l}}))}}class z9 extends UB{constructor(e,t,i,n,s,r,a,l){const c=Ye("div.diff-hidden-lines-widget");super(e,t,c.root),this._editor=e,this._unchangedRegion=i,this._unchangedRegionRange=n,this._hide=s,this._modifiedOutlineSource=r,this._revealModifiedHiddenLine=a,this._options=l,this._nodes=Ye("div.diff-hidden-lines",[Ye("div.top@top",{title:p("diff.hiddenLines.top","Click or drag to show more above")}),Ye("div.center@content",{style:{display:"flex"}},[Ye("div@first",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:"0"}},[ie("a",{title:p("showUnchangedRegion","Show Unchanged Region"),role:"button",onclick:()=>{this._unchangedRegion.showAll(void 0)}},...nh("$(unfold)"))]),Ye("div@others",{style:{display:"flex",justifyContent:"center",alignItems:"center"}})]),Ye("div.bottom@bottom",{title:p("diff.bottom","Click or drag to show more below"),role:"button"})]),c.root.appendChild(this._nodes.root),this._hide?pn(this._nodes.first):this._register(Yc(this._nodes.first,{width:Qs(this._editor).layoutInfoContentLeft})),this._register(Re(h=>{const u=this._unchangedRegion.visibleLineCountTop.read(h)+this._unchangedRegion.visibleLineCountBottom.read(h)===this._unchangedRegion.lineCount;this._nodes.bottom.classList.toggle("canMoveTop",!u),this._nodes.bottom.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0),this._nodes.top.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),this._nodes.top.classList.toggle("canMoveBottom",!u);const g=this._unchangedRegion.isDragged.read(h),f=this._editor.getDomNode();f&&(f.classList.toggle("draggingUnchangedRegion",!!g),g==="top"?(f.classList.toggle("canMoveTop",this._unchangedRegion.visibleLineCountTop.read(h)>0),f.classList.toggle("canMoveBottom",!u)):g==="bottom"?(f.classList.toggle("canMoveTop",!u),f.classList.toggle("canMoveBottom",this._unchangedRegion.visibleLineCountBottom.read(h)>0)):(f.classList.toggle("canMoveTop",!1),f.classList.toggle("canMoveBottom",!1)))}));const d=this._editor;this._register(H(this._nodes.top,"mousedown",h=>{if(h.button!==0)return;this._nodes.top.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let g=!1;const f=this._unchangedRegion.visibleLineCountTop.get();this._unchangedRegion.isDragged.set("top",void 0);const m=xe(this._nodes.top),_=H(m,"mousemove",v=>{const C=v.clientY-u;g=g||Math.abs(C)>2;const w=Math.round(C/d.getOption(67)),x=Math.max(0,Math.min(f+w,this._unchangedRegion.getMaxVisibleLineCountTop()));this._unchangedRegion.visibleLineCountTop.set(x,void 0)}),b=H(m,"mouseup",v=>{g||this._unchangedRegion.showMoreAbove(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0),this._nodes.top.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),this._unchangedRegion.isDragged.set(void 0,void 0),_.dispose(),b.dispose()})})),this._register(H(this._nodes.bottom,"mousedown",h=>{if(h.button!==0)return;this._nodes.bottom.classList.toggle("dragging",!0),this._nodes.root.classList.toggle("dragging",!0),h.preventDefault();const u=h.clientY;let g=!1;const f=this._unchangedRegion.visibleLineCountBottom.get();this._unchangedRegion.isDragged.set("bottom",void 0);const m=xe(this._nodes.bottom),_=H(m,"mousemove",v=>{const C=v.clientY-u;g=g||Math.abs(C)>2;const w=Math.round(C/d.getOption(67)),x=Math.max(0,Math.min(f-w,this._unchangedRegion.getMaxVisibleLineCountBottom())),k=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.visibleLineCountBottom.set(x,void 0);const E=this._unchangedRegionRange.endLineNumberExclusive>d.getModel().getLineCount()?d.getContentHeight():d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(E-k))}),b=H(m,"mouseup",v=>{if(this._unchangedRegion.isDragged.set(void 0,void 0),!g){const y=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);this._unchangedRegion.showMoreBelow(this._options.hideUnchangedRegionsRevealLineCount.get(),void 0);const C=d.getTopForLineNumber(this._unchangedRegionRange.endLineNumberExclusive);d.setScrollTop(d.getScrollTop()+(C-y))}this._nodes.bottom.classList.toggle("dragging",!1),this._nodes.root.classList.toggle("dragging",!1),_.dispose(),b.dispose()})})),this._register(Re(h=>{const u=[];if(!this._hide){const g=i.getHiddenModifiedRange(h).length,f=p("hiddenLines","{0} hidden lines",g),m=ie("span",{title:p("diff.hiddenLines.expandAll","Double click to unfold")},f);m.addEventListener("dblclick",v=>{v.button===0&&(v.preventDefault(),this._unchangedRegion.showAll(void 0))}),u.push(m);const _=this._unchangedRegion.getHiddenModifiedRange(h),b=this._modifiedOutlineSource.getBreadcrumbItems(_,h);if(b.length>0){u.push(ie("span",void 0,"  |  "));for(let v=0;v<b.length;v++){const y=b[v],C=x0.toIcon(y.kind),w=Ye("div.breadcrumb-item",{style:{display:"flex",alignItems:"center"}},[Sf(C)," ",y.name,...v===b.length-1?[]:[Sf(J.chevronRight)]]).root;u.push(w),w.onclick=()=>{this._revealModifiedHiddenLine(y.startLineNumber)}}}}pn(this._nodes.others,...u)}))}}var zbe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ube=function(o,e){return function(t,i){e(t,i,o)}},ta,Ac;let zy=(Ac=class extends F{constructor(e,t,i,n,s,r,a){super(),this._editors=e,this._rootElement=t,this._diffModel=i,this._rootWidth=n,this._rootHeight=s,this._modifiedEditorLayoutInfo=r,this._themeService=a,this.width=ta.ENTIRE_DIFF_OVERVIEW_WIDTH;const l=yt(this._themeService.onDidColorThemeChange,()=>this._themeService.getColorTheme()),c=me(u=>{const g=l.read(u),f=g.getColor(ase)||(g.getColor(ose)||zP).transparent(2),m=g.getColor(lse)||(g.getColor(rse)||UP).transparent(2);return{insertColor:f,removeColor:m}}),d=bt(document.createElement("div"));d.setClassName("diffViewport"),d.setPosition("absolute");const h=Ye("div.diffOverview",{style:{position:"absolute",top:"0px",width:ta.ENTIRE_DIFF_OVERVIEW_WIDTH+"px"}}).root;this._register(sm(h,d.domNode)),this._register(ci(h,ee.POINTER_DOWN,u=>{this._editors.modified.delegateVerticalScrollbarPointerDown(u)})),this._register(H(h,ee.MOUSE_WHEEL,u=>{this._editors.modified.delegateScrollFromMouseWheelEvent(u)},{passive:!1})),this._register(sm(this._rootElement,h)),this._register(Is((u,g)=>{const f=this._diffModel.read(u),m=this._editors.original.createOverviewRuler("original diffOverviewRuler");m&&(g.add(m),g.add(sm(h,m.getDomNode())));const _=this._editors.modified.createOverviewRuler("modified diffOverviewRuler");if(_&&(g.add(_),g.add(sm(h,_.getDomNode()))),!m||!_)return;const b=Sn("viewZoneChanged",this._editors.original.onDidChangeViewZones),v=Sn("viewZoneChanged",this._editors.modified.onDidChangeViewZones),y=Sn("hiddenRangesChanged",this._editors.original.onDidChangeHiddenAreas),C=Sn("hiddenRangesChanged",this._editors.modified.onDidChangeHiddenAreas);g.add(Re(w=>{b.read(w),v.read(w),y.read(w),C.read(w);const x=c.read(w),k=f?.diff.read(w)?.mappings;function E(B,U,Z){const V=Z._getViewModel();return V?B.filter(Q=>Q.length>0).map(Q=>{const le=V.coordinatesConverter.convertModelPositionToViewPosition(new A(Q.startLineNumber,1)),ge=V.coordinatesConverter.convertModelPositionToViewPosition(new A(Q.endLineNumberExclusive,1)),_e=ge.lineNumber-le.lineNumber;return new ej(le.lineNumber,ge.lineNumber,_e,U.toString())}):[]}const N=E((k||[]).map(B=>B.lineRangeMapping.original),x.removeColor,this._editors.original),z=E((k||[]).map(B=>B.lineRangeMapping.modified),x.insertColor,this._editors.modified);m?.setZones(N),_?.setZones(z)})),g.add(Re(w=>{const x=this._rootHeight.read(w),k=this._rootWidth.read(w),E=this._modifiedEditorLayoutInfo.read(w);if(E){const N=ta.ENTIRE_DIFF_OVERVIEW_WIDTH-2*ta.ONE_OVERVIEW_WIDTH;m.setLayout({top:0,height:x,right:N+ta.ONE_OVERVIEW_WIDTH,width:ta.ONE_OVERVIEW_WIDTH}),_.setLayout({top:0,height:x,right:0,width:ta.ONE_OVERVIEW_WIDTH});const z=this._editors.modifiedScrollTop.read(w),B=this._editors.modifiedScrollHeight.read(w),U=this._editors.modified.getOption(104),Z=new x_(U.verticalHasArrows?U.arrowSize:0,U.verticalScrollbarSize,0,E.height,B,z);d.setTop(Z.getSliderPosition()),d.setHeight(Z.getSliderSize())}else d.setTop(0),d.setHeight(0);h.style.height=x+"px",h.style.left=k-ta.ENTIRE_DIFF_OVERVIEW_WIDTH+"px",d.setWidth(ta.ENTIRE_DIFF_OVERVIEW_WIDTH)}))}))}},ta=Ac,Ac.ONE_OVERVIEW_WIDTH=15,Ac.ENTIRE_DIFF_OVERVIEW_WIDTH=Ac.ONE_OVERVIEW_WIDTH*2,Ac);zy=ta=zbe([Ube(6,zi)],zy);const dN=[];class Gbe extends F{constructor(e,t,i,n){super(),this._editors=e,this._diffModel=t,this._options=i,this._widget=n,this._selectedDiffs=me(this,s=>{const a=this._diffModel.read(s)?.diff.read(s);if(!a)return dN;const l=this._editors.modifiedSelections.read(s);if(l.every(u=>u.isEmpty()))return dN;const c=new sr(l.map(u=>Be.fromRangeInclusive(u))),h=a.mappings.filter(u=>u.lineRangeMapping.innerChanges&&c.intersects(u.lineRangeMapping.modified)).map(u=>({mapping:u,rangeMappings:u.lineRangeMapping.innerChanges.filter(g=>l.some(f=>L.areIntersecting(g.modifiedRange,f)))}));return h.length===0||h.every(u=>u.rangeMappings.length===0)?dN:h}),this._register(Is((s,r)=>{if(!this._options.shouldRenderOldRevertArrows.read(s))return;const a=this._diffModel.read(s),l=a?.diff.read(s);if(!a||!l||a.movedTextToCompare.read(s))return;const c=[],d=this._selectedDiffs.read(s),h=new Set(d.map(u=>u.mapping));if(d.length>0){const u=this._editors.modifiedSelections.read(s),g=r.add(new uL(u[u.length-1].positionLineNumber,this._widget,d.flatMap(f=>f.rangeMappings),!0));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}for(const u of l.mappings)if(!h.has(u)&&!u.lineRangeMapping.modified.isEmpty&&u.lineRangeMapping.innerChanges){const g=r.add(new uL(u.lineRangeMapping.modified.startLineNumber,this._widget,u.lineRangeMapping,!1));this._editors.modified.addGlyphMarginWidget(g),c.push(g)}r.add(ve(()=>{for(const u of c)this._editors.modified.removeGlyphMarginWidget(u)}))}))}}const rE=class rE extends F{getId(){return this._id}constructor(e,t,i,n){super(),this._lineNumber=e,this._widget=t,this._diffs=i,this._revertSelection=n,this._id=`revertButton${rE.counter++}`,this._domNode=Ye("div.revertButton",{title:this._revertSelection?p("revertSelectedChanges","Revert Selected Changes"):p("revertChange","Revert Change")},[Sf(J.arrowRight)]).root,this._register(H(this._domNode,ee.MOUSE_DOWN,s=>{s.button!==2&&(s.stopPropagation(),s.preventDefault())})),this._register(H(this._domNode,ee.MOUSE_UP,s=>{s.stopPropagation(),s.preventDefault()})),this._register(H(this._domNode,ee.CLICK,s=>{this._diffs instanceof qn?this._widget.revert(this._diffs):this._widget.revertRangeMappings(this._diffs),s.stopPropagation(),s.preventDefault()}))}getDomNode(){return this._domNode}getPosition(){return{lane:Ur.Right,range:{startColumn:1,startLineNumber:this._lineNumber,endColumn:1,endLineNumber:this._lineNumber},zIndex:10001}}};rE.counter=0;let uL=rE;function $be(o,e,t){return cle({debugName:()=>`Configuration Key "${o}"`},i=>t.onDidChangeConfiguration(n=>{n.affectsConfiguration(o)&&i(n)}),()=>t.getValue(o)??e)}function sa(o,e,t){const i=o.bindTo(e);return Ow({debugName:()=>`Set Context Key "${o.key}"`},n=>{i.set(t(n))})}var Kbe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},U9=function(o,e){return function(t,i){e(t,i,o)}};let CO=class extends F{get onDidContentSizeChange(){return this._onDidContentSizeChange.event}constructor(e,t,i,n,s,r,a){super(),this.originalEditorElement=e,this.modifiedEditorElement=t,this._options=i,this._argCodeEditorWidgetOptions=n,this._createInnerEditor=s,this._instantiationService=r,this._keybindingService=a,this.original=this._register(this._createLeftHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.originalEditor||{})),this.modified=this._register(this._createRightHandSideEditor(this._options.editorOptions.get(),this._argCodeEditorWidgetOptions.modifiedEditor||{})),this._onDidContentSizeChange=this._register(new O),this.modifiedScrollTop=yt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollTop()),this.modifiedScrollHeight=yt(this,this.modified.onDidScrollChange,()=>this.modified.getScrollHeight()),this.modifiedObs=Qs(this.modified),this.originalObs=Qs(this.original),this.modifiedModel=this.modifiedObs.model,this.modifiedSelections=yt(this,this.modified.onDidChangeCursorSelection,()=>this.modified.getSelections()??[]),this.modifiedCursor=Eo({owner:this,equalsFn:A.equals},l=>this.modifiedSelections.read(l)[0]?.getPosition()??new A(1,1)),this.originalCursor=yt(this,this.original.onDidChangeCursorPosition,()=>this.original.getPosition()??new A(1,1)),this._argCodeEditorWidgetOptions=null,this._register(Fw({createEmptyChangeSummary:()=>({}),handleChange:(l,c)=>(l.didChange(i.editorOptions)&&Object.assign(c,l.change.changedOptions),!0)},(l,c)=>{i.editorOptions.read(l),this._options.renderSideBySide.read(l),this.modified.updateOptions(this._adjustOptionsForRightHandSide(l,c)),this.original.updateOptions(this._adjustOptionsForLeftHandSide(l,c))}))}_createLeftHandSideEditor(e,t){const i=this._adjustOptionsForLeftHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.originalEditorElement,i,t);return n.setContextValue("isInDiffLeftEditor",!0),n}_createRightHandSideEditor(e,t){const i=this._adjustOptionsForRightHandSide(void 0,e),n=this._constructInnerEditor(this._instantiationService,this.modifiedEditorElement,i,t);return n.setContextValue("isInDiffRightEditor",!0),n}_constructInnerEditor(e,t,i,n){const s=this._createInnerEditor(e,t,i,n);return this._register(s.onDidContentSizeChange(r=>{const a=this.original.getContentWidth()+this.modified.getContentWidth()+zy.ENTIRE_DIFF_OVERVIEW_WIDTH,l=Math.max(this.modified.getContentHeight(),this.original.getContentHeight());this._onDidContentSizeChange.fire({contentHeight:l,contentWidth:a,contentHeightChanged:r.contentHeightChanged,contentWidthChanged:r.contentWidthChanged})})),s}_adjustOptionsForLeftHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return this._options.renderSideBySide.get()?(i.unicodeHighlight=this._options.editorOptions.get().unicodeHighlight||{},i.wordWrapOverride1=this._options.diffWordWrap.get()):(i.wordWrapOverride1="off",i.wordWrapOverride2="off",i.stickyScroll={enabled:!1},i.unicodeHighlight={nonBasicASCII:!1,ambiguousCharacters:!1,invisibleCharacters:!1}),i.glyphMargin=this._options.renderSideBySide.get(),t.originalAriaLabel&&(i.ariaLabel=t.originalAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.readOnly=!this._options.originalEditable.get(),i.dropIntoEditor={enabled:!i.readOnly},i.extraEditorClassName="original-in-monaco-diff-editor",i}_adjustOptionsForRightHandSide(e,t){const i=this._adjustOptionsForSubEditor(t);return t.modifiedAriaLabel&&(i.ariaLabel=t.modifiedAriaLabel),i.ariaLabel=this._updateAriaLabel(i.ariaLabel),i.wordWrapOverride1=this._options.diffWordWrap.get(),i.revealHorizontalRightPadding=Oa.revealHorizontalRightPadding.defaultValue+zy.ENTIRE_DIFF_OVERVIEW_WIDTH,i.scrollbar.verticalHasArrows=!1,i.extraEditorClassName="modified-in-monaco-diff-editor",i}_adjustOptionsForSubEditor(e){const t={...e,dimension:{height:0,width:0}};return t.inDiffEditor=!0,t.automaticLayout=!1,t.scrollbar={...t.scrollbar||{}},t.folding=!1,t.codeLens=this._options.diffCodeLens.get(),t.fixedOverflowWidgets=!0,t.minimap={...t.minimap||{}},t.minimap.enabled=!1,this._options.hideUnchangedRegions.get()?t.stickyScroll={enabled:!1}:t.stickyScroll=this._options.editorOptions.get().stickyScroll,t}_updateAriaLabel(e){e||(e="");const t=p("diff-aria-navigation-tip"," use {0} to open the accessibility help.",this._keybindingService.lookupKeybinding("editor.action.accessibilityHelp")?.getAriaLabel());return this._options.accessibilityVerbose.get()?e+t:e?e.replaceAll(t,""):""}};CO=Kbe([U9(5,Ce),U9(6,vt)],CO);const aE=class aE extends F{constructor(){super(...arguments),this._id=++aE.idCounter,this._onDidDispose=this._register(new O),this.onDidDispose=this._onDidDispose.event}getId(){return this.getEditorType()+":v2:"+this._id}getVisibleColumnFromPosition(e){return this._targetEditor.getVisibleColumnFromPosition(e)}getPosition(){return this._targetEditor.getPosition()}setPosition(e,t="api"){this._targetEditor.setPosition(e,t)}revealLine(e,t=0){this._targetEditor.revealLine(e,t)}revealLineInCenter(e,t=0){this._targetEditor.revealLineInCenter(e,t)}revealLineInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealLineInCenterIfOutsideViewport(e,t)}revealLineNearTop(e,t=0){this._targetEditor.revealLineNearTop(e,t)}revealPosition(e,t=0){this._targetEditor.revealPosition(e,t)}revealPositionInCenter(e,t=0){this._targetEditor.revealPositionInCenter(e,t)}revealPositionInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealPositionInCenterIfOutsideViewport(e,t)}revealPositionNearTop(e,t=0){this._targetEditor.revealPositionNearTop(e,t)}getSelection(){return this._targetEditor.getSelection()}getSelections(){return this._targetEditor.getSelections()}setSelection(e,t="api"){this._targetEditor.setSelection(e,t)}setSelections(e,t="api"){this._targetEditor.setSelections(e,t)}revealLines(e,t,i=0){this._targetEditor.revealLines(e,t,i)}revealLinesInCenter(e,t,i=0){this._targetEditor.revealLinesInCenter(e,t,i)}revealLinesInCenterIfOutsideViewport(e,t,i=0){this._targetEditor.revealLinesInCenterIfOutsideViewport(e,t,i)}revealLinesNearTop(e,t,i=0){this._targetEditor.revealLinesNearTop(e,t,i)}revealRange(e,t=0,i=!1,n=!0){this._targetEditor.revealRange(e,t,i,n)}revealRangeInCenter(e,t=0){this._targetEditor.revealRangeInCenter(e,t)}revealRangeInCenterIfOutsideViewport(e,t=0){this._targetEditor.revealRangeInCenterIfOutsideViewport(e,t)}revealRangeNearTop(e,t=0){this._targetEditor.revealRangeNearTop(e,t)}revealRangeNearTopIfOutsideViewport(e,t=0){this._targetEditor.revealRangeNearTopIfOutsideViewport(e,t)}revealRangeAtTop(e,t=0){this._targetEditor.revealRangeAtTop(e,t)}getSupportedActions(){return this._targetEditor.getSupportedActions()}focus(){this._targetEditor.focus()}trigger(e,t,i){this._targetEditor.trigger(e,t,i)}createDecorationsCollection(e){return this._targetEditor.createDecorationsCollection(e)}changeDecorations(e){return this._targetEditor.changeDecorations(e)}};aE.idCounter=0;let yO=aE;var jbe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},qbe=function(o,e){return function(t,i){e(t,i,o)}};let wO=class{get editorOptions(){return this._options}constructor(e,t){this._accessibilityService=t,this._diffEditorWidth=$e(this,0),this._screenReaderMode=yt(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this.couldShowInlineViewBecauseOfSize=me(this,n=>this._options.read(n).renderSideBySide&&this._diffEditorWidth.read(n)<=this._options.read(n).renderSideBySideInlineBreakpoint),this.renderOverviewRuler=me(this,n=>this._options.read(n).renderOverviewRuler),this.renderSideBySide=me(this,n=>this.compactMode.read(n)&&this.shouldRenderInlineViewInSmartMode.read(n)?!1:this._options.read(n).renderSideBySide&&!(this._options.read(n).useInlineViewWhenSpaceIsLimited&&this.couldShowInlineViewBecauseOfSize.read(n)&&!this._screenReaderMode.read(n))),this.readOnly=me(this,n=>this._options.read(n).readOnly),this.shouldRenderOldRevertArrows=me(this,n=>!(!this._options.read(n).renderMarginRevertIcon||!this.renderSideBySide.read(n)||this.readOnly.read(n)||this.shouldRenderGutterMenu.read(n))),this.shouldRenderGutterMenu=me(this,n=>this._options.read(n).renderGutterMenu),this.renderIndicators=me(this,n=>this._options.read(n).renderIndicators),this.enableSplitViewResizing=me(this,n=>this._options.read(n).enableSplitViewResizing),this.splitViewDefaultRatio=me(this,n=>this._options.read(n).splitViewDefaultRatio),this.ignoreTrimWhitespace=me(this,n=>this._options.read(n).ignoreTrimWhitespace),this.maxComputationTimeMs=me(this,n=>this._options.read(n).maxComputationTime),this.showMoves=me(this,n=>this._options.read(n).experimental.showMoves&&this.renderSideBySide.read(n)),this.isInEmbeddedEditor=me(this,n=>this._options.read(n).isInEmbeddedEditor),this.diffWordWrap=me(this,n=>this._options.read(n).diffWordWrap),this.originalEditable=me(this,n=>this._options.read(n).originalEditable),this.diffCodeLens=me(this,n=>this._options.read(n).diffCodeLens),this.accessibilityVerbose=me(this,n=>this._options.read(n).accessibilityVerbose),this.diffAlgorithm=me(this,n=>this._options.read(n).diffAlgorithm),this.showEmptyDecorations=me(this,n=>this._options.read(n).experimental.showEmptyDecorations),this.onlyShowAccessibleDiffViewer=me(this,n=>this._options.read(n).onlyShowAccessibleDiffViewer),this.compactMode=me(this,n=>this._options.read(n).compactMode),this.trueInlineDiffRenderingEnabled=me(this,n=>this._options.read(n).experimental.useTrueInlineView),this.useTrueInlineDiffRendering=me(this,n=>!this.renderSideBySide.read(n)&&this.trueInlineDiffRenderingEnabled.read(n)),this.hideUnchangedRegions=me(this,n=>this._options.read(n).hideUnchangedRegions.enabled),this.hideUnchangedRegionsRevealLineCount=me(this,n=>this._options.read(n).hideUnchangedRegions.revealLineCount),this.hideUnchangedRegionsContextLineCount=me(this,n=>this._options.read(n).hideUnchangedRegions.contextLineCount),this.hideUnchangedRegionsMinimumLineCount=me(this,n=>this._options.read(n).hideUnchangedRegions.minimumLineCount),this._model=$e(this,void 0),this.shouldRenderInlineViewInSmartMode=this._model.map(this,n=>gle(this,s=>{const r=n?.diff.read(s);return r?Zbe(r,this.trueInlineDiffRenderingEnabled.read(s)):void 0})).flatten().map(this,n=>!!n),this.inlineViewHideOriginalLineNumbers=this.compactMode;const i={...e,...G9(e,bn)};this._options=$e(this,i)}updateOptions(e){const t=G9(e,this._options.get()),i={...this._options.get(),...e,...t};this._options.set(i,void 0,{changedOptions:e})}setWidth(e){this._diffEditorWidth.set(e,void 0)}setModel(e){this._model.set(e,void 0)}};wO=jbe([qbe(1,ho)],wO);function Zbe(o,e){return o.mappings.every(t=>Ybe(t.lineRangeMapping)||Xbe(t.lineRangeMapping)||e&&QB(t.lineRangeMapping))}function Ybe(o){return o.original.length===0}function Xbe(o){return o.modified.length===0}function G9(o,e){return{enableSplitViewResizing:be(o.enableSplitViewResizing,e.enableSplitViewResizing),splitViewDefaultRatio:JY(o.splitViewDefaultRatio,.5,.1,.9),renderSideBySide:be(o.renderSideBySide,e.renderSideBySide),renderMarginRevertIcon:be(o.renderMarginRevertIcon,e.renderMarginRevertIcon),maxComputationTime:Cu(o.maxComputationTime,e.maxComputationTime,0,1073741824),maxFileSize:Cu(o.maxFileSize,e.maxFileSize,0,1073741824),ignoreTrimWhitespace:be(o.ignoreTrimWhitespace,e.ignoreTrimWhitespace),renderIndicators:be(o.renderIndicators,e.renderIndicators),originalEditable:be(o.originalEditable,e.originalEditable),diffCodeLens:be(o.diffCodeLens,e.diffCodeLens),renderOverviewRuler:be(o.renderOverviewRuler,e.renderOverviewRuler),diffWordWrap:ui(o.diffWordWrap,e.diffWordWrap,["off","on","inherit"]),diffAlgorithm:ui(o.diffAlgorithm,e.diffAlgorithm,["legacy","advanced"],{smart:"legacy",experimental:"advanced"}),accessibilityVerbose:be(o.accessibilityVerbose,e.accessibilityVerbose),experimental:{showMoves:be(o.experimental?.showMoves,e.experimental.showMoves),showEmptyDecorations:be(o.experimental?.showEmptyDecorations,e.experimental.showEmptyDecorations),useTrueInlineView:be(o.experimental?.useTrueInlineView,e.experimental.useTrueInlineView)},hideUnchangedRegions:{enabled:be(o.hideUnchangedRegions?.enabled??o.experimental?.collapseUnchangedRegions,e.hideUnchangedRegions.enabled),contextLineCount:Cu(o.hideUnchangedRegions?.contextLineCount,e.hideUnchangedRegions.contextLineCount,0,1073741824),minimumLineCount:Cu(o.hideUnchangedRegions?.minimumLineCount,e.hideUnchangedRegions.minimumLineCount,0,1073741824),revealLineCount:Cu(o.hideUnchangedRegions?.revealLineCount,e.hideUnchangedRegions.revealLineCount,0,1073741824)},isInEmbeddedEditor:be(o.isInEmbeddedEditor,e.isInEmbeddedEditor),onlyShowAccessibleDiffViewer:be(o.onlyShowAccessibleDiffViewer,e.onlyShowAccessibleDiffViewer),renderSideBySideInlineBreakpoint:Cu(o.renderSideBySideInlineBreakpoint,e.renderSideBySideInlineBreakpoint,0,1073741824),useInlineViewWhenSpaceIsLimited:be(o.useInlineViewWhenSpaceIsLimited,e.useInlineViewWhenSpaceIsLimited),renderGutterMenu:be(o.renderGutterMenu,e.renderGutterMenu),compactMode:be(o.compactMode,e.compactMode)}}var Qbe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},iv=function(o,e){return function(t,i){e(t,i,o)}};let Xc=class extends yO{get onDidContentSizeChange(){return this._editors.onDidContentSizeChange}constructor(e,t,i,n,s,r,a,l){super(),this._domElement=e,this._parentContextKeyService=n,this._parentInstantiationService=s,this._accessibilitySignalService=a,this._editorProgressService=l,this.elements=Ye("div.monaco-diff-editor.side-by-side",{style:{position:"relative",height:"100%"}},[Ye("div.editor.original@original",{style:{position:"absolute",height:"100%"}}),Ye("div.editor.modified@modified",{style:{position:"absolute",height:"100%"}}),Ye("div.accessibleDiffViewer@accessibleDiffViewer",{style:{position:"absolute",height:"100%"}})]),this._diffModelSrc=this._register(my(this,void 0)),this._diffModel=me(this,C=>this._diffModelSrc.read(C)?.object),this.onDidChangeModel=se.fromObservableLight(this._diffModel),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._domElement)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new bb([Ee,this._contextKeyService]))),this._boundarySashes=$e(this,void 0),this._accessibleDiffViewerShouldBeVisible=$e(this,!1),this._accessibleDiffViewerVisible=me(this,C=>this._options.onlyShowAccessibleDiffViewer.read(C)?!0:this._accessibleDiffViewerShouldBeVisible.read(C)),this._movedBlocksLinesPart=$e(this,void 0),this._layoutInfo=me(this,C=>{const w=this._rootSizeObserver.width.read(C),x=this._rootSizeObserver.height.read(C);this._rootSizeObserver.automaticLayout?this.elements.root.style.height="100%":this.elements.root.style.height=x+"px";const k=this._sash.read(C),E=this._gutter.read(C),N=E?.width.read(C)??0,z=this._overviewRulerPart.read(C)?.width??0;let B,U,Z,V,Q;if(!!k){const ge=k.sashLeft.read(C),_e=this._movedBlocksLinesPart.read(C)?.width.read(C)??0;B=0,U=ge-N-_e,Q=ge-N,Z=ge,V=w-Z-z}else{Q=0;const ge=this._options.inlineViewHideOriginalLineNumbers.read(C);B=N,ge?U=0:U=Math.max(5,this._editors.originalObs.layoutInfoDecorationsLeft.read(C)),Z=N+U,V=w-Z-z}return this.elements.original.style.left=B+"px",this.elements.original.style.width=U+"px",this._editors.original.layout({width:U,height:x},!0),E?.layout(Q),this.elements.modified.style.left=Z+"px",this.elements.modified.style.width=V+"px",this._editors.modified.layout({width:V,height:x},!0),{modifiedEditor:this._editors.modified.getLayoutInfo(),originalEditor:this._editors.original.getLayoutInfo()}}),this._diffValue=this._diffModel.map((C,w)=>C?.diff.read(w)),this.onDidUpdateDiff=se.fromObservableLight(this._diffValue),r.willCreateDiffEditor(),this._contextKeyService.createKey("isInDiffEditor",!0),this._domElement.appendChild(this.elements.root),this._register(ve(()=>this.elements.root.remove())),this._rootSizeObserver=this._register(new oj(this.elements.root,t.dimension)),this._rootSizeObserver.setAutomaticLayout(t.automaticLayout??!1),this._options=this._instantiationService.createInstance(wO,t),this._register(Re(C=>{this._options.setWidth(this._rootSizeObserver.width.read(C))})),this._contextKeyService.createKey(T.isEmbeddedDiffEditor.key,!1),this._register(sa(T.isEmbeddedDiffEditor,this._contextKeyService,C=>this._options.isInEmbeddedEditor.read(C))),this._register(sa(T.comparingMovedCode,this._contextKeyService,C=>!!this._diffModel.read(C)?.movedTextToCompare.read(C))),this._register(sa(T.diffEditorRenderSideBySideInlineBreakpointReached,this._contextKeyService,C=>this._options.couldShowInlineViewBecauseOfSize.read(C))),this._register(sa(T.diffEditorInlineMode,this._contextKeyService,C=>!this._options.renderSideBySide.read(C))),this._register(sa(T.hasChanges,this._contextKeyService,C=>(this._diffModel.read(C)?.diff.read(C)?.mappings.length??0)>0)),this._editors=this._register(this._instantiationService.createInstance(CO,this.elements.original,this.elements.modified,this._options,i,(C,w,x,k)=>this._createInnerEditor(C,w,x,k))),this._register(sa(T.diffEditorOriginalWritable,this._contextKeyService,C=>this._options.originalEditable.read(C))),this._register(sa(T.diffEditorModifiedWritable,this._contextKeyService,C=>!this._options.readOnly.read(C))),this._register(sa(T.diffEditorOriginalUri,this._contextKeyService,C=>this._diffModel.read(C)?.model.original.uri.toString()??"")),this._register(sa(T.diffEditorModifiedUri,this._contextKeyService,C=>this._diffModel.read(C)?.model.modified.uri.toString()??"")),this._overviewRulerPart=Kn(this,C=>this._options.renderOverviewRuler.read(C)?this._instantiationService.createInstance(qs(zy,C),this._editors,this.elements.root,this._diffModel,this._rootSizeObserver.width,this._rootSizeObserver.height,this._layoutInfo.map(w=>w.modifiedEditor)):void 0).recomputeInitiallyAndOnChange(this._store);const c={height:this._rootSizeObserver.height,width:this._rootSizeObserver.width.map((C,w)=>C-(this._overviewRulerPart.read(w)?.width??0))};this._sashLayout=new Mbe(this._options,c),this._sash=Kn(this,C=>{const w=this._options.renderSideBySide.read(C);return this.elements.root.classList.toggle("side-by-side",w),w?new dj(this.elements.root,c,this._options.enableSplitViewResizing,this._boundarySashes,this._sashLayout.sashLeft,()=>this._sashLayout.resetSash()):void 0}).recomputeInitiallyAndOnChange(this._store);const d=Kn(this,C=>this._instantiationService.createInstance(qs(hL,C),this._editors,this._diffModel,this._options)).recomputeInitiallyAndOnChange(this._store);Kn(this,C=>this._instantiationService.createInstance(qs(Abe,C),this._editors,this._diffModel,this._options,this)).recomputeInitiallyAndOnChange(this._store);const h=new Set,u=new Set;let g=!1;const f=Kn(this,C=>this._instantiationService.createInstance(qs(pO,C),xe(this._domElement),this._editors,this._diffModel,this._options,this,()=>g||d.get().isUpdatingHiddenAreas,h,u)).recomputeInitiallyAndOnChange(this._store),m=me(this,C=>{const w=f.read(C).viewZones.read(C).orig,x=d.read(C).viewZones.read(C).origViewZones;return w.concat(x)}),_=me(this,C=>{const w=f.read(C).viewZones.read(C).mod,x=d.read(C).viewZones.read(C).modViewZones;return w.concat(x)});this._register(rL(this._editors.original,m,C=>{g=C},h));let b;this._register(rL(this._editors.modified,_,C=>{g=C,g?b=Ma.capture(this._editors.modified):(b?.restore(this._editors.modified),b=void 0)},u)),this._accessibleDiffViewer=Kn(this,C=>this._instantiationService.createInstance(qs(ig,C),this.elements.accessibleDiffViewer,this._accessibleDiffViewerVisible,(w,x)=>this._accessibleDiffViewerShouldBeVisible.set(w,x),this._options.onlyShowAccessibleDiffViewer.map(w=>!w),this._rootSizeObserver.width,this._rootSizeObserver.height,this._diffModel.map((w,x)=>w?.diff.read(x)?.mappings.map(k=>k.lineRangeMapping)),new wbe(this._editors))).recomputeInitiallyAndOnChange(this._store);const v=this._accessibleDiffViewerVisible.map(C=>C?"hidden":"visible");this._register(Yc(this.elements.modified,{visibility:v})),this._register(Yc(this.elements.original,{visibility:v})),this._createDiffEditorContributions(),r.addDiffEditor(this),this._gutter=Kn(this,C=>this._options.shouldRenderGutterMenu.read(C)?this._instantiationService.createInstance(qs(mO,C),this.elements.root,this._diffModel,this._editors,this._options,this._sashLayout,this._boundarySashes):void 0),this._register(fb(this._layoutInfo)),Kn(this,C=>new(qs(Xm,C))(this.elements.root,this._diffModel,this._layoutInfo.map(w=>w.originalEditor),this._layoutInfo.map(w=>w.modifiedEditor),this._editors)).recomputeInitiallyAndOnChange(this._store,C=>{this._movedBlocksLinesPart.set(C,void 0)}),this._register(se.runAndSubscribe(this._editors.modified.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!0))),this._register(se.runAndSubscribe(this._editors.original.onDidChangeCursorPosition,C=>this._handleCursorPositionChange(C,!1)));const y=this._diffModel.map(this,(C,w)=>{if(C)return C.diff.read(w)===void 0&&!C.isDiffUpToDate.read(w)});this._register(Is((C,w)=>{if(y.read(C)===!0){const x=this._editorProgressService.show(!0,1e3);w.add(ve(()=>x.done()))}})),this._register(Is((C,w)=>{w.add(new(qs(Gbe,C))(this._editors,this._diffModel,this._options,this))})),this._register(Is((C,w)=>{const x=this._diffModel.read(C);if(x)for(const k of[x.model.original,x.model.modified])w.add(k.onWillDispose(E=>{Ae(new pt("TextModel got disposed before DiffEditorWidget model got reset")),this.setModel(null)}))})),this._register(Re(C=>{this._options.setModel(this._diffModel.read(C))}))}_createInnerEditor(e,t,i,n){return e.createInstance(By,t,i,n)}_createDiffEditorContributions(){const e=lg.getDiffEditorContributions();for(const t of e)try{this._register(this._instantiationService.createInstance(t.ctor,this))}catch(i){Ae(i)}}get _targetEditor(){return this._editors.modified}getEditorType(){return Gw.IDiffEditor}layout(e){this._rootSizeObserver.observe(e)}hasTextFocus(){return this._editors.original.hasTextFocus()||this._editors.modified.hasTextFocus()}saveViewState(){const e=this._editors.original.saveViewState(),t=this._editors.modified.saveViewState();return{original:e,modified:t,modelState:this._diffModel.get()?.serializeState()}}restoreViewState(e){if(e&&e.original&&e.modified){const t=e;this._editors.original.restoreViewState(t.original),this._editors.modified.restoreViewState(t.modified),t.modelState&&this._diffModel.get()?.restoreSerializedState(t.modelState)}}handleInitialized(){this._editors.original.handleInitialized(),this._editors.modified.handleInitialized()}createViewModel(e){return this._instantiationService.createInstance(fO,e,this._options)}getModel(){return this._diffModel.get()?.model??null}setModel(e){const t=e?"model"in e?aL.create(e).createNewRef(this):aL.create(this.createViewModel(e),this):null;this.setDiffModel(t)}setDiffModel(e,t){const i=this._diffModel.get();!e&&i&&this._accessibleDiffViewer.get().close(),this._diffModel.get()!==e?.object&&kf(t,n=>{const s=e?.object;yt.batchEventsGlobally(n,()=>{this._editors.original.setModel(s?s.model.original:null),this._editors.modified.setModel(s?s.model.modified:null)});const r=this._diffModelSrc.get()?.createNewRef(this);this._diffModelSrc.set(e?.createNewRef(this),n),setTimeout(()=>{r?.dispose()},0)})}updateOptions(e){this._options.updateOptions(e)}getContainerDomNode(){return this._domElement}getOriginalEditor(){return this._editors.original}getModifiedEditor(){return this._editors.modified}getLineChanges(){const e=this._diffModel.get()?.diff.get();return e?Jbe(e):null}revert(e){const t=this._diffModel.get();!t||!t.isDiffUpToDate.get()||this._editors.modified.executeEdits("diffEditor",[{range:e.modified.toExclusiveRange(),text:t.model.original.getValueInRange(e.original.toExclusiveRange())}])}revertRangeMappings(e){const t=this._diffModel.get();if(!t||!t.isDiffUpToDate.get())return;const i=e.map(n=>({range:n.modifiedRange,text:t.model.original.getValueInRange(n.originalRange)}));this._editors.modified.executeEdits("diffEditor",i)}_goTo(e){this._editors.modified.setPosition(new A(e.lineRangeMapping.modified.startLineNumber,1)),this._editors.modified.revealRangeInCenter(e.lineRangeMapping.modified.toExclusiveRange())}goToDiff(e){const t=this._diffModel.get()?.diff.get()?.mappings;if(!t||t.length===0)return;const i=this._editors.modified.getPosition().lineNumber;let n;e==="next"?n=t.find(s=>s.lineRangeMapping.modified.startLineNumber>i)??t[0]:n=JC(t,s=>s.lineRangeMapping.modified.startLineNumber<i)??t[t.length-1],this._goTo(n),n.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(xo.diffLineDeleted,{source:"diffEditor.goToDiff"}):n.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(xo.diffLineInserted,{source:"diffEditor.goToDiff"}):n&&this._accessibilitySignalService.playSignal(xo.diffLineModified,{source:"diffEditor.goToDiff"})}revealFirstDiff(){const e=this._diffModel.get();e&&this.waitForDiff().then(()=>{const t=e.diff.get()?.mappings;!t||t.length===0||this._goTo(t[0])})}accessibleDiffViewerNext(){this._accessibleDiffViewer.get().next()}accessibleDiffViewerPrev(){this._accessibleDiffViewer.get().prev()}async waitForDiff(){const e=this._diffModel.get();e&&await e.waitForDiff()}mapToOtherSide(){const e=this._editors.modified.hasWidgetFocus(),t=e?this._editors.modified:this._editors.original,i=e?this._editors.original:this._editors.modified;let n;const s=t.getSelection();if(s){const r=this._diffModel.get()?.diff.get()?.mappings.map(a=>e?a.lineRangeMapping.flip():a.lineRangeMapping);if(r){const a=T9(s.getStartPosition(),r),l=T9(s.getEndPosition(),r);n=L.plusRange(a,l)}}return{destination:i,destinationSelection:n}}switchSide(){const{destination:e,destinationSelection:t}=this.mapToOtherSide();e.focus(),t&&e.setSelection(t)}exitCompareMove(){const e=this._diffModel.get();e&&e.movedTextToCompare.set(void 0,void 0)}collapseAllUnchangedRegions(){const e=this._diffModel.get()?.unchangedRegions.get();e&&oi(t=>{for(const i of e)i.collapseAll(t)})}showAllUnchangedRegions(){const e=this._diffModel.get()?.unchangedRegions.get();e&&oi(t=>{for(const i of e)i.showAll(t)})}_handleCursorPositionChange(e,t){if(e?.reason===3){const i=this._diffModel.get()?.diff.get()?.mappings.find(n=>t?n.lineRangeMapping.modified.contains(e.position.lineNumber):n.lineRangeMapping.original.contains(e.position.lineNumber));i?.lineRangeMapping.modified.isEmpty?this._accessibilitySignalService.playSignal(xo.diffLineDeleted,{source:"diffEditor.cursorPositionChanged"}):i?.lineRangeMapping.original.isEmpty?this._accessibilitySignalService.playSignal(xo.diffLineInserted,{source:"diffEditor.cursorPositionChanged"}):i&&this._accessibilitySignalService.playSignal(xo.diffLineModified,{source:"diffEditor.cursorPositionChanged"})}}};Xc=Qbe([iv(3,Ee),iv(4,Ce),iv(5,gt),iv(6,Jh),iv(7,Yh)],Xc);function Jbe(o){return o.mappings.map(e=>{const t=e.lineRangeMapping;let i,n,s,r,a=t.innerChanges;return t.original.isEmpty?(i=t.original.startLineNumber-1,n=0,a=void 0):(i=t.original.startLineNumber,n=t.original.endLineNumberExclusive-1),t.modified.isEmpty?(s=t.modified.startLineNumber-1,r=0,a=void 0):(s=t.modified.startLineNumber,r=t.modified.endLineNumberExclusive-1),{originalStartLineNumber:i,originalEndLineNumber:n,modifiedStartLineNumber:s,modifiedEndLineNumber:r,charChanges:a?.map(l=>({originalStartLineNumber:l.originalRange.startLineNumber,originalStartColumn:l.originalRange.startColumn,originalEndLineNumber:l.originalRange.endLineNumber,originalEndColumn:l.originalRange.endColumn,modifiedStartLineNumber:l.modifiedRange.startLineNumber,modifiedStartColumn:l.modifiedRange.startColumn,modifiedEndLineNumber:l.modifiedRange.endLineNumber,modifiedEndColumn:l.modifiedRange.endColumn}))}})}var eW=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Bt=function(o,e){return function(t,i){e(t,i,o)}};let eve=0,$9=!1;function tve(o){if(!o){if($9)return;$9=!0}sae(o||It.document.body)}let gL=class extends By{constructor(e,t,i,n,s,r,a,l,c,d,h,u,g){const f={...t};f.ariaLabel=f.ariaLabel||mA.editorViewAccessibleLabel,super(e,f,{},i,n,s,r,c,d,h,u,g),l instanceof A_?this._standaloneKeybindingService=l:this._standaloneKeybindingService=null,tve(f.ariaContainerElement),ble((m,_)=>i.createInstance(w_,m,_,{})),vle(a)}addCommand(e,t,i){if(!this._standaloneKeybindingService)return console.warn("Cannot add command because the editor is configured with an unrecognized KeybindingService"),null;const n="DYNAMIC_"+ ++eve,s=K.deserialize(i);return this._standaloneKeybindingService.addDynamicKeybinding(n,e,t,s),n}createContextKey(e,t){return this._contextKeyService.createKey(e,t)}addAction(e){if(typeof e.id!="string"||typeof e.label!="string"||typeof e.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");if(!this._standaloneKeybindingService)return console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),F.None;const t=e.id,i=e.label,n=K.and(K.equals("editorId",this.getId()),K.deserialize(e.precondition)),s=e.keybindings,r=K.and(n,K.deserialize(e.keybindingContext)),a=e.contextMenuGroupId||null,l=e.contextMenuOrder||0,c=(g,...f)=>Promise.resolve(e.run(this,...f)),d=new $,h=this.getId()+":"+t;if(d.add(st.registerCommand(h,c)),a){const g={command:{id:h,title:i},when:n,group:a,order:l};d.add(sn.appendMenuItem(fe.EditorContext,g))}if(Array.isArray(s))for(const g of s)d.add(this._standaloneKeybindingService.addDynamicKeybinding(h,g,c,r));const u=new tj(h,i,i,void 0,n,(...g)=>Promise.resolve(e.run(this,...g)),this._contextKeyService);return this._actions.set(t,u),d.add(ve(()=>{this._actions.delete(t)})),d}_triggerCommand(e,t){if(this._codeEditorService instanceof K0)try{this._codeEditorService.setActiveCodeEditor(this),super._triggerCommand(e,t)}finally{this._codeEditorService.setActiveCodeEditor(null)}else super._triggerCommand(e,t)}};gL=eW([Bt(2,Ce),Bt(3,gt),Bt(4,Ft),Bt(5,Ee),Bt(6,zl),Bt(7,vt),Bt(8,zi),Bt(9,Ei),Bt(10,ho),Bt(11,li),Bt(12,ue)],gL);let SO=class extends gL{constructor(e,t,i,n,s,r,a,l,c,d,h,u,g,f,m,_){const b={...t};zx(h,b,!1);const v=c.registerEditorContainer(e);typeof b.theme=="string"&&c.setTheme(b.theme),typeof b.autoDetectHighContrast<"u"&&c.setAutoDetectHighContrast(!!b.autoDetectHighContrast);const y=b.model;delete b.model,super(e,b,i,n,s,r,a,l,c,d,u,m,_),this._configurationService=h,this._standaloneThemeService=c,this._register(v);let C;if(typeof y>"u"){const w=f.getLanguageIdByMimeType(b.language)||b.language||hs;C=fj(g,f,b.value||"",w,void 0),this._ownsModel=!0}else C=y,this._ownsModel=!1;if(this._attachModel(C),C){const w={oldModelUrl:null,newModelUrl:C.uri};this._onDidChangeModel.fire(w)}}dispose(){super.dispose()}updateOptions(e){zx(this._configurationService,e,!1),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_postDetachModelCleanup(e){super._postDetachModelCleanup(e),e&&this._ownsModel&&(e.dispose(),this._ownsModel=!1)}};SO=eW([Bt(2,Ce),Bt(3,gt),Bt(4,Ft),Bt(5,Ee),Bt(6,zl),Bt(7,vt),Bt(8,Ko),Bt(9,Ei),Bt(10,Ke),Bt(11,ho),Bt(12,Ut),Bt(13,ti),Bt(14,li),Bt(15,ue)],SO);let xO=class extends Xc{constructor(e,t,i,n,s,r,a,l,c,d,h,u){const g={...t};zx(l,g,!0);const f=r.registerEditorContainer(e);typeof g.theme=="string"&&r.setTheme(g.theme),typeof g.autoDetectHighContrast<"u"&&r.setAutoDetectHighContrast(!!g.autoDetectHighContrast),super(e,g,{},n,i,s,u,d),this._configurationService=l,this._standaloneThemeService=r,this._register(f)}dispose(){super.dispose()}updateOptions(e){zx(this._configurationService,e,!0),typeof e.theme=="string"&&this._standaloneThemeService.setTheme(e.theme),typeof e.autoDetectHighContrast<"u"&&this._standaloneThemeService.setAutoDetectHighContrast(!!e.autoDetectHighContrast),super.updateOptions(e)}_createInnerEditor(e,t,i){return e.createInstance(gL,t,i)}getOriginalEditor(){return super.getOriginalEditor()}getModifiedEditor(){return super.getModifiedEditor()}addCommand(e,t,i){return this.getModifiedEditor().addCommand(e,t,i)}createContextKey(e,t){return this.getModifiedEditor().createContextKey(e,t)}addAction(e){return this.getModifiedEditor().addAction(e)}};xO=eW([Bt(2,Ce),Bt(3,Ee),Bt(4,gt),Bt(5,Ko),Bt(6,Ei),Bt(7,Ke),Bt(8,co),Bt(9,Yh),Bt(10,ad),Bt(11,Jh)],xO);function fj(o,e,t,i,n){if(t=t||"",!i){const s=t.indexOf(`
`);let r=t;return s!==-1&&(r=t.substring(0,s)),K9(o,t,e.createByFilepathOrFirstLine(n||null,r),n)}return K9(o,t,e.createById(i),n)}function K9(o,e,t,i){return o.createModel(e,t,i)}var ive=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},j9=function(o,e){return function(t,i){e(t,i,o)}};class nve{constructor(e,t){this.viewModel=e,this.deltaScrollVertical=t}getId(){return this.viewModel}}let fL=class extends F{constructor(e,t,i,n,s){super(),this._container=e,this._overflowWidgetsDomNode=t,this._workbenchUIElementFactory=i,this._instantiationService=n,this._viewModel=$e(this,void 0),this._collapsed=me(this,l=>this._viewModel.read(l)?.collapsed.read(l)),this._editorContentHeight=$e(this,500),this.contentHeight=me(this,l=>(this._collapsed.read(l)?0:this._editorContentHeight.read(l))+this._outerEditorHeight),this._modifiedContentWidth=$e(this,0),this._modifiedWidth=$e(this,0),this._originalContentWidth=$e(this,0),this._originalWidth=$e(this,0),this.maxScroll=me(this,l=>{const c=this._modifiedContentWidth.read(l)-this._modifiedWidth.read(l),d=this._originalContentWidth.read(l)-this._originalWidth.read(l);return c>d?{maxScroll:c,width:this._modifiedWidth.read(l)}:{maxScroll:d,width:this._originalWidth.read(l)}}),this._elements=Ye("div.multiDiffEntry",[Ye("div.header@header",[Ye("div.header-content",[Ye("div.collapse-button@collapseButton"),Ye("div.file-path",[Ye("div.title.modified.show-file-icons@primaryPath",[]),Ye("div.status.deleted@status",["R"]),Ye("div.title.original.show-file-icons@secondaryPath",[])]),Ye("div.actions@actions")])]),Ye("div.editorParent",[Ye("div.editorContainer@editor")])]),this.editor=this._register(this._instantiationService.createInstance(Xc,this._elements.editor,{overflowWidgetsDomNode:this._overflowWidgetsDomNode},{})),this.isModifedFocused=Qs(this.editor.getModifiedEditor()).isFocused,this.isOriginalFocused=Qs(this.editor.getOriginalEditor()).isFocused,this.isFocused=me(this,l=>this.isModifedFocused.read(l)||this.isOriginalFocused.read(l)),this._resourceLabel=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.primaryPath)):void 0,this._resourceLabel2=this._workbenchUIElementFactory.createResourceLabel?this._register(this._workbenchUIElementFactory.createResourceLabel(this._elements.secondaryPath)):void 0,this._dataStore=this._register(new $),this._headerHeight=40,this._lastScrollTop=-1,this._isSettingScrollTop=!1;const r=new Lx(this._elements.collapseButton,{});this._register(Re(l=>{r.element.className="",r.icon=this._collapsed.read(l)?J.chevronRight:J.chevronDown})),this._register(r.onDidClick(()=>{this._viewModel.get()?.collapsed.set(!this._collapsed.get(),void 0)})),this._register(Re(l=>{this._elements.editor.style.display=this._collapsed.read(l)?"none":"block"})),this._register(this.editor.getModifiedEditor().onDidLayoutChange(l=>{const c=this.editor.getModifiedEditor().getLayoutInfo().contentWidth;this._modifiedWidth.set(c,void 0)})),this._register(this.editor.getOriginalEditor().onDidLayoutChange(l=>{const c=this.editor.getOriginalEditor().getLayoutInfo().contentWidth;this._originalWidth.set(c,void 0)})),this._register(this.editor.onDidContentSizeChange(l=>{pv(c=>{this._editorContentHeight.set(l.contentHeight,c),this._modifiedContentWidth.set(this.editor.getModifiedEditor().getContentWidth(),c),this._originalContentWidth.set(this.editor.getOriginalEditor().getContentWidth(),c)})})),this._register(this.editor.getOriginalEditor().onDidScrollChange(l=>{if(this._isSettingScrollTop||!l.scrollTopChanged||!this._data)return;const c=l.scrollTop-this._lastScrollTop;this._data.deltaScrollVertical(c)})),this._register(Re(l=>{const c=this._viewModel.read(l)?.isActive.read(l);this._elements.root.classList.toggle("active",c)})),this._container.appendChild(this._elements.root),this._outerEditorHeight=this._headerHeight,this._contextKeyService=this._register(s.createScoped(this._elements.actions));const a=this._register(this._instantiationService.createChild(new bb([Ee,this._contextKeyService])));this._register(a.createInstance(dL,this._elements.actions,fe.MultiDiffEditorFileToolbar,{actionRunner:this._register(new hj(()=>this._viewModel.get()?.modifiedUri)),menuOptions:{shouldForwardArgs:!0},toolbarOptions:{primaryGroup:l=>l.startsWith("navigation")},actionViewItemProvider:(l,c)=>a$(a,l,c)}))}setScrollLeft(e){this._modifiedContentWidth.get()-this._modifiedWidth.get()>this._originalContentWidth.get()-this._originalWidth.get()?this.editor.getModifiedEditor().setScrollLeft(e):this.editor.getOriginalEditor().setScrollLeft(e)}setData(e){this._data=e;function t(n){return{...n,scrollBeyondLastLine:!1,hideUnchangedRegions:{enabled:!0},scrollbar:{vertical:"hidden",horizontal:"hidden",handleMouseWheel:!1,useShadows:!1},renderOverviewRuler:!1,fixedOverflowWidgets:!0,overviewRulerBorder:!1}}if(!e){pv(n=>{this._viewModel.set(void 0,n),this.editor.setDiffModel(null,n),this._dataStore.clear()});return}const i=e.viewModel.documentDiffItem;if(pv(n=>{this._resourceLabel?.setUri(e.viewModel.modifiedUri??e.viewModel.originalUri,{strikethrough:e.viewModel.modifiedUri===void 0});let s=!1,r=!1,a=!1,l="";e.viewModel.modifiedUri&&e.viewModel.originalUri&&e.viewModel.modifiedUri.path!==e.viewModel.originalUri.path?(l="R",s=!0):e.viewModel.modifiedUri?e.viewModel.originalUri||(l="A",a=!0):(l="D",r=!0),this._elements.status.classList.toggle("renamed",s),this._elements.status.classList.toggle("deleted",r),this._elements.status.classList.toggle("added",a),this._elements.status.innerText=l,this._resourceLabel2?.setUri(s?e.viewModel.originalUri:void 0,{strikethrough:!0}),this._dataStore.clear(),this._viewModel.set(e.viewModel,n),this.editor.setDiffModel(e.viewModel.diffEditorViewModelRef,n),this.editor.updateOptions(t(i.options??{}))}),i.onOptionsDidChange&&this._dataStore.add(i.onOptionsDidChange(()=>{this.editor.updateOptions(t(i.options??{}))})),e.viewModel.isAlive.recomputeInitiallyAndOnChange(this._dataStore,n=>{n||this.setData(void 0)}),e.viewModel.documentDiffItem.contextKeys)for(const[n,s]of Object.entries(e.viewModel.documentDiffItem.contextKeys))this._contextKeyService.createKey(n,s)}render(e,t,i,n){this._elements.root.style.visibility="visible",this._elements.root.style.top=`${e.start}px`,this._elements.root.style.height=`${e.length}px`,this._elements.root.style.width=`${t}px`,this._elements.root.style.position="absolute";const s=e.length-this._headerHeight,r=Math.max(0,Math.min(n.start-e.start,s));this._elements.header.style.transform=`translateY(${r}px)`,pv(a=>{this.editor.layout({width:t-2*8-2*1,height:e.length-this._outerEditorHeight})});try{this._isSettingScrollTop=!0,this._lastScrollTop=i,this.editor.getOriginalEditor().setScrollTop(i)}finally{this._isSettingScrollTop=!1}this._elements.header.classList.toggle("shadow",r>0||i>0),this._elements.header.classList.toggle("collapsed",r===s)}hide(){this._elements.root.style.top="-100000px",this._elements.root.style.visibility="hidden"}};fL=ive([j9(3,Ce),j9(4,Ee)],fL);class sve{constructor(e){this._create=e,this._unused=new Set,this._used=new Set,this._itemData=new Map}getUnusedObj(e){let t;if(this._unused.size===0)t=this._create(e),this._itemData.set(t,e);else{const i=[...this._unused.values()];t=i.find(n=>this._itemData.get(n).getId()===e.getId())??i[0],this._unused.delete(t),this._itemData.set(t,e),t.setData(e)}return this._used.add(t),{object:t,dispose:()=>{this._used.delete(t),this._unused.size>5?t.dispose():this._unused.add(t)}}}dispose(){for(const e of this._used)e.dispose();for(const e of this._unused)e.dispose();this._used.clear(),this._unused.clear()}}var ove=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},q9=function(o,e){return function(t,i){e(t,i,o)}};let LO=class extends F{constructor(e,t,i,n,s,r){super(),this._element=e,this._dimension=t,this._viewModel=i,this._workbenchUIElementFactory=n,this._parentContextKeyService=s,this._parentInstantiationService=r,this._scrollableElements=Ye("div.scrollContent",[Ye("div@content",{style:{overflow:"hidden"}}),Ye("div.monaco-editor@overflowWidgetsDomNode",{})]),this._scrollable=this._register(new db({forceIntegerValues:!1,scheduleAtNextAnimationFrame:l=>ao(xe(this._element),l),smoothScrollDuration:100})),this._scrollableElement=this._register(new RT(this._scrollableElements.root,{vertical:1,horizontal:1,useShadows:!1},this._scrollable)),this._elements=Ye("div.monaco-component.multiDiffEditor",{},[Ye("div",{},[this._scrollableElement.getDomNode()]),Ye("div.placeholder@placeholder",{},[Ye("div",[p("noChangedFiles","No Changed Files")])])]),this._sizeObserver=this._register(new oj(this._element,void 0)),this._objectPool=this._register(new sve(l=>{const c=this._instantiationService.createInstance(fL,this._scrollableElements.content,this._scrollableElements.overflowWidgetsDomNode,this._workbenchUIElementFactory);return c.setData(l),c})),this.scrollTop=yt(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollTop),this.scrollLeft=yt(this,this._scrollableElement.onScroll,()=>this._scrollableElement.getScrollPosition().scrollLeft),this._viewItemsInfo=Xh(this,(l,c)=>{const d=this._viewModel.read(l);if(!d)return{items:[],getItem:f=>{throw new pt}};const h=d.items.read(l),u=new Map;return{items:h.map(f=>{const m=c.add(new rve(f,this._objectPool,this.scrollLeft,b=>{this._scrollableElement.setScrollPosition({scrollTop:this._scrollableElement.getScrollPosition().scrollTop+b})})),_=this._lastDocStates?.[m.getKey()];return _&&oi(b=>{m.setViewState(_,b)}),u.set(f,m),m}),getItem:f=>u.get(f)}}),this._viewItems=this._viewItemsInfo.map(this,l=>l.items),this._spaceBetweenPx=0,this._totalHeight=this._viewItems.map(this,(l,c)=>l.reduce((d,h)=>d+h.contentHeight.read(c)+this._spaceBetweenPx,0)),this._contextKeyService=this._register(this._parentContextKeyService.createScoped(this._element)),this._instantiationService=this._register(this._parentInstantiationService.createChild(new bb([Ee,this._contextKeyService]))),this._lastDocStates={},this._contextKeyService.createKey(T.inMultiDiffEditor.key,!0),this._register(Is((l,c)=>{const d=this._viewModel.read(l);if(d&&d.contextKeys)for(const[h,u]of Object.entries(d.contextKeys)){const g=this._contextKeyService.createKey(h,void 0);g.set(u),c.add(ve(()=>g.reset()))}}));const a=this._parentContextKeyService.createKey(T.multiDiffEditorAllCollapsed.key,!1);this._register(Re(l=>{const c=this._viewModel.read(l);if(c){const d=c.items.read(l).every(h=>h.collapsed.read(l));a.set(d)}})),this._register(Re(l=>{const c=this._dimension.read(l);this._sizeObserver.observe(c)})),this._register(Re(l=>{const c=this._viewItems.read(l);this._elements.placeholder.classList.toggle("visible",c.length===0)})),this._scrollableElements.content.style.position="relative",this._register(Re(l=>{const c=this._sizeObserver.height.read(l);this._scrollableElements.root.style.height=`${c}px`;const d=this._totalHeight.read(l);this._scrollableElements.content.style.height=`${d}px`;const h=this._sizeObserver.width.read(l);let u=h;const g=this._viewItems.read(l),f=e5(g,cs(m=>m.maxScroll.read(l).maxScroll,Br));if(f){const m=f.maxScroll.read(l);u=h+m.maxScroll}this._scrollableElement.setScrollDimensions({width:h,height:c,scrollHeight:d,scrollWidth:u})})),e.replaceChildren(this._elements.root),this._register(ve(()=>{e.replaceChildren()})),this._register(this._register(Re(l=>{pv(c=>{this.render(l)})})))}render(e){const t=this.scrollTop.read(e);let i=0,n=0,s=0;const r=this._sizeObserver.height.read(e),a=je.ofStartAndLength(t,r),l=this._sizeObserver.width.read(e);for(const c of this._viewItems.read(e)){const d=c.contentHeight.read(e),h=Math.min(d,r),u=je.ofStartAndLength(n,h),g=je.ofStartAndLength(s,d);if(g.isBefore(a))i-=d-h,c.hide();else if(g.isAfter(a))c.hide();else{const f=Math.max(0,Math.min(a.start-g.start,d-h));i-=f;const m=je.ofStartAndLength(t+i,r);c.render(u,f,l,m)}n+=h+this._spaceBetweenPx,s+=d+this._spaceBetweenPx}this._scrollableElements.content.style.transform=`translateY(${-(t+i)}px)`}};LO=ove([q9(4,Ee),q9(5,Ce)],LO);class rve extends F{constructor(e,t,i,n){super(),this.viewModel=e,this._objectPool=t,this._scrollLeft=i,this._deltaScrollVertical=n,this._templateRef=this._register(my(this,void 0)),this.contentHeight=me(this,s=>this._templateRef.read(s)?.object.contentHeight?.read(s)??this.viewModel.lastTemplateData.read(s).contentHeight),this.maxScroll=me(this,s=>this._templateRef.read(s)?.object.maxScroll.read(s)??{maxScroll:0,scrollWidth:0}),this.template=me(this,s=>this._templateRef.read(s)?.object),this._isHidden=$e(this,!1),this._isFocused=me(this,s=>this.template.read(s)?.isFocused.read(s)??!1),this.viewModel.setIsFocused(this._isFocused,void 0),this._register(Re(s=>{const r=this._scrollLeft.read(s);this._templateRef.read(s)?.object.setScrollLeft(r)})),this._register(Re(s=>{const r=this._templateRef.read(s);!r||!this._isHidden.read(s)||r.object.isFocused.read(s)||this._clear()}))}dispose(){this._clear(),super.dispose()}toString(){return`VirtualViewItem(${this.viewModel.documentDiffItem.modified?.uri.toString()})`}getKey(){return this.viewModel.getKey()}setViewState(e,t){this.viewModel.collapsed.set(e.collapsed,t),this._updateTemplateData(t);const i=this.viewModel.lastTemplateData.get(),n=e.selections?.map(pe.liftSelection);this.viewModel.lastTemplateData.set({...i,selections:n},t);const s=this._templateRef.get();s&&n&&s.object.editor.setSelections(n)}_updateTemplateData(e){const t=this._templateRef.get();t&&this.viewModel.lastTemplateData.set({contentHeight:t.object.contentHeight.get(),selections:t.object.editor.getSelections()??void 0},e)}_clear(){const e=this._templateRef.get();e&&oi(t=>{this._updateTemplateData(t),e.object.hide(),this._templateRef.set(void 0,t)})}hide(){this._isHidden.set(!0,void 0)}render(e,t,i,n){this._isHidden.set(!1,void 0);let s=this._templateRef.get();if(!s){s=this._objectPool.getUnusedObj(new nve(this.viewModel,this._deltaScrollVertical)),this._templateRef.set(s,void 0);const r=this.viewModel.lastTemplateData.get().selections;r&&s.object.editor.setSelections(r)}s.object.render(e,i,t,n)}}D("multiDiffEditor.headerBackground",{dark:"#262626",light:"tab.inactiveBackground",hcDark:"tab.inactiveBackground",hcLight:"tab.inactiveBackground"},p("multiDiffEditor.headerBackground","The background color of the diff editor's header"));D("multiDiffEditor.background",$r,p("multiDiffEditor.background","The background color of the multi file diff editor"));D("multiDiffEditor.border",{dark:"sideBarSectionHeader.border",light:"#cccccc",hcDark:"sideBarSectionHeader.border",hcLight:"#cccccc"},p("multiDiffEditor.border","The border color of the multi file diff editor"));var ave=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},lve=function(o,e){return function(t,i){e(t,i,o)}};let kO=class extends F{constructor(e,t,i){super(),this._element=e,this._workbenchUIElementFactory=t,this._instantiationService=i,this._dimension=$e(this,void 0),this._viewModel=$e(this,void 0),this._widgetImpl=Xh(this,(n,s)=>(qs(fL,n),s.add(this._instantiationService.createInstance(qs(LO,n),this._element,this._dimension,this._viewModel,this._workbenchUIElementFactory)))),this._register(fb(this._widgetImpl))}};kO=ave([lve(2,Ce)],kO);function cve(o,e,t){return Ie.initialize(t||{}).createInstance(SO,o,e)}function dve(o){return Ie.get(gt).onCodeEditorAdd(t=>{o(t)})}function hve(o){return Ie.get(gt).onDiffEditorAdd(t=>{o(t)})}function uve(){return Ie.get(gt).listCodeEditors()}function gve(){return Ie.get(gt).listDiffEditors()}function fve(o,e,t){return Ie.initialize(t||{}).createInstance(xO,o,e)}function pve(o,e){const t=Ie.initialize(e||{});return new kO(o,{},t)}function mve(o){if(typeof o.id!="string"||typeof o.run!="function")throw new Error("Invalid command descriptor, `id` and `run` are required properties!");return st.registerCommand(o.id,o.run)}function _ve(o){if(typeof o.id!="string"||typeof o.label!="string"||typeof o.run!="function")throw new Error("Invalid action descriptor, `id`, `label` and `run` are required properties!");const e=K.deserialize(o.precondition),t=(n,...s)=>Hi.runEditorCommand(n,s,e,(r,a,l)=>Promise.resolve(o.run(a,...l))),i=new $;if(i.add(st.registerCommand(o.id,t)),o.contextMenuGroupId){const n={command:{id:o.id,title:o.label},when:e,group:o.contextMenuGroupId,order:o.contextMenuOrder||0};i.add(sn.appendMenuItem(fe.EditorContext,n))}if(Array.isArray(o.keybindings)){const n=Ie.get(vt);if(!(n instanceof A_))console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService");else{const s=K.and(e,K.deserialize(o.keybindingContext));i.add(n.addDynamicKeybindings(o.keybindings.map(r=>({keybinding:r,command:o.id,when:s}))))}}return i}function bve(o){return pj([o])}function pj(o){const e=Ie.get(vt);return e instanceof A_?e.addDynamicKeybindings(o.map(t=>({keybinding:t.keybinding,command:t.command,commandArgs:t.commandArgs,when:K.deserialize(t.when)}))):(console.warn("Cannot add keybinding because the editor is configured with an unrecognized KeybindingService"),F.None)}function vve(o,e,t){const i=Ie.get(ti),n=i.getLanguageIdByMimeType(e)||e;return fj(Ie.get(Ut),i,o,n,t)}function Cve(o,e){const t=Ie.get(ti),i=t.getLanguageIdByMimeType(e)||e||hs;o.setLanguage(t.createById(i))}function yve(o,e,t){o&&Ie.get(Ul).changeOne(e,o.uri,t)}function wve(o){Ie.get(Ul).changeAll(o,[])}function Sve(o){return Ie.get(Ul).read(o)}function xve(o){return Ie.get(Ul).onMarkerChanged(o)}function Lve(o){return Ie.get(Ut).getModel(o)}function kve(){return Ie.get(Ut).getModels()}function Eve(o){return Ie.get(Ut).onModelAdded(o)}function Tve(o){return Ie.get(Ut).onModelRemoved(o)}function Dve(o){return Ie.get(Ut).onModelLanguageChanged(t=>{o({model:t.model,oldLanguage:t.oldLanguageId})})}function Ive(o){return gfe(Ie.get(Ut),o)}function Nve(o,e){const t=Ie.get(ti),i=Ie.get(Ko);return yB.colorizeElement(i,t,o,e).then(()=>{i.registerEditorContainer(o)})}function Rve(o,e,t){const i=Ie.get(ti);return Ie.get(Ko).registerEditorContainer(It.document.body),yB.colorize(i,o,e,t)}function Pve(o,e,t=4){return Ie.get(Ko).registerEditorContainer(It.document.body),yB.colorizeModelLine(o,e,t)}function Ave(o){const e=gi.get(o);return e||{getInitialState:()=>k_,tokenize:(t,i,n)=>I5(o,n)}}function Mve(o,e){gi.getOrCreate(e);const t=Ave(e),i=Bl(o),n=[];let s=t.getInitialState();for(let r=0,a=i.length;r<a;r++){const l=i[r],c=t.tokenize(l,!0,s);n[r]=c.tokens,s=c.endState}return n}function Ove(o,e){Ie.get(Ko).defineTheme(o,e)}function Fve(o){Ie.get(Ko).setTheme(o)}function Bve(){gP.clearAllFontInfos()}function Wve(o,e){return st.registerCommand({id:o,handler:e})}function Vve(o){return Ie.get(Fs).registerOpener({async open(t){return typeof t=="string"&&(t=ye.parse(t)),o.open(t)}})}function Hve(o){return Ie.get(gt).registerCodeEditorOpenHandler(async(t,i,n)=>{if(!i)return null;const s=t.options?.selection;let r;return s&&typeof s.endLineNumber=="number"&&typeof s.endColumn=="number"?r=s:s&&(r={lineNumber:s.startLineNumber,column:s.startColumn}),await o.openCodeEditor(i,t.resource,r)?i:null})}function zve(){return{create:cve,getEditors:uve,getDiffEditors:gve,onDidCreateEditor:dve,onDidCreateDiffEditor:hve,createDiffEditor:fve,addCommand:mve,addEditorAction:_ve,addKeybindingRule:bve,addKeybindingRules:pj,createModel:vve,setModelLanguage:Cve,setModelMarkers:yve,getModelMarkers:Sve,removeAllMarkers:wve,onDidChangeMarkers:xve,getModels:kve,getModel:Lve,onDidCreateModel:Eve,onWillDisposeModel:Tve,onDidChangeModelLanguage:Dve,createWebWorker:Ive,colorizeElement:Nve,colorize:Rve,colorizeModelLine:Pve,tokenize:Mve,defineTheme:Ove,setTheme:Fve,remeasureFonts:Bve,registerCommand:Wve,registerLinkOpener:Vve,registerEditorOpener:Hve,AccessibilitySupport:lR,ContentWidgetPositionPreference:fR,CursorChangeReason:pR,DefaultEndOfLine:mR,EditorAutoIndentStrategy:bR,EditorOption:vR,EndOfLinePreference:CR,EndOfLineSequence:yR,MinimapPosition:RR,MinimapSectionHeaderStyle:PR,MouseTargetType:AR,OverlayWidgetPositionPreference:FR,OverviewRulerLane:BR,GlyphMarginLane:wR,RenderLineNumbersType:HR,RenderMinimap:zR,ScrollbarVisibility:GR,ScrollType:UR,TextEditorCursorBlinkingStyle:YR,TextEditorCursorStyle:XR,TrackedRangeStickiness:QR,WrappingIndent:JR,InjectedTextCursorStops:LR,PositionAffinity:VR,ShowLightbulbIconMode:KR,ConfigurationChangedEvent:sz,BareFontInfo:rg,FontInfo:uP,TextModelResolvedOptions:P1,FindMatch:QC,ApplyUpdateResult:Pv,EditorZoom:ir,createMultiFileDiffEditor:pve,EditorType:Gw,EditorOptions:Oa}}function Uve(o,e){if(!e||!Array.isArray(e))return!1;for(const t of e)if(!o(t))return!1;return!0}function i1(o,e){return typeof o=="boolean"?o:e}function Z9(o,e){return typeof o=="string"?o:e}function Gve(o){const e={};for(const t of o)e[t]=!0;return e}function Y9(o,e=!1){e&&(o=o.map(function(i){return i.toLowerCase()}));const t=Gve(o);return e?function(i){return t[i.toLowerCase()]!==void 0&&t.hasOwnProperty(i.toLowerCase())}:function(i){return t[i]!==void 0&&t.hasOwnProperty(i)}}function EO(o,e,t){e=e.replace(/@@/g,"");let i=0,n;do n=!1,e=e.replace(/@(\w+)/g,function(r,a){n=!0;let l="";if(typeof o[a]=="string")l=o[a];else if(o[a]&&o[a]instanceof RegExp)l=o[a].source;else throw o[a]===void 0?Kt(o,"language definition does not contain attribute '"+a+"', used at: "+e):Kt(o,"attribute reference '"+a+"' must be a string, used at: "+e);return Vu(l)?"":"(?:"+l+")"}),i++;while(n&&i<5);e=e.replace(/\x01/g,"@");const s=(o.ignoreCase?"i":"")+(o.unicode?"u":"");if(t&&e.match(/\$[sS](\d\d?)/g)){let a=null,l=null;return c=>(l&&a===c||(a=c,l=new RegExp(Rfe(o,e,c),s)),l)}return new RegExp(e,s)}function $ve(o,e,t,i){if(i<0)return o;if(i<e.length)return e[i];if(i>=100){i=i-100;const n=t.split(".");if(n.unshift(t),i<n.length)return n[i]}return null}function Kve(o,e,t,i){let n=-1,s=t,r=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);r&&(r[3]&&(n=parseInt(r[3]),r[2]&&(n=n+100)),s=r[4]);let a="~",l=s;!s||s.length===0?(a="!=",l=""):/^\w*$/.test(l)?a="==":(r=s.match(/^(@|!@|~|!~|==|!=)(.*)$/),r&&(a=r[1],l=r[2]));let c;if((a==="~"||a==="!~")&&/^(\w|\|)*$/.test(l)){const d=Y9(l.split("|"),o.ignoreCase);c=function(h){return a==="~"?d(h):!d(h)}}else if(a==="@"||a==="!@"){const d=o[l];if(!d)throw Kt(o,"the @ match target '"+l+"' is not defined, in rule: "+e);if(!Uve(function(u){return typeof u=="string"},d))throw Kt(o,"the @ match target '"+l+"' must be an array of strings, in rule: "+e);const h=Y9(d,o.ignoreCase);c=function(u){return a==="@"?h(u):!h(u)}}else if(a==="~"||a==="!~")if(l.indexOf("$")<0){const d=EO(o,"^"+l+"$",!1);c=function(h){return a==="~"?d.test(h):!d.test(h)}}else c=function(d,h,u,g){return EO(o,"^"+Ad(o,l,h,u,g)+"$",!1).test(d)};else if(l.indexOf("$")<0){const d=Vc(o,l);c=function(h){return a==="=="?h===d:h!==d}}else{const d=Vc(o,l);c=function(h,u,g,f,m){const _=Ad(o,d,u,g,f);return a==="=="?h===_:h!==_}}return n===-1?{name:t,value:i,test:function(d,h,u,g){return c(d,d,h,u,g)}}:{name:t,value:i,test:function(d,h,u,g){const f=$ve(d,h,u,n);return c(f||"",d,h,u,g)}}}function TO(o,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw Kt(o,"a 'token' attribute must be of type string, in rule: "+e);{const i={token:t.token};if(t.token.indexOf("$")>=0&&(i.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")i.bracket=1;else if(t.bracket==="@close")i.bracket=-1;else throw Kt(o,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw Kt(o,"the next state must be a string value in rule: "+e);{let n=t.next;if(!/^(@pop|@push|@popall)$/.test(n)&&(n[0]==="@"&&(n=n.substr(1)),n.indexOf("$")<0&&!Pfe(o,Ad(o,n,"",[],""))))throw Kt(o,"the next state '"+t.next+"' is not defined in rule: "+e);i.next=n}}return typeof t.goBack=="number"&&(i.goBack=t.goBack),typeof t.switchTo=="string"&&(i.switchTo=t.switchTo),typeof t.log=="string"&&(i.log=t.log),typeof t.nextEmbedded=="string"&&(i.nextEmbedded=t.nextEmbedded,o.usesEmbedded=!0),i}}else if(Array.isArray(t)){const i=[];for(let n=0,s=t.length;n<s;n++)i[n]=TO(o,e,t[n]);return{group:i}}else if(t.cases){const i=[];for(const s in t.cases)if(t.cases.hasOwnProperty(s)){const r=TO(o,e,t.cases[s]);s==="@default"||s==="@"||s===""?i.push({test:void 0,value:r,name:s}):s==="@eos"?i.push({test:function(a,l,c,d){return d},value:r,name:s}):i.push(Kve(o,e,s,r))}const n=o.defaultToken;return{test:function(s,r,a,l){for(const c of i)if(!c.test||c.test(s,r,a,l))return c.value;return n}}}else throw Kt(o,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}class jve{constructor(e){this.regex=new RegExp(""),this.action={token:""},this.matchOnlyAtLineStart=!1,this.name="",this.name=e}setRegex(e,t){let i;if(typeof t=="string")i=t;else if(t instanceof RegExp)i=t.source;else throw Kt(e,"rules must start with a match string or regular expression: "+this.name);this.matchOnlyAtLineStart=i.length>0&&i[0]==="^",this.name=this.name+": "+i,this.regex=EO(e,"^(?:"+(this.matchOnlyAtLineStart?i.substr(1):i)+")",!0)}setAction(e,t){this.action=TO(e,this.name,t)}resolveRegex(e){return this.regex instanceof RegExp?this.regex:this.regex(e)}}function mj(o,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");const t={languageId:o,includeLF:i1(e.includeLF,!1),noThrow:!1,maxStack:100,start:typeof e.start=="string"?e.start:null,ignoreCase:i1(e.ignoreCase,!1),unicode:i1(e.unicode,!1),tokenPostfix:Z9(e.tokenPostfix,"."+o),defaultToken:Z9(e.defaultToken,"source"),usesEmbedded:!1,stateNames:{},tokenizer:{},brackets:[]},i=e;i.languageId=o,i.includeLF=t.includeLF,i.ignoreCase=t.ignoreCase,i.unicode=t.unicode,i.noThrow=t.noThrow,i.usesEmbedded=t.usesEmbedded,i.stateNames=e.tokenizer,i.defaultToken=t.defaultToken;function n(r,a,l){for(const c of l){let d=c.include;if(d){if(typeof d!="string")throw Kt(t,"an 'include' attribute must be a string at: "+r);if(d[0]==="@"&&(d=d.substr(1)),!e.tokenizer[d])throw Kt(t,"include target '"+d+"' is not defined at: "+r);n(r+"."+d,a,e.tokenizer[d])}else{const h=new jve(r);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(h.setRegex(i,c[0]),c.length>=3)if(typeof c[1]=="string")h.setAction(i,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){const u=c[1];u.next=c[2],h.setAction(i,u)}else throw Kt(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+r);else h.setAction(i,c[1]);else{if(!c.regex)throw Kt(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+r);c.name&&typeof c.name=="string"&&(h.name=c.name),c.matchOnlyAtStart&&(h.matchOnlyAtLineStart=i1(c.matchOnlyAtLineStart,!1)),h.setRegex(i,c.regex),h.setAction(i,c.action)}a.push(h)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw Kt(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(const r in e.tokenizer)if(e.tokenizer.hasOwnProperty(r)){t.start||(t.start=r);const a=e.tokenizer[r];t.tokenizer[r]=new Array,n("tokenizer."+r,t.tokenizer[r],a)}if(t.usesEmbedded=i.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw Kt(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];const s=[];for(const r of e.brackets){let a=r;if(a&&Array.isArray(a)&&a.length===3&&(a={token:a[2],open:a[0],close:a[1]}),a.open===a.close)throw Kt(t,"open and close brackets in a 'brackets' attribute must be different: "+a.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof a.open=="string"&&typeof a.token=="string"&&typeof a.close=="string")s.push({token:a.token+t.tokenPostfix,open:Vc(t,a.open),close:Vc(t,a.close)});else throw Kt(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=s,t.noThrow=!0,t}function qve(o){__.registerLanguage(o)}function Zve(){let o=[];return o=o.concat(__.getLanguages()),o}function Yve(o){return Ie.get(ti).languageIdCodec.encodeLanguageId(o)}function Xve(o,e){return Ie.withServices(()=>{const i=Ie.get(ti).onDidRequestRichLanguageFeatures(n=>{n===o&&(i.dispose(),e())});return i})}function Qve(o,e){return Ie.withServices(()=>{const i=Ie.get(ti).onDidRequestBasicLanguageFeatures(n=>{n===o&&(i.dispose(),e())});return i})}function Jve(o,e){if(!Ie.get(ti).isRegisteredLanguageId(o))throw new Error(`Cannot set configuration for unknown language ${o}`);return Ie.get(li).register(o,e,100)}class eCe{constructor(e,t){this._languageId=e,this._actual=t}dispose(){}getInitialState(){return this._actual.getInitialState()}tokenize(e,t,i){if(typeof this._actual.tokenize=="function")return Uy.adaptTokenize(this._languageId,this._actual,e,i);throw new Error("Not supported!")}tokenizeEncoded(e,t,i){const n=this._actual.tokenizeEncoded(e,i);return new eT(n.tokens,n.endState)}}class Uy{constructor(e,t,i,n){this._languageId=e,this._actual=t,this._languageService=i,this._standaloneThemeService=n}dispose(){}getInitialState(){return this._actual.getInitialState()}static _toClassicTokens(e,t){const i=[];let n=0;for(let s=0,r=e.length;s<r;s++){const a=e[s];let l=a.startIndex;s===0?l=0:l<n&&(l=n),i[s]=new UC(l,a.scopes,t),n=l}return i}static adaptTokenize(e,t,i,n){const s=t.tokenize(i,n),r=Uy._toClassicTokens(s.tokens,e);let a;return s.endState.equals(n)?a=n:a=s.endState,new D4(r,a)}tokenize(e,t,i){return Uy.adaptTokenize(this._languageId,this._actual,e,i)}_toBinaryTokens(e,t){const i=e.encodeLanguageId(this._languageId),n=this._standaloneThemeService.getColorTheme().tokenTheme,s=[];let r=0,a=0;for(let c=0,d=t.length;c<d;c++){const h=t[c],u=n.match(i,h.scopes)|1024;if(r>0&&s[r-1]===u)continue;let g=h.startIndex;c===0?g=0:g<a&&(g=a),s[r++]=g,s[r++]=u,a=g}const l=new Uint32Array(r);for(let c=0;c<r;c++)l[c]=s[c];return l}tokenizeEncoded(e,t,i){const n=this._actual.tokenize(e,i),s=this._toBinaryTokens(this._languageService.languageIdCodec,n.tokens);let r;return n.endState.equals(i)?r=i:r=n.endState,new eT(s,r)}}function tCe(o){return typeof o.getInitialState=="function"}function iCe(o){return"tokenizeEncoded"in o}function _j(o){return o&&typeof o.then=="function"}function nCe(o){const e=Ie.get(Ko);if(o){const t=[null];for(let i=1,n=o.length;i<n;i++)t[i]=j.fromHex(o[i]);e.setColorMapOverride(t)}else e.setColorMapOverride(null)}function bj(o,e){return iCe(e)?new eCe(o,e):new Uy(o,e,Ie.get(ti),Ie.get(Ko))}function tW(o,e){const t=new RQ(async()=>{const i=await Promise.resolve(e.create());return i?tCe(i)?bj(o,i):new Ny(Ie.get(ti),Ie.get(Ko),o,mj(o,i),Ie.get(Ke)):null});return gi.registerFactory(o,t)}function sCe(o,e){if(!Ie.get(ti).isRegisteredLanguageId(o))throw new Error(`Cannot set tokens provider for unknown language ${o}`);return _j(e)?tW(o,{create:()=>e}):gi.register(o,bj(o,e))}function oCe(o,e){const t=i=>new Ny(Ie.get(ti),Ie.get(Ko),o,mj(o,i),Ie.get(Ke));return _j(e)?tW(o,{create:()=>e}):gi.register(o,t(e))}function rCe(o,e){return Ie.get(ue).referenceProvider.register(o,e)}function aCe(o,e){return Ie.get(ue).renameProvider.register(o,e)}function lCe(o,e){return Ie.get(ue).newSymbolNamesProvider.register(o,e)}function cCe(o,e){return Ie.get(ue).signatureHelpProvider.register(o,e)}function dCe(o,e){return Ie.get(ue).hoverProvider.register(o,{provideHover:async(i,n,s,r)=>{const a=i.getWordAtPosition(n);return Promise.resolve(e.provideHover(i,n,s,r)).then(l=>{if(l)return!l.range&&a&&(l.range=new L(n.lineNumber,a.startColumn,n.lineNumber,a.endColumn)),l.range||(l.range=new L(n.lineNumber,n.column,n.lineNumber,n.column)),l})}})}function hCe(o,e){return Ie.get(ue).documentSymbolProvider.register(o,e)}function uCe(o,e){return Ie.get(ue).documentHighlightProvider.register(o,e)}function gCe(o,e){return Ie.get(ue).linkedEditingRangeProvider.register(o,e)}function fCe(o,e){return Ie.get(ue).definitionProvider.register(o,e)}function pCe(o,e){return Ie.get(ue).implementationProvider.register(o,e)}function mCe(o,e){return Ie.get(ue).typeDefinitionProvider.register(o,e)}function _Ce(o,e){return Ie.get(ue).codeLensProvider.register(o,e)}function bCe(o,e,t){return Ie.get(ue).codeActionProvider.register(o,{providedCodeActionKinds:t?.providedCodeActionKinds,documentation:t?.documentation,provideCodeActions:(n,s,r,a)=>{const c=Ie.get(Ul).read({resource:n.uri}).filter(d=>L.areIntersectingOrTouching(d,s));return e.provideCodeActions(n,s,{markers:c,only:r.only,trigger:r.trigger},a)},resolveCodeAction:e.resolveCodeAction})}function vCe(o,e){return Ie.get(ue).documentFormattingEditProvider.register(o,e)}function CCe(o,e){return Ie.get(ue).documentRangeFormattingEditProvider.register(o,e)}function yCe(o,e){return Ie.get(ue).onTypeFormattingEditProvider.register(o,e)}function wCe(o,e){return Ie.get(ue).linkProvider.register(o,e)}function SCe(o,e){return Ie.get(ue).completionProvider.register(o,e)}function xCe(o,e){return Ie.get(ue).colorProvider.register(o,e)}function LCe(o,e){return Ie.get(ue).foldingRangeProvider.register(o,e)}function kCe(o,e){return Ie.get(ue).declarationProvider.register(o,e)}function ECe(o,e){return Ie.get(ue).selectionRangeProvider.register(o,e)}function TCe(o,e){return Ie.get(ue).documentSemanticTokensProvider.register(o,e)}function DCe(o,e){return Ie.get(ue).documentRangeSemanticTokensProvider.register(o,e)}function ICe(o,e){return Ie.get(ue).inlineCompletionsProvider.register(o,e)}function NCe(o,e){return Ie.get(ue).inlineEditProvider.register(o,e)}function RCe(o,e){return Ie.get(ue).inlayHintsProvider.register(o,e)}function PCe(){return{register:qve,getLanguages:Zve,onLanguage:Xve,onLanguageEncountered:Qve,getEncodedLanguageId:Yve,setLanguageConfiguration:Jve,setColorMap:nCe,registerTokensProviderFactory:tW,setTokensProvider:sCe,setMonarchTokensProvider:oCe,registerReferenceProvider:rCe,registerRenameProvider:aCe,registerNewSymbolNameProvider:lCe,registerCompletionItemProvider:SCe,registerSignatureHelpProvider:cCe,registerHoverProvider:dCe,registerDocumentSymbolProvider:hCe,registerDocumentHighlightProvider:uCe,registerLinkedEditingRangeProvider:gCe,registerDefinitionProvider:fCe,registerImplementationProvider:pCe,registerTypeDefinitionProvider:mCe,registerCodeLensProvider:_Ce,registerCodeActionProvider:bCe,registerDocumentFormattingEditProvider:vCe,registerDocumentRangeFormattingEditProvider:CCe,registerOnTypeFormattingEditProvider:yCe,registerLinkProvider:wCe,registerColorProvider:xCe,registerFoldingRangeProvider:LCe,registerDeclarationProvider:kCe,registerSelectionRangeProvider:ECe,registerDocumentSemanticTokensProvider:TCe,registerDocumentRangeSemanticTokensProvider:DCe,registerInlineCompletionsProvider:ICe,registerInlineEditProvider:NCe,registerInlayHintsProvider:RCe,DocumentHighlightKind:_R,CompletionItemKind:hR,CompletionItemTag:uR,CompletionItemInsertTextRule:dR,SymbolKind:qR,SymbolTag:ZR,IndentAction:xR,CompletionTriggerKind:gR,SignatureHelpTriggerKind:jR,InlayHintKind:kR,InlineCompletionTriggerKind:ER,InlineEditTriggerKind:TR,CodeActionTriggerType:cR,NewSymbolNameTag:MR,NewSymbolNameTriggerKind:OR,PartialAcceptTriggerKind:WR,HoverVerbosityAction:SR,FoldingRangeKind:Th,SelectedSuggestionInfo:Cz}}const iW=Je("IEditorCancelService"),vj=new re("cancellableOperation",!1,p("cancellableOperation","Whether the editor runs a cancellable operation, e.g. like 'Peek References'"));it(iW,class{constructor(){this._tokens=new WeakMap}add(o,e){let t=this._tokens.get(o);t||(t=o.invokeWithinContext(n=>{const s=vj.bindTo(n.get(Ee)),r=new os;return{key:s,tokens:r}}),this._tokens.set(o,t));let i;return t.key.set(!0),i=t.tokens.push(e),()=>{i&&(i(),t.key.set(!t.tokens.isEmpty()),i=void 0)}}cancel(o){const e=this._tokens.get(o);if(!e)return;const t=e.tokens.pop();t&&(t.cancel(),e.key.set(!e.tokens.isEmpty()))}},1);class ACe extends ri{constructor(e,t){super(t),this.editor=e,this._unregister=e.invokeWithinContext(i=>i.get(iW).add(e,this))}dispose(){this._unregister(),super.dispose()}}oe(new class extends Hi{constructor(){super({id:"editor.cancelOperation",kbOpts:{weight:100,primary:9},precondition:vj})}runEditorCommand(o,e){o.get(iW).cancel(e)}});let Cj=class DO{constructor(e,t){if(this.flags=t,(this.flags&1)!==0){const i=e.getModel();this.modelVersionId=i?mf("{0}#{1}",i.uri.toString(),i.getVersionId()):null}else this.modelVersionId=null;(this.flags&4)!==0?this.position=e.getPosition():this.position=null,(this.flags&2)!==0?this.selection=e.getSelection():this.selection=null,(this.flags&8)!==0?(this.scrollLeft=e.getScrollLeft(),this.scrollTop=e.getScrollTop()):(this.scrollLeft=-1,this.scrollTop=-1)}_equals(e){if(!(e instanceof DO))return!1;const t=e;return!(this.modelVersionId!==t.modelVersionId||this.scrollLeft!==t.scrollLeft||this.scrollTop!==t.scrollTop||!this.position&&t.position||this.position&&!t.position||this.position&&t.position&&!this.position.equals(t.position)||!this.selection&&t.selection||this.selection&&!t.selection||this.selection&&t.selection&&!this.selection.equalsRange(t.selection))}validate(e){return this._equals(new DO(e,this.flags))}};class zh extends ACe{constructor(e,t,i,n){super(e,n),this._listener=new $,t&4&&this._listener.add(e.onDidChangeCursorPosition(s=>{(!i||!L.containsPosition(i,s.position))&&this.cancel()})),t&2&&this._listener.add(e.onDidChangeCursorSelection(s=>{(!i||!L.containsRange(i,s.selection))&&this.cancel()})),t&8&&this._listener.add(e.onDidScrollChange(s=>this.cancel())),t&1&&(this._listener.add(e.onDidChangeModel(s=>this.cancel())),this._listener.add(e.onDidChangeModelContent(s=>this.cancel())))}dispose(){this._listener.dispose(),super.dispose()}}class nW extends ri{constructor(e,t){super(t),this._listener=e.onDidChangeContent(()=>this.cancel())}dispose(){this._listener.dispose(),super.dispose()}}function Fl(o){return o&&typeof o.getEditorType=="function"?o.getEditorType()===Gw.ICodeEditor:!1}function sW(o){return o&&typeof o.getEditorType=="function"?o.getEditorType()===Gw.IDiffEditor:!1}function MCe(o){return!!o&&typeof o=="object"&&typeof o.onDidChangeActiveEditor=="function"}function yj(o){return Fl(o)?o:sW(o)?o.getModifiedEditor():MCe(o)&&Fl(o.activeCodeEditor)?o.activeCodeEditor:null}class B_{static _handleEolEdits(e,t){let i;const n=[];for(const s of t)typeof s.eol=="number"&&(i=s.eol),s.range&&typeof s.text=="string"&&n.push(s);return typeof i=="number"&&e.hasModel()&&e.getModel().pushEOL(i),n}static _isFullModelReplaceEdit(e,t){if(!e.hasModel())return!1;const i=e.getModel(),n=i.validateRange(t.range);return i.getFullModelRange().equalsRange(n)}static execute(e,t,i){i&&e.pushUndoStop();const n=Ma.capture(e),s=B_._handleEolEdits(e,t);s.length===1&&B_._isFullModelReplaceEdit(e,s[0])?e.executeEdits("formatEditsCommand",s.map(r=>si.replace(L.lift(r.range),r.text))):e.executeEdits("formatEditsCommand",s.map(r=>si.replaceMove(L.lift(r.range),r.text))),i&&e.pushUndoStop(),n.restoreRelativeVerticalPositionOfCursor(e)}}class X9{constructor(e){this.value=e,this._lower=e.toLowerCase()}static toKey(e){return typeof e=="string"?e.toLowerCase():e._lower}}class OCe{constructor(e){if(this._set=new Set,e)for(const t of e)this.add(t)}add(e){this._set.add(X9.toKey(e))}has(e){return this._set.has(X9.toKey(e))}}function wj(o,e,t){const i=[],n=new OCe,s=o.ordered(t);for(const a of s)i.push(a),a.extensionId&&n.add(a.extensionId);const r=e.ordered(t);for(const a of r){if(a.extensionId){if(n.has(a.extensionId))continue;n.add(a.extensionId)}i.push({displayName:a.displayName,extensionId:a.extensionId,provideDocumentFormattingEdits(l,c,d){return a.provideDocumentRangeFormattingEdits(l,l.getFullModelRange(),c,d)}})}return i}const PC=class PC{static setFormatterSelector(e){return{dispose:PC._selectors.unshift(e)}}static async select(e,t,i,n){if(e.length===0)return;const s=nt.first(PC._selectors);if(s)return await s(e,t,i,n)}};PC._selectors=new os;let Gy=PC;async function Sj(o,e,t,i,n,s,r){const a=o.get(Ce),{documentRangeFormattingEditProvider:l}=o.get(ue),c=Fl(e)?e.getModel():e,d=l.ordered(c),h=await Gy.select(d,c,i,2);h&&(n.report(h),await a.invokeFunction(FCe,h,e,t,s,r))}async function FCe(o,e,t,i,n,s){const r=o.get(Bs),a=o.get(Tn),l=o.get(Jh);let c,d;Fl(t)?(c=t.getModel(),d=new zh(t,5,void 0,n)):(c=t,d=new nW(t,n));const h=[];let u=0;for(const b of b4(i).sort(L.compareRangesUsingStarts))u>0&&L.areIntersectingOrTouching(h[u-1],b)?h[u-1]=L.fromPositions(h[u-1].getStartPosition(),b.getEndPosition()):u=h.push(b);const g=async b=>{a.trace("[format][provideDocumentRangeFormattingEdits] (request)",e.extensionId?.value,b);const v=await e.provideDocumentRangeFormattingEdits(c,b,c.getFormattingOptions(),d.token)||[];return a.trace("[format][provideDocumentRangeFormattingEdits] (response)",e.extensionId?.value,v),v},f=(b,v)=>{if(!b.length||!v.length)return!1;const y=b.reduce((C,w)=>L.plusRange(C,w.range),b[0].range);if(!v.some(C=>L.intersectRanges(y,C.range)))return!1;for(const C of b)for(const w of v)if(L.intersectRanges(C.range,w.range))return!0;return!1},m=[],_=[];try{if(typeof e.provideDocumentRangesFormattingEdits=="function"){a.trace("[format][provideDocumentRangeFormattingEdits] (request)",e.extensionId?.value,h);const b=await e.provideDocumentRangesFormattingEdits(c,h,c.getFormattingOptions(),d.token)||[];a.trace("[format][provideDocumentRangeFormattingEdits] (response)",e.extensionId?.value,b),_.push(b)}else{for(const b of h){if(d.token.isCancellationRequested)return!0;_.push(await g(b))}for(let b=0;b<h.length;++b)for(let v=b+1;v<h.length;++v){if(d.token.isCancellationRequested)return!0;if(f(_[b],_[v])){const y=L.plusRange(h[b],h[v]),C=await g(y);h.splice(v,1),h.splice(b,1),h.push(y),_.splice(v,1),_.splice(b,1),_.push(C),b=0,v=0}}}for(const b of _){if(d.token.isCancellationRequested)return!0;const v=await r.computeMoreMinimalEdits(c.uri,b);v&&m.push(...v)}}finally{d.dispose()}if(m.length===0)return!1;if(Fl(t))B_.execute(t,m,!0),t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:b}]=m,v=new pe(b.startLineNumber,b.startColumn,b.endLineNumber,b.endColumn);c.pushEditOperations([v],m.map(y=>({text:y.text,range:L.lift(y.range),forceMoveMarkers:!0})),y=>{for(const{range:C}of y)if(L.areIntersectingOrTouching(C,v))return[new pe(C.startLineNumber,C.startColumn,C.endLineNumber,C.endColumn)];return null})}return l.playSignal(xo.format,{userGesture:s}),!0}async function BCe(o,e,t,i,n,s){const r=o.get(Ce),a=o.get(ue),l=Fl(e)?e.getModel():e,c=wj(a.documentFormattingEditProvider,a.documentRangeFormattingEditProvider,l),d=await Gy.select(c,l,t,1);d&&(i.report(d),await r.invokeFunction(WCe,d,e,t,n,s))}async function WCe(o,e,t,i,n,s){const r=o.get(Bs),a=o.get(Jh);let l,c;Fl(t)?(l=t.getModel(),c=new zh(t,5,void 0,n)):(l=t,c=new nW(t,n));let d;try{const h=await e.provideDocumentFormattingEdits(l,l.getFormattingOptions(),c.token);if(d=await r.computeMoreMinimalEdits(l.uri,h),c.token.isCancellationRequested)return!0}finally{c.dispose()}if(!d||d.length===0)return!1;if(Fl(t))B_.execute(t,d,i!==2),i!==2&&t.revealPositionInCenterIfOutsideViewport(t.getPosition(),1);else{const[{range:h}]=d,u=new pe(h.startLineNumber,h.startColumn,h.endLineNumber,h.endColumn);l.pushEditOperations([u],d.map(g=>({text:g.text,range:L.lift(g.range),forceMoveMarkers:!0})),g=>{for(const{range:f}of g)if(L.areIntersectingOrTouching(f,u))return[new pe(f.startLineNumber,f.startColumn,f.endLineNumber,f.endColumn)];return null})}return a.playSignal(xo.format,{userGesture:s}),!0}async function VCe(o,e,t,i,n,s){const r=e.documentRangeFormattingEditProvider.ordered(t);for(const a of r){const l=await Promise.resolve(a.provideDocumentRangeFormattingEdits(t,i,n,s)).catch(yi);if(Yn(l))return await o.computeMoreMinimalEdits(t.uri,l)}}async function HCe(o,e,t,i,n){const s=wj(e.documentFormattingEditProvider,e.documentRangeFormattingEditProvider,t);for(const r of s){const a=await Promise.resolve(r.provideDocumentFormattingEdits(t,i,n)).catch(yi);if(Yn(a))return await o.computeMoreMinimalEdits(t.uri,a)}}function xj(o,e,t,i,n,s,r){const a=e.onTypeFormattingEditProvider.ordered(t);return a.length===0||a[0].autoFormatTriggerCharacters.indexOf(n)<0?Promise.resolve(void 0):Promise.resolve(a[0].provideOnTypeFormattingEdits(t,i,n,s,r)).catch(yi).then(l=>o.computeMoreMinimalEdits(t.uri,l))}st.registerCommand("_executeFormatRangeProvider",async function(o,...e){const[t,i,n]=e;ut(ye.isUri(t)),ut(L.isIRange(i));const s=o.get(Ms),r=o.get(Bs),a=o.get(ue),l=await s.createModelReference(t);try{return VCe(r,a,l.object.textEditorModel,L.lift(i),n,He.None)}finally{l.dispose()}});st.registerCommand("_executeFormatDocumentProvider",async function(o,...e){const[t,i]=e;ut(ye.isUri(t));const n=o.get(Ms),s=o.get(Bs),r=o.get(ue),a=await n.createModelReference(t);try{return HCe(s,r,a.object.textEditorModel,i,He.None)}finally{a.dispose()}});st.registerCommand("_executeFormatOnTypeProvider",async function(o,...e){const[t,i,n,s]=e;ut(ye.isUri(t)),ut(A.isIPosition(i)),ut(typeof n=="string");const r=o.get(Ms),a=o.get(Bs),l=o.get(ue),c=await r.createModelReference(t);try{return xj(a,l,c.object.textEditorModel,A.lift(i),n,s,He.None)}finally{c.dispose()}});Oa.wrappingIndent.defaultValue=0;Oa.glyphMargin.defaultValue=!1;Oa.autoIndent.defaultValue=3;Oa.overviewRulerLanes.defaultValue=2;Gy.setFormatterSelector((o,e,t)=>Promise.resolve(o[0]));const vs=yz();vs.editor=zve();vs.languages=PCe();const zCe=vs.CancellationTokenSource,UCe=vs.Emitter,Lj=vs.KeyCode,GCe=vs.KeyMod,$Ce=vs.Position,KCe=vs.Range,jCe=vs.Selection,qCe=vs.SelectionDirection,ZCe=vs.MarkerSeverity,YCe=vs.MarkerTag,XCe=vs.Uri,QCe=vs.Token,kj=vs.editor,qw=vs.languages,JCe=globalThis.MonacoEnvironment;(JCe?.globalAPI||typeof define=="function"&&define.amd)&&(globalThis.monaco=vs);typeof globalThis.require<"u"&&typeof globalThis.require.config=="function"&&globalThis.require.config({ignoreDuplicateModules:["vscode-languageserver-types","vscode-languageserver-types/main","vscode-languageserver-textdocument","vscode-languageserver-textdocument/main","vscode-nls","vscode-nls/vscode-nls","jsonc-parser","jsonc-parser/main","vscode-uri","vscode-uri/index","vs/basic-languages/typescript/typescript"]});const Zw=Object.freeze(Object.defineProperty({__proto__:null,CancellationTokenSource:zCe,Emitter:UCe,KeyCode:Lj,KeyMod:GCe,MarkerSeverity:ZCe,MarkerTag:YCe,Position:$Ce,Range:KCe,Selection:jCe,SelectionDirection:qCe,Token:QCe,Uri:XCe,editor:kj,languages:qw},Symbol.toStringTag,{value:"Module"}));/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var eye=Object.defineProperty,tye=Object.getOwnPropertyDescriptor,iye=Object.getOwnPropertyNames,nye=Object.prototype.hasOwnProperty,sye=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of iye(e))!nye.call(o,n)&&n!==t&&eye(o,n,{get:()=>e[n],enumerable:!(i=tye(e,n))||i.enumerable});return o},oye=(o,e,t)=>(sye(o,e,"default"),t),yv={};oye(yv,Zw);var Ej={},hN={},rye=class Tj{static getOrCreate(e){return hN[e]||(hN[e]=new Tj(e)),hN[e]}constructor(e){this._languageId=e,this._loadingTriggered=!1,this._lazyLoadPromise=new Promise((t,i)=>{this._lazyLoadPromiseResolve=t,this._lazyLoadPromiseReject=i})}load(){return this._loadingTriggered||(this._loadingTriggered=!0,Ej[this._languageId].loader().then(e=>this._lazyLoadPromiseResolve(e),e=>this._lazyLoadPromiseReject(e))),this._lazyLoadPromise}};function Le(o){const e=o.id;Ej[e]=o,yv.languages.register(o);const t=rye.getOrCreate(e);yv.languages.registerTokensProviderFactory(e,{create:async()=>(await t.load()).language}),yv.languages.onLanguageEncountered(e,async()=>{const i=await t.load();yv.languages.setLanguageConfiguration(e,i.conf)})}Le({id:"abap",extensions:[".abap"],aliases:["abap","ABAP"],loader:()=>we(()=>import("./abap-BrgZPUOV.js"),[])});Le({id:"apex",extensions:[".cls"],aliases:["Apex","apex"],mimetypes:["text/x-apex-source","text/x-apex"],loader:()=>we(()=>import("./apex-DyP6w7ZV.js"),[])});Le({id:"azcli",extensions:[".azcli"],aliases:["Azure CLI","azcli"],loader:()=>we(()=>import("./azcli-BaLxmfj-.js"),[])});Le({id:"bat",extensions:[".bat",".cmd"],aliases:["Batch","bat"],loader:()=>we(()=>import("./bat-CFOPXBzS.js"),[])});Le({id:"bicep",extensions:[".bicep"],aliases:["Bicep"],loader:()=>we(()=>import("./bicep-BfEKNvv3.js"),[])});Le({id:"cameligo",extensions:[".mligo"],aliases:["Cameligo"],loader:()=>we(()=>import("./cameligo-BFG1Mk7z.js"),[])});Le({id:"clojure",extensions:[".clj",".cljs",".cljc",".edn"],aliases:["clojure","Clojure"],loader:()=>we(()=>import("./clojure-DTECt2xU.js"),[])});Le({id:"coffeescript",extensions:[".coffee"],aliases:["CoffeeScript","coffeescript","coffee"],mimetypes:["text/x-coffeescript","text/coffeescript"],loader:()=>we(()=>import("./coffee-CDGzqUPQ.js"),[])});Le({id:"c",extensions:[".c",".h"],aliases:["C","c"],loader:()=>we(()=>import("./cpp-CLLBncYj.js"),[])});Le({id:"cpp",extensions:[".cpp",".cc",".cxx",".hpp",".hh",".hxx"],aliases:["C++","Cpp","cpp"],loader:()=>we(()=>import("./cpp-CLLBncYj.js"),[])});Le({id:"csharp",extensions:[".cs",".csx",".cake"],aliases:["C#","csharp"],loader:()=>we(()=>import("./csharp-dUCx_-0o.js"),[])});Le({id:"csp",extensions:[".csp"],aliases:["CSP","csp"],loader:()=>we(()=>import("./csp-5Rap-vPy.js"),[])});Le({id:"css",extensions:[".css"],aliases:["CSS","css"],mimetypes:["text/css"],loader:()=>we(()=>import("./css-D3h14YRZ.js"),[])});Le({id:"cypher",extensions:[".cypher",".cyp"],aliases:["Cypher","OpenCypher"],loader:()=>we(()=>import("./cypher-DrQuvNYM.js"),[])});Le({id:"dart",extensions:[".dart"],aliases:["Dart","dart"],mimetypes:["text/x-dart-source","text/x-dart"],loader:()=>we(()=>import("./dart-CFKIUWau.js"),[])});Le({id:"dockerfile",extensions:[".dockerfile"],filenames:["Dockerfile"],aliases:["Dockerfile"],loader:()=>we(()=>import("./dockerfile-Zznr-cwX.js"),[])});Le({id:"ecl",extensions:[".ecl"],aliases:["ECL","Ecl","ecl"],loader:()=>we(()=>import("./ecl-Ce3n6wWz.js"),[])});Le({id:"elixir",extensions:[".ex",".exs"],aliases:["Elixir","elixir","ex"],loader:()=>we(()=>import("./elixir-deUWdS0T.js"),[])});Le({id:"flow9",extensions:[".flow"],aliases:["Flow9","Flow","flow9","flow"],loader:()=>we(()=>import("./flow9-i9-g7ZhI.js"),[])});Le({id:"fsharp",extensions:[".fs",".fsi",".ml",".mli",".fsx",".fsscript"],aliases:["F#","FSharp","fsharp"],loader:()=>we(()=>import("./fsharp-CzKuDChf.js"),[])});Le({id:"freemarker2",extensions:[".ftl",".ftlh",".ftlx"],aliases:["FreeMarker2","Apache FreeMarker2"],loader:()=>we(()=>import("./freemarker2-Bm7RC7Dg.js"),[]).then(o=>o.TagAutoInterpolationDollar)});Le({id:"freemarker2.tag-angle.interpolation-dollar",aliases:["FreeMarker2 (Angle/Dollar)","Apache FreeMarker2 (Angle/Dollar)"],loader:()=>we(()=>import("./freemarker2-Bm7RC7Dg.js"),[]).then(o=>o.TagAngleInterpolationDollar)});Le({id:"freemarker2.tag-bracket.interpolation-dollar",aliases:["FreeMarker2 (Bracket/Dollar)","Apache FreeMarker2 (Bracket/Dollar)"],loader:()=>we(()=>import("./freemarker2-Bm7RC7Dg.js"),[]).then(o=>o.TagBracketInterpolationDollar)});Le({id:"freemarker2.tag-angle.interpolation-bracket",aliases:["FreeMarker2 (Angle/Bracket)","Apache FreeMarker2 (Angle/Bracket)"],loader:()=>we(()=>import("./freemarker2-Bm7RC7Dg.js"),[]).then(o=>o.TagAngleInterpolationBracket)});Le({id:"freemarker2.tag-bracket.interpolation-bracket",aliases:["FreeMarker2 (Bracket/Bracket)","Apache FreeMarker2 (Bracket/Bracket)"],loader:()=>we(()=>import("./freemarker2-Bm7RC7Dg.js"),[]).then(o=>o.TagBracketInterpolationBracket)});Le({id:"freemarker2.tag-auto.interpolation-dollar",aliases:["FreeMarker2 (Auto/Dollar)","Apache FreeMarker2 (Auto/Dollar)"],loader:()=>we(()=>import("./freemarker2-Bm7RC7Dg.js"),[]).then(o=>o.TagAutoInterpolationDollar)});Le({id:"freemarker2.tag-auto.interpolation-bracket",aliases:["FreeMarker2 (Auto/Bracket)","Apache FreeMarker2 (Auto/Bracket)"],loader:()=>we(()=>import("./freemarker2-Bm7RC7Dg.js"),[]).then(o=>o.TagAutoInterpolationBracket)});Le({id:"go",extensions:[".go"],aliases:["Go"],loader:()=>we(()=>import("./go-Cphgjts3.js"),[])});Le({id:"graphql",extensions:[".graphql",".gql"],aliases:["GraphQL","graphql","gql"],mimetypes:["application/graphql"],loader:()=>we(()=>import("./graphql-Cg7bfA9N.js"),[])});Le({id:"handlebars",extensions:[".handlebars",".hbs"],aliases:["Handlebars","handlebars","hbs"],mimetypes:["text/x-handlebars-template"],loader:()=>we(()=>import("./handlebars-D40nmZG_.js"),[])});Le({id:"hcl",extensions:[".tf",".tfvars",".hcl"],aliases:["Terraform","tf","HCL","hcl"],loader:()=>we(()=>import("./hcl-0cvrggvQ.js"),[])});Le({id:"html",extensions:[".html",".htm",".shtml",".xhtml",".mdoc",".jsp",".asp",".aspx",".jshtm"],aliases:["HTML","htm","html","xhtml"],mimetypes:["text/html","text/x-jshtm","text/template","text/ng-template"],loader:()=>we(()=>import("./html-BhdS-jw2.js"),[])});Le({id:"ini",extensions:[".ini",".properties",".gitconfig"],filenames:["config",".gitattributes",".gitconfig",".editorconfig"],aliases:["Ini","ini"],loader:()=>we(()=>import("./ini-Drc7WvVn.js"),[])});Le({id:"java",extensions:[".java",".jav"],aliases:["Java","java"],mimetypes:["text/x-java-source","text/x-java"],loader:()=>we(()=>import("./java-B_fMsGYe.js"),[])});Le({id:"javascript",extensions:[".js",".es6",".jsx",".mjs",".cjs"],firstLine:"^#!.*\\bnode",filenames:["jakefile"],aliases:["JavaScript","javascript","js"],mimetypes:["text/javascript"],loader:()=>we(()=>import("./javascript-8Itubqs8.js"),__vite__mapDeps([0,1]))});Le({id:"julia",extensions:[".jl"],aliases:["julia","Julia"],loader:()=>we(()=>import("./julia-Bqgm2twL.js"),[])});Le({id:"kotlin",extensions:[".kt",".kts"],aliases:["Kotlin","kotlin"],mimetypes:["text/x-kotlin-source","text/x-kotlin"],loader:()=>we(()=>import("./kotlin-BSkB5QuD.js"),[])});Le({id:"less",extensions:[".less"],aliases:["Less","less"],mimetypes:["text/x-less","text/less"],loader:()=>we(()=>import("./less-BsTHnhdd.js"),[])});Le({id:"lexon",extensions:[".lex"],aliases:["Lexon"],loader:()=>we(()=>import("./lexon-YWi4-JPR.js"),[])});Le({id:"lua",extensions:[".lua"],aliases:["Lua","lua"],loader:()=>we(()=>import("./lua-nf6ki56Z.js"),[])});Le({id:"liquid",extensions:[".liquid",".html.liquid"],aliases:["Liquid","liquid"],mimetypes:["application/liquid"],loader:()=>we(()=>import("./liquid-CHTu_vxP.js"),[])});Le({id:"m3",extensions:[".m3",".i3",".mg",".ig"],aliases:["Modula-3","Modula3","modula3","m3"],loader:()=>we(()=>import("./m3-Cpb6xl2v.js"),[])});Le({id:"markdown",extensions:[".md",".markdown",".mdown",".mkdn",".mkd",".mdwn",".mdtxt",".mdtext"],aliases:["Markdown","markdown"],loader:()=>we(()=>import("./markdown-DSZPf7rp.js"),[])});Le({id:"mdx",extensions:[".mdx"],aliases:["MDX","mdx"],loader:()=>we(()=>import("./mdx-Cpgp3n8p.js"),[])});Le({id:"mips",extensions:[".s"],aliases:["MIPS","MIPS-V"],mimetypes:["text/x-mips","text/mips","text/plaintext"],loader:()=>we(()=>import("./mips-B_c3zf-v.js"),[])});Le({id:"msdax",extensions:[".dax",".msdax"],aliases:["DAX","MSDAX"],loader:()=>we(()=>import("./msdax-rUNN04Wq.js"),[])});Le({id:"mysql",extensions:[],aliases:["MySQL","mysql"],loader:()=>we(()=>import("./mysql-DDwshQtU.js"),[])});Le({id:"objective-c",extensions:[".m"],aliases:["Objective-C"],loader:()=>we(()=>import("./objective-c-B5zXfXm9.js"),[])});Le({id:"pascal",extensions:[".pas",".p",".pp"],aliases:["Pascal","pas"],mimetypes:["text/x-pascal-source","text/x-pascal"],loader:()=>we(()=>import("./pascal-CXOwvkN_.js"),[])});Le({id:"pascaligo",extensions:[".ligo"],aliases:["Pascaligo","ligo"],loader:()=>we(()=>import("./pascaligo-Bc-ZgV77.js"),[])});Le({id:"perl",extensions:[".pl",".pm"],aliases:["Perl","pl"],loader:()=>we(()=>import("./perl-CwNk8-XU.js"),[])});Le({id:"pgsql",extensions:[],aliases:["PostgreSQL","postgres","pg","postgre"],loader:()=>we(()=>import("./pgsql-tGk8EFnU.js"),[])});Le({id:"php",extensions:[".php",".php4",".php5",".phtml",".ctp"],aliases:["PHP","php"],mimetypes:["application/x-php"],loader:()=>we(()=>import("./php-CpIb_Oan.js"),[])});Le({id:"pla",extensions:[".pla"],loader:()=>we(()=>import("./pla-B03wrqEc.js"),[])});Le({id:"postiats",extensions:[".dats",".sats",".hats"],aliases:["ATS","ATS/Postiats"],loader:()=>we(()=>import("./postiats-BKlk5iyT.js"),[])});Le({id:"powerquery",extensions:[".pq",".pqm"],aliases:["PQ","M","Power Query","Power Query M"],loader:()=>we(()=>import("./powerquery-Bhzvs7bI.js"),[])});Le({id:"powershell",extensions:[".ps1",".psm1",".psd1"],aliases:["PowerShell","powershell","ps","ps1"],loader:()=>we(()=>import("./powershell-Dd3NCNK9.js"),[])});Le({id:"proto",extensions:[".proto"],aliases:["protobuf","Protocol Buffers"],loader:()=>we(()=>import("./protobuf-COyEY5Pt.js"),[])});Le({id:"pug",extensions:[".jade",".pug"],aliases:["Pug","Jade","jade"],loader:()=>we(()=>import("./pug-BaJupSGV.js"),[])});Le({id:"python",extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi"],aliases:["Python","py"],firstLine:"^#!/.*\\bpython[0-9.-]*\\b",loader:()=>we(()=>import("./python-D9zltBVR.js"),[])});Le({id:"qsharp",extensions:[".qs"],aliases:["Q#","qsharp"],loader:()=>we(()=>import("./qsharp-DXyYeYxl.js"),[])});Le({id:"r",extensions:[".r",".rhistory",".rmd",".rprofile",".rt"],aliases:["R","r"],loader:()=>we(()=>import("./r-CdQndTaG.js"),[])});Le({id:"razor",extensions:[".cshtml"],aliases:["Razor","razor"],mimetypes:["text/x-cshtml"],loader:()=>we(()=>import("./razor-CERWJy5b.js"),[])});Le({id:"redis",extensions:[".redis"],aliases:["redis"],loader:()=>we(()=>import("./redis-CVwtpugi.js"),[])});Le({id:"redshift",extensions:[],aliases:["Redshift","redshift"],loader:()=>we(()=>import("./redshift-25W9uPmb.js"),[])});Le({id:"restructuredtext",extensions:[".rst"],aliases:["reStructuredText","restructuredtext"],loader:()=>we(()=>import("./restructuredtext-DfzH4Xui.js"),[])});Le({id:"ruby",extensions:[".rb",".rbx",".rjs",".gemspec",".pp"],filenames:["rakefile","Gemfile"],aliases:["Ruby","rb"],loader:()=>we(()=>import("./ruby-Cp1zYvxS.js"),[])});Le({id:"rust",extensions:[".rs",".rlib"],aliases:["Rust","rust"],loader:()=>we(()=>import("./rust-D5C2fndG.js"),[])});Le({id:"sb",extensions:[".sb"],aliases:["Small Basic","sb"],loader:()=>we(()=>import("./sb-CDntyWJ8.js"),[])});Le({id:"scala",extensions:[".scala",".sc",".sbt"],aliases:["Scala","scala","SBT","Sbt","sbt","Dotty","dotty"],mimetypes:["text/x-scala-source","text/x-scala","text/x-sbt","text/x-dotty"],loader:()=>we(()=>import("./scala-BoFRg7Ot.js"),[])});Le({id:"scheme",extensions:[".scm",".ss",".sch",".rkt"],aliases:["scheme","Scheme"],loader:()=>we(()=>import("./scheme-Bio4gycK.js"),[])});Le({id:"scss",extensions:[".scss"],aliases:["Sass","sass","scss"],mimetypes:["text/x-scss","text/scss"],loader:()=>we(()=>import("./scss-4Ik7cdeQ.js"),[])});Le({id:"shell",extensions:[".sh",".bash"],aliases:["Shell","sh"],loader:()=>we(()=>import("./shell-CX-rkNHf.js"),[])});Le({id:"sol",extensions:[".sol"],aliases:["sol","solidity","Solidity"],loader:()=>we(()=>import("./solidity-Tw7wswEv.js"),[])});Le({id:"aes",extensions:[".aes"],aliases:["aes","sophia","Sophia"],loader:()=>we(()=>import("./sophia-C5WLch3f.js"),[])});Le({id:"sparql",extensions:[".rq"],aliases:["sparql","SPARQL"],loader:()=>we(()=>import("./sparql-DHaeiCBh.js"),[])});Le({id:"sql",extensions:[".sql"],aliases:["SQL"],loader:()=>we(()=>import("./sql-CCSDG5nI.js"),[])});Le({id:"st",extensions:[".st",".iecst",".iecplc",".lc3lib",".TcPOU",".TcDUT",".TcGVL",".TcIO"],aliases:["StructuredText","scl","stl"],loader:()=>we(()=>import("./st-pnP8ivHi.js"),[])});Le({id:"swift",aliases:["Swift","swift"],extensions:[".swift"],mimetypes:["text/swift"],loader:()=>we(()=>import("./swift-DwJ7jVG9.js"),[])});Le({id:"systemverilog",extensions:[".sv",".svh"],aliases:["SV","sv","SystemVerilog","systemverilog"],loader:()=>we(()=>import("./systemverilog-B9Xyijhd.js"),[])});Le({id:"verilog",extensions:[".v",".vh"],aliases:["V","v","Verilog","verilog"],loader:()=>we(()=>import("./systemverilog-B9Xyijhd.js"),[])});Le({id:"tcl",extensions:[".tcl"],aliases:["tcl","Tcl","tcltk","TclTk","tcl/tk","Tcl/Tk"],loader:()=>we(()=>import("./tcl-DnHyzjbg.js"),[])});Le({id:"twig",extensions:[".twig"],aliases:["Twig","twig"],mimetypes:["text/x-twig"],loader:()=>we(()=>import("./twig-CPajHgWi.js"),[])});Le({id:"typescript",extensions:[".ts",".tsx",".cts",".mts"],aliases:["TypeScript","ts","typescript"],mimetypes:["text/typescript"],loader:()=>we(()=>import("./typescript-6KArqQOB.js"),[])});Le({id:"typespec",extensions:[".tsp"],aliases:["TypeSpec"],loader:()=>we(()=>import("./typespec-D-MeaMDU.js"),[])});Le({id:"vb",extensions:[".vb"],aliases:["Visual Basic","vb"],loader:()=>we(()=>import("./vb-DgyLZaXg.js"),[])});Le({id:"wgsl",extensions:[".wgsl"],aliases:["WebGPU Shading Language","WGSL","wgsl"],loader:()=>we(()=>import("./wgsl-BIv9DU6q.js"),[])});Le({id:"xml",extensions:[".xml",".xsd",".dtd",".ascx",".csproj",".config",".props",".targets",".wxi",".wxl",".wxs",".xaml",".svg",".svgz",".opf",".xslt",".xsl"],firstLine:"(\\<\\?xml.*)|(\\<svg)|(\\<\\!doctype\\s+svg)",aliases:["XML","xml"],mimetypes:["text/xml","application/xml","application/xaml+xml","application/xml-dtd"],loader:()=>we(()=>import("./xml-24x88iUk.js"),[])});Le({id:"yaml",extensions:[".yaml",".yml"],aliases:["YAML","yaml","YML","yml"],mimetypes:["application/x-yaml","text/x-yaml"],loader:()=>we(()=>import("./yaml-CxeIa4bU.js"),[])});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var aye=Object.defineProperty,lye=Object.getOwnPropertyDescriptor,cye=Object.getOwnPropertyNames,dye=Object.prototype.hasOwnProperty,hye=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of cye(e))!dye.call(o,n)&&n!==t&&aye(o,n,{get:()=>e[n],enumerable:!(i=lye(e,n))||i.enumerable});return o},uye=(o,e,t)=>(hye(o,e,"default"),t),yb={};uye(yb,Zw);var oW=class{constructor(e,t,i){this._onDidChange=new yb.Emitter,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this.options}get options(){return this._options}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setDiagnosticsOptions(e){this.setOptions(e)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},rW={validate:!0,lint:{compatibleVendorPrefixes:"ignore",vendorPrefix:"warning",duplicateProperties:"warning",emptyRules:"warning",importStatement:"ignore",boxModel:"ignore",universalSelector:"ignore",zeroUnits:"ignore",fontFaceProperties:"warning",hexColorLength:"error",argumentsInColorFunction:"error",unknownProperties:"warning",ieHack:"ignore",unknownVendorSpecificProperties:"ignore",propertyIgnoredDueToDisplay:"warning",important:"ignore",float:"ignore",idSelector:"ignore"},data:{useDefaultDataProvider:!0},format:{newlineBetweenSelectors:!0,newlineBetweenRules:!0,spaceAroundSelectorSeparator:!1,braceStyle:"collapse",maxPreserveNewLines:void 0,preserveNewLines:!0}},aW={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0,documentFormattingEdits:!0,documentRangeFormattingEdits:!0},Dj=new oW("css",rW,aW),Ij=new oW("scss",rW,aW),Nj=new oW("less",rW,aW);yb.languages.css={cssDefaults:Dj,lessDefaults:Nj,scssDefaults:Ij};function lW(){return we(()=>import("./cssMode-Vn9D2eu3.js"),[])}yb.languages.onLanguage("less",()=>{lW().then(o=>o.setupMode(Nj))});yb.languages.onLanguage("scss",()=>{lW().then(o=>o.setupMode(Ij))});yb.languages.onLanguage("css",()=>{lW().then(o=>o.setupMode(Dj))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var gye=Object.defineProperty,fye=Object.getOwnPropertyDescriptor,pye=Object.getOwnPropertyNames,mye=Object.prototype.hasOwnProperty,_ye=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of pye(e))!mye.call(o,n)&&n!==t&&gye(o,n,{get:()=>e[n],enumerable:!(i=fye(e,n))||i.enumerable});return o},bye=(o,e,t)=>(_ye(o,e,"default"),t),dD={};bye(dD,Zw);var vye=class{constructor(e,t,i){this._onDidChange=new dD.Emitter,this._languageId=e,this.setOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get options(){return this._options}get modeConfiguration(){return this._modeConfiguration}setOptions(e){this._options=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},Cye={tabSize:4,insertSpaces:!1,wrapLineLength:120,unformatted:'default": "a, abbr, acronym, b, bdo, big, br, button, cite, code, dfn, em, i, img, input, kbd, label, map, object, q, samp, select, small, span, strong, sub, sup, textarea, tt, var',contentUnformatted:"pre",indentInnerHtml:!1,preserveNewLines:!0,maxPreserveNewLines:void 0,indentHandlebars:!1,endWithNewline:!1,extraLiners:"head, body, /html",wrapAttributes:"auto"},hD={format:Cye,suggest:{},data:{useDefaultDataProvider:!0}};function uD(o){return{completionItems:!0,hovers:!0,documentSymbols:!0,links:!0,documentHighlights:!0,rename:!0,colors:!0,foldingRanges:!0,selectionRanges:!0,diagnostics:o===lC,documentFormattingEdits:o===lC,documentRangeFormattingEdits:o===lC}}var lC="html",Q9="handlebars",J9="razor",Rj=gD(lC,hD,uD(lC)),yye=Rj.defaults,Pj=gD(Q9,hD,uD(Q9)),wye=Pj.defaults,Aj=gD(J9,hD,uD(J9)),Sye=Aj.defaults;dD.languages.html={htmlDefaults:yye,razorDefaults:Sye,handlebarDefaults:wye,htmlLanguageService:Rj,handlebarLanguageService:Pj,razorLanguageService:Aj,registerHTMLLanguageService:gD};function xye(){return we(()=>import("./htmlMode-DGYPXKay.js"),[])}function gD(o,e=hD,t=uD(o)){const i=new vye(o,e,t);let n;const s=dD.languages.onLanguage(o,async()=>{n=(await xye()).setupMode(i)});return{defaults:i,dispose(){s.dispose(),n?.dispose(),n=void 0}}}/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var Lye=Object.defineProperty,kye=Object.getOwnPropertyDescriptor,Eye=Object.getOwnPropertyNames,Tye=Object.prototype.hasOwnProperty,Dye=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Eye(e))!Tye.call(o,n)&&n!==t&&Lye(o,n,{get:()=>e[n],enumerable:!(i=kye(e,n))||i.enumerable});return o},Iye=(o,e,t)=>(Dye(o,e,"default"),t),Yw={};Iye(Yw,Zw);var Nye=class{constructor(e,t,i){this._onDidChange=new Yw.Emitter,this._languageId=e,this.setDiagnosticsOptions(t),this.setModeConfiguration(i)}get onDidChange(){return this._onDidChange.event}get languageId(){return this._languageId}get modeConfiguration(){return this._modeConfiguration}get diagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(e){this._diagnosticsOptions=e||Object.create(null),this._onDidChange.fire(this)}setModeConfiguration(e){this._modeConfiguration=e||Object.create(null),this._onDidChange.fire(this)}},Rye={validate:!0,allowComments:!0,schemas:[],enableSchemaRequest:!1,schemaRequest:"warning",schemaValidation:"warning",comments:"error",trailingCommas:"error"},Pye={documentFormattingEdits:!0,documentRangeFormattingEdits:!0,completionItems:!0,hovers:!0,documentSymbols:!0,tokens:!0,colors:!0,foldingRanges:!0,diagnostics:!0,selectionRanges:!0},Mj=new Nye("json",Rye,Pye),Aye=()=>Oj().then(o=>o.getWorker());Yw.languages.json={jsonDefaults:Mj,getWorker:Aye};function Oj(){return we(()=>import("./jsonMode-0mq0S3wU.js"),[])}Yw.languages.register({id:"json",extensions:[".json",".bowerrc",".jshintrc",".jscsrc",".eslintrc",".babelrc",".har"],aliases:["JSON","json"],mimetypes:["application/json"]});Yw.languages.onLanguage("json",()=>{Oj().then(o=>o.setupMode(Mj))});/*!-----------------------------------------------------------------------------
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Version: 0.52.2(404545bded1df6ffa41ea0af4e8ddb219018c6c1)
 * Released under the MIT license
 * https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt
 *-----------------------------------------------------------------------------*/var Mye=Object.defineProperty,Oye=Object.getOwnPropertyDescriptor,Fye=Object.getOwnPropertyNames,Bye=Object.prototype.hasOwnProperty,Wye=(o,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Fye(e))!Bye.call(o,n)&&n!==t&&Mye(o,n,{get:()=>e[n],enumerable:!(i=Oye(e,n))||i.enumerable});return o},Vye=(o,e,t)=>(Wye(o,e,"default"),t),Hye="5.4.5",W_={};Vye(W_,Zw);var Fj=(o=>(o[o.None=0]="None",o[o.CommonJS=1]="CommonJS",o[o.AMD=2]="AMD",o[o.UMD=3]="UMD",o[o.System=4]="System",o[o.ES2015=5]="ES2015",o[o.ESNext=99]="ESNext",o))(Fj||{}),Bj=(o=>(o[o.None=0]="None",o[o.Preserve=1]="Preserve",o[o.React=2]="React",o[o.ReactNative=3]="ReactNative",o[o.ReactJSX=4]="ReactJSX",o[o.ReactJSXDev=5]="ReactJSXDev",o))(Bj||{}),Wj=(o=>(o[o.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",o[o.LineFeed=1]="LineFeed",o))(Wj||{}),Vj=(o=>(o[o.ES3=0]="ES3",o[o.ES5=1]="ES5",o[o.ES2015=2]="ES2015",o[o.ES2016=3]="ES2016",o[o.ES2017=4]="ES2017",o[o.ES2018=5]="ES2018",o[o.ES2019=6]="ES2019",o[o.ES2020=7]="ES2020",o[o.ESNext=99]="ESNext",o[o.JSON=100]="JSON",o[o.Latest=99]="Latest",o))(Vj||{}),Hj=(o=>(o[o.Classic=1]="Classic",o[o.NodeJs=2]="NodeJs",o))(Hj||{}),zj=class{constructor(o,e,t,i,n){this._onDidChange=new W_.Emitter,this._onDidExtraLibsChange=new W_.Emitter,this._extraLibs=Object.create(null),this._removedExtraLibs=Object.create(null),this._eagerModelSync=!1,this.setCompilerOptions(o),this.setDiagnosticsOptions(e),this.setWorkerOptions(t),this.setInlayHintsOptions(i),this.setModeConfiguration(n),this._onDidExtraLibsChangeTimeout=-1}get onDidChange(){return this._onDidChange.event}get onDidExtraLibsChange(){return this._onDidExtraLibsChange.event}get modeConfiguration(){return this._modeConfiguration}get workerOptions(){return this._workerOptions}get inlayHintsOptions(){return this._inlayHintsOptions}getExtraLibs(){return this._extraLibs}addExtraLib(o,e){let t;if(typeof e>"u"?t=`ts:extralib-${Math.random().toString(36).substring(2,15)}`:t=e,this._extraLibs[t]&&this._extraLibs[t].content===o)return{dispose:()=>{}};let i=1;return this._removedExtraLibs[t]&&(i=this._removedExtraLibs[t]+1),this._extraLibs[t]&&(i=this._extraLibs[t].version+1),this._extraLibs[t]={content:o,version:i},this._fireOnDidExtraLibsChangeSoon(),{dispose:()=>{let n=this._extraLibs[t];n&&n.version===i&&(delete this._extraLibs[t],this._removedExtraLibs[t]=i,this._fireOnDidExtraLibsChangeSoon())}}}setExtraLibs(o){for(const e in this._extraLibs)this._removedExtraLibs[e]=this._extraLibs[e].version;if(this._extraLibs=Object.create(null),o&&o.length>0)for(const e of o){const t=e.filePath||`ts:extralib-${Math.random().toString(36).substring(2,15)}`,i=e.content;let n=1;this._removedExtraLibs[t]&&(n=this._removedExtraLibs[t]+1),this._extraLibs[t]={content:i,version:n}}this._fireOnDidExtraLibsChangeSoon()}_fireOnDidExtraLibsChangeSoon(){this._onDidExtraLibsChangeTimeout===-1&&(this._onDidExtraLibsChangeTimeout=window.setTimeout(()=>{this._onDidExtraLibsChangeTimeout=-1,this._onDidExtraLibsChange.fire(void 0)},0))}getCompilerOptions(){return this._compilerOptions}setCompilerOptions(o){this._compilerOptions=o||Object.create(null),this._onDidChange.fire(void 0)}getDiagnosticsOptions(){return this._diagnosticsOptions}setDiagnosticsOptions(o){this._diagnosticsOptions=o||Object.create(null),this._onDidChange.fire(void 0)}setWorkerOptions(o){this._workerOptions=o||Object.create(null),this._onDidChange.fire(void 0)}setInlayHintsOptions(o){this._inlayHintsOptions=o||Object.create(null),this._onDidChange.fire(void 0)}setMaximumWorkerIdleTime(o){}setEagerModelSync(o){this._eagerModelSync=o}getEagerModelSync(){return this._eagerModelSync}setModeConfiguration(o){this._modeConfiguration=o||Object.create(null),this._onDidChange.fire(void 0)}},zye=Hye,Uj={completionItems:!0,hovers:!0,documentSymbols:!0,definitions:!0,references:!0,documentHighlights:!0,rename:!0,diagnostics:!0,documentRangeFormattingEdits:!0,signatureHelp:!0,onTypeFormattingEdits:!0,codeActions:!0,inlayHints:!0},Gj=new zj({allowNonTsExtensions:!0,target:99},{noSemanticValidation:!1,noSyntaxValidation:!1,onlyVisible:!1},{},{},Uj),$j=new zj({allowNonTsExtensions:!0,allowJs:!0,target:99},{noSemanticValidation:!0,noSyntaxValidation:!1,onlyVisible:!1},{},{},Uj),Uye=()=>fD().then(o=>o.getTypeScriptWorker()),Gye=()=>fD().then(o=>o.getJavaScriptWorker());W_.languages.typescript={ModuleKind:Fj,JsxEmit:Bj,NewLineKind:Wj,ScriptTarget:Vj,ModuleResolutionKind:Hj,typescriptVersion:zye,typescriptDefaults:Gj,javascriptDefaults:$j,getTypeScriptWorker:Uye,getJavaScriptWorker:Gye};function fD(){return we(()=>import("./tsMode-Df-RWKDW.js"),[])}W_.languages.onLanguage("typescript",()=>fD().then(o=>o.setupTypeScript(Gj)));W_.languages.onLanguage("javascript",()=>fD().then(o=>o.setupJavaScript($j)));class $ye extends _s{constructor(){super({id:"diffEditor.toggleCollapseUnchangedRegions",title:De("toggleCollapseUnchangedRegions","Toggle Collapse Unchanged Regions"),icon:J.map,toggled:K.has("config.diffEditor.hideUnchangedRegions.enabled"),precondition:K.has("isInDiffEditor"),menu:{when:K.has("isInDiffEditor"),id:fe.EditorTitle,order:22,group:"navigation"}})}run(e,...t){const i=e.get(Ke),n=!i.getValue("diffEditor.hideUnchangedRegions.enabled");i.updateValue("diffEditor.hideUnchangedRegions.enabled",n)}}class Kj extends _s{constructor(){super({id:"diffEditor.toggleShowMovedCodeBlocks",title:De("toggleShowMovedCodeBlocks","Toggle Show Moved Code Blocks"),precondition:K.has("isInDiffEditor")})}run(e,...t){const i=e.get(Ke),n=!i.getValue("diffEditor.experimental.showMoves");i.updateValue("diffEditor.experimental.showMoves",n)}}class jj extends _s{constructor(){super({id:"diffEditor.toggleUseInlineViewWhenSpaceIsLimited",title:De("toggleUseInlineViewWhenSpaceIsLimited","Toggle Use Inline View When Space Is Limited"),precondition:K.has("isInDiffEditor")})}run(e,...t){const i=e.get(Ke),n=!i.getValue("diffEditor.useInlineViewWhenSpaceIsLimited");i.updateValue("diffEditor.useInlineViewWhenSpaceIsLimited",n)}}const Xw=De("diffEditor","Diff Editor");class Kye extends Fa{constructor(){super({id:"diffEditor.switchSide",title:De("switchSide","Switch Side"),icon:J.arrowSwap,precondition:K.has("isInDiffEditor"),f1:!0,category:Xw})}runEditorCommand(e,t,i){const n=wb(e);if(n instanceof Xc){if(i&&i.dryRun)return{destinationSelection:n.mapToOtherSide().destinationSelection};n.switchSide()}}}class jye extends Fa{constructor(){super({id:"diffEditor.exitCompareMove",title:De("exitCompareMove","Exit Compare Move"),icon:J.close,precondition:T.comparingMovedCode,f1:!1,category:Xw,keybinding:{weight:1e4,primary:9}})}runEditorCommand(e,t,...i){const n=wb(e);n instanceof Xc&&n.exitCompareMove()}}class qye extends Fa{constructor(){super({id:"diffEditor.collapseAllUnchangedRegions",title:De("collapseAllUnchangedRegions","Collapse All Unchanged Regions"),icon:J.fold,precondition:K.has("isInDiffEditor"),f1:!0,category:Xw})}runEditorCommand(e,t,...i){const n=wb(e);n instanceof Xc&&n.collapseAllUnchangedRegions()}}class Zye extends Fa{constructor(){super({id:"diffEditor.showAllUnchangedRegions",title:De("showAllUnchangedRegions","Show All Unchanged Regions"),icon:J.unfold,precondition:K.has("isInDiffEditor"),f1:!0,category:Xw})}runEditorCommand(e,t,...i){const n=wb(e);n instanceof Xc&&n.showAllUnchangedRegions()}}class IO extends _s{constructor(){super({id:"diffEditor.revert",title:De("revert","Revert"),f1:!1,category:Xw})}run(e,t){const i=Yye(e,t.originalUri,t.modifiedUri);i instanceof Xc&&i.revertRangeMappings(t.mapping.innerChanges??[])}}const qj=De("accessibleDiffViewer","Accessible Diff Viewer"),lE=class lE extends _s{constructor(){super({id:lE.id,title:De("editor.action.accessibleDiffViewer.next","Go to Next Difference"),category:qj,precondition:K.has("isInDiffEditor"),keybinding:{primary:65,weight:100},f1:!0})}run(e){wb(e)?.accessibleDiffViewerNext()}};lE.id="editor.action.accessibleDiffViewer.next";let $y=lE;const cE=class cE extends _s{constructor(){super({id:cE.id,title:De("editor.action.accessibleDiffViewer.prev","Go to Previous Difference"),category:qj,precondition:K.has("isInDiffEditor"),keybinding:{primary:1089,weight:100},f1:!0})}run(e){wb(e)?.accessibleDiffViewerPrev()}};cE.id="editor.action.accessibleDiffViewer.prev";let pL=cE;function Yye(o,e,t){return o.get(gt).listDiffEditors().find(s=>{const r=s.getModifiedEditor(),a=s.getOriginalEditor();return r&&r.getModel()?.uri.toString()===t.toString()&&a&&a.getModel()?.uri.toString()===e.toString()})||null}function wb(o){const t=o.get(gt).listDiffEditors(),i=Ln();if(i)for(const n of t){const s=n.getContainerDomNode();if(Xye(s,i))return n}return null}function Xye(o,e){let t=e;for(;t;){if(t===o)return!0;t=t.parentElement}return!1}At($ye);At(Kj);At(jj);sn.appendMenuItem(fe.EditorTitle,{command:{id:new jj().desc.id,title:p("useInlineViewWhenSpaceIsLimited","Use Inline View When Space Is Limited"),toggled:K.has("config.diffEditor.useInlineViewWhenSpaceIsLimited"),precondition:K.has("isInDiffEditor")},order:11,group:"1_diff",when:K.and(T.diffEditorRenderSideBySideInlineBreakpointReached,K.has("isInDiffEditor"))});sn.appendMenuItem(fe.EditorTitle,{command:{id:new Kj().desc.id,title:p("showMoves","Show Moved Code Blocks"),icon:J.move,toggled:sb.create("config.diffEditor.experimental.showMoves",!0),precondition:K.has("isInDiffEditor")},order:10,group:"1_diff",when:K.has("isInDiffEditor")});At(IO);for(const o of[{icon:J.arrowRight,key:T.diffEditorInlineMode.toNegated()},{icon:J.discard,key:T.diffEditorInlineMode}])sn.appendMenuItem(fe.DiffEditorHunkToolbar,{command:{id:new IO().desc.id,title:p("revertHunk","Revert Block"),icon:o.icon},when:K.and(T.diffEditorModifiedWritable,o.key),order:5,group:"primary"}),sn.appendMenuItem(fe.DiffEditorSelectionToolbar,{command:{id:new IO().desc.id,title:p("revertSelection","Revert Selection"),icon:o.icon},when:K.and(T.diffEditorModifiedWritable,o.key),order:5,group:"primary"});At(Kye);At(jye);At(qye);At(Zye);sn.appendMenuItem(fe.EditorTitle,{command:{id:$y.id,title:p("Open Accessible Diff Viewer","Open Accessible Diff Viewer"),precondition:K.has("isInDiffEditor")},order:10,group:"2_diff",when:K.and(T.accessibleDiffViewerVisible.negate(),K.has("isInDiffEditor"))});st.registerCommandAlias("editor.action.diffReview.next",$y.id);At($y);st.registerCommandAlias("editor.action.diffReview.prev",pL.id);At(pL);var Qye=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Jye=function(o,e){return function(t,i){e(t,i,o)}},NO;const pD=new re("selectionAnchorSet",!1);var Eg;let Uh=(Eg=class{static get(e){return e.getContribution(NO.ID)}constructor(e,t){this.editor=e,this.selectionAnchorSetContextKey=pD.bindTo(t),this.modelChangeListener=e.onDidChangeModel(()=>this.selectionAnchorSetContextKey.reset())}setSelectionAnchor(){if(this.editor.hasModel()){const e=this.editor.getPosition();this.editor.changeDecorations(t=>{this.decorationId&&t.removeDecoration(this.decorationId),this.decorationId=t.addDecoration(pe.fromPositions(e,e),{description:"selection-anchor",stickiness:1,hoverMessage:new Pn().appendText(p("selectionAnchor","Selection Anchor")),className:"selection-anchor"})}),this.selectionAnchorSetContextKey.set(!!this.decorationId),ps(p("anchorSet","Anchor set at {0}:{1}",e.lineNumber,e.column))}}goToSelectionAnchor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);e&&this.editor.setPosition(e.getStartPosition())}}selectFromAnchorToCursor(){if(this.editor.hasModel()&&this.decorationId){const e=this.editor.getModel().getDecorationRange(this.decorationId);if(e){const t=this.editor.getPosition();this.editor.setSelection(pe.fromPositions(e.getStartPosition(),t)),this.cancelSelectionAnchor()}}}cancelSelectionAnchor(){if(this.decorationId){const e=this.decorationId;this.editor.changeDecorations(t=>{t.removeDecoration(e),this.decorationId=void 0}),this.selectionAnchorSetContextKey.set(!1)}}dispose(){this.cancelSelectionAnchor(),this.modelChangeListener.dispose()}},NO=Eg,Eg.ID="editor.contrib.selectionAnchorController",Eg);Uh=NO=Qye([Jye(1,Ee)],Uh);class ewe extends de{constructor(){super({id:"editor.action.setSelectionAnchor",label:p("setSelectionAnchor","Set Selection Anchor"),alias:"Set Selection Anchor",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2080),weight:100}})}async run(e,t){Uh.get(t)?.setSelectionAnchor()}}class twe extends de{constructor(){super({id:"editor.action.goToSelectionAnchor",label:p("goToSelectionAnchor","Go to Selection Anchor"),alias:"Go to Selection Anchor",precondition:pD})}async run(e,t){Uh.get(t)?.goToSelectionAnchor()}}class iwe extends de{constructor(){super({id:"editor.action.selectFromAnchorToCursor",label:p("selectFromAnchorToCursor","Select from Anchor to Cursor"),alias:"Select from Anchor to Cursor",precondition:pD,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2089),weight:100}})}async run(e,t){Uh.get(t)?.selectFromAnchorToCursor()}}class nwe extends de{constructor(){super({id:"editor.action.cancelSelectionAnchor",label:p("cancelSelectionAnchor","Cancel Selection Anchor"),alias:"Cancel Selection Anchor",precondition:pD,kbOpts:{kbExpr:T.editorTextFocus,primary:9,weight:100}})}async run(e,t){Uh.get(t)?.cancelSelectionAnchor()}}at(Uh.ID,Uh,4);X(ewe);X(twe);X(iwe);X(nwe);const swe=D("editorOverviewRuler.bracketMatchForeground","#A0A0A0",p("overviewRulerBracketMatchForeground","Overview ruler marker color for matching brackets."));class owe extends de{constructor(){super({id:"editor.action.jumpToBracket",label:p("smartSelect.jumpBracket","Go to Bracket"),alias:"Go to Bracket",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:3165,weight:100}})}run(e,t){Nf.get(t)?.jumpToBracket()}}class rwe extends de{constructor(){super({id:"editor.action.selectToBracket",label:p("smartSelect.selectToBracket","Select to Bracket"),alias:"Select to Bracket",precondition:void 0,metadata:{description:De("smartSelect.selectToBracketDescription","Select the text inside and including the brackets or curly braces"),args:[{name:"args",schema:{type:"object",properties:{selectBrackets:{type:"boolean",default:!0}}}}]}})}run(e,t,i){let n=!0;i&&i.selectBrackets===!1&&(n=!1),Nf.get(t)?.selectToBracket(n)}}class awe extends de{constructor(){super({id:"editor.action.removeBrackets",label:p("smartSelect.removeBrackets","Remove Brackets"),alias:"Remove Brackets",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:2561,weight:100}})}run(e,t){Nf.get(t)?.removeBrackets(this.id)}}class lwe{constructor(e,t,i){this.position=e,this.brackets=t,this.options=i}}const Dd=class Dd extends F{static get(e){return e.getContribution(Dd.ID)}constructor(e){super(),this._editor=e,this._lastBracketsData=[],this._lastVersionId=0,this._decorations=this._editor.createDecorationsCollection(),this._updateBracketsSoon=this._register(new xt(()=>this._updateBrackets(),50)),this._matchBrackets=this._editor.getOption(72),this._updateBracketsSoon.schedule(),this._register(e.onDidChangeCursorPosition(t=>{this._matchBrackets!=="never"&&this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelContent(t=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModel(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeModelLanguageConfiguration(t=>{this._lastBracketsData=[],this._updateBracketsSoon.schedule()})),this._register(e.onDidChangeConfiguration(t=>{t.hasChanged(72)&&(this._matchBrackets=this._editor.getOption(72),this._decorations.clear(),this._lastBracketsData=[],this._lastVersionId=0,this._updateBracketsSoon.schedule())})),this._register(e.onDidBlurEditorWidget(()=>{this._updateBracketsSoon.schedule()})),this._register(e.onDidFocusEditorWidget(()=>{this._updateBracketsSoon.schedule()}))}jumpToBracket(){if(!this._editor.hasModel())return;const e=this._editor.getModel(),t=this._editor.getSelections().map(i=>{const n=i.getStartPosition(),s=e.bracketPairs.matchBracket(n);let r=null;if(s)s[0].containsPosition(n)&&!s[1].containsPosition(n)?r=s[1].getStartPosition():s[1].containsPosition(n)&&(r=s[0].getStartPosition());else{const a=e.bracketPairs.findEnclosingBrackets(n);if(a)r=a[1].getStartPosition();else{const l=e.bracketPairs.findNextBracket(n);l&&l.range&&(r=l.range.getStartPosition())}}return r?new pe(r.lineNumber,r.column,r.lineNumber,r.column):new pe(n.lineNumber,n.column,n.lineNumber,n.column)});this._editor.setSelections(t),this._editor.revealRange(t[0])}selectToBracket(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=[];this._editor.getSelections().forEach(n=>{const s=n.getStartPosition();let r=t.bracketPairs.matchBracket(s);if(!r&&(r=t.bracketPairs.findEnclosingBrackets(s),!r)){const c=t.bracketPairs.findNextBracket(s);c&&c.range&&(r=t.bracketPairs.matchBracket(c.range.getStartPosition()))}let a=null,l=null;if(r){r.sort(L.compareRangesUsingStarts);const[c,d]=r;if(a=e?c.getStartPosition():c.getEndPosition(),l=e?d.getEndPosition():d.getStartPosition(),d.containsPosition(s)){const h=a;a=l,l=h}}a&&l&&i.push(new pe(a.lineNumber,a.column,l.lineNumber,l.column))}),i.length>0&&(this._editor.setSelections(i),this._editor.revealRange(i[0]))}removeBrackets(e){if(!this._editor.hasModel())return;const t=this._editor.getModel();this._editor.getSelections().forEach(i=>{const n=i.getPosition();let s=t.bracketPairs.matchBracket(n);s||(s=t.bracketPairs.findEnclosingBrackets(n)),s&&(this._editor.pushUndoStop(),this._editor.executeEdits(e,[{range:s[0],text:""},{range:s[1],text:""}]),this._editor.pushUndoStop())})}_updateBrackets(){if(this._matchBrackets==="never")return;this._recomputeBrackets();const e=[];let t=0;for(const i of this._lastBracketsData){const n=i.brackets;n&&(e[t++]={range:n[0],options:i.options},e[t++]={range:n[1],options:i.options})}this._decorations.set(e)}_recomputeBrackets(){if(!this._editor.hasModel()||!this._editor.hasWidgetFocus()){this._lastBracketsData=[],this._lastVersionId=0;return}const e=this._editor.getSelections();if(e.length>100){this._lastBracketsData=[],this._lastVersionId=0;return}const t=this._editor.getModel(),i=t.getVersionId();let n=[];this._lastVersionId===i&&(n=this._lastBracketsData);const s=[];let r=0;for(let h=0,u=e.length;h<u;h++){const g=e[h];g.isEmpty()&&(s[r++]=g.getStartPosition())}s.length>1&&s.sort(A.compare);const a=[];let l=0,c=0;const d=n.length;for(let h=0,u=s.length;h<u;h++){const g=s[h];for(;c<d&&n[c].position.isBefore(g);)c++;if(c<d&&n[c].position.equals(g))a[l++]=n[c];else{let f=t.bracketPairs.matchBracket(g,20),m=Dd._DECORATION_OPTIONS_WITH_OVERVIEW_RULER;!f&&this._matchBrackets==="always"&&(f=t.bracketPairs.findEnclosingBrackets(g,20),m=Dd._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER),a[l++]=new lwe(g,f,m)}}this._lastBracketsData=a,this._lastVersionId=i}};Dd.ID="editor.contrib.bracketMatchingController",Dd._DECORATION_OPTIONS_WITH_OVERVIEW_RULER=Fe.register({description:"bracket-match-overview",stickiness:1,className:"bracket-match",overviewRuler:{color:fi(swe),position:Ao.Center}}),Dd._DECORATION_OPTIONS_WITHOUT_OVERVIEW_RULER=Fe.register({description:"bracket-match-no-overview",stickiness:1,className:"bracket-match"});let Nf=Dd;at(Nf.ID,Nf,1);X(rwe);X(owe);X(awe);sn.appendMenuItem(fe.MenubarGoMenu,{group:"5_infile_nav",command:{id:"editor.action.jumpToBracket",title:p({key:"miGoToBracket",comment:["&& denotes a mnemonic"]},"Go to &&Bracket")},order:2});class cwe{constructor(e,t){this._selection=e,this._isMovingLeft=t}getEditOperations(e,t){if(this._selection.startLineNumber!==this._selection.endLineNumber||this._selection.isEmpty())return;const i=this._selection.startLineNumber,n=this._selection.startColumn,s=this._selection.endColumn;if(!(this._isMovingLeft&&n===1)&&!(!this._isMovingLeft&&s===e.getLineMaxColumn(i)))if(this._isMovingLeft){const r=new L(i,n-1,i,n),a=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new L(i,s,i,s),a)}else{const r=new L(i,s,i,s+1),a=e.getValueInRange(r);t.addEditOperation(r,null),t.addEditOperation(new L(i,n,i,n),a)}}computeCursorState(e,t){return this._isMovingLeft?new pe(this._selection.startLineNumber,this._selection.startColumn-1,this._selection.endLineNumber,this._selection.endColumn-1):new pe(this._selection.startLineNumber,this._selection.startColumn+1,this._selection.endLineNumber,this._selection.endColumn+1)}}class Zj extends de{constructor(e,t){super(t),this.left=e}run(e,t){if(!t.hasModel())return;const i=[],n=t.getSelections();for(const s of n)i.push(new cwe(s,this.left));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}class dwe extends Zj{constructor(){super(!0,{id:"editor.action.moveCarretLeftAction",label:p("caret.moveLeft","Move Selected Text Left"),alias:"Move Selected Text Left",precondition:T.writable})}}class hwe extends Zj{constructor(){super(!1,{id:"editor.action.moveCarretRightAction",label:p("caret.moveRight","Move Selected Text Right"),alias:"Move Selected Text Right",precondition:T.writable})}}X(dwe);X(hwe);class uwe extends de{constructor(){super({id:"editor.action.transposeLetters",label:p("transposeLetters.label","Transpose Letters"),alias:"Transpose Letters",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:306},weight:100}})}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=[],s=t.getSelections();for(const r of s){if(!r.isEmpty())continue;const a=r.startLineNumber,l=r.startColumn,c=i.getLineMaxColumn(a);if(a===1&&(l===1||l===2&&c===2))continue;const d=l===c?r.getPosition():Ct.rightPosition(i,r.getPosition().lineNumber,r.getPosition().column),h=Ct.leftPosition(i,d),u=Ct.leftPosition(i,h),g=i.getValueInRange(L.fromPositions(u,h)),f=i.getValueInRange(L.fromPositions(h,d)),m=L.fromPositions(u,d);n.push(new xn(m,f+g))}n.length>0&&(t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop())}}X(uwe);const mD=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let o;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?o=crypto.getRandomValues.bind(crypto):o=function(i){for(let n=0;n<i.length;n++)i[n]=Math.floor(Math.random()*256);return i};const e=new Uint8Array(16),t=[];for(let i=0;i<256;i++)t.push(i.toString(16).padStart(2,"0"));return function(){o(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let n=0,s="";return s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+="-",s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s+=t[e[n++]],s}}();function cW(o){return{asString:async()=>o,asFile:()=>{},value:typeof o=="string"?o:void 0}}function gwe(o,e,t){const i={id:mD(),name:o,uri:e,data:t};return{asString:async()=>"",asFile:()=>i,value:void 0}}class Yj{constructor(){this._entries=new Map}get size(){let e=0;for(const t of this._entries)e++;return e}has(e){return this._entries.has(this.toKey(e))}matches(e){const t=[...this._entries.keys()];return nt.some(this,([i,n])=>n.asFile())&&t.push("files"),Qj(mL(e),t)}get(e){return this._entries.get(this.toKey(e))?.[0]}append(e,t){const i=this._entries.get(e);i?i.push(t):this._entries.set(this.toKey(e),[t])}replace(e,t){this._entries.set(this.toKey(e),[t])}delete(e){this._entries.delete(this.toKey(e))}*[Symbol.iterator](){for(const[e,t]of this._entries)for(const i of t)yield[e,i]}toKey(e){return mL(e)}}function mL(o){return o.toLowerCase()}function Xj(o,e){return Qj(mL(o),e.map(mL))}function Qj(o,e){if(o==="*/*")return e.length>0;if(e.includes(o))return!0;const t=o.match(/^([a-z]+)\/([a-z]+|\*)$/i);if(!t)return!1;const[i,n,s]=t;return s==="*"?e.some(r=>r.startsWith(n+"/")):!1}const _D=Object.freeze({create:o=>Uc(o.map(e=>e.toString())).join(`\r
`),split:o=>o.split(`\r
`),parse:o=>_D.split(o).filter(e=>!e.startsWith("#"))}),sl=class sl{constructor(e){this.value=e}equals(e){return this.value===e.value}contains(e){return this.equals(e)||this.value===""||e.value.startsWith(this.value+sl.sep)}intersects(e){return this.contains(e)||e.contains(this)}append(...e){return new sl((this.value?[this.value,...e]:e).join(sl.sep))}};sl.sep=".",sl.None=new sl("@@none@@"),sl.Empty=new sl("");let Jt=sl;const e8={EDITORS:"CodeEditors",FILES:"CodeFiles"};class fwe{}const pwe={DragAndDropContribution:"workbench.contributions.dragAndDrop"};ai.add(pwe.DragAndDropContribution,new fwe);const AC=class AC{constructor(){}static getInstance(){return AC.INSTANCE}hasData(e){return e&&e===this.proto}getData(e){if(this.hasData(e))return this.data}};AC.INSTANCE=new AC;let RO=AC;function Jj(o){const e=new Yj;for(const t of o.items){const i=t.type;if(t.kind==="string"){const n=new Promise(s=>t.getAsString(s));e.append(i,cW(n))}else if(t.kind==="file"){const n=t.getAsFile();n&&e.append(i,mwe(n))}}return e}function mwe(o){const e=o.path?ye.parse(o.path):void 0;return gwe(o.name,e,async()=>new Uint8Array(await o.arrayBuffer()))}const _we=Object.freeze([e8.EDITORS,e8.FILES,_y.RESOURCES,_y.INTERNAL_URI_LIST]);function eq(o,e=!1){const t=Jj(o),i=t.get(_y.INTERNAL_URI_LIST);if(i)t.replace(vi.uriList,i);else if(e||!t.has(vi.uriList)){const n=[];for(const s of o.items){const r=s.getAsFile();if(r){const a=r.path;try{a?n.push(ye.file(a).toString()):n.push(ye.parse(r.name,!0).toString())}catch{}}}n.length&&t.replace(vi.uriList,cW(_D.create(n)))}for(const n of _we)t.delete(n);return t}var dW=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ky=function(o,e){return function(t,i){e(t,i,o)}};class hW{async provideDocumentPasteEdits(e,t,i,n,s){const r=await this.getEdit(i,s);if(r)return{edits:[{insertText:r.insertText,title:r.title,kind:r.kind,handledMimeType:r.handledMimeType,yieldTo:r.yieldTo}],dispose(){}}}async provideDocumentDropEdits(e,t,i,n){const s=await this.getEdit(i,n);if(s)return{edits:[{insertText:s.insertText,title:s.title,kind:s.kind,handledMimeType:s.handledMimeType,yieldTo:s.yieldTo}],dispose(){}}}}const MC=class MC extends hW{constructor(){super(...arguments),this.kind=MC.kind,this.dropMimeTypes=[vi.text],this.pasteMimeTypes=[vi.text]}async getEdit(e,t){const i=e.get(vi.text);if(!i||e.has(vi.uriList))return;const n=await i.asString();return{handledMimeType:vi.text,title:p("text.label","Insert Plain Text"),insertText:n,kind:this.kind}}};MC.id="text",MC.kind=new Jt("text.plain");let Rf=MC;class tq extends hW{constructor(){super(...arguments),this.kind=new Jt("uri.absolute"),this.dropMimeTypes=[vi.uriList],this.pasteMimeTypes=[vi.uriList]}async getEdit(e,t){const i=await iq(e);if(!i.length||t.isCancellationRequested)return;let n=0;const s=i.map(({uri:a,originalText:l})=>a.scheme===Oe.file?a.fsPath:(n++,l)).join(" ");let r;return n>0?r=i.length>1?p("defaultDropProvider.uriList.uris","Insert Uris"):p("defaultDropProvider.uriList.uri","Insert Uri"):r=i.length>1?p("defaultDropProvider.uriList.paths","Insert Paths"):p("defaultDropProvider.uriList.path","Insert Path"),{handledMimeType:vi.uriList,insertText:s,title:r,kind:this.kind}}}let _L=class extends hW{constructor(e){super(),this._workspaceContextService=e,this.kind=new Jt("uri.relative"),this.dropMimeTypes=[vi.uriList],this.pasteMimeTypes=[vi.uriList]}async getEdit(e,t){const i=await iq(e);if(!i.length||t.isCancellationRequested)return;const n=Vr(i.map(({uri:s})=>{const r=this._workspaceContextService.getWorkspaceFolder(s);return r?yre(r.uri,s):void 0}));if(n.length)return{handledMimeType:vi.uriList,insertText:n.join(" "),title:i.length>1?p("defaultDropProvider.uriList.relativePaths","Insert Relative Paths"):p("defaultDropProvider.uriList.relativePath","Insert Relative Path"),kind:this.kind}}};_L=dW([Ky(0,Lf)],_L);class bwe{constructor(){this.kind=new Jt("html"),this.pasteMimeTypes=["text/html"],this._yieldTo=[{mimeType:vi.text}]}async provideDocumentPasteEdits(e,t,i,n,s){if(n.triggerKind!==$C.PasteAs&&!n.only?.contains(this.kind))return;const a=await i.get("text/html")?.asString();if(!(!a||s.isCancellationRequested))return{dispose(){},edits:[{insertText:a,yieldTo:this._yieldTo,title:p("pasteHtmlLabel","Insert HTML"),kind:this.kind}]}}}async function iq(o){const e=o.get(vi.uriList);if(!e)return[];const t=await e.asString(),i=[];for(const n of _D.parse(t))try{i.push({uri:ye.parse(n),originalText:n})}catch{}return i}let PO=class extends F{constructor(e,t){super(),this._register(e.documentDropEditProvider.register("*",new Rf)),this._register(e.documentDropEditProvider.register("*",new tq)),this._register(e.documentDropEditProvider.register("*",new _L(t)))}};PO=dW([Ky(0,ue),Ky(1,Lf)],PO);let AO=class extends F{constructor(e,t){super(),this._register(e.documentPasteEditProvider.register("*",new Rf)),this._register(e.documentPasteEditProvider.register("*",new tq)),this._register(e.documentPasteEditProvider.register("*",new _L(t))),this._register(e.documentPasteEditProvider.register("*",new bwe))}};AO=dW([Ky(0,ue),Ky(1,Lf)],AO);const Er=class Er{constructor(){this.value="",this.pos=0}static isDigitCharacter(e){return e>=48&&e<=57}static isVariableCharacter(e){return e===95||e>=97&&e<=122||e>=65&&e<=90}text(e){this.value=e,this.pos=0}tokenText(e){return this.value.substr(e.pos,e.len)}next(){if(this.pos>=this.value.length)return{type:14,pos:this.pos,len:0};const e=this.pos;let t=0,i=this.value.charCodeAt(e),n;if(n=Er._table[i],typeof n=="number")return this.pos+=1,{type:n,pos:e,len:1};if(Er.isDigitCharacter(i)){n=8;do t+=1,i=this.value.charCodeAt(e+t);while(Er.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}if(Er.isVariableCharacter(i)){n=9;do i=this.value.charCodeAt(e+ ++t);while(Er.isVariableCharacter(i)||Er.isDigitCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}n=10;do t+=1,i=this.value.charCodeAt(e+t);while(!isNaN(i)&&typeof Er._table[i]>"u"&&!Er.isDigitCharacter(i)&&!Er.isVariableCharacter(i));return this.pos+=t,{type:n,pos:e,len:t}}};Er._table={36:0,58:1,44:2,123:3,125:4,92:5,47:6,124:7,43:11,45:12,63:13};let MO=Er;class Sb{constructor(){this._children=[]}appendChild(e){return e instanceof ss&&this._children[this._children.length-1]instanceof ss?this._children[this._children.length-1].value+=e.value:(e.parent=this,this._children.push(e)),this}replace(e,t){const{parent:i}=e,n=i.children.indexOf(e),s=i.children.slice(0);s.splice(n,1,...t),i._children=s,function r(a,l){for(const c of a)c.parent=l,r(c.children,c)}(t,i)}get children(){return this._children}get rightMostDescendant(){return this._children.length>0?this._children[this._children.length-1].rightMostDescendant:this}get snippet(){let e=this;for(;;){if(!e)return;if(e instanceof Qw)return e;e=e.parent}}toString(){return this.children.reduce((e,t)=>e+t.toString(),"")}len(){return 0}}class ss extends Sb{constructor(e){super(),this.value=e}toString(){return this.value}len(){return this.value.length}clone(){return new ss(this.value)}}class nq extends Sb{}class tr extends nq{static compareByIndex(e,t){return e.index===t.index?0:e.isFinalTabstop?1:t.isFinalTabstop||e.index<t.index?-1:e.index>t.index?1:0}constructor(e){super(),this.index=e}get isFinalTabstop(){return this.index===0}get choice(){return this._children.length===1&&this._children[0]instanceof xb?this._children[0]:void 0}clone(){const e=new tr(this.index);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}class xb extends Sb{constructor(){super(...arguments),this.options=[]}appendChild(e){return e instanceof ss&&(e.parent=this,this.options.push(e)),this}toString(){return this.options[0].value}len(){return this.options[0].len()}clone(){const e=new xb;return this.options.forEach(e.appendChild,e),e}}class uW extends Sb{constructor(){super(...arguments),this.regexp=new RegExp("")}resolve(e){const t=this;let i=!1,n=e.replace(this.regexp,function(){return i=!0,t._replace(Array.prototype.slice.call(arguments,0,-2))});return!i&&this._children.some(s=>s instanceof da&&!!s.elseValue)&&(n=this._replace([])),n}_replace(e){let t="";for(const i of this._children)if(i instanceof da){let n=e[i.index]||"";n=i.resolve(n),t+=n}else t+=i.toString();return t}toString(){return""}clone(){const e=new uW;return e.regexp=new RegExp(this.regexp.source,(this.regexp.ignoreCase?"i":"")+(this.regexp.global?"g":"")),e._children=this.children.map(t=>t.clone()),e}}class da extends Sb{constructor(e,t,i,n){super(),this.index=e,this.shorthandName=t,this.ifValue=i,this.elseValue=n}resolve(e){return this.shorthandName==="upcase"?e?e.toLocaleUpperCase():"":this.shorthandName==="downcase"?e?e.toLocaleLowerCase():"":this.shorthandName==="capitalize"?e?e[0].toLocaleUpperCase()+e.substr(1):"":this.shorthandName==="pascalcase"?e?this._toPascalCase(e):"":this.shorthandName==="camelcase"?e?this._toCamelCase(e):"":e&&typeof this.ifValue=="string"?this.ifValue:!e&&typeof this.elseValue=="string"?this.elseValue:e||""}_toPascalCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map(i=>i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}_toCamelCase(e){const t=e.match(/[a-z0-9]+/gi);return t?t.map((i,n)=>n===0?i.charAt(0).toLowerCase()+i.substr(1):i.charAt(0).toUpperCase()+i.substr(1)).join(""):e}clone(){return new da(this.index,this.shorthandName,this.ifValue,this.elseValue)}}class jy extends nq{constructor(e){super(),this.name=e}resolve(e){let t=e.resolve(this);return this.transform&&(t=this.transform.resolve(t||"")),t!==void 0?(this._children=[new ss(t)],!0):!1}clone(){const e=new jy(this.name);return this.transform&&(e.transform=this.transform.clone()),e._children=this.children.map(t=>t.clone()),e}}function t8(o,e){const t=[...o];for(;t.length>0;){const i=t.shift();if(!e(i))break;t.unshift(...i.children)}}class Qw extends Sb{get placeholderInfo(){if(!this._placeholders){const e=[];let t;this.walk(function(i){return i instanceof tr&&(e.push(i),t=!t||t.index<i.index?i:t),!0}),this._placeholders={all:e,last:t}}return this._placeholders}get placeholders(){const{all:e}=this.placeholderInfo;return e}offset(e){let t=0,i=!1;return this.walk(n=>n===e?(i=!0,!1):(t+=n.len(),!0)),i?t:-1}fullLen(e){let t=0;return t8([e],i=>(t+=i.len(),!0)),t}enclosingPlaceholders(e){const t=[];let{parent:i}=e;for(;i;)i instanceof tr&&t.push(i),i=i.parent;return t}resolveVariables(e){return this.walk(t=>(t instanceof jy&&t.resolve(e)&&(this._placeholders=void 0),!0)),this}appendChild(e){return this._placeholders=void 0,super.appendChild(e)}replace(e,t){return this._placeholders=void 0,super.replace(e,t)}clone(){const e=new Qw;return this._children=this.children.map(t=>t.clone()),e}walk(e){t8(this.children,e)}}class Pf{constructor(){this._scanner=new MO,this._token={type:14,pos:0,len:0}}static escape(e){return e.replace(/\$|}|\\/g,"\\$&")}static guessNeedsClipboard(e){return/\${?CLIPBOARD/.test(e)}parse(e,t,i){const n=new Qw;return this.parseFragment(e,n),this.ensureFinalTabstop(n,i??!1,t??!1),n}parseFragment(e,t){const i=t.children.length;for(this._scanner.text(e),this._token=this._scanner.next();this._parse(t););const n=new Map,s=[];t.walk(l=>(l instanceof tr&&(l.isFinalTabstop?n.set(0,void 0):!n.has(l.index)&&l.children.length>0?n.set(l.index,l.children):s.push(l)),!0));const r=(l,c)=>{const d=n.get(l.index);if(!d)return;const h=new tr(l.index);h.transform=l.transform;for(const u of d){const g=u.clone();h.appendChild(g),g instanceof tr&&n.has(g.index)&&!c.has(g.index)&&(c.add(g.index),r(g,c),c.delete(g.index))}t.replace(l,[h])},a=new Set;for(const l of s)r(l,a);return t.children.slice(i)}ensureFinalTabstop(e,t,i){(t||i&&e.placeholders.length>0)&&(e.placeholders.find(s=>s.index===0)||e.appendChild(new tr(0)))}_accept(e,t){if(e===void 0||this._token.type===e){const i=t?this._scanner.tokenText(this._token):!0;return this._token=this._scanner.next(),i}return!1}_backTo(e){return this._scanner.pos=e.pos+e.len,this._token=e,!1}_until(e){const t=this._token;for(;this._token.type!==e;){if(this._token.type===14)return!1;if(this._token.type===5){const n=this._scanner.next();if(n.type!==0&&n.type!==4&&n.type!==5)return!1}this._token=this._scanner.next()}const i=this._scanner.value.substring(t.pos,this._token.pos).replace(/\\(\$|}|\\)/g,"$1");return this._token=this._scanner.next(),i}_parse(e){return this._parseEscaped(e)||this._parseTabstopOrVariableName(e)||this._parseComplexPlaceholder(e)||this._parseComplexVariable(e)||this._parseAnything(e)}_parseEscaped(e){let t;return(t=this._accept(5,!0))?(t=this._accept(0,!0)||this._accept(4,!0)||this._accept(5,!0)||t,e.appendChild(new ss(t)),!0):!1}_parseTabstopOrVariableName(e){let t;const i=this._token;return this._accept(0)&&(t=this._accept(9,!0)||this._accept(8,!0))?(e.appendChild(/^\d+$/.test(t)?new tr(Number(t)):new jy(t)),!0):this._backTo(i)}_parseComplexPlaceholder(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(8,!0))))return this._backTo(i);const s=new tr(Number(t));if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(s),!0;if(!this._parse(s))return e.appendChild(new ss("${"+t+":")),s.children.forEach(e.appendChild,e),!0}else if(s.index>0&&this._accept(7)){const r=new xb;for(;;){if(this._parseChoiceElement(r)){if(this._accept(2))continue;if(this._accept(7)&&(s.appendChild(r),this._accept(4)))return e.appendChild(s),!0}return this._backTo(i),!1}}else return this._accept(6)?this._parseTransform(s)?(e.appendChild(s),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(s),!0):this._backTo(i)}_parseChoiceElement(e){const t=this._token,i=[];for(;!(this._token.type===2||this._token.type===7);){let n;if((n=this._accept(5,!0))?n=this._accept(2,!0)||this._accept(7,!0)||this._accept(5,!0)||n:n=this._accept(void 0,!0),!n)return this._backTo(t),!1;i.push(n)}return i.length===0?(this._backTo(t),!1):(e.appendChild(new ss(i.join(""))),!0)}_parseComplexVariable(e){let t;const i=this._token;if(!(this._accept(0)&&this._accept(3)&&(t=this._accept(9,!0))))return this._backTo(i);const s=new jy(t);if(this._accept(1))for(;;){if(this._accept(4))return e.appendChild(s),!0;if(!this._parse(s))return e.appendChild(new ss("${"+t+":")),s.children.forEach(e.appendChild,e),!0}else return this._accept(6)?this._parseTransform(s)?(e.appendChild(s),!0):(this._backTo(i),!1):this._accept(4)?(e.appendChild(s),!0):this._backTo(i)}_parseTransform(e){const t=new uW;let i="",n="";for(;!this._accept(6);){let s;if(s=this._accept(5,!0)){s=this._accept(6,!0)||s,i+=s;continue}if(this._token.type!==14){i+=this._accept(void 0,!0);continue}return!1}for(;!this._accept(6);){let s;if(s=this._accept(5,!0)){s=this._accept(5,!0)||this._accept(6,!0)||s,t.appendChild(new ss(s));continue}if(!(this._parseFormatString(t)||this._parseAnything(t)))return!1}for(;!this._accept(4);){if(this._token.type!==14){n+=this._accept(void 0,!0);continue}return!1}try{t.regexp=new RegExp(i,n)}catch{return!1}return e.transform=t,!0}_parseFormatString(e){const t=this._token;if(!this._accept(0))return!1;let i=!1;this._accept(3)&&(i=!0);const n=this._accept(8,!0);if(n)if(i){if(this._accept(4))return e.appendChild(new da(Number(n))),!0;if(!this._accept(1))return this._backTo(t),!1}else return e.appendChild(new da(Number(n))),!0;else return this._backTo(t),!1;if(this._accept(6)){const s=this._accept(9,!0);return!s||!this._accept(4)?(this._backTo(t),!1):(e.appendChild(new da(Number(n),s)),!0)}else if(this._accept(11)){const s=this._until(4);if(s)return e.appendChild(new da(Number(n),void 0,s,void 0)),!0}else if(this._accept(12)){const s=this._until(4);if(s)return e.appendChild(new da(Number(n),void 0,void 0,s)),!0}else if(this._accept(13)){const s=this._until(1);if(s){const r=this._until(4);if(r)return e.appendChild(new da(Number(n),void 0,s,r)),!0}}else{const s=this._until(4);if(s)return e.appendChild(new da(Number(n),void 0,void 0,s)),!0}return this._backTo(t),!1}_parseAnything(e){return this._token.type!==14?(e.appendChild(new ss(this._scanner.tokenText(this._token))),this._accept(void 0),!0):!1}}function sq(o,e,t){return(typeof t.insertText=="string"?t.insertText==="":t.insertText.snippet==="")?{edits:t.additionalEdit?.edits??[]}:{edits:[...e.map(i=>new sh(o,{range:i,text:typeof t.insertText=="string"?Pf.escape(t.insertText)+"$0":t.insertText.snippet,insertAsSnippet:!0})),...t.additionalEdit?.edits??[]]}}function oq(o){function e(r,a){return"mimeType"in r?r.mimeType===a.handledMimeType:!!a.kind&&r.kind.contains(a.kind)}const t=new Map;for(const r of o)for(const a of r.yieldTo??[])for(const l of o)if(l!==r&&e(a,l)){let c=t.get(r);c||(c=[],t.set(r,c)),c.push(l)}if(!t.size)return Array.from(o);const i=new Set,n=[];function s(r){if(!r.length)return[];const a=r[0];if(n.includes(a))return console.warn("Yield to cycle detected",a),r;if(i.has(a))return s(r.slice(1));let l=[];const c=t.get(a);return c&&(n.push(a),l=s(c),n.pop()),i.add(a),[...l,a,...s(r.slice(1))]}return s(Array.from(o))}var vwe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Cwe=function(o,e){return function(t,i){e(t,i,o)}};const ywe=Fe.register({description:"inline-progress-widget",stickiness:1,showIfCollapsed:!0,after:{content:Iz,inlineClassName:"inline-editor-progress-decoration",inlineClassNameAffectsLetterSpacing:!0}}),dE=class dE extends F{constructor(e,t,i,n,s){super(),this.typeId=e,this.editor=t,this.range=i,this.delegate=s,this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this.create(n),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this)}create(e){this.domNode=ie(".inline-progress-widget"),this.domNode.role="button",this.domNode.title=e;const t=ie("span.icon");this.domNode.append(t),t.classList.add(...ke.asClassNameArray(J.loading),"codicon-modifier-spin");const i=()=>{const n=this.editor.getOption(67);this.domNode.style.height=`${n}px`,this.domNode.style.width=`${Math.ceil(.8*n)}px`};i(),this._register(this.editor.onDidChangeConfiguration(n=>{(n.hasChanged(52)||n.hasChanged(67))&&i()})),this._register(H(this.domNode,ee.CLICK,n=>{this.delegate.cancel()}))}getId(){return dE.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:{lineNumber:this.range.startLineNumber,column:this.range.startColumn},preference:[0]}}dispose(){super.dispose(),this.editor.removeContentWidget(this)}};dE.baseId="editor.widget.inlineProgressWidget";let OO=dE,bL=class extends F{constructor(e,t,i){super(),this.id=e,this._editor=t,this._instantiationService=i,this._showDelay=500,this._showPromise=this._register(new Yi),this._currentWidget=this._register(new Yi),this._operationIdPool=0,this._currentDecorations=t.createDecorationsCollection()}dispose(){super.dispose(),this._currentDecorations.clear()}async showWhile(e,t,i,n,s){const r=this._operationIdPool++;this._currentOperation=r,this.clear(),this._showPromise.value=Rh(()=>{const a=L.fromPositions(e);this._currentDecorations.set([{range:a,options:ywe}]).length>0&&(this._currentWidget.value=this._instantiationService.createInstance(OO,this.id,this._editor,a,t,n))},s??this._showDelay);try{return await i}finally{this._currentOperation===r&&(this.clear(),this._currentOperation=void 0)}}clear(){this._showPromise.clear(),this._currentDecorations.clear(),this._currentWidget.clear()}};bL=vwe([Cwe(2,Ce)],bL);var wwe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},i8=function(o,e){return function(t,i){e(t,i,o)}},t0,ch;let no=(ch=class{static get(e){return e.getContribution(t0.ID)}constructor(e,t,i){this._openerService=i,this._messageWidget=new Yi,this._messageListeners=new $,this._mouseOverMessage=!1,this._editor=e,this._visible=t0.MESSAGE_VISIBLE.bindTo(t)}dispose(){this._message?.dispose(),this._messageListeners.dispose(),this._messageWidget.dispose(),this._visible.reset()}showMessage(e,t){ps(Ea(e)?e.value:e),this._visible.set(!0),this._messageWidget.clear(),this._messageListeners.clear(),this._message=Ea(e)?FT(e,{actionHandler:{callback:n=>{this.closeMessage(),N5(this._openerService,n,Ea(e)?e.isTrusted:void 0)},disposables:this._messageListeners}}):void 0,this._messageWidget.value=new n8(this._editor,t,typeof e=="string"?e:this._message.element),this._messageListeners.add(se.debounce(this._editor.onDidBlurEditorText,(n,s)=>s,0)(()=>{this._mouseOverMessage||this._messageWidget.value&&Ki(Ln(),this._messageWidget.value.getDomNode())||this.closeMessage()})),this._messageListeners.add(this._editor.onDidChangeCursorPosition(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidDispose(()=>this.closeMessage())),this._messageListeners.add(this._editor.onDidChangeModel(()=>this.closeMessage())),this._messageListeners.add(H(this._messageWidget.value.getDomNode(),ee.MOUSE_ENTER,()=>this._mouseOverMessage=!0,!0)),this._messageListeners.add(H(this._messageWidget.value.getDomNode(),ee.MOUSE_LEAVE,()=>this._mouseOverMessage=!1,!0));let i;this._messageListeners.add(this._editor.onMouseMove(n=>{n.target.position&&(i?i.containsPosition(n.target.position)||this.closeMessage():i=new L(t.lineNumber-3,1,n.target.position.lineNumber+3,1))}))}closeMessage(){this._visible.reset(),this._messageListeners.clear(),this._messageWidget.value&&this._messageListeners.add(n8.fadeOut(this._messageWidget.value))}},t0=ch,ch.ID="editor.contrib.messageController",ch.MESSAGE_VISIBLE=new re("messageVisible",!1,p("messageVisible","Whether the editor is currently showing an inline message")),ch);no=t0=wwe([i8(1,Ee),i8(2,Fs)],no);const Swe=Hi.bindToContribution(no.get);oe(new Swe({id:"leaveEditorMessage",precondition:no.MESSAGE_VISIBLE,handler:o=>o.closeMessage(),kbOpts:{weight:130,primary:9}}));let n8=class{static fadeOut(e){const t=()=>{e.dispose(),clearTimeout(i),e.getDomNode().removeEventListener("animationend",t)},i=setTimeout(t,110);return e.getDomNode().addEventListener("animationend",t),e.getDomNode().classList.add("fadeOut"),{dispose:t}}constructor(e,{lineNumber:t,column:i},n){this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._editor=e,this._editor.revealLinesInCenterIfOutsideViewport(t,t,0),this._position={lineNumber:t,column:i},this._domNode=document.createElement("div"),this._domNode.classList.add("monaco-editor-overlaymessage"),this._domNode.style.marginLeft="-6px";const s=document.createElement("div");s.classList.add("anchor","top"),this._domNode.appendChild(s);const r=document.createElement("div");typeof n=="string"?(r.classList.add("message"),r.textContent=n):(n.classList.add("message"),r.appendChild(n)),this._domNode.appendChild(r);const a=document.createElement("div");a.classList.add("anchor","below"),this._domNode.appendChild(a),this._editor.addContentWidget(this),this._domNode.classList.add("fadeIn")}dispose(){this._editor.removeContentWidget(this)}getId(){return"messageoverlay"}getDomNode(){return this._domNode}getPosition(){return{position:this._position,preference:[1,2],positionAffinity:1}}afterRender(e){this._domNode.classList.toggle("below",e===2)}};at(no.ID,no,4);function uN(o,e){return e&&(o.stack||o.stacktrace)?p("stackTrace.format","{0}: {1}",o8(o),s8(o.stack)||s8(o.stacktrace)):o8(o)}function s8(o){return Array.isArray(o)?o.join(`
`):o}function o8(o){return o.code==="ERR_UNC_HOST_NOT_ALLOWED"?`${o.message}. Please update the 'security.allowedUNCHosts' setting if you want to allow this host.`:typeof o.code=="string"&&typeof o.errno=="number"&&typeof o.syscall=="string"?p("nodeExceptionMessage","A system error occurred ({0})",o.message):o.message||p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}function vL(o=null,e=!1){if(!o)return p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.");if(Array.isArray(o)){const t=Vr(o),i=vL(t[0],e);return t.length>1?p("error.moreErrors","{0} ({1} errors in total)",i,t.length):i}if(Ds(o))return o;if(o.detail){const t=o.detail;if(t.error)return uN(t.error,e);if(t.exception)return uN(t.exception,e)}return o.stack?uN(o,e):o.message?o.message:p("error.defaultMessage","An unknown error occurred. Please consult the log for more details.")}var rq=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Qm=function(o,e){return function(t,i){e(t,i,o)}},FO,Tg;let BO=(Tg=class extends F{constructor(e,t,i,n,s,r,a,l,c,d){super(),this.typeId=e,this.editor=t,this.showCommand=n,this.range=s,this.edits=r,this.onSelectNewEdit=a,this._contextMenuService=l,this._keybindingService=d,this.allowEditorOverflow=!0,this.suppressMouseDown=!0,this.create(),this.visibleContext=i.bindTo(c),this.visibleContext.set(!0),this._register(ve(()=>this.visibleContext.reset())),this.editor.addContentWidget(this),this.editor.layoutContentWidget(this),this._register(ve(()=>this.editor.removeContentWidget(this))),this._register(this.editor.onDidChangeCursorPosition(h=>{s.containsPosition(h.position)||this.dispose()})),this._register(se.runAndSubscribe(d.onDidUpdateKeybindings,()=>{this._updateButtonTitle()}))}_updateButtonTitle(){const e=this._keybindingService.lookupKeybinding(this.showCommand.id)?.getLabel();this.button.element.title=this.showCommand.label+(e?` (${e})`:"")}create(){this.domNode=ie(".post-edit-widget"),this.button=this._register(new Lx(this.domNode,{supportIcons:!0})),this.button.label="$(insert)",this._register(H(this.domNode,ee.CLICK,()=>this.showSelector()))}getId(){return FO.baseId+"."+this.typeId}getDomNode(){return this.domNode}getPosition(){return{position:this.range.getEndPosition(),preference:[2]}}showSelector(){this._contextMenuService.showContextMenu({getAnchor:()=>{const e=Ci(this.button.element);return{x:e.left+e.width,y:e.top+e.height}},getActions:()=>this.edits.allEdits.map((e,t)=>ag({id:"",label:e.title,checked:t===this.edits.activeEditIndex,run:()=>{if(t!==this.edits.activeEditIndex)return this.onSelectNewEdit(t)}}))})}},FO=Tg,Tg.baseId="editor.widget.postEditWidget",Tg);BO=FO=rq([Qm(7,co),Qm(8,Ee),Qm(9,vt)],BO);let CL=class extends F{constructor(e,t,i,n,s,r,a){super(),this._id=e,this._editor=t,this._visibleContext=i,this._showCommand=n,this._instantiationService=s,this._bulkEditService=r,this._notificationService=a,this._currentWidget=this._register(new Yi),this._register(se.any(t.onDidChangeModel,t.onDidChangeModelContent)(()=>this.clear()))}async applyEditAndShowIfNeeded(e,t,i,n,s){const r=this._editor.getModel();if(!r||!e.length)return;const a=t.allEdits.at(t.activeEditIndex);if(!a)return;const l=async _=>{const b=this._editor.getModel();b&&(await b.undo(),this.applyEditAndShowIfNeeded(e,{activeEditIndex:_,allEdits:t.allEdits},i,n,s))},c=(_,b)=>{_r(_)||(this._notificationService.error(b),i&&this.show(e[0],t,l))};let d;try{d=await n(a,s)}catch(_){return c(_,p("resolveError",`Error resolving edit '{0}':
{1}`,a.title,vL(_)))}if(s.isCancellationRequested)return;const h=sq(r.uri,e,d),u=e[0],g=r.deltaDecorations([],[{range:u,options:{description:"paste-line-suffix",stickiness:0}}]);this._editor.focus();let f,m;try{f=await this._bulkEditService.apply(h,{editor:this._editor,token:s}),m=r.getDecorationRange(g[0])}catch(_){return c(_,p("applyError",`Error applying edit '{0}':
{1}`,a.title,vL(_)))}finally{r.deltaDecorations(g,[])}s.isCancellationRequested||i&&f.isApplied&&t.allEdits.length>1&&this.show(m??u,t,l)}show(e,t,i){this.clear(),this._editor.hasModel()&&(this._currentWidget.value=this._instantiationService.createInstance(BO,this._id,this._editor,this._visibleContext,this._showCommand,e,t,i))}clear(){this._currentWidget.clear()}tryShowSelector(){this._currentWidget.value?.showSelector()}};CL=rq([Qm(4,Ce),Qm(5,Pw),Qm(6,Ei)],CL);var xwe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Sp=function(o,e){return function(t,i){e(t,i,o)}},Du;const aq="editor.changePasteType",gW=new re("pasteWidgetVisible",!1,p("pasteWidgetVisible","Whether the paste widget is showing")),gN="application/vnd.code.copyMetadata";var Dg;let Qc=(Dg=class extends F{static get(e){return e.getContribution(Du.ID)}constructor(e,t,i,n,s,r,a){super(),this._bulkEditService=i,this._clipboardService=n,this._languageFeaturesService=s,this._quickInputService=r,this._progressService=a,this._editor=e;const l=e.getContainerDomNode();this._register(H(l,"copy",c=>this.handleCopy(c))),this._register(H(l,"cut",c=>this.handleCopy(c))),this._register(H(l,"paste",c=>this.handlePaste(c),!0)),this._pasteProgressManager=this._register(new bL("pasteIntoEditor",e,t)),this._postPasteWidgetManager=this._register(t.createInstance(CL,"pasteIntoEditor",e,gW,{id:aq,label:p("postPasteWidgetTitle","Show paste options...")}))}changePasteType(){this._postPasteWidgetManager.tryShowSelector()}pasteAs(e){this._editor.focus();try{this._pasteAsActionContext={preferred:e},nb().execCommand("paste")}finally{this._pasteAsActionContext=void 0}}clearWidgets(){this._postPasteWidgetManager.clear()}isPasteAsEnabled(){return this._editor.getOption(85).enabled}async finishedPaste(){await this._currentPasteOperation}handleCopy(e){if(!this._editor.hasTextFocus()||(this._clipboardService.clearInternalState?.(),!e.clipboardData||!this.isPasteAsEnabled()))return;const t=this._editor.getModel(),i=this._editor.getSelections();if(!t||!i?.length)return;const n=this._editor.getOption(37);let s=i;const r=i.length===1&&i[0].isEmpty();if(r){if(!n)return;s=[new L(s[0].startLineNumber,1,s[0].startLineNumber,1+t.getLineLength(s[0].startLineNumber))]}const a=this._editor._getViewModel()?.getPlainTextToCopy(i,n,En),c={multicursorText:Array.isArray(a)?a:null,pasteOnNewLine:r,mode:null},d=this._languageFeaturesService.documentPasteEditProvider.ordered(t).filter(m=>!!m.prepareDocumentPaste);if(!d.length){this.setCopyMetadata(e.clipboardData,{defaultPastePayload:c});return}const h=Jj(e.clipboardData),u=d.flatMap(m=>m.copyMimeTypes??[]),g=mD();this.setCopyMetadata(e.clipboardData,{id:g,providerCopyMimeTypes:u,defaultPastePayload:c});const f=ji(async m=>{const _=Vr(await Promise.all(d.map(async b=>{try{return await b.prepareDocumentPaste(t,s,h,m)}catch(v){console.error(v);return}})));_.reverse();for(const b of _)for(const[v,y]of b)h.replace(v,y);return h});Du._currentCopyOperation?.dataTransferPromise.cancel(),Du._currentCopyOperation={handle:g,dataTransferPromise:f}}async handlePaste(e){if(!e.clipboardData||!this._editor.hasTextFocus())return;no.get(this._editor)?.closeMessage(),this._currentPasteOperation?.cancel(),this._currentPasteOperation=void 0;const t=this._editor.getModel(),i=this._editor.getSelections();if(!i?.length||!t||this._editor.getOption(92)||!this.isPasteAsEnabled()&&!this._pasteAsActionContext)return;const n=this.fetchCopyMetadata(e),s=eq(e.clipboardData);s.delete(gN);const r=[...e.clipboardData.types,...n?.providerCopyMimeTypes??[],vi.uriList],a=this._languageFeaturesService.documentPasteEditProvider.ordered(t).filter(l=>{const c=this._pasteAsActionContext?.preferred;return c&&l.providedPasteEditKinds&&!this.providerMatchesPreference(l,c)?!1:l.pasteMimeTypes?.some(d=>Xj(d,r))});if(!a.length){this._pasteAsActionContext?.preferred&&this.showPasteAsNoEditMessage(i,this._pasteAsActionContext.preferred);return}e.preventDefault(),e.stopImmediatePropagation(),this._pasteAsActionContext?this.showPasteAsPick(this._pasteAsActionContext.preferred,a,i,s,n):this.doPasteInline(a,i,s,n,e)}showPasteAsNoEditMessage(e,t){no.get(this._editor)?.showMessage(p("pasteAsError","No paste edits for '{0}' found",t instanceof Jt?t.value:t.providerId),e[0].getStartPosition())}doPasteInline(e,t,i,n,s){const r=this._editor;if(!r.hasModel())return;const a=new zh(r,3,void 0),l=ji(async c=>{const d=this._editor;if(!d.hasModel())return;const h=d.getModel(),u=new $,g=u.add(new ri(c));u.add(a.token.onCancellationRequested(()=>g.cancel()));const f=g.token;try{if(await this.mergeInDataFromCopy(i,n,f),f.isCancellationRequested)return;const m=e.filter(v=>this.isSupportedPasteProvider(v,i));if(!m.length||m.length===1&&m[0]instanceof Rf)return this.applyDefaultPasteHandler(i,n,f,s);const _={triggerKind:$C.Automatic},b=await this.getPasteEdits(m,i,h,t,_,f);if(u.add(b),f.isCancellationRequested)return;if(b.edits.length===1&&b.edits[0].provider instanceof Rf)return this.applyDefaultPasteHandler(i,n,f,s);if(b.edits.length){const v=d.getOption(85).showPasteSelector==="afterPaste";return this._postPasteWidgetManager.applyEditAndShowIfNeeded(t,{activeEditIndex:0,allEdits:b.edits},v,(y,C)=>new Promise((w,x)=>{(async()=>{try{const k=y.provider.resolveDocumentPasteEdit?.(y,C),E=new ib,N=k&&await this._pasteProgressManager.showWhile(t[0].getEndPosition(),p("resolveProcess","Resolving paste edit. Click to cancel"),Promise.race([E.p,k]),{cancel:()=>(E.cancel(),x(new Hr))},0);return N&&(y.additionalEdit=N.additionalEdit),w(y)}catch(k){return x(k)}})()}),f)}await this.applyDefaultPasteHandler(i,n,f,s)}finally{u.dispose(),this._currentPasteOperation===l&&(this._currentPasteOperation=void 0)}});this._pasteProgressManager.showWhile(t[0].getEndPosition(),p("pasteIntoEditorProgress","Running paste handlers. Click to cancel and do basic paste"),l,{cancel:async()=>{try{if(l.cancel(),a.token.isCancellationRequested)return;await this.applyDefaultPasteHandler(i,n,a.token,s)}finally{a.dispose()}}}).then(()=>{a.dispose()}),this._currentPasteOperation=l}showPasteAsPick(e,t,i,n,s){const r=ji(async a=>{const l=this._editor;if(!l.hasModel())return;const c=l.getModel(),d=new $,h=d.add(new zh(l,3,void 0,a));try{if(await this.mergeInDataFromCopy(n,s,h.token),h.token.isCancellationRequested)return;let u=t.filter(b=>this.isSupportedPasteProvider(b,n,e));e&&(u=u.filter(b=>this.providerMatchesPreference(b,e)));const g={triggerKind:$C.PasteAs,only:e&&e instanceof Jt?e:void 0};let f=d.add(await this.getPasteEdits(u,n,c,i,g,h.token));if(h.token.isCancellationRequested)return;if(e&&(f={edits:f.edits.filter(b=>e instanceof Jt?e.contains(b.kind):e.providerId===b.provider.id),dispose:f.dispose}),!f.edits.length){g.only&&this.showPasteAsNoEditMessage(i,g.only);return}let m;if(e?m=f.edits.at(0):m=(await this._quickInputService.pick(f.edits.map(v=>({label:v.title,description:v.kind?.value,edit:v})),{placeHolder:p("pasteAsPickerPlaceholder","Select Paste Action")}))?.edit,!m)return;const _=sq(c.uri,i,m);await this._bulkEditService.apply(_,{editor:this._editor})}finally{d.dispose(),this._currentPasteOperation===r&&(this._currentPasteOperation=void 0)}});this._progressService.withProgress({location:10,title:p("pasteAsProgress","Running paste handlers")},()=>r)}setCopyMetadata(e,t){e.setData(gN,JSON.stringify(t))}fetchCopyMetadata(e){if(!e.clipboardData)return;const t=e.clipboardData.getData(gN);if(t)try{return JSON.parse(t)}catch{return}const[i,n]=$M.getTextData(e.clipboardData);if(n)return{defaultPastePayload:{mode:n.mode,multicursorText:n.multicursorText??null,pasteOnNewLine:!!n.isFromEmptySelection}}}async mergeInDataFromCopy(e,t,i){if(t?.id&&Du._currentCopyOperation?.handle===t.id){const n=await Du._currentCopyOperation.dataTransferPromise;if(i.isCancellationRequested)return;for(const[s,r]of n)e.replace(s,r)}if(!e.has(vi.uriList)){const n=await this._clipboardService.readResources();if(i.isCancellationRequested)return;n.length&&e.append(vi.uriList,cW(_D.create(n)))}}async getPasteEdits(e,t,i,n,s,r){const a=new $,l=await Lw(Promise.all(e.map(async d=>{try{const h=await d.provideDocumentPasteEdits?.(i,n,t,s,r);return h&&a.add(h),h?.edits?.map(u=>({...u,provider:d}))}catch(h){_r(h)||console.error(h);return}})),r),c=Vr(l??[]).flat().filter(d=>!s.only||s.only.contains(d.kind));return{edits:oq(c),dispose:()=>a.dispose()}}async applyDefaultPasteHandler(e,t,i,n){const r=await(e.get(vi.text)??e.get("text"))?.asString()??"";if(i.isCancellationRequested)return;const a={clipboardEvent:n,text:r,pasteOnNewLine:t?.defaultPastePayload.pasteOnNewLine??!1,multicursorText:t?.defaultPastePayload.multicursorText??null,mode:null};this._editor.trigger("keyboard","paste",a)}isSupportedPasteProvider(e,t,i){return e.pasteMimeTypes?.some(n=>t.matches(n))?!i||this.providerMatchesPreference(e,i):!1}providerMatchesPreference(e,t){return t instanceof Jt?e.providedPasteEditKinds?e.providedPasteEditKinds.some(i=>t.contains(i)):!0:e.id===t.providerId}},Du=Dg,Dg.ID="editor.contrib.copyPasteActionController",Dg);Qc=Du=xwe([Sp(1,Ce),Sp(2,Pw),Sp(3,ad),Sp(4,ue),Sp(5,vr),Sp(6,WG)],Qc);const Af="9_cutcopypaste",Lwe=El||document.queryCommandSupported("cut"),lq=El||document.queryCommandSupported("copy"),kwe=typeof navigator.clipboard>"u"||dr?document.queryCommandSupported("paste"):!0;function fW(o){return o.register(),o}const Ewe=Lwe?fW(new ob({id:"editor.action.clipboardCutAction",precondition:void 0,kbOpts:El?{primary:2102,win:{primary:2102,secondary:[1044]},weight:100}:void 0,menuOpts:[{menuId:fe.MenubarEditMenu,group:"2_ccp",title:p({key:"miCut",comment:["&& denotes a mnemonic"]},"Cu&&t"),order:1},{menuId:fe.EditorContext,group:Af,title:p("actions.clipboard.cutLabel","Cut"),when:T.writable,order:1},{menuId:fe.CommandPalette,group:"",title:p("actions.clipboard.cutLabel","Cut"),order:1},{menuId:fe.SimpleEditorContext,group:Af,title:p("actions.clipboard.cutLabel","Cut"),when:T.writable,order:1}]})):void 0,Twe=lq?fW(new ob({id:"editor.action.clipboardCopyAction",precondition:void 0,kbOpts:El?{primary:2081,win:{primary:2081,secondary:[2067]},weight:100}:void 0,menuOpts:[{menuId:fe.MenubarEditMenu,group:"2_ccp",title:p({key:"miCopy",comment:["&& denotes a mnemonic"]},"&&Copy"),order:2},{menuId:fe.EditorContext,group:Af,title:p("actions.clipboard.copyLabel","Copy"),order:2},{menuId:fe.CommandPalette,group:"",title:p("actions.clipboard.copyLabel","Copy"),order:1},{menuId:fe.SimpleEditorContext,group:Af,title:p("actions.clipboard.copyLabel","Copy"),order:2}]})):void 0;sn.appendMenuItem(fe.MenubarEditMenu,{submenu:fe.MenubarCopy,title:De("copy as","Copy As"),group:"2_ccp",order:3});sn.appendMenuItem(fe.EditorContext,{submenu:fe.EditorContextCopy,title:De("copy as","Copy As"),group:Af,order:3});sn.appendMenuItem(fe.EditorContext,{submenu:fe.EditorContextShare,title:De("share","Share"),group:"11_share",order:-1,when:K.and(K.notEquals("resourceScheme","output"),T.editorTextFocus)});sn.appendMenuItem(fe.ExplorerContext,{submenu:fe.ExplorerContextShare,title:De("share","Share"),group:"11_share",order:-1});const fN=kwe?fW(new ob({id:"editor.action.clipboardPasteAction",precondition:void 0,kbOpts:El?{primary:2100,win:{primary:2100,secondary:[1043]},linux:{primary:2100,secondary:[1043]},weight:100}:void 0,menuOpts:[{menuId:fe.MenubarEditMenu,group:"2_ccp",title:p({key:"miPaste",comment:["&& denotes a mnemonic"]},"&&Paste"),order:4},{menuId:fe.EditorContext,group:Af,title:p("actions.clipboard.pasteLabel","Paste"),when:T.writable,order:4},{menuId:fe.CommandPalette,group:"",title:p("actions.clipboard.pasteLabel","Paste"),order:1},{menuId:fe.SimpleEditorContext,group:Af,title:p("actions.clipboard.pasteLabel","Paste"),when:T.writable,order:4}]})):void 0;class Dwe extends de{constructor(){super({id:"editor.action.clipboardCopyWithSyntaxHighlightingAction",label:p("actions.clipboard.copyWithSyntaxHighlightingLabel","Copy With Syntax Highlighting"),alias:"Copy With Syntax Highlighting",precondition:void 0,kbOpts:{kbExpr:T.textInputFocus,primary:0,weight:100}})}run(e,t){!t.hasModel()||!t.getOption(37)&&t.getSelection().isEmpty()||(UM.forceCopyWithSyntaxHighlighting=!0,t.focus(),t.getContainerDomNode().ownerDocument.execCommand("copy"),UM.forceCopyWithSyntaxHighlighting=!1)}}function cq(o,e){o&&(o.addImplementation(1e4,"code-editor",(t,i)=>{const n=t.get(gt).getFocusedCodeEditor();if(n&&n.hasTextFocus()){const s=n.getOption(37),r=n.getSelection();return r&&r.isEmpty()&&!s||n.getContainerDomNode().ownerDocument.execCommand(e),!0}return!1}),o.addImplementation(0,"generic-dom",(t,i)=>(nb().execCommand(e),!0)))}cq(Ewe,"cut");cq(Twe,"copy");fN&&(fN.addImplementation(1e4,"code-editor",(o,e)=>{const t=o.get(gt),i=o.get(ad),n=t.getFocusedCodeEditor();return n&&n.hasTextFocus()?n.getContainerDomNode().ownerDocument.execCommand("paste")?Qc.get(n)?.finishedPaste()??Promise.resolve():Uf?(async()=>{const r=await i.readText();if(r!==""){const a=Ay.INSTANCE.get(r);let l=!1,c=null,d=null;a&&(l=n.getOption(37)&&!!a.isFromEmptySelection,c=typeof a.multicursorText<"u"?a.multicursorText:null,d=a.mode),n.trigger("keyboard","paste",{text:r,pasteOnNewLine:l,multicursorText:c,mode:d})}})():!0:!1}),fN.addImplementation(0,"generic-dom",(o,e)=>(nb().execCommand("paste"),!0)));lq&&X(Dwe);const jt=new class{constructor(){this.QuickFix=new Jt("quickfix"),this.Refactor=new Jt("refactor"),this.RefactorExtract=this.Refactor.append("extract"),this.RefactorInline=this.Refactor.append("inline"),this.RefactorMove=this.Refactor.append("move"),this.RefactorRewrite=this.Refactor.append("rewrite"),this.Notebook=new Jt("notebook"),this.Source=new Jt("source"),this.SourceOrganizeImports=this.Source.append("organizeImports"),this.SourceFixAll=this.Source.append("fixAll"),this.SurroundWith=this.Refactor.append("surround")}};var lo;(function(o){o.Refactor="refactor",o.RefactorPreview="refactor preview",o.Lightbulb="lightbulb",o.Default="other (default)",o.SourceAction="source action",o.QuickFix="quick fix action",o.FixAll="fix all",o.OrganizeImports="organize imports",o.AutoFix="auto fix",o.QuickFixHover="quick fix hover window",o.OnSave="save participants",o.ProblemsView="problems view"})(lo||(lo={}));function Iwe(o,e){return!(o.include&&!o.include.intersects(e)||o.excludes&&o.excludes.some(t=>dq(e,t,o.include))||!o.includeSourceActions&&jt.Source.contains(e))}function Nwe(o,e){const t=e.kind?new Jt(e.kind):void 0;return!(o.include&&(!t||!o.include.contains(t))||o.excludes&&t&&o.excludes.some(i=>dq(t,i,o.include))||!o.includeSourceActions&&t&&jt.Source.contains(t)||o.onlyIncludePreferredActions&&!e.isPreferred)}function dq(o,e,t){return!(!e.contains(o)||t&&e.contains(t))}class _l{static fromUser(e,t){return!e||typeof e!="object"?new _l(t.kind,t.apply,!1):new _l(_l.getKindFromUser(e,t.kind),_l.getApplyFromUser(e,t.apply),_l.getPreferredUser(e))}static getApplyFromUser(e,t){switch(typeof e.apply=="string"?e.apply.toLowerCase():""){case"first":return"first";case"never":return"never";case"ifsingle":return"ifSingle";default:return t}}static getKindFromUser(e,t){return typeof e.kind=="string"?new Jt(e.kind):t}static getPreferredUser(e){return typeof e.preferred=="boolean"?e.preferred:!1}constructor(e,t,i){this.kind=e,this.apply=t,this.preferred=i}}class Rwe{constructor(e,t,i){this.action=e,this.provider=t,this.highlightRange=i}async resolve(e){if(this.provider?.resolveCodeAction&&!this.action.edit){let t;try{t=await this.provider.resolveCodeAction(this.action,e)}catch(i){yi(i)}t&&(this.action.edit=t.edit)}return this}}const hq="editor.action.codeAction",pW="editor.action.quickFix",uq="editor.action.autoFix",gq="editor.action.refactor",fq="editor.action.sourceAction",WO="editor.action.organizeImports",VO="editor.action.fixAll";class cC extends F{static codeActionsPreferredComparator(e,t){return e.isPreferred&&!t.isPreferred?-1:!e.isPreferred&&t.isPreferred?1:0}static codeActionsComparator({action:e},{action:t}){return e.isAI&&!t.isAI?1:!e.isAI&&t.isAI?-1:Yn(e.diagnostics)?Yn(t.diagnostics)?cC.codeActionsPreferredComparator(e,t):-1:Yn(t.diagnostics)?1:cC.codeActionsPreferredComparator(e,t)}constructor(e,t,i){super(),this.documentation=t,this._register(i),this.allActions=[...e].sort(cC.codeActionsComparator),this.validActions=this.allActions.filter(({action:n})=>!n.disabled)}get hasAutoFix(){return this.validActions.some(({action:e})=>!!e.kind&&jt.QuickFix.contains(new Jt(e.kind))&&!!e.isPreferred)}get hasAIFix(){return this.validActions.some(({action:e})=>!!e.isAI)}get allAIFixes(){return this.validActions.every(({action:e})=>!!e.isAI)}}const r8={actions:[],documentation:void 0};async function rm(o,e,t,i,n,s){const r=i.filter||{},a={...r,excludes:[...r.excludes||[],jt.Notebook]},l={only:r.include?.value,trigger:i.type},c=new nW(e,s),d=i.type===2,h=Pwe(o,e,d?a:r),u=new $,g=h.map(async m=>{try{n.report(m);const _=await m.provideCodeActions(e,t,l,c.token);if(_&&u.add(_),c.token.isCancellationRequested)return r8;const b=(_?.actions||[]).filter(y=>y&&Nwe(r,y)),v=Mwe(m,b,r.include);return{actions:b.map(y=>new Rwe(y,m)),documentation:v}}catch(_){if(_r(_))throw _;return yi(_),r8}}),f=o.onDidChange(()=>{const m=o.all(e);ei(m,h)||c.cancel()});try{const m=await Promise.all(g),_=m.map(v=>v.actions).flat(),b=[...Vr(m.map(v=>v.documentation)),...Awe(o,e,i,_)];return new cC(_,b,u)}finally{f.dispose(),c.dispose()}}function Pwe(o,e,t){return o.all(e).filter(i=>i.providedCodeActionKinds?i.providedCodeActionKinds.some(n=>Iwe(t,new Jt(n))):!0)}function*Awe(o,e,t,i){if(e&&i.length)for(const n of o.all(e))n._getAdditionalMenuItems&&(yield*n._getAdditionalMenuItems?.({trigger:t.type,only:t.filter?.include?.value},i.map(s=>s.action)))}function Mwe(o,e,t){if(!o.documentation)return;const i=o.documentation.map(n=>({kind:new Jt(n.kind),command:n.command}));if(t){let n;for(const s of i)s.kind.contains(t)&&(n?n.kind.contains(s.kind)&&(n=s):n=s);if(n)return n?.command}for(const n of e)if(n.kind){for(const s of i)if(s.kind.contains(new Jt(n.kind)))return s.command}}var ng;(function(o){o.OnSave="onSave",o.FromProblemsView="fromProblemsView",o.FromCodeActions="fromCodeActions",o.FromAILightbulb="fromAILightbulb"})(ng||(ng={}));async function Owe(o,e,t,i,n=He.None){const s=o.get(Pw),r=o.get(Ft),a=o.get(Fn),l=o.get(Ei);if(a.publicLog2("codeAction.applyCodeAction",{codeActionTitle:e.action.title,codeActionKind:e.action.kind,codeActionIsPreferred:!!e.action.isPreferred,reason:t}),await e.resolve(n),!n.isCancellationRequested&&!(e.action.edit?.edits.length&&!(await s.apply(e.action.edit,{editor:i?.editor,label:e.action.title,quotableLabel:e.action.title,code:"undoredo.codeAction",respectAutoSaveConfig:t!==ng.OnSave,showPreview:i?.preview})).isApplied)&&e.action.command)try{await r.executeCommand(e.action.command.id,...e.action.command.arguments||[])}catch(c){const d=Fwe(c);l.error(typeof d=="string"?d:p("applyCodeActionFailed","An unknown error occurred while applying the code action"))}}function Fwe(o){return typeof o=="string"?o:o instanceof Error&&typeof o.message=="string"?o.message:void 0}st.registerCommand("_executeCodeActionProvider",async function(o,e,t,i,n){if(!(e instanceof ye))throw ar();const{codeActionProvider:s}=o.get(ue),r=o.get(Ut).getModel(e);if(!r)throw ar();const a=pe.isISelection(t)?pe.liftSelection(t):L.isIRange(t)?r.validateRange(t):void 0;if(!a)throw ar();const l=typeof i=="string"?new Jt(i):void 0,c=await rm(s,r,a,{type:1,triggerAction:lo.Default,filter:{includeSourceActions:!0,include:l}},va.None,He.None),d=[],h=Math.min(c.validActions.length,typeof n=="number"?n:0);for(let u=0;u<h;u++)d.push(c.validActions[u].resolve(He.None));try{return await Promise.all(d),c.validActions.map(u=>u.action)}finally{setTimeout(()=>c.dispose(),100)}});var Bwe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Wwe=function(o,e){return function(t,i){e(t,i,o)}},HO,Ig;let zO=(Ig=class{constructor(e){this.keybindingService=e}getResolver(){const e=new Da(()=>this.keybindingService.getKeybindings().filter(t=>HO.codeActionCommands.indexOf(t.command)>=0).filter(t=>t.resolvedKeybinding).map(t=>{let i=t.commandArgs;return t.command===WO?i={kind:jt.SourceOrganizeImports.value}:t.command===VO&&(i={kind:jt.SourceFixAll.value}),{resolvedKeybinding:t.resolvedKeybinding,..._l.fromUser(i,{kind:Jt.None,apply:"never"})}}));return t=>{if(t.kind)return this.bestKeybindingForCodeAction(t,e.value)?.resolvedKeybinding}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new Jt(e.kind);return t.filter(n=>n.kind.contains(i)).filter(n=>n.preferred?e.isPreferred:!0).reduceRight((n,s)=>n?n.kind.contains(s.kind)?s:n:s,void 0)}},HO=Ig,Ig.codeActionCommands=[gq,hq,fq,WO,VO],Ig);zO=HO=Bwe([Wwe(0,vt)],zO);D("symbolIcon.arrayForeground",qe,p("symbolIcon.arrayForeground","The foreground color for array symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.booleanForeground",qe,p("symbolIcon.booleanForeground","The foreground color for boolean symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.classForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},p("symbolIcon.classForeground","The foreground color for class symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.colorForeground",qe,p("symbolIcon.colorForeground","The foreground color for color symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.constantForeground",qe,p("symbolIcon.constantForeground","The foreground color for constant symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.constructorForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("symbolIcon.constructorForeground","The foreground color for constructor symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.enumeratorForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},p("symbolIcon.enumeratorForeground","The foreground color for enumerator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.enumeratorMemberForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.enumeratorMemberForeground","The foreground color for enumerator member symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.eventForeground",{dark:"#EE9D28",light:"#D67E00",hcDark:"#EE9D28",hcLight:"#D67E00"},p("symbolIcon.eventForeground","The foreground color for event symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.fieldForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.fieldForeground","The foreground color for field symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.fileForeground",qe,p("symbolIcon.fileForeground","The foreground color for file symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.folderForeground",qe,p("symbolIcon.folderForeground","The foreground color for folder symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.functionForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("symbolIcon.functionForeground","The foreground color for function symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.interfaceForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.interfaceForeground","The foreground color for interface symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.keyForeground",qe,p("symbolIcon.keyForeground","The foreground color for key symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.keywordForeground",qe,p("symbolIcon.keywordForeground","The foreground color for keyword symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.methodForeground",{dark:"#B180D7",light:"#652D90",hcDark:"#B180D7",hcLight:"#652D90"},p("symbolIcon.methodForeground","The foreground color for method symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.moduleForeground",qe,p("symbolIcon.moduleForeground","The foreground color for module symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.namespaceForeground",qe,p("symbolIcon.namespaceForeground","The foreground color for namespace symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.nullForeground",qe,p("symbolIcon.nullForeground","The foreground color for null symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.numberForeground",qe,p("symbolIcon.numberForeground","The foreground color for number symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.objectForeground",qe,p("symbolIcon.objectForeground","The foreground color for object symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.operatorForeground",qe,p("symbolIcon.operatorForeground","The foreground color for operator symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.packageForeground",qe,p("symbolIcon.packageForeground","The foreground color for package symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.propertyForeground",qe,p("symbolIcon.propertyForeground","The foreground color for property symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.referenceForeground",qe,p("symbolIcon.referenceForeground","The foreground color for reference symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.snippetForeground",qe,p("symbolIcon.snippetForeground","The foreground color for snippet symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.stringForeground",qe,p("symbolIcon.stringForeground","The foreground color for string symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.structForeground",qe,p("symbolIcon.structForeground","The foreground color for struct symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.textForeground",qe,p("symbolIcon.textForeground","The foreground color for text symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.typeParameterForeground",qe,p("symbolIcon.typeParameterForeground","The foreground color for type parameter symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.unitForeground",qe,p("symbolIcon.unitForeground","The foreground color for unit symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));D("symbolIcon.variableForeground",{dark:"#75BEFF",light:"#007ACC",hcDark:"#75BEFF",hcLight:"#007ACC"},p("symbolIcon.variableForeground","The foreground color for variable symbols. These symbols appear in the outline, breadcrumb, and suggest widget."));const pq=Object.freeze({kind:Jt.Empty,title:p("codeAction.widget.id.more","More Actions...")}),Vwe=Object.freeze([{kind:jt.QuickFix,title:p("codeAction.widget.id.quickfix","Quick Fix")},{kind:jt.RefactorExtract,title:p("codeAction.widget.id.extract","Extract"),icon:J.wrench},{kind:jt.RefactorInline,title:p("codeAction.widget.id.inline","Inline"),icon:J.wrench},{kind:jt.RefactorRewrite,title:p("codeAction.widget.id.convert","Rewrite"),icon:J.wrench},{kind:jt.RefactorMove,title:p("codeAction.widget.id.move","Move"),icon:J.wrench},{kind:jt.SurroundWith,title:p("codeAction.widget.id.surround","Surround With"),icon:J.surroundWith},{kind:jt.Source,title:p("codeAction.widget.id.source","Source Action"),icon:J.symbolFile},pq]);function Hwe(o,e,t){if(!e)return o.map(s=>({kind:"action",item:s,group:pq,disabled:!!s.action.disabled,label:s.action.disabled||s.action.title,canPreview:!!s.action.edit?.edits.length}));const i=Vwe.map(s=>({group:s,actions:[]}));for(const s of o){const r=s.action.kind?new Jt(s.action.kind):Jt.None;for(const a of i)if(a.group.kind.contains(r)){a.actions.push(s);break}}const n=[];for(const s of i)if(s.actions.length){n.push({kind:"header",group:s.group});for(const r of s.actions){const a=s.group;n.push({kind:"action",item:r,group:r.action.isAI?{title:a.title,kind:a.kind,icon:J.sparkle}:a,label:r.action.title,disabled:!!r.action.disabled,keybinding:t(r.action)})}}return n}var zwe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Uwe=function(o,e){return function(t,i){e(t,i,o)}},Fp;const a8=Gt("gutter-lightbulb",J.lightBulb,p("gutterLightbulbWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor.")),l8=Gt("gutter-lightbulb-auto-fix",J.lightbulbAutofix,p("gutterLightbulbAutoFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and a quick fix is available.")),c8=Gt("gutter-lightbulb-sparkle",J.lightbulbSparkle,p("gutterLightbulbAIFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix is available.")),d8=Gt("gutter-lightbulb-aifix-auto-fix",J.lightbulbSparkleAutofix,p("gutterLightbulbAIFixAutoFixWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available.")),h8=Gt("gutter-lightbulb-sparkle-filled",J.sparkleFilled,p("gutterLightbulbSparkleFilledWidget","Icon which spawns code actions menu from the gutter when there is no space in the editor and an AI fix and a quick fix is available."));var oa;(function(o){o.Hidden={type:0};class e{constructor(i,n,s,r){this.actions=i,this.trigger=n,this.editorPosition=s,this.widgetPosition=r,this.type=1}}o.Showing=e})(oa||(oa={}));var Mc;let qy=(Mc=class extends F{constructor(e,t){super(),this._editor=e,this._keybindingService=t,this._onClick=this._register(new O),this.onClick=this._onClick.event,this._state=oa.Hidden,this._gutterState=oa.Hidden,this._iconClasses=[],this.lightbulbClasses=["codicon-"+a8.id,"codicon-"+d8.id,"codicon-"+l8.id,"codicon-"+c8.id,"codicon-"+h8.id],this.gutterDecoration=Fp.GUTTER_DECORATION,this._domNode=ie("div.lightBulbWidget"),this._domNode.role="listbox",this._register(Mn.ignoreTarget(this._domNode)),this._editor.addContentWidget(this),this._register(this._editor.onDidChangeModelContent(i=>{const n=this._editor.getModel();(this.state.type!==1||!n||this.state.editorPosition.lineNumber>=n.getLineCount())&&this.hide(),(this.gutterState.type!==1||!n||this.gutterState.editorPosition.lineNumber>=n.getLineCount())&&this.gutterHide()})),this._register(KJ(this._domNode,i=>{if(this.state.type!==1)return;this._editor.focus(),i.preventDefault();const{top:n,height:s}=Ci(this._domNode),r=this._editor.getOption(67);let a=Math.floor(r/3);this.state.widgetPosition.position!==null&&this.state.widgetPosition.position.lineNumber<this.state.editorPosition.lineNumber&&(a+=r),this._onClick.fire({x:i.posx,y:n+s+a,actions:this.state.actions,trigger:this.state.trigger})})),this._register(H(this._domNode,"mouseenter",i=>{(i.buttons&1)===1&&this.hide()})),this._register(se.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings,()=>{this._preferredKbLabel=this._keybindingService.lookupKeybinding(uq)?.getLabel()??void 0,this._quickFixKbLabel=this._keybindingService.lookupKeybinding(pW)?.getLabel()??void 0,this._updateLightBulbTitleAndIcon()})),this._register(this._editor.onMouseDown(async i=>{if(!i.target.element||!this.lightbulbClasses.some(l=>i.target.element&&i.target.element.classList.contains(l))||this.gutterState.type!==1)return;this._editor.focus();const{top:n,height:s}=Ci(i.target.element),r=this._editor.getOption(67);let a=Math.floor(r/3);this.gutterState.widgetPosition.position!==null&&this.gutterState.widgetPosition.position.lineNumber<this.gutterState.editorPosition.lineNumber&&(a+=r),this._onClick.fire({x:i.event.posx,y:n+s+a,actions:this.gutterState.actions,trigger:this.gutterState.trigger})}))}dispose(){super.dispose(),this._editor.removeContentWidget(this),this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID)}getId(){return"LightBulbWidget"}getDomNode(){return this._domNode}getPosition(){return this._state.type===1?this._state.widgetPosition:null}update(e,t,i){if(e.validActions.length<=0)return this.gutterHide(),this.hide();if(!this._editor.hasTextFocus())return this.gutterHide(),this.hide();if(!this._editor.getOptions().get(65).enabled)return this.gutterHide(),this.hide();const r=this._editor.getModel();if(!r)return this.gutterHide(),this.hide();const{lineNumber:a,column:l}=r.validatePosition(i),c=r.getOptions().tabSize,d=this._editor.getOptions().get(50),h=r.getLineContent(a),u=jT(h,c),g=d.spaceWidth*u>22,f=w=>w>2&&this._editor.getTopForLineNumber(w)===this._editor.getTopForLineNumber(w-1),m=this._editor.getLineDecorations(a);let _=!1;if(m)for(const w of m){const x=w.options.glyphMarginClassName;if(x&&!this.lightbulbClasses.some(k=>x.includes(k))){_=!0;break}}let b=a,v=1;if(!g){const w=x=>{const k=r.getLineContent(x);return/^\s*$|^\s+/.test(k)||k.length<=v};if(a>1&&!f(a-1)){const x=r.getLineCount(),k=a===x,E=a>1&&w(a-1),N=!k&&w(a+1),z=w(a),B=!N&&!E;if(!N&&!E&&!_)return this.gutterState=new oa.Showing(e,t,i,{position:{lineNumber:b,column:v},preference:Fp._posPref}),this.renderGutterLightbub(),this.hide();E||k||E&&!z?b-=1:(N||B&&z)&&(b+=1)}else if(a===1&&(a===r.getLineCount()||!w(a+1)&&!w(a)))if(this.gutterState=new oa.Showing(e,t,i,{position:{lineNumber:b,column:v},preference:Fp._posPref}),_)this.gutterHide();else return this.renderGutterLightbub(),this.hide();else if(a<r.getLineCount()&&!f(a+1))b+=1;else if(l*d.spaceWidth<22)return this.hide();v=/^\S\s*$/.test(r.getLineContent(b))?2:1}this.state=new oa.Showing(e,t,i,{position:{lineNumber:b,column:v},preference:Fp._posPref}),this._gutterDecorationID&&(this._removeGutterDecoration(this._gutterDecorationID),this.gutterHide());const y=e.validActions,C=e.validActions[0].action.kind;if(y.length!==1||!C){this._editor.layoutContentWidget(this);return}this._editor.layoutContentWidget(this)}hide(){this.state!==oa.Hidden&&(this.state=oa.Hidden,this._editor.layoutContentWidget(this))}gutterHide(){this.gutterState!==oa.Hidden&&(this._gutterDecorationID&&this._removeGutterDecoration(this._gutterDecorationID),this.gutterState=oa.Hidden)}get state(){return this._state}set state(e){this._state=e,this._updateLightBulbTitleAndIcon()}get gutterState(){return this._gutterState}set gutterState(e){this._gutterState=e,this._updateGutterLightBulbTitleAndIcon()}_updateLightBulbTitleAndIcon(){if(this._domNode.classList.remove(...this._iconClasses),this._iconClasses=[],this.state.type!==1)return;let e,t=!1;this.state.actions.allAIFixes?(e=J.sparkleFilled,this.state.actions.validActions.length===1&&(t=!0)):this.state.actions.hasAutoFix?this.state.actions.hasAIFix?e=J.lightbulbSparkleAutofix:e=J.lightbulbAutofix:this.state.actions.hasAIFix?e=J.lightbulbSparkle:e=J.lightBulb,this._updateLightbulbTitle(this.state.actions.hasAutoFix,t),this._iconClasses=ke.asClassNameArray(e),this._domNode.classList.add(...this._iconClasses)}_updateGutterLightBulbTitleAndIcon(){if(this.gutterState.type!==1)return;let e,t=!1;this.gutterState.actions.allAIFixes?(e=h8,this.gutterState.actions.validActions.length===1&&(t=!0)):this.gutterState.actions.hasAutoFix?this.gutterState.actions.hasAIFix?e=d8:e=l8:this.gutterState.actions.hasAIFix?e=c8:e=a8,this._updateLightbulbTitle(this.gutterState.actions.hasAutoFix,t);const i=Fe.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:ke.asClassName(e),glyphMargin:{position:Ur.Left},stickiness:1});this.gutterDecoration=i}renderGutterLightbub(){const e=this._editor.getSelection();e&&(this._gutterDecorationID===void 0?this._addGutterDecoration(e.startLineNumber):this._updateGutterDecoration(this._gutterDecorationID,e.startLineNumber))}_addGutterDecoration(e){this._editor.changeDecorations(t=>{this._gutterDecorationID=t.addDecoration(new L(e,0,e,0),this.gutterDecoration)})}_removeGutterDecoration(e){this._editor.changeDecorations(t=>{t.removeDecoration(e),this._gutterDecorationID=void 0})}_updateGutterDecoration(e,t){this._editor.changeDecorations(i=>{i.changeDecoration(e,new L(t,0,t,0)),i.changeDecorationOptions(e,this.gutterDecoration)})}_updateLightbulbTitle(e,t){this.state.type===1&&(t?this.title=p("codeActionAutoRun","Run: {0}",this.state.actions.validActions[0].action.title):e&&this._preferredKbLabel?this.title=p("preferredcodeActionWithKb","Show Code Actions. Preferred Quick Fix Available ({0})",this._preferredKbLabel):!e&&this._quickFixKbLabel?this.title=p("codeActionWithKb","Show Code Actions ({0})",this._quickFixKbLabel):e||(this.title=p("codeAction","Show Code Actions")))}set title(e){this._domNode.title=e}},Fp=Mc,Mc.GUTTER_DECORATION=Fe.register({description:"codicon-gutter-lightbulb-decoration",glyphMarginClassName:ke.asClassName(J.lightBulb),glyphMargin:{position:Ur.Left},stickiness:1}),Mc.ID="editor.contrib.lightbulbWidget",Mc._posPref=[0],Mc);qy=Fp=zwe([Uwe(1,vt)],qy);var mq=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},UO=function(o,e){return function(t,i){e(t,i,o)}};const _q="acceptSelectedCodeAction",bq="previewSelectedCodeAction";class Gwe{get templateId(){return"header"}renderTemplate(e){e.classList.add("group-header");const t=document.createElement("span");return e.append(t),{container:e,text:t}}renderElement(e,t,i){i.text.textContent=e.group?.title??""}disposeTemplate(e){}}let GO=class{get templateId(){return"action"}constructor(e,t){this._supportsPreview=e,this._keybindingService=t}renderTemplate(e){e.classList.add(this.templateId);const t=document.createElement("div");t.className="icon",e.append(t);const i=document.createElement("span");i.className="title",e.append(i);const n=new _b(e,Js);return{container:e,icon:t,text:i,keybinding:n}}renderElement(e,t,i){if(e.group?.icon?(i.icon.className=ke.asClassName(e.group.icon),e.group.icon.color&&(i.icon.style.color=ce(e.group.icon.color.id))):(i.icon.className=ke.asClassName(J.lightBulb),i.icon.style.color="var(--vscode-editorLightBulb-foreground)"),!e.item||!e.label)return;i.text.textContent=vq(e.label),i.keybinding.set(e.keybinding),aee(!!e.keybinding,i.keybinding.element);const n=this._keybindingService.lookupKeybinding(_q)?.getLabel(),s=this._keybindingService.lookupKeybinding(bq)?.getLabel();i.container.classList.toggle("option-disabled",e.disabled),e.disabled?i.container.title=e.label:n&&s?this._supportsPreview&&e.canPreview?i.container.title=p({key:"label-preview",comment:['placeholders are keybindings, e.g "F2 to Apply, Shift+F2 to Preview"']},"{0} to Apply, {1} to Preview",n,s):i.container.title=p({key:"label",comment:['placeholder is a keybinding, e.g "F2 to Apply"']},"{0} to Apply",n):i.container.title=""}disposeTemplate(e){e.keybinding.dispose()}};GO=mq([UO(1,vt)],GO);class $we extends UIEvent{constructor(){super("acceptSelectedAction")}}class u8 extends UIEvent{constructor(){super("previewSelectedAction")}}function Kwe(o){if(o.kind==="action")return o.label}let $O=class extends F{constructor(e,t,i,n,s,r){super(),this._delegate=n,this._contextViewService=s,this._keybindingService=r,this._actionLineHeight=24,this._headerLineHeight=26,this.cts=this._register(new ri),this.domNode=document.createElement("div"),this.domNode.classList.add("actionList");const a={getHeight:l=>l.kind==="header"?this._headerLineHeight:this._actionLineHeight,getTemplateId:l=>l.kind};this._list=this._register(new $o(e,this.domNode,a,[new GO(t,this._keybindingService),new Gwe],{keyboardSupport:!1,typeNavigationEnabled:!0,keyboardNavigationLabelProvider:{getKeyboardNavigationLabel:Kwe},accessibilityProvider:{getAriaLabel:l=>{if(l.kind==="action"){let c=l.label?vq(l?.label):"";return l.disabled&&(c=p({key:"customQuickFixWidget.labels",comment:["Action widget labels for accessibility."]},"{0}, Disabled Reason: {1}",c,l.disabled)),c}return null},getWidgetAriaLabel:()=>p({key:"customQuickFixWidget",comment:["An action widget option"]},"Action Widget"),getRole:l=>l.kind==="action"?"option":"separator",getWidgetRole:()=>"listbox"}})),this._list.style(qf),this._register(this._list.onMouseClick(l=>this.onListClick(l))),this._register(this._list.onMouseOver(l=>this.onListHover(l))),this._register(this._list.onDidChangeFocus(()=>this.onFocus())),this._register(this._list.onDidChangeSelection(l=>this.onListSelection(l))),this._allMenuItems=i,this._list.splice(0,this._list.length,this._allMenuItems),this._list.length&&this.focusNext()}focusCondition(e){return!e.disabled&&e.kind==="action"}hide(e){this._delegate.onHide(e),this.cts.cancel(),this._contextViewService.hideContextView()}layout(e){const t=this._allMenuItems.filter(l=>l.kind==="header").length,n=this._allMenuItems.length*this._actionLineHeight+t*this._headerLineHeight-t*this._actionLineHeight;this._list.layout(n);let s=e;if(this._allMenuItems.length>=50)s=380;else{const l=this._allMenuItems.map((c,d)=>{const h=this.domNode.ownerDocument.getElementById(this._list.getElementID(d));if(h){h.style.width="auto";const u=h.getBoundingClientRect().width;return h.style.width="",u}return 0});s=Math.max(...l,e)}const a=Math.min(n,this.domNode.ownerDocument.body.clientHeight*.7);return this._list.layout(a,s),this.domNode.style.height=`${a}px`,this._list.domFocus(),s}focusPrevious(){this._list.focusPrevious(1,!0,void 0,this.focusCondition)}focusNext(){this._list.focusNext(1,!0,void 0,this.focusCondition)}acceptSelected(e){const t=this._list.getFocus();if(t.length===0)return;const i=t[0],n=this._list.element(i);if(!this.focusCondition(n))return;const s=e?new u8:new $we;this._list.setSelection([i],s)}onListSelection(e){if(!e.elements.length)return;const t=e.elements[0];t.item&&this.focusCondition(t)?this._delegate.onSelect(t.item,e.browserEvent instanceof u8):this._list.setSelection([])}onFocus(){const e=this._list.getFocus();if(e.length===0)return;const t=e[0],i=this._list.element(t);this._delegate.onFocus?.(i.item)}async onListHover(e){const t=e.element;if(t&&t.item&&this.focusCondition(t)){if(this._delegate.onHover&&!t.disabled&&t.kind==="action"){const i=await this._delegate.onHover(t.item,this.cts.token);t.canPreview=i?i.canPreview:void 0}e.index&&this._list.splice(e.index,1,[t])}this._list.setFocus(typeof e.index=="number"?[e.index]:[])}onListClick(e){e.element&&this.focusCondition(e.element)&&this._list.setFocus([])}};$O=mq([UO(4,sd),UO(5,vt)],$O);function vq(o){return o.replace(/\r\n|\r|\n/g," ")}var jwe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},pN=function(o,e){return function(t,i){e(t,i,o)}};D("actionBar.toggledBackground",Dw,p("actionBar.toggledBackground","Background color for toggled action items in action bar."));const Mf={Visible:new re("codeActionMenuVisible",!1,p("codeActionMenuVisible","Whether the action widget list is visible"))},tp=Je("actionWidgetService");let Of=class extends F{get isVisible(){return Mf.Visible.getValue(this._contextKeyService)||!1}constructor(e,t,i){super(),this._contextViewService=e,this._contextKeyService=t,this._instantiationService=i,this._list=this._register(new Yi)}show(e,t,i,n,s,r,a){const l=Mf.Visible.bindTo(this._contextKeyService),c=this._instantiationService.createInstance($O,e,t,i,n);this._contextViewService.showContextView({getAnchor:()=>s,render:d=>(l.set(!0),this._renderWidget(d,c,a??[])),onHide:d=>{l.reset(),this._onWidgetClosed(d)}},r,!1)}acceptSelected(e){this._list.value?.acceptSelected(e)}focusPrevious(){this._list?.value?.focusPrevious()}focusNext(){this._list?.value?.focusNext()}hide(e){this._list.value?.hide(e),this._list.clear()}_renderWidget(e,t,i){const n=document.createElement("div");if(n.classList.add("action-widget"),e.appendChild(n),this._list.value=t,this._list.value)n.appendChild(this._list.value.domNode);else throw new Error("List has no value");const s=new $,r=document.createElement("div"),a=e.appendChild(r);a.classList.add("context-view-block"),s.add(H(a,ee.MOUSE_DOWN,g=>g.stopPropagation()));const l=document.createElement("div"),c=e.appendChild(l);c.classList.add("context-view-pointerBlock"),s.add(H(c,ee.POINTER_MOVE,()=>c.remove())),s.add(H(c,ee.MOUSE_DOWN,()=>c.remove()));let d=0;if(i.length){const g=this._createActionBar(".action-widget-action-bar",i);g&&(n.appendChild(g.getContainer().parentElement),s.add(g),d=g.getContainer().offsetWidth)}const h=this._list.value?.layout(d);n.style.width=`${h}px`;const u=s.add(Ia(e));return s.add(u.onDidBlur(()=>this.hide(!0))),s}_createActionBar(e,t){if(!t.length)return;const i=ie(e),n=new Oo(i);return n.push(t,{icon:!1,label:!0}),n}_onWidgetClosed(e){this._list.value?.hide(e)}};Of=jwe([pN(0,sd),pN(1,Ee),pN(2,Ce)],Of);it(tp,Of,1);const Jw=1100;At(class extends _s{constructor(){super({id:"hideCodeActionWidget",title:De("hideCodeActionWidget.title","Hide action widget"),precondition:Mf.Visible,keybinding:{weight:Jw,primary:9,secondary:[1033]}})}run(o){o.get(tp).hide(!0)}});At(class extends _s{constructor(){super({id:"selectPrevCodeAction",title:De("selectPrevCodeAction.title","Select previous action"),precondition:Mf.Visible,keybinding:{weight:Jw,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}})}run(o){const e=o.get(tp);e instanceof Of&&e.focusPrevious()}});At(class extends _s{constructor(){super({id:"selectNextCodeAction",title:De("selectNextCodeAction.title","Select next action"),precondition:Mf.Visible,keybinding:{weight:Jw,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}})}run(o){const e=o.get(tp);e instanceof Of&&e.focusNext()}});At(class extends _s{constructor(){super({id:_q,title:De("acceptSelected.title","Accept selected action"),precondition:Mf.Visible,keybinding:{weight:Jw,primary:3,secondary:[2137]}})}run(o){const e=o.get(tp);e instanceof Of&&e.acceptSelected()}});At(class extends _s{constructor(){super({id:bq,title:De("previewSelected.title","Preview selected action"),precondition:Mf.Visible,keybinding:{weight:Jw,primary:2051}})}run(o){const e=o.get(tp);e instanceof Of&&e.acceptSelected(!0)}});const Cq=new re("supportedCodeAction",""),g8="_typescript.applyFixAllCodeAction";class qwe extends F{constructor(e,t,i,n=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=n,this._autoTriggerTimer=this._register(new qr),this._register(this._markerService.onMarkerChanged(s=>this._onMarkerChanges(s))),this._register(this._editor.onDidChangeCursorPosition(()=>this._tryAutoTrigger()))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);this._signalChange(t?{trigger:e,selection:t}:void 0)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some(i=>gy(i,t.uri))&&this._tryAutoTrigger()}_tryAutoTrigger(){this._autoTriggerTimer.cancelAndSet(()=>{this.trigger({type:2,triggerAction:lo.Default})},this._delay)}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getSelection();if(e.type===1)return t;const i=this._editor.getOption(65).enabled;if(i!==Ir.Off){{if(i===Ir.On)return t;if(i===Ir.OnCode){if(!t.isEmpty())return t;const s=this._editor.getModel(),{lineNumber:r,column:a}=t.getPosition(),l=s.getLineContent(r);if(l.length===0)return;if(a===1){if(/\s/.test(l[0]))return}else if(a===s.getLineMaxColumn(r)){if(/\s/.test(l[l.length-1]))return}else if(/\s/.test(l[a-2])&&/\s/.test(l[a-1]))return}}return t}}}var Uu;(function(o){o.Empty={type:0};class e{constructor(i,n,s){this.trigger=i,this.position=n,this._cancellablePromise=s,this.type=1,this.actions=s.catch(r=>{if(_r(r))return yq;throw r})}cancel(){this._cancellablePromise.cancel()}}o.Triggered=e})(Uu||(Uu={}));const yq=Object.freeze({allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1,hasAIFix:!1,allAIFixes:!1});class Zwe extends F{constructor(e,t,i,n,s,r,a){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=s,this._configurationService=r,this._telemetryService=a,this._codeActionOracle=this._register(new Yi),this._state=Uu.Empty,this._onDidChangeState=this._register(new O),this.onDidChangeState=this._onDidChangeState.event,this._disposed=!1,this._supportedCodeActions=Cq.bindTo(n),this._register(this._editor.onDidChangeModel(()=>this._update())),this._register(this._editor.onDidChangeModelLanguage(()=>this._update())),this._register(this._registry.onDidChange(()=>this._update())),this._register(this._editor.onDidChangeConfiguration(l=>{l.hasChanged(65)&&this._update()})),this._update()}dispose(){this._disposed||(this._disposed=!0,super.dispose(),this.setState(Uu.Empty,!0))}_settingEnabledNearbyQuickfixes(){const e=this._editor?.getModel();return this._configurationService?this._configurationService.getValue("editor.codeActionWidget.includeNearbyQuickFixes",{resource:e?.uri}):!1}_update(){if(this._disposed)return;this._codeActionOracle.value=void 0,this.setState(Uu.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(92)){const t=this._registry.all(e).flatMap(i=>i.providedCodeActionKinds??[]);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new qwe(this._editor,this._markerService,i=>{if(!i){this.setState(Uu.Empty);return}const n=i.selection.getStartPosition(),s=ji(async l=>{if(this._settingEnabledNearbyQuickfixes()&&i.trigger.type===1&&(i.trigger.triggerAction===lo.QuickFix||i.trigger.filter?.include?.contains(jt.QuickFix))){const c=await rm(this._registry,e,i.selection,i.trigger,va.None,l),d=[...c.allActions];if(l.isCancellationRequested)return yq;const h=c.validActions?.some(g=>g.action.kind?jt.QuickFix.contains(new Jt(g.action.kind)):!1),u=this._markerService.read({resource:e.uri});if(h){for(const g of c.validActions)g.action.command?.arguments?.some(f=>typeof f=="string"&&f.includes(g8))&&(g.action.diagnostics=[...u.filter(f=>f.relatedInformation)]);return{validActions:c.validActions,allActions:d,documentation:c.documentation,hasAutoFix:c.hasAutoFix,hasAIFix:c.hasAIFix,allAIFixes:c.allAIFixes,dispose:()=>{c.dispose()}}}else if(!h&&u.length>0){const g=i.selection.getPosition();let f=g,m=Number.MAX_VALUE;const _=[...c.validActions];for(const v of u){const y=v.endColumn,C=v.endLineNumber,w=v.startLineNumber;if(C===g.lineNumber||w===g.lineNumber){f=new A(C,y);const x={type:i.trigger.type,triggerAction:i.trigger.triggerAction,filter:{include:i.trigger.filter?.include?i.trigger.filter?.include:jt.QuickFix},autoApply:i.trigger.autoApply,context:{notAvailableMessage:i.trigger.context?.notAvailableMessage||"",position:f}},k=new pe(f.lineNumber,f.column,f.lineNumber,f.column),E=await rm(this._registry,e,k,x,va.None,l);if(E.validActions.length!==0){for(const N of E.validActions)N.action.command?.arguments?.some(z=>typeof z=="string"&&z.includes(g8))&&(N.action.diagnostics=[...u.filter(z=>z.relatedInformation)]);c.allActions.length===0&&d.push(...E.allActions),Math.abs(g.column-y)<m?_.unshift(...E.validActions):_.push(...E.validActions)}m=Math.abs(g.column-y)}}const b=_.filter((v,y,C)=>C.findIndex(w=>w.action.title===v.action.title)===y);return b.sort((v,y)=>v.action.isPreferred&&!y.action.isPreferred?-1:!v.action.isPreferred&&y.action.isPreferred||v.action.isAI&&!y.action.isAI?1:!v.action.isAI&&y.action.isAI?-1:0),{validActions:b,allActions:d,documentation:c.documentation,hasAutoFix:c.hasAutoFix,hasAIFix:c.hasAIFix,allAIFixes:c.allAIFixes,dispose:()=>{c.dispose()}}}}if(i.trigger.type===1){const c=new rn,d=await rm(this._registry,e,i.selection,i.trigger,va.None,l);return this._telemetryService&&this._telemetryService.publicLog2("codeAction.invokedDurations",{codeActions:d.validActions.length,duration:c.elapsed()}),d}return rm(this._registry,e,i.selection,i.trigger,va.None,l)});i.trigger.type===1&&this._progressService?.showWhile(s,250);const r=new Uu.Triggered(i.trigger,n,s);let a=!1;this._state.type===1&&(a=this._state.trigger.type===1&&r.type===1&&r.trigger.type===2&&this._state.position!==r.position),a?setTimeout(()=>{this.setState(r)},500):this.setState(r)},void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:lo.Default})}else this._supportedCodeActions.reset()}trigger(e){this._codeActionOracle.value?.trigger(e)}setState(e,t){e!==this._state&&(this._state.type===1&&this._state.cancel(),this._state=e,!t&&!this._disposed&&this._onDidChangeState.fire(e))}}var Ywe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},qa=function(o,e){return function(t,i){e(t,i,o)}},Bp;const Xwe="quickfix-edit-highlight";var dh;let V_=(dh=class extends F{static get(e){return e.getContribution(Bp.ID)}constructor(e,t,i,n,s,r,a,l,c,d,h){super(),this._commandService=a,this._configurationService=l,this._actionWidgetService=c,this._instantiationService=d,this._telemetryService=h,this._activeCodeActions=this._register(new Yi),this._showDisabled=!1,this._disposed=!1,this._editor=e,this._model=this._register(new Zwe(this._editor,s.codeActionProvider,t,i,r,l,this._telemetryService)),this._register(this._model.onDidChangeState(u=>this.update(u))),this._lightBulbWidget=new Da(()=>{const u=this._editor.getContribution(qy.ID);return u&&this._register(u.onClick(g=>this.showCodeActionsFromLightbulb(g.actions,g))),u}),this._resolver=n.createInstance(zO),this._register(this._editor.onDidLayoutChange(()=>this._actionWidgetService.hide()))}dispose(){this._disposed=!0,super.dispose()}async showCodeActionsFromLightbulb(e,t){if(e.allAIFixes&&e.validActions.length===1){const i=e.validActions[0],n=i.action.command;n&&n.id==="inlineChat.start"&&n.arguments&&n.arguments.length>=1&&(n.arguments[0]={...n.arguments[0],autoSend:!1}),await this._applyCodeAction(i,!1,!1,ng.FromAILightbulb);return}await this.showCodeActionList(e,t,{includeDisabledActions:!1,fromLightbulb:!0})}showCodeActions(e,t,i){return this.showCodeActionList(t,i,{includeDisabledActions:!1,fromLightbulb:!1})}manualTriggerAtCurrentPosition(e,t,i,n){if(!this._editor.hasModel())return;no.get(this._editor)?.closeMessage();const s=this._editor.getPosition();this._trigger({type:1,triggerAction:t,filter:i,autoApply:n,context:{notAvailableMessage:e,position:s}})}_trigger(e){return this._model.trigger(e)}async _applyCodeAction(e,t,i,n){try{await this._instantiationService.invokeFunction(Owe,e,n,{preview:i,editor:this._editor})}finally{t&&this._trigger({type:2,triggerAction:lo.QuickFix,filter:{}})}}hideLightBulbWidget(){this._lightBulbWidget.rawValue?.hide(),this._lightBulbWidget.rawValue?.gutterHide()}async update(e){if(e.type!==1){this.hideLightBulbWidget();return}let t;try{t=await e.actions}catch(n){Ae(n);return}if(!(this._disposed||this._editor.getSelection()?.startLineNumber!==e.position.lineNumber))if(this._lightBulbWidget.value?.update(t,e.trigger,e.position),e.trigger.type===1){if(e.trigger.filter?.include){const s=this.tryGetValidActionToApply(e.trigger,t);if(s){try{this.hideLightBulbWidget(),await this._applyCodeAction(s,!1,!1,ng.FromCodeActions)}finally{t.dispose()}return}if(e.trigger.context){const r=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,t);if(r&&r.action.disabled){no.get(this._editor)?.showMessage(r.action.disabled,e.trigger.context.position),t.dispose();return}}}const n=!!e.trigger.filter?.include;if(e.trigger.context&&(!t.allActions.length||!n&&!t.validActions.length)){no.get(this._editor)?.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=t,t.dispose();return}this._activeCodeActions.value=t,this.showCodeActionList(t,this.toCoords(e.position),{includeDisabledActions:n,fromLightbulb:!1})}else this._actionWidgetService.isVisible?t.dispose():this._activeCodeActions.value=t}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length&&(e.autoApply==="first"&&t.validActions.length===0||e.autoApply==="ifSingle"&&t.allActions.length===1))return t.allActions.find(({action:i})=>i.disabled)}tryGetValidActionToApply(e,t){if(t.validActions.length&&(e.autoApply==="first"&&t.validActions.length>0||e.autoApply==="ifSingle"&&t.validActions.length===1))return t.validActions[0]}async showCodeActionList(e,t,i){const n=this._editor.createDecorationsCollection(),s=this._editor.getDomNode();if(!s)return;const r=i.includeDisabledActions&&(this._showDisabled||e.validActions.length===0)?e.allActions:e.validActions;if(!r.length)return;const a=A.isIPosition(t)?this.toCoords(t):t,l={onSelect:async(c,d)=>{this._applyCodeAction(c,!0,!!d,i.fromLightbulb?ng.FromAILightbulb:ng.FromCodeActions),this._actionWidgetService.hide(!1),n.clear()},onHide:c=>{this._editor?.focus(),n.clear()},onHover:async(c,d)=>{if(d.isCancellationRequested)return;let h=!1;const u=c.action.kind;if(u){const g=new Jt(u);h=[jt.RefactorExtract,jt.RefactorInline,jt.RefactorRewrite,jt.RefactorMove,jt.Source].some(m=>m.contains(g))}return{canPreview:h||!!c.action.edit?.edits.length}},onFocus:c=>{if(c&&c.action){const d=c.action.ranges,h=c.action.diagnostics;if(n.clear(),d&&d.length>0){const u=h&&h?.length>1?h.map(g=>({range:g,options:Bp.DECORATION})):d.map(g=>({range:g,options:Bp.DECORATION}));n.set(u)}else if(h&&h.length>0){const u=h.map(f=>({range:f,options:Bp.DECORATION}));n.set(u);const g=h[0];if(g.startLineNumber&&g.startColumn){const f=this._editor.getModel()?.getWordAtPosition({lineNumber:g.startLineNumber,column:g.startColumn})?.word;Rl(p("editingNewSelection","Context: {0} at line {1} and column {2}.",f,g.startLineNumber,g.startColumn))}}}else n.clear()}};this._actionWidgetService.show("codeActionWidget",!0,Hwe(r,this._shouldShowHeaders(),this._resolver.getResolver()),l,a,s,this._getActionBarActions(e,t,i))}toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=Ci(this._editor.getDomNode()),n=i.left+t.left,s=i.top+t.top+t.height;return{x:n,y:s}}_shouldShowHeaders(){const e=this._editor?.getModel();return this._configurationService.getValue("editor.codeActionWidget.showHeaders",{resource:e?.uri})}_getActionBarActions(e,t,i){if(i.fromLightbulb)return[];const n=e.documentation.map(s=>({id:s.id,label:s.title,tooltip:s.tooltip??"",class:void 0,enabled:!0,run:()=>this._commandService.executeCommand(s.id,...s.arguments??[])}));return i.includeDisabledActions&&e.validActions.length>0&&e.allActions.length!==e.validActions.length&&n.push(this._showDisabled?{id:"hideMoreActions",label:p("hideMoreActions","Hide Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!1,this.showCodeActionList(e,t,i))}:{id:"showMoreActions",label:p("showMoreActions","Show Disabled"),enabled:!0,tooltip:"",class:void 0,run:()=>(this._showDisabled=!0,this.showCodeActionList(e,t,i))}),n}},Bp=dh,dh.ID="editor.contrib.codeActionController",dh.DECORATION=Fe.register({description:"quickfix-highlight",className:Xwe}),dh);V_=Bp=Ywe([qa(1,Ul),qa(2,Ee),qa(3,Ce),qa(4,ue),qa(5,Yh),qa(6,Ft),qa(7,Ke),qa(8,tp),qa(9,Ce),qa(10,Fn)],V_);br((o,e)=>{((n,s)=>{s&&e.addRule(`.monaco-editor ${n} { background-color: ${s}; }`)})(".quickfix-edit-highlight",o.getColor(Ec));const i=o.getColor(Ud);i&&e.addRule(`.monaco-editor .quickfix-edit-highlight { border: 1px ${xa(o.type)?"dotted":"solid"} ${i}; box-sizing: border-box; }`)});function eS(o){return K.regex(Cq.keys()[0],new RegExp("(\\s|^)"+Fo(o.value)+"\\b"))}const mW={type:"object",defaultSnippets:[{body:{kind:""}}],properties:{kind:{type:"string",description:p("args.schema.kind","Kind of the code action to run.")},apply:{type:"string",description:p("args.schema.apply","Controls when the returned actions are applied."),default:"ifSingle",enum:["first","ifSingle","never"],enumDescriptions:[p("args.schema.apply.first","Always apply the first returned code action."),p("args.schema.apply.ifSingle","Apply the first returned code action if it is the only one."),p("args.schema.apply.never","Do not apply the returned code actions.")]},preferred:{type:"boolean",default:!1,description:p("args.schema.preferred","Controls if only preferred code actions should be returned.")}}};function ip(o,e,t,i,n=lo.Default){o.hasModel()&&V_.get(o)?.manualTriggerAtCurrentPosition(e,n,t,i)}class Qwe extends de{constructor(){super({id:pW,label:p("quickfix.trigger.label","Quick Fix..."),alias:"Quick Fix...",precondition:K.and(T.writable,T.hasCodeActionsProvider),kbOpts:{kbExpr:T.textInputFocus,primary:2137,weight:100}})}run(e,t){return ip(t,p("editor.action.quickFix.noneMessage","No code actions available"),void 0,void 0,lo.QuickFix)}}class Jwe extends Hi{constructor(){super({id:hq,precondition:K.and(T.writable,T.hasCodeActionsProvider),metadata:{description:"Trigger a code action",args:[{name:"args",schema:mW}]}})}runEditorCommand(e,t,i){const n=_l.fromUser(i,{kind:Jt.Empty,apply:"ifSingle"});return ip(t,typeof i?.kind=="string"?n.preferred?p("editor.action.codeAction.noneMessage.preferred.kind","No preferred code actions for '{0}' available",i.kind):p("editor.action.codeAction.noneMessage.kind","No code actions for '{0}' available",i.kind):n.preferred?p("editor.action.codeAction.noneMessage.preferred","No preferred code actions available"):p("editor.action.codeAction.noneMessage","No code actions available"),{include:n.kind,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply)}}class eSe extends de{constructor(){super({id:gq,label:p("refactor.label","Refactor..."),alias:"Refactor...",precondition:K.and(T.writable,T.hasCodeActionsProvider),kbOpts:{kbExpr:T.textInputFocus,primary:3120,mac:{primary:1328},weight:100},contextMenuOpts:{group:"1_modification",order:2,when:K.and(T.writable,eS(jt.Refactor))},metadata:{description:"Refactor...",args:[{name:"args",schema:mW}]}})}run(e,t,i){const n=_l.fromUser(i,{kind:jt.Refactor,apply:"never"});return ip(t,typeof i?.kind=="string"?n.preferred?p("editor.action.refactor.noneMessage.preferred.kind","No preferred refactorings for '{0}' available",i.kind):p("editor.action.refactor.noneMessage.kind","No refactorings for '{0}' available",i.kind):n.preferred?p("editor.action.refactor.noneMessage.preferred","No preferred refactorings available"):p("editor.action.refactor.noneMessage","No refactorings available"),{include:jt.Refactor.contains(n.kind)?n.kind:Jt.None,onlyIncludePreferredActions:n.preferred},n.apply,lo.Refactor)}}class tSe extends de{constructor(){super({id:fq,label:p("source.label","Source Action..."),alias:"Source Action...",precondition:K.and(T.writable,T.hasCodeActionsProvider),contextMenuOpts:{group:"1_modification",order:2.1,when:K.and(T.writable,eS(jt.Source))},metadata:{description:"Source Action...",args:[{name:"args",schema:mW}]}})}run(e,t,i){const n=_l.fromUser(i,{kind:jt.Source,apply:"never"});return ip(t,typeof i?.kind=="string"?n.preferred?p("editor.action.source.noneMessage.preferred.kind","No preferred source actions for '{0}' available",i.kind):p("editor.action.source.noneMessage.kind","No source actions for '{0}' available",i.kind):n.preferred?p("editor.action.source.noneMessage.preferred","No preferred source actions available"):p("editor.action.source.noneMessage","No source actions available"),{include:jt.Source.contains(n.kind)?n.kind:Jt.None,includeSourceActions:!0,onlyIncludePreferredActions:n.preferred},n.apply,lo.SourceAction)}}class iSe extends de{constructor(){super({id:WO,label:p("organizeImports.label","Organize Imports"),alias:"Organize Imports",precondition:K.and(T.writable,eS(jt.SourceOrganizeImports)),kbOpts:{kbExpr:T.textInputFocus,primary:1581,weight:100}})}run(e,t){return ip(t,p("editor.action.organize.noneMessage","No organize imports action available"),{include:jt.SourceOrganizeImports,includeSourceActions:!0},"ifSingle",lo.OrganizeImports)}}class nSe extends de{constructor(){super({id:VO,label:p("fixAll.label","Fix All"),alias:"Fix All",precondition:K.and(T.writable,eS(jt.SourceFixAll))})}run(e,t){return ip(t,p("fixAll.noneMessage","No fix all action available"),{include:jt.SourceFixAll,includeSourceActions:!0},"ifSingle",lo.FixAll)}}class sSe extends de{constructor(){super({id:uq,label:p("autoFix.label","Auto Fix..."),alias:"Auto Fix...",precondition:K.and(T.writable,eS(jt.QuickFix)),kbOpts:{kbExpr:T.textInputFocus,primary:1625,mac:{primary:2649},weight:100}})}run(e,t){return ip(t,p("editor.action.autoFix.noneMessage","No auto fixes available"),{include:jt.QuickFix,onlyIncludePreferredActions:!0},"ifSingle",lo.AutoFix)}}at(V_.ID,V_,3);at(qy.ID,qy,4);X(Qwe);X(eSe);X(tSe);X(iSe);X(sSe);X(nSe);oe(new Jwe);ai.as(Zr.Configuration).registerConfiguration({...Aw,properties:{"editor.codeActionWidget.showHeaders":{type:"boolean",scope:5,description:p("showCodeActionHeaders","Enable/disable showing group headers in the Code Action menu."),default:!0}}});ai.as(Zr.Configuration).registerConfiguration({...Aw,properties:{"editor.codeActionWidget.includeNearbyQuickFixes":{type:"boolean",scope:5,description:p("includeNearbyQuickFixes","Enable/disable showing nearest Quick Fix within a line when not currently on a diagnostic."),default:!0}}});ai.as(Zr.Configuration).registerConfiguration({...Aw,properties:{"editor.codeActions.triggerOnFocusChange":{type:"boolean",scope:5,markdownDescription:p("triggerOnFocusChange","Enable triggering {0} when {1} is set to {2}. Code Actions must be set to {3} to be triggered for window and focus changes.","`#editor.codeActionsOnSave#`","`#files.autoSave#`","`afterDelay`","`always`"),default:!1}}});class KO{constructor(){this.lenses=[],this._disposables=new $}dispose(){this._disposables.dispose()}get isDisposed(){return this._disposables.isDisposed}add(e,t){this._disposables.add(e);for(const i of e.lenses)this.lenses.push({symbol:i,provider:t})}}async function wq(o,e,t){const i=o.ordered(e),n=new Map,s=new KO,r=i.map(async(a,l)=>{n.set(a,l);try{const c=await Promise.resolve(a.provideCodeLenses(e,t));c&&s.add(c,a)}catch(c){yi(c)}});return await Promise.all(r),s.lenses=s.lenses.sort((a,l)=>a.symbol.range.startLineNumber<l.symbol.range.startLineNumber?-1:a.symbol.range.startLineNumber>l.symbol.range.startLineNumber?1:n.get(a.provider)<n.get(l.provider)?-1:n.get(a.provider)>n.get(l.provider)?1:a.symbol.range.startColumn<l.symbol.range.startColumn?-1:a.symbol.range.startColumn>l.symbol.range.startColumn?1:0),s}st.registerCommand("_executeCodeLensProvider",function(o,...e){let[t,i]=e;ut(ye.isUri(t)),ut(typeof i=="number"||!i);const{codeLensProvider:n}=o.get(ue),s=o.get(Ut).getModel(t);if(!s)throw ar();const r=[],a=new $;return wq(n,s,He.None).then(l=>{a.add(l);const c=[];for(const d of l.lenses)i==null||d.symbol.command?r.push(d.symbol):i-- >0&&d.provider.resolveCodeLens&&c.push(Promise.resolve(d.provider.resolveCodeLens(s,d.symbol,He.None)).then(h=>r.push(h||d.symbol)));return Promise.all(c)}).then(()=>r).finally(()=>{setTimeout(()=>a.dispose(),100)})});var oSe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},rSe=function(o,e){return function(t,i){e(t,i,o)}};const Sq=Je("ICodeLensCache");class f8{constructor(e,t){this.lineCount=e,this.data=t}}let jO=class{constructor(e){this._fakeProvider=new class{provideCodeLenses(){throw new Error("not supported")}},this._cache=new Vl(20,.75);const t="codelens/cache";cv(It,()=>e.remove(t,1));const i="codelens/cache2",n=e.get(i,1,"{}");this._deserialize(n);const s=se.filter(e.onWillSaveState,r=>r.reason===vy.SHUTDOWN);se.once(s)(r=>{e.store(i,this._serialize(),1,1)})}put(e,t){const i=t.lenses.map(r=>({range:r.symbol.range,command:r.symbol.command&&{id:"",title:r.symbol.command?.title}})),n=new KO;n.add({lenses:i,dispose:()=>{}},this._fakeProvider);const s=new f8(e.getLineCount(),n);this._cache.set(e.uri.toString(),s)}get(e){const t=this._cache.get(e.uri.toString());return t&&t.lineCount===e.getLineCount()?t.data:void 0}delete(e){this._cache.delete(e.uri.toString())}_serialize(){const e=Object.create(null);for(const[t,i]of this._cache){const n=new Set;for(const s of i.data.lenses)n.add(s.symbol.range.startLineNumber);e[t]={lineCount:i.lineCount,lines:[...n.values()]}}return JSON.stringify(e)}_deserialize(e){try{const t=JSON.parse(e);for(const i in t){const n=t[i],s=[];for(const a of n.lines)s.push({range:new L(a,1,a,11)});const r=new KO;r.add({lenses:s,dispose(){}},this._fakeProvider),this._cache.set(i,new f8(n.lineCount,r))}}catch{}}};jO=oSe([rSe(0,Yr)],jO);it(Sq,jO,1);class aSe{constructor(e,t,i){this.afterColumn=1073741824,this.afterLineNumber=e,this.heightInPx=t,this._onHeight=i,this.suppressMouseDown=!0,this.domNode=document.createElement("div")}onComputedHeight(e){this._lastHeight===void 0?this._lastHeight=e:this._lastHeight!==e&&(this._lastHeight=e,this._onHeight())}isVisible(){return this._lastHeight!==0&&this.domNode.hasAttribute("monaco-visible-view-zone")}}const OC=class OC{constructor(e,t){this.allowEditorOverflow=!1,this.suppressMouseDown=!0,this._commands=new Map,this._isEmpty=!0,this._editor=e,this._id=`codelens.widget-${OC._idPool++}`,this.updatePosition(t),this._domNode=document.createElement("span"),this._domNode.className="codelens-decoration"}withCommands(e,t){this._commands.clear();const i=[];let n=!1;for(let s=0;s<e.length;s++){const r=e[s];if(r&&(n=!0,r.command)){const a=nh(r.command.title.trim());if(r.command.id){const l=`c${OC._idPool++}`;i.push(ie("a",{id:l,title:r.command.tooltip,role:"button"},...a)),this._commands.set(l,r.command)}else i.push(ie("span",{title:r.command.tooltip},...a));s+1<e.length&&i.push(ie("span",void 0," | "))}}n?(pn(this._domNode,...i),this._isEmpty&&t&&this._domNode.classList.add("fadein"),this._isEmpty=!1):pn(this._domNode,ie("span",void 0,"no commands"))}getCommand(e){return e.parentElement===this._domNode?this._commands.get(e.id):void 0}getId(){return this._id}getDomNode(){return this._domNode}updatePosition(e){const t=this._editor.getModel().getLineFirstNonWhitespaceColumn(e);this._widgetPosition={position:{lineNumber:e,column:t},preference:[1]}}getPosition(){return this._widgetPosition||null}};OC._idPool=0;let qO=OC;class mN{constructor(){this._removeDecorations=[],this._addDecorations=[],this._addDecorationsCallbacks=[]}addDecoration(e,t){this._addDecorations.push(e),this._addDecorationsCallbacks.push(t)}removeDecoration(e){this._removeDecorations.push(e)}commit(e){const t=e.deltaDecorations(this._removeDecorations,this._addDecorations);for(let i=0,n=t.length;i<n;i++)this._addDecorationsCallbacks[i](t[i])}}const p8=Fe.register({collapseOnReplaceEdit:!0,description:"codelens"});class m8{constructor(e,t,i,n,s,r){this._isDisposed=!1,this._editor=t,this._data=e,this._decorationIds=[];let a;const l=[];this._data.forEach((c,d)=>{c.symbol.command&&l.push(c.symbol),i.addDecoration({range:c.symbol.range,options:p8},h=>this._decorationIds[d]=h),a?a=L.plusRange(a,c.symbol.range):a=L.lift(c.symbol.range)}),this._viewZone=new aSe(a.startLineNumber-1,s,r),this._viewZoneId=n.addZone(this._viewZone),l.length>0&&(this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(l,!1))}_createContentWidgetIfNecessary(){this._contentWidget?this._editor.layoutContentWidget(this._contentWidget):(this._contentWidget=new qO(this._editor,this._viewZone.afterLineNumber+1),this._editor.addContentWidget(this._contentWidget))}dispose(e,t){this._decorationIds.forEach(e.removeDecoration,e),this._decorationIds=[],t?.removeZone(this._viewZoneId),this._contentWidget&&(this._editor.removeContentWidget(this._contentWidget),this._contentWidget=void 0),this._isDisposed=!0}isDisposed(){return this._isDisposed}isValid(){return this._decorationIds.some((e,t)=>{const i=this._editor.getModel().getDecorationRange(e),n=this._data[t].symbol;return!!(i&&L.isEmpty(n.range)===i.isEmpty())})}updateCodeLensSymbols(e,t){this._decorationIds.forEach(t.removeDecoration,t),this._decorationIds=[],this._data=e,this._data.forEach((i,n)=>{t.addDecoration({range:i.symbol.range,options:p8},s=>this._decorationIds[n]=s)})}updateHeight(e,t){this._viewZone.heightInPx=e,t.layoutZone(this._viewZoneId),this._contentWidget&&this._editor.layoutContentWidget(this._contentWidget)}computeIfNecessary(e){if(!this._viewZone.isVisible())return null;for(let t=0;t<this._decorationIds.length;t++){const i=e.getDecorationRange(this._decorationIds[t]);i&&(this._data[t].symbol.range=i)}return this._data}updateCommands(e){this._createContentWidgetIfNecessary(),this._contentWidget.withCommands(e,!0);for(let t=0;t<this._data.length;t++){const i=e[t];if(i){const{symbol:n}=this._data[t];n.command=i.command||n.command}}}getCommand(e){return this._contentWidget?.getCommand(e)}getLineNumber(){const e=this._editor.getModel().getDecorationRange(this._decorationIds[0]);return e?e.startLineNumber:-1}update(e){if(this.isValid()){const t=this._editor.getModel().getDecorationRange(this._decorationIds[0]);t&&(this._viewZone.afterLineNumber=t.startLineNumber-1,e.layoutZone(this._viewZoneId),this._contentWidget&&(this._contentWidget.updatePosition(t.startLineNumber),this._editor.layoutContentWidget(this._contentWidget)))}}}var lSe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},nv=function(o,e){return function(t,i){e(t,i,o)}},n_;let Zy=(n_=class{constructor(e,t,i,n,s,r){this._editor=e,this._languageFeaturesService=t,this._commandService=n,this._notificationService=s,this._codeLensCache=r,this._disposables=new $,this._localToDispose=new $,this._lenses=[],this._oldCodeLensModels=new $,this._provideCodeLensDebounce=i.for(t.codeLensProvider,"CodeLensProvide",{min:250}),this._resolveCodeLensesDebounce=i.for(t.codeLensProvider,"CodeLensResolve",{min:250,salt:"resolve"}),this._resolveCodeLensesScheduler=new xt(()=>this._resolveCodeLensesInViewport(),this._resolveCodeLensesDebounce.default()),this._disposables.add(this._editor.onDidChangeModel(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>this._onModelChange())),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{(a.hasChanged(50)||a.hasChanged(19)||a.hasChanged(18))&&this._updateLensStyle(),a.hasChanged(17)&&this._onModelChange()})),this._disposables.add(t.codeLensProvider.onDidChange(this._onModelChange,this)),this._onModelChange(),this._updateLensStyle()}dispose(){this._localDispose(),this._disposables.dispose(),this._oldCodeLensModels.dispose(),this._currentCodeLensModel?.dispose()}_getLayoutInfo(){const e=Math.max(1.3,this._editor.getOption(67)/this._editor.getOption(52));let t=this._editor.getOption(19);return(!t||t<5)&&(t=this._editor.getOption(52)*.9|0),{fontSize:t,codeLensHeight:t*e|0}}_updateLensStyle(){const{codeLensHeight:e,fontSize:t}=this._getLayoutInfo(),i=this._editor.getOption(18),n=this._editor.getOption(50),{style:s}=this._editor.getContainerDomNode();s.setProperty("--vscode-editorCodeLens-lineHeight",`${e}px`),s.setProperty("--vscode-editorCodeLens-fontSize",`${t}px`),s.setProperty("--vscode-editorCodeLens-fontFeatureSettings",n.fontFeatureSettings),i&&(s.setProperty("--vscode-editorCodeLens-fontFamily",i),s.setProperty("--vscode-editorCodeLens-fontFamilyDefault",ds.fontFamily)),this._editor.changeViewZones(r=>{for(const a of this._lenses)a.updateHeight(e,r)})}_localDispose(){this._getCodeLensModelPromise?.cancel(),this._getCodeLensModelPromise=void 0,this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0,this._localToDispose.clear(),this._oldCodeLensModels.clear(),this._currentCodeLensModel?.dispose()}_onModelChange(){this._localDispose();const e=this._editor.getModel();if(!e||!this._editor.getOption(17)||e.isTooLargeForTokenization())return;const t=this._codeLensCache.get(e);if(t&&this._renderCodeLensSymbols(t),!this._languageFeaturesService.codeLensProvider.has(e)){t&&Rh(()=>{const n=this._codeLensCache.get(e);t===n&&(this._codeLensCache.delete(e),this._onModelChange())},30*1e3,this._localToDispose);return}for(const n of this._languageFeaturesService.codeLensProvider.all(e))if(typeof n.onDidChange=="function"){const s=n.onDidChange(()=>i.schedule());this._localToDispose.add(s)}const i=new xt(()=>{const n=Date.now();this._getCodeLensModelPromise?.cancel(),this._getCodeLensModelPromise=ji(s=>wq(this._languageFeaturesService.codeLensProvider,e,s)),this._getCodeLensModelPromise.then(s=>{this._currentCodeLensModel&&this._oldCodeLensModels.add(this._currentCodeLensModel),this._currentCodeLensModel=s,this._codeLensCache.put(e,s);const r=this._provideCodeLensDebounce.update(e,Date.now()-n);i.delay=r,this._renderCodeLensSymbols(s),this._resolveCodeLensesInViewportSoon()},Ae)},this._provideCodeLensDebounce.get(e));this._localToDispose.add(i),this._localToDispose.add(ve(()=>this._resolveCodeLensesScheduler.cancel())),this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._editor.changeDecorations(n=>{this._editor.changeViewZones(s=>{const r=[];let a=-1;this._lenses.forEach(c=>{!c.isValid()||a===c.getLineNumber()?r.push(c):(c.update(s),a=c.getLineNumber())});const l=new mN;r.forEach(c=>{c.dispose(l,s),this._lenses.splice(this._lenses.indexOf(c),1)}),l.commit(n)})}),i.schedule(),this._resolveCodeLensesScheduler.cancel(),this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0})),this._localToDispose.add(this._editor.onDidFocusEditorText(()=>{i.schedule()})),this._localToDispose.add(this._editor.onDidBlurEditorText(()=>{i.cancel()})),this._localToDispose.add(this._editor.onDidScrollChange(n=>{n.scrollTopChanged&&this._lenses.length>0&&this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(this._editor.onDidLayoutChange(()=>{this._resolveCodeLensesInViewportSoon()})),this._localToDispose.add(ve(()=>{if(this._editor.getModel()){const n=Ma.capture(this._editor);this._editor.changeDecorations(s=>{this._editor.changeViewZones(r=>{this._disposeAllLenses(s,r)})}),n.restore(this._editor)}else this._disposeAllLenses(void 0,void 0)})),this._localToDispose.add(this._editor.onMouseDown(n=>{if(n.target.type!==9)return;let s=n.target.element;if(s?.tagName==="SPAN"&&(s=s.parentElement),s?.tagName==="A")for(const r of this._lenses){const a=r.getCommand(s);if(a){this._commandService.executeCommand(a.id,...a.arguments||[]).catch(l=>this._notificationService.error(l));break}}})),i.schedule()}_disposeAllLenses(e,t){const i=new mN;for(const n of this._lenses)n.dispose(i,t);e&&i.commit(e),this._lenses.length=0}_renderCodeLensSymbols(e){if(!this._editor.hasModel())return;const t=this._editor.getModel().getLineCount(),i=[];let n;for(const a of e.lenses){const l=a.symbol.range.startLineNumber;l<1||l>t||(n&&n[n.length-1].symbol.range.startLineNumber===l?n.push(a):(n=[a],i.push(n)))}if(!i.length&&!this._lenses.length)return;const s=Ma.capture(this._editor),r=this._getLayoutInfo();this._editor.changeDecorations(a=>{this._editor.changeViewZones(l=>{const c=new mN;let d=0,h=0;for(;h<i.length&&d<this._lenses.length;){const u=i[h][0].symbol.range.startLineNumber,g=this._lenses[d].getLineNumber();g<u?(this._lenses[d].dispose(c,l),this._lenses.splice(d,1)):g===u?(this._lenses[d].updateCodeLensSymbols(i[h],c),h++,d++):(this._lenses.splice(d,0,new m8(i[h],this._editor,c,l,r.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),d++,h++)}for(;d<this._lenses.length;)this._lenses[d].dispose(c,l),this._lenses.splice(d,1);for(;h<i.length;)this._lenses.push(new m8(i[h],this._editor,c,l,r.codeLensHeight,()=>this._resolveCodeLensesInViewportSoon())),h++;c.commit(a)})}),s.restore(this._editor)}_resolveCodeLensesInViewportSoon(){this._editor.getModel()&&this._resolveCodeLensesScheduler.schedule()}_resolveCodeLensesInViewport(){this._resolveCodeLensesPromise?.cancel(),this._resolveCodeLensesPromise=void 0;const e=this._editor.getModel();if(!e)return;const t=[],i=[];if(this._lenses.forEach(r=>{const a=r.computeIfNecessary(e);a&&(t.push(a),i.push(r))}),t.length===0)return;const n=Date.now(),s=ji(r=>{const a=t.map((l,c)=>{const d=new Array(l.length),h=l.map((u,g)=>!u.symbol.command&&typeof u.provider.resolveCodeLens=="function"?Promise.resolve(u.provider.resolveCodeLens(e,u.symbol,r)).then(f=>{d[g]=f},yi):(d[g]=u.symbol,Promise.resolve(void 0)));return Promise.all(h).then(()=>{!r.isCancellationRequested&&!i[c].isDisposed()&&i[c].updateCommands(d)})});return Promise.all(a)});this._resolveCodeLensesPromise=s,this._resolveCodeLensesPromise.then(()=>{const r=this._resolveCodeLensesDebounce.update(e,Date.now()-n);this._resolveCodeLensesScheduler.delay=r,this._currentCodeLensModel&&this._codeLensCache.put(e,this._currentCodeLensModel),this._oldCodeLensModels.clear(),s===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)},r=>{Ae(r),s===this._resolveCodeLensesPromise&&(this._resolveCodeLensesPromise=void 0)})}async getModel(){return await this._getCodeLensModelPromise,await this._resolveCodeLensesPromise,this._currentCodeLensModel?.isDisposed?void 0:this._currentCodeLensModel}},n_.ID="css.editor.codeLens",n_);Zy=lSe([nv(1,ue),nv(2,Uo),nv(3,Ft),nv(4,Ei),nv(5,Sq)],Zy);at(Zy.ID,Zy,1);X(class extends de{constructor(){super({id:"codelens.showLensesInCurrentLine",precondition:T.hasCodeLensProvider,label:p("showLensOnLine","Show CodeLens Commands For Current Line"),alias:"Show CodeLens Commands For Current Line"})}async run(e,t){if(!t.hasModel())return;const i=e.get(vr),n=e.get(Ft),s=e.get(Ei),r=t.getSelection().positionLineNumber,a=t.getContribution(Zy.ID);if(!a)return;const l=await a.getModel();if(!l)return;const c=[];for(const u of l.lenses)u.symbol.command&&u.symbol.range.startLineNumber===r&&c.push({label:u.symbol.command.title,command:u.symbol.command});if(c.length===0)return;const d=await i.pick(c,{canPickMany:!1,placeHolder:p("placeHolder","Select a command")});if(!d)return;let h=d.command;if(l.isDisposed){const g=(await a.getModel())?.lenses.find(f=>f.symbol.range.startLineNumber===r&&f.symbol.command?.title===h.title);if(!g||!g.symbol.command)return;h=g.symbol.command}try{await n.executeCommand(h.id,...h.arguments||[])}catch(u){s.error(u)}}});var xq=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},ZO=function(o,e){return function(t,i){e(t,i,o)}};let Yy=class{constructor(e){this._editorWorkerService=e}async provideDocumentColors(e,t){return this._editorWorkerService.computeDefaultDocumentColors(e.uri)}provideColorPresentations(e,t,i){const n=t.range,s=t.color,r=s.alpha,a=new j(new lt(Math.round(255*s.red),Math.round(255*s.green),Math.round(255*s.blue),r)),l=r?j.Format.CSS.formatRGB(a):j.Format.CSS.formatRGBA(a),c=r?j.Format.CSS.formatHSL(a):j.Format.CSS.formatHSLA(a),d=r?j.Format.CSS.formatHex(a):j.Format.CSS.formatHexA(a),h=[];return h.push({label:l,textEdit:{range:n,text:l}}),h.push({label:c,textEdit:{range:n,text:c}}),h.push({label:d,textEdit:{range:n,text:d}}),h}};Yy=xq([ZO(0,Bs)],Yy);let YO=class extends F{constructor(e,t){super(),this._register(e.colorProvider.register("*",new Yy(t)))}};YO=xq([ZO(0,ue),ZO(1,Bs)],YO);vb(YO);async function Lq(o,e,t,i=!0){return _W(new cSe,o,e,t,i)}function kq(o,e,t,i){return Promise.resolve(t.provideColorPresentations(o,e,i))}class cSe{constructor(){}async compute(e,t,i,n){const s=await e.provideDocumentColors(t,i);if(Array.isArray(s))for(const r of s)n.push({colorInfo:r,provider:e});return Array.isArray(s)}}class dSe{constructor(){}async compute(e,t,i,n){const s=await e.provideDocumentColors(t,i);if(Array.isArray(s))for(const r of s)n.push({range:r.range,color:[r.color.red,r.color.green,r.color.blue,r.color.alpha]});return Array.isArray(s)}}class hSe{constructor(e){this.colorInfo=e}async compute(e,t,i,n){const s=await e.provideColorPresentations(t,this.colorInfo,He.None);return Array.isArray(s)&&n.push(...s),Array.isArray(s)}}async function _W(o,e,t,i,n){let s=!1,r;const a=[],l=e.ordered(t);for(let c=l.length-1;c>=0;c--){const d=l[c];if(d instanceof Yy)r=d;else try{await o.compute(d,t,i,a)&&(s=!0)}catch(h){yi(h)}}return s?a:r&&n?(await o.compute(r,t,i,a),a):[]}function Eq(o,e){const{colorProvider:t}=o.get(ue),i=o.get(Ut).getModel(e);if(!i)throw ar();const n=o.get(Ke).getValue("editor.defaultColorDecorators",{resource:e});return{model:i,colorProviderRegistry:t,isDefaultColorDecoratorsEnabled:n}}st.registerCommand("_executeDocumentColorProvider",function(o,...e){const[t]=e;if(!(t instanceof ye))throw ar();const{model:i,colorProviderRegistry:n,isDefaultColorDecoratorsEnabled:s}=Eq(o,t);return _W(new dSe,n,i,He.None,s)});st.registerCommand("_executeColorPresentationProvider",function(o,...e){const[t,i]=e,{uri:n,range:s}=i;if(!(n instanceof ye)||!Array.isArray(t)||t.length!==4||!L.isIRange(s))throw ar();const{model:r,colorProviderRegistry:a,isDefaultColorDecoratorsEnabled:l}=Eq(o,n),[c,d,h,u]=t;return _W(new hSe({range:s,color:{red:c,green:d,blue:h,alpha:u}}),a,r,He.None,l)});var uSe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},_N=function(o,e){return function(t,i){e(t,i,o)}},XO;const Tq=Object.create({});var hh;let H_=(hh=class extends F{constructor(e,t,i,n){super(),this._editor=e,this._configurationService=t,this._languageFeaturesService=i,this._localToDispose=this._register(new $),this._decorationsIds=[],this._colorDatas=new Map,this._colorDecoratorIds=this._editor.createDecorationsCollection(),this._ruleFactory=new Kx(this._editor),this._decoratorLimitReporter=new gSe,this._colorDecorationClassRefs=this._register(new $),this._debounceInformation=n.for(i.colorProvider,"Document Colors",{min:XO.RECOMPUTE_TIME}),this._register(e.onDidChangeModel(()=>{this._isColorDecoratorsEnabled=this.isEnabled(),this.updateColors()})),this._register(e.onDidChangeModelLanguage(()=>this.updateColors())),this._register(i.colorProvider.onDidChange(()=>this.updateColors())),this._register(e.onDidChangeConfiguration(s=>{const r=this._isColorDecoratorsEnabled;this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(148);const a=r!==this._isColorDecoratorsEnabled||s.hasChanged(21),l=s.hasChanged(148);(a||l)&&(this._isColorDecoratorsEnabled?this.updateColors():this.removeAllDecorations())})),this._timeoutTimer=null,this._computePromise=null,this._isColorDecoratorsEnabled=this.isEnabled(),this._isDefaultColorDecoratorsEnabled=this._editor.getOption(148),this.updateColors()}isEnabled(){const e=this._editor.getModel();if(!e)return!1;const t=e.getLanguageId(),i=this._configurationService.getValue(t);if(i&&typeof i=="object"){const n=i.colorDecorators;if(n&&n.enable!==void 0&&!n.enable)return n.enable}return this._editor.getOption(20)}static get(e){return e.getContribution(this.ID)}dispose(){this.stop(),this.removeAllDecorations(),super.dispose()}updateColors(){if(this.stop(),!this._isColorDecoratorsEnabled)return;const e=this._editor.getModel();!e||!this._languageFeaturesService.colorProvider.has(e)||(this._localToDispose.add(this._editor.onDidChangeModelContent(()=>{this._timeoutTimer||(this._timeoutTimer=new qr,this._timeoutTimer.cancelAndSet(()=>{this._timeoutTimer=null,this.beginCompute()},this._debounceInformation.get(e)))})),this.beginCompute())}async beginCompute(){this._computePromise=ji(async e=>{const t=this._editor.getModel();if(!t)return[];const i=new rn(!1),n=await Lq(this._languageFeaturesService.colorProvider,t,e,this._isDefaultColorDecoratorsEnabled);return this._debounceInformation.update(t,i.elapsed()),n});try{const e=await this._computePromise;this.updateDecorations(e),this.updateColorDecorators(e),this._computePromise=null}catch(e){Ae(e)}}stop(){this._timeoutTimer&&(this._timeoutTimer.cancel(),this._timeoutTimer=null),this._computePromise&&(this._computePromise.cancel(),this._computePromise=null),this._localToDispose.clear()}updateDecorations(e){const t=e.map(i=>({range:{startLineNumber:i.colorInfo.range.startLineNumber,startColumn:i.colorInfo.range.startColumn,endLineNumber:i.colorInfo.range.endLineNumber,endColumn:i.colorInfo.range.endColumn},options:Fe.EMPTY}));this._editor.changeDecorations(i=>{this._decorationsIds=i.deltaDecorations(this._decorationsIds,t),this._colorDatas=new Map,this._decorationsIds.forEach((n,s)=>this._colorDatas.set(n,e[s]))})}updateColorDecorators(e){this._colorDecorationClassRefs.clear();const t=[],i=this._editor.getOption(21);for(let s=0;s<e.length&&t.length<i;s++){const{red:r,green:a,blue:l,alpha:c}=e[s].colorInfo.color,d=new lt(Math.round(r*255),Math.round(a*255),Math.round(l*255),c),h=`rgba(${d.r}, ${d.g}, ${d.b}, ${d.a})`,u=this._colorDecorationClassRefs.add(this._ruleFactory.createClassNameRef({backgroundColor:h}));t.push({range:{startLineNumber:e[s].colorInfo.range.startLineNumber,startColumn:e[s].colorInfo.range.startColumn,endLineNumber:e[s].colorInfo.range.endLineNumber,endColumn:e[s].colorInfo.range.endColumn},options:{description:"colorDetector",before:{content:Iz,inlineClassName:`${u.className} colorpicker-color-decoration`,inlineClassNameAffectsLetterSpacing:!0,attachedData:Tq}}})}const n=i<e.length?i:!1;this._decoratorLimitReporter.update(e.length,n),this._colorDecoratorIds.set(t)}removeAllDecorations(){this._editor.removeDecorations(this._decorationsIds),this._decorationsIds=[],this._colorDecoratorIds.clear(),this._colorDecorationClassRefs.clear()}getColorData(e){const t=this._editor.getModel();if(!t)return null;const i=t.getDecorationsInRange(L.fromPositions(e,e)).filter(n=>this._colorDatas.has(n.id));return i.length===0?null:this._colorDatas.get(i[0].id)}isColorDecoration(e){return this._colorDecoratorIds.has(e)}},XO=hh,hh.ID="editor.contrib.colorDetector",hh.RECOMPUTE_TIME=1e3,hh);H_=XO=uSe([_N(1,Ke),_N(2,ue),_N(3,Uo)],H_);class gSe{constructor(){this._onDidChange=new O,this._computed=0,this._limited=!1}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}at(H_.ID,H_,1);class fSe{get color(){return this._color}set color(e){this._color.equals(e)||(this._color=e,this._onDidChangeColor.fire(e))}get presentation(){return this.colorPresentations[this.presentationIndex]}get colorPresentations(){return this._colorPresentations}set colorPresentations(e){this._colorPresentations=e,this.presentationIndex>e.length-1&&(this.presentationIndex=0),this._onDidChangePresentation.fire(this.presentation)}constructor(e,t,i){this.presentationIndex=i,this._onColorFlushed=new O,this.onColorFlushed=this._onColorFlushed.event,this._onDidChangeColor=new O,this.onDidChangeColor=this._onDidChangeColor.event,this._onDidChangePresentation=new O,this.onDidChangePresentation=this._onDidChangePresentation.event,this.originalColor=e,this._color=e,this._colorPresentations=t}selectNextColorPresentation(){this.presentationIndex=(this.presentationIndex+1)%this.colorPresentations.length,this.flushColor(),this._onDidChangePresentation.fire(this.presentation)}guessColorPresentation(e,t){let i=-1;for(let n=0;n<this.colorPresentations.length;n++)if(t.toLowerCase()===this.colorPresentations[n].label){i=n;break}if(i===-1){const n=t.split("(")[0].toLowerCase();for(let s=0;s<this.colorPresentations.length;s++)if(this.colorPresentations[s].label.toLowerCase().startsWith(n)){i=s;break}}i!==-1&&i!==this.presentationIndex&&(this.presentationIndex=i,this._onDidChangePresentation.fire(this.presentation))}flushColor(){this._onColorFlushed.fire(this._color)}}const Do=ie;class pSe extends F{constructor(e,t,i,n=!1){super(),this.model=t,this.showingStandaloneColorPicker=n,this._closeButton=null,this._domNode=Do(".colorpicker-header"),Y(e,this._domNode),this._pickedColorNode=Y(this._domNode,Do(".picked-color")),Y(this._pickedColorNode,Do("span.codicon.codicon-color-mode")),this._pickedColorPresentation=Y(this._pickedColorNode,document.createElement("span")),this._pickedColorPresentation.classList.add("picked-color-presentation");const s=p("clickToToggleColorOptions","Click to toggle color options (rgb/hsl/hex)");this._pickedColorNode.setAttribute("title",s),this._originalColorNode=Y(this._domNode,Do(".original-color")),this._originalColorNode.style.backgroundColor=j.Format.CSS.format(this.model.originalColor)||"",this.backgroundColor=i.getColorTheme().getColor(X0)||j.white,this._register(i.onDidColorThemeChange(r=>{this.backgroundColor=r.getColor(X0)||j.white})),this._register(H(this._pickedColorNode,ee.CLICK,()=>this.model.selectNextColorPresentation())),this._register(H(this._originalColorNode,ee.CLICK,()=>{this.model.color=this.model.originalColor,this.model.flushColor()})),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this._register(t.onDidChangePresentation(this.onDidChangePresentation,this)),this._pickedColorNode.style.backgroundColor=j.Format.CSS.format(t.color)||"",this._pickedColorNode.classList.toggle("light",t.color.rgba.a<.5?this.backgroundColor.isLighter():t.color.isLighter()),this.onDidChangeColor(this.model.color),this.showingStandaloneColorPicker&&(this._domNode.classList.add("standalone-colorpicker"),this._closeButton=this._register(new mSe(this._domNode)))}get closeButton(){return this._closeButton}get pickedColorNode(){return this._pickedColorNode}get originalColorNode(){return this._originalColorNode}onDidChangeColor(e){this._pickedColorNode.style.backgroundColor=j.Format.CSS.format(e)||"",this._pickedColorNode.classList.toggle("light",e.rgba.a<.5?this.backgroundColor.isLighter():e.isLighter()),this.onDidChangePresentation()}onDidChangePresentation(){this._pickedColorPresentation.textContent=this.model.presentation?this.model.presentation.label:""}}class mSe extends F{constructor(e){super(),this._onClicked=this._register(new O),this.onClicked=this._onClicked.event,this._button=document.createElement("div"),this._button.classList.add("close-button"),Y(e,this._button);const t=document.createElement("div");t.classList.add("close-button-inner-div"),Y(this._button,t),Y(t,Do(".button"+ke.asCSSSelector(Gt("color-picker-close",J.close,p("closeIcon","Icon to close the color picker"))))).classList.add("close-icon"),this._register(H(this._button,ee.CLICK,()=>{this._onClicked.fire()}))}}class _Se extends F{constructor(e,t,i,n=!1){super(),this.model=t,this.pixelRatio=i,this._insertButton=null,this._domNode=Do(".colorpicker-body"),Y(e,this._domNode),this._saturationBox=new bSe(this._domNode,this.model,this.pixelRatio),this._register(this._saturationBox),this._register(this._saturationBox.onDidChange(this.onDidSaturationValueChange,this)),this._register(this._saturationBox.onColorFlushed(this.flushColor,this)),this._opacityStrip=new vSe(this._domNode,this.model,n),this._register(this._opacityStrip),this._register(this._opacityStrip.onDidChange(this.onDidOpacityChange,this)),this._register(this._opacityStrip.onColorFlushed(this.flushColor,this)),this._hueStrip=new CSe(this._domNode,this.model,n),this._register(this._hueStrip),this._register(this._hueStrip.onDidChange(this.onDidHueChange,this)),this._register(this._hueStrip.onColorFlushed(this.flushColor,this)),n&&(this._insertButton=this._register(new ySe(this._domNode)),this._domNode.classList.add("standalone-colorpicker"))}flushColor(){this.model.flushColor()}onDidSaturationValueChange({s:e,v:t}){const i=this.model.color.hsva;this.model.color=new j(new yl(i.h,e,t,i.a))}onDidOpacityChange(e){const t=this.model.color.hsva;this.model.color=new j(new yl(t.h,t.s,t.v,e))}onDidHueChange(e){const t=this.model.color.hsva,i=(1-e)*360;this.model.color=new j(new yl(i===360?0:i,t.s,t.v,t.a))}get domNode(){return this._domNode}get saturationBox(){return this._saturationBox}get enterButton(){return this._insertButton}layout(){this._saturationBox.layout(),this._opacityStrip.layout(),this._hueStrip.layout()}}class bSe extends F{constructor(e,t,i){super(),this.model=t,this.pixelRatio=i,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new O,this.onColorFlushed=this._onColorFlushed.event,this._domNode=Do(".saturation-wrap"),Y(e,this._domNode),this._canvas=document.createElement("canvas"),this._canvas.className="saturation-box",Y(this._domNode,this._canvas),this.selection=Do(".saturation-selection"),Y(this._domNode,this.selection),this.layout(),this._register(H(this._domNode,ee.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(this.model.onDidChangeColor(this.onDidChangeColor,this)),this.monitor=null}get domNode(){return this._domNode}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;this.monitor=this._register(new cb);const t=Ci(this._domNode);e.target!==this.selection&&this.onDidChangePosition(e.offsetX,e.offsetY),this.monitor.startMonitoring(e.target,e.pointerId,e.buttons,n=>this.onDidChangePosition(n.pageX-t.left,n.pageY-t.top),()=>null);const i=H(e.target.ownerDocument,ee.POINTER_UP,()=>{this._onColorFlushed.fire(),i.dispose(),this.monitor&&(this.monitor.stopMonitoring(!0),this.monitor=null)},!0)}onDidChangePosition(e,t){const i=Math.max(0,Math.min(1,e/this.width)),n=Math.max(0,Math.min(1,1-t/this.height));this.paintSelection(i,n),this._onDidChange.fire({s:i,v:n})}layout(){this.width=this._domNode.offsetWidth,this.height=this._domNode.offsetHeight,this._canvas.width=this.width*this.pixelRatio,this._canvas.height=this.height*this.pixelRatio,this.paint();const e=this.model.color.hsva;this.paintSelection(e.s,e.v)}paint(){const e=this.model.color.hsva,t=new j(new yl(e.h,1,1,1)),i=this._canvas.getContext("2d"),n=i.createLinearGradient(0,0,this._canvas.width,0);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),n.addColorStop(1,"rgba(255, 255, 255, 0)");const s=i.createLinearGradient(0,0,0,this._canvas.height);s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(1,"rgba(0, 0, 0, 1)"),i.rect(0,0,this._canvas.width,this._canvas.height),i.fillStyle=j.Format.CSS.format(t),i.fill(),i.fillStyle=n,i.fill(),i.fillStyle=s,i.fill()}paintSelection(e,t){this.selection.style.left=`${e*this.width}px`,this.selection.style.top=`${this.height-t*this.height}px`}onDidChangeColor(e){if(this.monitor&&this.monitor.isMonitoring())return;this.paint();const t=e.hsva;this.paintSelection(t.s,t.v)}}class Dq extends F{constructor(e,t,i=!1){super(),this.model=t,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._onColorFlushed=new O,this.onColorFlushed=this._onColorFlushed.event,i?(this.domNode=Y(e,Do(".standalone-strip")),this.overlay=Y(this.domNode,Do(".standalone-overlay"))):(this.domNode=Y(e,Do(".strip")),this.overlay=Y(this.domNode,Do(".overlay"))),this.slider=Y(this.domNode,Do(".slider")),this.slider.style.top="0px",this._register(H(this.domNode,ee.POINTER_DOWN,n=>this.onPointerDown(n))),this._register(t.onDidChangeColor(this.onDidChangeColor,this)),this.layout()}layout(){this.height=this.domNode.offsetHeight-this.slider.offsetHeight;const e=this.getValue(this.model.color);this.updateSliderPosition(e)}onDidChangeColor(e){const t=this.getValue(e);this.updateSliderPosition(t)}onPointerDown(e){if(!e.target||!(e.target instanceof Element))return;const t=this._register(new cb),i=Ci(this.domNode);this.domNode.classList.add("grabbing"),e.target!==this.slider&&this.onDidChangeTop(e.offsetY),t.startMonitoring(e.target,e.pointerId,e.buttons,s=>this.onDidChangeTop(s.pageY-i.top),()=>null);const n=H(e.target.ownerDocument,ee.POINTER_UP,()=>{this._onColorFlushed.fire(),n.dispose(),t.stopMonitoring(!0),this.domNode.classList.remove("grabbing")},!0)}onDidChangeTop(e){const t=Math.max(0,Math.min(1,1-e/this.height));this.updateSliderPosition(t),this._onDidChange.fire(t)}updateSliderPosition(e){this.slider.style.top=`${(1-e)*this.height}px`}}class vSe extends Dq{constructor(e,t,i=!1){super(e,t,i),this.domNode.classList.add("opacity-strip"),this.onDidChangeColor(this.model.color)}onDidChangeColor(e){super.onDidChangeColor(e);const{r:t,g:i,b:n}=e.rgba,s=new j(new lt(t,i,n,1)),r=new j(new lt(t,i,n,0));this.overlay.style.background=`linear-gradient(to bottom, ${s} 0%, ${r} 100%)`}getValue(e){return e.hsva.a}}class CSe extends Dq{constructor(e,t,i=!1){super(e,t,i),this.domNode.classList.add("hue-strip")}getValue(e){return 1-e.hsva.h/360}}class ySe extends F{constructor(e){super(),this._onClicked=this._register(new O),this.onClicked=this._onClicked.event,this._button=Y(e,document.createElement("button")),this._button.classList.add("insert-button"),this._button.textContent="Insert",this._register(H(this._button,ee.CLICK,()=>{this._onClicked.fire()}))}get button(){return this._button}}class wSe extends Go{constructor(e,t,i,n,s=!1){super(),this.model=t,this.pixelRatio=i,this._register(YC.getInstance(xe(e)).onDidChange(()=>this.layout())),this._domNode=Do(".colorpicker-widget"),e.appendChild(this._domNode),this.header=this._register(new pSe(this._domNode,this.model,n,s)),this.body=this._register(new _Se(this._domNode,this.model,this.pixelRatio,s))}layout(){this.body.layout()}get domNode(){return this._domNode}}class bN{constructor(e,t,i,n){this.priority=e,this.range=t,this.initialMousePosX=i,this.initialMousePosY=n,this.type=1}equals(e){return e.type===1&&this.range.equalsRange(e.range)}canAdoptVisibleHover(e,t){return e.type===1&&t.lineNumber===this.range.startLineNumber}}class i0{constructor(e,t,i,n,s,r){this.priority=e,this.owner=t,this.range=i,this.initialMousePosX=n,this.initialMousePosY=s,this.supportsMarkerHover=r,this.type=2}equals(e){return e.type===2&&this.owner===e.owner}canAdoptVisibleHover(e,t){return e.type===2&&this.owner===e.owner}}class Ff{constructor(e){this.renderedHoverParts=e}dispose(){for(const e of this.renderedHoverParts)e.dispose()}}const np=new class{constructor(){this._participants=[]}register(e){this._participants.push(e)}getAll(){return this._participants}};var Iq=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Nq=function(o,e){return function(t,i){e(t,i,o)}};class SSe{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n,this.forceShowAtRange=!0}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let Xy=class{constructor(e,t){this._editor=e,this._themeService=t,this.hoverOrdinal=2}computeSync(e,t){return[]}computeAsync(e,t,i){return No.fromPromise(this._computeAsync(e,t,i))}async _computeAsync(e,t,i){if(!this._editor.hasModel())return[];const n=H_.get(this._editor);if(!n)return[];for(const s of t){if(!n.isColorDecoration(s))continue;const r=n.getColorData(s.range.getStartPosition());if(r)return[await Rq(this,this._editor.getModel(),r.colorInfo,r.provider)]}return[]}renderHoverParts(e,t){const i=Pq(this,this._editor,this._themeService,t,e);if(!i)return new Ff([]);this._colorPicker=i.colorPicker;const n={hoverPart:i.hoverPart,hoverElement:this._colorPicker.domNode,dispose(){i.disposables.dispose()}};return new Ff([n])}handleResize(){this._colorPicker?.layout()}isColorPickerVisible(){return!!this._colorPicker}};Xy=Iq([Nq(1,zi)],Xy);class xSe{constructor(e,t,i,n){this.owner=e,this.range=t,this.model=i,this.provider=n}}let Qy=class{constructor(e,t){this._editor=e,this._themeService=t,this._color=null}async createColorHover(e,t,i){if(!this._editor.hasModel()||!H_.get(this._editor))return null;const s=await Lq(i,this._editor.getModel(),He.None);let r=null,a=null;for(const h of s){const u=h.colorInfo;L.containsRange(u.range,e.range)&&(r=u,a=h.provider)}const l=r??e,c=a??t,d=!!r;return{colorHover:await Rq(this,this._editor.getModel(),l,c),foundInEditor:d}}async updateEditorModel(e){if(!this._editor.hasModel())return;const t=e.model;let i=new L(e.range.startLineNumber,e.range.startColumn,e.range.endLineNumber,e.range.endColumn);this._color&&(await n0(this._editor.getModel(),t,this._color,i,e),i=Aq(this._editor,i,t))}renderHoverParts(e,t){return Pq(this,this._editor,this._themeService,t,e)}set color(e){this._color=e}get color(){return this._color}};Qy=Iq([Nq(1,zi)],Qy);async function Rq(o,e,t,i){const n=e.getValueInRange(t.range),{red:s,green:r,blue:a,alpha:l}=t.color,c=new lt(Math.round(s*255),Math.round(r*255),Math.round(a*255),l),d=new j(c),h=await kq(e,t,i,He.None),u=new fSe(d,[],0);return u.colorPresentations=h||[],u.guessColorPresentation(d,n),o instanceof Xy?new SSe(o,L.lift(t.range),u,i):new xSe(o,L.lift(t.range),u,i)}function Pq(o,e,t,i,n){if(i.length===0||!e.hasModel())return;if(n.setMinimumDimensions){const u=e.getOption(67)+8;n.setMinimumDimensions(new wt(302,u))}const s=new $,r=i[0],a=e.getModel(),l=r.model,c=s.add(new wSe(n.fragment,l,e.getOption(144),t,o instanceof Qy));let d=!1,h=new L(r.range.startLineNumber,r.range.startColumn,r.range.endLineNumber,r.range.endColumn);if(o instanceof Qy){const u=r.model.color;o.color=u,n0(a,l,u,h,r),s.add(l.onColorFlushed(g=>{o.color=g}))}else s.add(l.onColorFlushed(async u=>{await n0(a,l,u,h,r),d=!0,h=Aq(e,h,l)}));return s.add(l.onDidChangeColor(u=>{n0(a,l,u,h,r)})),s.add(e.onDidChangeModelContent(u=>{d?d=!1:(n.hide(),e.focus())})),{hoverPart:r,colorPicker:c,disposables:s}}function Aq(o,e,t){const i=[],n=t.presentation.textEdit??{range:e,text:t.presentation.label,forceMoveMarkers:!1};i.push(n),t.presentation.additionalTextEdits&&i.push(...t.presentation.additionalTextEdits);const s=L.lift(n.range),r=o.getModel()._setTrackedRange(null,s,3);return o.executeEdits("colorpicker",i),o.pushUndoStop(),o.getModel()._getTrackedRange(r)??s}async function n0(o,e,t,i,n){const s=await kq(o,{range:i,color:{red:t.rgba.r/255,green:t.rgba.g/255,blue:t.rgba.b/255,alpha:t.rgba.a}},n.provider,He.None);e.colorPresentations=s||[]}const Mq="editor.action.showHover",LSe="editor.action.showDefinitionPreviewHover",kSe="editor.action.scrollUpHover",ESe="editor.action.scrollDownHover",TSe="editor.action.scrollLeftHover",DSe="editor.action.scrollRightHover",ISe="editor.action.pageUpHover",NSe="editor.action.pageDownHover",RSe="editor.action.goToTopHover",PSe="editor.action.goToBottomHover",bD="editor.action.increaseHoverVerbosityLevel",ASe=p({key:"increaseHoverVerbosityLevel",comment:["Label for action that will increase the hover verbosity level."]},"Increase Hover Verbosity Level"),vD="editor.action.decreaseHoverVerbosityLevel",MSe=p({key:"decreaseHoverVerbosityLevel",comment:["Label for action that will decrease the hover verbosity level."]},"Decrease Hover Verbosity Level"),Oq="editor.action.inlineSuggest.commit",Fq="editor.action.inlineSuggest.showPrevious",Bq="editor.action.inlineSuggest.showNext";var bW=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Pr=function(o,e){return function(t,i){e(t,i,o)}},s0;let QO=class extends F{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=yt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).showToolbar==="always"),this.sessionPosition=void 0,this.position=me(this,n=>{const s=this.model.read(n)?.primaryGhostText.read(n);if(!this.alwaysShowToolbar.read(n)||!s||s.parts.length===0)return this.sessionPosition=void 0,null;const r=s.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==s.lineNumber&&(this.sessionPosition=void 0);const a=new A(s.lineNumber,Math.min(r,this.sessionPosition?.column??Number.MAX_SAFE_INTEGER));return this.sessionPosition=a,a}),this._register(Is((n,s)=>{const r=this.model.read(n);if(!r||!this.alwaysShowToolbar.read(n))return;const a=Xh((c,d)=>{const h=d.add(this.instantiationService.createInstance(z_,this.editor,!0,this.position,r.selectedInlineCompletionIndex,r.inlineCompletionsCount,r.activeCommands));return e.addContentWidget(h),d.add(ve(()=>e.removeContentWidget(h))),d.add(Re(u=>{this.position.read(u)&&r.lastTriggerKind.read(u)!==wa.Explicit&&r.triggerExplicitly()})),h}),l=Bw(this,(c,d)=>!!this.position.read(c)||!!d);s.add(Re(c=>{l.read(c)&&a.read(c)}))}))}};QO=bW([Pr(2,Ce)],QO);const OSe=Gt("inline-suggestion-hints-next",J.chevronRight,p("parameterHintsNextIcon","Icon for show next parameter hint.")),FSe=Gt("inline-suggestion-hints-previous",J.chevronLeft,p("parameterHintsPreviousIcon","Icon for show previous parameter hint."));var uh;let z_=(uh=class extends F{static get dropDownVisible(){return this._dropDownVisible}createCommandAction(e,t,i){const n=new to(e,t,i,!0,()=>this._commandService.executeCommand(e)),s=this.keybindingService.lookupKeybinding(e,this._contextKeyService);let r=t;return s&&(r=p({key:"content",comment:["A label","A keybinding"]},"{0} ({1})",t,s.getLabel())),n.tooltip=r,n}constructor(e,t,i,n,s,r,a,l,c,d,h){super(),this.editor=e,this.withBorder=t,this._position=i,this._currentSuggestionIdx=n,this._suggestionCount=s,this._extraCommands=r,this._commandService=a,this.keybindingService=c,this._contextKeyService=d,this._menuService=h,this.id=`InlineSuggestionHintsContentWidget${s0.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=Ye("div.inlineSuggestionsHints",{className:this.withBorder?".withBorder":""},[Ye("div@toolBar")]),this.previousAction=this.createCommandAction(Fq,p("previous","Previous"),ke.asClassName(FSe)),this.availableSuggestionCountAction=new to("inlineSuggestionHints.availableSuggestionCount","",void 0,!1),this.nextAction=this.createCommandAction(Bq,p("next","Next"),ke.asClassName(OSe)),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(fe.InlineCompletionsActions,this._contextKeyService)),this.clearAvailableSuggestionCountLabelDebounced=this._register(new xt(()=>{this.availableSuggestionCountAction.label=""},100)),this.disableButtonsDebounced=this._register(new xt(()=>{this.previousAction.enabled=this.nextAction.enabled=!1},100)),this.toolBar=this._register(l.createInstance(JO,this.nodes.toolBar,fe.InlineSuggestionToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:u=>u.startsWith("primary")},actionViewItemProvider:(u,g)=>{if(u instanceof io)return l.createInstance(WSe,u,void 0);if(u===this.availableSuggestionCountAction){const f=new BSe(void 0,u,{label:!0,icon:!1});return f.setClass("availableSuggestionCount"),f}},telemetrySource:"InlineSuggestionToolbar"})),this.toolBar.setPrependedPrimaryActions([this.previousAction,this.availableSuggestionCountAction,this.nextAction]),this._register(this.toolBar.onDidChangeDropdownVisibility(u=>{s0._dropDownVisible=u})),this._register(Re(u=>{this._position.read(u),this.editor.layoutContentWidget(this)})),this._register(Re(u=>{const g=this._suggestionCount.read(u),f=this._currentSuggestionIdx.read(u);g!==void 0?(this.clearAvailableSuggestionCountLabelDebounced.cancel(),this.availableSuggestionCountAction.label=`${f+1}/${g}`):this.clearAvailableSuggestionCountLabelDebounced.schedule(),g!==void 0&&g>1?(this.disableButtonsDebounced.cancel(),this.previousAction.enabled=this.nextAction.enabled=!0):this.disableButtonsDebounced.schedule()})),this._register(Re(u=>{const f=this._extraCommands.read(u).map(m=>({class:void 0,id:m.id,enabled:!0,tooltip:m.tooltip||"",label:m.title,run:_=>this._commandService.executeCommand(m.id)}));for(const[m,_]of this.inlineCompletionsActionsMenus.getActions())for(const b of _)b instanceof io&&f.push(b);f.length>0&&f.unshift(new Zi),this.toolBar.setAdditionalSecondaryActions(f)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}},s0=uh,uh._dropDownVisible=!1,uh.id=0,uh);z_=s0=bW([Pr(6,Ft),Pr(7,Ce),Pr(8,vt),Pr(9,Ee),Pr(10,zo)],z_);class BSe extends I_{constructor(){super(...arguments),this._className=void 0}setClass(e){this._className=e}render(e){super.render(e),this._className&&e.classList.add(this._className)}updateTooltip(){}}let WSe=class extends Fh{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Ye("div.keybinding").root;this._register(new _b(t,Js,{disableTitle:!0,...mK})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineSuggestionStatusBarItemLabel")}}updateTooltip(){}},JO=class extends Hy{constructor(e,t,i,n,s,r,a,l,c){super(e,{resetMenu:t,...i},n,s,r,a,l,c),this.menuId=t,this.options2=i,this.menuService=n,this.contextKeyService=s,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){const e=[],t=[];$T(this.menu,this.options2?.menuOptions,{primary:e,secondary:t},this.options2?.toolbarOptions?.primaryGroup,this.options2?.toolbarOptions?.shouldInlineSubmenu,this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions),t.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),this.setActions(e,t)}setPrependedPrimaryActions(e){ei(this.prependedPrimaryActions,e,(t,i)=>t===i)||(this.prependedPrimaryActions=e,this.updateToolbar())}setAdditionalSecondaryActions(e){ei(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};JO=bW([Pr(3,zo),Pr(4,Ee),Pr(5,co),Pr(6,vt),Pr(7,Ft),Pr(8,Fn)],JO);function CD(o,e,t){const i=Ci(o);return!(e<i.left||e>i.left+i.width||t<i.top||t>i.top+i.height)}let VSe=class{constructor(e,t,i){this.value=e,this.isComplete=t,this.hasLoadingMessage=i}};class Wq extends F{constructor(e,t){super(),this._editor=e,this._computer=t,this._onResult=this._register(new O),this.onResult=this._onResult.event,this._firstWaitScheduler=this._register(new xt(()=>this._triggerAsyncComputation(),0)),this._secondWaitScheduler=this._register(new xt(()=>this._triggerSyncComputation(),0)),this._loadingMessageScheduler=this._register(new xt(()=>this._triggerLoadingMessage(),0)),this._state=0,this._asyncIterable=null,this._asyncIterableDone=!1,this._result=[]}dispose(){this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),super.dispose()}get _hoverTime(){return this._editor.getOption(60).delay}get _firstWaitTime(){return this._hoverTime/2}get _secondWaitTime(){return this._hoverTime-this._firstWaitTime}get _loadingMessageTime(){return 3*this._hoverTime}_setState(e,t=!0){this._state=e,t&&this._fireResult()}_triggerAsyncComputation(){this._setState(2),this._secondWaitScheduler.schedule(this._secondWaitTime),this._computer.computeAsync?(this._asyncIterableDone=!1,this._asyncIterable=fJ(e=>this._computer.computeAsync(e)),(async()=>{try{for await(const e of this._asyncIterable)e&&(this._result.push(e),this._fireResult());this._asyncIterableDone=!0,(this._state===3||this._state===4)&&this._setState(0)}catch(e){Ae(e)}})()):this._asyncIterableDone=!0}_triggerSyncComputation(){this._computer.computeSync&&(this._result=this._result.concat(this._computer.computeSync())),this._setState(this._asyncIterableDone?0:3)}_triggerLoadingMessage(){this._state===3&&this._setState(4)}_fireResult(){if(this._state===1||this._state===2)return;const e=this._state===0,t=this._state===4;this._onResult.fire(new VSe(this._result.slice(0),e,t))}start(e){if(e===0)this._state===0&&(this._setState(1),this._firstWaitScheduler.schedule(this._firstWaitTime),this._loadingMessageScheduler.schedule(this._loadingMessageTime));else switch(this._state){case 0:this._triggerAsyncComputation(),this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break;case 2:this._secondWaitScheduler.cancel(),this._triggerSyncComputation();break}}cancel(){this._firstWaitScheduler.cancel(),this._secondWaitScheduler.cancel(),this._loadingMessageScheduler.cancel(),this._asyncIterable&&(this._asyncIterable.cancel(),this._asyncIterable=null),this._result=[],this._setState(0,!1)}}class vW{constructor(){this._onDidWillResize=new O,this.onDidWillResize=this._onDidWillResize.event,this._onDidResize=new O,this.onDidResize=this._onDidResize.event,this._sashListener=new $,this._size=new wt(0,0),this._minSize=new wt(0,0),this._maxSize=new wt(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),this.domNode=document.createElement("div"),this._eastSash=new Nn(this.domNode,{getVerticalSashLeft:()=>this._size.width},{orientation:0}),this._westSash=new Nn(this.domNode,{getVerticalSashLeft:()=>0},{orientation:0}),this._northSash=new Nn(this.domNode,{getHorizontalSashTop:()=>0},{orientation:1,orthogonalEdge:kx.North}),this._southSash=new Nn(this.domNode,{getHorizontalSashTop:()=>this._size.height},{orientation:1,orthogonalEdge:kx.South}),this._northSash.orthogonalStartSash=this._westSash,this._northSash.orthogonalEndSash=this._eastSash,this._southSash.orthogonalStartSash=this._westSash,this._southSash.orthogonalEndSash=this._eastSash;let e,t=0,i=0;this._sashListener.add(se.any(this._northSash.onDidStart,this._eastSash.onDidStart,this._southSash.onDidStart,this._westSash.onDidStart)(()=>{e===void 0&&(this._onDidWillResize.fire(),e=this._size,t=0,i=0)})),this._sashListener.add(se.any(this._northSash.onDidEnd,this._eastSash.onDidEnd,this._southSash.onDidEnd,this._westSash.onDidEnd)(()=>{e!==void 0&&(e=void 0,t=0,i=0,this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(this._eastSash.onDidChange(n=>{e&&(i=n.currentX-n.startX,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,east:!0}))})),this._sashListener.add(this._westSash.onDidChange(n=>{e&&(i=-(n.currentX-n.startX),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,west:!0}))})),this._sashListener.add(this._northSash.onDidChange(n=>{e&&(t=-(n.currentY-n.startY),this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,north:!0}))})),this._sashListener.add(this._southSash.onDidChange(n=>{e&&(t=n.currentY-n.startY,this.layout(e.height+t,e.width+i),this._onDidResize.fire({dimension:this._size,done:!1,south:!0}))})),this._sashListener.add(se.any(this._eastSash.onDidReset,this._westSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._size.height,this._preferredSize.width),this._onDidResize.fire({dimension:this._size,done:!0}))})),this._sashListener.add(se.any(this._northSash.onDidReset,this._southSash.onDidReset)(n=>{this._preferredSize&&(this.layout(this._preferredSize.height,this._size.width),this._onDidResize.fire({dimension:this._size,done:!0}))}))}dispose(){this._northSash.dispose(),this._southSash.dispose(),this._eastSash.dispose(),this._westSash.dispose(),this._sashListener.dispose(),this._onDidResize.dispose(),this._onDidWillResize.dispose(),this.domNode.remove()}enableSashes(e,t,i,n){this._northSash.state=e?3:0,this._eastSash.state=t?3:0,this._southSash.state=i?3:0,this._westSash.state=n?3:0}layout(e=this.size.height,t=this.size.width){const{height:i,width:n}=this._minSize,{height:s,width:r}=this._maxSize;e=Math.max(i,Math.min(s,e)),t=Math.max(n,Math.min(r,t));const a=new wt(t,e);wt.equals(a,this._size)||(this.domNode.style.height=e+"px",this.domNode.style.width=t+"px",this._size=a,this._northSash.layout(),this._eastSash.layout(),this._southSash.layout(),this._westSash.layout())}clearSashHoverState(){this._eastSash.clearSashHoverState(),this._westSash.clearSashHoverState(),this._northSash.clearSashHoverState(),this._southSash.clearSashHoverState()}get size(){return this._size}set maxSize(e){this._maxSize=e}get maxSize(){return this._maxSize}set minSize(e){this._minSize=e}get minSize(){return this._minSize}set preferredSize(e){this._preferredSize=e}get preferredSize(){return this._preferredSize}}const HSe=30,zSe=24;class USe extends F{constructor(e,t=new wt(10,10)){super(),this._editor=e,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._resizableNode=this._register(new vW),this._contentPosition=null,this._isResizing=!1,this._resizableNode.domNode.style.position="absolute",this._resizableNode.minSize=wt.lift(t),this._resizableNode.layout(t.height,t.width),this._resizableNode.enableSashes(!0,!0,!0,!0),this._register(this._resizableNode.onDidResize(i=>{this._resize(new wt(i.dimension.width,i.dimension.height)),i.done&&(this._isResizing=!1)})),this._register(this._resizableNode.onDidWillResize(()=>{this._isResizing=!0}))}get isResizing(){return this._isResizing}getDomNode(){return this._resizableNode.domNode}getPosition(){return this._contentPosition}get position(){return this._contentPosition?.position?A.lift(this._contentPosition.position):void 0}_availableVerticalSpaceAbove(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);return!t||!i?void 0:Ci(t).top+i.top-HSe}_availableVerticalSpaceBelow(e){const t=this._editor.getDomNode(),i=this._editor.getScrolledVisiblePosition(e);if(!t||!i)return;const n=Ci(t),s=Ph(t.ownerDocument.body),r=n.top+i.top+i.height;return s.height-r-zSe}_findPositionPreference(e,t){const i=Math.min(this._availableVerticalSpaceBelow(t)??1/0,e),n=Math.min(this._availableVerticalSpaceAbove(t)??1/0,e),s=Math.min(Math.max(n,i),e),r=Math.min(e,s);let a;return this._editor.getOption(60).above?a=r<=n?1:2:a=r<=i?2:1,a===1?this._resizableNode.enableSashes(!0,!0,!1,!1):this._resizableNode.enableSashes(!1,!0,!0,!1),a}_resize(e){this._resizableNode.layout(e.height,e.width)}}var GSe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},n1=function(o,e){return function(t,i){e(t,i,o)}},Ja;const _8=30,$Se=6;var gh;let e2=(gh=class extends USe{get isVisibleFromKeyboard(){return this._renderedHover?.source===1}get isVisible(){return this._hoverVisibleKey.get()??!1}get isFocused(){return this._hoverFocusedKey.get()??!1}constructor(e,t,i,n,s){const r=e.getOption(67)+8,a=150,l=new wt(a,r);super(e,l),this._configurationService=i,this._accessibilityService=n,this._keybindingService=s,this._hover=this._register(new v5),this._onDidResize=this._register(new O),this.onDidResize=this._onDidResize.event,this._minimumSize=l,this._hoverVisibleKey=T.hoverVisible.bindTo(t),this._hoverFocusedKey=T.hoverFocused.bindTo(t),Y(this._resizableNode.domNode,this._hover.containerDomNode),this._resizableNode.domNode.style.zIndex="50",this._register(this._editor.onDidLayoutChange(()=>{this.isVisible&&this._updateMaxDimensions()})),this._register(this._editor.onDidChangeConfiguration(d=>{d.hasChanged(50)&&this._updateFont()}));const c=this._register(Ia(this._resizableNode.domNode));this._register(c.onDidFocus(()=>{this._hoverFocusedKey.set(!0)})),this._register(c.onDidBlur(()=>{this._hoverFocusedKey.set(!1)})),this._setRenderedHover(void 0),this._editor.addContentWidget(this)}dispose(){super.dispose(),this._renderedHover?.dispose(),this._editor.removeContentWidget(this)}getId(){return Ja.ID}static _applyDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,s=typeof i=="number"?`${i}px`:i;e.style.width=n,e.style.height=s}_setContentsDomNodeDimensions(e,t){const i=this._hover.contentsDomNode;return Ja._applyDimensions(i,e,t)}_setContainerDomNodeDimensions(e,t){const i=this._hover.containerDomNode;return Ja._applyDimensions(i,e,t)}_setHoverWidgetDimensions(e,t){this._setContentsDomNodeDimensions(e,t),this._setContainerDomNodeDimensions(e,t),this._layoutContentWidget()}static _applyMaxDimensions(e,t,i){const n=typeof t=="number"?`${t}px`:t,s=typeof i=="number"?`${i}px`:i;e.style.maxWidth=n,e.style.maxHeight=s}_setHoverWidgetMaxDimensions(e,t){Ja._applyMaxDimensions(this._hover.contentsDomNode,e,t),Ja._applyMaxDimensions(this._hover.containerDomNode,e,t),this._hover.containerDomNode.style.setProperty("--vscode-hover-maxWidth",typeof e=="number"?`${e}px`:e),this._layoutContentWidget()}_setAdjustedHoverWidgetDimensions(e){this._setHoverWidgetMaxDimensions("none","none");const t=e.width,i=e.height;this._setHoverWidgetDimensions(t,i)}_updateResizableNodeMaxDimensions(){const e=this._findMaximumRenderingWidth()??1/0,t=this._findMaximumRenderingHeight()??1/0;this._resizableNode.maxSize=new wt(e,t),this._setHoverWidgetMaxDimensions(e,t)}_resize(e){Ja._lastDimensions=new wt(e.width,e.height),this._setAdjustedHoverWidgetDimensions(e),this._resizableNode.layout(e.height,e.width),this._updateResizableNodeMaxDimensions(),this._hover.scrollbar.scanDomNode(),this._editor.layoutContentWidget(this),this._onDidResize.fire()}_findAvailableSpaceVertically(){const e=this._renderedHover?.showAtPosition;if(e)return this._positionPreference===1?this._availableVerticalSpaceAbove(e):this._availableVerticalSpaceBelow(e)}_findMaximumRenderingHeight(){const e=this._findAvailableSpaceVertically();if(!e)return;let t=$Se;return Array.from(this._hover.contentsDomNode.children).forEach(i=>{t+=i.clientHeight}),Math.min(e,t)}_isHoverTextOverflowing(){this._hover.containerDomNode.style.setProperty("--vscode-hover-whiteSpace","nowrap"),this._hover.containerDomNode.style.setProperty("--vscode-hover-sourceWhiteSpace","nowrap");const e=Array.from(this._hover.contentsDomNode.children).some(t=>t.scrollWidth>t.clientWidth);return this._hover.containerDomNode.style.removeProperty("--vscode-hover-whiteSpace"),this._hover.containerDomNode.style.removeProperty("--vscode-hover-sourceWhiteSpace"),e}_findMaximumRenderingWidth(){if(!this._editor||!this._editor.hasModel())return;const e=this._isHoverTextOverflowing(),t=typeof this._contentWidth>"u"?0:this._contentWidth-2;return e||this._hover.containerDomNode.clientWidth<t?Ph(this._hover.containerDomNode.ownerDocument.body).width-14:this._hover.containerDomNode.clientWidth+2}isMouseGettingCloser(e,t){if(!this._renderedHover)return!1;if(this._renderedHover.initialMousePosX===void 0||this._renderedHover.initialMousePosY===void 0)return this._renderedHover.initialMousePosX=e,this._renderedHover.initialMousePosY=t,!1;const i=Ci(this.getDomNode());this._renderedHover.closestMouseDistance===void 0&&(this._renderedHover.closestMouseDistance=b8(this._renderedHover.initialMousePosX,this._renderedHover.initialMousePosY,i.left,i.top,i.width,i.height));const n=b8(e,t,i.left,i.top,i.width,i.height);return n>this._renderedHover.closestMouseDistance+4?!1:(this._renderedHover.closestMouseDistance=Math.min(this._renderedHover.closestMouseDistance,n),!0)}_setRenderedHover(e){this._renderedHover?.dispose(),this._renderedHover=e,this._hoverVisibleKey.set(!!e),this._hover.containerDomNode.classList.toggle("hidden",!e)}_updateFont(){const{fontSize:e,lineHeight:t}=this._editor.getOption(50),i=this._hover.contentsDomNode;i.style.fontSize=`${e}px`,i.style.lineHeight=`${t/e}`,Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(s=>this._editor.applyFontInfo(s))}_updateContent(e){const t=this._hover.contentsDomNode;t.style.paddingBottom="",t.textContent="",t.appendChild(e)}_layoutContentWidget(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged()}_updateMaxDimensions(){const e=Math.max(this._editor.getLayoutInfo().height/4,250,Ja._lastDimensions.height),t=Math.max(this._editor.getLayoutInfo().width*.66,500,Ja._lastDimensions.width);this._setHoverWidgetMaxDimensions(t,e)}_render(e){this._setRenderedHover(e),this._updateFont(),this._updateContent(e.domNode),this._updateMaxDimensions(),this.onContentsChanged(),this._editor.render()}getPosition(){return this._renderedHover?{position:this._renderedHover.showAtPosition,secondaryPosition:this._renderedHover.showAtSecondaryPosition,positionAffinity:this._renderedHover.shouldAppearBeforeContent?3:void 0,preference:[this._positionPreference??1]}:null}show(e){if(!this._editor||!this._editor.hasModel())return;this._render(e);const t=xc(this._hover.containerDomNode),i=e.showAtPosition;this._positionPreference=this._findPositionPreference(t,i)??1,this.onContentsChanged(),e.shouldFocus&&this._hover.containerDomNode.focus(),this._onDidResize.fire();const s=this._hover.containerDomNode.ownerDocument.activeElement===this._hover.containerDomNode&&CG(this._configurationService.getValue("accessibility.verbosity.hover")===!0&&this._accessibilityService.isScreenReaderOptimized(),this._keybindingService.lookupKeybinding("editor.action.accessibleView")?.getAriaLabel()??"");s&&(this._hover.contentsDomNode.ariaLabel=this._hover.contentsDomNode.textContent+", "+s)}hide(){if(!this._renderedHover)return;const e=this._renderedHover.shouldFocus||this._hoverFocusedKey.get();this._setRenderedHover(void 0),this._resizableNode.maxSize=new wt(1/0,1/0),this._resizableNode.clearSashHoverState(),this._hoverFocusedKey.set(!1),this._editor.layoutContentWidget(this),e&&this._editor.focus()}_removeConstraintsRenderNormally(){const e=this._editor.getLayoutInfo();this._resizableNode.layout(e.height,e.width),this._setHoverWidgetDimensions("auto","auto")}setMinimumDimensions(e){this._minimumSize=new wt(Math.max(this._minimumSize.width,e.width),Math.max(this._minimumSize.height,e.height)),this._updateMinimumWidth()}_updateMinimumWidth(){const e=typeof this._contentWidth>"u"?this._minimumSize.width:Math.min(this._contentWidth,this._minimumSize.width);this._resizableNode.minSize=new wt(e,this._minimumSize.height)}onContentsChanged(){this._removeConstraintsRenderNormally();const e=this._hover.containerDomNode;let t=xc(e),i=Ks(e);if(this._resizableNode.layout(t,i),this._setHoverWidgetDimensions(i,t),t=xc(e),i=Ks(e),this._contentWidth=i,this._updateMinimumWidth(),this._resizableNode.layout(t,i),this._renderedHover?.showAtPosition){const n=xc(this._hover.containerDomNode);this._positionPreference=this._findPositionPreference(n,this._renderedHover.showAtPosition)}this._layoutContentWidget()}focus(){this._hover.containerDomNode.focus()}scrollUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e-t.lineHeight})}scrollDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._editor.getOption(50);this._hover.scrollbar.setScrollPosition({scrollTop:e+t.lineHeight})}scrollLeft(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e-_8})}scrollRight(){const e=this._hover.scrollbar.getScrollPosition().scrollLeft;this._hover.scrollbar.setScrollPosition({scrollLeft:e+_8})}pageUp(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e-t})}pageDown(){const e=this._hover.scrollbar.getScrollPosition().scrollTop,t=this._hover.scrollbar.getScrollDimensions().height;this._hover.scrollbar.setScrollPosition({scrollTop:e+t})}goToTop(){this._hover.scrollbar.setScrollPosition({scrollTop:0})}goToBottom(){this._hover.scrollbar.setScrollPosition({scrollTop:this._hover.scrollbar.getScrollDimensions().scrollHeight})}},Ja=gh,gh.ID="editor.contrib.resizableContentHoverWidget",gh._lastDimensions=new wt(0,0),gh);e2=Ja=GSe([n1(1,Ee),n1(2,Ke),n1(3,ho),n1(4,vt)],e2);function b8(o,e,t,i,n,s){const r=t+n/2,a=i+s/2,l=Math.max(Math.abs(o-r)-n/2,0),c=Math.max(Math.abs(e-a)-s/2,0);return Math.sqrt(l*l+c*c)}class yL{get anchor(){return this._anchor}set anchor(e){this._anchor=e}get shouldFocus(){return this._shouldFocus}set shouldFocus(e){this._shouldFocus=e}get source(){return this._source}set source(e){this._source=e}get insistOnKeepingHoverVisible(){return this._insistOnKeepingHoverVisible}set insistOnKeepingHoverVisible(e){this._insistOnKeepingHoverVisible=e}constructor(e,t){this._editor=e,this._participants=t,this._anchor=null,this._shouldFocus=!1,this._source=0,this._insistOnKeepingHoverVisible=!1}static _getLineDecorations(e,t){if(t.type!==1&&!t.supportsMarkerHover)return[];const i=e.getModel(),n=t.range.startLineNumber;if(n>i.getLineCount())return[];const s=i.getLineMaxColumn(n);return e.getLineDecorations(n).filter(r=>{if(r.options.isWholeLine)return!0;const a=r.range.startLineNumber===n?r.range.startColumn:1,l=r.range.endLineNumber===n?r.range.endColumn:s;if(r.options.showIfCollapsed){if(a>t.range.startColumn+1||t.range.endColumn-1>l)return!1}else if(a>t.range.startColumn||t.range.endColumn>l)return!1;return!0})}computeAsync(e){const t=this._anchor;if(!this._editor.hasModel()||!t)return No.EMPTY;const i=yL._getLineDecorations(this._editor,t);return No.merge(this._participants.map(n=>n.computeAsync?n.computeAsync(t,i,e):No.EMPTY))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const e=yL._getLineDecorations(this._editor,this._anchor);let t=[];for(const i of this._participants)t=t.concat(i.computeSync(this._anchor,e));return Vr(t)}}class Vq{constructor(e,t,i){this.anchor=e,this.hoverParts=t,this.isComplete=i}filter(e){const t=this.hoverParts.filter(i=>i.isValidForHoverAnchor(e));return t.length===this.hoverParts.length?this:new KSe(this,this.anchor,t,this.isComplete)}}class KSe extends Vq{constructor(e,t,i,n){super(t,i,n),this.original=e}filter(e){return this.original.filter(e)}}var jSe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},qSe=function(o,e){return function(t,i){e(t,i,o)}};const v8=ie;let wL=class extends F{get hasContent(){return this._hasContent}constructor(e){super(),this._keybindingService=e,this.actions=[],this._hasContent=!1,this.hoverElement=v8("div.hover-row.status-bar"),this.hoverElement.tabIndex=0,this.actionsElement=Y(this.hoverElement,v8("div.actions"))}addAction(e){const t=this._keybindingService.lookupKeybinding(e.commandId),i=t?t.getLabel():null;this._hasContent=!0;const n=this._register(PT.render(this.actionsElement,e,i));return this.actions.push(n),n}append(e){const t=Y(this.actionsElement,e);return this._hasContent=!0,t}};wL=jSe([qSe(0,vt)],wL);class ZSe{constructor(e,t,i){this.provider=e,this.hover=t,this.ordinal=i}}async function YSe(o,e,t,i,n){const s=await Promise.resolve(o.provideHover(t,i,n)).catch(yi);if(!(!s||!XSe(s)))return new ZSe(o,s,e)}function CW(o,e,t,i,n=!1){const r=o.ordered(e,n).map((a,l)=>YSe(a,l,e,t,i));return No.fromPromises(r).coalesce()}function Hq(o,e,t,i,n=!1){return CW(o,e,t,i,n).map(s=>s.hover).toPromise()}Os("_executeHoverProvider",(o,e,t)=>{const i=o.get(ue);return Hq(i.hoverProvider,e,t,He.None)});Os("_executeHoverProvider_recursive",(o,e,t)=>{const i=o.get(ue);return Hq(i.hoverProvider,e,t,He.None,!0)});function XSe(o){const e=typeof o.range<"u",t=typeof o.contents<"u"&&o.contents&&o.contents.length>0;return e&&t}var QSe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},mu=function(o,e){return function(t,i){e(t,i,o)}};const am=ie,JSe=Gt("hover-increase-verbosity",J.add,p("increaseHoverVerbosity","Icon for increaseing hover verbosity.")),e1e=Gt("hover-decrease-verbosity",J.remove,p("decreaseHoverVerbosity","Icon for decreasing hover verbosity."));class Ar{constructor(e,t,i,n,s,r=void 0){this.owner=e,this.range=t,this.contents=i,this.isBeforeContent=n,this.ordinal=s,this.source=r}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}class zq{constructor(e,t,i){this.hover=e,this.hoverProvider=t,this.hoverPosition=i}supportsVerbosityAction(e){switch(e){case Zs.Increase:return this.hover.canIncreaseVerbosity??!1;case Zs.Decrease:return this.hover.canDecreaseVerbosity??!1}}}let Jy=class{constructor(e,t,i,n,s,r,a,l){this._editor=e,this._languageService=t,this._openerService=i,this._configurationService=n,this._languageFeaturesService=s,this._keybindingService=r,this._hoverService=a,this._commandService=l,this.hoverOrdinal=3}createLoadingMessage(e){return new Ar(this,e.range,[new Pn().appendText(p("modesContentHover.loading","Loading..."))],!1,2e3)}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,s=i.getLineMaxColumn(n),r=[];let a=1e3;const l=i.getLineLength(n),c=i.getLanguageIdAtPosition(e.range.startLineNumber,e.range.startColumn),d=this._editor.getOption(118),h=this._configurationService.getValue("editor.maxTokenizationLineLength",{overrideIdentifier:c});let u=!1;d>=0&&l>d&&e.range.startColumn>=d&&(u=!0,r.push(new Ar(this,e.range,[{value:p("stopped rendering","Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.")}],!1,a++))),!u&&typeof h=="number"&&l>=h&&r.push(new Ar(this,e.range,[{value:p("too many characters","Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.")}],!1,a++));let g=!1;for(const f of t){const m=f.range.startLineNumber===n?f.range.startColumn:1,_=f.range.endLineNumber===n?f.range.endColumn:s,b=f.options.hoverMessage;if(!b||L_(b))continue;f.options.beforeContentClassName&&(g=!0);const v=new L(e.range.startLineNumber,m,e.range.startLineNumber,_);r.push(new Ar(this,v,b4(b),g,a++))}return r}computeAsync(e,t,i){if(!this._editor.hasModel()||e.type!==1)return No.EMPTY;const n=this._editor.getModel(),s=this._languageFeaturesService.hoverProvider;return s.has(n)?this._getMarkdownHovers(s,n,e,i):No.EMPTY}_getMarkdownHovers(e,t,i,n){const s=i.range.getStartPosition();return CW(e,t,s,n).filter(l=>!L_(l.hover.contents)).map(l=>{const c=l.hover.range?L.lift(l.hover.range):i.range,d=new zq(l.hover,l.provider,s);return new Ar(this,c,l.hover.contents,!1,l.ordinal,d)})}renderHoverParts(e,t){return this._renderedHoverParts=new t1e(t,e.fragment,this,this._editor,this._languageService,this._openerService,this._commandService,this._keybindingService,this._hoverService,this._configurationService,e.onContentsChanged),this._renderedHoverParts}updateMarkdownHoverVerbosityLevel(e,t,i){return Promise.resolve(this._renderedHoverParts?.updateMarkdownHoverPartVerbosityLevel(e,t,i))}};Jy=QSe([mu(1,ti),mu(2,Fs),mu(3,Ke),mu(4,ue),mu(5,vt),mu(6,zl),mu(7,Ft)],Jy);class s1{constructor(e,t,i){this.hoverPart=e,this.hoverElement=t,this.disposables=i}dispose(){this.disposables.dispose()}}class t1e{constructor(e,t,i,n,s,r,a,l,c,d,h){this._hoverParticipant=i,this._editor=n,this._languageService=s,this._openerService=r,this._commandService=a,this._keybindingService=l,this._hoverService=c,this._configurationService=d,this._onFinishedRendering=h,this._ongoingHoverOperations=new Map,this._disposables=new $,this.renderedHoverParts=this._renderHoverParts(e,t,this._onFinishedRendering),this._disposables.add(ve(()=>{this.renderedHoverParts.forEach(u=>{u.dispose()}),this._ongoingHoverOperations.forEach(u=>{u.tokenSource.dispose(!0)})}))}_renderHoverParts(e,t,i){return e.sort(cs(n=>n.ordinal,Br)),e.map(n=>{const s=this._renderHoverPart(n,i);return t.appendChild(s.hoverElement),s})}_renderHoverPart(e,t){const i=this._renderMarkdownHover(e,t),n=i.hoverElement,s=e.source,r=new $;if(r.add(i),!s)return new s1(e,n,r);const a=s.supportsVerbosityAction(Zs.Increase),l=s.supportsVerbosityAction(Zs.Decrease);if(!a&&!l)return new s1(e,n,r);const c=am("div.verbosity-actions");return n.prepend(c),r.add(this._renderHoverExpansionAction(c,Zs.Increase,a)),r.add(this._renderHoverExpansionAction(c,Zs.Decrease,l)),new s1(e,n,r)}_renderMarkdownHover(e,t){return Uq(this._editor,e,this._languageService,this._openerService,t)}_renderHoverExpansionAction(e,t,i){const n=new $,s=t===Zs.Increase,r=Y(e,am(ke.asCSSSelector(s?JSe:e1e)));r.tabIndex=0;const a=new w_("mouse",!1,{target:e,position:{hoverPosition:0}},this._configurationService,this._hoverService);if(n.add(this._hoverService.setupManagedHover(a,r,n1e(this._keybindingService,t))),!i)return r.classList.add("disabled"),n;r.classList.add("enabled");const l=()=>this._commandService.executeCommand(t===Zs.Increase?bD:vD);return n.add(new yG(r,l)),n.add(new wG(r,l,[3,10])),n}async updateMarkdownHoverPartVerbosityLevel(e,t,i=!0){const n=this._editor.getModel();if(!n)return;const s=this._getRenderedHoverPartAtIndex(t),r=s?.hoverPart.source;if(!s||!r?.supportsVerbosityAction(e))return;const a=await this._fetchHover(r,n,e);if(!a)return;const l=new zq(a,r.hoverProvider,r.hoverPosition),c=s.hoverPart,d=new Ar(this._hoverParticipant,c.range,a.contents,c.isBeforeContent,c.ordinal,l),h=this._renderHoverPart(d,this._onFinishedRendering);return this._replaceRenderedHoverPartAtIndex(t,h,d),i&&this._focusOnHoverPartWithIndex(t),{hoverPart:d,hoverElement:h.hoverElement}}async _fetchHover(e,t,i){let n=i===Zs.Increase?1:-1;const s=e.hoverProvider,r=this._ongoingHoverOperations.get(s);r&&(r.tokenSource.cancel(),n+=r.verbosityDelta);const a=new ri;this._ongoingHoverOperations.set(s,{verbosityDelta:n,tokenSource:a});const l={verbosityRequest:{verbosityDelta:n,previousHover:e.hover}};let c;try{c=await Promise.resolve(s.provideHover(t,e.hoverPosition,a.token,l))}catch(d){yi(d)}return a.dispose(),this._ongoingHoverOperations.delete(s),c}_replaceRenderedHoverPartAtIndex(e,t,i){if(e>=this.renderedHoverParts.length||e<0)return;const n=this.renderedHoverParts[e],s=n.hoverElement,r=t.hoverElement,a=Array.from(r.children);s.replaceChildren(...a);const l=new s1(i,s,t.disposables);s.focus(),n.dispose(),this.renderedHoverParts[e]=l}_focusOnHoverPartWithIndex(e){this.renderedHoverParts[e].hoverElement.focus()}_getRenderedHoverPartAtIndex(e){return this.renderedHoverParts[e]}dispose(){this._disposables.dispose()}}function i1e(o,e,t,i,n){e.sort(cs(r=>r.ordinal,Br));const s=[];for(const r of e)s.push(Uq(t,r,i,n,o.onContentsChanged));return new Ff(s)}function Uq(o,e,t,i,n){const s=new $,r=am("div.hover-row"),a=am("div.hover-row-contents");r.appendChild(a);const l=e.contents;for(const d of l){if(L_(d))continue;const h=am("div.markdown-hover"),u=Y(h,am("div.hover-contents")),g=s.add(new Zc({editor:o},t,i));s.add(g.onDidRenderAsync(()=>{u.className="hover-contents code-hover-contents",n()}));const f=s.add(g.render(d));u.appendChild(f.element),a.appendChild(h)}return{hoverPart:e,hoverElement:r,dispose(){s.dispose()}}}function n1e(o,e){switch(e){case Zs.Increase:{const t=o.lookupKeybinding(bD);return t?p("increaseVerbosityWithKb","Increase Hover Verbosity ({0})",t.getLabel()):p("increaseVerbosity","Increase Hover Verbosity")}case Zs.Decrease:{const t=o.lookupKeybinding(vD);return t?p("decreaseVerbosityWithKb","Decrease Hover Verbosity ({0})",t.getLabel()):p("decreaseVerbosity","Decrease Hover Verbosity")}}}function t2(o,e){return!!o[e]}class vN{constructor(e,t){this.target=e.target,this.isLeftClick=e.event.leftButton,this.isMiddleClick=e.event.middleButton,this.isRightClick=e.event.rightButton,this.hasTriggerModifier=t2(e.event,t.triggerModifier),this.hasSideBySideModifier=t2(e.event,t.triggerSideBySideModifier),this.isNoneOrSingleMouseDown=e.event.detail<=1}}class C8{constructor(e,t){this.keyCodeIsTriggerKey=e.keyCode===t.triggerKey,this.keyCodeIsSideBySideKey=e.keyCode===t.triggerSideBySideKey,this.hasTriggerModifier=t2(e,t.triggerModifier)}}class o1{constructor(e,t,i,n){this.triggerKey=e,this.triggerModifier=t,this.triggerSideBySideKey=i,this.triggerSideBySideModifier=n}equals(e){return this.triggerKey===e.triggerKey&&this.triggerModifier===e.triggerModifier&&this.triggerSideBySideKey===e.triggerSideBySideKey&&this.triggerSideBySideModifier===e.triggerSideBySideModifier}}function y8(o){return o==="altKey"?Qe?new o1(57,"metaKey",6,"altKey"):new o1(5,"ctrlKey",6,"altKey"):Qe?new o1(6,"altKey",57,"metaKey"):new o1(6,"altKey",5,"ctrlKey")}class yD extends F{constructor(e,t){super(),this._onMouseMoveOrRelevantKeyDown=this._register(new O),this.onMouseMoveOrRelevantKeyDown=this._onMouseMoveOrRelevantKeyDown.event,this._onExecute=this._register(new O),this.onExecute=this._onExecute.event,this._onCancel=this._register(new O),this.onCancel=this._onCancel.event,this._editor=e,this._extractLineNumberFromMouseEvent=t?.extractLineNumberFromMouseEvent??(i=>i.target.position?i.target.position.lineNumber:0),this._opts=y8(this._editor.getOption(78)),this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._register(this._editor.onDidChangeConfiguration(i=>{if(i.hasChanged(78)){const n=y8(this._editor.getOption(78));if(this._opts.equals(n))return;this._opts=n,this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._lineNumberOnMouseDown=0,this._onCancel.fire()}})),this._register(this._editor.onMouseMove(i=>this._onEditorMouseMove(new vN(i,this._opts)))),this._register(this._editor.onMouseDown(i=>this._onEditorMouseDown(new vN(i,this._opts)))),this._register(this._editor.onMouseUp(i=>this._onEditorMouseUp(new vN(i,this._opts)))),this._register(this._editor.onKeyDown(i=>this._onEditorKeyDown(new C8(i,this._opts)))),this._register(this._editor.onKeyUp(i=>this._onEditorKeyUp(new C8(i,this._opts)))),this._register(this._editor.onMouseDrag(()=>this._resetHandler())),this._register(this._editor.onDidChangeCursorSelection(i=>this._onDidChangeCursorSelection(i))),this._register(this._editor.onDidChangeModel(i=>this._resetHandler())),this._register(this._editor.onDidChangeModelContent(()=>this._resetHandler())),this._register(this._editor.onDidScrollChange(i=>{(i.scrollTopChanged||i.scrollLeftChanged)&&this._resetHandler()}))}_onDidChangeCursorSelection(e){e.selection&&e.selection.startColumn!==e.selection.endColumn&&this._resetHandler()}_onEditorMouseMove(e){this._lastMouseMoveEvent=e,this._onMouseMoveOrRelevantKeyDown.fire([e,null])}_onEditorMouseDown(e){this._hasTriggerKeyOnMouseDown=e.hasTriggerModifier,this._lineNumberOnMouseDown=this._extractLineNumberFromMouseEvent(e)}_onEditorMouseUp(e){const t=this._extractLineNumberFromMouseEvent(e);this._hasTriggerKeyOnMouseDown&&this._lineNumberOnMouseDown&&this._lineNumberOnMouseDown===t&&this._onExecute.fire(e)}_onEditorKeyDown(e){this._lastMouseMoveEvent&&(e.keyCodeIsTriggerKey||e.keyCodeIsSideBySideKey&&e.hasTriggerModifier)?this._onMouseMoveOrRelevantKeyDown.fire([this._lastMouseMoveEvent,e]):e.hasTriggerModifier&&this._onCancel.fire()}_onEditorKeyUp(e){e.keyCodeIsTriggerKey&&this._onCancel.fire()}_resetHandler(){this._lastMouseMoveEvent=null,this._hasTriggerKeyOnMouseDown=!1,this._onCancel.fire()}}class Gq{constructor(e,t){this.range=e,this.direction=t}}class yW{constructor(e,t,i){this.hint=e,this.anchor=t,this.provider=i,this._isResolved=!1}with(e){const t=new yW(this.hint,e.anchor,this.provider);return t._isResolved=this._isResolved,t._currentResolve=this._currentResolve,t}async resolve(e){if(typeof this.provider.resolveInlayHint=="function"){if(this._currentResolve)return await this._currentResolve,e.isCancellationRequested?void 0:this.resolve(e);this._isResolved||(this._currentResolve=this._doResolve(e).finally(()=>this._currentResolve=void 0)),await this._currentResolve}}async _doResolve(e){try{const t=await Promise.resolve(this.provider.resolveInlayHint(this.hint,e));this.hint.tooltip=t?.tooltip??this.hint.tooltip,this.hint.label=t?.label??this.hint.label,this.hint.textEdits=t?.textEdits??this.hint.textEdits,this._isResolved=!0}catch(t){yi(t),this._isResolved=!1}}}const xm=class xm{static async create(e,t,i,n){const s=[],r=e.ordered(t).reverse().map(a=>i.map(async l=>{try{const c=await a.provideInlayHints(t,l,n);(c?.hints.length||a.onDidChangeInlayHints)&&s.push([c??xm._emptyInlayHintList,a])}catch(c){yi(c)}}));if(await Promise.all(r.flat()),n.isCancellationRequested||t.isDisposed())throw new Hr;return new xm(i,s,t)}constructor(e,t,i){this._disposables=new $,this.ranges=e,this.provider=new Set;const n=[];for(const[s,r]of t){this._disposables.add(s),this.provider.add(r);for(const a of s.hints){const l=i.validatePosition(a.position);let c="before";const d=xm._getRangeAtPosition(i,l);let h;d.getStartPosition().isBefore(l)?(h=L.fromPositions(d.getStartPosition(),l),c="after"):(h=L.fromPositions(l,d.getEndPosition()),c="before"),n.push(new yW(a,new Gq(h,c),r))}}this.items=n.sort((s,r)=>A.compare(s.hint.position,r.hint.position))}dispose(){this._disposables.dispose()}static _getRangeAtPosition(e,t){const i=t.lineNumber,n=e.getWordAtPosition(t);if(n)return new L(i,n.startColumn,i,n.endColumn);e.tokenization.tokenizeIfCheap(i);const s=e.tokenization.getLineTokens(i),r=t.column-1,a=s.findTokenIndexAtOffset(r);let l=s.getStartOffset(a),c=s.getEndOffset(a);return c-l===1&&(l===r&&a>1?(l=s.getStartOffset(a-1),c=s.getEndOffset(a-1)):c===r&&a<s.getCount()-1&&(l=s.getStartOffset(a+1),c=s.getEndOffset(a+1))),new L(i,l+1,i,c+1)}};xm._emptyInlayHintList=Object.freeze({dispose(){},hints:[]});let SL=xm;function s1e(o){return ye.from({scheme:Oe.command,path:o.id,query:o.arguments&&encodeURIComponent(JSON.stringify(o.arguments))}).toString()}var o1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ql=function(o,e){return function(t,i){e(t,i,o)}};let jr=class extends By{constructor(e,t,i,n,s,r,a,l,c,d,h,u,g){super(e,{...n.getRawOptions(),overflowWidgetsDomNode:n.getOverflowWidgetsDomNode()},i,s,r,a,l,c,d,h,u,g),this._parentEditor=n,this._overwriteOptions=t,super.updateOptions(this._overwriteOptions),this._register(n.onDidChangeConfiguration(f=>this._onParentConfigurationChanged(f)))}getParentEditor(){return this._parentEditor}_onParentConfigurationChanged(e){super.updateOptions(this._parentEditor.getRawOptions()),super.updateOptions(this._overwriteOptions)}updateOptions(e){XE(this._overwriteOptions,e,!0),super.updateOptions(this._overwriteOptions)}};jr=o1e([Ql(4,Ce),Ql(5,gt),Ql(6,Ft),Ql(7,Ee),Ql(8,zi),Ql(9,Ei),Ql(10,ho),Ql(11,li),Ql(12,ue)],jr);const w8=new j(new lt(0,122,204)),r1e={showArrow:!0,showFrame:!0,className:"",frameColor:w8,arrowColor:w8,keepEditorSelection:!1},a1e="vs.editor.contrib.zoneWidget";class l1e{constructor(e,t,i,n,s,r,a,l){this.id="",this.domNode=e,this.afterLineNumber=t,this.afterColumn=i,this.heightInLines=n,this.showInHiddenAreas=a,this.ordinal=l,this._onDomNodeTop=s,this._onComputedHeight=r}onDomNodeTop(e){this._onDomNodeTop(e)}onComputedHeight(e){this._onComputedHeight(e)}}class c1e{constructor(e,t){this._id=e,this._domNode=t}getId(){return this._id}getDomNode(){return this._domNode}getPosition(){return null}}const hE=class hE{constructor(e){this._editor=e,this._ruleName=hE._IdGenerator.nextId(),this._decorations=this._editor.createDecorationsCollection(),this._color=null,this._height=-1}dispose(){this.hide(),hP(this._ruleName)}set color(e){this._color!==e&&(this._color=e,this._updateStyle())}set height(e){this._height!==e&&(this._height=e,this._updateStyle())}_updateStyle(){hP(this._ruleName),A0(`.monaco-editor ${this._ruleName}`,`border-style: solid; border-color: transparent; border-bottom-color: ${this._color}; border-width: ${this._height}px; bottom: -${this._height}px !important; margin-left: -${this._height}px; `)}show(e){e.column===1&&(e={lineNumber:e.lineNumber,column:2}),this._decorations.set([{range:L.fromPositions(e),options:{description:"zone-widget-arrow",className:this._ruleName,stickiness:1}}])}hide(){this._decorations.clear()}};hE._IdGenerator=new T5(".arrow-decoration-");let i2=hE;class d1e{constructor(e,t={}){this._arrow=null,this._overlayWidget=null,this._resizeSash=null,this._viewZone=null,this._disposables=new $,this.container=null,this._isShowing=!1,this.editor=e,this._positionMarkerId=this.editor.createDecorationsCollection(),this.options=gc(t),XE(this.options,r1e,!1),this.domNode=document.createElement("div"),this.options.isAccessible||(this.domNode.setAttribute("aria-hidden","true"),this.domNode.setAttribute("role","presentation")),this._disposables.add(this.editor.onDidLayoutChange(i=>{const n=this._getWidth(i);this.domNode.style.width=n+"px",this.domNode.style.left=this._getLeft(i)+"px",this._onWidth(n)}))}dispose(){this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._viewZone&&this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id),this._viewZone=null}),this._positionMarkerId.clear(),this._disposables.dispose()}create(){this.domNode.classList.add("zone-widget"),this.options.className&&this.domNode.classList.add(this.options.className),this.container=document.createElement("div"),this.container.classList.add("zone-widget-container"),this.domNode.appendChild(this.container),this.options.showArrow&&(this._arrow=new i2(this.editor),this._disposables.add(this._arrow)),this._fillContainer(this.container),this._initSash(),this._applyStyles()}style(e){e.frameColor&&(this.options.frameColor=e.frameColor),e.arrowColor&&(this.options.arrowColor=e.arrowColor),this._applyStyles()}_applyStyles(){if(this.container&&this.options.frameColor){const e=this.options.frameColor.toString();this.container.style.borderTopColor=e,this.container.style.borderBottomColor=e}if(this._arrow&&this.options.arrowColor){const e=this.options.arrowColor.toString();this._arrow.color=e}}_getWidth(e){return e.width-e.minimap.minimapWidth-e.verticalScrollbarWidth}_getLeft(e){return e.minimap.minimapWidth>0&&e.minimap.minimapLeft===0?e.minimap.minimapWidth:0}_onViewZoneTop(e){this.domNode.style.top=e+"px"}_onViewZoneHeight(e){if(this.domNode.style.height=`${e}px`,this.container){const t=e-this._decoratingElementsHeight();this.container.style.height=`${t}px`;const i=this.editor.getLayoutInfo();this._doLayout(t,this._getWidth(i))}this._resizeSash?.layout()}get position(){const e=this._positionMarkerId.getRange(0);if(e)return e.getStartPosition()}show(e,t){const i=L.isIRange(e)?L.lift(e):L.fromPositions(e);this._isShowing=!0,this._showImpl(i,t),this._isShowing=!1,this._positionMarkerId.set([{range:i,options:Fe.EMPTY}])}hide(){this._viewZone&&(this.editor.changeViewZones(e=>{this._viewZone&&e.removeZone(this._viewZone.id)}),this._viewZone=null),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this._arrow?.hide(),this._positionMarkerId.clear()}_decoratingElementsHeight(){const e=this.editor.getOption(67);let t=0;if(this.options.showArrow){const i=Math.round(e/3);t+=2*i}if(this.options.showFrame){const i=Math.round(e/9);t+=2*i}return t}_showImpl(e,t){const i=e.getStartPosition(),n=this.editor.getLayoutInfo(),s=this._getWidth(n);this.domNode.style.width=`${s}px`,this.domNode.style.left=this._getLeft(n)+"px";const r=document.createElement("div");r.style.overflow="hidden";const a=this.editor.getOption(67);if(!this.options.allowUnlimitedHeight){const u=Math.max(12,this.editor.getLayoutInfo().height/a*.8);t=Math.min(t,u)}let l=0,c=0;if(this._arrow&&this.options.showArrow&&(l=Math.round(a/3),this._arrow.height=l,this._arrow.show(i)),this.options.showFrame&&(c=Math.round(a/9)),this.editor.changeViewZones(u=>{this._viewZone&&u.removeZone(this._viewZone.id),this._overlayWidget&&(this.editor.removeOverlayWidget(this._overlayWidget),this._overlayWidget=null),this.domNode.style.top="-1000px",this._viewZone=new l1e(r,i.lineNumber,i.column,t,g=>this._onViewZoneTop(g),g=>this._onViewZoneHeight(g),this.options.showInHiddenAreas,this.options.ordinal),this._viewZone.id=u.addZone(this._viewZone),this._overlayWidget=new c1e(a1e+this._viewZone.id,this.domNode),this.editor.addOverlayWidget(this._overlayWidget)}),this.container&&this.options.showFrame){const u=this.options.frameWidth?this.options.frameWidth:c;this.container.style.borderTopWidth=u+"px",this.container.style.borderBottomWidth=u+"px"}const d=t*a-this._decoratingElementsHeight();this.container&&(this.container.style.top=l+"px",this.container.style.height=d+"px",this.container.style.overflow="hidden"),this._doLayout(d,s),this.options.keepEditorSelection||this.editor.setSelection(e);const h=this.editor.getModel();if(h){const u=h.validateRange(new L(e.startLineNumber,1,e.endLineNumber+1,1));this.revealRange(u,u.startLineNumber===h.getLineCount())}}revealRange(e,t){t?this.editor.revealLineNearTop(e.endLineNumber,0):this.editor.revealRange(e,0)}setCssClass(e,t){this.container&&(t&&this.container.classList.remove(t),this.container.classList.add(e))}_onWidth(e){}_doLayout(e,t){}_relayout(e){this._viewZone&&this._viewZone.heightInLines!==e&&this.editor.changeViewZones(t=>{this._viewZone&&(this._viewZone.heightInLines=e,t.layoutZone(this._viewZone.id))})}_initSash(){if(this._resizeSash)return;this._resizeSash=this._disposables.add(new Nn(this.domNode,this,{orientation:1})),this.options.isResizeable||(this._resizeSash.state=0);let e;this._disposables.add(this._resizeSash.onDidStart(t=>{this._viewZone&&(e={startY:t.startY,heightInLines:this._viewZone.heightInLines})})),this._disposables.add(this._resizeSash.onDidEnd(()=>{e=void 0})),this._disposables.add(this._resizeSash.onDidChange(t=>{if(e){const i=(t.currentY-e.startY)/this.editor.getOption(67),n=i<0?Math.ceil(i):Math.floor(i),s=e.heightInLines+n;s>5&&s<35&&this._relayout(s)}}))}getHorizontalSashLeft(){return 0}getHorizontalSashTop(){return(this.domNode.style.height===null?0:parseInt(this.domNode.style.height))-this._decoratingElementsHeight()/2}getHorizontalSashWidth(){const e=this.editor.getLayoutInfo();return e.width-e.minimap.minimapWidth}}var $q=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Kq=function(o,e){return function(t,i){e(t,i,o)}};const jq=Je("IPeekViewService");it(jq,class{constructor(){this._widgets=new Map}addExclusiveWidget(o,e){const t=this._widgets.get(o);t&&(t.listener.dispose(),t.widget.dispose());const i=()=>{const n=this._widgets.get(o);n&&n.widget===e&&(n.listener.dispose(),this._widgets.delete(o))};this._widgets.set(o,{widget:e,listener:e.onDidClose(i)})}},1);var Ps;(function(o){o.inPeekEditor=new re("inReferenceSearchEditor",!0,p("inReferenceSearchEditor","Whether the current code editor is embedded inside peek")),o.notInPeekEditor=o.inPeekEditor.toNegated()})(Ps||(Ps={}));var s_;let xL=(s_=class{constructor(e,t){e instanceof jr&&Ps.inPeekEditor.bindTo(t)}dispose(){}},s_.ID="editor.contrib.referenceController",s_);xL=$q([Kq(1,Ee)],xL);at(xL.ID,xL,0);function h1e(o){const e=o.get(gt).getFocusedCodeEditor();return e instanceof jr?e.getParentEditor():e}const u1e={headerBackgroundColor:j.white,primaryHeadingColor:j.fromHex("#333333"),secondaryHeadingColor:j.fromHex("#6c6c6cb3")};let LL=class extends d1e{constructor(e,t,i){super(e,t),this.instantiationService=i,this._onDidClose=new O,this.onDidClose=this._onDidClose.event,XE(this.options,u1e,!1)}dispose(){this.disposed||(this.disposed=!0,super.dispose(),this._onDidClose.fire(this))}style(e){const t=this.options;e.headerBackgroundColor&&(t.headerBackgroundColor=e.headerBackgroundColor),e.primaryHeadingColor&&(t.primaryHeadingColor=e.primaryHeadingColor),e.secondaryHeadingColor&&(t.secondaryHeadingColor=e.secondaryHeadingColor),super.style(e)}_applyStyles(){super._applyStyles();const e=this.options;this._headElement&&e.headerBackgroundColor&&(this._headElement.style.backgroundColor=e.headerBackgroundColor.toString()),this._primaryHeading&&e.primaryHeadingColor&&(this._primaryHeading.style.color=e.primaryHeadingColor.toString()),this._secondaryHeading&&e.secondaryHeadingColor&&(this._secondaryHeading.style.color=e.secondaryHeadingColor.toString()),this._bodyElement&&e.frameColor&&(this._bodyElement.style.borderColor=e.frameColor.toString())}_fillContainer(e){this.setCssClass("peekview-widget"),this._headElement=ie(".head"),this._bodyElement=ie(".body"),this._fillHead(this._headElement),this._fillBody(this._bodyElement),e.appendChild(this._headElement),e.appendChild(this._bodyElement)}_fillHead(e,t){this._titleElement=ie(".peekview-title"),this.options.supportOnTitleClick&&(this._titleElement.classList.add("clickable"),ci(this._titleElement,"click",s=>this._onTitleClick(s))),Y(this._headElement,this._titleElement),this._fillTitleIcon(this._titleElement),this._primaryHeading=ie("span.filename"),this._secondaryHeading=ie("span.dirname"),this._metaHeading=ie("span.meta"),Y(this._titleElement,this._primaryHeading,this._secondaryHeading,this._metaHeading);const i=ie(".peekview-actions");Y(this._headElement,i);const n=this._getActionBarOptions();this._actionbarWidget=new Oo(i,n),this._disposables.add(this._actionbarWidget),t||this._actionbarWidget.push(new to("peekview.close",p("label.close","Close"),ke.asClassName(J.close),!0,()=>(this.dispose(),Promise.resolve())),{label:!1,icon:!0})}_fillTitleIcon(e){}_getActionBarOptions(){return{actionViewItemProvider:a$.bind(void 0,this.instantiationService),orientation:0}}_onTitleClick(e){}setTitle(e,t){this._primaryHeading&&this._secondaryHeading&&(this._primaryHeading.innerText=e,this._primaryHeading.setAttribute("title",e),t?this._secondaryHeading.innerText=t:fn(this._secondaryHeading))}setMetaTitle(e){this._metaHeading&&(e?(this._metaHeading.innerText=e,Ys(this._metaHeading)):is(this._metaHeading))}_doLayout(e,t){if(!this._isShowing&&e<0){this.dispose();return}const i=Math.ceil(this.editor.getOption(67)*1.2),n=Math.round(e-(i+2));this._doLayoutHead(i,t),this._doLayoutBody(n,t)}_doLayoutHead(e,t){this._headElement&&(this._headElement.style.height=`${e}px`,this._headElement.style.lineHeight=this._headElement.style.height)}_doLayoutBody(e,t){this._bodyElement&&(this._bodyElement.style.height=`${e}px`)}};LL=$q([Kq(2,Ce)],LL);const g1e=D("peekViewTitle.background",{dark:"#252526",light:"#F3F3F3",hcDark:j.black,hcLight:j.white},p("peekViewTitleBackground","Background color of the peek view title area.")),qq=D("peekViewTitleLabel.foreground",{dark:j.white,light:j.black,hcDark:j.white,hcLight:Hl},p("peekViewTitleForeground","Color of the peek view title.")),Zq=D("peekViewTitleDescription.foreground",{dark:"#ccccccb3",light:"#616161",hcDark:"#FFFFFF99",hcLight:"#292929"},p("peekViewTitleInfoForeground","Color of the peek view title info.")),f1e=D("peekView.border",{dark:Nl,light:Nl,hcDark:rt,hcLight:rt},p("peekViewBorder","Color of the peek view borders and arrow.")),p1e=D("peekViewResult.background",{dark:"#252526",light:"#F3F3F3",hcDark:j.black,hcLight:j.white},p("peekViewResultsBackground","Background color of the peek view result list."));D("peekViewResult.lineForeground",{dark:"#bbbbbb",light:"#646465",hcDark:j.white,hcLight:Hl},p("peekViewResultsMatchForeground","Foreground color for line nodes in the peek view result list."));D("peekViewResult.fileForeground",{dark:j.white,light:"#1E1E1E",hcDark:j.white,hcLight:Hl},p("peekViewResultsFileForeground","Foreground color for file nodes in the peek view result list."));D("peekViewResult.selectionBackground",{dark:"#3399ff33",light:"#3399ff33",hcDark:null,hcLight:null},p("peekViewResultsSelectionBackground","Background color of the selected entry in the peek view result list."));D("peekViewResult.selectionForeground",{dark:j.white,light:"#6C6C6C",hcDark:j.white,hcLight:Hl},p("peekViewResultsSelectionForeground","Foreground color of the selected entry in the peek view result list."));const Yq=D("peekViewEditor.background",{dark:"#001F33",light:"#F2F8FC",hcDark:j.black,hcLight:j.white},p("peekViewEditorBackground","Background color of the peek view editor."));D("peekViewEditorGutter.background",Yq,p("peekViewEditorGutterBackground","Background color of the gutter in the peek view editor."));D("peekViewEditorStickyScroll.background",Yq,p("peekViewEditorStickScrollBackground","Background color of sticky scroll in the peek view editor."));D("peekViewResult.matchHighlightBackground",{dark:"#ea5c004d",light:"#ea5c004d",hcDark:null,hcLight:null},p("peekViewResultsMatchHighlight","Match highlight color in the peek view result list."));D("peekViewEditor.matchHighlightBackground",{dark:"#ff8f0099",light:"#f5d802de",hcDark:null,hcLight:null},p("peekViewEditorMatchHighlight","Match highlight color in the peek view editor."));D("peekViewEditor.matchHighlightBorder",{dark:null,light:null,hcDark:qt,hcLight:qt},p("peekViewEditorMatchHighlightBorder","Match highlight border in the peek view editor."));class Gh{constructor(e,t,i,n){this.isProviderFirst=e,this.parent=t,this.link=i,this._rangeCallback=n,this.id=tA.nextId()}get uri(){return this.link.uri}get range(){return this._range??this.link.targetSelectionRange??this.link.range}set range(e){this._range=e,this._rangeCallback(this)}get ariaMessage(){const e=this.parent.getPreview(this)?.preview(this.range);return e?p({key:"aria.oneReference.preview",comment:["Placeholders are: 0: filename, 1:line number, 2: column number, 3: preview snippet of source code"]},"{0} in {1} on line {2} at column {3}",e.value,fr(this.uri),this.range.startLineNumber,this.range.startColumn):p("aria.oneReference","in {0} on line {1} at column {2}",fr(this.uri),this.range.startLineNumber,this.range.startColumn)}}class m1e{constructor(e){this._modelReference=e}dispose(){this._modelReference.dispose()}preview(e,t=8){const i=this._modelReference.object.textEditorModel;if(!i)return;const{startLineNumber:n,startColumn:s,endLineNumber:r,endColumn:a}=e,l=i.getWordUntilPosition({lineNumber:n,column:s-t}),c=new L(n,l.startColumn,n,s),d=new L(r,a,r,1073741824),h=i.getValueInRange(c).replace(/^\s+/,""),u=i.getValueInRange(e),g=i.getValueInRange(d).replace(/\s+$/,"");return{value:h+u+g,highlight:{start:h.length,end:h.length+u.length}}}}class ew{constructor(e,t){this.parent=e,this.uri=t,this.children=[],this._previews=new on}dispose(){Dt(this._previews.values()),this._previews.clear()}getPreview(e){return this._previews.get(e.uri)}get ariaMessage(){const e=this.children.length;return e===1?p("aria.fileReferences.1","1 symbol in {0}, full path {1}",fr(this.uri),this.uri.fsPath):p("aria.fileReferences.N","{0} symbols in {1}, full path {2}",e,fr(this.uri),this.uri.fsPath)}async resolve(e){if(this._previews.size!==0)return this;for(const t of this.children)if(!this._previews.has(t.uri))try{const i=await e.createModelReference(t.uri);this._previews.set(t.uri,new m1e(i))}catch(i){Ae(i)}return this}}class so{constructor(e,t){this.groups=[],this.references=[],this._onDidChangeReferenceRange=new O,this.onDidChangeReferenceRange=this._onDidChangeReferenceRange.event,this._links=e,this._title=t;const[i]=e;e.sort(so._compareReferences);let n;for(const s of e)if((!n||!Zt.isEqual(n.uri,s.uri,!0))&&(n=new ew(this,s.uri),this.groups.push(n)),n.children.length===0||so._compareReferences(s,n.children[n.children.length-1])!==0){const r=new Gh(i===s,n,s,a=>this._onDidChangeReferenceRange.fire(a));this.references.push(r),n.children.push(r)}}dispose(){Dt(this.groups),this._onDidChangeReferenceRange.dispose(),this.groups.length=0}clone(){return new so(this._links,this._title)}get title(){return this._title}get isEmpty(){return this.groups.length===0}get ariaMessage(){return this.isEmpty?p("aria.result.0","No results found"):this.references.length===1?p("aria.result.1","Found 1 symbol in {0}",this.references[0].uri.fsPath):this.groups.length===1?p("aria.result.n1","Found {0} symbols in {1}",this.references.length,this.groups[0].uri.fsPath):p("aria.result.nm","Found {0} symbols in {1} files",this.references.length,this.groups.length)}nextOrPreviousReference(e,t){const{parent:i}=e;let n=i.children.indexOf(e);const s=i.children.length,r=i.parent.groups.length;return r===1||t&&n+1<s||!t&&n>0?(t?n=(n+1)%s:n=(n+s-1)%s,i.children[n]):(n=i.parent.groups.indexOf(i),t?(n=(n+1)%r,i.parent.groups[n].children[0]):(n=(n+r-1)%r,i.parent.groups[n].children[i.parent.groups[n].children.length-1]))}nearestReference(e,t){const i=this.references.map((n,s)=>({idx:s,prefixLen:Dh(n.uri.toString(),e.toString()),offsetDist:Math.abs(n.range.startLineNumber-t.lineNumber)*100+Math.abs(n.range.startColumn-t.column)})).sort((n,s)=>n.prefixLen>s.prefixLen?-1:n.prefixLen<s.prefixLen?1:n.offsetDist<s.offsetDist?-1:n.offsetDist>s.offsetDist?1:0)[0];if(i)return this.references[i.idx]}referenceAt(e,t){for(const i of this.references)if(i.uri.toString()===e.toString()&&L.containsPosition(i.range,t))return i}firstReference(){for(const e of this.references)if(e.isProviderFirst)return e;return this.references[0]}static _compareReferences(e,t){return Zt.compare(e.uri,t.uri)||L.compareRangesUsingStarts(e.range,t.range)}}var wD=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},SD=function(o,e){return function(t,i){e(t,i,o)}},n2;let s2=class{constructor(e){this._resolverService=e}hasChildren(e){return e instanceof so||e instanceof ew}getChildren(e){if(e instanceof so)return e.groups;if(e instanceof ew)return e.resolve(this._resolverService).then(t=>t.children);throw new Error("bad tree")}};s2=wD([SD(0,Ms)],s2);class _1e{getHeight(){return 23}getTemplateId(e){return e instanceof ew?kL.id:EL.id}}let o2=class{constructor(e){this._keybindingService=e}getKeyboardNavigationLabel(e){if(e instanceof Gh){const t=e.parent.getPreview(e)?.preview(e.range);if(t)return t.value}return fr(e.uri)}};o2=wD([SD(0,vt)],o2);class b1e{getId(e){return e instanceof Gh?e.id:e.uri}}let r2=class extends F{constructor(e,t){super(),this._labelService=t;const i=document.createElement("div");i.classList.add("reference-file"),this.file=this._register(new Mx(i,{supportHighlights:!0})),this.badge=new eM(Y(i,ie(".count")),{},o$),e.appendChild(i)}set(e,t){const i=MT(e.uri);this.file.setLabel(this._labelService.getUriBasenameLabel(e.uri),this._labelService.getUriLabel(i,{relative:!0}),{title:this._labelService.getUriLabel(e.uri),matches:t});const n=e.children.length;this.badge.setCount(n),n>1?this.badge.setTitleFormat(p("referencesCount","{0} references",n)):this.badge.setTitleFormat(p("referenceCount","{0} reference",n))}};r2=wD([SD(1,E_)],r2);var Ng;let kL=(Ng=class{constructor(e){this._instantiationService=e,this.templateId=n2.id}renderTemplate(e){return this._instantiationService.createInstance(r2,e)}renderElement(e,t,i){i.set(e.element,Nw(e.filterData))}disposeTemplate(e){e.dispose()}},n2=Ng,Ng.id="FileReferencesRenderer",Ng);kL=n2=wD([SD(0,Ce)],kL);class v1e extends F{constructor(e){super(),this.label=this._register(new rh(e))}set(e,t){const i=e.parent.getPreview(e)?.preview(e.range);if(!i||!i.value)this.label.set(`${fr(e.uri)}:${e.range.startLineNumber+1}:${e.range.startColumn+1}`);else{const{value:n,highlight:s}=i;t&&!ka.isDefault(t)?(this.label.element.classList.toggle("referenceMatch",!1),this.label.set(n,Nw(t))):(this.label.element.classList.toggle("referenceMatch",!0),this.label.set(n,[s]))}}}const uE=class uE{constructor(){this.templateId=uE.id}renderTemplate(e){return new v1e(e)}renderElement(e,t,i){i.set(e.element,e.filterData)}disposeTemplate(e){e.dispose()}};uE.id="OneReferenceRenderer";let EL=uE;class C1e{getWidgetAriaLabel(){return p("treeAriaLabel","References")}getAriaLabel(e){return e.ariaMessage}}var y1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},xp=function(o,e){return function(t,i){e(t,i,o)}};const gE=class gE{constructor(e,t){this._editor=e,this._model=t,this._decorations=new Map,this._decorationIgnoreSet=new Set,this._callOnDispose=new $,this._callOnModelChange=new $,this._callOnDispose.add(this._editor.onDidChangeModel(()=>this._onModelChanged())),this._onModelChanged()}dispose(){this._callOnModelChange.dispose(),this._callOnDispose.dispose(),this.removeDecorations()}_onModelChanged(){this._callOnModelChange.clear();const e=this._editor.getModel();if(e){for(const t of this._model.references)if(t.uri.toString()===e.uri.toString()){this._addDecorations(t.parent);return}}}_addDecorations(e){if(!this._editor.hasModel())return;this._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(()=>this._onDecorationChanged()));const t=[],i=[];for(let n=0,s=e.children.length;n<s;n++){const r=e.children[n];this._decorationIgnoreSet.has(r.id)||r.uri.toString()===this._editor.getModel().uri.toString()&&(t.push({range:r.range,options:gE.DecorationOptions}),i.push(n))}this._editor.changeDecorations(n=>{const s=n.deltaDecorations([],t);for(let r=0;r<s.length;r++)this._decorations.set(s[r],e.children[i[r]])})}_onDecorationChanged(){const e=[],t=this._editor.getModel();if(t){for(const[i,n]of this._decorations){const s=t.getDecorationRange(i);if(!s)continue;let r=!1;if(!L.equalsRange(s,n.range)){if(L.spansMultipleLines(s))r=!0;else{const a=n.range.endColumn-n.range.startColumn,l=s.endColumn-s.startColumn;a!==l&&(r=!0)}r?(this._decorationIgnoreSet.add(n.id),e.push(i)):n.range=s}}for(let i=0,n=e.length;i<n;i++)this._decorations.delete(e[i]);this._editor.removeDecorations(e)}}removeDecorations(){this._editor.removeDecorations([...this._decorations.keys()]),this._decorations.clear()}};gE.DecorationOptions=Fe.register({description:"reference-decoration",stickiness:1,className:"reference-decoration"});let a2=gE;class w1e{constructor(){this.ratio=.7,this.heightInLines=18}static fromJSON(e){let t,i;try{const n=JSON.parse(e);t=n.ratio,i=n.heightInLines}catch{}return{ratio:t||.7,heightInLines:i||18}}}class S1e extends lM{}let l2=class extends LL{constructor(e,t,i,n,s,r,a,l,c){super(e,{showFrame:!1,showArrow:!0,isResizeable:!0,isAccessible:!0,supportOnTitleClick:!0},r),this._defaultTreeKeyboardSupport=t,this.layoutData=i,this._textModelResolverService=s,this._instantiationService=r,this._peekViewService=a,this._uriLabel=l,this._keybindingService=c,this._disposeOnNewModel=new $,this._callOnDispose=new $,this._onDidSelectReference=new O,this.onDidSelectReference=this._onDidSelectReference.event,this._dim=new wt(0,0),this._isClosing=!1,this._applyTheme(n.getColorTheme()),this._callOnDispose.add(n.onDidColorThemeChange(this._applyTheme.bind(this))),this._peekViewService.addExclusiveWidget(e,this),this.create()}get isClosing(){return this._isClosing}dispose(){this._isClosing=!0,this.setModel(void 0),this._callOnDispose.dispose(),this._disposeOnNewModel.dispose(),Dt(this._preview),Dt(this._previewNotAvailableMessage),Dt(this._tree),Dt(this._previewModelReference),this._splitView.dispose(),super.dispose()}_applyTheme(e){const t=e.getColor(f1e)||j.transparent;this.style({arrowColor:t,frameColor:t,headerBackgroundColor:e.getColor(g1e)||j.transparent,primaryHeadingColor:e.getColor(qq),secondaryHeadingColor:e.getColor(Zq)})}show(e){super.show(e,this.layoutData.heightInLines||18)}focusOnReferenceTree(){this._tree.domFocus()}focusOnPreviewEditor(){this._preview.focus()}isPreviewEditorFocused(){return this._preview.hasTextFocus()}_onTitleClick(e){this._preview&&this._preview.getModel()&&this._onDidSelectReference.fire({element:this._getFocusedReference(),kind:e.ctrlKey||e.metaKey||e.altKey?"side":"open",source:"title"})}_fillBody(e){this.setCssClass("reference-zone-widget"),this._messageContainer=Y(e,ie("div.messages")),is(this._messageContainer),this._splitView=new X$(e,{orientation:1}),this._previewContainer=Y(e,ie("div.preview.inline"));const t={scrollBeyondLastLine:!1,scrollbar:{verticalScrollbarSize:14,horizontal:"auto",useShadows:!0,verticalHasArrows:!1,horizontalHasArrows:!1,alwaysConsumeMouseWheel:!0},overviewRulerLanes:2,fixedOverflowWidgets:!0,minimap:{enabled:!1}};this._preview=this._instantiationService.createInstance(jr,this._previewContainer,t,{},this.editor),is(this._previewContainer),this._previewNotAvailableMessage=this._instantiationService.createInstance(Ca,p("missingPreviewMessage","no preview available"),hs,Ca.DEFAULT_CREATION_OPTIONS,null),this._treeContainer=Y(e,ie("div.ref-tree.inline"));const i={keyboardSupport:this._defaultTreeKeyboardSupport,accessibilityProvider:new C1e,keyboardNavigationLabelProvider:this._instantiationService.createInstance(o2),identityProvider:new b1e,openOnSingleClick:!0,selectionNavigation:!0,overrideStyles:{listBackground:p1e}};this._defaultTreeKeyboardSupport&&this._callOnDispose.add(ci(this._treeContainer,"keydown",s=>{s.equals(9)&&(this._keybindingService.dispatchEvent(s,s.target),s.stopPropagation())},!0)),this._tree=this._instantiationService.createInstance(S1e,"ReferencesWidget",this._treeContainer,new _1e,[this._instantiationService.createInstance(kL),this._instantiationService.createInstance(EL)],this._instantiationService.createInstance(s2),i),this._splitView.addView({onDidChange:se.None,element:this._previewContainer,minimumSize:200,maximumSize:Number.MAX_VALUE,layout:s=>{this._preview.layout({height:this._dim.height,width:s})}},Tx.Distribute),this._splitView.addView({onDidChange:se.None,element:this._treeContainer,minimumSize:100,maximumSize:Number.MAX_VALUE,layout:s=>{this._treeContainer.style.height=`${this._dim.height}px`,this._treeContainer.style.width=`${s}px`,this._tree.layout(this._dim.height,s)}},Tx.Distribute),this._disposables.add(this._splitView.onDidSashChange(()=>{this._dim.width&&(this.layoutData.ratio=this._splitView.getViewSize(0)/this._dim.width)},void 0));const n=(s,r)=>{s instanceof Gh&&(r==="show"&&this._revealReference(s,!1),this._onDidSelectReference.fire({element:s,kind:r,source:"tree"}))};this._disposables.add(this._tree.onDidOpen(s=>{s.sideBySide?n(s.element,"side"):s.editorOptions.pinned?n(s.element,"goto"):n(s.element,"show")})),is(this._treeContainer)}_onWidth(e){this._dim&&this._doLayoutBody(this._dim.height,e)}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._dim=new wt(t,e),this.layoutData.heightInLines=this._viewZone?this._viewZone.heightInLines:this.layoutData.heightInLines,this._splitView.layout(t),this._splitView.resizeView(0,t*this.layoutData.ratio)}setSelection(e){return this._revealReference(e,!0).then(()=>{this._model&&(this._tree.setSelection([e]),this._tree.setFocus([e]))})}setModel(e){return this._disposeOnNewModel.clear(),this._model=e,this._model?this._onNewModel():Promise.resolve()}_onNewModel(){return this._model?this._model.isEmpty?(this.setTitle(""),this._messageContainer.innerText=p("noResults","No results"),Ys(this._messageContainer),Promise.resolve(void 0)):(is(this._messageContainer),this._decorationsManager=new a2(this._preview,this._model),this._disposeOnNewModel.add(this._decorationsManager),this._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(e=>this._tree.rerender(e))),this._disposeOnNewModel.add(this._preview.onMouseDown(e=>{const{event:t,target:i}=e;if(t.detail!==2)return;const n=this._getFocusedReference();n&&this._onDidSelectReference.fire({element:{uri:n.uri,range:i.range},kind:t.ctrlKey||t.metaKey||t.altKey?"side":"open",source:"editor"})})),this.container.classList.add("results-loaded"),Ys(this._treeContainer),Ys(this._previewContainer),this._splitView.layout(this._dim.width),this.focusOnReferenceTree(),this._tree.setInput(this._model.groups.length===1?this._model.groups[0]:this._model)):Promise.resolve(void 0)}_getFocusedReference(){const[e]=this._tree.getFocus();if(e instanceof Gh)return e;if(e instanceof ew&&e.children.length>0)return e.children[0]}async revealReference(e){await this._revealReference(e,!1),this._onDidSelectReference.fire({element:e,kind:"goto",source:"tree"})}async _revealReference(e,t){if(this._revealedReference===e)return;this._revealedReference=e,e.uri.scheme!==Oe.inMemory?this.setTitle(_re(e.uri),this._uriLabel.getUriLabel(MT(e.uri))):this.setTitle(p("peekView.alternateTitle","References"));const i=this._textModelResolverService.createModelReference(e.uri);this._tree.getInput()===e.parent?this._tree.reveal(e):(t&&this._tree.reveal(e.parent),await this._tree.expand(e.parent),this._tree.reveal(e));const n=await i;if(!this._model){n.dispose();return}Dt(this._previewModelReference);const s=n.object;if(s){const r=this._preview.getModel()===s.textEditorModel?0:1,a=L.lift(e.range).collapseToStart();this._previewModelReference=n,this._preview.setModel(s.textEditorModel),this._preview.setSelection(a),this._preview.revealRangeInCenter(a,r)}else this._preview.setModel(this._previewNotAvailableMessage),n.dispose()}};l2=y1e([xp(3,zi),xp(4,Ms),xp(5,Ce),xp(6,jq),xp(7,E_),xp(8,vt)],l2);var x1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Lp=function(o,e){return function(t,i){e(t,i,o)}},o0;const sp=new re("referenceSearchVisible",!1,p("referenceSearchVisible","Whether reference peek is visible, like 'Peek References' or 'Peek Definition'"));var Rg;let Bf=(Rg=class{static get(e){return e.getContribution(o0.ID)}constructor(e,t,i,n,s,r,a,l){this._defaultTreeKeyboardSupport=e,this._editor=t,this._editorService=n,this._notificationService=s,this._instantiationService=r,this._storageService=a,this._configurationService=l,this._disposables=new $,this._requestIdPool=0,this._ignoreModelChangeEvent=!1,this._referenceSearchVisible=sp.bindTo(i)}dispose(){this._referenceSearchVisible.reset(),this._disposables.dispose(),this._widget?.dispose(),this._model?.dispose(),this._widget=void 0,this._model=void 0}toggleWidget(e,t,i){let n;if(this._widget&&(n=this._widget.position),this.closeWidget(),n&&e.containsPosition(n))return;this._peekMode=i,this._referenceSearchVisible.set(!0),this._disposables.add(this._editor.onDidChangeModelLanguage(()=>{this.closeWidget()})),this._disposables.add(this._editor.onDidChangeModel(()=>{this._ignoreModelChangeEvent||this.closeWidget()}));const s="peekViewLayout",r=w1e.fromJSON(this._storageService.get(s,0,"{}"));this._widget=this._instantiationService.createInstance(l2,this._editor,this._defaultTreeKeyboardSupport,r),this._widget.setTitle(p("labelLoading","Loading...")),this._widget.show(e),this._disposables.add(this._widget.onDidClose(()=>{t.cancel(),this._widget?(this._storageService.store(s,JSON.stringify(this._widget.layoutData),0,1),this._widget.isClosing||this.closeWidget(),this._widget=void 0):this.closeWidget()})),this._disposables.add(this._widget.onDidSelectReference(l=>{const{element:c,kind:d}=l;if(c)switch(d){case"open":(l.source!=="editor"||!this._configurationService.getValue("editor.stablePeek"))&&this.openReference(c,!1,!1);break;case"side":this.openReference(c,!0,!1);break;case"goto":i?this._gotoReference(c,!0):this.openReference(c,!1,!0);break}}));const a=++this._requestIdPool;t.then(l=>{if(a!==this._requestIdPool||!this._widget){l.dispose();return}return this._model?.dispose(),this._model=l,this._widget.setModel(this._model).then(()=>{if(this._widget&&this._model&&this._editor.hasModel()){this._model.isEmpty?this._widget.setMetaTitle(""):this._widget.setMetaTitle(p("metaTitle.N","{0} ({1})",this._model.title,this._model.references.length));const c=this._editor.getModel().uri,d=new A(e.startLineNumber,e.startColumn),h=this._model.nearestReference(c,d);if(h)return this._widget.setSelection(h).then(()=>{this._widget&&this._editor.getOption(87)==="editor"&&this._widget.focusOnPreviewEditor()})}})},l=>{this._notificationService.error(l)})}changeFocusBetweenPreviewAndReferences(){this._widget&&(this._widget.isPreviewEditorFocused()?this._widget.focusOnReferenceTree():this._widget.focusOnPreviewEditor())}async goToNextOrPreviousReference(e){if(!this._editor.hasModel()||!this._model||!this._widget)return;const t=this._widget.position;if(!t)return;const i=this._model.nearestReference(this._editor.getModel().uri,t);if(!i)return;const n=this._model.nextOrPreviousReference(i,e),s=this._editor.hasTextFocus(),r=this._widget.isPreviewEditorFocused();await this._widget.setSelection(n),await this._gotoReference(n,!1),s?this._editor.focus():this._widget&&r&&this._widget.focusOnPreviewEditor()}async revealReference(e){!this._editor.hasModel()||!this._model||!this._widget||await this._widget.revealReference(e)}closeWidget(e=!0){this._widget?.dispose(),this._model?.dispose(),this._referenceSearchVisible.reset(),this._disposables.clear(),this._widget=void 0,this._model=void 0,e&&this._editor.focus(),this._requestIdPool+=1}_gotoReference(e,t){this._widget?.hide(),this._ignoreModelChangeEvent=!0;const i=L.lift(e.range).collapseToStart();return this._editorService.openCodeEditor({resource:e.uri,options:{selection:i,selectionSource:"code.jump",pinned:t}},this._editor).then(n=>{if(this._ignoreModelChangeEvent=!1,!n||!this._widget){this.closeWidget();return}if(this._editor===n)this._widget.show(i),this._widget.focusOnReferenceTree();else{const s=o0.get(n),r=this._model.clone();this.closeWidget(),n.focus(),s?.toggleWidget(i,ji(a=>Promise.resolve(r)),this._peekMode??!1)}},n=>{this._ignoreModelChangeEvent=!1,Ae(n)})}openReference(e,t,i){t||this.closeWidget();const{uri:n,range:s}=e;this._editorService.openCodeEditor({resource:n,options:{selection:s,selectionSource:"code.jump",pinned:i}},this._editor,t)}},o0=Rg,Rg.ID="editor.contrib.referencesController",Rg);Bf=o0=x1e([Lp(2,Ee),Lp(3,gt),Lp(4,Ei),Lp(5,Ce),Lp(6,Yr),Lp(7,Ke)],Bf);function op(o,e){const t=h1e(o);if(!t)return;const i=Bf.get(t);i&&e(i)}fs.registerCommandAndKeybindingRule({id:"togglePeekWidgetFocus",weight:100,primary:Fi(2089,60),when:K.or(sp,Ps.inPeekEditor),handler(o){op(o,e=>{e.changeFocusBetweenPreviewAndReferences()})}});fs.registerCommandAndKeybindingRule({id:"goToNextReference",weight:90,primary:62,secondary:[70],when:K.or(sp,Ps.inPeekEditor),handler(o){op(o,e=>{e.goToNextOrPreviousReference(!0)})}});fs.registerCommandAndKeybindingRule({id:"goToPreviousReference",weight:90,primary:1086,secondary:[1094],when:K.or(sp,Ps.inPeekEditor),handler(o){op(o,e=>{e.goToNextOrPreviousReference(!1)})}});st.registerCommandAlias("goToNextReferenceFromEmbeddedEditor","goToNextReference");st.registerCommandAlias("goToPreviousReferenceFromEmbeddedEditor","goToPreviousReference");st.registerCommandAlias("closeReferenceSearchEditor","closeReferenceSearch");st.registerCommand("closeReferenceSearch",o=>op(o,e=>e.closeWidget()));fs.registerKeybindingRule({id:"closeReferenceSearch",weight:-1,primary:9,secondary:[1033],when:K.and(Ps.inPeekEditor,K.not("config.editor.stablePeek"))});fs.registerKeybindingRule({id:"closeReferenceSearch",weight:250,primary:9,secondary:[1033],when:K.and(sp,K.not("config.editor.stablePeek"),K.or(T.editorTextFocus,aK.negate()))});fs.registerCommandAndKeybindingRule({id:"revealReference",weight:200,primary:3,mac:{primary:3,secondary:[2066]},when:K.and(sp,dK,hB.negate(),uB.negate()),handler(o){const t=o.get(Cr).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof Gh&&op(o,i=>i.revealReference(t[0]))}});fs.registerCommandAndKeybindingRule({id:"openReferenceToSide",weight:100,primary:2051,mac:{primary:259},when:K.and(sp,dK,hB.negate(),uB.negate()),handler(o){const t=o.get(Cr).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof Gh&&op(o,i=>i.openReference(t[0],!0,!0))}});st.registerCommand("openReference",o=>{const t=o.get(Cr).lastFocusedList?.getFocus();Array.isArray(t)&&t[0]instanceof Gh&&op(o,i=>i.openReference(t[0],!1,!0))});var Xq=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},wv=function(o,e){return function(t,i){e(t,i,o)}};const wW=new re("hasSymbols",!1,p("hasSymbols","Whether there are symbol locations that can be navigated via keyboard-only.")),xD=Je("ISymbolNavigationService");let c2=class{constructor(e,t,i,n){this._editorService=t,this._notificationService=i,this._keybindingService=n,this._currentModel=void 0,this._currentIdx=-1,this._ignoreEditorChange=!1,this._ctxHasSymbols=wW.bindTo(e)}reset(){this._ctxHasSymbols.reset(),this._currentState?.dispose(),this._currentMessage?.dispose(),this._currentModel=void 0,this._currentIdx=-1}put(e){const t=e.parent.parent;if(t.references.length<=1){this.reset();return}this._currentModel=t,this._currentIdx=t.references.indexOf(e),this._ctxHasSymbols.set(!0),this._showMessage();const i=new d2(this._editorService),n=i.onDidChange(s=>{if(this._ignoreEditorChange)return;const r=this._editorService.getActiveCodeEditor();if(!r)return;const a=r.getModel(),l=r.getPosition();if(!a||!l)return;let c=!1,d=!1;for(const h of t.references)if(gy(h.uri,a.uri))c=!0,d=d||L.containsPosition(h.range,l);else if(c)break;(!c||!d)&&this.reset()});this._currentState=Wr(i,n)}revealNext(e){if(!this._currentModel)return Promise.resolve();this._currentIdx+=1,this._currentIdx%=this._currentModel.references.length;const t=this._currentModel.references[this._currentIdx];return this._showMessage(),this._ignoreEditorChange=!0,this._editorService.openCodeEditor({resource:t.uri,options:{selection:L.collapseToStart(t.range),selectionRevealType:3}},e).finally(()=>{this._ignoreEditorChange=!1})}_showMessage(){this._currentMessage?.dispose();const e=this._keybindingService.lookupKeybinding("editor.gotoNextSymbolFromResult"),t=e?p("location.kb","Symbol {0} of {1}, {2} for next",this._currentIdx+1,this._currentModel.references.length,e.getLabel()):p("location","Symbol {0} of {1}",this._currentIdx+1,this._currentModel.references.length);this._currentMessage=this._notificationService.status(t)}};c2=Xq([wv(0,Ee),wv(1,gt),wv(2,Ei),wv(3,vt)],c2);it(xD,c2,1);oe(new class extends Hi{constructor(){super({id:"editor.gotoNextSymbolFromResult",precondition:wW,kbOpts:{weight:100,primary:70}})}runEditorCommand(o,e){return o.get(xD).revealNext(e)}});fs.registerCommandAndKeybindingRule({id:"editor.gotoNextSymbolFromResult.cancel",weight:100,when:wW,primary:9,handler(o){o.get(xD).reset()}});let d2=class{constructor(e){this._listener=new Map,this._disposables=new $,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._disposables.add(e.onCodeEditorRemove(this._onDidRemoveEditor,this)),this._disposables.add(e.onCodeEditorAdd(this._onDidAddEditor,this)),e.listCodeEditors().forEach(this._onDidAddEditor,this)}dispose(){this._disposables.dispose(),this._onDidChange.dispose(),Dt(this._listener.values())}_onDidAddEditor(e){this._listener.set(e,Wr(e.onDidChangeCursorPosition(t=>this._onDidChange.fire({editor:e})),e.onDidChangeModelContent(t=>this._onDidChange.fire({editor:e}))))}_onDidRemoveEditor(e){this._listener.get(e)?.dispose(),this._listener.delete(e)}};d2=Xq([wv(0,gt)],d2);function h2(o,e){return e.uri.scheme===o.uri.scheme?!0:!aP(e.uri,Oe.walkThroughSnippet,Oe.vscodeChatCodeBlock,Oe.vscodeChatCodeCompareBlock)}async function tS(o,e,t,i,n){const r=t.ordered(o,i).map(l=>Promise.resolve(n(l,o,e)).then(void 0,c=>{yi(c)})),a=await Promise.all(r);return Vr(a.flat()).filter(l=>h2(o,l))}function iS(o,e,t,i,n){return tS(e,t,o,i,(s,r,a)=>s.provideDefinition(r,a,n))}function SW(o,e,t,i,n){return tS(e,t,o,i,(s,r,a)=>s.provideDeclaration(r,a,n))}function xW(o,e,t,i,n){return tS(e,t,o,i,(s,r,a)=>s.provideImplementation(r,a,n))}function LW(o,e,t,i,n){return tS(e,t,o,i,(s,r,a)=>s.provideTypeDefinition(r,a,n))}function nS(o,e,t,i,n,s){return tS(e,t,o,n,async(r,a,l)=>{const c=(await r.provideReferences(a,l,{includeDeclaration:!0},s))?.filter(h=>h2(a,h));if(!i||!c||c.length!==2)return c;const d=(await r.provideReferences(a,l,{includeDeclaration:!1},s))?.filter(h=>h2(a,h));return d&&d.length===1?d:c})}async function $l(o){const e=await o(),t=new so(e,""),i=t.references.map(n=>n.link);return t.dispose(),i}Os("_executeDefinitionProvider",(o,e,t)=>{const i=o.get(ue),n=iS(i.definitionProvider,e,t,!1,He.None);return $l(()=>n)});Os("_executeDefinitionProvider_recursive",(o,e,t)=>{const i=o.get(ue),n=iS(i.definitionProvider,e,t,!0,He.None);return $l(()=>n)});Os("_executeTypeDefinitionProvider",(o,e,t)=>{const i=o.get(ue),n=LW(i.typeDefinitionProvider,e,t,!1,He.None);return $l(()=>n)});Os("_executeTypeDefinitionProvider_recursive",(o,e,t)=>{const i=o.get(ue),n=LW(i.typeDefinitionProvider,e,t,!0,He.None);return $l(()=>n)});Os("_executeDeclarationProvider",(o,e,t)=>{const i=o.get(ue),n=SW(i.declarationProvider,e,t,!1,He.None);return $l(()=>n)});Os("_executeDeclarationProvider_recursive",(o,e,t)=>{const i=o.get(ue),n=SW(i.declarationProvider,e,t,!0,He.None);return $l(()=>n)});Os("_executeReferenceProvider",(o,e,t)=>{const i=o.get(ue),n=nS(i.referenceProvider,e,t,!1,!1,He.None);return $l(()=>n)});Os("_executeReferenceProvider_recursive",(o,e,t)=>{const i=o.get(ue),n=nS(i.referenceProvider,e,t,!1,!0,He.None);return $l(()=>n)});Os("_executeImplementationProvider",(o,e,t)=>{const i=o.get(ue),n=xW(i.implementationProvider,e,t,!1,He.None);return $l(()=>n)});Os("_executeImplementationProvider_recursive",(o,e,t)=>{const i=o.get(ue),n=xW(i.implementationProvider,e,t,!0,He.None);return $l(()=>n)});sn.appendMenuItem(fe.EditorContext,{submenu:fe.EditorContextPeek,title:p("peek.submenu","Peek"),group:"navigation",order:100});class U_{static is(e){return!e||typeof e!="object"?!1:!!(e instanceof U_||A.isIPosition(e.position)&&e.model)}constructor(e,t){this.model=e,this.position=t}}const Tr=class Tr extends Fa{static all(){return Tr._allSymbolNavigationCommands.values()}static _patchConfig(e){const t={...e,f1:!0};if(t.menu)for(const i of nt.wrap(t.menu))(i.id===fe.EditorContext||i.id===fe.EditorContextPeek)&&(i.when=K.and(e.precondition,i.when));return t}constructor(e,t){super(Tr._patchConfig(t)),this.configuration=e,Tr._allSymbolNavigationCommands.set(t.id,this)}runEditorCommand(e,t,i,n){if(!t.hasModel())return Promise.resolve(void 0);const s=e.get(Ei),r=e.get(gt),a=e.get(Yh),l=e.get(xD),c=e.get(ue),d=e.get(Ce),h=t.getModel(),u=t.getPosition(),g=U_.is(i)?i:new U_(h,u),f=new zh(t,5),m=Lw(this._getLocationModel(c,g.model,g.position,f.token),f.token).then(async _=>{if(!_||f.token.isCancellationRequested)return;ps(_.ariaMessage);let b;if(_.referenceAt(h.uri,u)){const y=this._getAlternativeCommand(t);!Tr._activeAlternativeCommands.has(y)&&Tr._allSymbolNavigationCommands.has(y)&&(b=Tr._allSymbolNavigationCommands.get(y))}const v=_.references.length;if(v===0){if(!this.configuration.muteMessage){const y=h.getWordAtPosition(u);no.get(t)?.showMessage(this._getNoResultFoundMessage(y),u)}}else if(v===1&&b)Tr._activeAlternativeCommands.add(this.desc.id),d.invokeFunction(y=>b.runEditorCommand(y,t,i,n).finally(()=>{Tr._activeAlternativeCommands.delete(this.desc.id)}));else return this._onResult(r,l,t,_,n)},_=>{s.error(_)}).finally(()=>{f.dispose()});return a.showWhile(m,250),m}async _onResult(e,t,i,n,s){const r=this._getGoToPreference(i);if(!(i instanceof jr)&&(this.configuration.openInPeek||r==="peek"&&n.references.length>1))this._openInPeek(i,n,s);else{const a=n.firstReference(),l=n.references.length>1&&r==="gotoAndPeek",c=await this._openReference(i,e,a,this.configuration.openToSide,!l);l&&c?this._openInPeek(c,n,s):n.dispose(),r==="goto"&&t.put(a)}}async _openReference(e,t,i,n,s){let r;if(DQ(i)&&(r=i.targetSelectionRange),r||(r=i.range),!r)return;const a=await t.openCodeEditor({resource:i.uri,options:{selection:L.collapseToStart(r),selectionRevealType:3,selectionSource:"code.jump"}},e,n);if(a){if(s){const l=a.getModel(),c=a.createDecorationsCollection([{range:r,options:{description:"symbol-navigate-action-highlight",className:"symbolHighlight"}}]);setTimeout(()=>{a.getModel()===l&&c.clear()},350)}return a}}_openInPeek(e,t,i){const n=Bf.get(e);n&&e.hasModel()?n.toggleWidget(i??e.getSelection(),ji(s=>Promise.resolve(t)),this.configuration.openInPeek):t.dispose()}};Tr._allSymbolNavigationCommands=new Map,Tr._activeAlternativeCommands=new Set;let Jc=Tr;class sS extends Jc{async _getLocationModel(e,t,i,n){return new so(await iS(e.definitionProvider,t,i,!1,n),p("def.title","Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?p("noResultWord","No definition found for '{0}'",e.word):p("generic.noResults","No definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleDefinitions}}var fh;At((fh=class extends sS{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:fh.id,title:{...De("actions.goToDecl.label","Go to Definition"),mnemonicTitle:p({key:"miGotoDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Definition")},precondition:T.hasDefinitionProvider,keybinding:[{when:T.editorTextFocus,primary:70,weight:100},{when:K.and(T.editorTextFocus,oK),primary:2118,weight:100}],menu:[{id:fe.EditorContext,group:"navigation",order:1.1},{id:fe.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:2}]}),st.registerCommandAlias("editor.action.goToDeclaration",fh.id)}},fh.id="editor.action.revealDefinition",fh));var ph;At((ph=class extends sS{constructor(){super({openToSide:!0,openInPeek:!1,muteMessage:!1},{id:ph.id,title:De("actions.goToDeclToSide.label","Open Definition to the Side"),precondition:K.and(T.hasDefinitionProvider,T.isInEmbeddedEditor.toNegated()),keybinding:[{when:T.editorTextFocus,primary:Fi(2089,70),weight:100},{when:K.and(T.editorTextFocus,oK),primary:Fi(2089,2118),weight:100}]}),st.registerCommandAlias("editor.action.openDeclarationToTheSide",ph.id)}},ph.id="editor.action.revealDefinitionAside",ph));var mh;At((mh=class extends sS{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:mh.id,title:De("actions.previewDecl.label","Peek Definition"),precondition:K.and(T.hasDefinitionProvider,Ps.notInPeekEditor,T.isInEmbeddedEditor.toNegated()),keybinding:{when:T.editorTextFocus,primary:582,linux:{primary:3140},weight:100},menu:{id:fe.EditorContextPeek,group:"peek",order:2}}),st.registerCommandAlias("editor.action.previewDeclaration",mh.id)}},mh.id="editor.action.peekDefinition",mh));class Qq extends Jc{async _getLocationModel(e,t,i,n){return new so(await SW(e.declarationProvider,t,i,!1,n),p("decl.title","Declarations"))}_getNoResultFoundMessage(e){return e&&e.word?p("decl.noResultWord","No declaration found for '{0}'",e.word):p("decl.generic.noResults","No declaration found")}_getAlternativeCommand(e){return e.getOption(58).alternativeDeclarationCommand}_getGoToPreference(e){return e.getOption(58).multipleDeclarations}}var Pg;At((Pg=class extends Qq{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Pg.id,title:{...De("actions.goToDeclaration.label","Go to Declaration"),mnemonicTitle:p({key:"miGotoDeclaration",comment:["&& denotes a mnemonic"]},"Go to &&Declaration")},precondition:K.and(T.hasDeclarationProvider,T.isInEmbeddedEditor.toNegated()),menu:[{id:fe.EditorContext,group:"navigation",order:1.3},{id:fe.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}_getNoResultFoundMessage(e){return e&&e.word?p("decl.noResultWord","No declaration found for '{0}'",e.word):p("decl.generic.noResults","No declaration found")}},Pg.id="editor.action.revealDeclaration",Pg));At(class extends Qq{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.peekDeclaration",title:De("actions.peekDecl.label","Peek Declaration"),precondition:K.and(T.hasDeclarationProvider,Ps.notInPeekEditor,T.isInEmbeddedEditor.toNegated()),menu:{id:fe.EditorContextPeek,group:"peek",order:3}})}});class Jq extends Jc{async _getLocationModel(e,t,i,n){return new so(await LW(e.typeDefinitionProvider,t,i,!1,n),p("typedef.title","Type Definitions"))}_getNoResultFoundMessage(e){return e&&e.word?p("goToTypeDefinition.noResultWord","No type definition found for '{0}'",e.word):p("goToTypeDefinition.generic.noResults","No type definition found")}_getAlternativeCommand(e){return e.getOption(58).alternativeTypeDefinitionCommand}_getGoToPreference(e){return e.getOption(58).multipleTypeDefinitions}}var Ag;At((Ag=class extends Jq{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Ag.ID,title:{...De("actions.goToTypeDefinition.label","Go to Type Definition"),mnemonicTitle:p({key:"miGotoTypeDefinition",comment:["&& denotes a mnemonic"]},"Go to &&Type Definition")},precondition:T.hasTypeDefinitionProvider,keybinding:{when:T.editorTextFocus,primary:0,weight:100},menu:[{id:fe.EditorContext,group:"navigation",order:1.4},{id:fe.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:3}]})}},Ag.ID="editor.action.goToTypeDefinition",Ag));var Mg;At((Mg=class extends Jq{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:Mg.ID,title:De("actions.peekTypeDefinition.label","Peek Type Definition"),precondition:K.and(T.hasTypeDefinitionProvider,Ps.notInPeekEditor,T.isInEmbeddedEditor.toNegated()),menu:{id:fe.EditorContextPeek,group:"peek",order:4}})}},Mg.ID="editor.action.peekTypeDefinition",Mg));class eZ extends Jc{async _getLocationModel(e,t,i,n){return new so(await xW(e.implementationProvider,t,i,!1,n),p("impl.title","Implementations"))}_getNoResultFoundMessage(e){return e&&e.word?p("goToImplementation.noResultWord","No implementation found for '{0}'",e.word):p("goToImplementation.generic.noResults","No implementation found")}_getAlternativeCommand(e){return e.getOption(58).alternativeImplementationCommand}_getGoToPreference(e){return e.getOption(58).multipleImplementations}}var Og;At((Og=class extends eZ{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:Og.ID,title:{...De("actions.goToImplementation.label","Go to Implementations"),mnemonicTitle:p({key:"miGotoImplementation",comment:["&& denotes a mnemonic"]},"Go to &&Implementations")},precondition:T.hasImplementationProvider,keybinding:{when:T.editorTextFocus,primary:2118,weight:100},menu:[{id:fe.EditorContext,group:"navigation",order:1.45},{id:fe.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:4}]})}},Og.ID="editor.action.goToImplementation",Og));var Fg;At((Fg=class extends eZ{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:Fg.ID,title:De("actions.peekImplementation.label","Peek Implementations"),precondition:K.and(T.hasImplementationProvider,Ps.notInPeekEditor,T.isInEmbeddedEditor.toNegated()),keybinding:{when:T.editorTextFocus,primary:3142,weight:100},menu:{id:fe.EditorContextPeek,group:"peek",order:5}})}},Fg.ID="editor.action.peekImplementation",Fg));class tZ extends Jc{_getNoResultFoundMessage(e){return e?p("references.no","No references found for '{0}'",e.word):p("references.noGeneric","No references found")}_getAlternativeCommand(e){return e.getOption(58).alternativeReferenceCommand}_getGoToPreference(e){return e.getOption(58).multipleReferences}}At(class extends tZ{constructor(){super({openToSide:!1,openInPeek:!1,muteMessage:!1},{id:"editor.action.goToReferences",title:{...De("goToReferences.label","Go to References"),mnemonicTitle:p({key:"miGotoReference",comment:["&& denotes a mnemonic"]},"Go to &&References")},precondition:K.and(T.hasReferenceProvider,Ps.notInPeekEditor,T.isInEmbeddedEditor.toNegated()),keybinding:{when:T.editorTextFocus,primary:1094,weight:100},menu:[{id:fe.EditorContext,group:"navigation",order:1.45},{id:fe.MenubarGoMenu,precondition:null,group:"4_symbol_nav",order:5}]})}async _getLocationModel(e,t,i,n){return new so(await nS(e.referenceProvider,t,i,!0,!1,n),p("ref.title","References"))}});At(class extends tZ{constructor(){super({openToSide:!1,openInPeek:!0,muteMessage:!1},{id:"editor.action.referenceSearch.trigger",title:De("references.action.label","Peek References"),precondition:K.and(T.hasReferenceProvider,Ps.notInPeekEditor,T.isInEmbeddedEditor.toNegated()),menu:{id:fe.EditorContextPeek,group:"peek",order:6}})}async _getLocationModel(e,t,i,n){return new so(await nS(e.referenceProvider,t,i,!1,!1,n),p("ref.title","References"))}});class L1e extends Jc{constructor(e,t,i){super(e,{id:"editor.action.goToLocation",title:De("label.generic","Go to Any Symbol"),precondition:K.and(Ps.notInPeekEditor,T.isInEmbeddedEditor.toNegated())}),this._references=t,this._gotoMultipleBehaviour=i}async _getLocationModel(e,t,i,n){return new so(this._references,p("generic.title","Locations"))}_getNoResultFoundMessage(e){return e&&p("generic.noResult","No results for '{0}'",e.word)||""}_getGoToPreference(e){return this._gotoMultipleBehaviour??e.getOption(58).multipleReferences}_getAlternativeCommand(){return""}}st.registerCommand({id:"editor.action.goToLocations",metadata:{description:"Go to locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:ye},{name:"position",description:"The position at which to start",constraint:A.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"},{name:"noResultsMessage",description:"Human readable message that shows when locations is empty."}]},handler:async(o,e,t,i,n,s,r)=>{ut(ye.isUri(e)),ut(A.isIPosition(t)),ut(Array.isArray(i)),ut(typeof n>"u"||typeof n=="string"),ut(typeof r>"u"||typeof r=="boolean");const a=o.get(gt),l=await a.openCodeEditor({resource:e},a.getFocusedCodeEditor());if(Fl(l))return l.setPosition(t),l.revealPositionInCenterIfOutsideViewport(t,0),l.invokeWithinContext(c=>{const d=new class extends L1e{_getNoResultFoundMessage(h){return s||super._getNoResultFoundMessage(h)}}({muteMessage:!s,openInPeek:!!r,openToSide:!1},i,n);c.get(Ce).invokeFunction(d.run.bind(d),l)})}});st.registerCommand({id:"editor.action.peekLocations",metadata:{description:"Peek locations from a position in a file",args:[{name:"uri",description:"The text document in which to start",constraint:ye},{name:"position",description:"The position at which to start",constraint:A.isIPosition},{name:"locations",description:"An array of locations.",constraint:Array},{name:"multiple",description:"Define what to do when having multiple results, either `peek`, `gotoAndPeek`, or `goto`"}]},handler:async(o,e,t,i,n)=>{o.get(Ft).executeCommand("editor.action.goToLocations",e,t,i,n,void 0,!0)}});st.registerCommand({id:"editor.action.findReferences",handler:(o,e,t)=>{ut(ye.isUri(e)),ut(A.isIPosition(t));const i=o.get(ue),n=o.get(gt);return n.openCodeEditor({resource:e},n.getFocusedCodeEditor()).then(s=>{if(!Fl(s)||!s.hasModel())return;const r=Bf.get(s);if(!r)return;const a=ji(c=>nS(i.referenceProvider,s.getModel(),A.lift(t),!1,!1,c).then(d=>new so(d,p("ref.title","References")))),l=new L(t.lineNumber,t.column,t.lineNumber,t.column);return Promise.resolve(r.toggleWidget(l,a,!1))})}});st.registerCommandAlias("editor.action.showReferences","editor.action.peekLocations");async function k1e(o,e,t,i){const n=o.get(Ms),s=o.get(co),r=o.get(Ft),a=o.get(Ce),l=o.get(Ei);if(await i.item.resolve(He.None),!i.part.location)return;const c=i.part.location,d=[],h=new Set(sn.getMenuItems(fe.EditorContext).map(g=>Rm(g)?g.command.id:mD()));for(const g of Jc.all())h.has(g.desc.id)&&d.push(new to(g.desc.id,io.label(g.desc,{renderShortTitle:!0}),void 0,!0,async()=>{const f=await n.createModelReference(c.uri);try{const m=new U_(f.object.textEditorModel,L.getStartPosition(c.range)),_=i.item.anchor.range;await a.invokeFunction(g.runEditorCommand.bind(g),e,m,_)}finally{f.dispose()}}));if(i.part.command){const{command:g}=i.part;d.push(new Zi),d.push(new to(g.id,g.title,void 0,!0,async()=>{try{await r.executeCommand(g.id,...g.arguments??[])}catch(f){l.notify({severity:ST.Error,source:i.item.provider.displayName,message:f})}}))}const u=e.getOption(128);s.showContextMenu({domForShadowRoot:u?e.getDomNode()??void 0:void 0,getAnchor:()=>{const g=Ci(t);return{x:g.left,y:g.top+g.height+8}},getActions:()=>d,onHide:()=>{e.focus()},autoSelectFirstItem:!0})}async function iZ(o,e,t,i){const s=await o.get(Ms).createModelReference(i.uri);await t.invokeWithinContext(async r=>{const a=e.hasSideBySideModifier,l=r.get(Ee),c=Ps.inPeekEditor.getValue(l),d=!a&&t.getOption(89)&&!c;return new sS({openToSide:a,openInPeek:d,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(r,new U_(s.object.textEditorModel,L.getStartPosition(i.range)),L.lift(i.range))}),s.dispose()}var E1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},kp=function(o,e){return function(t,i){e(t,i,o)}},Wp;class TL{constructor(){this._entries=new Vl(50)}get(e){const t=TL._key(e);return this._entries.get(t)}set(e,t){const i=TL._key(e);this._entries.set(i,t)}static _key(e){return`${e.uri.toString()}/${e.getVersionId()}`}}const nZ=Je("IInlayHintsCache");it(nZ,TL,1);class u2{constructor(e,t){this.item=e,this.index=t}get part(){const e=this.item.hint.label;return typeof e=="string"?{label:e}:e[this.index]}}class T1e{constructor(e,t){this.part=e,this.hasTriggerModifier=t}}var Oc;let tw=(Oc=class{static get(e){return e.getContribution(Wp.ID)??void 0}constructor(e,t,i,n,s,r,a){this._editor=e,this._languageFeaturesService=t,this._inlayHintsCache=n,this._commandService=s,this._notificationService=r,this._instaService=a,this._disposables=new $,this._sessionDisposables=new $,this._decorationsMetadata=new Map,this._ruleFactory=new Kx(this._editor),this._activeRenderMode=0,this._debounceInfo=i.for(t.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(t.inlayHintsProvider.onDidChange(()=>this._update())),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(l=>{l.hasChanged(142)&&this._update()})),this._update()}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const e=this._editor.getOption(142);if(e.enabled==="off")return;const t=this._editor.getModel();if(!t||!this._languageFeaturesService.inlayHintsProvider.has(t))return;if(e.enabled==="on")this._activeRenderMode=0;else{let a,l;e.enabled==="onUnlessPressed"?(a=0,l=1):(a=1,l=0),this._activeRenderMode=a,this._sessionDisposables.add(Lc.getInstance().event(c=>{if(!this._editor.hasModel())return;const d=c.altKey&&c.ctrlKey&&!(c.shiftKey||c.metaKey)?l:a;if(d!==this._activeRenderMode){this._activeRenderMode=d;const h=this._editor.getModel(),u=this._copyInlayHintsWithCurrentAnchor(h);this._updateHintsDecorators([h.getFullModelRange()],u),r.schedule(0)}}))}const i=this._inlayHintsCache.get(t);i&&this._updateHintsDecorators([t.getFullModelRange()],i),this._sessionDisposables.add(ve(()=>{t.isDisposed()||this._cacheHintsForFastRestore(t)}));let n;const s=new Set,r=new xt(async()=>{const a=Date.now();n?.dispose(!0),n=new ri;const l=t.onWillDispose(()=>n?.cancel());try{const c=n.token,d=await SL.create(this._languageFeaturesService.inlayHintsProvider,t,this._getHintsRanges(),c);if(r.delay=this._debounceInfo.update(t,Date.now()-a),c.isCancellationRequested){d.dispose();return}for(const h of d.provider)typeof h.onDidChangeInlayHints=="function"&&!s.has(h)&&(s.add(h),this._sessionDisposables.add(h.onDidChangeInlayHints(()=>{r.isScheduled()||r.schedule()})));this._sessionDisposables.add(d),this._updateHintsDecorators(d.ranges,d.items),this._cacheHintsForFastRestore(t)}catch(c){Ae(c)}finally{n.dispose(),l.dispose()}},this._debounceInfo.get(t));this._sessionDisposables.add(r),this._sessionDisposables.add(ve(()=>n?.dispose(!0))),r.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange(a=>{(a.scrollTopChanged||!r.isScheduled())&&r.schedule()})),this._sessionDisposables.add(this._editor.onDidChangeModelContent(a=>{n?.cancel();const l=Math.max(r.delay,1250);r.schedule(l)})),this._sessionDisposables.add(this._installDblClickGesture(()=>r.schedule(0))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const e=new $,t=e.add(new yD(this._editor)),i=new $;return e.add(i),e.add(t.onMouseMoveOrRelevantKeyDown(n=>{const[s]=n,r=this._getInlayHintLabelPart(s),a=this._editor.getModel();if(!r||!a){i.clear();return}const l=new ri;i.add(ve(()=>l.dispose(!0))),r.item.resolve(l.token),this._activeInlayHintPart=r.part.command||r.part.location?new T1e(r,s.hasTriggerModifier):void 0;const c=a.validatePosition(r.item.hint.position).lineNumber,d=new L(c,1,c,a.getLineMaxColumn(c)),h=this._getInlineHintsForRange(d);this._updateHintsDecorators([d],h),i.add(ve(()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([d],h)}))})),e.add(t.onCancel(()=>i.clear())),e.add(t.onExecute(async n=>{const s=this._getInlayHintLabelPart(n);if(s){const r=s.part;r.location?this._instaService.invokeFunction(iZ,n,this._editor,r.location):rR.is(r.command)&&await this._invokeCommand(r.command,s.item)}})),e}_getInlineHintsForRange(e){const t=new Set;for(const i of this._decorationsMetadata.values())e.containsRange(i.item.anchor.range)&&t.add(i.item);return Array.from(t)}_installDblClickGesture(e){return this._editor.onMouseUp(async t=>{if(t.event.detail!==2)return;const i=this._getInlayHintLabelPart(t);if(i&&(t.event.preventDefault(),await i.item.resolve(He.None),Yn(i.item.hint.textEdits))){const n=i.item.hint.textEdits.map(s=>si.replace(L.lift(s.range),s.text));this._editor.executeEdits("inlayHint.default",n),e()}})}_installContextMenu(){return this._editor.onContextMenu(async e=>{if(!qi(e.event.target))return;const t=this._getInlayHintLabelPart(e);t&&await this._instaService.invokeFunction(k1e,this._editor,e.event.target,t)})}_getInlayHintLabelPart(e){if(e.target.type!==6)return;const t=e.target.detail.injectedText?.options;if(t instanceof Wh&&t?.attachedData instanceof u2)return t.attachedData}async _invokeCommand(e,t){try{await this._commandService.executeCommand(e.id,...e.arguments??[])}catch(i){this._notificationService.notify({severity:ST.Error,source:t.provider.displayName,message:i})}}_cacheHintsForFastRestore(e){const t=this._copyInlayHintsWithCurrentAnchor(e);this._inlayHintsCache.set(e,t)}_copyInlayHintsWithCurrentAnchor(e){const t=new Map;for(const[i,n]of this._decorationsMetadata){if(t.has(n.item))continue;const s=e.getDecorationRange(i);if(s){const r=new Gq(s,n.item.anchor.direction),a=n.item.with({anchor:r});t.set(n.item,a)}}return Array.from(t.values())}_getHintsRanges(){const t=this._editor.getModel(),i=this._editor.getVisibleRangesPlusViewportAboveBelow(),n=[];for(const s of i.sort(L.compareRangesUsingStarts)){const r=t.validateRange(new L(s.startLineNumber-30,s.startColumn,s.endLineNumber+30,s.endColumn));n.length===0||!L.areIntersectingOrTouching(n[n.length-1],r)?n.push(r):n[n.length-1]=L.plusRange(n[n.length-1],r)}return n}_updateHintsDecorators(e,t){const i=[],n=(f,m,_,b,v)=>{const y={content:_,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:m.className,cursorStops:b,attachedData:v};i.push({item:f,classNameRef:m,decoration:{range:f.anchor.range,options:{description:"InlayHint",showIfCollapsed:f.anchor.range.isEmpty(),collapseOnReplaceEdit:!f.anchor.range.isEmpty(),stickiness:0,[f.anchor.direction]:this._activeRenderMode===0?y:void 0}}})},s=(f,m)=>{const _=this._ruleFactory.createClassNameRef({width:`${r/3|0}px`,display:"inline-block"});n(f,_," ",m?Or.Right:Or.None)},{fontSize:r,fontFamily:a,padding:l,isUniform:c}=this._getLayoutInfo(),d="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(d,a);let h={line:0,totalLen:0};for(const f of t){if(h.line!==f.anchor.range.startLineNumber&&(h={line:f.anchor.range.startLineNumber,totalLen:0}),h.totalLen>Wp._MAX_LABEL_LEN)continue;f.hint.paddingLeft&&s(f,!1);const m=typeof f.hint.label=="string"?[{label:f.hint.label}]:f.hint.label;for(let _=0;_<m.length;_++){const b=m[_],v=_===0,y=_===m.length-1,C={fontSize:`${r}px`,fontFamily:`var(${d}), ${ds.fontFamily}`,verticalAlign:c?"baseline":"middle",unicodeBidi:"isolate"};Yn(f.hint.textEdits)&&(C.cursor="default"),this._fillInColors(C,f.hint),(b.command||b.location)&&this._activeInlayHintPart?.part.item===f&&this._activeInlayHintPart.part.index===_&&(C.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(C.color=fi(Zne),C.cursor="pointer")),l&&(v&&y?(C.padding=`1px ${Math.max(1,r/4)|0}px`,C.borderRadius=`${r/4|0}px`):v?(C.padding=`1px 0 1px ${Math.max(1,r/4)|0}px`,C.borderRadius=`${r/4|0}px 0 0 ${r/4|0}px`):y?(C.padding=`1px ${Math.max(1,r/4)|0}px 1px 0`,C.borderRadius=`0 ${r/4|0}px ${r/4|0}px 0`):C.padding="1px 0 1px 0");let w=b.label;h.totalLen+=w.length;let x=!1;const k=h.totalLen-Wp._MAX_LABEL_LEN;if(k>0&&(w=w.slice(0,-k)+"…",x=!0),n(f,this._ruleFactory.createClassNameRef(C),D1e(w),y&&!f.hint.paddingRight?Or.Right:Or.None,new u2(f,_)),x)break}if(f.hint.paddingRight&&s(f,!0),i.length>Wp._MAX_DECORATORS)break}const u=[];for(const[f,m]of this._decorationsMetadata){const _=this._editor.getModel()?.getDecorationRange(f);_&&e.some(b=>b.containsRange(_))&&(u.push(f),m.classNameRef.dispose(),this._decorationsMetadata.delete(f))}const g=Ma.capture(this._editor);this._editor.changeDecorations(f=>{const m=f.deltaDecorations(u,i.map(_=>_.decoration));for(let _=0;_<m.length;_++){const b=i[_];this._decorationsMetadata.set(m[_],b)}}),g.restore(this._editor)}_fillInColors(e,t){t.kind===L0.Parameter?(e.backgroundColor=fi(nse),e.color=fi(ise)):t.kind===L0.Type?(e.backgroundColor=fi(tse),e.color=fi(ese)):(e.backgroundColor=fi(g5),e.color=fi(u5))}_getLayoutInfo(){const e=this._editor.getOption(142),t=e.padding,i=this._editor.getOption(52),n=this._editor.getOption(49);let s=e.fontSize;(!s||s<5||s>i)&&(s=i);const r=e.fontFamily||n;return{fontSize:s,fontFamily:r,padding:t,isUniform:!t&&r===n&&s===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const e of this._decorationsMetadata.values())e.classNameRef.dispose();this._decorationsMetadata.clear()}},Wp=Oc,Oc.ID="editor.contrib.InlayHints",Oc._MAX_DECORATORS=1500,Oc._MAX_LABEL_LEN=43,Oc);tw=Wp=E1e([kp(1,ue),kp(2,Uo),kp(3,nZ),kp(4,Ft),kp(5,Ei),kp(6,Ce)],tw);function D1e(o){return o.replace(/[ \t]/g," ")}st.registerCommand("_executeInlayHintProvider",async(o,...e)=>{const[t,i]=e;ut(ye.isUri(t)),ut(L.isIRange(i));const{inlayHintsProvider:n}=o.get(ue),s=await o.get(Ms).createModelReference(t);try{const r=await SL.create(n,s.object.textEditorModel,[L.lift(i)],He.None),a=r.items.map(l=>l.hint);return setTimeout(()=>r.dispose(),0),a}finally{s.dispose()}});var I1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},_d=function(o,e){return function(t,i){e(t,i,o)}};class S8 extends i0{constructor(e,t,i,n){super(10,t,e.item.anchor.range,i,n,!0),this.part=e}}let DL=class extends Jy{constructor(e,t,i,n,s,r,a,l,c){super(e,t,i,r,l,n,s,c),this._resolverService=a,this.hoverOrdinal=6}suggestHoverAnchor(e){if(!tw.get(this._editor)||e.target.type!==6)return null;const i=e.target.detail.injectedText?.options;return i instanceof Wh&&i.attachedData instanceof u2?new S8(i.attachedData,this,e.event.posx,e.event.posy):null}computeSync(){return[]}computeAsync(e,t,i){return e instanceof S8?new No(async n=>{const{part:s}=e;if(await s.item.resolve(i),i.isCancellationRequested)return;let r;typeof s.item.hint.tooltip=="string"?r=new Pn().appendText(s.item.hint.tooltip):s.item.hint.tooltip&&(r=s.item.hint.tooltip),r&&n.emitOne(new Ar(this,e.range,[r],!1,0)),Yn(s.item.hint.textEdits)&&n.emitOne(new Ar(this,e.range,[new Pn().appendText(p("hint.dbl","Double-click to insert"))],!1,10001));let a;if(typeof s.part.tooltip=="string"?a=new Pn().appendText(s.part.tooltip):s.part.tooltip&&(a=s.part.tooltip),a&&n.emitOne(new Ar(this,e.range,[a],!1,1)),s.part.location||s.part.command){let c;const h=this._editor.getOption(78)==="altKey"?Qe?p("links.navigate.kb.meta.mac","cmd + click"):p("links.navigate.kb.meta","ctrl + click"):Qe?p("links.navigate.kb.alt.mac","option + click"):p("links.navigate.kb.alt","alt + click");s.part.location&&s.part.command?c=new Pn().appendText(p("hint.defAndCommand","Go to Definition ({0}), right click for more",h)):s.part.location?c=new Pn().appendText(p("hint.def","Go to Definition ({0})",h)):s.part.command&&(c=new Pn(`[${p("hint.cmd","Execute Command")}](${s1e(s.part.command)} "${s.part.command.title}") (${h})`,{isTrusted:!0})),c&&n.emitOne(new Ar(this,e.range,[c],!1,1e4))}const l=await this._resolveInlayHintLabelPartHover(s,i);for await(const c of l)n.emitOne(c)}):No.EMPTY}async _resolveInlayHintLabelPartHover(e,t){if(!e.part.location)return No.EMPTY;const{uri:i,range:n}=e.part.location,s=await this._resolverService.createModelReference(i);try{const r=s.object.textEditorModel;return this._languageFeaturesService.hoverProvider.has(r)?CW(this._languageFeaturesService.hoverProvider,r,new A(n.startLineNumber,n.startColumn),t).filter(a=>!L_(a.hover.contents)).map(a=>new Ar(this,e.item.anchor.range,a.hover.contents,!1,2+a.ordinal)):No.EMPTY}finally{s.dispose()}}};DL=I1e([_d(1,ti),_d(2,Fs),_d(3,vt),_d(4,zl),_d(5,Ke),_d(6,Ms),_d(7,ue),_d(8,Ft)],DL);class kW extends F{constructor(e,t,i,n,s,r){super();const a=t.anchor,l=t.hoverParts;this._renderedHoverParts=this._register(new g2(e,i,l,r,s));const{showAtPosition:c,showAtSecondaryPosition:d}=kW.computeHoverPositions(e,a.range,l);this.shouldAppearBeforeContent=l.some(h=>h.isBeforeContent),this.showAtPosition=c,this.showAtSecondaryPosition=d,this.initialMousePosX=a.initialMousePosX,this.initialMousePosY=a.initialMousePosY,this.shouldFocus=n.shouldFocus,this.source=n.source}get domNode(){return this._renderedHoverParts.domNode}get domNodeHasChildren(){return this._renderedHoverParts.domNodeHasChildren}get focusedHoverPartIndex(){return this._renderedHoverParts.focusedHoverPartIndex}async updateHoverVerbosityLevel(e,t,i){this._renderedHoverParts.updateHoverVerbosityLevel(e,t,i)}isColorPickerVisible(){return this._renderedHoverParts.isColorPickerVisible()}static computeHoverPositions(e,t,i){let n=1;if(e.hasModel()){const d=e._getViewModel(),h=d.coordinatesConverter,u=h.convertModelRangeToViewRange(t),g=d.getLineMinColumn(u.startLineNumber),f=new A(u.startLineNumber,g);n=h.convertViewPositionToModelPosition(f).column}const s=t.startLineNumber;let r=t.startColumn,a;for(const d of i){const h=d.range,u=h.startLineNumber===s,g=h.endLineNumber===s;if(u&&g){const m=h.startColumn,_=Math.min(r,m);r=Math.max(_,n)}d.forceShowAtRange&&(a=h)}let l,c;if(a){const d=a.getStartPosition();l=d,c=d}else l=t.getStartPosition(),c=new A(s,r);return{showAtPosition:l,showAtSecondaryPosition:c}}}class N1e{constructor(e,t){this._statusBar=t,e.appendChild(this._statusBar.hoverElement)}get hoverElement(){return this._statusBar.hoverElement}get actions(){return this._statusBar.actions}dispose(){this._statusBar.dispose()}}const fE=class fE extends F{constructor(e,t,i,n,s){super(),this._renderedParts=[],this._focusedHoverPartIndex=-1,this._context=s,this._fragment=document.createDocumentFragment(),this._register(this._renderParts(t,i,s,n)),this._register(this._registerListenersOnRenderedParts()),this._register(this._createEditorDecorations(e,i)),this._updateMarkdownAndColorParticipantInfo(t)}_createEditorDecorations(e,t){if(t.length===0)return F.None;let i=t[0].range;for(const s of t){const r=s.range;i=L.plusRange(i,r)}const n=e.createDecorationsCollection();return n.set([{range:i,options:fE._DECORATION_OPTIONS}]),ve(()=>{n.clear()})}_renderParts(e,t,i,n){const s=new wL(n),r={fragment:this._fragment,statusBar:s,...i},a=new $;for(const c of e){const d=this._renderHoverPartsForParticipant(t,c,r);a.add(d);for(const h of d.renderedHoverParts)this._renderedParts.push({type:"hoverPart",participant:c,hoverPart:h.hoverPart,hoverElement:h.hoverElement})}const l=this._renderStatusBar(this._fragment,s);return l&&(a.add(l),this._renderedParts.push({type:"statusBar",hoverElement:l.hoverElement,actions:l.actions})),ve(()=>{a.dispose()})}_renderHoverPartsForParticipant(e,t,i){const n=e.filter(r=>r.owner===t);return n.length>0?t.renderHoverParts(i,n):new Ff([])}_renderStatusBar(e,t){if(t.hasContent)return new N1e(e,t)}_registerListenersOnRenderedParts(){const e=new $;return this._renderedParts.forEach((t,i)=>{const n=t.hoverElement;n.tabIndex=0,e.add(H(n,ee.FOCUS_IN,s=>{s.stopPropagation(),this._focusedHoverPartIndex=i})),e.add(H(n,ee.FOCUS_OUT,s=>{s.stopPropagation(),this._focusedHoverPartIndex=-1}))}),e}_updateMarkdownAndColorParticipantInfo(e){const t=e.find(i=>i instanceof Jy&&!(i instanceof DL));t&&(this._markdownHoverParticipant=t),this._colorHoverParticipant=e.find(i=>i instanceof Xy)}async updateHoverVerbosityLevel(e,t,i){if(!this._markdownHoverParticipant)return;const n=this._normalizedIndexToMarkdownHoverIndexRange(this._markdownHoverParticipant,t);if(n===void 0)return;const s=await this._markdownHoverParticipant.updateMarkdownHoverVerbosityLevel(e,n,i);s&&(this._renderedParts[t]={type:"hoverPart",participant:this._markdownHoverParticipant,hoverPart:s.hoverPart,hoverElement:s.hoverElement},this._context.onContentsChanged())}isColorPickerVisible(){return this._colorHoverParticipant?.isColorPickerVisible()??!1}_normalizedIndexToMarkdownHoverIndexRange(e,t){const i=this._renderedParts[t];if(!i||i.type!=="hoverPart"||!(i.participant===e))return;const s=this._renderedParts.findIndex(r=>r.type==="hoverPart"&&r.participant===e);if(s===-1)throw new pt;return t-s}get domNode(){return this._fragment}get domNodeHasChildren(){return this._fragment.hasChildNodes()}get focusedHoverPartIndex(){return this._focusedHoverPartIndex}};fE._DECORATION_OPTIONS=Fe.register({description:"content-hover-highlight",className:"hoverHighlight"});let g2=fE;var R1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},x8=function(o,e){return function(t,i){e(t,i,o)}};let f2=class extends F{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._currentResult=null,this._onContentsChanged=this._register(new O),this.onContentsChanged=this._onContentsChanged.event,this._contentHoverWidget=this._register(this._instantiationService.createInstance(e2,this._editor)),this._participants=this._initializeHoverParticipants(),this._computer=new yL(this._editor,this._participants),this._hoverOperation=this._register(new Wq(this._editor,this._computer)),this._registerListeners()}_initializeHoverParticipants(){const e=[];for(const t of np.getAll()){const i=this._instantiationService.createInstance(t,this._editor);e.push(i)}return e.sort((t,i)=>t.hoverOrdinal-i.hoverOrdinal),this._register(this._contentHoverWidget.onDidResize(()=>{this._participants.forEach(t=>t.handleResize?.())})),e}_registerListeners(){this._register(this._hoverOperation.onResult(t=>{if(!this._computer.anchor)return;const i=t.hasLoadingMessage?this._addLoadingMessage(t.value):t.value;this._withResult(new Vq(this._computer.anchor,i,t.isComplete))}));const e=this._contentHoverWidget.getDomNode();this._register(ci(e,"keydown",t=>{t.equals(9)&&this.hide()})),this._register(ci(e,"mouseleave",t=>{this._onMouseLeave(t)})),this._register(gi.onDidChange(()=>{this._contentHoverWidget.position&&this._currentResult&&this._setCurrentResult(this._currentResult)}))}_startShowingOrUpdateHover(e,t,i,n,s){if(!(this._contentHoverWidget.position&&this._currentResult))return e?(this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):!1;const a=this._editor.getOption(60).sticky,l=s&&this._contentHoverWidget.isMouseGettingCloser(s.event.posx,s.event.posy);return a&&l?(e&&this._startHoverOperationIfNecessary(e,t,i,n,!0),!0):e?this._currentResult.anchor.equals(e)?!0:e.canAdoptVisibleHover(this._currentResult.anchor,this._contentHoverWidget.position)?(this._setCurrentResult(this._currentResult.filter(e)),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),this._startHoverOperationIfNecessary(e,t,i,n,!1),!0):(this._setCurrentResult(null),!1)}_startHoverOperationIfNecessary(e,t,i,n,s){this._computer.anchor&&this._computer.anchor.equals(e)||(this._hoverOperation.cancel(),this._computer.anchor=e,this._computer.shouldFocus=n,this._computer.source=i,this._computer.insistOnKeepingHoverVisible=s,this._hoverOperation.start(t))}_setCurrentResult(e){let t=e;if(this._currentResult===t)return;t&&t.hoverParts.length===0&&(t=null),this._currentResult=t,this._currentResult?this._showHover(this._currentResult):this._hideHover()}_addLoadingMessage(e){if(!this._computer.anchor)return e;for(const t of this._participants){if(!t.createLoadingMessage)continue;const i=t.createLoadingMessage(this._computer.anchor);if(i)return e.slice(0).concat([i])}return e}_withResult(e){if(this._contentHoverWidget.position&&this._currentResult&&this._currentResult.isComplete||this._setCurrentResult(e),!e.isComplete)return;const n=e.hoverParts.length===0,s=this._computer.insistOnKeepingHoverVisible;n&&s||this._setCurrentResult(e)}_showHover(e){const t=this._getHoverContext();this._renderedContentHover=new kW(this._editor,e,this._participants,this._computer,t,this._keybindingService),this._renderedContentHover.domNodeHasChildren?this._contentHoverWidget.show(this._renderedContentHover):this._renderedContentHover.dispose()}_hideHover(){this._contentHoverWidget.hide()}_getHoverContext(){return{hide:()=>{this.hide()},onContentsChanged:()=>{this._onContentsChanged.fire(),this._contentHoverWidget.onContentsChanged()},setMinimumDimensions:n=>{this._contentHoverWidget.setMinimumDimensions(n)}}}showsOrWillShow(e){if(this._contentHoverWidget.isResizing)return!0;const i=this._findHoverAnchorCandidates(e);if(!(i.length>0))return this._startShowingOrUpdateHover(null,0,0,!1,e);const s=i[0];return this._startShowingOrUpdateHover(s,0,0,!1,e)}_findHoverAnchorCandidates(e){const t=[];for(const n of this._participants){if(!n.suggestHoverAnchor)continue;const s=n.suggestHoverAnchor(e);s&&t.push(s)}const i=e.target;switch(i.type){case 6:{t.push(new bN(0,i.range,e.event.posx,e.event.posy));break}case 7:{const n=this._editor.getOption(50).typicalHalfwidthCharacterWidth/2;if(!(!i.detail.isAfterLines&&typeof i.detail.horizontalDistanceToText=="number"&&i.detail.horizontalDistanceToText<n))break;t.push(new bN(0,i.range,e.event.posx,e.event.posy));break}}return t.sort((n,s)=>s.priority-n.priority),t}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!CD(t,e.x,e.y))&&this.hide()}startShowingAtRange(e,t,i,n){this._startShowingOrUpdateHover(new bN(0,e,void 0,void 0),t,i,n,null)}async updateHoverVerbosityLevel(e,t,i){this._renderedContentHover?.updateHoverVerbosityLevel(e,t,i)}focusedHoverPartIndex(){return this._renderedContentHover?.focusedHoverPartIndex??-1}containsNode(e){return e?this._contentHoverWidget.getDomNode().contains(e):!1}focus(){this._contentHoverWidget.focus()}scrollUp(){this._contentHoverWidget.scrollUp()}scrollDown(){this._contentHoverWidget.scrollDown()}scrollLeft(){this._contentHoverWidget.scrollLeft()}scrollRight(){this._contentHoverWidget.scrollRight()}pageUp(){this._contentHoverWidget.pageUp()}pageDown(){this._contentHoverWidget.pageDown()}goToTop(){this._contentHoverWidget.goToTop()}goToBottom(){this._contentHoverWidget.goToBottom()}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._setCurrentResult(null)}getDomNode(){return this._contentHoverWidget.getDomNode()}get isColorPickerVisible(){return this._renderedContentHover?.isColorPickerVisible()??!1}get isVisibleFromKeyboard(){return this._contentHoverWidget.isVisibleFromKeyboard}get isVisible(){return this._contentHoverWidget.isVisible}get isFocused(){return this._contentHoverWidget.isFocused}get isResizing(){return this._contentHoverWidget.isResizing}get widget(){return this._contentHoverWidget}};f2=R1e([x8(1,Ce),x8(2,vt)],f2);var P1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},L8=function(o,e){return function(t,i){e(t,i,o)}},p2,Bg;let Qn=(Bg=class extends F{constructor(e,t,i){super(),this._editor=e,this._instantiationService=t,this._keybindingService=i,this._onHoverContentsChanged=this._register(new O),this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new $,this._hoverState={mouseDown:!1,activatedByDecoratorClick:!1},this._reactToEditorMouseMoveRunner=this._register(new xt(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(60)&&(this._unhookListeners(),this._hookListeners())}))}static get(e){return e.getContribution(p2.ID)}_hookListeners(){const e=this._editor.getOption(60);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))):(this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this._hideWidgets()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._shouldNotHideCurrentHoverWidget(e)&&this._hideWidgets()}_shouldNotHideCurrentHoverWidget(e){return this._isMouseOnContentHoverWidget(e)||this._isContentWidgetResizing()}_isMouseOnContentHoverWidget(e){const t=this._contentWidget?.getDomNode();return t?CD(t,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._shouldNotHideCurrentHoverWidget(e))||this._hideWidgets()}_shouldNotRecomputeCurrentHoverWidget(e){const t=this._hoverSettings.sticky,i=(r,a)=>{const l=this._isMouseOnContentHoverWidget(r);return a&&l},n=r=>{const a=this._isMouseOnContentHoverWidget(r),l=this._contentWidget?.isColorPickerVisible??!1;return a&&l},s=(r,a)=>(a&&this._contentWidget?.containsNode(r.event.browserEvent.view?.document.activeElement)&&!r.event.browserEvent.view?.getSelection()?.isCollapsed)??!1;return i(e,t)||n(e)||s(e,t)}_onEditorMouseMove(e){if(this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._mouseMoveEvent=e,this._contentWidget?.isFocused||this._contentWidget?.isResizing))return;const t=this._hoverSettings.sticky;if(t&&this._contentWidget?.isVisibleFromKeyboard)return;if(this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}const n=this._hoverSettings.hidingDelay;if(this._contentWidget?.isVisible&&t&&n>0){this._reactToEditorMouseMoveRunner.isScheduled()||this._reactToEditorMouseMoveRunner.schedule(n);return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){if(!e)return;const i=e.target.element?.classList.contains("colorpicker-color-decoration"),n=this._editor.getOption(149),s=this._hoverSettings.enabled,r=this._hoverState.activatedByDecoratorClick;if(i&&(n==="click"&&!r||n==="hover"&&!s||n==="clickAndHover"&&!s&&!r)||!i&&!s&&!r){this._hideWidgets();return}this._tryShowHoverWidget(e)||this._hideWidgets()}_tryShowHoverWidget(e){return this._getOrCreateContentWidget().showsOrWillShow(e)}_onKeyDown(e){if(!this._editor.hasModel())return;const t=this._keybindingService.softDispatch(e,this._editor.getDomNode()),i=t.kind===1||t.kind===2&&(t.commandId===Mq||t.commandId===bD||t.commandId===vD)&&this._contentWidget?.isVisible;e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||i||this._hideWidgets()}_hideWidgets(){this._hoverState.mouseDown&&this._contentWidget?.isColorPickerVisible||z_.dropDownVisible||(this._hoverState.activatedByDecoratorClick=!1,this._contentWidget?.hide())}_getOrCreateContentWidget(){return this._contentWidget||(this._contentWidget=this._instantiationService.createInstance(f2,this._editor),this._listenersStore.add(this._contentWidget.onContentsChanged(()=>this._onHoverContentsChanged.fire()))),this._contentWidget}showContentHover(e,t,i,n,s=!1){this._hoverState.activatedByDecoratorClick=s,this._getOrCreateContentWidget().startShowingAtRange(e,t,i,n)}_isContentWidgetResizing(){return this._contentWidget?.widget.isResizing||!1}focusedHoverPartIndex(){return this._getOrCreateContentWidget().focusedHoverPartIndex()}updateHoverVerbosityLevel(e,t,i){this._getOrCreateContentWidget().updateHoverVerbosityLevel(e,t,i)}focus(){this._contentWidget?.focus()}scrollUp(){this._contentWidget?.scrollUp()}scrollDown(){this._contentWidget?.scrollDown()}scrollLeft(){this._contentWidget?.scrollLeft()}scrollRight(){this._contentWidget?.scrollRight()}pageUp(){this._contentWidget?.pageUp()}pageDown(){this._contentWidget?.pageDown()}goToTop(){this._contentWidget?.goToTop()}goToBottom(){this._contentWidget?.goToBottom()}get isColorPickerVisible(){return this._contentWidget?.isColorPickerVisible}get isHoverVisible(){return this._contentWidget?.isVisible}dispose(){super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),this._contentWidget?.dispose()}},p2=Bg,Bg.ID="editor.contrib.contentHover",Bg);Qn=p2=P1e([L8(1,Ce),L8(2,vt)],Qn);const a3=class a3 extends F{constructor(e){super(),this._editor=e,this._register(e.onMouseDown(t=>this.onMouseDown(t)))}dispose(){super.dispose()}onMouseDown(e){const t=this._editor.getOption(149);if(t!=="click"&&t!=="clickAndHover")return;const i=e.target;if(i.type!==6||!i.detail.injectedText||i.detail.injectedText.options.attachedData!==Tq||!i.range)return;const n=this._editor.getContribution(Qn.ID);if(n&&!n.isColorPickerVisible){const s=new L(i.range.startLineNumber,i.range.startColumn+1,i.range.endLineNumber,i.range.endColumn+1);n.showContentHover(s,1,0,!1,!0)}}};a3.ID="editor.contrib.colorContribution";let IL=a3;at(IL.ID,IL,2);np.register(Xy);var sZ=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},lm=function(o,e){return function(t,i){e(t,i,o)}},m2,_2,Wg;let Wf=(Wg=class extends F{constructor(e,t,i){super(),this._editor=e,this._instantiationService=i,this._standaloneColorPickerWidget=null,this._standaloneColorPickerVisible=T.standaloneColorPickerVisible.bindTo(t),this._standaloneColorPickerFocused=T.standaloneColorPickerFocused.bindTo(t)}showOrFocus(){this._editor.hasModel()&&(this._standaloneColorPickerVisible.get()?this._standaloneColorPickerFocused.get()||this._standaloneColorPickerWidget?.focus():this._standaloneColorPickerWidget=this._instantiationService.createInstance(b2,this._editor,this._standaloneColorPickerVisible,this._standaloneColorPickerFocused))}hide(){this._standaloneColorPickerFocused.set(!1),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerWidget?.hide(),this._editor.focus()}insertColor(){this._standaloneColorPickerWidget?.updateEditor(),this.hide()}static get(e){return e.getContribution(m2.ID)}},m2=Wg,Wg.ID="editor.contrib.standaloneColorPickerController",Wg);Wf=m2=sZ([lm(1,Ee),lm(2,Ce)],Wf);at(Wf.ID,Wf,1);const k8=8,A1e=22;var Vg;let b2=(Vg=class extends F{constructor(e,t,i,n,s,r,a){super(),this._editor=e,this._standaloneColorPickerVisible=t,this._standaloneColorPickerFocused=i,this._keybindingService=s,this._languageFeaturesService=r,this._editorWorkerService=a,this.allowEditorOverflow=!0,this._position=void 0,this._body=document.createElement("div"),this._colorHover=null,this._selectionSetInEditor=!1,this._onResult=this._register(new O),this.onResult=this._onResult.event,this._standaloneColorPickerVisible.set(!0),this._standaloneColorPickerParticipant=n.createInstance(Qy,this._editor),this._position=this._editor._getViewModel()?.getPrimaryCursorState().modelState.position;const l=this._editor.getSelection(),c=l?{startLineNumber:l.startLineNumber,startColumn:l.startColumn,endLineNumber:l.endLineNumber,endColumn:l.endColumn}:{startLineNumber:0,endLineNumber:0,endColumn:0,startColumn:0},d=this._register(Ia(this._body));this._register(d.onDidBlur(h=>{this.hide()})),this._register(d.onDidFocus(h=>{this.focus()})),this._register(this._editor.onDidChangeCursorPosition(()=>{this._selectionSetInEditor?this._selectionSetInEditor=!1:this.hide()})),this._register(this._editor.onMouseMove(h=>{const u=h.target.element?.classList;u&&u.contains("colorpicker-color-decoration")&&this.hide()})),this._register(this.onResult(h=>{this._render(h.value,h.foundInEditor)})),this._start(c),this._body.style.zIndex="50",this._editor.addContentWidget(this)}updateEditor(){this._colorHover&&this._standaloneColorPickerParticipant.updateEditorModel(this._colorHover)}getId(){return _2.ID}getDomNode(){return this._body}getPosition(){if(!this._position)return null;const e=this._editor.getOption(60).above;return{position:this._position,secondaryPosition:this._position,preference:e?[1,2]:[2,1],positionAffinity:2}}hide(){this.dispose(),this._standaloneColorPickerVisible.set(!1),this._standaloneColorPickerFocused.set(!1),this._editor.removeContentWidget(this),this._editor.focus()}focus(){this._standaloneColorPickerFocused.set(!0),this._body.focus()}async _start(e){const t=await this._computeAsync(e);t&&this._onResult.fire(new M1e(t.result,t.foundInEditor))}async _computeAsync(e){if(!this._editor.hasModel())return null;const t={range:e,color:{red:0,green:0,blue:0,alpha:1}},i=await this._standaloneColorPickerParticipant.createColorHover(t,new Yy(this._editorWorkerService),this._languageFeaturesService.colorProvider);return i?{result:i.colorHover,foundInEditor:i.foundInEditor}:null}_render(e,t){const i=document.createDocumentFragment(),n=this._register(new wL(this._keybindingService)),s={fragment:i,statusBar:n,onContentsChanged:()=>{},hide:()=>this.hide()};this._colorHover=e;const r=this._standaloneColorPickerParticipant.renderHoverParts(s,[e]);if(!r)return;this._register(r.disposables);const a=r.colorPicker;this._body.classList.add("standalone-colorpicker-body"),this._body.style.maxHeight=Math.max(this._editor.getLayoutInfo().height/4,250)+"px",this._body.style.maxWidth=Math.max(this._editor.getLayoutInfo().width*.66,500)+"px",this._body.tabIndex=0,this._body.appendChild(i),a.layout();const l=a.body,c=l.saturationBox.domNode.clientWidth,d=l.domNode.clientWidth-c-A1e-k8,h=a.body.enterButton;h?.onClicked(()=>{this.updateEditor(),this.hide()});const u=a.header,g=u.pickedColorNode;g.style.width=c+k8+"px";const f=u.originalColorNode;f.style.width=d+"px",a.header.closeButton?.onClicked(()=>{this.hide()}),t&&(h&&(h.button.textContent="Replace"),this._selectionSetInEditor=!0,this._editor.setSelection(e.range)),this._editor.layoutContentWidget(this)}},_2=Vg,Vg.ID="editor.contrib.standaloneColorPickerWidget",Vg);b2=_2=sZ([lm(3,Ce),lm(4,vt),lm(5,ue),lm(6,Bs)],b2);class M1e{constructor(e,t){this.value=e,this.foundInEditor=t}}class O1e extends Fa{constructor(){super({id:"editor.action.showOrFocusStandaloneColorPicker",title:{...De("showOrFocusStandaloneColorPicker","Show or Focus Standalone Color Picker"),mnemonicTitle:p({key:"mishowOrFocusStandaloneColorPicker",comment:["&& denotes a mnemonic"]},"&&Show or Focus Standalone Color Picker")},precondition:void 0,menu:[{id:fe.CommandPalette}],metadata:{description:De("showOrFocusStandaloneColorPickerDescription","Show or focus a standalone color picker which uses the default color provider. It displays hex/rgb/hsl colors.")}})}runEditorCommand(e,t){Wf.get(t)?.showOrFocus()}}class F1e extends de{constructor(){super({id:"editor.action.hideColorPicker",label:p({key:"hideColorPicker",comment:["Action that hides the color picker"]},"Hide the Color Picker"),alias:"Hide the Color Picker",precondition:T.standaloneColorPickerVisible.isEqualTo(!0),kbOpts:{primary:9,weight:100},metadata:{description:De("hideColorPickerDescription","Hide the standalone color picker.")}})}run(e,t){Wf.get(t)?.hide()}}class B1e extends de{constructor(){super({id:"editor.action.insertColorWithStandaloneColorPicker",label:p({key:"insertColorWithStandaloneColorPicker",comment:["Action that inserts color with standalone color picker"]},"Insert Color with Standalone Color Picker"),alias:"Insert Color with Standalone Color Picker",precondition:T.standaloneColorPickerFocused.isEqualTo(!0),kbOpts:{primary:3,weight:100},metadata:{description:De("insertColorWithStandaloneColorPickerDescription","Insert hex/rgb/hsl colors with the focused standalone color picker.")}})}run(e,t){Wf.get(t)?.insertColor()}}X(F1e);X(B1e);At(O1e);class Xd{constructor(e,t,i){this.languageConfigurationService=i,this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,i){if(i<0)return!1;const n=t.length,s=e.length;if(i+n>s)return!1;for(let r=0;r<n;r++){const a=e.charCodeAt(i+r),l=t.charCodeAt(r);if(a!==l&&!(a>=65&&a<=90&&a+32===l)&&!(l>=65&&l<=90&&l+32===a))return!1}return!0}_createOperationsForBlockComment(e,t,i,n,s,r){const a=e.startLineNumber,l=e.startColumn,c=e.endLineNumber,d=e.endColumn,h=s.getLineContent(a),u=s.getLineContent(c);let g=h.lastIndexOf(t,l-1+t.length),f=u.indexOf(i,d-1-i.length);if(g!==-1&&f!==-1)if(a===c)h.substring(g+t.length,f).indexOf(i)>=0&&(g=-1,f=-1);else{const _=h.substring(g+t.length),b=u.substring(0,f);(_.indexOf(i)>=0||b.indexOf(i)>=0)&&(g=-1,f=-1)}let m;g!==-1&&f!==-1?(n&&g+t.length<h.length&&h.charCodeAt(g+t.length)===32&&(t=t+" "),n&&f>0&&u.charCodeAt(f-1)===32&&(i=" "+i,f-=1),m=Xd._createRemoveBlockCommentOperations(new L(a,g+t.length+1,c,f+1),t,i)):(m=Xd._createAddBlockCommentOperations(e,t,i,this._insertSpace),this._usedEndToken=m.length===1?i:null);for(const _ of m)r.addTrackedEditOperation(_.range,_.text)}static _createRemoveBlockCommentOperations(e,t,i){const n=[];return L.isEmpty(e)?n.push(si.delete(new L(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+i.length))):(n.push(si.delete(new L(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),n.push(si.delete(new L(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+i.length)))),n}static _createAddBlockCommentOperations(e,t,i,n){const s=[];return L.isEmpty(e)?s.push(si.replace(new L(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+"  "+i)):(s.push(si.insert(new A(e.startLineNumber,e.startColumn),t+(n?" ":""))),s.push(si.insert(new A(e.endLineNumber,e.endColumn),(n?" ":"")+i))),s}getEditOperations(e,t){const i=this._selection.startLineNumber,n=this._selection.startColumn;e.tokenization.tokenizeIfCheap(i);const s=e.getLanguageIdAtPosition(i,n),r=this.languageConfigurationService.getLanguageConfiguration(s).comments;!r||!r.blockCommentStartToken||!r.blockCommentEndToken||this._createOperationsForBlockComment(this._selection,r.blockCommentStartToken,r.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){const i=t.getInverseEditOperations();if(i.length===2){const n=i[0],s=i[1];return new pe(n.range.endLineNumber,n.range.endColumn,s.range.startLineNumber,s.range.startColumn)}else{const n=i[0].range,s=this._usedEndToken?-this._usedEndToken.length-1:0;return new pe(n.endLineNumber,n.endColumn+s,n.endLineNumber,n.endColumn+s)}}}class rc{constructor(e,t,i,n,s,r,a){this.languageConfigurationService=e,this._selection=t,this._indentSize=i,this._type=n,this._insertSpace=s,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=r,this._ignoreFirstLine=a||!1}static _gatherPreflightCommentStrings(e,t,i,n){e.tokenization.tokenizeIfCheap(t);const s=e.getLanguageIdAtPosition(t,1),r=n.getLanguageConfiguration(s).comments,a=r?r.lineCommentToken:null;if(!a)return null;const l=[];for(let c=0,d=i-t+1;c<d;c++)l[c]={ignore:!1,commentStr:a,commentStrOffset:0,commentStrLength:a.length};return l}static _analyzeLines(e,t,i,n,s,r,a,l){let c=!0,d;e===0?d=!0:e===1?d=!1:d=!0;for(let h=0,u=n.length;h<u;h++){const g=n[h],f=s+h;if(f===s&&a){g.ignore=!0;continue}const m=i.getLineContent(f),_=Xn(m);if(_===-1){g.ignore=r,g.commentStrOffset=m.length;continue}if(c=!1,g.ignore=!1,g.commentStrOffset=_,d&&!Xd._haystackHasNeedleAtOffset(m,g.commentStr,_)&&(e===0?d=!1:e===1||(g.ignore=!0)),d&&t){const b=_+g.commentStrLength;b<m.length&&m.charCodeAt(b)===32&&(g.commentStrLength+=1)}}if(e===0&&c){d=!1;for(let h=0,u=n.length;h<u;h++)n[h].ignore=!1}return{supported:!0,shouldRemoveComments:d,lines:n}}static _gatherPreflightData(e,t,i,n,s,r,a,l){const c=rc._gatherPreflightCommentStrings(i,n,s,l);return c===null?{supported:!1}:rc._analyzeLines(e,t,i,c,n,r,a,l)}_executeLineComments(e,t,i,n){let s;i.shouldRemoveComments?s=rc._createRemoveLineCommentsOperations(i.lines,n.startLineNumber):(rc._normalizeInsertionPoint(e,i.lines,n.startLineNumber,this._indentSize),s=this._createAddLineCommentsOperations(i.lines,n.startLineNumber));const r=new A(n.positionLineNumber,n.positionColumn);for(let a=0,l=s.length;a<l;a++)t.addEditOperation(s[a].range,s[a].text),L.isEmpty(s[a].range)&&L.getStartPosition(s[a].range).equals(r)&&e.getLineContent(r.lineNumber).length+1===r.column&&(this._deltaColumn=(s[a].text||"").length);this._selectionId=t.trackSelection(n)}_attemptRemoveBlockComment(e,t,i,n){let s=t.startLineNumber,r=t.endLineNumber;const a=n.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn);let l=e.getLineContent(s).lastIndexOf(i,a-1),c=e.getLineContent(r).indexOf(n,t.endColumn-1-i.length);return l!==-1&&c===-1&&(c=e.getLineContent(s).indexOf(n,l+i.length),r=s),l===-1&&c!==-1&&(l=e.getLineContent(r).lastIndexOf(i,c),s=r),t.isEmpty()&&(l===-1||c===-1)&&(l=e.getLineContent(s).indexOf(i),l!==-1&&(c=e.getLineContent(s).indexOf(n,l+i.length))),l!==-1&&e.getLineContent(s).charCodeAt(l+i.length)===32&&(i+=" "),c!==-1&&e.getLineContent(r).charCodeAt(c-1)===32&&(n=" "+n,c-=1),l!==-1&&c!==-1?Xd._createRemoveBlockCommentOperations(new L(s,l+i.length+1,r,c+1),i,n):null}_executeBlockComment(e,t,i){e.tokenization.tokenizeIfCheap(i.startLineNumber);const n=e.getLanguageIdAtPosition(i.startLineNumber,1),s=this.languageConfigurationService.getLanguageConfiguration(n).comments;if(!s||!s.blockCommentStartToken||!s.blockCommentEndToken)return;const r=s.blockCommentStartToken,a=s.blockCommentEndToken;let l=this._attemptRemoveBlockComment(e,i,r,a);if(!l){if(i.isEmpty()){const c=e.getLineContent(i.startLineNumber);let d=Xn(c);d===-1&&(d=c.length),l=Xd._createAddBlockCommentOperations(new L(i.startLineNumber,d+1,i.startLineNumber,c.length+1),r,a,this._insertSpace)}else l=Xd._createAddBlockCommentOperations(new L(i.startLineNumber,e.getLineFirstNonWhitespaceColumn(i.startLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),r,a,this._insertSpace);l.length===1&&(this._deltaColumn=r.length+1)}this._selectionId=t.trackSelection(i);for(const c of l)t.addEditOperation(c.range,c.text)}getEditOperations(e,t){let i=this._selection;if(this._moveEndPositionDown=!1,i.startLineNumber===i.endLineNumber&&this._ignoreFirstLine){t.addEditOperation(new L(i.startLineNumber,e.getLineMaxColumn(i.startLineNumber),i.startLineNumber+1,1),i.startLineNumber===e.getLineCount()?"":`
`),this._selectionId=t.trackSelection(i);return}i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._moveEndPositionDown=!0,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=rc._gatherPreflightData(this._type,this._insertSpace,e,i.startLineNumber,i.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return n.supported?this._executeLineComments(e,t,n,i):this._executeBlockComment(e,t,i)}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),new pe(i.selectionStartLineNumber,i.selectionStartColumn+this._deltaColumn,i.positionLineNumber,i.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){const i=[];for(let n=0,s=e.length;n<s;n++){const r=e[n];r.ignore||i.push(si.delete(new L(t+n,r.commentStrOffset+1,t+n,r.commentStrOffset+r.commentStrLength+1)))}return i}_createAddLineCommentsOperations(e,t){const i=[],n=this._insertSpace?" ":"";for(let s=0,r=e.length;s<r;s++){const a=e[s];a.ignore||i.push(si.insert(new A(t+s,a.commentStrOffset+1),a.commentStr+n))}return i}static nextVisibleColumn(e,t,i,n){return i?e+(t-e%t):e+n}static _normalizeInsertionPoint(e,t,i,n){let s=1073741824,r,a;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let h=0;for(let u=0,g=t[l].commentStrOffset;h<s&&u<g;u++)h=rc.nextVisibleColumn(h,n,d.charCodeAt(u)===9,1);h<s&&(s=h)}s=Math.floor(s/n)*n;for(let l=0,c=t.length;l<c;l++){if(t[l].ignore)continue;const d=e.getLineContent(i+l);let h=0;for(r=0,a=t[l].commentStrOffset;h<s&&r<a;r++)h=rc.nextVisibleColumn(h,n,d.charCodeAt(r)===9,1);h>s?t[l].commentStrOffset=r-1:t[l].commentStrOffset=r}}}class EW extends de{constructor(e,t){super(t),this._type=e}run(e,t){const i=e.get(li);if(!t.hasModel())return;const n=t.getModel(),s=[],r=n.getOptions(),a=t.getOption(23),l=t.getSelections().map((d,h)=>({selection:d,index:h,ignoreFirstLine:!1}));l.sort((d,h)=>L.compareRangesUsingStarts(d.selection,h.selection));let c=l[0];for(let d=1;d<l.length;d++){const h=l[d];c.selection.endLineNumber===h.selection.startLineNumber&&(c.index<h.index?h.ignoreFirstLine=!0:(c.ignoreFirstLine=!0,c=h))}for(const d of l)s.push(new rc(i,d.selection,r.indentSize,this._type,a.insertSpace,a.ignoreEmptyLines,d.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}class W1e extends EW{constructor(){super(0,{id:"editor.action.commentLine",label:p("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:2138,weight:100},menuOpts:{menuId:fe.MenubarEditMenu,group:"5_insert",title:p({key:"miToggleLineComment",comment:["&& denotes a mnemonic"]},"&&Toggle Line Comment"),order:1}})}}class V1e extends EW{constructor(){super(1,{id:"editor.action.addCommentLine",label:p("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2081),weight:100}})}}class H1e extends EW{constructor(){super(2,{id:"editor.action.removeCommentLine",label:p("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2099),weight:100}})}}class z1e extends de{constructor(){super({id:"editor.action.blockComment",label:p("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:fe.MenubarEditMenu,group:"5_insert",title:p({key:"miToggleBlockComment",comment:["&& denotes a mnemonic"]},"Toggle &&Block Comment"),order:2}})}run(e,t){const i=e.get(li);if(!t.hasModel())return;const n=t.getOption(23),s=[],r=t.getSelections();for(const a of r)s.push(new Xd(a,n.insertSpace,i));t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}X(W1e);X(V1e);X(H1e);X(z1e);var U1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},_u=function(o,e){return function(t,i){e(t,i,o)}},v2,Hg;let G_=(Hg=class{static get(e){return e.getContribution(v2.ID)}constructor(e,t,i,n,s,r,a,l){this._contextMenuService=t,this._contextViewService=i,this._contextKeyService=n,this._keybindingService=s,this._menuService=r,this._configurationService=a,this._workspaceContextService=l,this._toDispose=new $,this._contextMenuIsBeingShownCount=0,this._editor=e,this._toDispose.add(this._editor.onContextMenu(c=>this._onContextMenu(c))),this._toDispose.add(this._editor.onMouseWheel(c=>{if(this._contextMenuIsBeingShownCount>0){const d=this._contextViewService.getContextViewElement(),h=c.srcElement;h.shadowRoot&&vf(d)===h.shadowRoot||this._contextViewService.hideContextView()}})),this._toDispose.add(this._editor.onKeyDown(c=>{this._editor.getOption(24)&&c.keyCode===58&&(c.preventDefault(),c.stopPropagation(),this.showContextMenu())}))}_onContextMenu(e){if(!this._editor.hasModel())return;if(!this._editor.getOption(24)){this._editor.focus(),e.target.position&&!this._editor.getSelection().containsPosition(e.target.position)&&this._editor.setPosition(e.target.position);return}if(e.target.type===12||e.target.type===6&&e.target.detail.injectedText)return;if(e.event.preventDefault(),e.event.stopPropagation(),e.target.type===11)return this._showScrollbarContextMenu(e.event);if(e.target.type!==6&&e.target.type!==7&&e.target.type!==1)return;if(this._editor.focus(),e.target.position){let i=!1;for(const n of this._editor.getSelections())if(n.containsPosition(e.target.position)){i=!0;break}i||this._editor.setPosition(e.target.position)}let t=null;e.target.type!==1&&(t=e.event),this.showContextMenu(t)}showContextMenu(e){if(!this._editor.getOption(24)||!this._editor.hasModel())return;const t=this._getMenuActions(this._editor.getModel(),this._editor.contextMenuId);t.length>0&&this._doShowContextMenu(t,e)}_getMenuActions(e,t){const i=[],n=this._menuService.getMenuActions(t,this._contextKeyService,{arg:e.uri});for(const s of n){const[,r]=s;let a=0;for(const l of r)if(l instanceof Pm){const c=this._getMenuActions(e,l.item.submenu);c.length>0&&(i.push(new m_(l.id,l.label,c)),a++)}else i.push(l),a++;a&&i.push(new Zi)}return i.length&&i.pop(),i}_doShowContextMenu(e,t=null){if(!this._editor.hasModel())return;const i=this._editor.getOption(60);this._editor.updateOptions({hover:{enabled:!1}});let n=t;if(!n){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const r=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),a=Ci(this._editor.getDomNode()),l=a.left+r.left,c=a.top+r.top+r.height;n={x:l,y:c}}const s=this._editor.getOption(128)&&!Ta;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:s?this._editor.getOverflowWidgetsDomNode()??this._editor.getDomNode():void 0,getAnchor:()=>n,getActions:()=>e,getActionViewItem:r=>{const a=this._keybindingFor(r);if(a)return new I_(r,r,{label:!0,keybinding:a.getLabel(),isMenu:!0});const l=r;return typeof l.getActionViewItem=="function"?l.getActionViewItem():new I_(r,r,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:r=>this._keybindingFor(r),onHide:r=>{this._contextMenuIsBeingShownCount--,this._editor.updateOptions({hover:i})}})}_showScrollbarContextMenu(e){if(!this._editor.hasModel()||Hae(this._workspaceContextService.getWorkspace()))return;const t=this._editor.getOption(73);let i=0;const n=c=>({id:`menu-action-${++i}`,label:c.label,tooltip:"",class:void 0,enabled:typeof c.enabled>"u"?!0:c.enabled,checked:c.checked,run:c.run}),s=(c,d)=>new m_(`menu-action-${++i}`,c,d,void 0),r=(c,d,h,u,g)=>{if(!d)return n({label:c,enabled:d,run:()=>{}});const f=_=>()=>{this._configurationService.updateValue(h,_)},m=[];for(const _ of g)m.push(n({label:_.label,checked:u===_.value,run:f(_.value)}));return s(c,m)},a=[];a.push(n({label:p("context.minimap.minimap","Minimap"),checked:t.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!t.enabled)}})),a.push(new Zi),a.push(n({label:p("context.minimap.renderCharacters","Render Characters"),enabled:t.enabled,checked:t.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!t.renderCharacters)}})),a.push(r(p("context.minimap.size","Vertical size"),t.enabled,"editor.minimap.size",t.size,[{label:p("context.minimap.size.proportional","Proportional"),value:"proportional"},{label:p("context.minimap.size.fill","Fill"),value:"fill"},{label:p("context.minimap.size.fit","Fit"),value:"fit"}])),a.push(r(p("context.minimap.slider","Slider"),t.enabled,"editor.minimap.showSlider",t.showSlider,[{label:p("context.minimap.slider.mouseover","Mouse Over"),value:"mouseover"},{label:p("context.minimap.slider.always","Always"),value:"always"}]));const l=this._editor.getOption(128)&&!Ta;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:l?this._editor.getDomNode():void 0,getAnchor:()=>e,getActions:()=>a,onHide:c=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(e){return this._keybindingService.lookupKeybinding(e.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}},v2=Hg,Hg.ID="editor.contrib.contextmenu",Hg);G_=v2=U1e([_u(1,co),_u(2,sd),_u(3,Ee),_u(4,vt),_u(5,zo),_u(6,Ke),_u(7,Lf)],G_);class G1e extends de{constructor(){super({id:"editor.action.showContextMenu",label:p("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:T.textInputFocus,primary:1092,weight:100}})}run(e,t){G_.get(t)?.showContextMenu()}}at(G_.ID,G_,2);X(G1e);class CN{constructor(e){this.selections=e}equals(e){const t=this.selections.length,i=e.selections.length;if(t!==i)return!1;for(let n=0;n<t;n++)if(!this.selections[n].equalsSelection(e.selections[n]))return!1;return!0}}class yN{constructor(e,t,i){this.cursorState=e,this.scrollTop=t,this.scrollLeft=i}}const pE=class pE extends F{static get(e){return e.getContribution(pE.ID)}constructor(e){super(),this._editor=e,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(e.onDidChangeModel(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeModelContent(t=>{this._undoStack=[],this._redoStack=[]})),this._register(e.onDidChangeCursorSelection(t=>{if(this._isCursorUndoRedo||!t.oldSelections||t.oldModelVersionId!==t.modelVersionId)return;const i=new CN(t.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(i)||(this._undoStack.push(new yN(i,e.getScrollTop(),e.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())}))}cursorUndo(){!this._editor.hasModel()||this._undoStack.length===0||(this._redoStack.push(new yN(new CN(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){!this._editor.hasModel()||this._redoStack.length===0||(this._undoStack.push(new yN(new CN(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(e){this._isCursorUndoRedo=!0,this._editor.setSelections(e.cursorState.selections),this._editor.setScrollPosition({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}),this._isCursorUndoRedo=!1}};pE.ID="editor.contrib.cursorUndoRedoController";let $_=pE;class $1e extends de{constructor(){super({id:"cursorUndo",label:p("cursor.undo","Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:T.textInputFocus,primary:2099,weight:100}})}run(e,t,i){$_.get(t)?.cursorUndo()}}class K1e extends de{constructor(){super({id:"cursorRedo",label:p("cursor.redo","Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(e,t,i){$_.get(t)?.cursorRedo()}}at($_.ID,$_,0);X($1e);X(K1e);class j1e{constructor(e,t,i){this.selection=e,this.targetPosition=t,this.copy=i,this.targetSelection=null}getEditOperations(e,t){const i=e.getValueInRange(this.selection);if(this.copy||t.addEditOperation(this.selection,null),t.addEditOperation(new L(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column),i),this.selection.containsPosition(this.targetPosition)&&!(this.copy&&(this.selection.getEndPosition().equals(this.targetPosition)||this.selection.getStartPosition().equals(this.targetPosition)))){this.targetSelection=this.selection;return}if(this.copy){this.targetSelection=new pe(this.targetPosition.lineNumber,this.targetPosition.column,this.selection.endLineNumber-this.selection.startLineNumber+this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber>this.selection.endLineNumber){this.targetSelection=new pe(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}if(this.targetPosition.lineNumber<this.selection.endLineNumber){this.targetSelection=new pe(this.targetPosition.lineNumber,this.targetPosition.column,this.targetPosition.lineNumber+this.selection.endLineNumber-this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column+this.selection.endColumn-this.selection.startColumn:this.selection.endColumn);return}this.selection.endColumn<=this.targetPosition.column?this.targetSelection=new pe(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column-this.selection.endColumn+this.selection.startColumn:this.targetPosition.column-this.selection.endColumn+this.selection.startColumn,this.targetPosition.lineNumber,this.selection.startLineNumber===this.selection.endLineNumber?this.targetPosition.column:this.selection.endColumn):this.targetSelection=new pe(this.targetPosition.lineNumber-this.selection.endLineNumber+this.selection.startLineNumber,this.targetPosition.column,this.targetPosition.lineNumber,this.targetPosition.column+this.selection.endColumn-this.selection.startColumn)}computeCursorState(e,t){return this.targetSelection}}function Ep(o){return Qe?o.altKey:o.ctrlKey}const Id=class Id extends F{constructor(e){super(),this._editor=e,this._dndDecorationIds=this._editor.createDecorationsCollection(),this._register(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._register(this._editor.onMouseUp(t=>this._onEditorMouseUp(t))),this._register(this._editor.onMouseDrag(t=>this._onEditorMouseDrag(t))),this._register(this._editor.onMouseDrop(t=>this._onEditorMouseDrop(t))),this._register(this._editor.onMouseDropCanceled(()=>this._onEditorMouseDropCanceled())),this._register(this._editor.onKeyDown(t=>this.onEditorKeyDown(t))),this._register(this._editor.onKeyUp(t=>this.onEditorKeyUp(t))),this._register(this._editor.onDidBlurEditorWidget(()=>this.onEditorBlur())),this._register(this._editor.onDidBlurEditorText(()=>this.onEditorBlur())),this._mouseDown=!1,this._modifierPressed=!1,this._dragSelection=null}onEditorBlur(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1}onEditorKeyDown(e){!this._editor.getOption(35)||this._editor.getOption(22)||(Ep(e)&&(this._modifierPressed=!0),this._mouseDown&&Ep(e)&&this._editor.updateOptions({mouseStyle:"copy"}))}onEditorKeyUp(e){!this._editor.getOption(35)||this._editor.getOption(22)||(Ep(e)&&(this._modifierPressed=!1),this._mouseDown&&e.keyCode===Id.TRIGGER_KEY_VALUE&&this._editor.updateOptions({mouseStyle:"default"}))}_onEditorMouseDown(e){this._mouseDown=!0}_onEditorMouseUp(e){this._mouseDown=!1,this._editor.updateOptions({mouseStyle:"text"})}_onEditorMouseDrag(e){const t=e.target;if(this._dragSelection===null){const n=(this._editor.getSelections()||[]).filter(s=>t.position&&s.containsPosition(t.position));if(n.length===1)this._dragSelection=n[0];else return}Ep(e.event)?this._editor.updateOptions({mouseStyle:"copy"}):this._editor.updateOptions({mouseStyle:"default"}),t.position&&(this._dragSelection.containsPosition(t.position)?this._removeDecoration():this.showAt(t.position))}_onEditorMouseDropCanceled(){this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}_onEditorMouseDrop(e){if(e.target&&(this._hitContent(e.target)||this._hitMargin(e.target))&&e.target.position){const t=new A(e.target.position.lineNumber,e.target.position.column);if(this._dragSelection===null){let i=null;if(e.event.shiftKey){const n=this._editor.getSelection();if(n){const{selectionStartLineNumber:s,selectionStartColumn:r}=n;i=[new pe(s,r,t.lineNumber,t.column)]}}else i=(this._editor.getSelections()||[]).map(n=>n.containsPosition(t)?new pe(t.lineNumber,t.column,t.lineNumber,t.column):n);this._editor.setSelections(i||[],"mouse",3)}else(!this._dragSelection.containsPosition(t)||(Ep(e.event)||this._modifierPressed)&&(this._dragSelection.getEndPosition().equals(t)||this._dragSelection.getStartPosition().equals(t)))&&(this._editor.pushUndoStop(),this._editor.executeCommand(Id.ID,new j1e(this._dragSelection,t,Ep(e.event)||this._modifierPressed)),this._editor.pushUndoStop())}this._editor.updateOptions({mouseStyle:"text"}),this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1}showAt(e){this._dndDecorationIds.set([{range:new L(e.lineNumber,e.column,e.lineNumber,e.column),options:Id._DECORATION_OPTIONS}]),this._editor.revealPosition(e,1)}_removeDecoration(){this._dndDecorationIds.clear()}_hitContent(e){return e.type===6||e.type===7}_hitMargin(e){return e.type===2||e.type===3||e.type===4}dispose(){this._removeDecoration(),this._dragSelection=null,this._mouseDown=!1,this._modifierPressed=!1,super.dispose()}};Id.ID="editor.contrib.dragAndDrop",Id.TRIGGER_KEY_VALUE=Qe?6:5,Id._DECORATION_OPTIONS=Fe.register({description:"dnd-target",className:"dnd-target"});let NL=Id;at(NL.ID,NL,2);at(Qc.ID,Qc,0);vb(AO);oe(new class extends Hi{constructor(){super({id:aq,precondition:gW,kbOpts:{weight:100,primary:2137}})}runEditorCommand(o,e){return Qc.get(e)?.changePasteType()}});oe(new class extends Hi{constructor(){super({id:"editor.hidePasteWidget",precondition:gW,kbOpts:{weight:100,primary:9}})}runEditorCommand(o,e){Qc.get(e)?.clearWidgets()}});var zg;X((zg=class extends de{constructor(){super({id:"editor.action.pasteAs",label:p("pasteAs","Paste As..."),alias:"Paste As...",precondition:T.writable,metadata:{description:"Paste as",args:[{name:"args",schema:zg.argsSchema}]}})}run(e,t,i){let n=typeof i?.kind=="string"?i.kind:void 0;return!n&&i&&(n=typeof i.id=="string"?i.id:void 0),Qc.get(t)?.pasteAs(n?new Jt(n):void 0)}},zg.argsSchema={type:"object",properties:{kind:{type:"string",description:p("pasteAs.kind","The kind of the paste edit to try applying. If not provided or there are multiple edits for this kind, the editor will show a picker.")}}},zg));X(class extends de{constructor(){super({id:"editor.action.pasteAsText",label:p("pasteAsText","Paste as Text"),alias:"Paste as Text",precondition:T.writable})}run(o,e){return Qc.get(e)?.pasteAs({providerId:Rf.id})}});class q1e{constructor(){this._dragOperations=new Map}removeDragOperationTransfer(e){if(e&&this._dragOperations.has(e)){const t=this._dragOperations.get(e);return this._dragOperations.delete(e),t}}}class E8{constructor(e){this.identifier=e}}const oZ=Je("treeViewsDndService");it(oZ,q1e,1);var Z1e=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},r1=function(o,e){return function(t,i){e(t,i,o)}},C2;const rZ="editor.experimental.dropIntoEditor.defaultProvider",aZ="editor.changeDropType",TW=new re("dropWidgetVisible",!1,p("dropWidgetVisible","Whether the drop widget is showing"));var Ug;let K_=(Ug=class extends F{static get(e){return e.getContribution(C2.ID)}constructor(e,t,i,n,s){super(),this._configService=i,this._languageFeaturesService=n,this._treeViewsDragAndDropService=s,this.treeItemsTransfer=RO.getInstance(),this._dropProgressManager=this._register(t.createInstance(bL,"dropIntoEditor",e)),this._postDropWidgetManager=this._register(t.createInstance(CL,"dropIntoEditor",e,TW,{id:aZ,label:p("postDropWidgetTitle","Show drop options...")})),this._register(e.onDropIntoEditor(r=>this.onDropIntoEditor(e,r.position,r.event)))}clearWidgets(){this._postDropWidgetManager.clear()}changeDropType(){this._postDropWidgetManager.tryShowSelector()}async onDropIntoEditor(e,t,i){if(!i.dataTransfer||!e.hasModel())return;this._currentOperation?.cancel(),e.focus(),e.setPosition(t);const n=ji(async s=>{const r=new $,a=r.add(new zh(e,1,void 0,s));try{const l=await this.extractDataTransferData(i);if(l.size===0||a.token.isCancellationRequested)return;const c=e.getModel();if(!c)return;const d=this._languageFeaturesService.documentDropEditProvider.ordered(c).filter(u=>u.dropMimeTypes?u.dropMimeTypes.some(g=>l.matches(g)):!0),h=r.add(await this.getDropEdits(d,c,t,l,a));if(a.token.isCancellationRequested)return;if(h.edits.length){const u=this.getInitialActiveEditIndex(c,h.edits),g=e.getOption(36).showDropSelector==="afterDrop";await this._postDropWidgetManager.applyEditAndShowIfNeeded([L.fromPositions(t)],{activeEditIndex:u,allEdits:h.edits},g,async f=>f,s)}}finally{r.dispose(),this._currentOperation===n&&(this._currentOperation=void 0)}});this._dropProgressManager.showWhile(t,p("dropIntoEditorProgress","Running drop handlers. Click to cancel"),n,{cancel:()=>n.cancel()}),this._currentOperation=n}async getDropEdits(e,t,i,n,s){const r=new $,a=await Lw(Promise.all(e.map(async c=>{try{const d=await c.provideDocumentDropEdits(t,i,n,s.token);return d&&r.add(d),d?.edits.map(h=>({...h,providerId:c.id}))}catch(d){console.error(d)}})),s.token),l=Vr(a??[]).flat();return{edits:oq(l),dispose:()=>r.dispose()}}getInitialActiveEditIndex(e,t){const i=this._configService.getValue(rZ,{resource:e.uri});for(const[n,s]of Object.entries(i)){const r=new Jt(s),a=t.findIndex(l=>r.value===l.providerId&&l.handledMimeType&&Xj(n,[l.handledMimeType]));if(a>=0)return a}return 0}async extractDataTransferData(e){if(!e.dataTransfer)return new Yj;const t=eq(e.dataTransfer);if(this.treeItemsTransfer.hasData(E8.prototype)){const i=this.treeItemsTransfer.getData(E8.prototype);if(Array.isArray(i))for(const n of i){const s=await this._treeViewsDragAndDropService.removeDragOperationTransfer(n.identifier);if(s)for(const[r,a]of s)t.replace(r,a)}}return t}},C2=Ug,Ug.ID="editor.contrib.dropIntoEditorController",Ug);K_=C2=Z1e([r1(1,Ce),r1(2,Ke),r1(3,ue),r1(4,oZ)],K_);at(K_.ID,K_,2);vb(PO);oe(new class extends Hi{constructor(){super({id:aZ,precondition:TW,kbOpts:{weight:100,primary:2137}})}runEditorCommand(o,e,t){K_.get(e)?.changeDropType()}});oe(new class extends Hi{constructor(){super({id:"editor.hideDropWidget",precondition:TW,kbOpts:{weight:100,primary:9}})}runEditorCommand(o,e,t){K_.get(e)?.clearWidgets()}});ai.as(Zr.Configuration).registerConfiguration({...Aw,properties:{[rZ]:{type:"object",scope:5,description:p("defaultProviderDescription","Configures the default drop provider to use for content of a given mime type."),default:{},additionalProperties:{type:"string"}}}});const Hn=class Hn{constructor(e){this._editor=e,this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null,this._startPosition=this._editor.getPosition()}dispose(){this._editor.removeDecorations(this._allDecorations()),this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}reset(){this._decorations=[],this._overviewRulerApproximateDecorations=[],this._findScopeDecorationIds=[],this._rangeHighlightDecorationId=null,this._highlightedDecorationId=null}getCount(){return this._decorations.length}getFindScope(){return this._findScopeDecorationIds[0]?this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]):null}getFindScopes(){if(this._findScopeDecorationIds.length){const e=this._findScopeDecorationIds.map(t=>this._editor.getModel().getDecorationRange(t)).filter(t=>!!t);if(e.length)return e}return null}getStartPosition(){return this._startPosition}setStartPosition(e){this._startPosition=e,this.setCurrentFindMatch(null)}_getDecorationIndex(e){const t=this._decorations.indexOf(e);return t>=0?t+1:1}getDecorationRangeAt(e){const t=e<this._decorations.length?this._decorations[e]:null;return t?this._editor.getModel().getDecorationRange(t):null}getCurrentMatchesPosition(e){const t=this._editor.getModel().getDecorationsInRange(e);for(const i of t){const n=i.options;if(n===Hn._FIND_MATCH_DECORATION||n===Hn._CURRENT_FIND_MATCH_DECORATION)return this._getDecorationIndex(i.id)}return 0}setCurrentFindMatch(e){let t=null,i=0;if(e)for(let n=0,s=this._decorations.length;n<s;n++){const r=this._editor.getModel().getDecorationRange(this._decorations[n]);if(e.equalsRange(r)){t=this._decorations[n],i=n+1;break}}return(this._highlightedDecorationId!==null||t!==null)&&this._editor.changeDecorations(n=>{if(this._highlightedDecorationId!==null&&(n.changeDecorationOptions(this._highlightedDecorationId,Hn._FIND_MATCH_DECORATION),this._highlightedDecorationId=null),t!==null&&(this._highlightedDecorationId=t,n.changeDecorationOptions(this._highlightedDecorationId,Hn._CURRENT_FIND_MATCH_DECORATION)),this._rangeHighlightDecorationId!==null&&(n.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),t!==null){let s=this._editor.getModel().getDecorationRange(t);if(s.startLineNumber!==s.endLineNumber&&s.endColumn===1){const r=s.endLineNumber-1,a=this._editor.getModel().getLineMaxColumn(r);s=new L(s.startLineNumber,s.startColumn,r,a)}this._rangeHighlightDecorationId=n.addDecoration(s,Hn._RANGE_HIGHLIGHT_DECORATION)}}),i}set(e,t){this._editor.changeDecorations(i=>{let n=Hn._FIND_MATCH_DECORATION;const s=[];if(e.length>1e3){n=Hn._FIND_MATCH_NO_OVERVIEW_DECORATION;const a=this._editor.getModel().getLineCount(),c=this._editor.getLayoutInfo().height/a,d=Math.max(2,Math.ceil(3/c));let h=e[0].range.startLineNumber,u=e[0].range.endLineNumber;for(let g=1,f=e.length;g<f;g++){const m=e[g].range;u+d>=m.startLineNumber?m.endLineNumber>u&&(u=m.endLineNumber):(s.push({range:new L(h,1,u,1),options:Hn._FIND_MATCH_ONLY_OVERVIEW_DECORATION}),h=m.startLineNumber,u=m.endLineNumber)}s.push({range:new L(h,1,u,1),options:Hn._FIND_MATCH_ONLY_OVERVIEW_DECORATION})}const r=new Array(e.length);for(let a=0,l=e.length;a<l;a++)r[a]={range:e[a].range,options:n};this._decorations=i.deltaDecorations(this._decorations,r),this._overviewRulerApproximateDecorations=i.deltaDecorations(this._overviewRulerApproximateDecorations,s),this._rangeHighlightDecorationId&&(i.removeDecoration(this._rangeHighlightDecorationId),this._rangeHighlightDecorationId=null),this._findScopeDecorationIds.length&&(this._findScopeDecorationIds.forEach(a=>i.removeDecoration(a)),this._findScopeDecorationIds=[]),t?.length&&(this._findScopeDecorationIds=t.map(a=>i.addDecoration(a,Hn._FIND_SCOPE_DECORATION)))})}matchBeforePosition(e){if(this._decorations.length===0)return null;for(let t=this._decorations.length-1;t>=0;t--){const i=this._decorations[t],n=this._editor.getModel().getDecorationRange(i);if(!(!n||n.endLineNumber>e.lineNumber)){if(n.endLineNumber<e.lineNumber)return n;if(!(n.endColumn>e.column))return n}}return this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length-1])}matchAfterPosition(e){if(this._decorations.length===0)return null;for(let t=0,i=this._decorations.length;t<i;t++){const n=this._decorations[t],s=this._editor.getModel().getDecorationRange(n);if(!(!s||s.startLineNumber<e.lineNumber)){if(s.startLineNumber>e.lineNumber)return s;if(!(s.startColumn<e.column))return s}}return this._editor.getModel().getDecorationRange(this._decorations[0])}_allDecorations(){let e=[];return e=e.concat(this._decorations),e=e.concat(this._overviewRulerApproximateDecorations),this._findScopeDecorationIds.length&&e.push(...this._findScopeDecorationIds),this._rangeHighlightDecorationId&&e.push(this._rangeHighlightDecorationId),e}};Hn._CURRENT_FIND_MATCH_DECORATION=Fe.register({description:"current-find-match",stickiness:1,zIndex:13,className:"currentFindMatch",inlineClassName:"currentFindMatchInline",showIfCollapsed:!0,overviewRuler:{color:fi(CI),position:Ao.Center},minimap:{color:fi(jP),position:1}}),Hn._FIND_MATCH_DECORATION=Fe.register({description:"find-match",stickiness:1,zIndex:10,className:"findMatch",inlineClassName:"findMatchInline",showIfCollapsed:!0,overviewRuler:{color:fi(CI),position:Ao.Center},minimap:{color:fi(jP),position:1}}),Hn._FIND_MATCH_NO_OVERVIEW_DECORATION=Fe.register({description:"find-match-no-overview",stickiness:1,className:"findMatch",showIfCollapsed:!0}),Hn._FIND_MATCH_ONLY_OVERVIEW_DECORATION=Fe.register({description:"find-match-only-overview",stickiness:1,overviewRuler:{color:fi(CI),position:Ao.Center}}),Hn._RANGE_HIGHLIGHT_DECORATION=Fe.register({description:"find-range-highlight",stickiness:1,className:"rangeHighlight",isWholeLine:!0}),Hn._FIND_SCOPE_DECORATION=Fe.register({description:"find-scope",className:"findScope",isWholeLine:!0});let y2=Hn;class Y1e{constructor(e,t,i){this._editorSelection=e,this._ranges=t,this._replaceStrings=i,this._trackedEditorSelectionId=null}getEditOperations(e,t){if(this._ranges.length>0){const i=[];for(let r=0;r<this._ranges.length;r++)i.push({range:this._ranges[r],text:this._replaceStrings[r]});i.sort((r,a)=>L.compareRangesUsingStarts(r.range,a.range));const n=[];let s=i[0];for(let r=1;r<i.length;r++)s.range.endLineNumber===i[r].range.startLineNumber&&s.range.endColumn===i[r].range.startColumn?(s.range=s.range.plusRange(i[r].range),s.text=s.text+i[r].text):(n.push(s),s=i[r]);n.push(s);for(const r of n)t.addEditOperation(r.range,r.text)}this._trackedEditorSelectionId=t.trackSelection(this._editorSelection)}computeCursorState(e,t){return t.getTrackedSelection(this._trackedEditorSelectionId)}}function lZ(o,e){if(o&&o[0]!==""){const t=T8(o,e,"-"),i=T8(o,e,"_");return t&&!i?D8(o,e,"-"):!t&&i?D8(o,e,"_"):o[0].toUpperCase()===o[0]?e.toUpperCase():o[0].toLowerCase()===o[0]?e.toLowerCase():qQ(o[0][0])&&e.length>0?e[0].toUpperCase()+e.substr(1):o[0][0].toUpperCase()!==o[0][0]&&e.length>0?e[0].toLowerCase()+e.substr(1):e}else return e}function T8(o,e,t){return o[0].indexOf(t)!==-1&&e.indexOf(t)!==-1&&o[0].split(t).length===e.split(t).length}function D8(o,e,t){const i=e.split(t),n=o[0].split(t);let s="";return i.forEach((r,a)=>{s+=lZ([n[a]],r)+t}),s.slice(0,-1)}class I8{constructor(e){this.staticValue=e,this.kind=0}}class X1e{constructor(e){this.pieces=e,this.kind=1}}class j_{static fromStaticValue(e){return new j_([pg.staticValue(e)])}get hasReplacementPatterns(){return this._state.kind===1}constructor(e){!e||e.length===0?this._state=new I8(""):e.length===1&&e[0].staticValue!==null?this._state=new I8(e[0].staticValue):this._state=new X1e(e)}buildReplaceString(e,t){if(this._state.kind===0)return t?lZ(e,this._state.staticValue):this._state.staticValue;let i="";for(let n=0,s=this._state.pieces.length;n<s;n++){const r=this._state.pieces[n];if(r.staticValue!==null){i+=r.staticValue;continue}let a=j_._substitute(r.matchIndex,e);if(r.caseOps!==null&&r.caseOps.length>0){const l=[],c=r.caseOps.length;let d=0;for(let h=0,u=a.length;h<u;h++){if(d>=c){l.push(a.slice(h));break}switch(r.caseOps[d]){case"U":l.push(a[h].toUpperCase());break;case"u":l.push(a[h].toUpperCase()),d++;break;case"L":l.push(a[h].toLowerCase());break;case"l":l.push(a[h].toLowerCase()),d++;break;default:l.push(a[h])}}a=l.join("")}i+=a}return i}static _substitute(e,t){if(t===null)return"";if(e===0)return t[0];let i="";for(;e>0;){if(e<t.length)return(t[e]||"")+i;i=String(e%10)+i,e=Math.floor(e/10)}return"$"+i}}class pg{static staticValue(e){return new pg(e,-1,null)}static caseOps(e,t){return new pg(null,e,t)}constructor(e,t,i){this.staticValue=e,this.matchIndex=t,!i||i.length===0?this.caseOps=null:this.caseOps=i.slice(0)}}class Q1e{constructor(e){this._source=e,this._lastCharIndex=0,this._result=[],this._resultLen=0,this._currentStaticPiece=""}emitUnchanged(e){this._emitStatic(this._source.substring(this._lastCharIndex,e)),this._lastCharIndex=e}emitStatic(e,t){this._emitStatic(e),this._lastCharIndex=t}_emitStatic(e){e.length!==0&&(this._currentStaticPiece+=e)}emitMatchIndex(e,t,i){this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=pg.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),this._result[this._resultLen++]=pg.caseOps(e,i),this._lastCharIndex=t}finalize(){return this.emitUnchanged(this._source.length),this._currentStaticPiece.length!==0&&(this._result[this._resultLen++]=pg.staticValue(this._currentStaticPiece),this._currentStaticPiece=""),new j_(this._result)}}function J1e(o){if(!o||o.length===0)return new j_(null);const e=[],t=new Q1e(o);for(let i=0,n=o.length;i<n;i++){const s=o.charCodeAt(i);if(s===92){if(i++,i>=n)break;const r=o.charCodeAt(i);switch(r){case 92:t.emitUnchanged(i-1),t.emitStatic("\\",i+1);break;case 110:t.emitUnchanged(i-1),t.emitStatic(`
`,i+1);break;case 116:t.emitUnchanged(i-1),t.emitStatic("	",i+1);break;case 117:case 85:case 108:case 76:t.emitUnchanged(i-1),t.emitStatic("",i+1),e.push(String.fromCharCode(r));break}continue}if(s===36){if(i++,i>=n)break;const r=o.charCodeAt(i);if(r===36){t.emitUnchanged(i-1),t.emitStatic("$",i+1);continue}if(r===48||r===38){t.emitUnchanged(i-1),t.emitMatchIndex(0,i+1,e),e.length=0;continue}if(49<=r&&r<=57){let a=r-48;if(i+1<n){const l=o.charCodeAt(i+1);if(48<=l&&l<=57){i++,a=a*10+(l-48),t.emitUnchanged(i-2),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}t.emitUnchanged(i-1),t.emitMatchIndex(a,i+1,e),e.length=0;continue}}}return t.finalize()}const ld=new re("findWidgetVisible",!1);ld.toNegated();const LD=new re("findInputFocussed",!1),DW=new re("replaceInputFocussed",!1),a1={primary:545,mac:{primary:2593}},l1={primary:565,mac:{primary:2613}},c1={primary:560,mac:{primary:2608}},d1={primary:554,mac:{primary:2602}},h1={primary:558,mac:{primary:2606}},Vt={StartFindAction:"actions.find",StartFindWithSelection:"actions.findWithSelection",StartFindWithArgs:"editor.actions.findWithArgs",NextMatchFindAction:"editor.action.nextMatchFindAction",PreviousMatchFindAction:"editor.action.previousMatchFindAction",GoToMatchFindAction:"editor.action.goToMatchFindAction",NextSelectionMatchFindAction:"editor.action.nextSelectionMatchFindAction",PreviousSelectionMatchFindAction:"editor.action.previousSelectionMatchFindAction",StartFindReplaceAction:"editor.action.startFindReplaceAction",CloseFindWidgetCommand:"closeFindWidget",ToggleCaseSensitiveCommand:"toggleFindCaseSensitive",ToggleWholeWordCommand:"toggleFindWholeWord",ToggleRegexCommand:"toggleFindRegex",ToggleSearchScopeCommand:"toggleFindInSelection",TogglePreserveCaseCommand:"togglePreserveCase",ReplaceOneAction:"editor.action.replaceOne",ReplaceAllAction:"editor.action.replaceAll",SelectAllMatchesAction:"editor.action.selectAllMatches"},Qd=19999,e0e=240;class dC{constructor(e,t){this._toDispose=new $,this._editor=e,this._state=t,this._isDisposed=!1,this._startSearchingTimer=new qr,this._decorations=new y2(e),this._toDispose.add(this._decorations),this._updateDecorationsScheduler=new xt(()=>{if(this._editor.hasModel())return this.research(!1)},100),this._toDispose.add(this._updateDecorationsScheduler),this._toDispose.add(this._editor.onDidChangeCursorPosition(i=>{(i.reason===3||i.reason===5||i.reason===6)&&this._decorations.setStartPosition(this._editor.getPosition())})),this._ignoreModelContentChanged=!1,this._toDispose.add(this._editor.onDidChangeModelContent(i=>{this._ignoreModelContentChanged||(i.isFlush&&this._decorations.reset(),this._decorations.setStartPosition(this._editor.getPosition()),this._updateDecorationsScheduler.schedule())})),this._toDispose.add(this._state.onFindReplaceStateChange(i=>this._onStateChanged(i))),this.research(!1,this._state.searchScope)}dispose(){this._isDisposed=!0,Dt(this._startSearchingTimer),this._toDispose.dispose()}_onStateChanged(e){this._isDisposed||this._editor.hasModel()&&(e.searchString||e.isReplaceRevealed||e.isRegex||e.wholeWord||e.matchCase||e.searchScope)&&(this._editor.getModel().isTooLargeForSyncing()?(this._startSearchingTimer.cancel(),this._startSearchingTimer.setIfNotSet(()=>{e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor)},e0e)):e.searchScope?this.research(e.moveCursor,this._state.searchScope):this.research(e.moveCursor))}static _getSearchRange(e,t){return t||e.getFullModelRange()}research(e,t){let i=null;typeof t<"u"?t!==null&&(Array.isArray(t)?i=t:i=[t]):i=this._decorations.getFindScopes(),i!==null&&(i=i.map(a=>{if(a.startLineNumber!==a.endLineNumber){let l=a.endLineNumber;return a.endColumn===1&&(l=l-1),new L(a.startLineNumber,1,l,this._editor.getModel().getLineMaxColumn(l))}return a}));const n=this._findMatches(i,!1,Qd);this._decorations.set(n,i);const s=this._editor.getSelection();let r=this._decorations.getCurrentMatchesPosition(s);if(r===0&&n.length>0){const a=ty(n.map(l=>l.range),l=>L.compareRangesUsingStarts(l,s)>=0);r=a>0?a-1+1:r}this._state.changeMatchInfo(r,this._decorations.getCount(),void 0),e&&this._editor.getOption(41).cursorMoveOnType&&this._moveToNextMatch(this._decorations.getStartPosition())}_hasMatches(){return this._state.matchesCount>0}_cannotFind(){if(!this._hasMatches()){const e=this._decorations.getFindScope();return e&&this._editor.revealRangeInCenterIfOutsideViewport(e,0),!0}return!1}_setCurrentFindMatch(e){const t=this._decorations.setCurrentFindMatch(e);this._state.changeMatchInfo(t,this._decorations.getCount(),e),this._editor.setSelection(e),this._editor.revealRangeInCenterIfOutsideViewport(e,0)}_prevSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const s=this._editor.getModel();return t||n===1?(i===1?i=s.getLineCount():i--,n=s.getLineMaxColumn(i)):n--,new A(i,n)}_moveToPrevMatch(e,t=!1){if(!this._state.canNavigateBack()){const d=this._decorations.matchAfterPosition(e);d&&this._setCurrentFindMatch(d);return}if(this._decorations.getCount()<Qd){let d=this._decorations.matchBeforePosition(e);d&&d.isEmpty()&&d.getStartPosition().equals(e)&&(e=this._prevSearchPosition(e),d=this._decorations.matchBeforePosition(e)),d&&this._setCurrentFindMatch(d);return}if(this._cannotFind())return;const i=this._decorations.getFindScope(),n=dC._getSearchRange(this._editor.getModel(),i);n.getEndPosition().isBefore(e)&&(e=n.getEndPosition()),e.isBefore(n.getStartPosition())&&(e=n.getEndPosition());const{lineNumber:s,column:r}=e,a=this._editor.getModel();let l=new A(s,r),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,!1);if(c&&c.range.isEmpty()&&c.range.getStartPosition().equals(l)&&(l=this._prevSearchPosition(l),c=a.findPreviousMatch(this._state.searchString,l,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,!1)),!!c){if(!t&&!n.containsRange(c.range))return this._moveToPrevMatch(c.range.getStartPosition(),!0);this._setCurrentFindMatch(c.range)}}moveToPrevMatch(){this._moveToPrevMatch(this._editor.getSelection().getStartPosition())}_nextSearchPosition(e){const t=this._state.isRegex&&(this._state.searchString.indexOf("^")>=0||this._state.searchString.indexOf("$")>=0);let{lineNumber:i,column:n}=e;const s=this._editor.getModel();return t||n===s.getLineMaxColumn(i)?(i===s.getLineCount()?i=1:i++,n=1):n++,new A(i,n)}_moveToNextMatch(e){if(!this._state.canNavigateForward()){const i=this._decorations.matchBeforePosition(e);i&&this._setCurrentFindMatch(i);return}if(this._decorations.getCount()<Qd){let i=this._decorations.matchAfterPosition(e);i&&i.isEmpty()&&i.getStartPosition().equals(e)&&(e=this._nextSearchPosition(e),i=this._decorations.matchAfterPosition(e)),i&&this._setCurrentFindMatch(i);return}const t=this._getNextMatch(e,!1,!0);t&&this._setCurrentFindMatch(t.range)}_getNextMatch(e,t,i,n=!1){if(this._cannotFind())return null;const s=this._decorations.getFindScope(),r=dC._getSearchRange(this._editor.getModel(),s);r.getEndPosition().isBefore(e)&&(e=r.getStartPosition()),e.isBefore(r.getStartPosition())&&(e=r.getStartPosition());const{lineNumber:a,column:l}=e,c=this._editor.getModel();let d=new A(a,l),h=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t);return i&&h&&h.range.isEmpty()&&h.range.getStartPosition().equals(d)&&(d=this._nextSearchPosition(d),h=c.findNextMatch(this._state.searchString,d,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t)),h?!n&&!r.containsRange(h.range)?this._getNextMatch(h.range.getEndPosition(),t,i,!0):h:null}moveToNextMatch(){this._moveToNextMatch(this._editor.getSelection().getEndPosition())}_moveToMatch(e){const t=this._decorations.getDecorationRangeAt(e);t&&this._setCurrentFindMatch(t)}moveToMatch(e){this._moveToMatch(e)}_getReplacePattern(){return this._state.isRegex?J1e(this._state.replaceString):j_.fromStaticValue(this._state.replaceString)}replace(){if(!this._hasMatches())return;const e=this._getReplacePattern(),t=this._editor.getSelection(),i=this._getNextMatch(t.getStartPosition(),!0,!1);if(i)if(t.equalsRange(i.range)){const n=e.buildReplaceString(i.matches,this._state.preserveCase),s=new xn(t,n);this._executeEditorCommand("replace",s),this._decorations.setStartPosition(new A(t.startLineNumber,t.startColumn+n.length)),this.research(!0)}else this._decorations.setStartPosition(this._editor.getPosition()),this._setCurrentFindMatch(i.range)}_findMatches(e,t,i){const n=(e||[null]).map(s=>dC._getSearchRange(this._editor.getModel(),s));return this._editor.getModel().findMatches(this._state.searchString,n,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null,t,i)}replaceAll(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();e===null&&this._state.matchesCount>=Qd?this._largeReplaceAll():this._regularReplaceAll(e),this.research(!1)}_largeReplaceAll(){const t=new Su(this._state.searchString,this._state.isRegex,this._state.matchCase,this._state.wholeWord?this._editor.getOption(132):null).parseSearchRequest();if(!t)return;let i=t.regex;if(!i.multiline){let h="mu";i.ignoreCase&&(h+="i"),i.global&&(h+="g"),i=new RegExp(i.source,h)}const n=this._editor.getModel(),s=n.getValue(1),r=n.getFullModelRange(),a=this._getReplacePattern();let l;const c=this._state.preserveCase;a.hasReplacementPatterns||c?l=s.replace(i,function(){return a.buildReplaceString(arguments,c)}):l=s.replace(i,a.buildReplaceString(null,c));const d=new kB(r,l,this._editor.getSelection());this._executeEditorCommand("replaceAll",d)}_regularReplaceAll(e){const t=this._getReplacePattern(),i=this._findMatches(e,t.hasReplacementPatterns||this._state.preserveCase,1073741824),n=[];for(let r=0,a=i.length;r<a;r++)n[r]=t.buildReplaceString(i[r].matches,this._state.preserveCase);const s=new Y1e(this._editor.getSelection(),i.map(r=>r.range),n);this._executeEditorCommand("replaceAll",s)}selectAllMatches(){if(!this._hasMatches())return;const e=this._decorations.getFindScopes();let i=this._findMatches(e,!1,1073741824).map(s=>new pe(s.range.startLineNumber,s.range.startColumn,s.range.endLineNumber,s.range.endColumn));const n=this._editor.getSelection();for(let s=0,r=i.length;s<r;s++)if(i[s].equalsRange(n)){i=[n].concat(i.slice(0,s)).concat(i.slice(s+1));break}this._editor.setSelections(i)}_executeEditorCommand(e,t){try{this._ignoreModelContentChanged=!0,this._editor.pushUndoStop(),this._editor.executeCommand(e,t),this._editor.pushUndoStop()}finally{this._ignoreModelContentChanged=!1}}}const mE=class mE extends Go{constructor(e,t,i){super(),this._hideSoon=this._register(new xt(()=>this._hide(),2e3)),this._isVisible=!1,this._editor=e,this._state=t,this._keybindingService=i,this._domNode=document.createElement("div"),this._domNode.className="findOptionsWidget",this._domNode.style.display="none",this._domNode.style.top="10px",this._domNode.style.zIndex="12",this._domNode.setAttribute("role","presentation"),this._domNode.setAttribute("aria-hidden","true");const n={inputActiveOptionBorder:ce(DT),inputActiveOptionForeground:ce(IT),inputActiveOptionBackground:ce(Dw)},s=this._register(D_());this.caseSensitive=this._register(new $$({appendTitle:this._keybindingLabelFor(Vt.ToggleCaseSensitiveCommand),isChecked:this._state.matchCase,hoverDelegate:s,...n})),this._domNode.appendChild(this.caseSensitive.domNode),this._register(this.caseSensitive.onChange(()=>{this._state.change({matchCase:this.caseSensitive.checked},!1)})),this.wholeWords=this._register(new K$({appendTitle:this._keybindingLabelFor(Vt.ToggleWholeWordCommand),isChecked:this._state.wholeWord,hoverDelegate:s,...n})),this._domNode.appendChild(this.wholeWords.domNode),this._register(this.wholeWords.onChange(()=>{this._state.change({wholeWord:this.wholeWords.checked},!1)})),this.regex=this._register(new j$({appendTitle:this._keybindingLabelFor(Vt.ToggleRegexCommand),isChecked:this._state.isRegex,hoverDelegate:s,...n})),this._domNode.appendChild(this.regex.domNode),this._register(this.regex.onChange(()=>{this._state.change({isRegex:this.regex.checked},!1)})),this._editor.addOverlayWidget(this),this._register(this._state.onFindReplaceStateChange(r=>{let a=!1;r.isRegex&&(this.regex.checked=this._state.isRegex,a=!0),r.wholeWord&&(this.wholeWords.checked=this._state.wholeWord,a=!0),r.matchCase&&(this.caseSensitive.checked=this._state.matchCase,a=!0),!this._state.isRevealed&&a&&this._revealTemporarily()})),this._register(H(this._domNode,ee.MOUSE_LEAVE,r=>this._onMouseLeave())),this._register(H(this._domNode,"mouseover",r=>this._onMouseOver()))}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return mE.ID}getDomNode(){return this._domNode}getPosition(){return{preference:0}}highlightFindOptions(){this._revealTemporarily()}_revealTemporarily(){this._show(),this._hideSoon.schedule()}_onMouseLeave(){this._hideSoon.schedule()}_onMouseOver(){this._hideSoon.cancel()}_show(){this._isVisible||(this._isVisible=!0,this._domNode.style.display="block")}_hide(){this._isVisible&&(this._isVisible=!1,this._domNode.style.display="none")}};mE.ID="editor.contrib.findOptionsWidget";let w2=mE;function u1(o,e){return o===1?!0:o===2?!1:e}class t0e extends F{get searchString(){return this._searchString}get replaceString(){return this._replaceString}get isRevealed(){return this._isRevealed}get isReplaceRevealed(){return this._isReplaceRevealed}get isRegex(){return u1(this._isRegexOverride,this._isRegex)}get wholeWord(){return u1(this._wholeWordOverride,this._wholeWord)}get matchCase(){return u1(this._matchCaseOverride,this._matchCase)}get preserveCase(){return u1(this._preserveCaseOverride,this._preserveCase)}get actualIsRegex(){return this._isRegex}get actualWholeWord(){return this._wholeWord}get actualMatchCase(){return this._matchCase}get actualPreserveCase(){return this._preserveCase}get searchScope(){return this._searchScope}get matchesPosition(){return this._matchesPosition}get matchesCount(){return this._matchesCount}get currentMatch(){return this._currentMatch}constructor(){super(),this._onFindReplaceStateChange=this._register(new O),this.onFindReplaceStateChange=this._onFindReplaceStateChange.event,this._searchString="",this._replaceString="",this._isRevealed=!1,this._isReplaceRevealed=!1,this._isRegex=!1,this._isRegexOverride=0,this._wholeWord=!1,this._wholeWordOverride=0,this._matchCase=!1,this._matchCaseOverride=0,this._preserveCase=!1,this._preserveCaseOverride=0,this._searchScope=null,this._matchesPosition=0,this._matchesCount=0,this._currentMatch=null,this._loop=!0,this._isSearching=!1,this._filters=null}changeMatchInfo(e,t,i){const n={moveCursor:!1,updateHistory:!1,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let s=!1;t===0&&(e=0),e>t&&(e=t),this._matchesPosition!==e&&(this._matchesPosition=e,n.matchesPosition=!0,s=!0),this._matchesCount!==t&&(this._matchesCount=t,n.matchesCount=!0,s=!0),typeof i<"u"&&(L.equalsRange(this._currentMatch,i)||(this._currentMatch=i,n.currentMatch=!0,s=!0)),s&&this._onFindReplaceStateChange.fire(n)}change(e,t,i=!0){const n={moveCursor:t,updateHistory:i,searchString:!1,replaceString:!1,isRevealed:!1,isReplaceRevealed:!1,isRegex:!1,wholeWord:!1,matchCase:!1,preserveCase:!1,searchScope:!1,matchesPosition:!1,matchesCount:!1,currentMatch:!1,loop:!1,isSearching:!1,filters:!1};let s=!1;const r=this.isRegex,a=this.wholeWord,l=this.matchCase,c=this.preserveCase;typeof e.searchString<"u"&&this._searchString!==e.searchString&&(this._searchString=e.searchString,n.searchString=!0,s=!0),typeof e.replaceString<"u"&&this._replaceString!==e.replaceString&&(this._replaceString=e.replaceString,n.replaceString=!0,s=!0),typeof e.isRevealed<"u"&&this._isRevealed!==e.isRevealed&&(this._isRevealed=e.isRevealed,n.isRevealed=!0,s=!0),typeof e.isReplaceRevealed<"u"&&this._isReplaceRevealed!==e.isReplaceRevealed&&(this._isReplaceRevealed=e.isReplaceRevealed,n.isReplaceRevealed=!0,s=!0),typeof e.isRegex<"u"&&(this._isRegex=e.isRegex),typeof e.wholeWord<"u"&&(this._wholeWord=e.wholeWord),typeof e.matchCase<"u"&&(this._matchCase=e.matchCase),typeof e.preserveCase<"u"&&(this._preserveCase=e.preserveCase),typeof e.searchScope<"u"&&(e.searchScope?.every(d=>this._searchScope?.some(h=>!L.equalsRange(h,d)))||(this._searchScope=e.searchScope,n.searchScope=!0,s=!0)),typeof e.loop<"u"&&this._loop!==e.loop&&(this._loop=e.loop,n.loop=!0,s=!0),typeof e.isSearching<"u"&&this._isSearching!==e.isSearching&&(this._isSearching=e.isSearching,n.isSearching=!0,s=!0),typeof e.filters<"u"&&(this._filters?this._filters.update(e.filters):this._filters=e.filters,n.filters=!0,s=!0),this._isRegexOverride=typeof e.isRegexOverride<"u"?e.isRegexOverride:0,this._wholeWordOverride=typeof e.wholeWordOverride<"u"?e.wholeWordOverride:0,this._matchCaseOverride=typeof e.matchCaseOverride<"u"?e.matchCaseOverride:0,this._preserveCaseOverride=typeof e.preserveCaseOverride<"u"?e.preserveCaseOverride:0,r!==this.isRegex&&(s=!0,n.isRegex=!0),a!==this.wholeWord&&(s=!0,n.wholeWord=!0),l!==this.matchCase&&(s=!0,n.matchCase=!0),c!==this.preserveCase&&(s=!0,n.preserveCase=!0),s&&this._onFindReplaceStateChange.fire(n)}canNavigateBack(){return this.canNavigateInLoop()||this.matchesPosition!==1}canNavigateForward(){return this.canNavigateInLoop()||this.matchesPosition<this.matchesCount}canNavigateInLoop(){return this._loop||this.matchesCount>=Qd}}const i0e=p("defaultLabel","input"),n0e=p("label.preserveCaseToggle","Preserve Case");class s0e extends pb{constructor(e){super({icon:J.preserveCase,title:n0e+e.appendTitle,isChecked:e.isChecked,hoverDelegate:e.hoverDelegate??bs("element"),inputActiveOptionBorder:e.inputActiveOptionBorder,inputActiveOptionForeground:e.inputActiveOptionForeground,inputActiveOptionBackground:e.inputActiveOptionBackground})}}class o0e extends Go{constructor(e,t,i,n){super(),this._showOptionButtons=i,this.fixFocusOnOptionClickEnabled=!0,this.cachedOptionsWidth=0,this._onDidOptionChange=this._register(new O),this.onDidOptionChange=this._onDidOptionChange.event,this._onKeyDown=this._register(new O),this.onKeyDown=this._onKeyDown.event,this._onMouseDown=this._register(new O),this._onInput=this._register(new O),this._onKeyUp=this._register(new O),this._onPreserveCaseKeyDown=this._register(new O),this.onPreserveCaseKeyDown=this._onPreserveCaseKeyDown.event,this.contextViewProvider=t,this.placeholder=n.placeholder||"",this.validation=n.validation,this.label=n.label||i0e;const s=n.appendPreserveCaseLabel||"",r=n.history||[],a=!!n.flexibleHeight,l=!!n.flexibleWidth,c=n.flexibleMaxHeight;this.domNode=document.createElement("div"),this.domNode.classList.add("monaco-findInput"),this.inputBox=this._register(new q$(this.domNode,this.contextViewProvider,{ariaLabel:this.label||"",placeholder:this.placeholder||"",validationOptions:{validation:this.validation},history:r,showHistoryHint:n.showHistoryHint,flexibleHeight:a,flexibleWidth:l,flexibleMaxHeight:c,inputBoxStyles:n.inputBoxStyles})),this.preserveCase=this._register(new s0e({appendTitle:s,isChecked:!1,...n.toggleStyles})),this._register(this.preserveCase.onChange(u=>{this._onDidOptionChange.fire(u),!u&&this.fixFocusOnOptionClickEnabled&&this.inputBox.focus(),this.validate()})),this._register(this.preserveCase.onKeyDown(u=>{this._onPreserveCaseKeyDown.fire(u)})),this._showOptionButtons?this.cachedOptionsWidth=this.preserveCase.width():this.cachedOptionsWidth=0;const d=[this.preserveCase.domNode];this.onkeydown(this.domNode,u=>{if(u.equals(15)||u.equals(17)||u.equals(9)){const g=d.indexOf(this.domNode.ownerDocument.activeElement);if(g>=0){let f=-1;u.equals(17)?f=(g+1)%d.length:u.equals(15)&&(g===0?f=d.length-1:f=g-1),u.equals(9)?(d[g].blur(),this.inputBox.focus()):f>=0&&d[f].focus(),tt.stop(u,!0)}}});const h=document.createElement("div");h.className="controls",h.style.display=this._showOptionButtons?"block":"none",h.appendChild(this.preserveCase.domNode),this.domNode.appendChild(h),e?.appendChild(this.domNode),this.onkeydown(this.inputBox.inputElement,u=>this._onKeyDown.fire(u)),this.onkeyup(this.inputBox.inputElement,u=>this._onKeyUp.fire(u)),this.oninput(this.inputBox.inputElement,u=>this._onInput.fire()),this.onmousedown(this.inputBox.inputElement,u=>this._onMouseDown.fire(u))}enable(){this.domNode.classList.remove("disabled"),this.inputBox.enable(),this.preserveCase.enable()}disable(){this.domNode.classList.add("disabled"),this.inputBox.disable(),this.preserveCase.disable()}setEnabled(e){e?this.enable():this.disable()}select(){this.inputBox.select()}focus(){this.inputBox.focus()}getPreserveCase(){return this.preserveCase.checked}setPreserveCase(e){this.preserveCase.checked=e}focusOnPreserve(){this.preserveCase.focus()}validate(){this.inputBox?.validate()}set width(e){this.inputBox.paddingRight=this.cachedOptionsWidth,this.domNode.style.width=e+"px"}dispose(){super.dispose()}}var cZ=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},dZ=function(o,e){return function(t,i){e(t,i,o)}};const IW=new re("suggestWidgetVisible",!1,p("suggestWidgetVisible","Whether suggestion are visible")),NW="historyNavigationWidgetFocus",hZ="historyNavigationForwardsEnabled",uZ="historyNavigationBackwardsEnabled";let hC;const g1=[];function gZ(o,e){if(g1.includes(e))throw new Error("Cannot register the same widget multiple times");g1.push(e);const t=new $,i=new re(NW,!1).bindTo(o),n=new re(hZ,!0).bindTo(o),s=new re(uZ,!0).bindTo(o),r=()=>{i.set(!0),hC=e},a=()=>{i.set(!1),hC===e&&(hC=void 0)};return lT(e.element)&&r(),t.add(e.onDidFocus(()=>r())),t.add(e.onDidBlur(()=>a())),t.add(ve(()=>{g1.splice(g1.indexOf(e),1),a()})),{historyNavigationForwardsEnablement:n,historyNavigationBackwardsEnablement:s,dispose(){t.dispose()}}}let S2=class extends Z${constructor(e,t,i,n){super(e,t,i);const s=this._register(n.createScoped(this.inputBox.element));this._register(gZ(s,this.inputBox))}};S2=cZ([dZ(3,Ee)],S2);let x2=class extends o0e{constructor(e,t,i,n,s=!1){super(e,t,s,i);const r=this._register(n.createScoped(this.inputBox.element));this._register(gZ(r,this.inputBox))}};x2=cZ([dZ(3,Ee)],x2);fs.registerCommandAndKeybindingRule({id:"history.showPrevious",weight:200,when:K.and(K.has(NW),K.equals(uZ,!0),K.not("isComposing"),IW.isEqualTo(!1)),primary:16,secondary:[528],handler:o=>{hC?.showPreviousValue()}});fs.registerCommandAndKeybindingRule({id:"history.showNext",weight:200,when:K.and(K.has(NW),K.equals(hZ,!0),K.not("isComposing"),IW.isEqualTo(!1)),primary:18,secondary:[530],handler:o=>{hC?.showNextValue()}});function N8(o){return o.lookupKeybinding("history.showPrevious")?.getElectronAccelerator()==="Up"&&o.lookupKeybinding("history.showNext")?.getElectronAccelerator()==="Down"}const R8=Gt("find-collapsed",J.chevronRight,p("findCollapsedIcon","Icon to indicate that the editor find widget is collapsed.")),P8=Gt("find-expanded",J.chevronDown,p("findExpandedIcon","Icon to indicate that the editor find widget is expanded.")),r0e=Gt("find-selection",J.selection,p("findSelectionIcon","Icon for 'Find in Selection' in the editor find widget.")),a0e=Gt("find-replace",J.replace,p("findReplaceIcon","Icon for 'Replace' in the editor find widget.")),l0e=Gt("find-replace-all",J.replaceAll,p("findReplaceAllIcon","Icon for 'Replace All' in the editor find widget.")),c0e=Gt("find-previous-match",J.arrowUp,p("findPreviousMatchIcon","Icon for 'Find Previous' in the editor find widget.")),d0e=Gt("find-next-match",J.arrowDown,p("findNextMatchIcon","Icon for 'Find Next' in the editor find widget.")),h0e=p("label.findDialog","Find / Replace"),u0e=p("label.find","Find"),g0e=p("placeholder.find","Find"),f0e=p("label.previousMatchButton","Previous Match"),p0e=p("label.nextMatchButton","Next Match"),m0e=p("label.toggleSelectionFind","Find in Selection"),_0e=p("label.closeButton","Close"),b0e=p("label.replace","Replace"),v0e=p("placeholder.replace","Replace"),C0e=p("label.replaceButton","Replace"),y0e=p("label.replaceAllButton","Replace All"),w0e=p("label.toggleReplaceButton","Toggle Replace"),S0e=p("title.matchesCountLimit","Only the first {0} results are highlighted, but all find operations work on the entire text.",Qd),x0e=p("label.matchesLocation","{0} of {1}"),A8=p("label.noResults","No results"),Za=419,L0e=275,k0e=L0e-54;let sv=69;const E0e=33,M8="ctrlEnterReplaceAll.windows.donotask",O8=Qe?256:2048;class wN{constructor(e){this.afterLineNumber=e,this.heightInPx=E0e,this.suppressMouseDown=!1,this.domNode=document.createElement("div"),this.domNode.className="dock-find-viewzone"}}function F8(o,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionStart>0){o.stopPropagation();return}}function B8(o,e,t){const i=!!e.match(/\n/);if(t&&i&&t.selectionEnd<t.value.length){o.stopPropagation();return}}const _E=class _E extends Go{constructor(e,t,i,n,s,r,a,l,c,d){super(),this._hoverService=d,this._cachedHeight=null,this._revealTimeouts=[],this._codeEditor=e,this._controller=t,this._state=i,this._contextViewProvider=n,this._keybindingService=s,this._contextKeyService=r,this._storageService=l,this._notificationService=c,this._ctrlEnterReplaceAllWarningPrompted=!!l.getBoolean(M8,0),this._isVisible=!1,this._isReplaceVisible=!1,this._ignoreChangeEvent=!1,this._updateHistoryDelayer=new hr(500),this._register(ve(()=>this._updateHistoryDelayer.cancel())),this._register(this._state.onFindReplaceStateChange(h=>this._onStateChanged(h))),this._buildDomNode(),this._updateButtons(),this._tryUpdateWidgetWidth(),this._findInput.inputBox.layout(),this._register(this._codeEditor.onDidChangeConfiguration(h=>{if(h.hasChanged(92)&&(this._codeEditor.getOption(92)&&this._state.change({isReplaceRevealed:!1},!1),this._updateButtons()),h.hasChanged(146)&&this._tryUpdateWidgetWidth(),h.hasChanged(2)&&this.updateAccessibilitySupport(),h.hasChanged(41)){const u=this._codeEditor.getOption(41).loop;this._state.change({loop:u},!1);const g=this._codeEditor.getOption(41).addExtraSpaceOnTop;g&&!this._viewZone&&(this._viewZone=new wN(0),this._showViewZone()),!g&&this._viewZone&&this._removeViewZone()}})),this.updateAccessibilitySupport(),this._register(this._codeEditor.onDidChangeCursorSelection(()=>{this._isVisible&&this._updateToggleSelectionFindButton()})),this._register(this._codeEditor.onDidFocusEditorWidget(async()=>{if(this._isVisible){const h=await this._controller.getGlobalBufferTerm();h&&h!==this._state.searchString&&(this._state.change({searchString:h},!1),this._findInput.select())}})),this._findInputFocused=LD.bindTo(r),this._findFocusTracker=this._register(Ia(this._findInput.inputBox.inputElement)),this._register(this._findFocusTracker.onDidFocus(()=>{this._findInputFocused.set(!0),this._updateSearchScope()})),this._register(this._findFocusTracker.onDidBlur(()=>{this._findInputFocused.set(!1)})),this._replaceInputFocused=DW.bindTo(r),this._replaceFocusTracker=this._register(Ia(this._replaceInput.inputBox.inputElement)),this._register(this._replaceFocusTracker.onDidFocus(()=>{this._replaceInputFocused.set(!0),this._updateSearchScope()})),this._register(this._replaceFocusTracker.onDidBlur(()=>{this._replaceInputFocused.set(!1)})),this._codeEditor.addOverlayWidget(this),this._codeEditor.getOption(41).addExtraSpaceOnTop&&(this._viewZone=new wN(0)),this._register(this._codeEditor.onDidChangeModel(()=>{this._isVisible&&(this._viewZoneId=void 0)})),this._register(this._codeEditor.onDidScrollChange(h=>{if(h.scrollTopChanged){this._layoutViewZone();return}setTimeout(()=>{this._layoutViewZone()},0)}))}getId(){return _E.ID}getDomNode(){return this._domNode}getPosition(){return this._isVisible?{preference:0}:null}_onStateChanged(e){if(e.searchString){try{this._ignoreChangeEvent=!0,this._findInput.setValue(this._state.searchString)}finally{this._ignoreChangeEvent=!1}this._updateButtons()}if(e.replaceString&&(this._replaceInput.inputBox.value=this._state.replaceString),e.isRevealed&&(this._state.isRevealed?this._reveal():this._hide(!0)),e.isReplaceRevealed&&(this._state.isReplaceRevealed?!this._codeEditor.getOption(92)&&!this._isReplaceVisible&&(this._isReplaceVisible=!0,this._replaceInput.width=Ks(this._findInput.domNode),this._updateButtons(),this._replaceInput.inputBox.layout()):this._isReplaceVisible&&(this._isReplaceVisible=!1,this._updateButtons())),(e.isRevealed||e.isReplaceRevealed)&&(this._state.isRevealed||this._state.isReplaceRevealed)&&this._tryUpdateHeight()&&this._showViewZone(),e.isRegex&&this._findInput.setRegex(this._state.isRegex),e.wholeWord&&this._findInput.setWholeWords(this._state.wholeWord),e.matchCase&&this._findInput.setCaseSensitive(this._state.matchCase),e.preserveCase&&this._replaceInput.setPreserveCase(this._state.preserveCase),e.searchScope&&(this._state.searchScope?this._toggleSelectionFind.checked=!0:this._toggleSelectionFind.checked=!1,this._updateToggleSelectionFindButton()),e.searchString||e.matchesCount||e.matchesPosition){const t=this._state.searchString.length>0&&this._state.matchesCount===0;this._domNode.classList.toggle("no-results",t),this._updateMatchesCount(),this._updateButtons()}(e.searchString||e.currentMatch)&&this._layoutViewZone(),e.updateHistory&&this._delayedUpdateHistory(),e.loop&&this._updateButtons()}_delayedUpdateHistory(){this._updateHistoryDelayer.trigger(this._updateHistory.bind(this)).then(void 0,Ae)}_updateHistory(){this._state.searchString&&this._findInput.inputBox.addToHistory(),this._state.replaceString&&this._replaceInput.inputBox.addToHistory()}_updateMatchesCount(){this._matchesCount.style.minWidth=sv+"px",this._state.matchesCount>=Qd?this._matchesCount.title=S0e:this._matchesCount.title="",this._matchesCount.firstChild?.remove();let e;if(this._state.matchesCount>0){let t=String(this._state.matchesCount);this._state.matchesCount>=Qd&&(t+="+");let i=String(this._state.matchesPosition);i==="0"&&(i="?"),e=mf(x0e,i,t)}else e=A8;this._matchesCount.appendChild(document.createTextNode(e)),ps(this._getAriaLabel(e,this._state.currentMatch,this._state.searchString)),sv=Math.max(sv,this._matchesCount.clientWidth)}_getAriaLabel(e,t,i){if(e===A8)return i===""?p("ariaSearchNoResultEmpty","{0} found",e):p("ariaSearchNoResult","{0} found for '{1}'",e,i);if(t){const n=p("ariaSearchNoResultWithLineNum","{0} found for '{1}', at {2}",e,i,t.startLineNumber+":"+t.startColumn),s=this._codeEditor.getModel();return s&&t.startLineNumber<=s.getLineCount()&&t.startLineNumber>=1?`${s.getLineContent(t.startLineNumber)}, ${n}`:n}return p("ariaSearchNoResultWithLineNumNoCurrentMatch","{0} found for '{1}'",e,i)}_updateToggleSelectionFindButton(){const e=this._codeEditor.getSelection(),t=e?e.startLineNumber!==e.endLineNumber||e.startColumn!==e.endColumn:!1,i=this._toggleSelectionFind.checked;this._isVisible&&(i||t)?this._toggleSelectionFind.enable():this._toggleSelectionFind.disable()}_updateButtons(){this._findInput.setEnabled(this._isVisible),this._replaceInput.setEnabled(this._isVisible&&this._isReplaceVisible),this._updateToggleSelectionFindButton(),this._closeBtn.setEnabled(this._isVisible);const e=this._state.searchString.length>0,t=!!this._state.matchesCount;this._prevBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateBack()),this._nextBtn.setEnabled(this._isVisible&&e&&t&&this._state.canNavigateForward()),this._replaceBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._replaceAllBtn.setEnabled(this._isVisible&&this._isReplaceVisible&&e),this._domNode.classList.toggle("replaceToggled",this._isReplaceVisible),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible);const i=!this._codeEditor.getOption(92);this._toggleReplaceBtn.setEnabled(this._isVisible&&i)}_reveal(){if(this._revealTimeouts.forEach(e=>{clearTimeout(e)}),this._revealTimeouts=[],!this._isVisible){this._isVisible=!0;const e=this._codeEditor.getSelection();switch(this._codeEditor.getOption(41).autoFindInSelection){case"always":this._toggleSelectionFind.checked=!0;break;case"never":this._toggleSelectionFind.checked=!1;break;case"multiline":{const i=!!e&&e.startLineNumber!==e.endLineNumber;this._toggleSelectionFind.checked=i;break}}this._tryUpdateWidgetWidth(),this._updateButtons(),this._revealTimeouts.push(setTimeout(()=>{this._domNode.classList.add("visible"),this._domNode.setAttribute("aria-hidden","false")},0)),this._revealTimeouts.push(setTimeout(()=>{this._findInput.validate()},200)),this._codeEditor.layoutOverlayWidget(this);let t=!0;if(this._codeEditor.getOption(41).seedSearchStringFromSelection&&e){const i=this._codeEditor.getDomNode();if(i){const n=Ci(i),s=this._codeEditor.getScrolledVisiblePosition(e.getStartPosition()),r=n.left+(s?s.left:0),a=s?s.top:0;if(this._viewZone&&a<this._viewZone.heightInPx){e.endLineNumber>e.startLineNumber&&(t=!1);const l=qz(this._domNode).left;r>l&&(t=!1);const c=this._codeEditor.getScrolledVisiblePosition(e.getEndPosition());n.left+(c?c.left:0)>l&&(t=!1)}}}this._showViewZone(t)}}_hide(e){this._revealTimeouts.forEach(t=>{clearTimeout(t)}),this._revealTimeouts=[],this._isVisible&&(this._isVisible=!1,this._updateButtons(),this._domNode.classList.remove("visible"),this._domNode.setAttribute("aria-hidden","true"),this._findInput.clearMessage(),e&&this._codeEditor.focus(),this._codeEditor.layoutOverlayWidget(this),this._removeViewZone())}_layoutViewZone(e){if(!this._codeEditor.getOption(41).addExtraSpaceOnTop){this._removeViewZone();return}if(!this._isVisible)return;const i=this._viewZone;this._viewZoneId!==void 0||!i||this._codeEditor.changeViewZones(n=>{i.heightInPx=this._getHeight(),this._viewZoneId=n.addZone(i),this._codeEditor.setScrollTop(e||this._codeEditor.getScrollTop()+i.heightInPx)})}_showViewZone(e=!0){if(!this._isVisible||!this._codeEditor.getOption(41).addExtraSpaceOnTop)return;this._viewZone===void 0&&(this._viewZone=new wN(0));const i=this._viewZone;this._codeEditor.changeViewZones(n=>{if(this._viewZoneId!==void 0){const s=this._getHeight();if(s===i.heightInPx)return;const r=s-i.heightInPx;i.heightInPx=s,n.layoutZone(this._viewZoneId),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+r);return}else{let s=this._getHeight();if(s-=this._codeEditor.getOption(84).top,s<=0)return;i.heightInPx=s,this._viewZoneId=n.addZone(i),e&&this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()+s)}})}_removeViewZone(){this._codeEditor.changeViewZones(e=>{this._viewZoneId!==void 0&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0,this._viewZone&&(this._codeEditor.setScrollTop(this._codeEditor.getScrollTop()-this._viewZone.heightInPx),this._viewZone=void 0))})}_tryUpdateWidgetWidth(){if(!this._isVisible||!this._domNode.isConnected)return;const e=this._codeEditor.getLayoutInfo();if(e.contentWidth<=0){this._domNode.classList.add("hiddenEditor");return}else this._domNode.classList.contains("hiddenEditor")&&this._domNode.classList.remove("hiddenEditor");const i=e.width,n=e.minimap.minimapWidth;let s=!1,r=!1,a=!1;if(this._resized&&Ks(this._domNode)>Za){this._domNode.style.maxWidth=`${i-28-n-15}px`,this._replaceInput.width=Ks(this._findInput.domNode);return}if(Za+28+n>=i&&(r=!0),Za+28+n-sv>=i&&(a=!0),Za+28+n-sv>=i+50&&(s=!0),this._domNode.classList.toggle("collapsed-find-widget",s),this._domNode.classList.toggle("narrow-find-widget",a),this._domNode.classList.toggle("reduced-find-widget",r),!a&&!s&&(this._domNode.style.maxWidth=`${i-28-n-15}px`),this._findInput.layout({collapsedFindWidget:s,narrowFindWidget:a,reducedFindWidget:r}),this._resized){const l=this._findInput.inputBox.element.clientWidth;l>0&&(this._replaceInput.width=l)}else this._isReplaceVisible&&(this._replaceInput.width=Ks(this._findInput.domNode))}_getHeight(){let e=0;return e+=4,e+=this._findInput.inputBox.height+2,this._isReplaceVisible&&(e+=4,e+=this._replaceInput.inputBox.height+2),e+=4,e}_tryUpdateHeight(){const e=this._getHeight();return this._cachedHeight!==null&&this._cachedHeight===e?!1:(this._cachedHeight=e,this._domNode.style.height=`${e}px`,!0)}focusFindInput(){this._findInput.select(),this._findInput.focus()}focusReplaceInput(){this._replaceInput.select(),this._replaceInput.focus()}highlightFindOptions(){this._findInput.highlightFindOptions()}_updateSearchScope(){if(this._codeEditor.hasModel()&&this._toggleSelectionFind.checked){const e=this._codeEditor.getSelections();e.map(t=>{t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(t.endLineNumber-1)));const i=this._state.currentMatch;return t.startLineNumber!==t.endLineNumber&&!L.equalsRange(t,i)?t:null}).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}_onFindInputMouseDown(e){e.middleButton&&e.stopPropagation()}_onFindInputKeyDown(e){if(e.equals(O8|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{this._findInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._isReplaceVisible?this._replaceInput.focus():this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return F8(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"));if(e.equals(18))return B8(e,this._findInput.getValue(),this._findInput.domNode.querySelector("textarea"))}_onReplaceInputKeyDown(e){if(e.equals(O8|3))if(this._keybindingService.dispatchEvent(e,e.target)){e.preventDefault();return}else{En&&El&&!this._ctrlEnterReplaceAllWarningPrompted&&(this._notificationService.info(p("ctrlEnter.keybindingChanged","Ctrl+Enter now inserts line break instead of replacing all. You can modify the keybinding for editor.action.replaceAll to override this behavior.")),this._ctrlEnterReplaceAllWarningPrompted=!0,this._storageService.store(M8,!0,0,0)),this._replaceInput.inputBox.insertAtCursor(`
`),e.preventDefault();return}if(e.equals(2)){this._findInput.focusOnCaseSensitive(),e.preventDefault();return}if(e.equals(1026)){this._findInput.focus(),e.preventDefault();return}if(e.equals(2066)){this._codeEditor.focus(),e.preventDefault();return}if(e.equals(16))return F8(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"));if(e.equals(18))return B8(e,this._replaceInput.inputBox.value,this._replaceInput.inputBox.element.querySelector("textarea"))}getVerticalSashLeft(e){return 0}_keybindingLabelFor(e){const t=this._keybindingService.lookupKeybinding(e);return t?` (${t.getLabel()})`:""}_buildDomNode(){this._findInput=this._register(new S2(null,this._contextViewProvider,{width:k0e,label:u0e,placeholder:g0e,appendCaseSensitiveLabel:this._keybindingLabelFor(Vt.ToggleCaseSensitiveCommand),appendWholeWordsLabel:this._keybindingLabelFor(Vt.ToggleWholeWordCommand),appendRegexLabel:this._keybindingLabelFor(Vt.ToggleRegexCommand),validation:d=>{if(d.length===0||!this._findInput.getRegex())return null;try{return new RegExp(d,"gu"),null}catch(h){return{content:h.message}}},flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showCommonFindToggles:!0,showHistoryHint:()=>N8(this._keybindingService),inputBoxStyles:gx,toggleStyles:ux},this._contextKeyService)),this._findInput.setRegex(!!this._state.isRegex),this._findInput.setCaseSensitive(!!this._state.matchCase),this._findInput.setWholeWords(!!this._state.wholeWord),this._register(this._findInput.onKeyDown(d=>this._onFindInputKeyDown(d))),this._register(this._findInput.inputBox.onDidChange(()=>{this._ignoreChangeEvent||this._state.change({searchString:this._findInput.getValue()},!0)})),this._register(this._findInput.onDidOptionChange(()=>{this._state.change({isRegex:this._findInput.getRegex(),wholeWord:this._findInput.getWholeWords(),matchCase:this._findInput.getCaseSensitive()},!0)})),this._register(this._findInput.onCaseSensitiveKeyDown(d=>{d.equals(1026)&&this._isReplaceVisible&&(this._replaceInput.focus(),d.preventDefault())})),this._register(this._findInput.onRegexKeyDown(d=>{d.equals(2)&&this._isReplaceVisible&&(this._replaceInput.focusOnPreserve(),d.preventDefault())})),this._register(this._findInput.inputBox.onDidHeightChange(d=>{this._tryUpdateHeight()&&this._showViewZone()})),us&&this._register(this._findInput.onMouseDown(d=>this._onFindInputMouseDown(d))),this._matchesCount=document.createElement("div"),this._matchesCount.className="matchesCount",this._updateMatchesCount();const i=this._register(D_());this._prevBtn=this._register(new Tp({label:f0e+this._keybindingLabelFor(Vt.PreviousMatchFindAction),icon:c0e,hoverDelegate:i,onTrigger:()=>{Vd(this._codeEditor.getAction(Vt.PreviousMatchFindAction)).run().then(void 0,Ae)}},this._hoverService)),this._nextBtn=this._register(new Tp({label:p0e+this._keybindingLabelFor(Vt.NextMatchFindAction),icon:d0e,hoverDelegate:i,onTrigger:()=>{Vd(this._codeEditor.getAction(Vt.NextMatchFindAction)).run().then(void 0,Ae)}},this._hoverService));const n=document.createElement("div");n.className="find-part",n.appendChild(this._findInput.domNode);const s=document.createElement("div");s.className="find-actions",n.appendChild(s),s.appendChild(this._matchesCount),s.appendChild(this._prevBtn.domNode),s.appendChild(this._nextBtn.domNode),this._toggleSelectionFind=this._register(new pb({icon:r0e,title:m0e+this._keybindingLabelFor(Vt.ToggleSearchScopeCommand),isChecked:!1,hoverDelegate:i,inputActiveOptionBackground:ce(Dw),inputActiveOptionBorder:ce(DT),inputActiveOptionForeground:ce(IT)})),this._register(this._toggleSelectionFind.onChange(()=>{if(this._toggleSelectionFind.checked){if(this._codeEditor.hasModel()){let d=this._codeEditor.getSelections();d=d.map(h=>(h.endColumn===1&&h.endLineNumber>h.startLineNumber&&(h=h.setEndPosition(h.endLineNumber-1,this._codeEditor.getModel().getLineMaxColumn(h.endLineNumber-1))),h.isEmpty()?null:h)).filter(h=>!!h),d.length&&this._state.change({searchScope:d},!0)}}else this._state.change({searchScope:null},!0)})),s.appendChild(this._toggleSelectionFind.domNode),this._closeBtn=this._register(new Tp({label:_0e+this._keybindingLabelFor(Vt.CloseFindWidgetCommand),icon:LK,hoverDelegate:i,onTrigger:()=>{this._state.change({isRevealed:!1,searchScope:null},!1)},onKeyDown:d=>{d.equals(2)&&this._isReplaceVisible&&(this._replaceBtn.isEnabled()?this._replaceBtn.focus():this._codeEditor.focus(),d.preventDefault())}},this._hoverService)),this._replaceInput=this._register(new x2(null,void 0,{label:b0e,placeholder:v0e,appendPreserveCaseLabel:this._keybindingLabelFor(Vt.TogglePreserveCaseCommand),history:[],flexibleHeight:!0,flexibleWidth:!0,flexibleMaxHeight:118,showHistoryHint:()=>N8(this._keybindingService),inputBoxStyles:gx,toggleStyles:ux},this._contextKeyService,!0)),this._replaceInput.setPreserveCase(!!this._state.preserveCase),this._register(this._replaceInput.onKeyDown(d=>this._onReplaceInputKeyDown(d))),this._register(this._replaceInput.inputBox.onDidChange(()=>{this._state.change({replaceString:this._replaceInput.inputBox.value},!1)})),this._register(this._replaceInput.inputBox.onDidHeightChange(d=>{this._isReplaceVisible&&this._tryUpdateHeight()&&this._showViewZone()})),this._register(this._replaceInput.onDidOptionChange(()=>{this._state.change({preserveCase:this._replaceInput.getPreserveCase()},!0)})),this._register(this._replaceInput.onPreserveCaseKeyDown(d=>{d.equals(2)&&(this._prevBtn.isEnabled()?this._prevBtn.focus():this._nextBtn.isEnabled()?this._nextBtn.focus():this._toggleSelectionFind.enabled?this._toggleSelectionFind.focus():this._closeBtn.isEnabled()&&this._closeBtn.focus(),d.preventDefault())}));const r=this._register(D_());this._replaceBtn=this._register(new Tp({label:C0e+this._keybindingLabelFor(Vt.ReplaceOneAction),icon:a0e,hoverDelegate:r,onTrigger:()=>{this._controller.replace()},onKeyDown:d=>{d.equals(1026)&&(this._closeBtn.focus(),d.preventDefault())}},this._hoverService)),this._replaceAllBtn=this._register(new Tp({label:y0e+this._keybindingLabelFor(Vt.ReplaceAllAction),icon:l0e,hoverDelegate:r,onTrigger:()=>{this._controller.replaceAll()}},this._hoverService));const a=document.createElement("div");a.className="replace-part",a.appendChild(this._replaceInput.domNode);const l=document.createElement("div");l.className="replace-actions",a.appendChild(l),l.appendChild(this._replaceBtn.domNode),l.appendChild(this._replaceAllBtn.domNode),this._toggleReplaceBtn=this._register(new Tp({label:w0e,className:"codicon toggle left",onTrigger:()=>{this._state.change({isReplaceRevealed:!this._isReplaceVisible},!1),this._isReplaceVisible&&(this._replaceInput.width=Ks(this._findInput.domNode),this._replaceInput.inputBox.layout()),this._showViewZone()}},this._hoverService)),this._toggleReplaceBtn.setExpanded(this._isReplaceVisible),this._domNode=document.createElement("div"),this._domNode.className="editor-widget find-widget",this._domNode.setAttribute("aria-hidden","true"),this._domNode.ariaLabel=h0e,this._domNode.role="dialog",this._domNode.style.width=`${Za}px`,this._domNode.appendChild(this._toggleReplaceBtn.domNode),this._domNode.appendChild(n),this._domNode.appendChild(this._closeBtn.domNode),this._domNode.appendChild(a),this._resizeSash=this._register(new Nn(this._domNode,this,{orientation:0,size:2})),this._resized=!1;let c=Za;this._register(this._resizeSash.onDidStart(()=>{c=Ks(this._domNode)})),this._register(this._resizeSash.onDidChange(d=>{this._resized=!0;const h=c+d.startX-d.currentX;if(h<Za)return;const u=parseFloat(aT(this._domNode).maxWidth)||0;h>u||(this._domNode.style.width=`${h}px`,this._isReplaceVisible&&(this._replaceInput.width=Ks(this._findInput.domNode)),this._findInput.inputBox.layout(),this._tryUpdateHeight())})),this._register(this._resizeSash.onDidReset(()=>{const d=Ks(this._domNode);if(d<Za)return;let h=Za;if(!this._resized||d===Za){const u=this._codeEditor.getLayoutInfo();h=u.width-28-u.minimap.minimapWidth-15,this._resized=!0}this._domNode.style.width=`${h}px`,this._isReplaceVisible&&(this._replaceInput.width=Ks(this._findInput.domNode)),this._findInput.inputBox.layout()}))}updateAccessibilitySupport(){const e=this._codeEditor.getOption(2);this._findInput.setFocusInputOnOptionClick(e!==2)}};_E.ID="editor.contrib.findWidget";let L2=_E;class Tp extends Go{constructor(e,t){super(),this._opts=e;let i="button";this._opts.className&&(i=i+" "+this._opts.className),this._opts.icon&&(i=i+" "+ke.asClassName(this._opts.icon)),this._domNode=document.createElement("div"),this._domNode.tabIndex=0,this._domNode.className=i,this._domNode.setAttribute("role","button"),this._domNode.setAttribute("aria-label",this._opts.label),this._register(t.setupManagedHover(e.hoverDelegate??bs("element"),this._domNode,this._opts.label)),this.onclick(this._domNode,n=>{this._opts.onTrigger(),n.preventDefault()}),this.onkeydown(this._domNode,n=>{if(n.equals(10)||n.equals(3)){this._opts.onTrigger(),n.preventDefault();return}this._opts.onKeyDown?.(n)})}get domNode(){return this._domNode}isEnabled(){return this._domNode.tabIndex>=0}focus(){this._domNode.focus()}setEnabled(e){this._domNode.classList.toggle("disabled",!e),this._domNode.setAttribute("aria-disabled",String(!e)),this._domNode.tabIndex=e?0:-1}setExpanded(e){this._domNode.setAttribute("aria-expanded",String(!!e)),e?(this._domNode.classList.remove(...ke.asClassNameArray(R8)),this._domNode.classList.add(...ke.asClassNameArray(P8))):(this._domNode.classList.remove(...ke.asClassNameArray(P8)),this._domNode.classList.add(...ke.asClassNameArray(R8)))}}br((o,e)=>{const t=o.getColor(Ud);t&&e.addRule(`.monaco-editor .findMatch { border: 1px ${xa(o.type)?"dotted":"solid"} ${t}; box-sizing: border-box; }`);const i=o.getColor(Jne);i&&e.addRule(`.monaco-editor .findScope { border: 1px ${xa(o.type)?"dashed":"solid"} ${i}; }`);const n=o.getColor(rt);n&&e.addRule(`.monaco-editor .find-widget { border: 1px solid ${n}; }`);const s=o.getColor(Xne);s&&e.addRule(`.monaco-editor .findMatchInline { color: ${s}; }`);const r=o.getColor(Qne);r&&e.addRule(`.monaco-editor .currentFindMatchInline { color: ${r}; }`)});var fZ=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Jo=function(o,e){return function(t,i){e(t,i,o)}},k2;const T0e=524288;function E2(o,e="single",t=!1){if(!o.hasModel())return null;const i=o.getSelection();if(e==="single"&&i.startLineNumber===i.endLineNumber||e==="multiple"){if(i.isEmpty()){const n=o.getConfiguredWordAtPosition(i.getStartPosition());if(n&&t===!1)return n.word}else if(o.getModel().getValueLengthInRange(i)<T0e)return o.getModel().getValueInRange(i)}return null}var Gg;let As=(Gg=class extends F{get editor(){return this._editor}static get(e){return e.getContribution(k2.ID)}constructor(e,t,i,n,s,r){super(),this._editor=e,this._findWidgetVisible=ld.bindTo(t),this._contextKeyService=t,this._storageService=i,this._clipboardService=n,this._notificationService=s,this._hoverService=r,this._updateHistoryDelayer=new hr(500),this._state=this._register(new t0e),this.loadQueryState(),this._register(this._state.onFindReplaceStateChange(a=>this._onStateChanged(a))),this._model=null,this._register(this._editor.onDidChangeModel(()=>{const a=this._editor.getModel()&&this._state.isRevealed;this.disposeModel(),this._state.change({searchScope:null,matchCase:this._storageService.getBoolean("editor.matchCase",1,!1),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,!1),isRegex:this._storageService.getBoolean("editor.isRegex",1,!1),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,!1)},!1),a&&this._start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!1,updateSearchScope:!1,loop:this._editor.getOption(41).loop})}))}dispose(){this.disposeModel(),super.dispose()}disposeModel(){this._model&&(this._model.dispose(),this._model=null)}_onStateChanged(e){this.saveQueryState(e),e.isRevealed&&(this._state.isRevealed?this._findWidgetVisible.set(!0):(this._findWidgetVisible.reset(),this.disposeModel())),e.searchString&&this.setGlobalBufferTerm(this._state.searchString)}saveQueryState(e){e.isRegex&&this._storageService.store("editor.isRegex",this._state.actualIsRegex,1,1),e.wholeWord&&this._storageService.store("editor.wholeWord",this._state.actualWholeWord,1,1),e.matchCase&&this._storageService.store("editor.matchCase",this._state.actualMatchCase,1,1),e.preserveCase&&this._storageService.store("editor.preserveCase",this._state.actualPreserveCase,1,1)}loadQueryState(){this._state.change({matchCase:this._storageService.getBoolean("editor.matchCase",1,this._state.matchCase),wholeWord:this._storageService.getBoolean("editor.wholeWord",1,this._state.wholeWord),isRegex:this._storageService.getBoolean("editor.isRegex",1,this._state.isRegex),preserveCase:this._storageService.getBoolean("editor.preserveCase",1,this._state.preserveCase)},!1)}isFindInputFocused(){return!!LD.getValue(this._contextKeyService)}getState(){return this._state}closeFindWidget(){this._state.change({isRevealed:!1,searchScope:null},!1),this._editor.focus()}toggleCaseSensitive(){this._state.change({matchCase:!this._state.matchCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleWholeWords(){this._state.change({wholeWord:!this._state.wholeWord},!1),this._state.isRevealed||this.highlightFindOptions()}toggleRegex(){this._state.change({isRegex:!this._state.isRegex},!1),this._state.isRevealed||this.highlightFindOptions()}togglePreserveCase(){this._state.change({preserveCase:!this._state.preserveCase},!1),this._state.isRevealed||this.highlightFindOptions()}toggleSearchScope(){if(this._state.searchScope)this._state.change({searchScope:null},!0);else if(this._editor.hasModel()){let e=this._editor.getSelections();e=e.map(t=>(t.endColumn===1&&t.endLineNumber>t.startLineNumber&&(t=t.setEndPosition(t.endLineNumber-1,this._editor.getModel().getLineMaxColumn(t.endLineNumber-1))),t.isEmpty()?null:t)).filter(t=>!!t),e.length&&this._state.change({searchScope:e},!0)}}setSearchString(e){this._state.isRegex&&(e=Fo(e)),this._state.change({searchString:e},!1)}highlightFindOptions(e=!1){}async _start(e,t){if(this.disposeModel(),!this._editor.hasModel())return;const i={...t,isRevealed:!0};if(e.seedSearchStringFromSelection==="single"){const n=E2(this._editor,e.seedSearchStringFromSelection,e.seedSearchStringFromNonEmptySelection);n&&(this._state.isRegex?i.searchString=Fo(n):i.searchString=n)}else if(e.seedSearchStringFromSelection==="multiple"&&!e.updateSearchScope){const n=E2(this._editor,e.seedSearchStringFromSelection);n&&(i.searchString=n)}if(!i.searchString&&e.seedSearchStringFromGlobalClipboard){const n=await this.getGlobalBufferTerm();if(!this._editor.hasModel())return;n&&(i.searchString=n)}if(e.forceRevealReplace||i.isReplaceRevealed?i.isReplaceRevealed=!0:this._findWidgetVisible.get()||(i.isReplaceRevealed=!1),e.updateSearchScope){const n=this._editor.getSelections();n.some(s=>!s.isEmpty())&&(i.searchScope=n)}i.loop=e.loop,this._state.change(i,!1),this._model||(this._model=new dC(this._editor,this._state))}start(e,t){return this._start(e,t)}moveToNextMatch(){return this._model?(this._model.moveToNextMatch(),!0):!1}moveToPrevMatch(){return this._model?(this._model.moveToPrevMatch(),!0):!1}goToMatch(e){return this._model?(this._model.moveToMatch(e),!0):!1}replace(){return this._model?(this._model.replace(),!0):!1}replaceAll(){return this._model?this._editor.getModel()?.isTooLargeForHeapOperation()?(this._notificationService.warn(p("too.large.for.replaceall","The file is too large to perform a replace all operation.")),!1):(this._model.replaceAll(),!0):!1}selectAllMatches(){return this._model?(this._model.selectAllMatches(),this._editor.focus(),!0):!1}async getGlobalBufferTerm(){return this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()?this._clipboardService.readFindText():""}setGlobalBufferTerm(e){this._editor.getOption(41).globalFindClipboard&&this._editor.hasModel()&&!this._editor.getModel().isTooLargeForSyncing()&&this._clipboardService.writeFindText(e)}},k2=Gg,Gg.ID="editor.contrib.findController",Gg);As=k2=fZ([Jo(1,Ee),Jo(2,Yr),Jo(3,ad),Jo(4,Ei),Jo(5,zl)],As);let T2=class extends As{constructor(e,t,i,n,s,r,a,l,c){super(e,i,a,l,r,c),this._contextViewService=t,this._keybindingService=n,this._themeService=s,this._widget=null,this._findOptionsWidget=null}async _start(e,t){this._widget||this._createFindWidget();const i=this._editor.getSelection();let n=!1;switch(this._editor.getOption(41).autoFindInSelection){case"always":n=!0;break;case"never":n=!1;break;case"multiline":{n=!!i&&i.startLineNumber!==i.endLineNumber;break}}e.updateSearchScope=e.updateSearchScope||n,await super._start(e,t),this._widget&&(e.shouldFocus===2?this._widget.focusReplaceInput():e.shouldFocus===1&&this._widget.focusFindInput())}highlightFindOptions(e=!1){this._widget||this._createFindWidget(),this._state.isRevealed&&!e?this._widget.highlightFindOptions():this._findOptionsWidget.highlightFindOptions()}_createFindWidget(){this._widget=this._register(new L2(this._editor,this,this._state,this._contextViewService,this._keybindingService,this._contextKeyService,this._themeService,this._storageService,this._notificationService,this._hoverService)),this._findOptionsWidget=this._register(new w2(this._editor,this._state,this._keybindingService))}};T2=fZ([Jo(1,sd),Jo(2,Ee),Jo(3,vt),Jo(4,zi),Jo(5,Ei),Jo(6,Yr),Jo(7,ad),Jo(8,zl)],T2);const D0e=hU(new dU({id:Vt.StartFindAction,label:p("startFindAction","Find"),alias:"Find",precondition:K.or(T.focus,K.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2084,weight:100},menuOpts:{menuId:fe.MenubarEditMenu,group:"3_find",title:p({key:"miFind",comment:["&& denotes a mnemonic"]},"&&Find"),order:1}}));D0e.addImplementation(0,(o,e,t)=>{const i=As.get(e);return i?i.start({forceRevealReplace:!1,seedSearchStringFromSelection:e.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).globalFindClipboard,shouldFocus:1,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop}):!1});const I0e={description:"Open a new In-Editor Find Widget.",args:[{name:"Open a new In-Editor Find Widget args",schema:{properties:{searchString:{type:"string"},replaceString:{type:"string"},isRegex:{type:"boolean"},matchWholeWord:{type:"boolean"},isCaseSensitive:{type:"boolean"},preserveCase:{type:"boolean"},findInSelection:{type:"boolean"}}}}]};class N0e extends de{constructor(){super({id:Vt.StartFindWithArgs,label:p("startFindWithArgsAction","Find With Arguments"),alias:"Find With Arguments",precondition:void 0,kbOpts:{kbExpr:null,primary:0,weight:100},metadata:I0e})}async run(e,t,i){const n=As.get(t);if(n){const s=i?{searchString:i.searchString,replaceString:i.replaceString,isReplaceRevealed:i.replaceString!==void 0,isRegex:i.isRegex,wholeWord:i.matchWholeWord,matchCase:i.isCaseSensitive,preserveCase:i.preserveCase}:{};await n.start({forceRevealReplace:!1,seedSearchStringFromSelection:n.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:1,shouldAnimate:!0,updateSearchScope:i?.findInSelection||!1,loop:t.getOption(41).loop},s),n.setGlobalBufferTerm(n.getState().searchString)}}}class R0e extends de{constructor(){super({id:Vt.StartFindWithSelection,label:p("startFindWithSelectionAction","Find With Selection"),alias:"Find With Selection",precondition:void 0,kbOpts:{kbExpr:null,primary:0,mac:{primary:2083},weight:100}})}async run(e,t){const i=As.get(t);i&&(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"multiple",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),i.setGlobalBufferTerm(i.getState().searchString))}}class pZ extends de{async run(e,t){const i=As.get(t);i&&!this._run(i)&&(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:i.getState().searchString.length===0&&t.getOption(41).seedSearchStringFromSelection!=="never"?"single":"none",seedSearchStringFromNonEmptySelection:t.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:!0,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))}}class P0e extends pZ{constructor(){super({id:Vt.NextMatchFindAction,label:p("findNextMatchAction","Find Next"),alias:"Find Next",precondition:void 0,kbOpts:[{kbExpr:T.focus,primary:61,mac:{primary:2085,secondary:[61]},weight:100},{kbExpr:K.and(T.focus,LD),primary:3,weight:100}]})}_run(e){return e.moveToNextMatch()?(e.editor.pushUndoStop(),!0):!1}}class A0e extends pZ{constructor(){super({id:Vt.PreviousMatchFindAction,label:p("findPreviousMatchAction","Find Previous"),alias:"Find Previous",precondition:void 0,kbOpts:[{kbExpr:T.focus,primary:1085,mac:{primary:3109,secondary:[1085]},weight:100},{kbExpr:K.and(T.focus,LD),primary:1027,weight:100}]})}_run(e){return e.moveToPrevMatch()}}class M0e extends de{constructor(){super({id:Vt.GoToMatchFindAction,label:p("findMatchAction.goToMatch","Go to Match..."),alias:"Go to Match...",precondition:ld}),this._highlightDecorations=[]}run(e,t,i){const n=As.get(t);if(!n)return;const s=n.getState().matchesCount;if(s<1){e.get(Ei).notify({severity:ST.Warning,message:p("findMatchAction.noResults","No matches. Try searching for something else.")});return}const r=e.get(vr),a=new $,l=a.add(r.createInputBox());l.placeholder=p("findMatchAction.inputPlaceHolder","Type a number to go to a specific match (between 1 and {0})",s);const c=h=>{const u=parseInt(h);if(isNaN(u))return;const g=n.getState().matchesCount;if(u>0&&u<=g)return u-1;if(u<0&&u>=-g)return g+u},d=h=>{const u=c(h);if(typeof u=="number"){l.validationMessage=void 0,n.goToMatch(u);const g=n.getState().currentMatch;g&&this.addDecorations(t,g)}else l.validationMessage=p("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount),this.clearDecorations(t)};a.add(l.onDidChangeValue(h=>{d(h)})),a.add(l.onDidAccept(()=>{const h=c(l.value);typeof h=="number"?(n.goToMatch(h),l.hide()):l.validationMessage=p("findMatchAction.inputValidationMessage","Please type a number between 1 and {0}",n.getState().matchesCount)})),a.add(l.onDidHide(()=>{this.clearDecorations(t),a.dispose()})),l.show()}clearDecorations(e){e.changeDecorations(t=>{this._highlightDecorations=t.deltaDecorations(this._highlightDecorations,[])})}addDecorations(e,t){e.changeDecorations(i=>{this._highlightDecorations=i.deltaDecorations(this._highlightDecorations,[{range:t,options:{description:"find-match-quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"find-match-quick-access-range-highlight-overview",overviewRuler:{color:fi(u$),position:Ao.Full}}}])})}}class mZ extends de{async run(e,t){const i=As.get(t);if(!i)return;const n=E2(t,"single",!1);n&&i.setSearchString(n),this._run(i)||(await i.start({forceRevealReplace:!1,seedSearchStringFromSelection:"none",seedSearchStringFromNonEmptySelection:!1,seedSearchStringFromGlobalClipboard:!1,shouldFocus:0,shouldAnimate:!0,updateSearchScope:!1,loop:t.getOption(41).loop}),this._run(i))}}class O0e extends mZ{constructor(){super({id:Vt.NextSelectionMatchFindAction,label:p("nextSelectionMatchFindAction","Find Next Selection"),alias:"Find Next Selection",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:2109,weight:100}})}_run(e){return e.moveToNextMatch()}}class F0e extends mZ{constructor(){super({id:Vt.PreviousSelectionMatchFindAction,label:p("previousSelectionMatchFindAction","Find Previous Selection"),alias:"Find Previous Selection",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:3133,weight:100}})}_run(e){return e.moveToPrevMatch()}}const B0e=hU(new dU({id:Vt.StartFindReplaceAction,label:p("startReplace","Replace"),alias:"Replace",precondition:K.or(T.focus,K.has("editorIsOpen")),kbOpts:{kbExpr:null,primary:2086,mac:{primary:2596},weight:100},menuOpts:{menuId:fe.MenubarEditMenu,group:"3_find",title:p({key:"miReplace",comment:["&& denotes a mnemonic"]},"&&Replace"),order:2}}));B0e.addImplementation(0,(o,e,t)=>{if(!e.hasModel()||e.getOption(92))return!1;const i=As.get(e);if(!i)return!1;const n=e.getSelection(),s=i.isFindInputFocused(),r=!n.isEmpty()&&n.startLineNumber===n.endLineNumber&&e.getOption(41).seedSearchStringFromSelection!=="never"&&!s,a=s||r?2:1;return i.start({forceRevealReplace:!0,seedSearchStringFromSelection:r?"single":"none",seedSearchStringFromNonEmptySelection:e.getOption(41).seedSearchStringFromSelection==="selection",seedSearchStringFromGlobalClipboard:e.getOption(41).seedSearchStringFromSelection!=="never",shouldFocus:a,shouldAnimate:!0,updateSearchScope:!1,loop:e.getOption(41).loop})});at(As.ID,T2,0);X(N0e);X(R0e);X(P0e);X(A0e);X(M0e);X(O0e);X(F0e);const Va=Hi.bindToContribution(As.get);oe(new Va({id:Vt.CloseFindWidgetCommand,precondition:ld,handler:o=>o.closeFindWidget(),kbOpts:{weight:105,kbExpr:K.and(T.focus,K.not("isComposing")),primary:9,secondary:[1033]}}));oe(new Va({id:Vt.ToggleCaseSensitiveCommand,precondition:void 0,handler:o=>o.toggleCaseSensitive(),kbOpts:{weight:105,kbExpr:T.focus,primary:a1.primary,mac:a1.mac,win:a1.win,linux:a1.linux}}));oe(new Va({id:Vt.ToggleWholeWordCommand,precondition:void 0,handler:o=>o.toggleWholeWords(),kbOpts:{weight:105,kbExpr:T.focus,primary:l1.primary,mac:l1.mac,win:l1.win,linux:l1.linux}}));oe(new Va({id:Vt.ToggleRegexCommand,precondition:void 0,handler:o=>o.toggleRegex(),kbOpts:{weight:105,kbExpr:T.focus,primary:c1.primary,mac:c1.mac,win:c1.win,linux:c1.linux}}));oe(new Va({id:Vt.ToggleSearchScopeCommand,precondition:void 0,handler:o=>o.toggleSearchScope(),kbOpts:{weight:105,kbExpr:T.focus,primary:d1.primary,mac:d1.mac,win:d1.win,linux:d1.linux}}));oe(new Va({id:Vt.TogglePreserveCaseCommand,precondition:void 0,handler:o=>o.togglePreserveCase(),kbOpts:{weight:105,kbExpr:T.focus,primary:h1.primary,mac:h1.mac,win:h1.win,linux:h1.linux}}));oe(new Va({id:Vt.ReplaceOneAction,precondition:ld,handler:o=>o.replace(),kbOpts:{weight:105,kbExpr:T.focus,primary:3094}}));oe(new Va({id:Vt.ReplaceOneAction,precondition:ld,handler:o=>o.replace(),kbOpts:{weight:105,kbExpr:K.and(T.focus,DW),primary:3}}));oe(new Va({id:Vt.ReplaceAllAction,precondition:ld,handler:o=>o.replaceAll(),kbOpts:{weight:105,kbExpr:T.focus,primary:2563}}));oe(new Va({id:Vt.ReplaceAllAction,precondition:ld,handler:o=>o.replaceAll(),kbOpts:{weight:105,kbExpr:K.and(T.focus,DW),primary:void 0,mac:{primary:2051}}}));oe(new Va({id:Vt.SelectAllMatchesAction,precondition:ld,handler:o=>o.selectAllMatches(),kbOpts:{weight:105,kbExpr:T.focus,primary:515}}));const W0e={0:" ",1:"u",2:"r"},W8=65535,ha=16777215,V8=4278190080;class SN{constructor(e){const t=Math.ceil(e/32);this._states=new Uint32Array(t)}get(e){const t=e/32|0,i=e%32;return(this._states[t]&1<<i)!==0}set(e,t){const i=e/32|0,n=e%32,s=this._states[i];t?this._states[i]=s|1<<n:this._states[i]=s&~(1<<n)}}class Lo{constructor(e,t,i){if(e.length!==t.length||e.length>W8)throw new Error("invalid startIndexes or endIndexes size");this._startIndexes=e,this._endIndexes=t,this._collapseStates=new SN(e.length),this._userDefinedStates=new SN(e.length),this._recoveredStates=new SN(e.length),this._types=i,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;const e=[],t=(i,n)=>{const s=e[e.length-1];return this.getStartLineNumber(s)<=i&&this.getEndLineNumber(s)>=n};for(let i=0,n=this._startIndexes.length;i<n;i++){const s=this._startIndexes[i],r=this._endIndexes[i];if(s>ha||r>ha)throw new Error("startLineNumber or endLineNumber must not exceed "+ha);for(;e.length>0&&!t(s,r);)e.pop();const a=e.length>0?e[e.length-1]:-1;e.push(i),this._startIndexes[i]=s+((a&255)<<24),this._endIndexes[i]=r+((a&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&ha}getEndLineNumber(e){return this._endIndexes[e]&ha}getType(e){return this._types?this._types[e]:void 0}hasTypes(){return!!this._types}isCollapsed(e){return this._collapseStates.get(e)}setCollapsed(e,t){this._collapseStates.set(e,t)}isUserDefined(e){return this._userDefinedStates.get(e)}setUserDefined(e,t){return this._userDefinedStates.set(e,t)}isRecovered(e){return this._recoveredStates.get(e)}setRecovered(e,t){return this._recoveredStates.set(e,t)}getSource(e){return this.isUserDefined(e)?1:this.isRecovered(e)?2:0}setSource(e,t){t===1?(this.setUserDefined(e,!0),this.setRecovered(e,!1)):t===2?(this.setUserDefined(e,!1),this.setRecovered(e,!0)):(this.setUserDefined(e,!1),this.setRecovered(e,!1))}setCollapsedAllOfType(e,t){let i=!1;if(this._types)for(let n=0;n<this._types.length;n++)this._types[n]===e&&(this.setCollapsed(n,t),i=!0);return i}toRegion(e){return new V0e(this,e)}getParentIndex(e){this.ensureParentIndices();const t=((this._startIndexes[e]&V8)>>>24)+((this._endIndexes[e]&V8)>>>16);return t===W8?-1:t}contains(e,t){return this.getStartLineNumber(e)<=t&&this.getEndLineNumber(e)>=t}findIndex(e){let t=0,i=this._startIndexes.length;if(i===0)return-1;for(;t<i;){const n=Math.floor((t+i)/2);e<this.getStartLineNumber(n)?i=n:t=n+1}return t-1}findRange(e){let t=this.findIndex(e);if(t>=0){if(this.getEndLineNumber(t)>=e)return t;for(t=this.getParentIndex(t);t!==-1;){if(this.contains(t,e))return t;t=this.getParentIndex(t)}}return-1}toString(){const e=[];for(let t=0;t<this.length;t++)e[t]=`[${W0e[this.getSource(t)]}${this.isCollapsed(t)?"+":"-"}] ${this.getStartLineNumber(t)}/${this.getEndLineNumber(t)}`;return e.join(", ")}toFoldRange(e){return{startLineNumber:this._startIndexes[e]&ha,endLineNumber:this._endIndexes[e]&ha,type:this._types?this._types[e]:void 0,isCollapsed:this.isCollapsed(e),source:this.getSource(e)}}static fromFoldRanges(e){const t=e.length,i=new Uint32Array(t),n=new Uint32Array(t);let s=[],r=!1;for(let l=0;l<t;l++){const c=e[l];i[l]=c.startLineNumber,n[l]=c.endLineNumber,s.push(c.type),c.type&&(r=!0)}r||(s=void 0);const a=new Lo(i,n,s);for(let l=0;l<t;l++)e[l].isCollapsed&&a.setCollapsed(l,!0),a.setSource(l,e[l].source);return a}static sanitizeAndMerge(e,t,i,n){i=i??Number.MAX_VALUE;const s=(_,b)=>Array.isArray(_)?v=>v<b?_[v]:void 0:v=>v<b?_.toFoldRange(v):void 0,r=s(e,e.length),a=s(t,t.length);let l=0,c=0,d=r(0),h=a(0);const u=[];let g,f=0;const m=[];for(;d||h;){let _;if(h&&(!d||d.startLineNumber>=h.startLineNumber))d&&d.startLineNumber===h.startLineNumber?(h.source===1?_=h:(_=d,_.isCollapsed=h.isCollapsed&&(d.endLineNumber===h.endLineNumber||!n?.startsInside(d.startLineNumber+1,d.endLineNumber+1)),_.source=0),d=r(++l)):(_=h,h.isCollapsed&&h.source===0&&(_.source=2)),h=a(++c);else{let b=c,v=h;for(;;){if(!v||v.startLineNumber>d.endLineNumber){_=d;break}if(v.source===1&&v.endLineNumber>d.endLineNumber)break;v=a(++b)}d=r(++l)}if(_){for(;g&&g.endLineNumber<_.startLineNumber;)g=u.pop();_.endLineNumber>_.startLineNumber&&_.startLineNumber>f&&_.endLineNumber<=i&&(!g||g.endLineNumber>=_.endLineNumber)&&(m.push(_),f=_.startLineNumber,g&&u.push(g),g=_)}}return m}}class V0e{constructor(e,t){this.ranges=e,this.index=t}get startLineNumber(){return this.ranges.getStartLineNumber(this.index)}get endLineNumber(){return this.ranges.getEndLineNumber(this.index)}get regionIndex(){return this.index}get parentIndex(){return this.ranges.getParentIndex(this.index)}get isCollapsed(){return this.ranges.isCollapsed(this.index)}containedBy(e){return e.startLineNumber<=this.startLineNumber&&e.endLineNumber>=this.endLineNumber}containsLine(e){return this.startLineNumber<=e&&e<=this.endLineNumber}}class H0e{get regions(){return this._regions}get textModel(){return this._textModel}constructor(e,t){this._updateEventEmitter=new O,this.onDidChange=this._updateEventEmitter.event,this._textModel=e,this._decorationProvider=t,this._regions=new Lo(new Uint32Array(0),new Uint32Array(0)),this._editorDecorationIds=[]}toggleCollapseState(e){if(!e.length)return;e=e.sort((i,n)=>i.regionIndex-n.regionIndex);const t={};this._decorationProvider.changeDecorations(i=>{let n=0,s=-1,r=-1;const a=l=>{for(;n<l;){const c=this._regions.getEndLineNumber(n),d=this._regions.isCollapsed(n);if(c<=s){const h=this.regions.getSource(n)!==0;i.changeDecorationOptions(this._editorDecorationIds[n],this._decorationProvider.getDecorationOption(d,c<=r,h))}d&&c>r&&(r=c),n++}};for(const l of e){const c=l.regionIndex,d=this._editorDecorationIds[c];if(d&&!t[d]){t[d]=!0,a(c);const h=!this._regions.isCollapsed(c);this._regions.setCollapsed(c,h),s=Math.max(s,this._regions.getEndLineNumber(c))}}a(this._regions.length)}),this._updateEventEmitter.fire({model:this,collapseStateChanged:e})}removeManualRanges(e){const t=new Array,i=n=>{for(const s of e)if(!(s.startLineNumber>n.endLineNumber||n.startLineNumber>s.endLineNumber))return!0;return!1};for(let n=0;n<this._regions.length;n++){const s=this._regions.toFoldRange(n);(s.source===0||!i(s))&&t.push(s)}this.updatePost(Lo.fromFoldRanges(t))}update(e,t){const i=this._currentFoldedOrManualRanges(t),n=Lo.sanitizeAndMerge(e,i,this._textModel.getLineCount(),t);this.updatePost(Lo.fromFoldRanges(n))}updatePost(e){const t=[];let i=-1;for(let n=0,s=e.length;n<s;n++){const r=e.getStartLineNumber(n),a=e.getEndLineNumber(n),l=e.isCollapsed(n),c=e.getSource(n)!==0,d={startLineNumber:r,startColumn:this._textModel.getLineMaxColumn(r),endLineNumber:a,endColumn:this._textModel.getLineMaxColumn(a)+1};t.push({range:d,options:this._decorationProvider.getDecorationOption(l,a<=i,c)}),l&&a>i&&(i=a)}this._decorationProvider.changeDecorations(n=>this._editorDecorationIds=n.deltaDecorations(this._editorDecorationIds,t)),this._regions=e,this._updateEventEmitter.fire({model:this})}_currentFoldedOrManualRanges(e){const t=[];for(let i=0,n=this._regions.length;i<n;i++){let s=this.regions.isCollapsed(i);const r=this.regions.getSource(i);if(s||r!==0){const a=this._regions.toFoldRange(i),l=this._textModel.getDecorationRange(this._editorDecorationIds[i]);l&&(s&&e?.startsInside(l.startLineNumber+1,l.endLineNumber)&&(s=!1),t.push({startLineNumber:l.startLineNumber,endLineNumber:l.endLineNumber,type:a.type,isCollapsed:s,source:r}))}}return t}getMemento(){const e=this._currentFoldedOrManualRanges(),t=[],i=this._textModel.getLineCount();for(let n=0,s=e.length;n<s;n++){const r=e[n];if(r.startLineNumber>=r.endLineNumber||r.startLineNumber<1||r.endLineNumber>i)continue;const a=this._getLinesChecksum(r.startLineNumber+1,r.endLineNumber);t.push({startLineNumber:r.startLineNumber,endLineNumber:r.endLineNumber,isCollapsed:r.isCollapsed,source:r.source,checksum:a})}return t.length>0?t:void 0}applyMemento(e){if(!Array.isArray(e))return;const t=[],i=this._textModel.getLineCount();for(const s of e){if(s.startLineNumber>=s.endLineNumber||s.startLineNumber<1||s.endLineNumber>i)continue;const r=this._getLinesChecksum(s.startLineNumber+1,s.endLineNumber);(!s.checksum||r===s.checksum)&&t.push({startLineNumber:s.startLineNumber,endLineNumber:s.endLineNumber,type:void 0,isCollapsed:s.isCollapsed??!0,source:s.source??0})}const n=Lo.sanitizeAndMerge(this._regions,t,i);this.updatePost(Lo.fromFoldRanges(n))}_getLinesChecksum(e,t){return sT(this._textModel.getLineContent(e)+this._textModel.getLineContent(t))%1e6}dispose(){this._decorationProvider.removeDecorations(this._editorDecorationIds)}getAllRegionsAtLine(e,t){const i=[];if(this._regions){let n=this._regions.findRange(e),s=1;for(;n>=0;){const r=this._regions.toRegion(n);(!t||t(r,s))&&i.push(r),s++,n=r.parentIndex}}return i}getRegionAtLine(e){if(this._regions){const t=this._regions.findRange(e);if(t>=0)return this._regions.toRegion(t)}return null}getRegionsInside(e,t){const i=[],n=e?e.regionIndex+1:0,s=e?e.endLineNumber:Number.MAX_VALUE;if(t&&t.length===2){const r=[];for(let a=n,l=this._regions.length;a<l;a++){const c=this._regions.toRegion(a);if(this._regions.getStartLineNumber(a)<s){for(;r.length>0&&!c.containedBy(r[r.length-1]);)r.pop();r.push(c),t(c,r.length)&&i.push(c)}else break}}else for(let r=n,a=this._regions.length;r<a;r++){const l=this._regions.toRegion(r);if(this._regions.getStartLineNumber(r)<s)(!t||t(l))&&i.push(l);else break}return i}}function RW(o,e,t){const i=[];for(const n of t){const s=o.getRegionAtLine(n);if(s){const r=!s.isCollapsed;if(i.push(s),e>1){const a=o.getRegionsInside(s,(l,c)=>l.isCollapsed!==r&&c<e);i.push(...a)}}}o.toggleCollapseState(i)}function Lb(o,e,t=Number.MAX_VALUE,i){const n=[];if(i&&i.length>0)for(const s of i){const r=o.getRegionAtLine(s);if(r&&(r.isCollapsed!==e&&n.push(r),t>1)){const a=o.getRegionsInside(r,(l,c)=>l.isCollapsed!==e&&c<t);n.push(...a)}}else{const s=o.getRegionsInside(null,(r,a)=>r.isCollapsed!==e&&a<t);n.push(...s)}o.toggleCollapseState(n)}function _Z(o,e,t,i){const n=[];for(const s of i){const r=o.getAllRegionsAtLine(s,(a,l)=>a.isCollapsed!==e&&l<=t);n.push(...r)}o.toggleCollapseState(n)}function z0e(o,e,t){const i=[];for(const n of t){const s=o.getAllRegionsAtLine(n,r=>r.isCollapsed!==e);s.length>0&&i.push(s[0])}o.toggleCollapseState(i)}function U0e(o,e,t,i){const n=(r,a)=>a===e&&r.isCollapsed!==t&&!i.some(l=>r.containsLine(l)),s=o.getRegionsInside(null,n);o.toggleCollapseState(s)}function bZ(o,e,t){const i=[];for(const r of t){const a=o.getAllRegionsAtLine(r,void 0);a.length>0&&i.push(a[0])}const n=r=>i.every(a=>!a.containedBy(r)&&!r.containedBy(a))&&r.isCollapsed!==e,s=o.getRegionsInside(null,n);o.toggleCollapseState(s)}function PW(o,e,t){const i=o.textModel,n=o.regions,s=[];for(let r=n.length-1;r>=0;r--)if(t!==n.isCollapsed(r)){const a=n.getStartLineNumber(r);e.test(i.getLineContent(a))&&s.push(n.toRegion(r))}o.toggleCollapseState(s)}function AW(o,e,t){const i=o.regions,n=[];for(let s=i.length-1;s>=0;s--)t!==i.isCollapsed(s)&&e===i.getType(s)&&n.push(i.toRegion(s));o.toggleCollapseState(n)}function G0e(o,e){let t=null;const i=e.getRegionAtLine(o);if(i!==null&&(t=i.startLineNumber,o===t)){const n=i.parentIndex;n!==-1?t=e.regions.getStartLineNumber(n):t=null}return t}function $0e(o,e){let t=e.getRegionAtLine(o);if(t!==null&&t.startLineNumber===o){if(o!==t.startLineNumber)return t.startLineNumber;{const i=t.parentIndex;let n=0;for(i!==-1&&(n=e.regions.getStartLineNumber(t.parentIndex));t!==null;)if(t.regionIndex>0){if(t=e.regions.toRegion(t.regionIndex-1),t.startLineNumber<=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}}else if(e.regions.length>0)for(t=e.regions.toRegion(e.regions.length-1);t!==null;){if(t.startLineNumber<o)return t.startLineNumber;t.regionIndex>0?t=e.regions.toRegion(t.regionIndex-1):t=null}return null}function K0e(o,e){let t=e.getRegionAtLine(o);if(t!==null&&t.startLineNumber===o){const i=t.parentIndex;let n=0;if(i!==-1)n=e.regions.getEndLineNumber(t.parentIndex);else{if(e.regions.length===0)return null;n=e.regions.getEndLineNumber(e.regions.length-1)}for(;t!==null;)if(t.regionIndex<e.regions.length){if(t=e.regions.toRegion(t.regionIndex+1),t.startLineNumber>=n)return null;if(t.parentIndex===i)return t.startLineNumber}else return null}else if(e.regions.length>0)for(t=e.regions.toRegion(0);t!==null;){if(t.startLineNumber>o)return t.startLineNumber;t.regionIndex<e.regions.length?t=e.regions.toRegion(t.regionIndex+1):t=null}return null}class j0e{get onDidChange(){return this._updateEventEmitter.event}get hiddenRanges(){return this._hiddenRanges}constructor(e){this._updateEventEmitter=new O,this._hasLineChanges=!1,this._foldingModel=e,this._foldingModelListener=e.onDidChange(t=>this.updateHiddenRanges()),this._hiddenRanges=[],e.regions.length&&this.updateHiddenRanges()}notifyChangeModelContent(e){this._hiddenRanges.length&&!this._hasLineChanges&&(this._hasLineChanges=e.changes.some(t=>t.range.endLineNumber!==t.range.startLineNumber||Mh(t.text)[0]!==0))}updateHiddenRanges(){let e=!1;const t=[];let i=0,n=0,s=Number.MAX_VALUE,r=-1;const a=this._foldingModel.regions;for(;i<a.length;i++){if(!a.isCollapsed(i))continue;const l=a.getStartLineNumber(i)+1,c=a.getEndLineNumber(i);s<=l&&c<=r||(!e&&n<this._hiddenRanges.length&&this._hiddenRanges[n].startLineNumber===l&&this._hiddenRanges[n].endLineNumber===c?(t.push(this._hiddenRanges[n]),n++):(e=!0,t.push(new L(l,1,c,1))),s=l,r=c)}(this._hasLineChanges||e||n<this._hiddenRanges.length)&&this.applyHiddenRanges(t)}applyHiddenRanges(e){this._hiddenRanges=e,this._hasLineChanges=!1,this._updateEventEmitter.fire(e)}hasRanges(){return this._hiddenRanges.length>0}isHidden(e){return H8(this._hiddenRanges,e)!==null}adjustSelections(e){let t=!1;const i=this._foldingModel.textModel;let n=null;const s=r=>((!n||!q0e(r,n))&&(n=H8(this._hiddenRanges,r)),n?n.startLineNumber-1:null);for(let r=0,a=e.length;r<a;r++){let l=e[r];const c=s(l.startLineNumber);c&&(l=l.setStartPosition(c,i.getLineMaxColumn(c)),t=!0);const d=s(l.endLineNumber);d&&(l=l.setEndPosition(d,i.getLineMaxColumn(d)),t=!0),e[r]=l}return t}dispose(){this.hiddenRanges.length>0&&(this._hiddenRanges=[],this._updateEventEmitter.fire(this._hiddenRanges)),this._foldingModelListener&&(this._foldingModelListener.dispose(),this._foldingModelListener=null)}}function q0e(o,e){return o>=e.startLineNumber&&o<=e.endLineNumber}function H8(o,e){const t=ty(o,i=>e<i.startLineNumber)-1;return t>=0&&o[t].endLineNumber>=e?o[t]:null}const Z0e=5e3,Y0e="indent";class MW{constructor(e,t,i){this.editorModel=e,this.languageConfigurationService=t,this.foldingRangesLimit=i,this.id=Y0e}dispose(){}compute(e){const t=this.languageConfigurationService.getLanguageConfiguration(this.editorModel.getLanguageId()).foldingRules,i=t&&!!t.offSide,n=t&&t.markers;return Promise.resolve(J0e(this.editorModel,i,n,this.foldingRangesLimit))}}let X0e=class{constructor(e){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0,this._foldingRangesLimit=e}insertFirst(e,t,i){if(e>ha||t>ha)return;const n=this._length;this._startIndexes[n]=e,this._endIndexes[n]=t,this._length++,i<1e3&&(this._indentOccurrences[i]=(this._indentOccurrences[i]||0)+1)}toIndentRanges(e){const t=this._foldingRangesLimit.limit;if(this._length<=t){this._foldingRangesLimit.update(this._length,!1);const i=new Uint32Array(this._length),n=new Uint32Array(this._length);for(let s=this._length-1,r=0;s>=0;s--,r++)i[r]=this._startIndexes[s],n[r]=this._endIndexes[s];return new Lo(i,n)}else{this._foldingRangesLimit.update(this._length,t);let i=0,n=this._indentOccurrences.length;for(let l=0;l<this._indentOccurrences.length;l++){const c=this._indentOccurrences[l];if(c){if(c+i>t){n=l;break}i+=c}}const s=e.getOptions().tabSize,r=new Uint32Array(t),a=new Uint32Array(t);for(let l=this._length-1,c=0;l>=0;l--){const d=this._startIndexes[l],h=e.getLineContent(d),u=jT(h,s);(u<n||u===n&&i++<t)&&(r[c]=d,a[c]=this._endIndexes[l],c++)}return new Lo(r,a)}}};const Q0e={limit:Z0e,update:()=>{}};function J0e(o,e,t,i=Q0e){const n=o.getOptions().tabSize,s=new X0e(i);let r;t&&(r=new RegExp(`(${t.start.source})|(?:${t.end.source})`));const a=[],l=o.getLineCount()+1;a.push({indent:-1,endAbove:l,line:l});for(let c=o.getLineCount();c>0;c--){const d=o.getLineContent(c),h=jT(d,n);let u=a[a.length-1];if(h===-1){e&&(u.endAbove=c);continue}let g;if(r&&(g=d.match(r)))if(g[1]){let f=a.length-1;for(;f>0&&a[f].indent!==-2;)f--;if(f>0){a.length=f+1,u=a[f],s.insertFirst(c,u.line,h),u.line=c,u.indent=h,u.endAbove=c;continue}}else{a.push({indent:-2,endAbove:c,line:c});continue}if(u.indent>h){do a.pop(),u=a[a.length-1];while(u.indent>h);const f=u.endAbove-1;f-c>=1&&s.insertFirst(c,f,h)}u.indent===h?u.endAbove=c:a.push({indent:h,endAbove:c,line:c})}return s.toIndentRanges(o)}const exe=D("editor.foldBackground",{light:Ue(zd,.3),dark:Ue(zd,.3),hcDark:null,hcLight:null},p("foldBackgroundBackground","Background color behind folded ranges. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.foldPlaceholderForeground",{light:"#808080",dark:"#808080",hcDark:null,hcLight:null},p("collapsedTextColor","Color of the collapsed text after the first line of a folded range."));D("editorGutter.foldingControlForeground",Y0,p("editorGutter.foldingControlForeground","Color of the folding control in the editor gutter."));const RL=Gt("folding-expanded",J.chevronDown,p("foldingExpandedIcon","Icon for expanded ranges in the editor glyph margin.")),PL=Gt("folding-collapsed",J.chevronRight,p("foldingCollapsedIcon","Icon for collapsed ranges in the editor glyph margin.")),z8=Gt("folding-manual-collapsed",PL,p("foldingManualCollapedIcon","Icon for manually collapsed ranges in the editor glyph margin.")),U8=Gt("folding-manual-expanded",RL,p("foldingManualExpandedIcon","Icon for manually expanded ranges in the editor glyph margin.")),xN={color:fi(exe),position:1},Dp=p("linesCollapsed","Click to expand the range."),f1=p("linesExpanded","Click to collapse the range."),Mi=class Mi{constructor(e){this.editor=e,this.showFoldingControls="mouseover",this.showFoldingHighlights=!0}getDecorationOption(e,t,i){return t?Mi.HIDDEN_RANGE_DECORATION:this.showFoldingControls==="never"?e?this.showFoldingHighlights?Mi.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION:Mi.NO_CONTROLS_COLLAPSED_RANGE_DECORATION:Mi.NO_CONTROLS_EXPANDED_RANGE_DECORATION:e?i?this.showFoldingHighlights?Mi.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:Mi.MANUALLY_COLLAPSED_VISUAL_DECORATION:this.showFoldingHighlights?Mi.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION:Mi.COLLAPSED_VISUAL_DECORATION:this.showFoldingControls==="mouseover"?i?Mi.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION:Mi.EXPANDED_AUTO_HIDE_VISUAL_DECORATION:i?Mi.MANUALLY_EXPANDED_VISUAL_DECORATION:Mi.EXPANDED_VISUAL_DECORATION}changeDecorations(e){return this.editor.changeDecorations(e)}removeDecorations(e){this.editor.removeDecorations(e)}};Mi.COLLAPSED_VISUAL_DECORATION=Fe.register({description:"folding-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:Dp,firstLineDecorationClassName:ke.asClassName(PL)}),Mi.COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=Fe.register({description:"folding-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:xN,isWholeLine:!0,linesDecorationsTooltip:Dp,firstLineDecorationClassName:ke.asClassName(PL)}),Mi.MANUALLY_COLLAPSED_VISUAL_DECORATION=Fe.register({description:"folding-manually-collapsed-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:Dp,firstLineDecorationClassName:ke.asClassName(z8)}),Mi.MANUALLY_COLLAPSED_HIGHLIGHTED_VISUAL_DECORATION=Fe.register({description:"folding-manually-collapsed-highlighted-visual-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:xN,isWholeLine:!0,linesDecorationsTooltip:Dp,firstLineDecorationClassName:ke.asClassName(z8)}),Mi.NO_CONTROLS_COLLAPSED_RANGE_DECORATION=Fe.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",isWholeLine:!0,linesDecorationsTooltip:Dp}),Mi.NO_CONTROLS_COLLAPSED_HIGHLIGHTED_RANGE_DECORATION=Fe.register({description:"folding-no-controls-range-decoration",stickiness:0,afterContentClassName:"inline-folded",className:"folded-background",minimap:xN,isWholeLine:!0,linesDecorationsTooltip:Dp}),Mi.EXPANDED_VISUAL_DECORATION=Fe.register({description:"folding-expanded-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+ke.asClassName(RL),linesDecorationsTooltip:f1}),Mi.EXPANDED_AUTO_HIDE_VISUAL_DECORATION=Fe.register({description:"folding-expanded-auto-hide-visual-decoration",stickiness:1,isWholeLine:!0,firstLineDecorationClassName:ke.asClassName(RL),linesDecorationsTooltip:f1}),Mi.MANUALLY_EXPANDED_VISUAL_DECORATION=Fe.register({description:"folding-manually-expanded-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:"alwaysShowFoldIcons "+ke.asClassName(U8),linesDecorationsTooltip:f1}),Mi.MANUALLY_EXPANDED_AUTO_HIDE_VISUAL_DECORATION=Fe.register({description:"folding-manually-expanded-auto-hide-visual-decoration",stickiness:0,isWholeLine:!0,firstLineDecorationClassName:ke.asClassName(U8),linesDecorationsTooltip:f1}),Mi.NO_CONTROLS_EXPANDED_RANGE_DECORATION=Fe.register({description:"folding-no-controls-range-decoration",stickiness:0,isWholeLine:!0}),Mi.HIDDEN_RANGE_DECORATION=Fe.register({description:"folding-hidden-range-decoration",stickiness:1});let D2=Mi;const txe={},ixe="syntax";class OW{constructor(e,t,i,n,s){this.editorModel=e,this.providers=t,this.handleFoldingRangesChange=i,this.foldingRangesLimit=n,this.fallbackRangeProvider=s,this.id=ixe,this.disposables=new $,s&&this.disposables.add(s);for(const r of t)typeof r.onDidChange=="function"&&this.disposables.add(r.onDidChange(i))}compute(e){return nxe(this.providers,this.editorModel,e).then(t=>t?oxe(t,this.foldingRangesLimit):this.fallbackRangeProvider?.compute(e)??null)}dispose(){this.disposables.dispose()}}function nxe(o,e,t){let i=null;const n=o.map((s,r)=>Promise.resolve(s.provideFoldingRanges(e,txe,t)).then(a=>{if(!t.isCancellationRequested&&Array.isArray(a)){Array.isArray(i)||(i=[]);const l=e.getLineCount();for(const c of a)c.start>0&&c.end>c.start&&c.end<=l&&i.push({start:c.start,end:c.end,rank:r,kind:c.kind})}},yi));return Promise.all(n).then(s=>i)}class sxe{constructor(e){this._startIndexes=[],this._endIndexes=[],this._nestingLevels=[],this._nestingLevelCounts=[],this._types=[],this._length=0,this._foldingRangesLimit=e}add(e,t,i,n){if(e>ha||t>ha)return;const s=this._length;this._startIndexes[s]=e,this._endIndexes[s]=t,this._nestingLevels[s]=n,this._types[s]=i,this._length++,n<30&&(this._nestingLevelCounts[n]=(this._nestingLevelCounts[n]||0)+1)}toIndentRanges(){const e=this._foldingRangesLimit.limit;if(this._length<=e){this._foldingRangesLimit.update(this._length,!1);const t=new Uint32Array(this._length),i=new Uint32Array(this._length);for(let n=0;n<this._length;n++)t[n]=this._startIndexes[n],i[n]=this._endIndexes[n];return new Lo(t,i,this._types)}else{this._foldingRangesLimit.update(this._length,e);let t=0,i=this._nestingLevelCounts.length;for(let a=0;a<this._nestingLevelCounts.length;a++){const l=this._nestingLevelCounts[a];if(l){if(l+t>e){i=a;break}t+=l}}const n=new Uint32Array(e),s=new Uint32Array(e),r=[];for(let a=0,l=0;a<this._length;a++){const c=this._nestingLevels[a];(c<i||c===i&&t++<e)&&(n[l]=this._startIndexes[a],s[l]=this._endIndexes[a],r[l]=this._types[a],l++)}return new Lo(n,s,r)}}}function oxe(o,e){const t=o.sort((r,a)=>{let l=r.start-a.start;return l===0&&(l=r.rank-a.rank),l}),i=new sxe(e);let n;const s=[];for(const r of t)if(!n)n=r,i.add(r.start,r.end,r.kind&&r.kind.value,s.length);else if(r.start>n.start)if(r.end<=n.end)s.push(n),n=r,i.add(r.start,r.end,r.kind&&r.kind.value,s.length);else{if(r.start>n.end){do n=s.pop();while(n&&r.start>n.end);n&&s.push(n),n=r}i.add(r.start,r.end,r.kind&&r.kind.value,s.length)}return i.toIndentRanges()}var rxe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},ov=function(o,e){return function(t,i){e(t,i,o)}},Sv;const Dn=new re("foldingEnabled",!1);var $g;let $h=($g=class extends F{static get(e){return e.getContribution(Sv.ID)}static getFoldingRangeProviders(e,t){const i=e.foldingRangeProvider.ordered(t);return Sv._foldingRangeSelector?.(i,t)??i}constructor(e,t,i,n,s,r){super(),this.contextKeyService=t,this.languageConfigurationService=i,this.languageFeaturesService=r,this.localToDispose=this._register(new $),this.editor=e,this._foldingLimitReporter=new vZ(e);const a=this.editor.getOptions();this._isEnabled=a.get(43),this._useFoldingProviders=a.get(44)!=="indentation",this._unfoldOnClickAfterEndOfLine=a.get(48),this._restoringViewState=!1,this._currentModelHasFoldedImports=!1,this._foldingImportsByDefault=a.get(46),this.updateDebounceInfo=s.for(r.foldingRangeProvider,"Folding",{min:200}),this.foldingModel=null,this.hiddenRangeModel=null,this.rangeProvider=null,this.foldingRegionPromise=null,this.foldingModelPromise=null,this.updateScheduler=null,this.cursorChangedScheduler=null,this.mouseDownInfo=null,this.foldingDecorationProvider=new D2(e),this.foldingDecorationProvider.showFoldingControls=a.get(111),this.foldingDecorationProvider.showFoldingHighlights=a.get(45),this.foldingEnabled=Dn.bindTo(this.contextKeyService),this.foldingEnabled.set(this._isEnabled),this._register(this.editor.onDidChangeModel(()=>this.onModelChanged())),this._register(this.editor.onDidChangeConfiguration(l=>{if(l.hasChanged(43)&&(this._isEnabled=this.editor.getOptions().get(43),this.foldingEnabled.set(this._isEnabled),this.onModelChanged()),l.hasChanged(47)&&this.onModelChanged(),l.hasChanged(111)||l.hasChanged(45)){const c=this.editor.getOptions();this.foldingDecorationProvider.showFoldingControls=c.get(111),this.foldingDecorationProvider.showFoldingHighlights=c.get(45),this.triggerFoldingModelChanged()}l.hasChanged(44)&&(this._useFoldingProviders=this.editor.getOptions().get(44)!=="indentation",this.onFoldingStrategyChanged()),l.hasChanged(48)&&(this._unfoldOnClickAfterEndOfLine=this.editor.getOptions().get(48)),l.hasChanged(46)&&(this._foldingImportsByDefault=this.editor.getOptions().get(46))})),this.onModelChanged()}saveViewState(){const e=this.editor.getModel();if(!e||!this._isEnabled||e.isTooLargeForTokenization())return{};if(this.foldingModel){const t=this.foldingModel.getMemento(),i=this.rangeProvider?this.rangeProvider.id:void 0;return{collapsedRegions:t,lineCount:e.getLineCount(),provider:i,foldedImports:this._currentModelHasFoldedImports}}}restoreViewState(e){const t=this.editor.getModel();if(!(!t||!this._isEnabled||t.isTooLargeForTokenization()||!this.hiddenRangeModel)&&e&&(this._currentModelHasFoldedImports=!!e.foldedImports,e.collapsedRegions&&e.collapsedRegions.length>0&&this.foldingModel)){this._restoringViewState=!0;try{this.foldingModel.applyMemento(e.collapsedRegions)}finally{this._restoringViewState=!1}}}onModelChanged(){this.localToDispose.clear();const e=this.editor.getModel();!this._isEnabled||!e||e.isTooLargeForTokenization()||(this._currentModelHasFoldedImports=!1,this.foldingModel=new H0e(e,this.foldingDecorationProvider),this.localToDispose.add(this.foldingModel),this.hiddenRangeModel=new j0e(this.foldingModel),this.localToDispose.add(this.hiddenRangeModel),this.localToDispose.add(this.hiddenRangeModel.onDidChange(t=>this.onHiddenRangesChanges(t))),this.updateScheduler=new hr(this.updateDebounceInfo.get(e)),this.cursorChangedScheduler=new xt(()=>this.revealCursor(),200),this.localToDispose.add(this.cursorChangedScheduler),this.localToDispose.add(this.languageFeaturesService.foldingRangeProvider.onDidChange(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelLanguageConfiguration(()=>this.onFoldingStrategyChanged())),this.localToDispose.add(this.editor.onDidChangeModelContent(t=>this.onDidChangeModelContent(t))),this.localToDispose.add(this.editor.onDidChangeCursorPosition(()=>this.onCursorPositionChanged())),this.localToDispose.add(this.editor.onMouseDown(t=>this.onEditorMouseDown(t))),this.localToDispose.add(this.editor.onMouseUp(t=>this.onEditorMouseUp(t))),this.localToDispose.add({dispose:()=>{this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.updateScheduler?.cancel(),this.updateScheduler=null,this.foldingModel=null,this.foldingModelPromise=null,this.hiddenRangeModel=null,this.cursorChangedScheduler=null,this.rangeProvider?.dispose(),this.rangeProvider=null}}),this.triggerFoldingModelChanged())}onFoldingStrategyChanged(){this.rangeProvider?.dispose(),this.rangeProvider=null,this.triggerFoldingModelChanged()}getRangeProvider(e){if(this.rangeProvider)return this.rangeProvider;const t=new MW(e,this.languageConfigurationService,this._foldingLimitReporter);if(this.rangeProvider=t,this._useFoldingProviders&&this.foldingModel){const i=Sv.getFoldingRangeProviders(this.languageFeaturesService,e);i.length>0&&(this.rangeProvider=new OW(e,i,()=>this.triggerFoldingModelChanged(),this._foldingLimitReporter,t))}return this.rangeProvider}getFoldingModel(){return this.foldingModelPromise}onDidChangeModelContent(e){this.hiddenRangeModel?.notifyChangeModelContent(e),this.triggerFoldingModelChanged()}triggerFoldingModelChanged(){this.updateScheduler&&(this.foldingRegionPromise&&(this.foldingRegionPromise.cancel(),this.foldingRegionPromise=null),this.foldingModelPromise=this.updateScheduler.trigger(()=>{const e=this.foldingModel;if(!e)return null;const t=new rn,i=this.getRangeProvider(e.textModel),n=this.foldingRegionPromise=ji(s=>i.compute(s));return n.then(s=>{if(s&&n===this.foldingRegionPromise){let r;if(this._foldingImportsByDefault&&!this._currentModelHasFoldedImports){const c=s.setCollapsedAllOfType(Th.Imports.value,!0);c&&(r=Ma.capture(this.editor),this._currentModelHasFoldedImports=c)}const a=this.editor.getSelections();e.update(s,axe(a)),r?.restore(this.editor);const l=this.updateDebounceInfo.update(e.textModel,t.elapsed());this.updateScheduler&&(this.updateScheduler.defaultDelay=l)}return e})}).then(void 0,e=>(Ae(e),null)))}onHiddenRangesChanges(e){if(this.hiddenRangeModel&&e.length&&!this._restoringViewState){const t=this.editor.getSelections();t&&this.hiddenRangeModel.adjustSelections(t)&&this.editor.setSelections(t)}this.editor.setHiddenAreas(e,this)}onCursorPositionChanged(){this.hiddenRangeModel&&this.hiddenRangeModel.hasRanges()&&this.cursorChangedScheduler.schedule()}revealCursor(){const e=this.getFoldingModel();e&&e.then(t=>{if(t){const i=this.editor.getSelections();if(i&&i.length>0){const n=[];for(const s of i){const r=s.selectionStartLineNumber;this.hiddenRangeModel&&this.hiddenRangeModel.isHidden(r)&&n.push(...t.getAllRegionsAtLine(r,a=>a.isCollapsed&&r>a.startLineNumber))}n.length&&(t.toggleCollapseState(n),this.reveal(i[0].getPosition()))}}}).then(void 0,Ae)}onEditorMouseDown(e){if(this.mouseDownInfo=null,!this.hiddenRangeModel||!e.target||!e.target.range||!e.event.leftButton&&!e.event.middleButton)return;const t=e.target.range;let i=!1;switch(e.target.type){case 4:{const n=e.target.detail,s=e.target.element.offsetLeft;if(n.offsetX-s<4)return;i=!0;break}case 7:{if(this._unfoldOnClickAfterEndOfLine&&this.hiddenRangeModel.hasRanges()&&!e.target.detail.isAfterLines)break;return}case 6:{if(this.hiddenRangeModel.hasRanges()){const n=this.editor.getModel();if(n&&t.startColumn===n.getLineMaxColumn(t.startLineNumber))break}return}default:return}this.mouseDownInfo={lineNumber:t.startLineNumber,iconClicked:i}}onEditorMouseUp(e){const t=this.foldingModel;if(!t||!this.mouseDownInfo||!e.target)return;const i=this.mouseDownInfo.lineNumber,n=this.mouseDownInfo.iconClicked,s=e.target.range;if(!s||s.startLineNumber!==i)return;if(n){if(e.target.type!==4)return}else{const a=this.editor.getModel();if(!a||s.startColumn!==a.getLineMaxColumn(i))return}const r=t.getRegionAtLine(i);if(r&&r.startLineNumber===i){const a=r.isCollapsed;if(n||a){const l=e.event.altKey;let c=[];if(l){const d=u=>!u.containedBy(r)&&!r.containedBy(u),h=t.getRegionsInside(null,d);for(const u of h)u.isCollapsed&&c.push(u);c.length===0&&(c=h)}else{const d=e.event.middleButton||e.event.shiftKey;if(d)for(const h of t.getRegionsInside(r))h.isCollapsed===a&&c.push(h);(a||!d||c.length===0)&&c.push(r)}t.toggleCollapseState(c),this.reveal({lineNumber:i,column:1})}}}reveal(e){this.editor.revealPositionInCenterIfOutsideViewport(e,0)}},Sv=$g,$g.ID="editor.contrib.folding",$g);$h=Sv=rxe([ov(1,Ee),ov(2,li),ov(3,Ei),ov(4,Uo),ov(5,ue)],$h);class vZ{constructor(e){this.editor=e,this._onDidChange=new O,this._computed=0,this._limited=!1}get limit(){return this.editor.getOptions().get(47)}update(e,t){(e!==this._computed||t!==this._limited)&&(this._computed=e,this._limited=t,this._onDidChange.fire())}}class Wn extends de{runEditorCommand(e,t,i){const n=e.get(li),s=$h.get(t);if(!s)return;const r=s.getFoldingModel();if(r)return this.reportTelemetry(e,t),r.then(a=>{if(a){this.invoke(s,a,t,i,n);const l=t.getSelection();l&&s.reveal(l.getStartPosition())}})}getSelectedLines(e){const t=e.getSelections();return t?t.map(i=>i.startLineNumber):[]}getLineNumbers(e,t){return e&&e.selectionLines?e.selectionLines.map(i=>i+1):this.getSelectedLines(t)}run(e,t){}}function axe(o){return!o||o.length===0?{startsInside:()=>!1}:{startsInside(e,t){for(const i of o){const n=i.startLineNumber;if(n>=e&&n<=t)return!0}return!1}}}function CZ(o){if(!Zn(o)){if(!nn(o))return!1;const e=o;if(!Zn(e.levels)&&!Lh(e.levels)||!Zn(e.direction)&&!Ds(e.direction)||!Zn(e.selectionLines)&&(!Array.isArray(e.selectionLines)||!e.selectionLines.every(Lh)))return!1}return!0}class lxe extends Wn{constructor(){super({id:"editor.unfold",label:p("unfoldAction.label","Unfold"),alias:"Unfold",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:3166,mac:{primary:2654},weight:100},metadata:{description:"Unfold the content in the editor",args:[{name:"Unfold editor argument",description:`Property-value pairs that can be passed through this argument:
						* 'levels': Number of levels to unfold. If not set, defaults to 1.
						* 'direction': If 'up', unfold given number of levels up otherwise unfolds down.
						* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the unfold action to. If not set, the active selection(s) will be used.
						`,constraint:CZ,schema:{type:"object",properties:{levels:{type:"number",default:1},direction:{type:"string",enum:["up","down"],default:"down"},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const s=n&&n.levels||1,r=this.getLineNumbers(n,i);n&&n.direction==="up"?_Z(t,!1,s,r):Lb(t,!1,s,r)}}class cxe extends Wn{constructor(){super({id:"editor.unfoldRecursively",label:p("unFoldRecursivelyAction.label","Unfold Recursively"),alias:"Unfold Recursively",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2142),weight:100}})}invoke(e,t,i,n){Lb(t,!1,Number.MAX_VALUE,this.getSelectedLines(i))}}class dxe extends Wn{constructor(){super({id:"editor.fold",label:p("foldAction.label","Fold"),alias:"Fold",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:3164,mac:{primary:2652},weight:100},metadata:{description:"Fold the content in the editor",args:[{name:"Fold editor argument",description:`Property-value pairs that can be passed through this argument:
							* 'levels': Number of levels to fold.
							* 'direction': If 'up', folds given number of levels up otherwise folds down.
							* 'selectionLines': Array of the start lines (0-based) of the editor selections to apply the fold action to. If not set, the active selection(s) will be used.
							If no levels or direction is set, folds the region at the locations or if already collapsed, the first uncollapsed parent instead.
						`,constraint:CZ,schema:{type:"object",properties:{levels:{type:"number"},direction:{type:"string",enum:["up","down"]},selectionLines:{type:"array",items:{type:"number"}}}}}]}})}invoke(e,t,i,n){const s=this.getLineNumbers(n,i),r=n&&n.levels,a=n&&n.direction;typeof r!="number"&&typeof a!="string"?z0e(t,!0,s):a==="up"?_Z(t,!0,r||1,s):Lb(t,!0,r||1,s)}}class hxe extends Wn{constructor(){super({id:"editor.toggleFold",label:p("toggleFoldAction.label","Toggle Fold"),alias:"Toggle Fold",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2090),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);RW(t,1,n)}}class uxe extends Wn{constructor(){super({id:"editor.foldRecursively",label:p("foldRecursivelyAction.label","Fold Recursively"),alias:"Fold Recursively",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2140),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);Lb(t,!0,Number.MAX_VALUE,n)}}class gxe extends Wn{constructor(){super({id:"editor.toggleFoldRecursively",label:p("toggleFoldRecursivelyAction.label","Toggle Fold Recursively"),alias:"Toggle Fold Recursively",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,3114),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);RW(t,Number.MAX_VALUE,n)}}class fxe extends Wn{constructor(){super({id:"editor.foldAllBlockComments",label:p("foldAllBlockComments.label","Fold All Block Comments"),alias:"Fold All Block Comments",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2138),weight:100}})}invoke(e,t,i,n,s){if(t.regions.hasTypes())AW(t,Th.Comment.value,!0);else{const r=i.getModel();if(!r)return;const a=s.getLanguageConfiguration(r.getLanguageId()).comments;if(a&&a.blockCommentStartToken){const l=new RegExp("^\\s*"+Fo(a.blockCommentStartToken));PW(t,l,!0)}}}}class pxe extends Wn{constructor(){super({id:"editor.foldAllMarkerRegions",label:p("foldAllMarkerRegions.label","Fold All Regions"),alias:"Fold All Regions",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2077),weight:100}})}invoke(e,t,i,n,s){if(t.regions.hasTypes())AW(t,Th.Region.value,!0);else{const r=i.getModel();if(!r)return;const a=s.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);PW(t,l,!0)}}}}class mxe extends Wn{constructor(){super({id:"editor.unfoldAllMarkerRegions",label:p("unfoldAllMarkerRegions.label","Unfold All Regions"),alias:"Unfold All Regions",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2078),weight:100}})}invoke(e,t,i,n,s){if(t.regions.hasTypes())AW(t,Th.Region.value,!1);else{const r=i.getModel();if(!r)return;const a=s.getLanguageConfiguration(r.getLanguageId()).foldingRules;if(a&&a.markers&&a.markers.start){const l=new RegExp(a.markers.start);PW(t,l,!1)}}}}class _xe extends Wn{constructor(){super({id:"editor.foldAllExcept",label:p("foldAllExcept.label","Fold All Except Selected"),alias:"Fold All Except Selected",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2136),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);bZ(t,!0,n)}}class bxe extends Wn{constructor(){super({id:"editor.unfoldAllExcept",label:p("unfoldAllExcept.label","Unfold All Except Selected"),alias:"Unfold All Except Selected",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2134),weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);bZ(t,!1,n)}}class vxe extends Wn{constructor(){super({id:"editor.foldAll",label:p("foldAllAction.label","Fold All"),alias:"Fold All",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2069),weight:100}})}invoke(e,t,i){Lb(t,!0)}}class Cxe extends Wn{constructor(){super({id:"editor.unfoldAll",label:p("unfoldAllAction.label","Unfold All"),alias:"Unfold All",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2088),weight:100}})}invoke(e,t,i){Lb(t,!1)}}const Lm=class Lm extends Wn{getFoldingLevel(){return parseInt(this.id.substr(Lm.ID_PREFIX.length))}invoke(e,t,i){U0e(t,this.getFoldingLevel(),!0,this.getSelectedLines(i))}};Lm.ID_PREFIX="editor.foldLevel",Lm.ID=e=>Lm.ID_PREFIX+e;let AL=Lm;class yxe extends Wn{constructor(){super({id:"editor.gotoParentFold",label:p("gotoParentFold.label","Go to Parent Fold"),alias:"Go to Parent Fold",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const s=G0e(n[0],t);s!==null&&i.setSelection({startLineNumber:s,startColumn:1,endLineNumber:s,endColumn:1})}}}class wxe extends Wn{constructor(){super({id:"editor.gotoPreviousFold",label:p("gotoPreviousFold.label","Go to Previous Folding Range"),alias:"Go to Previous Folding Range",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const s=$0e(n[0],t);s!==null&&i.setSelection({startLineNumber:s,startColumn:1,endLineNumber:s,endColumn:1})}}}class Sxe extends Wn{constructor(){super({id:"editor.gotoNextFold",label:p("gotoNextFold.label","Go to Next Folding Range"),alias:"Go to Next Folding Range",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,weight:100}})}invoke(e,t,i){const n=this.getSelectedLines(i);if(n.length>0){const s=K0e(n[0],t);s!==null&&i.setSelection({startLineNumber:s,startColumn:1,endLineNumber:s,endColumn:1})}}}class xxe extends Wn{constructor(){super({id:"editor.createFoldingRangeFromSelection",label:p("createManualFoldRange.label","Create Folding Range from Selection"),alias:"Create Folding Range from Selection",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2135),weight:100}})}invoke(e,t,i){const n=[],s=i.getSelections();if(s){for(const r of s){let a=r.endLineNumber;r.endColumn===1&&--a,a>r.startLineNumber&&(n.push({startLineNumber:r.startLineNumber,endLineNumber:a,type:void 0,isCollapsed:!0,source:1}),i.setSelection({startLineNumber:r.startLineNumber,startColumn:1,endLineNumber:r.startLineNumber,endColumn:1}))}if(n.length>0){n.sort((a,l)=>a.startLineNumber-l.startLineNumber);const r=Lo.sanitizeAndMerge(t.regions,n,i.getModel()?.getLineCount());t.updatePost(Lo.fromFoldRanges(r))}}}}class Lxe extends Wn{constructor(){super({id:"editor.removeManualFoldingRanges",label:p("removeManualFoldingRanges.label","Remove Manual Folding Ranges"),alias:"Remove Manual Folding Ranges",precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2137),weight:100}})}invoke(e,t,i){const n=i.getSelections();if(n){const s=[];for(const r of n){const{startLineNumber:a,endLineNumber:l}=r;s.push(l>=a?{startLineNumber:a,endLineNumber:l}:{endLineNumber:l,startLineNumber:a})}t.removeManualRanges(s),e.triggerFoldingModelChanged()}}}at($h.ID,$h,0);X(lxe);X(cxe);X(dxe);X(uxe);X(gxe);X(vxe);X(Cxe);X(fxe);X(pxe);X(mxe);X(_xe);X(bxe);X(hxe);X(yxe);X(wxe);X(Sxe);X(xxe);X(Lxe);for(let o=1;o<=7;o++)Uee(new AL({id:AL.ID(o),label:p("foldLevelAction.label","Fold Level {0}",o),alias:`Fold Level ${o}`,precondition:Dn,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2048|21+o),weight:100}}));st.registerCommand("_executeFoldingRangeProvider",async function(o,...e){const[t]=e;if(!(t instanceof ye))throw ar();const i=o.get(ue),n=o.get(Ut).getModel(t);if(!n)throw ar();const s=o.get(Ke);if(!s.getValue("editor.folding",{resource:t}))return[];const r=o.get(li),a=s.getValue("editor.foldingStrategy",{resource:t}),l={get limit(){return s.getValue("editor.foldingMaximumRegions",{resource:t})},update:(g,f)=>{}},c=new MW(n,r,l);let d=c;if(a!=="indentation"){const g=$h.getFoldingRangeProviders(i,n);g.length&&(d=new OW(n,g,()=>{},l,c))}const h=await d.compute(He.None),u=[];try{if(h)for(let g=0;g<h.length;g++){const f=h.getType(g);u.push({start:h.getStartLineNumber(g),end:h.getEndLineNumber(g),kind:f?Th.fromValue(f):void 0})}return u}finally{d.dispose()}});class kxe extends de{constructor(){super({id:"editor.action.fontZoomIn",label:p("EditorFontZoomIn.label","Increase Editor Font Size"),alias:"Increase Editor Font Size",precondition:void 0})}run(e,t){ir.setZoomLevel(ir.getZoomLevel()+1)}}class Exe extends de{constructor(){super({id:"editor.action.fontZoomOut",label:p("EditorFontZoomOut.label","Decrease Editor Font Size"),alias:"Decrease Editor Font Size",precondition:void 0})}run(e,t){ir.setZoomLevel(ir.getZoomLevel()-1)}}class Txe extends de{constructor(){super({id:"editor.action.fontZoomReset",label:p("EditorFontZoomReset.label","Reset Editor Font Size"),alias:"Reset Editor Font Size",precondition:void 0})}run(e,t){ir.setZoomLevel(0)}}X(kxe);X(Exe);X(Txe);var yZ=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},uC=function(o,e){return function(t,i){e(t,i,o)}},o_;let ML=(o_=class{constructor(e,t,i,n){this._editor=e,this._languageFeaturesService=t,this._workerService=i,this._accessibilitySignalService=n,this._disposables=new $,this._sessionDisposables=new $,this._disposables.add(t.onTypeFormattingEditProvider.onDidChange(this._update,this)),this._disposables.add(e.onDidChangeModel(()=>this._update())),this._disposables.add(e.onDidChangeModelLanguage(()=>this._update())),this._disposables.add(e.onDidChangeConfiguration(s=>{s.hasChanged(56)&&this._update()})),this._update()}dispose(){this._disposables.dispose(),this._sessionDisposables.dispose()}_update(){if(this._sessionDisposables.clear(),!this._editor.getOption(56)||!this._editor.hasModel())return;const e=this._editor.getModel(),[t]=this._languageFeaturesService.onTypeFormattingEditProvider.ordered(e);if(!t||!t.autoFormatTriggerCharacters)return;const i=new V0;for(const n of t.autoFormatTriggerCharacters)i.add(n.charCodeAt(0));this._sessionDisposables.add(this._editor.onDidType(n=>{const s=n.charCodeAt(n.length-1);i.has(s)&&this._trigger(String.fromCharCode(s))}))}_trigger(e){if(!this._editor.hasModel()||this._editor.getSelections().length>1||!this._editor.getSelection().isEmpty())return;const t=this._editor.getModel(),i=this._editor.getPosition(),n=new ri,s=this._editor.onDidChangeModelContent(r=>{if(r.isFlush){n.cancel(),s.dispose();return}for(let a=0,l=r.changes.length;a<l;a++)if(r.changes[a].range.endLineNumber<=i.lineNumber){n.cancel(),s.dispose();return}});xj(this._workerService,this._languageFeaturesService,t,i,e,t.getFormattingOptions(),n.token).then(r=>{n.token.isCancellationRequested||Yn(r)&&(this._accessibilitySignalService.playSignal(xo.format,{userGesture:!1}),B_.execute(this._editor,r,!0))}).finally(()=>{s.dispose()})}},o_.ID="editor.contrib.autoFormat",o_);ML=yZ([uC(1,ue),uC(2,Bs),uC(3,Jh)],ML);var r_;let OL=(r_=class{constructor(e,t,i){this.editor=e,this._languageFeaturesService=t,this._instantiationService=i,this._callOnDispose=new $,this._callOnModel=new $,this._callOnDispose.add(e.onDidChangeConfiguration(()=>this._update())),this._callOnDispose.add(e.onDidChangeModel(()=>this._update())),this._callOnDispose.add(e.onDidChangeModelLanguage(()=>this._update())),this._callOnDispose.add(t.documentRangeFormattingEditProvider.onDidChange(this._update,this))}dispose(){this._callOnDispose.dispose(),this._callOnModel.dispose()}_update(){this._callOnModel.clear(),this.editor.getOption(55)&&this.editor.hasModel()&&this._languageFeaturesService.documentRangeFormattingEditProvider.has(this.editor.getModel())&&this._callOnModel.add(this.editor.onDidPaste(({range:e})=>this._trigger(e)))}_trigger(e){this.editor.hasModel()&&(this.editor.getSelections().length>1||this._instantiationService.invokeFunction(Sj,this.editor,e,2,va.None,He.None,!1).catch(Ae))}},r_.ID="editor.contrib.formatOnPaste",r_);OL=yZ([uC(1,ue),uC(2,Ce)],OL);class Dxe extends de{constructor(){super({id:"editor.action.formatDocument",label:p("formatDocument.label","Format Document"),alias:"Format Document",precondition:K.and(T.notInCompositeEditor,T.writable,T.hasDocumentFormattingProvider),kbOpts:{kbExpr:T.editorTextFocus,primary:1572,linux:{primary:3111},weight:100},contextMenuOpts:{group:"1_modification",order:1.3}})}async run(e,t){if(t.hasModel()){const i=e.get(Ce);await e.get(Yh).showWhile(i.invokeFunction(BCe,t,1,va.None,He.None,!0),250)}}}class Ixe extends de{constructor(){super({id:"editor.action.formatSelection",label:p("formatSelection.label","Format Selection"),alias:"Format Selection",precondition:K.and(T.writable,T.hasDocumentSelectionFormattingProvider),kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2084),weight:100},contextMenuOpts:{when:T.hasNonEmptySelection,group:"1_modification",order:1.31}})}async run(e,t){if(!t.hasModel())return;const i=e.get(Ce),n=t.getModel(),s=t.getSelections().map(a=>a.isEmpty()?new L(a.startLineNumber,1,a.startLineNumber,n.getLineMaxColumn(a.startLineNumber)):a);await e.get(Yh).showWhile(i.invokeFunction(Sj,t,s,1,va.None,He.None,!0),250)}}at(ML.ID,ML,2);at(OL.ID,OL,2);X(Dxe);X(Ixe);st.registerCommand("editor.action.format",async o=>{const e=o.get(gt).getFocusedCodeEditor();if(!e||!e.hasModel())return;const t=o.get(Ft);e.getSelection().isEmpty()?await t.executeCommand("editor.action.formatDocument"):await t.executeCommand("editor.action.formatSelection")});var Nxe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},LN=function(o,e){return function(t,i){e(t,i,o)}};class cm{remove(){this.parent?.children.delete(this.id)}static findId(e,t){let i;typeof e=="string"?i=`${t.id}/${e}`:(i=`${t.id}/${e.name}`,t.children.get(i)!==void 0&&(i=`${t.id}/${e.name}_${e.range.startLineNumber}_${e.range.startColumn}`));let n=i;for(let s=0;t.children.get(n)!==void 0;s++)n=`${i}_${s}`;return n}static empty(e){return e.children.size===0}}class I2 extends cm{constructor(e,t,i){super(),this.id=e,this.parent=t,this.symbol=i,this.children=new Map}}class wZ extends cm{constructor(e,t,i,n){super(),this.id=e,this.parent=t,this.label=i,this.order=n,this.children=new Map}}class _c extends cm{static create(e,t,i){const n=new ri(i),s=new _c(t.uri),r=e.ordered(t),a=r.map((c,d)=>{const h=cm.findId(`provider_${d}`,s),u=new wZ(h,s,c.displayName??"Unknown Outline Provider",d);return Promise.resolve(c.provideDocumentSymbols(t,n.token)).then(g=>{for(const f of g||[])_c._makeOutlineElement(f,u);return u},g=>(yi(g),u)).then(g=>{cm.empty(g)?g.remove():s._groups.set(h,g)})}),l=e.onDidChange(()=>{const c=e.ordered(t);ei(c,r)||n.cancel()});return Promise.all(a).then(()=>n.token.isCancellationRequested&&!i.isCancellationRequested?_c.create(e,t,i):s._compact()).finally(()=>{n.dispose(),l.dispose(),n.dispose()})}static _makeOutlineElement(e,t){const i=cm.findId(e,t),n=new I2(i,t,e);if(e.children)for(const s of e.children)_c._makeOutlineElement(s,n);t.children.set(n.id,n)}constructor(e){super(),this.uri=e,this.id="root",this.parent=void 0,this._groups=new Map,this.children=new Map,this.id="root",this.parent=void 0}_compact(){let e=0;for(const[t,i]of this._groups)i.children.size===0?this._groups.delete(t):e+=1;if(e!==1)this.children=this._groups;else{const t=nt.first(this._groups.values());for(const[,i]of t.children)i.parent=this,this.children.set(i.id,i)}return this}getTopLevelSymbols(){const e=[];for(const t of this.children.values())t instanceof I2?e.push(t.symbol):e.push(...nt.map(t.children.values(),i=>i.symbol));return e.sort((t,i)=>L.compareRangesUsingStarts(t.range,i.range))}asListOfDocumentSymbols(){const e=this.getTopLevelSymbols(),t=[];return _c._flattenDocumentSymbols(t,e,""),t.sort((i,n)=>A.compare(L.getStartPosition(i.range),L.getStartPosition(n.range))||A.compare(L.getEndPosition(n.range),L.getEndPosition(i.range)))}static _flattenDocumentSymbols(e,t,i){for(const n of t)e.push({kind:n.kind,tags:n.tags,name:n.name,detail:n.detail,containerName:n.containerName||i,range:n.range,selectionRange:n.selectionRange,children:void 0}),n.children&&_c._flattenDocumentSymbols(e,n.children,n.name)}}const oS=Je("IOutlineModelService");let N2=class{constructor(e,t,i){this._languageFeaturesService=e,this._disposables=new $,this._cache=new Vl(10,.7),this._debounceInformation=t.for(e.documentSymbolProvider,"DocumentSymbols",{min:350}),this._disposables.add(i.onModelRemoved(n=>{this._cache.delete(n.id)}))}dispose(){this._disposables.dispose()}async getOrCreate(e,t){const i=this._languageFeaturesService.documentSymbolProvider,n=i.ordered(e);let s=this._cache.get(e.id);if(!s||s.versionId!==e.getVersionId()||!ei(s.provider,n)){const a=new ri;s={versionId:e.getVersionId(),provider:n,promiseCnt:0,source:a,promise:_c.create(i,e,a.token),model:void 0},this._cache.set(e.id,s);const l=Date.now();s.promise.then(c=>{s.model=c,this._debounceInformation.update(e,Date.now()-l)}).catch(c=>{this._cache.delete(e.id)})}if(s.model)return s.model;s.promiseCnt+=1;const r=t.onCancellationRequested(()=>{--s.promiseCnt===0&&(s.source.cancel(),this._cache.delete(e.id))});try{return await s.promise}finally{r.dispose()}}};N2=Nxe([LN(0,ue),LN(1,Uo),LN(2,Ut)],N2);it(oS,N2,1);st.registerCommand("_executeDocumentSymbolProvider",async function(o,...e){const[t]=e;ut(ye.isUri(t));const i=o.get(oS),s=await o.get(Ms).createModelReference(t);try{return(await i.getOrCreate(s.object.textEditorModel,He.None)).getTopLevelSymbols()}finally{s.dispose()}});const ol=class ol extends F{constructor(e,t){super(),this.contextKeyService=e,this.model=t,this.inlineCompletionVisible=ol.inlineSuggestionVisible.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentation=ol.inlineSuggestionHasIndentation.bindTo(this.contextKeyService),this.inlineCompletionSuggestsIndentationLessThanTabSize=ol.inlineSuggestionHasIndentationLessThanTabSize.bindTo(this.contextKeyService),this.suppressSuggestions=ol.suppressSuggestions.bindTo(this.contextKeyService),this._register(Re(i=>{const s=this.model.read(i)?.state.read(i),r=!!s?.inlineCompletion&&s?.primaryGhostText!==void 0&&!s?.primaryGhostText.isEmpty();this.inlineCompletionVisible.set(r),s?.primaryGhostText&&s?.inlineCompletion&&this.suppressSuggestions.set(s.inlineCompletion.inlineCompletion.source.inlineCompletions.suppressSuggestions)})),this._register(Re(i=>{const n=this.model.read(i);let s=!1,r=!0;const a=n?.primaryGhostText.read(i);if(n?.selectedSuggestItem&&a&&a.parts.length>0){const{column:l,lines:c}=a.parts[0],d=c[0],h=n.textModel.getLineIndentColumn(a.lineNumber);if(l<=h){let g=Xn(d);g===-1&&(g=d.length-1),s=g>0;const f=n.textModel.getOptions().tabSize;r=Vi.visibleColumnFromColumn(d,g+1,f)<f}}this.inlineCompletionSuggestsIndentation.set(s),this.inlineCompletionSuggestsIndentationLessThanTabSize.set(r)}))}};ol.inlineSuggestionVisible=new re("inlineSuggestionVisible",!1,p("inlineSuggestionVisible","Whether an inline suggestion is visible")),ol.inlineSuggestionHasIndentation=new re("inlineSuggestionHasIndentation",!1,p("inlineSuggestionHasIndentation","Whether the inline suggestion starts with whitespace")),ol.inlineSuggestionHasIndentationLessThanTabSize=new re("inlineSuggestionHasIndentationLessThanTabSize",!0,p("inlineSuggestionHasIndentationLessThanTabSize","Whether the inline suggestion starts with whitespace that is less than what would be inserted by tab")),ol.suppressSuggestions=new re("inlineSuggestionSuppressSuggestions",void 0,p("suppressSuggestions","Whether suggestions should be suppressed for the current suggestion"));let oo=ol;function Rxe(o){const e=new $,t=e.add(Qz());return e.add(Re(i=>{t.setStyle(o.read(i))})),e}class iw{constructor(e,t){this.lineNumber=e,this.parts=t}equals(e){return this.lineNumber===e.lineNumber&&this.parts.length===e.parts.length&&this.parts.every((t,i)=>t.equals(e.parts[i]))}renderForScreenReader(e){if(this.parts.length===0)return"";const t=this.parts[this.parts.length-1],i=e.substr(0,t.column-1);return new t5([...this.parts.map(s=>new Dl(L.fromPositions(new A(1,s.column)),s.lines.join(`
`)))]).applyToString(i).substring(this.parts[0].column-1)}isEmpty(){return this.parts.every(e=>e.lines.length===0)}get lineCount(){return 1+this.parts.reduce((e,t)=>e+t.lines.length-1,0)}}class FL{constructor(e,t,i){this.column=e,this.text=t,this.preview=i,this.lines=Bl(this.text)}equals(e){return this.column===e.column&&this.lines.length===e.lines.length&&this.lines.every((t,i)=>t===e.lines[i])}}class R2{constructor(e,t,i,n=0){this.lineNumber=e,this.columnRange=t,this.text=i,this.additionalReservedLineCount=n,this.parts=[new FL(this.columnRange.endColumnExclusive,this.text,!1)],this.newLines=Bl(this.text)}renderForScreenReader(e){return this.newLines.join(`
`)}get lineCount(){return this.newLines.length}isEmpty(){return this.parts.every(e=>e.lines.length===0)}equals(e){return this.lineNumber===e.lineNumber&&this.columnRange.equals(e.columnRange)&&this.newLines.length===e.newLines.length&&this.newLines.every((t,i)=>t===e.newLines[i])&&this.additionalReservedLineCount===e.additionalReservedLineCount}}function G8(o,e){return ei(o,e,SZ)}function SZ(o,e){return o===e?!0:!o||!e?!1:o instanceof iw&&e instanceof iw||o instanceof R2&&e instanceof R2?o.equals(e):!1}const Pxe=[];function Axe(){return Pxe}class xZ{constructor(e,t){if(this.startColumn=e,this.endColumnExclusive=t,e>t)throw new pt(`startColumn ${e} cannot be after endColumnExclusive ${t}`)}toRange(e){return new L(e,this.startColumn,e,this.endColumnExclusive)}equals(e){return this.startColumn===e.startColumn&&this.endColumnExclusive===e.endColumnExclusive}}function LZ(o,e){const t=new $,i=o.createDecorationsCollection();return t.add(Ow({debugName:()=>`Apply decorations from ${e.debugName}`},n=>{const s=e.read(n);i.set(s)})),t.add({dispose:()=>{i.clear()}}),t}function Mxe(o,e){return new A(o.lineNumber+e.lineNumber-1,e.lineNumber===1?o.column+e.column-1:e.column)}function $8(o,e){return new A(o.lineNumber-e.lineNumber+1,o.lineNumber-e.lineNumber===0?o.column-e.column+1:o.column)}var Oxe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Fxe=function(o,e){return function(t,i){e(t,i,o)}};const K8="ghost-text";let P2=class extends F{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=$e(this,!1),this.currentTextModel=yt(this,this.editor.onDidChangeModel,()=>this.editor.getModel()),this.uiState=me(this,n=>{if(this.isDisposed.read(n))return;const s=this.currentTextModel.read(n);if(s!==this.model.targetTextModel.read(n))return;const r=this.model.ghostText.read(n);if(!r)return;const a=r instanceof R2?r.columnRange:void 0,l=[],c=[];function d(m,_){if(c.length>0){const b=c[c.length-1];_&&b.decorations.push(new as(b.content.length+1,b.content.length+1+m[0].length,_,0)),b.content+=m[0],m=m.slice(1)}for(const b of m)c.push({content:b,decorations:_?[new as(1,b.length+1,_,0)]:[]})}const h=s.getLineContent(r.lineNumber);let u,g=0;for(const m of r.parts){let _=m.lines;u===void 0?(l.push({column:m.column,text:_[0],preview:m.preview}),_=_.slice(1)):d([h.substring(g,m.column-1)],void 0),_.length>0&&(d(_,K8),u===void 0&&m.column<=h.length&&(u=m.column)),g=m.column-1}u!==void 0&&d([h.substring(g)],void 0);const f=u!==void 0?new xZ(u,h.length+1):void 0;return{replacedRange:a,inlineTexts:l,additionalLines:c,hiddenRange:f,lineNumber:r.lineNumber,additionalReservedLineCount:this.model.minReservedLineCount.read(n),targetTextModel:s}}),this.decorations=me(this,n=>{const s=this.uiState.read(n);if(!s)return[];const r=[];s.replacedRange&&r.push({range:s.replacedRange.toRange(s.lineNumber),options:{inlineClassName:"inline-completion-text-to-replace",description:"GhostTextReplacement"}}),s.hiddenRange&&r.push({range:s.hiddenRange.toRange(s.lineNumber),options:{inlineClassName:"ghost-text-hidden",description:"ghost-text-hidden"}});for(const a of s.inlineTexts)r.push({range:L.fromPositions(new A(s.lineNumber,a.column)),options:{description:K8,after:{content:a.text,inlineClassName:a.preview?"ghost-text-decoration-preview":"ghost-text-decoration",cursorStops:Or.Left},showIfCollapsed:!0}});return r}),this.additionalLinesWidget=this._register(new Bxe(this.editor,this.languageService.languageIdCodec,me(n=>{const s=this.uiState.read(n);return s?{lineNumber:s.lineNumber,additionalLines:s.additionalLines,minReservedLineCount:s.additionalReservedLineCount,targetTextModel:s.targetTextModel}:void 0}))),this._register(ve(()=>{this.isDisposed.set(!0,void 0)})),this._register(LZ(this.editor,this.decorations))}ownsViewZone(e){return this.additionalLinesWidget.viewZoneId===e}};P2=Oxe([Fxe(2,ti)],P2);class Bxe extends F{get viewZoneId(){return this._viewZoneId}constructor(e,t,i){super(),this.editor=e,this.languageIdCodec=t,this.lines=i,this._viewZoneId=void 0,this.editorOptionsChanged=Sn("editorOptionChanged",se.filter(this.editor.onDidChangeConfiguration,n=>n.hasChanged(33)||n.hasChanged(118)||n.hasChanged(100)||n.hasChanged(95)||n.hasChanged(51)||n.hasChanged(50)||n.hasChanged(67))),this._register(Re(n=>{const s=this.lines.read(n);this.editorOptionsChanged.read(n),s?this.updateLines(s.lineNumber,s.additionalLines,s.minReservedLineCount):this.clear()}))}dispose(){super.dispose(),this.clear()}clear(){this.editor.changeViewZones(e=>{this._viewZoneId&&(e.removeZone(this._viewZoneId),this._viewZoneId=void 0)})}updateLines(e,t,i){const n=this.editor.getModel();if(!n)return;const{tabSize:s}=n.getOptions();this.editor.changeViewZones(r=>{this._viewZoneId&&(r.removeZone(this._viewZoneId),this._viewZoneId=void 0);const a=Math.max(t.length,i);if(a>0){const l=document.createElement("div");Wxe(l,s,t,this.editor.getOptions(),this.languageIdCodec),this._viewZoneId=r.addZone({afterLineNumber:e,heightInLines:a,domNode:l,afterColumnAffinity:1})}})}}function Wxe(o,e,t,i,n){const s=i.get(33),r=i.get(118),a="none",l=i.get(95),c=i.get(51),d=i.get(50),h=i.get(67),u=new rb(1e4);u.appendString('<div class="suggest-preview-text">');for(let m=0,_=t.length;m<_;m++){const b=t[m],v=b.content;u.appendString('<div class="view-line'),u.appendString('" style="top:'),u.appendString(String(m*h)),u.appendString('px;width:1000000px;">');const y=Sw(v),C=p_(v),w=an.createEmpty(v,n);$w(new eu(d.isMonospace&&!s,d.canUseHalfwidthRightwardsArrow,v,!1,y,C,0,w,b.decorations,e,0,d.spaceWidth,d.middotWidth,d.wsmiddotWidth,r,a,l,c!==kh.OFF,null),u),u.appendString("</div>")}u.appendString("</div>"),mn(o,d);const g=u.build(),f=j8?j8.createHTML(g):g;o.innerHTML=f}const j8=nd("editorGhostText",{createHTML:o=>o});function Vxe(o,e){const t=new C$,i=new w$(t,c=>e.getLanguageConfiguration(c)),n=new y$(new Hxe([o]),i),s=VA(n,[],void 0,!0);let r="";const a=o.getLineContent();function l(c,d){if(c.kind===2)if(l(c.openingBracket,d),d=mi(d,c.openingBracket.length),c.child&&(l(c.child,d),d=mi(d,c.child.length)),c.closingBracket)l(c.closingBracket,d),d=mi(d,c.closingBracket.length);else{const u=i.getSingleLanguageBracketTokens(c.openingBracket.languageId).findClosingTokenText(c.openingBracket.bracketIds);r+=u}else if(c.kind!==3){if(c.kind===0||c.kind===1)r+=a.substring(d,mi(d,c.length));else if(c.kind===4)for(const h of c.children)l(h,d),d=mi(d,h.length)}}return l(s,rs),r}class Hxe{constructor(e){this.lines=e,this.tokenization={getLineTokens:t=>this.lines[t-1]}}getLineCount(){return this.lines.length}getLineLength(e){return this.lines[e-1].getLineContent().length}}async function kZ(o,e,t,i,n=He.None,s){const r=e instanceof A?Gxe(e,t):e,a=o.all(t),l=new Y4;for(const b of a)b.groupId&&l.add(b.groupId,b);function c(b){if(!b.yieldsToGroupIds)return[];const v=[];for(const y of b.yieldsToGroupIds||[]){const C=l.get(y);for(const w of C)v.push(w)}return v}const d=new Map,h=new Set;function u(b,v){if(v=[...v,b],h.has(b))return v;h.add(b);try{const y=c(b);for(const C of y){const w=u(C,v);if(w)return w}}finally{h.delete(b)}}function g(b){const v=d.get(b);if(v)return v;const y=u(b,[]);y&&yi(new Error(`Inline completions: cyclic yield-to dependency detected. Path: ${y.map(w=>w.toString?w.toString():""+w).join(" -> ")}`));const C=new ib;return d.set(b,C.p),(async()=>{if(!y){const w=c(b);for(const x of w){const k=await g(x);if(k&&k.items.length>0)return}}try{return e instanceof A?await b.provideInlineCompletions(t,e,i,n):await b.provideInlineEdits?.(t,e,i,n)}catch(w){yi(w);return}})().then(w=>C.complete(w),w=>C.error(w)),C.p}const f=await Promise.all(a.map(async b=>({provider:b,completions:await g(b)}))),m=new Map,_=[];for(const b of f){const v=b.completions;if(!v)continue;const y=new Uxe(v,b.provider);_.push(y);for(const C of v.items){const w=BL.from(C,y,r,t,s);m.set(w.hash(),w)}}return new zxe(Array.from(m.values()),new Set(m.keys()),_)}class zxe{constructor(e,t,i){this.completions=e,this.hashs=t,this.providerResults=i}has(e){return this.hashs.has(e.hash())}dispose(){for(const e of this.providerResults)e.removeRef()}}class Uxe{constructor(e,t){this.inlineCompletions=e,this.provider=t,this.refCount=1}addRef(){this.refCount++}removeRef(){this.refCount--,this.refCount===0&&this.provider.freeInlineCompletions(this.inlineCompletions)}}class BL{static from(e,t,i,n,s){let r,a,l=e.range?L.lift(e.range):i;if(typeof e.insertText=="string"){if(r=e.insertText,s&&e.completeBracketPairs){r=q8(r,l.getStartPosition(),n,s);const c=r.length-e.insertText.length;c!==0&&(l=new L(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+c))}a=void 0}else if("snippet"in e.insertText){const c=e.insertText.snippet.length;if(s&&e.completeBracketPairs){e.insertText.snippet=q8(e.insertText.snippet,l.getStartPosition(),n,s);const h=e.insertText.snippet.length-c;h!==0&&(l=new L(l.startLineNumber,l.startColumn,l.endLineNumber,l.endColumn+h))}const d=new Pf().parse(e.insertText.snippet);d.children.length===1&&d.children[0]instanceof ss?(r=d.children[0].value,a=void 0):(r=d.toString(),a={snippet:e.insertText.snippet,range:l})}else _T(e.insertText);return new BL(r,e.command,l,r,a,e.additionalTextEdits||Axe(),e,t)}constructor(e,t,i,n,s,r,a,l){this.filterText=e,this.command=t,this.range=i,this.insertText=n,this.snippetInfo=s,this.additionalTextEdits=r,this.sourceInlineCompletion=a,this.source=l,e=e.replace(/\r\n|\r/g,`
`),n=e.replace(/\r\n|\r/g,`
`)}withRange(e){return new BL(this.filterText,this.command,e,this.insertText,this.snippetInfo,this.additionalTextEdits,this.sourceInlineCompletion,this.source)}hash(){return JSON.stringify({insertText:this.insertText,range:this.range.toString()})}toSingleTextEdit(){return new Dl(this.range,this.insertText)}}function Gxe(o,e){const t=e.getWordAtPosition(o),i=e.getLineMaxColumn(o.lineNumber);return t?new L(o.lineNumber,t.startColumn,o.lineNumber,i):L.fromPositions(o,o.with(void 0,i))}function q8(o,e,t,i){const s=t.getLineContent(e.lineNumber).substring(0,e.column-1)+o,a=t.tokenization.tokenizeLineWithEdit(e,s.length-(e.column-1),o)?.sliceAndInflate(e.column-1,s.length,0);return a?Vxe(a,i):o}function mg(o,e,t){const i=t?o.range.intersectRanges(t):o.range;if(!i)return o;const n=e.getValueInRange(i,1),s=Dh(n,o.text),r=Gr.ofText(n.substring(0,s)).addToPosition(o.range.getStartPosition()),a=o.text.substring(s),l=L.fromPositions(r,o.range.getEndPosition());return new Dl(l,a)}function EZ(o,e){return o.text.startsWith(e.text)&&$xe(o.range,e.range)}function Z8(o,e,t,i,n=0){let s=mg(o,e);if(s.range.endLineNumber!==s.range.startLineNumber)return;const r=e.getLineContent(s.range.startLineNumber),a=Tt(r).length;if(s.range.startColumn-1<=a){const f=Tt(s.text).length,m=r.substring(s.range.startColumn-1,a),[_,b]=[s.range.getStartPosition(),s.range.getEndPosition()],v=_.column+m.length<=b.column?_.delta(0,m.length):b,y=L.fromPositions(v,b),C=s.text.startsWith(m)?s.text.substring(m.length):s.text.substring(f);s=new Dl(y,C)}const c=e.getValueInRange(s.range),d=Kxe(c,s.text);if(!d)return;const h=s.range.startLineNumber,u=new Array;if(t==="prefix"){const f=d.filter(m=>m.originalLength===0);if(f.length>1||f.length===1&&f[0].originalStart!==c.length)return}const g=s.text.length-n;for(const f of d){const m=s.range.startColumn+f.originalStart+f.originalLength;if(t==="subwordSmart"&&i&&i.lineNumber===s.range.startLineNumber&&m<i.column||f.originalLength>0)return;if(f.modifiedLength===0)continue;const _=f.modifiedStart+f.modifiedLength,b=Math.max(f.modifiedStart,Math.min(_,g)),v=s.text.substring(f.modifiedStart,b),y=s.text.substring(b,Math.max(f.modifiedStart,_));v.length>0&&u.push(new FL(m,v,!1)),y.length>0&&u.push(new FL(m,y,!0))}return new iw(h,u)}function $xe(o,e){return e.getStartPosition().equals(o.getStartPosition())&&e.getEndPosition().isBeforeOrEqual(o.getEndPosition())}let p1;function Kxe(o,e){if(p1?.originalValue===o&&p1?.newValue===e)return p1?.changes;{let t=X8(o,e,!0);if(t){const i=Y8(t);if(i>0){const n=X8(o,e,!1);n&&Y8(n)<i&&(t=n)}}return p1={originalValue:o,newValue:e,changes:t},t}}function Y8(o){let e=0;for(const t of o)e+=t.originalLength;return e}function X8(o,e,t){if(o.length>5e3||e.length>5e3)return;function i(c){let d=0;for(let h=0,u=c.length;h<u;h++){const g=c.charCodeAt(h);g>d&&(d=g)}return d}const n=Math.max(i(o),i(e));function s(c){if(c<0)throw new Error("unexpected");return n+c+1}function r(c){let d=0,h=0;const u=new Int32Array(c.length);for(let g=0,f=c.length;g<f;g++)if(t&&c[g]==="("){const m=h*100+d;u[g]=s(2*m),d++}else if(t&&c[g]===")"){d=Math.max(d-1,0);const m=h*100+d;u[g]=s(2*m+1),d===0&&h++}else u[g]=c.charCodeAt(g);return u}const a=r(o),l=r(e);return new pl({getElements:()=>a},{getElements:()=>l}).ComputeDiff(!1).changes}var jxe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Q8=function(o,e){return function(t,i){e(t,i,o)}};let A2=class extends F{constructor(e,t,i,n,s){super(),this.textModel=e,this.versionId=t,this._debounceValue=i,this.languageFeaturesService=n,this.languageConfigurationService=s,this._updateOperation=this._register(new Yi),this.inlineCompletions=my("inlineCompletions",void 0),this.suggestWidgetInlineCompletions=my("suggestWidgetInlineCompletions",void 0),this._register(this.textModel.onDidChangeContent(()=>{this._updateOperation.clear()}))}fetch(e,t,i){const n=new Zxe(e,t,this.textModel.getVersionId()),s=t.selectedSuggestionInfo?this.suggestWidgetInlineCompletions:this.inlineCompletions;if(this._updateOperation.value?.request.satisfies(n))return this._updateOperation.value.promise;if(s.get()?.request.satisfies(n))return Promise.resolve(!0);const r=!!this._updateOperation.value;this._updateOperation.clear();const a=new ri,l=(async()=>{if((r||t.triggerKind===wa.Automatic)&&await qxe(this._debounceValue.get(this.textModel),a.token),a.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==n.versionId)return!1;const h=new Date,u=await kZ(this.languageFeaturesService.inlineCompletionsProvider,e,this.textModel,t,a.token,this.languageConfigurationService);if(a.token.isCancellationRequested||this._store.isDisposed||this.textModel.getVersionId()!==n.versionId)return!1;const g=new Date;this._debounceValue.update(this.textModel,g.getTime()-h.getTime());const f=new Xxe(u,n,this.textModel,this.versionId);if(i){const m=i.toInlineCompletion(void 0);i.canBeReused(this.textModel,e)&&!u.has(m)&&f.prepend(i.inlineCompletion,m.range,!0)}return this._updateOperation.clear(),oi(m=>{s.set(f,m)}),!0})(),c=new Yxe(n,a,l);return this._updateOperation.value=c,l}clear(e){this._updateOperation.clear(),this.inlineCompletions.set(void 0,e),this.suggestWidgetInlineCompletions.set(void 0,e)}clearSuggestWidgetInlineCompletions(e){this._updateOperation.value?.request.context.selectedSuggestionInfo&&this._updateOperation.clear(),this.suggestWidgetInlineCompletions.set(void 0,e)}cancelUpdate(){this._updateOperation.clear()}};A2=jxe([Q8(3,ue),Q8(4,li)],A2);function qxe(o,e){return new Promise(t=>{let i;const n=setTimeout(()=>{i&&i.dispose(),t()},o);e&&(i=e.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),t()}))})}class Zxe{constructor(e,t,i){this.position=e,this.context=t,this.versionId=i}satisfies(e){return this.position.equals(e.position)&&CA(this.context.selectedSuggestionInfo,e.context.selectedSuggestionInfo,Zae())&&(e.context.triggerKind===wa.Automatic||this.context.triggerKind===wa.Explicit)&&this.versionId===e.versionId}}class Yxe{constructor(e,t,i){this.request=e,this.cancellationTokenSource=t,this.promise=i}dispose(){this.cancellationTokenSource.cancel()}}class Xxe{get inlineCompletions(){return this._inlineCompletions}constructor(e,t,i,n){this.inlineCompletionProviderResult=e,this.request=t,this._textModel=i,this._versionId=n,this._refCount=1,this._prependedInlineCompletionItems=[];const s=i.deltaDecorations([],e.completions.map(r=>({range:r.range,options:{description:"inline-completion-tracking-range"}})));this._inlineCompletions=e.completions.map((r,a)=>new J8(r,s[a],this._textModel,this._versionId))}clone(){return this._refCount++,this}dispose(){if(this._refCount--,this._refCount===0){setTimeout(()=>{this._textModel.isDisposed()||this._textModel.deltaDecorations(this._inlineCompletions.map(e=>e.decorationId),[])},0),this.inlineCompletionProviderResult.dispose();for(const e of this._prependedInlineCompletionItems)e.source.removeRef()}}prepend(e,t,i){i&&e.source.addRef();const n=this._textModel.deltaDecorations([],[{range:t,options:{description:"inline-completion-tracking-range"}}])[0];this._inlineCompletions.unshift(new J8(e,n,this._textModel,this._versionId)),this._prependedInlineCompletionItems.push(e)}}class J8{get forwardStable(){return this.inlineCompletion.source.inlineCompletions.enableForwardStability??!1}constructor(e,t,i,n){this.inlineCompletion=e,this.decorationId=t,this._textModel=i,this._modelVersion=n,this.semanticId=JSON.stringify([this.inlineCompletion.filterText,this.inlineCompletion.insertText,this.inlineCompletion.range.getStartPosition().toString()]),this._updatedRange=Eo({owner:this,equalsFn:L.equalsRange},s=>(this._modelVersion.read(s),this._textModel.getDecorationRange(this.decorationId)))}toInlineCompletion(e){return this.inlineCompletion.withRange(this._updatedRange.read(e)??kN)}toSingleTextEdit(e){return new Dl(this._updatedRange.read(e)??kN,this.inlineCompletion.insertText)}isVisible(e,t,i){const n=mg(this._toFilterTextReplacement(i),e),s=this._updatedRange.read(i);if(!s||!this.inlineCompletion.range.getStartPosition().equals(s.getStartPosition())||t.lineNumber!==n.range.startLineNumber)return!1;const r=e.getValueInRange(n.range,1),a=n.text,l=Math.max(0,t.column-n.range.startColumn);let c=a.substring(0,l),d=a.substring(l),h=r.substring(0,l),u=r.substring(l);const g=e.getLineIndentColumn(n.range.startLineNumber);return n.range.startColumn<=g&&(h=h.trimStart(),h.length===0&&(u=u.trimStart()),c=c.trimStart(),c.length===0&&(d=d.trimStart())),c.startsWith(h)&&!!kG(u,d)}canBeReused(e,t){const i=this._updatedRange.read(void 0);return!!i&&i.containsPosition(t)&&this.isVisible(e,t,void 0)&&Gr.ofRange(i).isGreaterThanOrEqualTo(Gr.ofRange(this.inlineCompletion.range))}_toFilterTextReplacement(e){return new Dl(this._updatedRange.read(e)??kN,this.inlineCompletion.filterText)}}const kN=new L(1,1,1,1),ze={Visible:IW,HasFocusedSuggestion:new re("suggestWidgetHasFocusedSuggestion",!1,p("suggestWidgetHasSelection","Whether any suggestion is focused")),DetailsVisible:new re("suggestWidgetDetailsVisible",!1,p("suggestWidgetDetailsVisible","Whether suggestion details are visible")),MultipleSuggestions:new re("suggestWidgetMultipleSuggestions",!1,p("suggestWidgetMultipleSuggestions","Whether there are multiple suggestions to pick from")),MakesTextEdit:new re("suggestionMakesTextEdit",!0,p("suggestionMakesTextEdit","Whether inserting the current suggestion yields in a change or has everything already been typed")),AcceptSuggestionsOnEnter:new re("acceptSuggestionOnEnter",!0,p("acceptSuggestionOnEnter","Whether suggestions are inserted when pressing Enter")),HasInsertAndReplaceRange:new re("suggestionHasInsertAndReplaceRange",!1,p("suggestionHasInsertAndReplaceRange","Whether the current suggestion has insert and replace behaviour")),InsertMode:new re("suggestionInsertMode",void 0,{type:"string",description:p("suggestionInsertMode","Whether the default behaviour is to insert or replace")}),CanResolve:new re("suggestionCanResolve",!1,p("suggestionCanResolve","Whether the current suggestion supports to resolve further details"))},ah=new fe("suggestWidgetStatusBar");class Qxe{constructor(e,t,i,n){this.position=e,this.completion=t,this.container=i,this.provider=n,this.isInvalid=!1,this.score=ka.Default,this.distance=0,this.textLabel=typeof t.label=="string"?t.label:t.label?.label,this.labelLow=this.textLabel.toLowerCase(),this.isInvalid=!this.textLabel,this.sortTextLow=t.sortText&&t.sortText.toLowerCase(),this.filterTextLow=t.filterText&&t.filterText.toLowerCase(),this.extensionId=t.extensionId,L.isIRange(t.range)?(this.editStart=new A(t.range.startLineNumber,t.range.startColumn),this.editInsertEnd=new A(t.range.endLineNumber,t.range.endColumn),this.editReplaceEnd=new A(t.range.endLineNumber,t.range.endColumn),this.isInvalid=this.isInvalid||L.spansMultipleLines(t.range)||t.range.startLineNumber!==e.lineNumber):(this.editStart=new A(t.range.insert.startLineNumber,t.range.insert.startColumn),this.editInsertEnd=new A(t.range.insert.endLineNumber,t.range.insert.endColumn),this.editReplaceEnd=new A(t.range.replace.endLineNumber,t.range.replace.endColumn),this.isInvalid=this.isInvalid||L.spansMultipleLines(t.range.insert)||L.spansMultipleLines(t.range.replace)||t.range.insert.startLineNumber!==e.lineNumber||t.range.replace.startLineNumber!==e.lineNumber||t.range.insert.startColumn!==t.range.replace.startColumn),typeof n.resolveCompletionItem!="function"&&(this._resolveCache=Promise.resolve(),this._resolveDuration=0)}get isResolved(){return this._resolveDuration!==void 0}get resolveDuration(){return this._resolveDuration!==void 0?this._resolveDuration:-1}async resolve(e){if(!this._resolveCache){const t=e.onCancellationRequested(()=>{this._resolveCache=void 0,this._resolveDuration=void 0}),i=new rn(!0);this._resolveCache=Promise.resolve(this.provider.resolveCompletionItem(this.completion,e)).then(n=>{Object.assign(this.completion,n),this._resolveDuration=i.elapsed()},n=>{_r(n)&&(this._resolveCache=void 0,this._resolveDuration=void 0)}).finally(()=>{t.dispose()})}return this._resolveCache}}const bE=class bE{constructor(e=2,t=new Set,i=new Set,n=new Map,s=!0){this.snippetSortOrder=e,this.kindFilter=t,this.providerFilter=i,this.providerItemsToReuse=n,this.showDeprecated=s}};bE.default=new bE;let nw=bE;class Jxe{constructor(e,t,i,n){this.items=e,this.needsClipboard=t,this.durations=i,this.disposable=n}}async function FW(o,e,t,i=nw.default,n={triggerKind:0},s=He.None){const r=new rn;t=t.clone();const a=e.getWordAtPosition(t),l=a?new L(t.lineNumber,a.startColumn,t.lineNumber,a.endColumn):L.fromPositions(t),c={replace:l,insert:l.setEndPosition(t.lineNumber,t.column)},d=[],h=new $,u=[];let g=!1;const f=(_,b,v)=>{let y=!1;if(!b)return y;for(const C of b.suggestions)if(!i.kindFilter.has(C.kind)){if(!i.showDeprecated&&C?.tags?.includes(1))continue;C.range||(C.range=c),C.sortText||(C.sortText=typeof C.label=="string"?C.label:C.label.label),!g&&C.insertTextRules&&C.insertTextRules&4&&(g=Pf.guessNeedsClipboard(C.insertText)),d.push(new Qxe(t,C,b,_)),y=!0}return JE(b)&&h.add(b),u.push({providerName:_._debugDisplayName??"unknown_provider",elapsedProvider:b.duration??-1,elapsedOverall:v.elapsed()}),y},m=(async()=>{})();for(const _ of o.orderedGroups(e)){let b=!1;if(await Promise.all(_.map(async v=>{if(i.providerItemsToReuse.has(v)){const y=i.providerItemsToReuse.get(v);y.forEach(C=>d.push(C)),b=b||y.length>0;return}if(!(i.providerFilter.size>0&&!i.providerFilter.has(v)))try{const y=new rn,C=await v.provideCompletionItems(e,t,n,s);b=f(v,C,y)||b}catch(y){yi(y)}})),b||s.isCancellationRequested)break}return await m,s.isCancellationRequested?(h.dispose(),Promise.reject(new Hr)):new Jxe(d.sort(iLe(i.snippetSortOrder)),g,{entries:u,elapsed:r.elapsed()},h)}function BW(o,e){if(o.sortTextLow&&e.sortTextLow){if(o.sortTextLow<e.sortTextLow)return-1;if(o.sortTextLow>e.sortTextLow)return 1}return o.textLabel<e.textLabel?-1:o.textLabel>e.textLabel?1:o.completion.kind-e.completion.kind}function eLe(o,e){if(o.completion.kind!==e.completion.kind){if(o.completion.kind===27)return-1;if(e.completion.kind===27)return 1}return BW(o,e)}function tLe(o,e){if(o.completion.kind!==e.completion.kind){if(o.completion.kind===27)return 1;if(e.completion.kind===27)return-1}return BW(o,e)}const kD=new Map;kD.set(0,eLe);kD.set(2,tLe);kD.set(1,BW);function iLe(o){return kD.get(o)}st.registerCommand("_executeCompletionItemProvider",async(o,...e)=>{const[t,i,n,s]=e;ut(ye.isUri(t)),ut(A.isIPosition(i)),ut(typeof n=="string"||!n),ut(typeof s=="number"||!s);const{completionProvider:r}=o.get(ue),a=await o.get(Ms).createModelReference(t);try{const l={incomplete:!1,suggestions:[]},c=[],d=a.object.textEditorModel.validatePosition(i),h=await FW(r,a.object.textEditorModel,d,void 0,{triggerCharacter:n??void 0,triggerKind:n?1:0});for(const u of h.items)c.length<(s??0)&&c.push(u.resolve(He.None)),l.incomplete=l.incomplete||u.container.incomplete,l.suggestions.push(u.completion);try{return await Promise.all(c),l}finally{setTimeout(()=>h.disposable.dispose(),100)}}finally{a.dispose()}});function nLe(o,e){o.getContribution("editor.contrib.suggestController")?.triggerSuggest(new Set().add(e),void 0,!0)}class dm{static isAllOff(e){return e.other==="off"&&e.comments==="off"&&e.strings==="off"}static isAllOn(e){return e.other==="on"&&e.comments==="on"&&e.strings==="on"}static valueFor(e,t){switch(t){case 1:return e.comments;case 2:return e.strings;default:return e.other}}}function e6(o,e=En){return Cne(o,e)?o.charAt(0).toUpperCase()+o.slice(1):o}var sLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},oLe=function(o,e){return function(t,i){e(t,i,o)}};class t6{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){const i=t.resolve(e);if(i!==void 0)return i}}}class i6{constructor(e,t,i,n){this._model=e,this._selection=t,this._selectionIdx=i,this._overtypingCapturer=n}resolve(e){const{name:t}=e;if(t==="SELECTION"||t==="TM_SELECTED_TEXT"){let i=this._model.getValueInRange(this._selection)||void 0,n=this._selection.startLineNumber!==this._selection.endLineNumber;if(!i&&this._overtypingCapturer){const s=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);s&&(i=s.value,n=s.multiline)}if(i&&n&&e.snippet){const s=this._model.getLineContent(this._selection.startLineNumber),r=Tt(s,0,this._selection.startColumn-1);let a=r;e.snippet.walk(c=>c===e?!1:(c instanceof ss&&(a=Tt(Bl(c.value).pop())),!0));const l=Dh(a,r);i=i.replace(/(\r\n|\r|\n)(.*)/g,(c,d,h)=>`${d}${a.substr(l)}${h}`)}return i}else{if(t==="TM_CURRENT_LINE")return this._model.getLineContent(this._selection.positionLineNumber);if(t==="TM_CURRENT_WORD"){const i=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return i&&i.word||void 0}else{if(t==="TM_LINE_INDEX")return String(this._selection.positionLineNumber-1);if(t==="TM_LINE_NUMBER")return String(this._selection.positionLineNumber);if(t==="CURSOR_INDEX")return String(this._selectionIdx);if(t==="CURSOR_NUMBER")return String(this._selectionIdx+1)}}}}class n6{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if(t==="TM_FILENAME")return th(this._model.uri.fsPath);if(t==="TM_FILENAME_BASE"){const i=th(this._model.uri.fsPath),n=i.lastIndexOf(".");return n<=0?i:i.slice(0,n)}else{if(t==="TM_DIRECTORY")return fz(this._model.uri.fsPath)==="."?"":this._labelService.getUriLabel(MT(this._model.uri));if(t==="TM_FILEPATH")return this._labelService.getUriLabel(this._model.uri);if(t==="RELATIVE_FILEPATH")return this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0})}}}class s6{constructor(e,t,i,n){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=i,this._spread=n}resolve(e){if(e.name!=="CLIPBOARD")return;const t=this._readClipboardText();if(t){if(this._spread){const i=t.split(/\r\n|\n|\r/).filter(n=>!Sz(n));if(i.length===this._selectionCount)return i[this._selectionIdx]}return t}}}let WL=class{constructor(e,t,i){this._model=e,this._selection=t,this._languageConfigurationService=i}resolve(e){const{name:t}=e,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),n=this._languageConfigurationService.getLanguageConfiguration(i).comments;if(n){if(t==="LINE_COMMENT")return n.lineCommentToken||void 0;if(t==="BLOCK_COMMENT_START")return n.blockCommentStartToken||void 0;if(t==="BLOCK_COMMENT_END")return n.blockCommentEndToken||void 0}}};WL=sLe([oLe(2,li)],WL);const rl=class rl{constructor(){this._date=new Date}resolve(e){const{name:t}=e;if(t==="CURRENT_YEAR")return String(this._date.getFullYear());if(t==="CURRENT_YEAR_SHORT")return String(this._date.getFullYear()).slice(-2);if(t==="CURRENT_MONTH")return String(this._date.getMonth().valueOf()+1).padStart(2,"0");if(t==="CURRENT_DATE")return String(this._date.getDate().valueOf()).padStart(2,"0");if(t==="CURRENT_HOUR")return String(this._date.getHours().valueOf()).padStart(2,"0");if(t==="CURRENT_MINUTE")return String(this._date.getMinutes().valueOf()).padStart(2,"0");if(t==="CURRENT_SECOND")return String(this._date.getSeconds().valueOf()).padStart(2,"0");if(t==="CURRENT_DAY_NAME")return rl.dayNames[this._date.getDay()];if(t==="CURRENT_DAY_NAME_SHORT")return rl.dayNamesShort[this._date.getDay()];if(t==="CURRENT_MONTH_NAME")return rl.monthNames[this._date.getMonth()];if(t==="CURRENT_MONTH_NAME_SHORT")return rl.monthNamesShort[this._date.getMonth()];if(t==="CURRENT_SECONDS_UNIX")return String(Math.floor(this._date.getTime()/1e3));if(t==="CURRENT_TIMEZONE_OFFSET"){const i=this._date.getTimezoneOffset(),n=i>0?"-":"+",s=Math.trunc(Math.abs(i/60)),r=s<10?"0"+s:s,a=Math.abs(i)-s*60,l=a<10?"0"+a:a;return n+r+":"+l}}};rl.dayNames=[p("Sunday","Sunday"),p("Monday","Monday"),p("Tuesday","Tuesday"),p("Wednesday","Wednesday"),p("Thursday","Thursday"),p("Friday","Friday"),p("Saturday","Saturday")],rl.dayNamesShort=[p("SundayShort","Sun"),p("MondayShort","Mon"),p("TuesdayShort","Tue"),p("WednesdayShort","Wed"),p("ThursdayShort","Thu"),p("FridayShort","Fri"),p("SaturdayShort","Sat")],rl.monthNames=[p("January","January"),p("February","February"),p("March","March"),p("April","April"),p("May","May"),p("June","June"),p("July","July"),p("August","August"),p("September","September"),p("October","October"),p("November","November"),p("December","December")],rl.monthNamesShort=[p("JanuaryShort","Jan"),p("FebruaryShort","Feb"),p("MarchShort","Mar"),p("AprilShort","Apr"),p("MayShort","May"),p("JuneShort","Jun"),p("JulyShort","Jul"),p("AugustShort","Aug"),p("SeptemberShort","Sep"),p("OctoberShort","Oct"),p("NovemberShort","Nov"),p("DecemberShort","Dec")];let VL=rl;class o6{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=Bae(this._workspaceService.getWorkspace());if(!Oae(t)){if(e.name==="WORKSPACE_NAME")return this._resolveWorkspaceName(t);if(e.name==="WORKSPACE_FOLDER")return this._resoveWorkspacePath(t)}}_resolveWorkspaceName(e){if(uA(e))return th(e.uri.path);let t=th(e.configPath.path);return t.endsWith(gA)&&(t=t.substr(0,t.length-gA.length-1)),t}_resoveWorkspacePath(e){if(uA(e))return e6(e.uri.fsPath);const t=th(e.configPath.path);let i=e.configPath.fsPath;return i.endsWith(t)&&(i=i.substr(0,i.length-t.length-1)),i?e6(i):"/"}}class r6{resolve(e){const{name:t}=e;if(t==="RANDOM")return Math.random().toString().slice(-6);if(t==="RANDOM_HEX")return Math.random().toString(16).slice(-6);if(t==="UUID")return mD()}}var rLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},aLe=function(o,e){return function(t,i){e(t,i,o)}},ia;const Dr=class Dr{constructor(e,t,i){this._editor=e,this._snippet=t,this._snippetLineLeadingWhitespace=i,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=f3(t.placeholders,tr.compareByIndex),this._placeholderGroupsIdx=-1}initialize(e){this._offset=e.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(this._offset===-1)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations(t=>{for(const i of this._snippet.placeholders){const n=this._snippet.offset(i),s=this._snippet.fullLen(i),r=L.fromPositions(e.getPositionAt(this._offset+n),e.getPositionAt(this._offset+n+s)),a=i.isFinalTabstop?Dr._decor.inactiveFinal:Dr._decor.inactive,l=t.addDecoration(r,a);this._placeholderDecorations.set(i,l)}})}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const n=[];for(const s of this._placeholderGroups[this._placeholderGroupsIdx])if(s.transform){const r=this._placeholderDecorations.get(s),a=this._editor.getModel().getDecorationRange(r),l=this._editor.getModel().getValueInRange(a),c=s.transform.resolve(l).split(/\r\n|\r|\n/);for(let d=1;d<c.length;d++)c[d]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+c[d]);n.push(si.replace(a,c.join(this._editor.getModel().getEOL())))}n.length>0&&this._editor.executeEdits("snippet.placeholderTransform",n)}let t=!1;e===!0&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):e===!1&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const i=this._editor.getModel().changeDecorations(n=>{const s=new Set,r=[];for(const a of this._placeholderGroups[this._placeholderGroupsIdx]){const l=this._placeholderDecorations.get(a),c=this._editor.getModel().getDecorationRange(l);r.push(new pe(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(a),n.changeDecorationOptions(l,a.isFinalTabstop?Dr._decor.activeFinal:Dr._decor.active),s.add(a);for(const d of this._snippet.enclosingPlaceholders(a)){const h=this._placeholderDecorations.get(d);n.changeDecorationOptions(h,d.isFinalTabstop?Dr._decor.activeFinal:Dr._decor.active),s.add(d)}}for(const[a,l]of this._placeholderDecorations)s.has(a)||n.changeDecorationOptions(l,a.isFinalTabstop?Dr._decor.inactiveFinal:Dr._decor.inactive);return r});return t?this.move(e):i??[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof tr){const i=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(i).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||this._placeholderGroups.length===0}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){if(this._snippet.placeholders.length===0)return!0;if(this._snippet.placeholders.length===1){const[e]=this._snippet.placeholders;if(e.isFinalTabstop&&this._snippet.rightMostDescendant===e)return!0}return!1}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let i;for(const n of t){if(n.isFinalTabstop)break;i||(i=[],e.set(n.index,i));const s=this._placeholderDecorations.get(n),r=this._editor.getModel().getDecorationRange(s);if(!r){e.delete(n.index);break}i.push(r)}}return e}get activeChoice(){if(!this._placeholderDecorations)return;const e=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!e?.choice)return;const t=this._placeholderDecorations.get(e);if(!t)return;const i=this._editor.getModel().getDecorationRange(t);if(i)return{range:i,choice:e.choice}}get hasChoice(){let e=!1;return this._snippet.walk(t=>(e=t instanceof xb,!e)),e}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations(i=>{for(const n of this._placeholderGroups[this._placeholderGroupsIdx]){const s=e.shift();console.assert(s._offset!==-1),console.assert(!s._placeholderDecorations);const r=s._snippet.placeholderInfo.last.index;for(const l of s._snippet.placeholderInfo.all)l.isFinalTabstop?l.index=n.index+(r+1)/this._nestingLevel:l.index=n.index+l.index/this._nestingLevel;this._snippet.replace(n,s._snippet.children);const a=this._placeholderDecorations.get(n);i.removeDecoration(a),this._placeholderDecorations.delete(n);for(const l of s._snippet.placeholders){const c=s._snippet.offset(l),d=s._snippet.fullLen(l),h=L.fromPositions(t.getPositionAt(s._offset+c),t.getPositionAt(s._offset+c+d)),u=i.addDecoration(h,Dr._decor.inactive);this._placeholderDecorations.set(l,u)}}this._placeholderGroups=f3(this._snippet.placeholders,tr.compareByIndex)})}};Dr._decor={active:Fe.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:Fe.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:Fe.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:Fe.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};let HL=Dr;const a6={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let zL=ia=class{static adjustWhitespace(e,t,i,n,s){const r=e.getLineContent(t.lineNumber),a=Tt(r,0,t.column-1);let l;return n.walk(c=>{if(!(c instanceof ss)||c.parent instanceof xb||s&&!s.has(c))return!0;const d=c.value.split(/\r\n|\r|\n/);if(i){const u=n.offset(c);if(u===0)d[0]=e.normalizeIndentation(d[0]);else{l=l??n.toString();const g=l.charCodeAt(u-1);(g===10||g===13)&&(d[0]=e.normalizeIndentation(a+d[0]))}for(let g=1;g<d.length;g++)d[g]=e.normalizeIndentation(a+d[g])}const h=d.join(e.getEOL());return h!==c.value&&(c.parent.replace(c,[new ss(h)]),l=void 0),!0}),a}static adjustSelection(e,t,i,n){if(i!==0||n!==0){const{positionLineNumber:s,positionColumn:r}=t,a=r-i,l=r+n,c=e.validateRange({startLineNumber:s,startColumn:a,endLineNumber:s,endColumn:l});t=pe.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,t.getDirection())}return t}static createEditsAndSnippetsFromSelections(e,t,i,n,s,r,a,l,c){const d=[],h=[];if(!e.hasModel())return{edits:d,snippets:h};const u=e.getModel(),g=e.invokeWithinContext(C=>C.get(Lf)),f=e.invokeWithinContext(C=>new n6(C.get(E_),u)),m=()=>a,_=u.getValueInRange(ia.adjustSelection(u,e.getSelection(),i,0)),b=u.getValueInRange(ia.adjustSelection(u,e.getSelection(),0,n)),v=u.getLineFirstNonWhitespaceColumn(e.getSelection().positionLineNumber),y=e.getSelections().map((C,w)=>({selection:C,idx:w})).sort((C,w)=>L.compareRangesUsingStarts(C.selection,w.selection));for(const{selection:C,idx:w}of y){let x=ia.adjustSelection(u,C,i,0),k=ia.adjustSelection(u,C,0,n);_!==u.getValueInRange(x)&&(x=C),b!==u.getValueInRange(k)&&(k=C);const E=C.setStartPosition(x.startLineNumber,x.startColumn).setEndPosition(k.endLineNumber,k.endColumn),N=new Pf().parse(t,!0,s),z=E.getStartPosition(),B=ia.adjustWhitespace(u,z,r||w>0&&v!==u.getLineFirstNonWhitespaceColumn(C.positionLineNumber),N);N.resolveVariables(new t6([f,new s6(m,w,y.length,e.getOption(79)==="spread"),new i6(u,C,w,l),new WL(u,C,c),new VL,new o6(g),new r6])),d[w]=si.replace(E,N.toString()),d[w].identifier={major:w,minor:0},d[w]._isTracked=!0,h[w]=new HL(e,N,B)}return{edits:d,snippets:h}}static createEditsAndSnippetsFromEdits(e,t,i,n,s,r,a){if(!e.hasModel()||t.length===0)return{edits:[],snippets:[]};const l=[],c=e.getModel(),d=new Pf,h=new Qw,u=new t6([e.invokeWithinContext(f=>new n6(f.get(E_),c)),new s6(()=>s,0,e.getSelections().length,e.getOption(79)==="spread"),new i6(c,e.getSelection(),0,r),new WL(c,e.getSelection(),a),new VL,new o6(e.invokeWithinContext(f=>f.get(Lf))),new r6]);t=t.sort((f,m)=>L.compareRangesUsingStarts(f.range,m.range));let g=0;for(let f=0;f<t.length;f++){const{range:m,template:_}=t[f];if(f>0){const w=t[f-1].range,x=L.fromPositions(w.getEndPosition(),m.getStartPosition()),k=new ss(c.getValueInRange(x));h.appendChild(k),g+=k.value.length}const b=d.parseFragment(_,h);ia.adjustWhitespace(c,m.getStartPosition(),!0,h,new Set(b)),h.resolveVariables(u);const v=h.toString(),y=v.slice(g);g=v.length;const C=si.replace(m,y);C.identifier={major:f,minor:0},C._isTracked=!0,l.push(C)}return d.ensureFinalTabstop(h,i,!0),{edits:l,snippets:[new HL(e,h,"")]}}constructor(e,t,i=a6,n){this._editor=e,this._template=t,this._options=i,this._languageConfigurationService=n,this._templateMerges=[],this._snippets=[]}dispose(){Dt(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:e,snippets:t}=typeof this._template=="string"?ia.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):ia.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=t,this._editor.executeEdits("snippet",e,i=>{const n=i.filter(s=>!!s.identifier);for(let s=0;s<t.length;s++)t[s].initialize(n[s].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):n.map(s=>pe.fromPositions(s.range.getEndPosition()))}),this._editor.revealRange(this._editor.getSelections()[0])}merge(e,t=a6){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,e]);const{edits:i,snippets:n}=ia.createEditsAndSnippetsFromSelections(this._editor,e,t.overwriteBefore,t.overwriteAfter,!0,t.adjustWhitespace,t.clipboardText,t.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",i,s=>{const r=s.filter(l=>!!l.identifier);for(let l=0;l<n.length;l++)n[l].initialize(r[l].textChange);const a=n[0].isTrivialSnippet;if(!a){for(const l of this._snippets)l.merge(n);console.assert(n.length===0)}return this._snippets[0].hasPlaceholder&&!a?this._move(void 0):r.map(l=>pe.fromPositions(l.range.getEndPosition()))})}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const i of this._snippets){const n=i.move(e);t.push(...n)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;const t=new Map;for(const i of this._snippets){const n=i.computePossibleSelections();if(t.size===0)for(const[s,r]of n){r.sort(L.compareRangesUsingStarts);for(const a of e)if(r[0].containsRange(a)){t.set(s,[]);break}}if(t.size===0)return!1;t.forEach((s,r)=>{s.push(...n.get(r))})}e.sort(L.compareRangesUsingStarts);for(const[i,n]of t){if(n.length!==e.length){t.delete(i);continue}n.sort(L.compareRangesUsingStarts);for(let s=0;s<n.length;s++)if(!n[s].containsRange(e[s])){t.delete(i);continue}}return t.size>0}};zL=ia=rLe([aLe(3,li)],zL);var lLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},m1=function(o,e){return function(t,i){e(t,i,o)}},Vp;const l6={overwriteBefore:0,overwriteAfter:0,undoStopBefore:!0,undoStopAfter:!0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};var vl;let ms=(vl=class{static get(e){return e.getContribution(Vp.ID)}constructor(e,t,i,n,s){this._editor=e,this._logService=t,this._languageFeaturesService=i,this._languageConfigurationService=s,this._snippetListener=new $,this._modelVersionId=-1,this._inSnippet=Vp.InSnippetMode.bindTo(n),this._hasNextTabstop=Vp.HasNextTabstop.bindTo(n),this._hasPrevTabstop=Vp.HasPrevTabstop.bindTo(n)}dispose(){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._session?.dispose(),this._snippetListener.dispose()}insert(e,t){try{this._doInsert(e,typeof t>"u"?l6:{...l6,...t})}catch(i){this.cancel(),this._logService.error(i),this._logService.error("snippet_error"),this._logService.error("insert_template=",e),this._logService.error("existing_template=",this._session?this._session._logInfo():"<no_session>")}}_doInsert(e,t){if(this._editor.hasModel()){if(this._snippetListener.clear(),t.undoStopBefore&&this._editor.getModel().pushStackElement(),this._session&&typeof e!="string"&&this.cancel(),this._session?(ut(typeof e=="string"),this._session.merge(e,t)):(this._modelVersionId=this._editor.getModel().getAlternativeVersionId(),this._session=new zL(this._editor,e,t,this._languageConfigurationService),this._session.insert()),t.undoStopAfter&&this._editor.getModel().pushStackElement(),this._session?.hasChoice){const i={_debugDisplayName:"snippetChoiceCompletions",provideCompletionItems:(c,d)=>{if(!this._session||c!==this._editor.getModel()||!A.equals(this._editor.getPosition(),d))return;const{activeChoice:h}=this._session;if(!h||h.choice.options.length===0)return;const u=c.getValueInRange(h.range),g=!!h.choice.options.find(m=>m.value===u),f=[];for(let m=0;m<h.choice.options.length;m++){const _=h.choice.options[m];f.push({kind:13,label:_.value,insertText:_.value,sortText:"a".repeat(m+1),range:h.range,filterText:g?`${u}_${_.value}`:void 0,command:{id:"jumpToNextSnippetPlaceholder",title:p("next","Go to next placeholder...")}})}return{suggestions:f}}},n=this._editor.getModel();let s,r=!1;const a=()=>{s?.dispose(),r=!1},l=()=>{r||(s=this._languageFeaturesService.completionProvider.register({language:n.getLanguageId(),pattern:n.uri.fsPath,scheme:n.uri.scheme,exclusive:!0},i),this._snippetListener.add(s),r=!0)};this._choiceCompletions={provider:i,enable:l,disable:a}}this._updateState(),this._snippetListener.add(this._editor.onDidChangeModelContent(i=>i.isFlush&&this.cancel())),this._snippetListener.add(this._editor.onDidChangeModel(()=>this.cancel())),this._snippetListener.add(this._editor.onDidChangeCursorSelection(()=>this._updateState()))}}_updateState(){if(!(!this._session||!this._editor.hasModel())){if(this._modelVersionId===this._editor.getModel().getAlternativeVersionId())return this.cancel();if(!this._session.hasPlaceholder)return this.cancel();if(this._session.isAtLastPlaceholder||!this._session.isSelectionWithinPlaceholders())return this._editor.getModel().pushStackElement(),this.cancel();this._inSnippet.set(!0),this._hasPrevTabstop.set(!this._session.isAtFirstPlaceholder),this._hasNextTabstop.set(!this._session.isAtLastPlaceholder),this._handleChoice()}}_handleChoice(){if(!this._session||!this._editor.hasModel()){this._currentChoice=void 0;return}const{activeChoice:e}=this._session;if(!e||!this._choiceCompletions){this._choiceCompletions?.disable(),this._currentChoice=void 0;return}this._currentChoice!==e.choice&&(this._currentChoice=e.choice,this._choiceCompletions.enable(),queueMicrotask(()=>{nLe(this._editor,this._choiceCompletions.provider)}))}finish(){for(;this._inSnippet.get();)this.next()}cancel(e=!1){this._inSnippet.reset(),this._hasPrevTabstop.reset(),this._hasNextTabstop.reset(),this._snippetListener.clear(),this._currentChoice=void 0,this._session?.dispose(),this._session=void 0,this._modelVersionId=-1,e&&this._editor.setSelections([this._editor.getSelection()])}prev(){this._session?.prev(),this._updateState()}next(){this._session?.next(),this._updateState()}isInSnippet(){return!!this._inSnippet.get()}},Vp=vl,vl.ID="snippetController2",vl.InSnippetMode=new re("inSnippetMode",!1,p("inSnippetMode","Whether the editor in current in snippet mode")),vl.HasNextTabstop=new re("hasNextTabstop",!1,p("hasNextTabstop","Whether there is a next tab stop when in snippet mode")),vl.HasPrevTabstop=new re("hasPrevTabstop",!1,p("hasPrevTabstop","Whether there is a previous tab stop when in snippet mode")),vl);ms=Vp=lLe([m1(1,Tn),m1(2,ue),m1(3,Ee),m1(4,li)],ms);at(ms.ID,ms,4);const ED=Hi.bindToContribution(ms.get);oe(new ED({id:"jumpToNextSnippetPlaceholder",precondition:K.and(ms.InSnippetMode,ms.HasNextTabstop),handler:o=>o.next(),kbOpts:{weight:130,kbExpr:T.textInputFocus,primary:2}}));oe(new ED({id:"jumpToPrevSnippetPlaceholder",precondition:K.and(ms.InSnippetMode,ms.HasPrevTabstop),handler:o=>o.prev(),kbOpts:{weight:130,kbExpr:T.textInputFocus,primary:1026}}));oe(new ED({id:"leaveSnippet",precondition:ms.InSnippetMode,handler:o=>o.cancel(!0),kbOpts:{weight:130,kbExpr:T.textInputFocus,primary:9,secondary:[1033]}}));oe(new ED({id:"acceptSnippet",precondition:ms.InSnippetMode,handler:o=>o.finish()}));var cLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},EN=function(o,e){return function(t,i){e(t,i,o)}};let M2=class extends F{get isAcceptingPartially(){return this._isAcceptingPartially}constructor(e,t,i,n,s,r,a,l,c,d,h,u){super(),this.textModel=e,this.selectedSuggestItem=t,this._textModelVersionId=i,this._positions=n,this._debounceValue=s,this._suggestPreviewEnabled=r,this._suggestPreviewMode=a,this._inlineSuggestMode=l,this._enabled=c,this._instantiationService=d,this._commandService=h,this._languageConfigurationService=u,this._source=this._register(this._instantiationService.createInstance(A2,this.textModel,this._textModelVersionId,this._debounceValue)),this._isActive=$e(this,!1),this._forceUpdateExplicitlySignal=gb(this),this._selectedInlineCompletionId=$e(this,void 0),this._primaryPosition=me(this,f=>this._positions.read(f)[0]??new A(1,1)),this._isAcceptingPartially=!1,this._preserveCurrentCompletionReasons=new Set([ac.Redo,ac.Undo,ac.AcceptWord]),this._fetchInlineCompletionsPromise=qG({owner:this,createEmptyChangeSummary:()=>({preserveCurrentCompletion:!1,inlineCompletionTriggerKind:wa.Automatic}),handleChange:(f,m)=>(f.didChange(this._textModelVersionId)&&this._preserveCurrentCompletionReasons.has(this._getReason(f.change))?m.preserveCurrentCompletion=!0:f.didChange(this._forceUpdateExplicitlySignal)&&(m.inlineCompletionTriggerKind=wa.Explicit),!0)},(f,m)=>{if(this._forceUpdateExplicitlySignal.read(f),!(this._enabled.read(f)&&this.selectedSuggestItem.read(f)||this._isActive.read(f))){this._source.cancelUpdate();return}this._textModelVersionId.read(f);const b=this._source.suggestWidgetInlineCompletions.get(),v=this.selectedSuggestItem.read(f);if(b&&!v){const k=this._source.inlineCompletions.get();oi(E=>{(!k||b.request.versionId>k.request.versionId)&&this._source.inlineCompletions.set(b.clone(),E),this._source.clearSuggestWidgetInlineCompletions(E)})}const y=this._primaryPosition.read(f),C={triggerKind:m.inlineCompletionTriggerKind,selectedSuggestionInfo:v?.toSelectedSuggestionInfo()},w=this.selectedInlineCompletion.get(),x=m.preserveCurrentCompletion||w?.forwardStable?w:void 0;return this._source.fetch(y,C,x)}),this._filteredInlineCompletionItems=Eo({owner:this,equalsFn:lx()},f=>{const m=this._source.inlineCompletions.read(f);if(!m)return[];const _=this._primaryPosition.read(f);return m.inlineCompletions.filter(v=>v.isVisible(this.textModel,_,f))}),this.selectedInlineCompletionIndex=me(this,f=>{const m=this._selectedInlineCompletionId.read(f),_=this._filteredInlineCompletionItems.read(f),b=this._selectedInlineCompletionId===void 0?-1:_.findIndex(v=>v.semanticId===m);return b===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):b}),this.selectedInlineCompletion=me(this,f=>{const m=this._filteredInlineCompletionItems.read(f),_=this.selectedInlineCompletionIndex.read(f);return m[_]}),this.activeCommands=Eo({owner:this,equalsFn:lx()},f=>this.selectedInlineCompletion.read(f)?.inlineCompletion.source.inlineCompletions.commands??[]),this.lastTriggerKind=this._source.inlineCompletions.map(this,f=>f?.request.context.triggerKind),this.inlineCompletionsCount=me(this,f=>{if(this.lastTriggerKind.read(f)===wa.Explicit)return this._filteredInlineCompletionItems.read(f).length}),this.state=Eo({owner:this,equalsFn:(f,m)=>!f||!m?f===m:G8(f.ghostTexts,m.ghostTexts)&&f.inlineCompletion===m.inlineCompletion&&f.suggestItem===m.suggestItem},f=>{const m=this.textModel,_=this.selectedSuggestItem.read(f);if(_){const b=mg(_.toSingleTextEdit(),m),v=this._computeAugmentation(b,f);if(!this._suggestPreviewEnabled.read(f)&&!v)return;const C=v?.edit??b,w=v?v.edit.text.length-b.text.length:0,x=this._suggestPreviewMode.read(f),k=this._positions.read(f),E=[C,...TN(this.textModel,k,C)],N=E.map((B,U)=>Z8(B,m,x,k[U],w)).filter(Sl),z=N[0]??new iw(C.range.endLineNumber,[]);return{edits:E,primaryGhostText:z,ghostTexts:N,inlineCompletion:v?.completion,suggestItem:_}}else{if(!this._isActive.read(f))return;const b=this.selectedInlineCompletion.read(f);if(!b)return;const v=b.toSingleTextEdit(f),y=this._inlineSuggestMode.read(f),C=this._positions.read(f),w=[v,...TN(this.textModel,C,v)],x=w.map((k,E)=>Z8(k,m,y,C[E],0)).filter(Sl);return x[0]?{edits:w,primaryGhostText:x[0],ghostTexts:x,inlineCompletion:b,suggestItem:void 0}:void 0}}),this.ghostTexts=Eo({owner:this,equalsFn:G8},f=>{const m=this.state.read(f);if(m)return m.ghostTexts}),this.primaryGhostText=Eo({owner:this,equalsFn:SZ},f=>{const m=this.state.read(f);if(m)return m?.primaryGhostText}),this._register(fb(this._fetchInlineCompletionsPromise));let g;this._register(Re(f=>{const _=this.state.read(f)?.inlineCompletion;if(_?.semanticId!==g?.semanticId&&(g=_,_)){const b=_.inlineCompletion,v=b.source;v.provider.handleItemDidShow?.(v.inlineCompletions,b.sourceInlineCompletion,b.insertText)}}))}_getReason(e){return e?.isUndoing?ac.Undo:e?.isRedoing?ac.Redo:this.isAcceptingPartially?ac.AcceptWord:ac.Other}async trigger(e){this._isActive.set(!0,e),await this._fetchInlineCompletionsPromise.get()}async triggerExplicitly(e){kf(e,t=>{this._isActive.set(!0,t),this._forceUpdateExplicitlySignal.trigger(t)}),await this._fetchInlineCompletionsPromise.get()}stop(e){kf(e,t=>{this._isActive.set(!1,t),this._source.clear(t)})}_computeAugmentation(e,t){const i=this.textModel,n=this._source.suggestWidgetInlineCompletions.read(t),s=n?n.inlineCompletions:[this.selectedInlineCompletion.read(t)].filter(Sl);return pie(s,a=>{let l=a.toSingleTextEdit(t);return l=mg(l,i,L.fromPositions(l.range.getStartPosition(),e.range.getEndPosition())),EZ(l,e)?{completion:a,edit:l}:void 0})}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineCompletionItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){if(e.getModel()!==this.textModel)throw new pt;const t=this.state.get();if(!t||t.primaryGhostText.isEmpty()||!t.inlineCompletion)return;const i=t.inlineCompletion.toInlineCompletion(void 0);if(i.command&&i.source.addRef(),e.pushUndoStop(),i.snippetInfo)e.executeEdits("inlineSuggestion.accept",[si.replace(i.range,""),...i.additionalTextEdits]),e.setPosition(i.snippetInfo.range.getStartPosition(),"inlineCompletionAccept"),ms.get(e)?.insert(i.snippetInfo.snippet,{undoStopBefore:!1});else{const n=t.edits,s=c6(n).map(r=>pe.fromPositions(r));e.executeEdits("inlineSuggestion.accept",[...n.map(r=>si.replace(r.range,r.text)),...i.additionalTextEdits]),e.setSelections(s,"inlineCompletionAccept")}this.stop(),i.command&&(await this._commandService.executeCommand(i.command.id,...i.command.arguments||[]).then(void 0,yi),i.source.removeRef())}async acceptNextWord(e){await this._acceptNext(e,(t,i)=>{const n=this.textModel.getLanguageIdAtPosition(t.lineNumber,t.column),s=this._languageConfigurationService.getLanguageConfiguration(n),r=new RegExp(s.wordDefinition.source,s.wordDefinition.flags.replace("g","")),a=i.match(r);let l=0;a&&a.index!==void 0?a.index===0?l=a[0].length:l=a.index:l=i.length;const d=/\s+/g.exec(i);return d&&d.index!==void 0&&d.index+d[0].length<l&&(l=d.index+d[0].length),l},0)}async acceptNextLine(e){await this._acceptNext(e,(t,i)=>{const n=i.match(/\n/);return n&&n.index!==void 0?n.index+1:i.length},1)}async _acceptNext(e,t,i){if(e.getModel()!==this.textModel)throw new pt;const n=this.state.get();if(!n||n.primaryGhostText.isEmpty()||!n.inlineCompletion)return;const s=n.primaryGhostText,r=n.inlineCompletion.toInlineCompletion(void 0);if(r.snippetInfo||r.filterText!==r.insertText){await this.accept(e);return}const a=s.parts[0],l=new A(s.lineNumber,a.column),c=a.text,d=t(l,c);if(d===c.length&&s.parts.length===1){this.accept(e);return}const h=c.substring(0,d),u=this._positions.get(),g=u[0];r.source.addRef();try{this._isAcceptingPartially=!0;try{e.pushUndoStop();const f=L.fromPositions(g,l),m=e.getModel().getValueInRange(f)+h,_=new Dl(f,m),b=[_,...TN(this.textModel,u,_)],v=c6(b).map(y=>pe.fromPositions(y));e.executeEdits("inlineSuggestion.accept",b.map(y=>si.replace(y.range,y.text))),e.setSelections(v,"inlineCompletionPartialAccept"),e.revealPositionInCenterIfOutsideViewport(e.getPosition(),1)}finally{this._isAcceptingPartially=!1}if(r.source.provider.handlePartialAccept){const f=L.fromPositions(r.range.getStartPosition(),Gr.ofText(h).addToPosition(l)),m=e.getModel().getValueInRange(f,1);r.source.provider.handlePartialAccept(r.source.inlineCompletions,r.sourceInlineCompletion,m.length,{kind:i})}}finally{r.source.removeRef()}}handleSuggestAccepted(e){const t=mg(e.toSingleTextEdit(),this.textModel),i=this._computeAugmentation(t,void 0);if(!i)return;const n=i.completion.inlineCompletion;n.source.provider.handlePartialAccept?.(n.source.inlineCompletions,n.sourceInlineCompletion,t.text.length,{kind:2})}};M2=cLe([EN(9,Ce),EN(10,Ft),EN(11,li)],M2);var ac;(function(o){o[o.Undo=0]="Undo",o[o.Redo=1]="Redo",o[o.AcceptWord=2]="AcceptWord",o[o.Other=3]="Other"})(ac||(ac={}));function TN(o,e,t){if(e.length===1)return[];const i=e[0],n=e.slice(1),s=t.range.getStartPosition(),r=t.range.getEndPosition(),a=o.getValueInRange(L.fromPositions(i,r)),l=$8(i,s);if(l.lineNumber<1)return Ae(new pt(`positionWithinTextEdit line number should be bigger than 0.
			Invalid subtraction between ${i.toString()} and ${s.toString()}`)),[];const c=dLe(t.text,l);return n.map(d=>{const h=Mxe($8(d,s),r),u=o.getValueInRange(L.fromPositions(d,h)),g=Dh(a,u),f=L.fromPositions(d,d.delta(0,g));return new Dl(f,c)})}function dLe(o,e){let t="";const i=zQ(o);for(let n=e.lineNumber-1;n<i.length;n++)t+=i[n].substring(n===e.lineNumber-1?e.column-1:0);return t}function c6(o){const e=f0.createSortPermutation(o,cs(s=>s.range,L.compareRangesUsingStarts)),i=new t5(e.apply(o)).getNewRanges();return e.inverse().apply(i).map(s=>s.getEndPosition())}var hLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},d6=function(o,e){return function(t,i){e(t,i,o)}},xv;class WW{constructor(e){this.name=e}select(e,t,i){if(i.length===0)return 0;const n=i[0].score[0];for(let s=0;s<i.length;s++){const{score:r,completion:a}=i[s];if(r[0]!==n)break;if(a.preselect)return s}return 0}}class h6 extends WW{constructor(){super("first")}memorize(e,t,i){}toJSON(){}fromJSON(){}}class uLe extends WW{constructor(){super("recentlyUsed"),this._cache=new Vl(300,.66),this._seq=0}memorize(e,t,i){const n=`${e.getLanguageId()}/${i.textLabel}`;this._cache.set(n,{touch:this._seq++,type:i.completion.kind,insertText:i.completion.insertText})}select(e,t,i){if(i.length===0)return 0;const n=e.getLineContent(t.lineNumber).substr(t.column-10,t.column-1);if(/\s$/.test(n))return super.select(e,t,i);const s=i[0].score[0];let r=-1,a=-1,l=-1;for(let c=0;c<i.length&&i[c].score[0]===s;c++){const d=`${e.getLanguageId()}/${i[c].textLabel}`,h=this._cache.peek(d);if(h&&h.touch>l&&h.type===i[c].completion.kind&&h.insertText===i[c].completion.insertText&&(l=h.touch,a=c),i[c].completion.preselect&&r===-1)return r=c}return a!==-1?a:r!==-1?r:0}toJSON(){return this._cache.toJSON()}fromJSON(e){this._cache.clear();const t=0;for(const[i,n]of e)n.touch=t,n.type=typeof n.type=="number"?n.type:GC.fromString(n.type),this._cache.set(i,n);this._seq=this._cache.size}}class gLe extends WW{constructor(){super("recentlyUsedByPrefix"),this._trie=Fm.forStrings(),this._seq=0}memorize(e,t,i){const{word:n}=e.getWordUntilPosition(t),s=`${e.getLanguageId()}/${n}`;this._trie.set(s,{type:i.completion.kind,insertText:i.completion.insertText,touch:this._seq++})}select(e,t,i){const{word:n}=e.getWordUntilPosition(t);if(!n)return super.select(e,t,i);const s=`${e.getLanguageId()}/${n}`;let r=this._trie.get(s);if(r||(r=this._trie.findSubstr(s)),r)for(let a=0;a<i.length;a++){const{kind:l,insertText:c}=i[a].completion;if(l===r.type&&c===r.insertText)return a}return super.select(e,t,i)}toJSON(){const e=[];return this._trie.forEach((t,i)=>e.push([i,t])),e.sort((t,i)=>-(t[1].touch-i[1].touch)).forEach((t,i)=>t[1].touch=i),e.slice(0,200)}fromJSON(e){if(this._trie.clear(),e.length>0){this._seq=e[0][1].touch+1;for(const[t,i]of e)i.type=typeof i.type=="number"?i.type:GC.fromString(i.type),this._trie.set(t,i)}}}var _h;let O2=(_h=class{constructor(e,t){this._storageService=e,this._configService=t,this._disposables=new $,this._persistSoon=new xt(()=>this._saveState(),500),this._disposables.add(e.onWillSaveState(i=>{i.reason===vy.SHUTDOWN&&this._saveState()}))}dispose(){this._disposables.dispose(),this._persistSoon.dispose()}memorize(e,t,i){this._withStrategy(e,t).memorize(e,t,i),this._persistSoon.schedule()}select(e,t,i){return this._withStrategy(e,t).select(e,t,i)}_withStrategy(e,t){const i=this._configService.getValue("editor.suggestSelection",{overrideIdentifier:e.getLanguageIdAtPosition(t.lineNumber,t.column),resource:e.uri});if(this._strategy?.name!==i){this._saveState();const n=xv._strategyCtors.get(i)||h6;this._strategy=new n;try{const r=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,a=this._storageService.get(`${xv._storagePrefix}/${i}`,r);a&&this._strategy.fromJSON(JSON.parse(a))}catch{}}return this._strategy}_saveState(){if(this._strategy){const t=this._configService.getValue("editor.suggest.shareSuggestSelections")?0:1,i=JSON.stringify(this._strategy);this._storageService.store(`${xv._storagePrefix}/${this._strategy.name}`,i,t,1)}}},xv=_h,_h._strategyCtors=new Map([["recentlyUsedByPrefix",gLe],["recentlyUsed",uLe],["first",h6]]),_h._storagePrefix="suggest/memories",_h);O2=xv=hLe([d6(0,Yr),d6(1,Ke)],O2);const TD=Je("ISuggestMemories");it(TD,O2,1);var fLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},pLe=function(o,e){return function(t,i){e(t,i,o)}},F2,Kg;let UL=(Kg=class{constructor(e,t){this._editor=e,this._enabled=!1,this._ckAtEnd=F2.AtEnd.bindTo(t),this._configListener=this._editor.onDidChangeConfiguration(i=>i.hasChanged(124)&&this._update()),this._update()}dispose(){this._configListener.dispose(),this._selectionListener?.dispose(),this._ckAtEnd.reset()}_update(){const e=this._editor.getOption(124)==="on";if(this._enabled!==e)if(this._enabled=e,this._enabled){const t=()=>{if(!this._editor.hasModel()){this._ckAtEnd.set(!1);return}const i=this._editor.getModel(),n=this._editor.getSelection(),s=i.getWordAtPosition(n.getStartPosition());if(!s){this._ckAtEnd.set(!1);return}this._ckAtEnd.set(s.endColumn===n.getStartPosition().column)};this._selectionListener=this._editor.onDidChangeCursorSelection(t),t()}else this._selectionListener&&(this._ckAtEnd.reset(),this._selectionListener.dispose(),this._selectionListener=void 0)}},F2=Kg,Kg.AtEnd=new re("atEndOfWord",!1),Kg);UL=F2=fLe([pLe(1,Ee)],UL);var mLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},_Le=function(o,e){return function(t,i){e(t,i,o)}},Lv,jg;let q_=(jg=class{constructor(e,t){this._editor=e,this._index=0,this._ckOtherSuggestions=Lv.OtherSuggestions.bindTo(t)}dispose(){this.reset()}reset(){this._ckOtherSuggestions.reset(),this._listener?.dispose(),this._model=void 0,this._acceptNext=void 0,this._ignore=!1}set({model:e,index:t},i){if(e.items.length===0){this.reset();return}if(Lv._moveIndex(!0,e,t)===t){this.reset();return}this._acceptNext=i,this._model=e,this._index=t,this._listener=this._editor.onDidChangeCursorPosition(()=>{this._ignore||this.reset()}),this._ckOtherSuggestions.set(!0)}static _moveIndex(e,t,i){let n=i;for(let s=t.items.length;s>0&&(n=(n+t.items.length+(e?1:-1))%t.items.length,!(n===i||!t.items[n].completion.additionalTextEdits));s--);return n}next(){this._move(!0)}prev(){this._move(!1)}_move(e){if(this._model)try{this._ignore=!0,this._index=Lv._moveIndex(e,this._model,this._index),this._acceptNext({index:this._index,item:this._model.items[this._index],model:this._model})}finally{this._ignore=!1}}},Lv=jg,jg.OtherSuggestions=new re("hasOtherSuggestions",!1),jg);q_=Lv=mLe([_Le(1,Ee)],q_);class bLe{constructor(e,t,i,n){this._disposables=new $,this._disposables.add(i.onDidSuggest(s=>{s.completionModel.items.length===0&&this.reset()})),this._disposables.add(i.onDidCancel(s=>{this.reset()})),this._disposables.add(t.onDidShow(()=>this._onItem(t.getFocusedItem()))),this._disposables.add(t.onDidFocus(this._onItem,this)),this._disposables.add(t.onDidHide(this.reset,this)),this._disposables.add(e.onWillType(s=>{if(this._active&&!t.isFrozen()&&i.state!==0){const r=s.charCodeAt(s.length-1);this._active.acceptCharacters.has(r)&&e.getOption(0)&&n(this._active.item)}}))}_onItem(e){if(!e||!Yn(e.item.completion.commitCharacters)){this.reset();return}if(this._active&&this._active.item.item===e.item)return;const t=new V0;for(const i of e.item.completion.commitCharacters)i.length>0&&t.add(i.charCodeAt(0));this._active={acceptCharacters:t,item:e}}reset(){this._active=void 0}dispose(){this._disposables.dispose()}}const Xo=class Xo{async provideSelectionRanges(e,t){const i=[];for(const n of t){const s=[];i.push(s);const r=new Map;await new Promise(a=>Xo._bracketsRightYield(a,0,e,n,r)),await new Promise(a=>Xo._bracketsLeftYield(a,0,e,n,r,s))}return i}static _bracketsRightYield(e,t,i,n,s){const r=new Map,a=Date.now();for(;;){if(t>=Xo._maxRounds){e();break}if(!n){e();break}const l=i.bracketPairs.findNextBracket(n);if(!l){e();break}if(Date.now()-a>Xo._maxDuration){setTimeout(()=>Xo._bracketsRightYield(e,t+1,i,n,s));break}if(l.bracketInfo.isOpeningBracket){const d=l.bracketInfo.bracketText,h=r.has(d)?r.get(d):0;r.set(d,h+1)}else{const d=l.bracketInfo.getOpeningBrackets()[0].bracketText;let h=r.has(d)?r.get(d):0;if(h-=1,r.set(d,Math.max(0,h)),h<0){let u=s.get(d);u||(u=new os,s.set(d,u)),u.push(l.range)}}n=l.range.getEndPosition()}}static _bracketsLeftYield(e,t,i,n,s,r){const a=new Map,l=Date.now();for(;;){if(t>=Xo._maxRounds&&s.size===0){e();break}if(!n){e();break}const c=i.bracketPairs.findPrevBracket(n);if(!c){e();break}if(Date.now()-l>Xo._maxDuration){setTimeout(()=>Xo._bracketsLeftYield(e,t+1,i,n,s,r));break}if(c.bracketInfo.isOpeningBracket){const h=c.bracketInfo.bracketText;let u=a.has(h)?a.get(h):0;if(u-=1,a.set(h,Math.max(0,u)),u<0){const g=s.get(h);if(g){const f=g.shift();g.size===0&&s.delete(h);const m=L.fromPositions(c.range.getEndPosition(),f.getStartPosition()),_=L.fromPositions(c.range.getStartPosition(),f.getEndPosition());r.push({range:m}),r.push({range:_}),Xo._addBracketLeading(i,_,r)}}}else{const h=c.bracketInfo.getOpeningBrackets()[0].bracketText,u=a.has(h)?a.get(h):0;a.set(h,u+1)}n=c.range.getStartPosition()}}static _addBracketLeading(e,t,i){if(t.startLineNumber===t.endLineNumber)return;const n=t.startLineNumber,s=e.getLineFirstNonWhitespaceColumn(n);s!==0&&s!==t.startColumn&&(i.push({range:L.fromPositions(new A(n,s),t.getEndPosition())}),i.push({range:L.fromPositions(new A(n,1),t.getEndPosition())}));const r=n-1;if(r>0){const a=e.getLineFirstNonWhitespaceColumn(r);a===t.startColumn&&a!==e.getLineLastNonWhitespaceColumn(r)&&(i.push({range:L.fromPositions(new A(r,a),t.getEndPosition())}),i.push({range:L.fromPositions(new A(r,1),t.getEndPosition())}))}}};Xo._maxDuration=30,Xo._maxRounds=2;let GL=Xo;const al=class al{static async create(e,t){if(!t.getOption(119).localityBonus||!t.hasModel())return al.None;const i=t.getModel(),n=t.getPosition();if(!e.canComputeWordRanges(i.uri))return al.None;const[s]=await new GL().provideSelectionRanges(i,[n]);if(s.length===0)return al.None;const r=await e.computeWordRanges(i.uri,s[0].range);if(!r)return al.None;const a=i.getWordUntilPosition(n);return delete r[a.word],new class extends al{distance(l,c){if(!n.equals(t.getPosition()))return 0;if(c.kind===17)return 2<<20;const d=typeof c.label=="string"?c.label:c.label.label,h=r[d];if(U6(h))return 2<<20;const u=BC(h,L.fromPositions(l),L.compareRangesUsingStarts),g=u>=0?h[u]:h[Math.max(0,~u-1)];let f=s.length;for(const m of s){if(!L.containsRange(m.range,g))break;f-=1}return f}}}};al.None=new class extends al{distance(){return 0}};let $L=al,u6=class{constructor(e,t){this.leadingLineContent=e,this.characterCountDelta=t}};class Bd{constructor(e,t,i,n,s,r,a=uy.default,l=void 0){this.clipboardText=l,this._snippetCompareFn=Bd._compareCompletionItems,this._items=e,this._column=t,this._wordDistance=n,this._options=s,this._refilterKind=1,this._lineContext=i,this._fuzzyScoreOptions=a,r==="top"?this._snippetCompareFn=Bd._compareCompletionItemsSnippetsUp:r==="bottom"&&(this._snippetCompareFn=Bd._compareCompletionItemsSnippetsDown)}get lineContext(){return this._lineContext}set lineContext(e){(this._lineContext.leadingLineContent!==e.leadingLineContent||this._lineContext.characterCountDelta!==e.characterCountDelta)&&(this._refilterKind=this._lineContext.characterCountDelta<e.characterCountDelta&&this._filteredItems?2:1,this._lineContext=e)}get items(){return this._ensureCachedState(),this._filteredItems}getItemsByProvider(){return this._ensureCachedState(),this._itemsByProvider}getIncompleteProvider(){this._ensureCachedState();const e=new Set;for(const[t,i]of this.getItemsByProvider())i.length>0&&i[0].container.incomplete&&e.add(t);return e}get stats(){return this._ensureCachedState(),this._stats}_ensureCachedState(){this._refilterKind!==0&&this._createCachedState()}_createCachedState(){this._itemsByProvider=new Map;const e=[],{leadingLineContent:t,characterCountDelta:i}=this._lineContext;let n="",s="";const r=this._refilterKind===1?this._items:this._filteredItems,a=[],l=!this._options.filterGraceful||r.length>2e3?xf:rre;for(let c=0;c<r.length;c++){const d=r[c];if(d.isInvalid)continue;const h=this._itemsByProvider.get(d.provider);h?h.push(d):this._itemsByProvider.set(d.provider,[d]);const u=d.position.column-d.editStart.column,g=u+i-(d.position.column-this._column);if(n.length!==g&&(n=g===0?"":t.slice(-g),s=n.toLowerCase()),d.word=n,g===0)d.score=ka.Default;else{let f=0;for(;f<u;){const m=n.charCodeAt(f);if(m===32||m===9)f+=1;else break}if(f>=g)d.score=ka.Default;else if(typeof d.completion.filterText=="string"){const m=l(n,s,f,d.completion.filterText,d.filterTextLow,0,this._fuzzyScoreOptions);if(!m)continue;eP(d.completion.filterText,d.textLabel)===0?d.score=m:(d.score=ire(n,s,f,d.textLabel,d.labelLow,0),d.score[0]=m[0])}else{const m=l(n,s,f,d.textLabel,d.labelLow,0,this._fuzzyScoreOptions);if(!m)continue;d.score=m}}d.idx=c,d.distance=this._wordDistance.distance(d.position,d.completion),a.push(d),e.push(d.textLabel.length)}this._filteredItems=a.sort(this._snippetCompareFn),this._refilterKind=0,this._stats={pLabelLen:e.length?$N(e.length-.85,e,(c,d)=>c-d):0}}static _compareCompletionItems(e,t){return e.score[0]>t.score[0]?-1:e.score[0]<t.score[0]?1:e.distance<t.distance?-1:e.distance>t.distance?1:e.idx<t.idx?-1:e.idx>t.idx?1:0}static _compareCompletionItemsSnippetsDown(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return 1;if(t.completion.kind===27)return-1}return Bd._compareCompletionItems(e,t)}static _compareCompletionItemsSnippetsUp(e,t){if(e.completion.kind!==t.completion.kind){if(e.completion.kind===27)return-1;if(t.completion.kind===27)return 1}return Bd._compareCompletionItems(e,t)}}var vLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},bd=function(o,e){return function(t,i){e(t,i,o)}},B2;class bu{static shouldAutoTrigger(e){if(!e.hasModel())return!1;const t=e.getModel(),i=e.getPosition();t.tokenization.tokenizeIfCheap(i.lineNumber);const n=t.getWordAtPosition(i);return!(!n||n.endColumn!==i.column&&n.startColumn+1!==i.column||!isNaN(Number(n.word)))}constructor(e,t,i){this.leadingLineContent=e.getLineContent(t.lineNumber).substr(0,t.column-1),this.leadingWord=e.getWordUntilPosition(t),this.lineNumber=t.lineNumber,this.column=t.column,this.triggerOptions=i}}function CLe(o,e,t){if(!e.getContextKeyValue(oo.inlineSuggestionVisible.key))return!0;const i=e.getContextKeyValue(oo.suppressSuggestions.key);return i!==void 0?!i:!o.getOption(62).suppressSuggestions}function yLe(o,e,t){if(!e.getContextKeyValue("inlineSuggestionVisible"))return!0;const i=e.getContextKeyValue(oo.suppressSuggestions.key);return i!==void 0?!i:!o.getOption(62).suppressSuggestions}let KL=B2=class{constructor(e,t,i,n,s,r,a,l,c){this._editor=e,this._editorWorkerService=t,this._clipboardService=i,this._telemetryService=n,this._logService=s,this._contextKeyService=r,this._configurationService=a,this._languageFeaturesService=l,this._envService=c,this._toDispose=new $,this._triggerCharacterListener=new $,this._triggerQuickSuggest=new qr,this._triggerState=void 0,this._completionDisposables=new $,this._onDidCancel=new O,this._onDidTrigger=new O,this._onDidSuggest=new O,this.onDidCancel=this._onDidCancel.event,this.onDidTrigger=this._onDidTrigger.event,this.onDidSuggest=this._onDidSuggest.event,this._telemetryGate=0,this._currentSelection=this._editor.getSelection()||new pe(1,1,1,1),this._toDispose.add(this._editor.onDidChangeModel(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeModelLanguage(()=>{this._updateTriggerCharacters(),this.cancel()})),this._toDispose.add(this._editor.onDidChangeConfiguration(()=>{this._updateTriggerCharacters()})),this._toDispose.add(this._languageFeaturesService.completionProvider.onDidChange(()=>{this._updateTriggerCharacters(),this._updateActiveSuggestSession()}));let d=!1;this._toDispose.add(this._editor.onDidCompositionStart(()=>{d=!0})),this._toDispose.add(this._editor.onDidCompositionEnd(()=>{d=!1,this._onCompositionEnd()})),this._toDispose.add(this._editor.onDidChangeCursorSelection(h=>{d||this._onCursorChange(h)})),this._toDispose.add(this._editor.onDidChangeModelContent(()=>{!d&&this._triggerState!==void 0&&this._refilterCompletionItems()})),this._updateTriggerCharacters()}dispose(){Dt(this._triggerCharacterListener),Dt([this._onDidCancel,this._onDidSuggest,this._onDidTrigger,this._triggerQuickSuggest]),this._toDispose.dispose(),this._completionDisposables.dispose(),this.cancel()}_updateTriggerCharacters(){if(this._triggerCharacterListener.clear(),this._editor.getOption(92)||!this._editor.hasModel()||!this._editor.getOption(122))return;const e=new Map;for(const i of this._languageFeaturesService.completionProvider.all(this._editor.getModel()))for(const n of i.triggerCharacters||[]){let s=e.get(n);s||(s=new Set,e.set(n,s)),s.add(i)}const t=i=>{if(!yLe(this._editor,this._contextKeyService,this._configurationService)||bu.shouldAutoTrigger(this._editor))return;if(!i){const r=this._editor.getPosition();i=this._editor.getModel().getLineContent(r.lineNumber).substr(0,r.column-1)}let n="";_f(i.charCodeAt(i.length-1))?$i(i.charCodeAt(i.length-2))&&(n=i.substr(i.length-2)):n=i.charAt(i.length-1);const s=e.get(n);if(s){const r=new Map;if(this._completionModel)for(const[a,l]of this._completionModel.getItemsByProvider())s.has(a)||r.set(a,l);this.trigger({auto:!0,triggerKind:1,triggerCharacter:n,retrigger:!!this._completionModel,clipboardText:this._completionModel?.clipboardText,completionOptions:{providerFilter:s,providerItemsToReuse:r}})}};this._triggerCharacterListener.add(this._editor.onDidType(t)),this._triggerCharacterListener.add(this._editor.onDidCompositionEnd(()=>t()))}get state(){return this._triggerState?this._triggerState.auto?2:1:0}cancel(e=!1){this._triggerState!==void 0&&(this._triggerQuickSuggest.cancel(),this._requestToken?.cancel(),this._requestToken=void 0,this._triggerState=void 0,this._completionModel=void 0,this._context=void 0,this._onDidCancel.fire({retrigger:e}))}clear(){this._completionDisposables.clear()}_updateActiveSuggestSession(){this._triggerState!==void 0&&(!this._editor.hasModel()||!this._languageFeaturesService.completionProvider.has(this._editor.getModel())?this.cancel():this.trigger({auto:this._triggerState.auto,retrigger:!0}))}_onCursorChange(e){if(!this._editor.hasModel())return;const t=this._currentSelection;if(this._currentSelection=this._editor.getSelection(),!e.selection.isEmpty()||e.reason!==0&&e.reason!==3||e.source!=="keyboard"&&e.source!=="deleteLeft"){this.cancel();return}this._triggerState===void 0&&e.reason===0?(t.containsRange(this._currentSelection)||t.getEndPosition().isBeforeOrEqual(this._currentSelection.getPosition()))&&this._doTriggerQuickSuggest():this._triggerState!==void 0&&e.reason===3&&this._refilterCompletionItems()}_onCompositionEnd(){this._triggerState===void 0?this._doTriggerQuickSuggest():this._refilterCompletionItems()}_doTriggerQuickSuggest(){dm.isAllOff(this._editor.getOption(90))||this._editor.getOption(119).snippetsPreventQuickSuggestions&&ms.get(this._editor)?.isInSnippet()||(this.cancel(),this._triggerQuickSuggest.cancelAndSet(()=>{if(this._triggerState!==void 0||!bu.shouldAutoTrigger(this._editor)||!this._editor.hasModel()||!this._editor.hasWidgetFocus())return;const e=this._editor.getModel(),t=this._editor.getPosition(),i=this._editor.getOption(90);if(!dm.isAllOff(i)){if(!dm.isAllOn(i)){e.tokenization.tokenizeIfCheap(t.lineNumber);const n=e.tokenization.getLineTokens(t.lineNumber),s=n.getStandardTokenType(n.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(dm.valueFor(i,s)!=="on")return}CLe(this._editor,this._contextKeyService,this._configurationService)&&this._languageFeaturesService.completionProvider.has(e)&&this.trigger({auto:!0})}},this._editor.getOption(91)))}_refilterCompletionItems(){ut(this._editor.hasModel()),ut(this._triggerState!==void 0);const e=this._editor.getModel(),t=this._editor.getPosition(),i=new bu(e,t,{...this._triggerState,refilter:!0});this._onNewContext(i)}trigger(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=new bu(t,this._editor.getPosition(),e);this.cancel(e.retrigger),this._triggerState=e,this._onDidTrigger.fire({auto:e.auto,shy:e.shy??!1,position:this._editor.getPosition()}),this._context=i;let n={triggerKind:e.triggerKind??0};e.triggerCharacter&&(n={triggerKind:1,triggerCharacter:e.triggerCharacter}),this._requestToken=new ri;const s=this._editor.getOption(113);let r=1;switch(s){case"top":r=0;break;case"bottom":r=2;break}const{itemKind:a,showDeprecated:l}=B2.createSuggestFilter(this._editor),c=new nw(r,e.completionOptions?.kindFilter??a,e.completionOptions?.providerFilter,e.completionOptions?.providerItemsToReuse,l),d=$L.create(this._editorWorkerService,this._editor),h=FW(this._languageFeaturesService.completionProvider,t,this._editor.getPosition(),c,n,this._requestToken.token);Promise.all([h,d]).then(async([u,g])=>{if(this._requestToken?.dispose(),!this._editor.hasModel())return;let f=e?.clipboardText;if(!f&&u.needsClipboard&&(f=await this._clipboardService.readText()),this._triggerState===void 0)return;const m=this._editor.getModel(),_=new bu(m,this._editor.getPosition(),e),b={...uy.default,firstMatchCanBeWeak:!this._editor.getOption(119).matchOnWordStartOnly};if(this._completionModel=new Bd(u.items,this._context.column,{leadingLineContent:_.leadingLineContent,characterCountDelta:_.column-this._context.column},g,this._editor.getOption(119),this._editor.getOption(113),b,f),this._completionDisposables.add(u.disposable),this._onNewContext(_),this._reportDurationsTelemetry(u.durations),!this._envService.isBuilt||this._envService.isExtensionDevelopment)for(const v of u.items)v.isInvalid&&this._logService.warn(`[suggest] did IGNORE invalid completion item from ${v.provider._debugDisplayName}`,v.completion)}).catch(Ae)}_reportDurationsTelemetry(e){this._telemetryGate++%230===0&&setTimeout(()=>{this._telemetryService.publicLog2("suggest.durations.json",{data:JSON.stringify(e)}),this._logService.debug("suggest.durations.json",e)})}static createSuggestFilter(e){const t=new Set;e.getOption(113)==="none"&&t.add(27);const n=e.getOption(119);return n.showMethods||t.add(0),n.showFunctions||t.add(1),n.showConstructors||t.add(2),n.showFields||t.add(3),n.showVariables||t.add(4),n.showClasses||t.add(5),n.showStructs||t.add(6),n.showInterfaces||t.add(7),n.showModules||t.add(8),n.showProperties||t.add(9),n.showEvents||t.add(10),n.showOperators||t.add(11),n.showUnits||t.add(12),n.showValues||t.add(13),n.showConstants||t.add(14),n.showEnums||t.add(15),n.showEnumMembers||t.add(16),n.showKeywords||t.add(17),n.showWords||t.add(18),n.showColors||t.add(19),n.showFiles||t.add(20),n.showReferences||t.add(21),n.showColors||t.add(22),n.showFolders||t.add(23),n.showTypeParameters||t.add(24),n.showSnippets||t.add(27),n.showUsers||t.add(25),n.showIssues||t.add(26),{itemKind:t,showDeprecated:n.showDeprecated}}_onNewContext(e){if(this._context){if(e.lineNumber!==this._context.lineNumber){this.cancel();return}if(Tt(e.leadingLineContent)!==Tt(this._context.leadingLineContent)){this.cancel();return}if(e.column<this._context.column){e.leadingWord.word?this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0}):this.cancel();return}if(this._completionModel){if(e.leadingWord.word.length!==0&&e.leadingWord.startColumn>this._context.leadingWord.startColumn){if(bu.shouldAutoTrigger(this._editor)&&this._context){const i=this._completionModel.getItemsByProvider();this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerItemsToReuse:i}})}return}if(e.column>this._context.column&&this._completionModel.getIncompleteProvider().size>0&&e.leadingWord.word.length!==0){const t=new Map,i=new Set;for(const[n,s]of this._completionModel.getItemsByProvider())s.length>0&&s[0].container.incomplete?i.add(n):t.set(n,s);this.trigger({auto:this._context.triggerOptions.auto,triggerKind:2,retrigger:!0,clipboardText:this._completionModel.clipboardText,completionOptions:{providerFilter:i,providerItemsToReuse:t}})}else{const t=this._completionModel.lineContext;let i=!1;if(this._completionModel.lineContext={leadingLineContent:e.leadingLineContent,characterCountDelta:e.column-this._context.column},this._completionModel.items.length===0){const n=bu.shouldAutoTrigger(this._editor);if(!this._context){this.cancel();return}if(n&&this._context.leadingWord.endColumn<e.leadingWord.startColumn){this.trigger({auto:this._context.triggerOptions.auto,retrigger:!0});return}if(this._context.triggerOptions.auto){this.cancel();return}else if(this._completionModel.lineContext=t,i=this._completionModel.items.length>0,i&&e.leadingWord.word.length===0){this.cancel();return}}this._onDidSuggest.fire({completionModel:this._completionModel,triggerOptions:e.triggerOptions,isFrozen:i})}}}}};KL=B2=vLe([bd(1,Bs),bd(2,ad),bd(3,Fn),bd(4,Tn),bd(5,Ee),bd(6,Ke),bd(7,ue),bd(8,o5)],KL);const vE=class vE{constructor(e,t){this._disposables=new $,this._lastOvertyped=[],this._locked=!1,this._disposables.add(e.onWillType(()=>{if(this._locked||!e.hasModel())return;const i=e.getSelections(),n=i.length;let s=!1;for(let a=0;a<n;a++)if(!i[a].isEmpty()){s=!0;break}if(!s){this._lastOvertyped.length!==0&&(this._lastOvertyped.length=0);return}this._lastOvertyped=[];const r=e.getModel();for(let a=0;a<n;a++){const l=i[a];if(r.getValueLengthInRange(l)>vE._maxSelectionLength)return;this._lastOvertyped[a]={value:r.getValueInRange(l),multiline:l.startLineNumber!==l.endLineNumber}}})),this._disposables.add(t.onDidTrigger(i=>{this._locked=!0})),this._disposables.add(t.onDidCancel(i=>{this._locked=!1}))}getLastOvertypedInfo(e){if(e>=0&&e<this._lastOvertyped.length)return this._lastOvertyped[e]}dispose(){this._disposables.dispose()}};vE._maxSelectionLength=51200;let W2=vE;var wLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},DN=function(o,e){return function(t,i){e(t,i,o)}};let V2=class{constructor(e,t,i,n,s){this._menuId=t,this._menuService=n,this._contextKeyService=s,this._menuDisposables=new $,this.element=Y(e,ie(".suggest-status-bar"));const r=a=>a instanceof io?i.createInstance(F5,a,{useComma:!0}):void 0;this._leftActions=new Oo(this.element,{actionViewItemProvider:r}),this._rightActions=new Oo(this.element,{actionViewItemProvider:r}),this._leftActions.domNode.classList.add("left"),this._rightActions.domNode.classList.add("right")}dispose(){this._menuDisposables.dispose(),this._leftActions.dispose(),this._rightActions.dispose(),this.element.remove()}show(){const e=this._menuService.createMenu(this._menuId,this._contextKeyService),t=()=>{const i=[],n=[];for(const[s,r]of e.getActions())s==="left"?i.push(...r):n.push(...r);this._leftActions.clear(),this._leftActions.push(i),this._rightActions.clear(),this._rightActions.push(n)};this._menuDisposables.add(e.onDidChange(()=>t())),this._menuDisposables.add(e)}hide(){this._menuDisposables.clear()}};V2=wLe([DN(2,Ce),DN(3,zo),DN(4,Ee)],V2);var SLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},xLe=function(o,e){return function(t,i){e(t,i,o)}};function VW(o){return!!o&&!!(o.completion.documentation||o.completion.detail&&o.completion.detail!==o.completion.label)}let H2=class{constructor(e,t){this._editor=e,this._onDidClose=new O,this.onDidClose=this._onDidClose.event,this._onDidChangeContents=new O,this.onDidChangeContents=this._onDidChangeContents.event,this._disposables=new $,this._renderDisposeable=new $,this._borderWidth=1,this._size=new wt(330,0),this.domNode=ie(".suggest-details"),this.domNode.classList.add("no-docs"),this._markdownRenderer=t.createInstance(Zc,{editor:e}),this._body=ie(".body"),this._scrollbar=new Iw(this._body,{alwaysConsumeMouseWheel:!0}),Y(this.domNode,this._scrollbar.getDomNode()),this._disposables.add(this._scrollbar),this._header=Y(this._body,ie(".header")),this._close=Y(this._header,ie("span"+ke.asCSSSelector(J.close))),this._close.title=p("details.close","Close"),this._type=Y(this._header,ie("p.type")),this._docs=Y(this._body,ie("p.docs")),this._configureFont(),this._disposables.add(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(50)&&this._configureFont()}))}dispose(){this._disposables.dispose(),this._renderDisposeable.dispose()}_configureFont(){const e=this._editor.getOptions(),t=e.get(50),i=t.getMassagedFontFamily(),n=e.get(120)||t.fontSize,s=e.get(121)||t.lineHeight,r=t.fontWeight,a=`${n}px`,l=`${s}px`;this.domNode.style.fontSize=a,this.domNode.style.lineHeight=`${s/n}`,this.domNode.style.fontWeight=r,this.domNode.style.fontFeatureSettings=t.fontFeatureSettings,this._type.style.fontFamily=i,this._close.style.height=l,this._close.style.width=l}getLayoutInfo(){const e=this._editor.getOption(121)||this._editor.getOption(50).lineHeight,t=this._borderWidth,i=t*2;return{lineHeight:e,borderWidth:t,borderHeight:i,verticalPadding:22,horizontalPadding:14}}renderLoading(){this._type.textContent=p("loading","Loading..."),this._docs.textContent="",this.domNode.classList.remove("no-docs","no-type"),this.layout(this.size.width,this.getLayoutInfo().lineHeight*2),this._onDidChangeContents.fire(this)}renderItem(e,t){this._renderDisposeable.clear();let{detail:i,documentation:n}=e.completion;if(t){let s="";s+=`score: ${e.score[0]}
`,s+=`prefix: ${e.word??"(no prefix)"}
`,s+=`word: ${e.completion.filterText?e.completion.filterText+" (filterText)":e.textLabel}
`,s+=`distance: ${e.distance} (localityBonus-setting)
`,s+=`index: ${e.idx}, based on ${e.completion.sortText&&`sortText: "${e.completion.sortText}"`||"label"}
`,s+=`commit_chars: ${e.completion.commitCharacters?.join("")}
`,n=new Pn().appendCodeblock("empty",s),i=`Provider: ${e.provider._debugDisplayName}`}if(!t&&!VW(e)){this.clearContents();return}if(this.domNode.classList.remove("no-docs","no-type"),i){const s=i.length>1e5?`${i.substr(0,1e5)}…`:i;this._type.textContent=s,this._type.title=s,Ys(this._type),this._type.classList.toggle("auto-wrap",!/\r?\n^\s+/gmi.test(s))}else fn(this._type),this._type.title="",is(this._type),this.domNode.classList.add("no-type");if(fn(this._docs),typeof n=="string")this._docs.classList.remove("markdown-docs"),this._docs.textContent=n;else if(n){this._docs.classList.add("markdown-docs"),fn(this._docs);const s=this._markdownRenderer.render(n);this._docs.appendChild(s.element),this._renderDisposeable.add(s),this._renderDisposeable.add(this._markdownRenderer.onDidRenderAsync(()=>{this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}))}this.domNode.style.userSelect="text",this.domNode.tabIndex=-1,this._close.onmousedown=s=>{s.preventDefault(),s.stopPropagation()},this._close.onclick=s=>{s.preventDefault(),s.stopPropagation(),this._onDidClose.fire()},this._body.scrollTop=0,this.layout(this._size.width,this._type.clientHeight+this._docs.clientHeight),this._onDidChangeContents.fire(this)}clearContents(){this.domNode.classList.add("no-docs"),this._type.textContent="",this._docs.textContent=""}get isEmpty(){return this.domNode.classList.contains("no-docs")}get size(){return this._size}layout(e,t){const i=new wt(e,t);wt.equals(i,this._size)||(this._size=i,qJ(this.domNode,e,t)),this._scrollbar.scanDomNode()}scrollDown(e=8){this._body.scrollTop+=e}scrollUp(e=8){this._body.scrollTop-=e}scrollTop(){this._body.scrollTop=0}scrollBottom(){this._body.scrollTop=this._body.scrollHeight}pageDown(){this.scrollDown(80)}pageUp(){this.scrollUp(80)}set borderWidth(e){this._borderWidth=e}get borderWidth(){return this._borderWidth}};H2=SLe([xLe(1,Ce)],H2);class LLe{constructor(e,t){this.widget=e,this._editor=t,this.allowEditorOverflow=!0,this._disposables=new $,this._added=!1,this._preferAlignAtTop=!0,this._resizable=new vW,this._resizable.domNode.classList.add("suggest-details-container"),this._resizable.domNode.appendChild(e.domNode),this._resizable.enableSashes(!1,!0,!0,!1);let i,n,s=0,r=0;this._disposables.add(this._resizable.onDidWillResize(()=>{i=this._topLeft,n=this._resizable.size})),this._disposables.add(this._resizable.onDidResize(a=>{if(i&&n){this.widget.layout(a.dimension.width,a.dimension.height);let l=!1;a.west&&(r=n.width-a.dimension.width,l=!0),a.north&&(s=n.height-a.dimension.height,l=!0),l&&this._applyTopLeft({top:i.top+s,left:i.left+r})}a.done&&(i=void 0,n=void 0,s=0,r=0,this._userSize=a.dimension)})),this._disposables.add(this.widget.onDidChangeContents(()=>{this._anchorBox&&this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,this._preferAlignAtTop)}))}dispose(){this._resizable.dispose(),this._disposables.dispose(),this.hide()}getId(){return"suggest.details"}getDomNode(){return this._resizable.domNode}getPosition(){return this._topLeft?{preference:this._topLeft}:null}show(){this._added||(this._editor.addOverlayWidget(this),this._added=!0)}hide(e=!1){this._resizable.clearSashHoverState(),this._added&&(this._editor.removeOverlayWidget(this),this._added=!1,this._anchorBox=void 0,this._topLeft=void 0),e&&(this._userSize=void 0,this.widget.clearContents())}placeAtAnchor(e,t){const i=e.getBoundingClientRect();this._anchorBox=i,this._preferAlignAtTop=t,this._placeAtAnchor(this._anchorBox,this._userSize??this.widget.size,t)}_placeAtAnchor(e,t,i){const n=Ph(this.getDomNode().ownerDocument.body),s=this.widget.getLayoutInfo(),r=new wt(220,2*s.lineHeight),a=e.top,l=function(){const w=n.width-(e.left+e.width+s.borderWidth+s.horizontalPadding),x=-s.borderWidth+e.left+e.width,k=new wt(w,n.height-e.top-s.borderHeight-s.verticalPadding),E=k.with(void 0,e.top+e.height-s.borderHeight-s.verticalPadding);return{top:a,left:x,fit:w-t.width,maxSizeTop:k,maxSizeBottom:E,minSize:r.with(Math.min(w,r.width))}}(),c=function(){const w=e.left-s.borderWidth-s.horizontalPadding,x=Math.max(s.horizontalPadding,e.left-t.width-s.borderWidth),k=new wt(w,n.height-e.top-s.borderHeight-s.verticalPadding),E=k.with(void 0,e.top+e.height-s.borderHeight-s.verticalPadding);return{top:a,left:x,fit:w-t.width,maxSizeTop:k,maxSizeBottom:E,minSize:r.with(Math.min(w,r.width))}}(),d=function(){const w=e.left,x=-s.borderWidth+e.top+e.height,k=new wt(e.width-s.borderHeight,n.height-e.top-e.height-s.verticalPadding);return{top:x,left:w,fit:k.height-t.height,maxSizeBottom:k,maxSizeTop:k,minSize:r.with(k.width)}}(),h=[l,c,d],u=h.find(w=>w.fit>=0)??h.sort((w,x)=>x.fit-w.fit)[0],g=e.top+e.height-s.borderHeight;let f,m=t.height;const _=Math.max(u.maxSizeTop.height,u.maxSizeBottom.height);m>_&&(m=_);let b;i?m<=u.maxSizeTop.height?(f=!0,b=u.maxSizeTop):(f=!1,b=u.maxSizeBottom):m<=u.maxSizeBottom.height?(f=!1,b=u.maxSizeBottom):(f=!0,b=u.maxSizeTop);let{top:v,left:y}=u;!f&&m>e.height&&(v=g-m);const C=this._editor.getDomNode();if(C){const w=C.getBoundingClientRect();v-=w.top,y-=w.left}this._applyTopLeft({left:y,top:v}),this._resizable.enableSashes(!f,u===l,f,u!==l),this._resizable.minSize=u.minSize,this._resizable.maxSize=b,this._resizable.layout(m,Math.min(b.width,t.width)),this.widget.layout(this._resizable.size.width,this._resizable.size.height)}_applyTopLeft(e){this._topLeft=e,this._editor.layoutOverlayWidget(this)}}var wl;(function(o){o[o.FILE=0]="FILE",o[o.FOLDER=1]="FOLDER",o[o.ROOT_FOLDER=2]="ROOT_FOLDER"})(wl||(wl={}));const kLe=/(?:\/|^)(?:([^\/]+)\/)?([^\/]+)$/;function _1(o,e,t,i,n){if(ke.isThemeIcon(n))return[`codicon-${n.id}`,"predefined-file-icon"];if(ye.isUri(n))return[];const s=i===wl.ROOT_FOLDER?["rootfolder-icon"]:i===wl.FOLDER?["folder-icon"]:["file-icon"];if(t){let r;if(t.scheme===Oe.data)r=Oh.parseMetaData(t).get(Oh.META_DATA_LABEL);else{const a=t.path.match(kLe);a?(r=b1(a[2].toLowerCase()),a[1]&&s.push(`${b1(a[1].toLowerCase())}-name-dir-icon`)):r=b1(t.authority.toLowerCase())}if(i===wl.ROOT_FOLDER)s.push(`${r}-root-name-folder-icon`);else if(i===wl.FOLDER)s.push(`${r}-name-folder-icon`);else{if(r){if(s.push(`${r}-name-file-icon`),s.push("name-file-icon"),r.length<=255){const l=r.split(".");for(let c=1;c<l.length;c++)s.push(`${l.slice(c).join(".")}-ext-file-icon`)}s.push("ext-file-icon")}const a=ELe(o,e,t);a&&s.push(`${b1(a)}-lang-file-icon`)}}return s}function ELe(o,e,t){if(!t)return null;let i=null;if(t.scheme===Oe.data){const s=Oh.parseMetaData(t).get(Oh.META_DATA_MIME);s&&(i=e.getLanguageIdByMimeType(s))}else{const n=o.getModel(t);n&&(i=n.getLanguageId())}return i&&i!==hs?i:e.guessLanguageIdByFilepathOrFirstLine(t)}function b1(o){return o.replace(/[\s]/g,"/")}var TLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},IN=function(o,e){return function(t,i){e(t,i,o)}};function TZ(o){return`suggest-aria-id:${o}`}const DLe=Gt("suggest-more-info",J.chevronRight,p("suggestMoreInfoIcon","Icon for more information in the suggest widget."));var pa;const ILe=new(pa=class{extract(e,t){if(e.textLabel.match(pa._regexStrict))return t[0]=e.textLabel,!0;if(e.completion.detail&&e.completion.detail.match(pa._regexStrict))return t[0]=e.completion.detail,!0;if(e.completion.documentation){const i=typeof e.completion.documentation=="string"?e.completion.documentation:e.completion.documentation.value,n=pa._regexRelaxed.exec(i);if(n&&(n.index===0||n.index+n[0].length===i.length))return t[0]=n[0],!0}return!1}},pa._regexRelaxed=/(#([\da-fA-F]{3}){1,2}|(rgb|hsl)a\(\s*(\d{1,3}%?\s*,\s*){3}(1|0?\.\d+)\)|(rgb|hsl)\(\s*\d{1,3}%?(\s*,\s*\d{1,3}%?){2}\s*\))/,pa._regexStrict=new RegExp(`^${pa._regexRelaxed.source}$`,"i"),pa);let z2=class{constructor(e,t,i,n){this._editor=e,this._modelService=t,this._languageService=i,this._themeService=n,this._onDidToggleDetails=new O,this.onDidToggleDetails=this._onDidToggleDetails.event,this.templateId="suggestion"}dispose(){this._onDidToggleDetails.dispose()}renderTemplate(e){const t=new $,i=e;i.classList.add("show-file-icons");const n=Y(e,ie(".icon")),s=Y(n,ie("span.colorspan")),r=Y(e,ie(".contents")),a=Y(r,ie(".main")),l=Y(a,ie(".icon-label.codicon")),c=Y(a,ie("span.left")),d=Y(a,ie("span.right")),h=new Mx(c,{supportHighlights:!0,supportIcons:!0});t.add(h);const u=Y(c,ie("span.signature-label")),g=Y(c,ie("span.qualifier-label")),f=Y(d,ie("span.details-label")),m=Y(d,ie("span.readMore"+ke.asCSSSelector(DLe)));return m.title=p("readMore","Read More"),{root:i,left:c,right:d,icon:n,colorspan:s,iconLabel:h,iconContainer:l,parametersLabel:u,qualifierLabel:g,detailsLabel:f,readMore:m,disposables:t,configureFont:()=>{const b=this._editor.getOptions(),v=b.get(50),y=v.getMassagedFontFamily(),C=v.fontFeatureSettings,w=b.get(120)||v.fontSize,x=b.get(121)||v.lineHeight,k=v.fontWeight,E=v.letterSpacing,N=`${w}px`,z=`${x}px`,B=`${E}px`;i.style.fontSize=N,i.style.fontWeight=k,i.style.letterSpacing=B,a.style.fontFamily=y,a.style.fontFeatureSettings=C,a.style.lineHeight=z,n.style.height=z,n.style.width=z,m.style.height=z,m.style.width=z}}}renderElement(e,t,i){i.configureFont();const{completion:n}=e;i.root.id=TZ(t),i.colorspan.style.backgroundColor="";const s={labelEscapeNewLines:!0,matches:Nw(e.score)},r=[];if(n.kind===19&&ILe.extract(e,r))i.icon.className="icon customcolor",i.iconContainer.className="icon hide",i.colorspan.style.backgroundColor=r[0];else if(n.kind===20&&this._themeService.getFileIconTheme().hasFileIcons){i.icon.className="icon hide",i.iconContainer.className="icon hide";const a=_1(this._modelService,this._languageService,ye.from({scheme:"fake",path:e.textLabel}),wl.FILE),l=_1(this._modelService,this._languageService,ye.from({scheme:"fake",path:n.detail}),wl.FILE);s.extraClasses=a.length>l.length?a:l}else n.kind===23&&this._themeService.getFileIconTheme().hasFolderIcons?(i.icon.className="icon hide",i.iconContainer.className="icon hide",s.extraClasses=[_1(this._modelService,this._languageService,ye.from({scheme:"fake",path:e.textLabel}),wl.FOLDER),_1(this._modelService,this._languageService,ye.from({scheme:"fake",path:n.detail}),wl.FOLDER)].flat()):(i.icon.className="icon hide",i.iconContainer.className="",i.iconContainer.classList.add("suggest-icon",...ke.asClassNameArray(GC.toIcon(n.kind))));n.tags&&n.tags.indexOf(1)>=0&&(s.extraClasses=(s.extraClasses||[]).concat(["deprecated"]),s.matches=[]),i.iconLabel.setLabel(e.textLabel,void 0,s),typeof n.label=="string"?(i.parametersLabel.textContent="",i.detailsLabel.textContent=NN(n.detail||""),i.root.classList.add("string-label")):(i.parametersLabel.textContent=NN(n.label.detail||""),i.detailsLabel.textContent=NN(n.label.description||""),i.root.classList.remove("string-label")),this._editor.getOption(119).showInlineDetails?Ys(i.detailsLabel):is(i.detailsLabel),VW(e)?(i.right.classList.add("can-expand-details"),Ys(i.readMore),i.readMore.onmousedown=a=>{a.stopPropagation(),a.preventDefault()},i.readMore.onclick=a=>{a.stopPropagation(),a.preventDefault(),this._onDidToggleDetails.fire()}):(i.right.classList.remove("can-expand-details"),is(i.readMore),i.readMore.onmousedown=null,i.readMore.onclick=null)}disposeTemplate(e){e.disposables.dispose()}};z2=TLe([IN(1,Ut),IN(2,ti),IN(3,zi)],z2);function NN(o){return o.replace(/\r\n|\r|\n/g,"")}var NLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},v1=function(o,e){return function(t,i){e(t,i,o)}},Hp;D("editorSuggestWidget.background",Ro,p("editorSuggestWidgetBackground","Background color of the suggest widget."));D("editorSuggestWidget.border",d5,p("editorSuggestWidgetBorder","Border color of the suggest widget."));const RLe=D("editorSuggestWidget.foreground",Hl,p("editorSuggestWidgetForeground","Foreground color of the suggest widget."));D("editorSuggestWidget.selectedForeground",ly,p("editorSuggestWidgetSelectedForeground","Foreground color of the selected entry in the suggest widget."));D("editorSuggestWidget.selectedIconForeground",_5,p("editorSuggestWidgetSelectedIconForeground","Icon foreground color of the selected entry in the suggest widget."));const PLe=D("editorSuggestWidget.selectedBackground",cy,p("editorSuggestWidgetSelectedBackground","Background color of the selected entry in the suggest widget."));D("editorSuggestWidget.highlightForeground",qp,p("editorSuggestWidgetHighlightForeground","Color of the match highlights in the suggest widget."));D("editorSuggestWidget.focusHighlightForeground",roe,p("editorSuggestWidgetFocusHighlightForeground","Color of the match highlights in the suggest widget when an item is focused."));D("editorSuggestWidgetStatus.foreground",Ue(RLe,.5),p("editorSuggestWidgetStatusForeground","Foreground color of the suggest widget status."));class ALe{constructor(e,t){this._service=e,this._key=`suggestWidget.size/${t.getEditorType()}/${t instanceof jr}`}restore(){const e=this._service.get(this._key,0)??"";try{const t=JSON.parse(e);if(wt.is(t))return wt.lift(t)}catch{}}store(e){this._service.store(this._key,JSON.stringify(e),0,1)}reset(){this._service.remove(this._key,0)}}var bh;let U2=(bh=class{constructor(e,t,i,n,s){this.editor=e,this._storageService=t,this._state=0,this._isAuto=!1,this._pendingLayout=new Yi,this._pendingShowDetails=new Yi,this._ignoreFocusEvents=!1,this._forceRenderingAbove=!1,this._explainMode=!1,this._showTimeout=new qr,this._disposables=new $,this._onDidSelect=new pf,this._onDidFocus=new pf,this._onDidHide=new O,this._onDidShow=new O,this.onDidSelect=this._onDidSelect.event,this.onDidFocus=this._onDidFocus.event,this.onDidHide=this._onDidHide.event,this.onDidShow=this._onDidShow.event,this._onDetailsKeydown=new O,this.onDetailsKeyDown=this._onDetailsKeydown.event,this.element=new vW,this.element.domNode.classList.add("editor-widget","suggest-widget"),this._contentWidget=new MLe(this,e),this._persistedSize=new ALe(t,e);class r{constructor(g,f,m=!1,_=!1){this.persistedSize=g,this.currentSize=f,this.persistHeight=m,this.persistWidth=_}}let a;this._disposables.add(this.element.onDidWillResize(()=>{this._contentWidget.lockPreference(),a=new r(this._persistedSize.restore(),this.element.size)})),this._disposables.add(this.element.onDidResize(u=>{if(this._resize(u.dimension.width,u.dimension.height),a&&(a.persistHeight=a.persistHeight||!!u.north||!!u.south,a.persistWidth=a.persistWidth||!!u.east||!!u.west),!!u.done){if(a){const{itemHeight:g,defaultSize:f}=this.getLayoutInfo(),m=Math.round(g/2);let{width:_,height:b}=this.element.size;(!a.persistHeight||Math.abs(a.currentSize.height-b)<=m)&&(b=a.persistedSize?.height??f.height),(!a.persistWidth||Math.abs(a.currentSize.width-_)<=m)&&(_=a.persistedSize?.width??f.width),this._persistedSize.store(new wt(_,b))}this._contentWidget.unlockPreference(),a=void 0}})),this._messageElement=Y(this.element.domNode,ie(".message")),this._listElement=Y(this.element.domNode,ie(".tree"));const l=this._disposables.add(s.createInstance(H2,this.editor));l.onDidClose(this.toggleDetails,this,this._disposables),this._details=new LLe(l,this.editor);const c=()=>this.element.domNode.classList.toggle("no-icons",!this.editor.getOption(119).showIcons);c();const d=s.createInstance(z2,this.editor);this._disposables.add(d),this._disposables.add(d.onDidToggleDetails(()=>this.toggleDetails())),this._list=new $o("SuggestWidget",this._listElement,{getHeight:u=>this.getLayoutInfo().itemHeight,getTemplateId:u=>"suggestion"},[d],{alwaysConsumeMouseWheel:!0,useShadows:!1,mouseSupport:!1,multipleSelectionSupport:!1,accessibilityProvider:{getRole:()=>"option",getWidgetAriaLabel:()=>p("suggest","Suggest"),getWidgetRole:()=>"listbox",getAriaLabel:u=>{let g=u.textLabel;if(typeof u.completion.label!="string"){const{detail:b,description:v}=u.completion.label;b&&v?g=p("label.full","{0} {1}, {2}",g,b,v):b?g=p("label.detail","{0} {1}",g,b):v&&(g=p("label.desc","{0}, {1}",g,v))}if(!u.isResolved||!this._isDetailsVisible())return g;const{documentation:f,detail:m}=u.completion,_=mf("{0}{1}",m||"",f?typeof f=="string"?f:f.value:"");return p("ariaCurrenttSuggestionReadDetails","{0}, docs: {1}",g,_)}}}),this._list.style(Zf({listInactiveFocusBackground:PLe,listInactiveFocusOutline:qt})),this._status=s.createInstance(V2,this.element.domNode,ah);const h=()=>this.element.domNode.classList.toggle("with-status-bar",this.editor.getOption(119).showStatusBar);h(),this._disposables.add(n.onDidColorThemeChange(u=>this._onThemeChange(u))),this._onThemeChange(n.getColorTheme()),this._disposables.add(this._list.onMouseDown(u=>this._onListMouseDownOrTap(u))),this._disposables.add(this._list.onTap(u=>this._onListMouseDownOrTap(u))),this._disposables.add(this._list.onDidChangeSelection(u=>this._onListSelection(u))),this._disposables.add(this._list.onDidChangeFocus(u=>this._onListFocus(u))),this._disposables.add(this.editor.onDidChangeCursorSelection(()=>this._onCursorSelectionChanged())),this._disposables.add(this.editor.onDidChangeConfiguration(u=>{u.hasChanged(119)&&(h(),c()),this._completionModel&&(u.hasChanged(50)||u.hasChanged(120)||u.hasChanged(121))&&this._list.splice(0,this._list.length,this._completionModel.items)})),this._ctxSuggestWidgetVisible=ze.Visible.bindTo(i),this._ctxSuggestWidgetDetailsVisible=ze.DetailsVisible.bindTo(i),this._ctxSuggestWidgetMultipleSuggestions=ze.MultipleSuggestions.bindTo(i),this._ctxSuggestWidgetHasFocusedSuggestion=ze.HasFocusedSuggestion.bindTo(i),this._disposables.add(ci(this._details.widget.domNode,"keydown",u=>{this._onDetailsKeydown.fire(u)})),this._disposables.add(this.editor.onMouseDown(u=>this._onEditorMouseDown(u)))}dispose(){this._details.widget.dispose(),this._details.dispose(),this._list.dispose(),this._status.dispose(),this._disposables.dispose(),this._loadingTimeout?.dispose(),this._pendingLayout.dispose(),this._pendingShowDetails.dispose(),this._showTimeout.dispose(),this._contentWidget.dispose(),this.element.dispose()}_onEditorMouseDown(e){this._details.widget.domNode.contains(e.target.element)?this._details.widget.domNode.focus():this.element.domNode.contains(e.target.element)&&this.editor.focus()}_onCursorSelectionChanged(){this._state!==0&&this._contentWidget.layout()}_onListMouseDownOrTap(e){typeof e.element>"u"||typeof e.index>"u"||(e.browserEvent.preventDefault(),e.browserEvent.stopPropagation(),this._select(e.element,e.index))}_onListSelection(e){e.elements.length&&this._select(e.elements[0],e.indexes[0])}_select(e,t){const i=this._completionModel;i&&(this._onDidSelect.fire({item:e,index:t,model:i}),this.editor.focus())}_onThemeChange(e){this._details.widget.borderWidth=xa(e.type)?2:1}_onListFocus(e){if(this._ignoreFocusEvents)return;if(!e.elements.length){this._currentSuggestionDetails&&(this._currentSuggestionDetails.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=void 0),this.editor.setAriaOptions({activeDescendant:void 0}),this._ctxSuggestWidgetHasFocusedSuggestion.set(!1);return}if(!this._completionModel)return;this._ctxSuggestWidgetHasFocusedSuggestion.set(!0);const t=e.elements[0],i=e.indexes[0];t!==this._focusedItem&&(this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._focusedItem=t,this._list.reveal(i),this._currentSuggestionDetails=ji(async n=>{const s=Rh(()=>{this._isDetailsVisible()&&this.showDetails(!0)},250),r=n.onCancellationRequested(()=>s.dispose());try{return await t.resolve(n)}finally{s.dispose(),r.dispose()}}),this._currentSuggestionDetails.then(()=>{i>=this._list.length||t!==this._list.element(i)||(this._ignoreFocusEvents=!0,this._list.splice(i,1,[t]),this._list.setFocus([i]),this._ignoreFocusEvents=!1,this._isDetailsVisible()?this.showDetails(!1):this.element.domNode.classList.remove("docs-side"),this.editor.setAriaOptions({activeDescendant:TZ(i)}))}).catch(Ae)),this._onDidFocus.fire({item:t,index:i,model:this._completionModel})}_setState(e){if(this._state!==e)switch(this._state=e,this.element.domNode.classList.toggle("frozen",e===4),this.element.domNode.classList.remove("message"),e){case 0:is(this._messageElement,this._listElement,this._status.element),this._details.hide(!0),this._status.hide(),this._contentWidget.hide(),this._ctxSuggestWidgetVisible.reset(),this._ctxSuggestWidgetMultipleSuggestions.reset(),this._ctxSuggestWidgetHasFocusedSuggestion.reset(),this._showTimeout.cancel(),this.element.domNode.classList.remove("visible"),this._list.splice(0,this._list.length),this._focusedItem=void 0,this._cappedHeight=void 0,this._explainMode=!1;break;case 1:this.element.domNode.classList.add("message"),this._messageElement.textContent=Hp.LOADING_MESSAGE,is(this._listElement,this._status.element),Ys(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Rl(Hp.LOADING_MESSAGE);break;case 2:this.element.domNode.classList.add("message"),this._messageElement.textContent=Hp.NO_SUGGESTIONS_MESSAGE,is(this._listElement,this._status.element),Ys(this._messageElement),this._details.hide(),this._show(),this._focusedItem=void 0,Rl(Hp.NO_SUGGESTIONS_MESSAGE);break;case 3:is(this._messageElement),Ys(this._listElement,this._status.element),this._show();break;case 4:is(this._messageElement),Ys(this._listElement,this._status.element),this._show();break;case 5:is(this._messageElement),Ys(this._listElement,this._status.element),this._details.show(),this._show();break}}_show(){this._status.show(),this._contentWidget.show(),this._layout(this._persistedSize.restore()),this._ctxSuggestWidgetVisible.set(!0),this._showTimeout.cancelAndSet(()=>{this.element.domNode.classList.add("visible"),this._onDidShow.fire(this)},100)}showTriggered(e,t){this._state===0&&(this._contentWidget.setPosition(this.editor.getPosition()),this._isAuto=!!e,this._isAuto||(this._loadingTimeout=Rh(()=>this._setState(1),t)))}showSuggestions(e,t,i,n,s){if(this._contentWidget.setPosition(this.editor.getPosition()),this._loadingTimeout?.dispose(),this._currentSuggestionDetails?.cancel(),this._currentSuggestionDetails=void 0,this._completionModel!==e&&(this._completionModel=e),i&&this._state!==2&&this._state!==0){this._setState(4);return}const r=this._completionModel.items.length,a=r===0;if(this._ctxSuggestWidgetMultipleSuggestions.set(r>1),a){this._setState(n?0:2),this._completionModel=void 0;return}this._focusedItem=void 0,this._onDidFocus.pause(),this._onDidSelect.pause();try{this._list.splice(0,this._list.length,this._completionModel.items),this._setState(i?4:3),this._list.reveal(t,0),this._list.setFocus(s?[]:[t])}finally{this._onDidFocus.resume(),this._onDidSelect.resume()}this._pendingLayout.value=R0(xe(this.element.domNode),()=>{this._pendingLayout.clear(),this._layout(this.element.size),this._details.widget.domNode.classList.remove("focused")})}focusSelected(){this._list.length>0&&this._list.setFocus([0])}selectNextPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageDown(),!0;case 1:return!this._isAuto;default:return this._list.focusNextPage(),!0}}selectNext(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusNext(1,!0),!0}}selectLast(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollBottom(),!0;case 1:return!this._isAuto;default:return this._list.focusLast(),!0}}selectPreviousPage(){switch(this._state){case 0:return!1;case 5:return this._details.widget.pageUp(),!0;case 1:return!this._isAuto;default:return this._list.focusPreviousPage(),!0}}selectPrevious(){switch(this._state){case 0:return!1;case 1:return!this._isAuto;default:return this._list.focusPrevious(1,!0),!1}}selectFirst(){switch(this._state){case 0:return!1;case 5:return this._details.widget.scrollTop(),!0;case 1:return!this._isAuto;default:return this._list.focusFirst(),!0}}getFocusedItem(){if(this._state!==0&&this._state!==2&&this._state!==1&&this._completionModel&&this._list.getFocus().length>0)return{item:this._list.getFocusedElements()[0],index:this._list.getFocus()[0],model:this._completionModel}}toggleDetailsFocus(){this._state===5?(this._setState(3),this._details.widget.domNode.classList.remove("focused")):this._state===3&&this._isDetailsVisible()&&(this._setState(5),this._details.widget.domNode.classList.add("focused"))}toggleDetails(){this._isDetailsVisible()?(this._pendingShowDetails.clear(),this._ctxSuggestWidgetDetailsVisible.set(!1),this._setDetailsVisible(!1),this._details.hide(),this.element.domNode.classList.remove("shows-details")):(VW(this._list.getFocusedElements()[0])||this._explainMode)&&(this._state===3||this._state===5||this._state===4)&&(this._ctxSuggestWidgetDetailsVisible.set(!0),this._setDetailsVisible(!0),this.showDetails(!1))}showDetails(e){this._pendingShowDetails.value=R0(xe(this.element.domNode),()=>{this._pendingShowDetails.clear(),this._details.show(),e?this._details.widget.renderLoading():this._details.widget.renderItem(this._list.getFocusedElements()[0],this._explainMode),this._details.widget.isEmpty?this._details.hide():(this._positionDetails(),this.element.domNode.classList.add("shows-details")),this.editor.focus()})}toggleExplainMode(){this._list.getFocusedElements()[0]&&(this._explainMode=!this._explainMode,this._isDetailsVisible()?this.showDetails(!1):this.toggleDetails())}resetPersistedSize(){this._persistedSize.reset()}hideWidget(){this._pendingLayout.clear(),this._pendingShowDetails.clear(),this._loadingTimeout?.dispose(),this._setState(0),this._onDidHide.fire(this),this.element.clearSashHoverState();const e=this._persistedSize.restore(),t=Math.ceil(this.getLayoutInfo().itemHeight*4.3);e&&e.height<t&&this._persistedSize.store(e.with(void 0,t))}isFrozen(){return this._state===4}_afterRender(e){if(e===null){this._isDetailsVisible()&&this._details.hide();return}this._state===2||this._state===1||(this._isDetailsVisible()&&!this._details.widget.isEmpty&&this._details.show(),this._positionDetails())}_layout(e){if(!this.editor.hasModel()||!this.editor.getDomNode())return;const t=Ph(this.element.domNode.ownerDocument.body),i=this.getLayoutInfo();e||(e=i.defaultSize);let n=e.height,s=e.width;if(this._status.element.style.height=`${i.itemHeight}px`,this._state===2||this._state===1)n=i.itemHeight+i.borderHeight,s=i.defaultSize.width/2,this.element.enableSashes(!1,!1,!1,!1),this.element.minSize=this.element.maxSize=new wt(s,n),this._contentWidget.setPreference(2);else{const r=t.width-i.borderHeight-2*i.horizontalPadding;s>r&&(s=r);const a=this._completionModel?this._completionModel.stats.pLabelLen*i.typicalHalfwidthCharacterWidth:s,l=i.statusBarHeight+this._list.contentHeight+i.borderHeight,c=i.itemHeight+i.statusBarHeight,d=Ci(this.editor.getDomNode()),h=this.editor.getScrolledVisiblePosition(this.editor.getPosition()),u=d.top+h.top+h.height,g=Math.min(t.height-u-i.verticalPadding,l),f=d.top+h.top-i.verticalPadding,m=Math.min(f,l);let _=Math.min(Math.max(m,g)+i.borderHeight,l);n===this._cappedHeight?.capped&&(n=this._cappedHeight.wanted),n<c&&(n=c),n>_&&(n=_),n>g||this._forceRenderingAbove&&f>150?(this._contentWidget.setPreference(1),this.element.enableSashes(!0,!0,!1,!1),_=m):(this._contentWidget.setPreference(2),this.element.enableSashes(!1,!0,!0,!1),_=g),this.element.preferredSize=new wt(a,i.defaultSize.height),this.element.maxSize=new wt(r,_),this.element.minSize=new wt(220,c),this._cappedHeight=n===l?{wanted:this._cappedHeight?.wanted??e.height,capped:n}:void 0}this._resize(s,n)}_resize(e,t){const{width:i,height:n}=this.element.maxSize;e=Math.min(i,e),t=Math.min(n,t);const{statusBarHeight:s}=this.getLayoutInfo();this._list.layout(t-s,e),this._listElement.style.height=`${t-s}px`,this.element.layout(t,e),this._contentWidget.layout(),this._positionDetails()}_positionDetails(){this._isDetailsVisible()&&this._details.placeAtAnchor(this.element.domNode,this._contentWidget.getPosition()?.preference[0]===2)}getLayoutInfo(){const e=this.editor.getOption(50),t=ts(this.editor.getOption(121)||e.lineHeight,8,1e3),i=!this.editor.getOption(119).showStatusBar||this._state===2||this._state===1?0:t,n=this._details.widget.borderWidth,s=2*n;return{itemHeight:t,statusBarHeight:i,borderWidth:n,borderHeight:s,typicalHalfwidthCharacterWidth:e.typicalHalfwidthCharacterWidth,verticalPadding:22,horizontalPadding:14,defaultSize:new wt(430,i+12*t+s)}}_isDetailsVisible(){return this._storageService.getBoolean("expandSuggestionDocs",0,!1)}_setDetailsVisible(e){this._storageService.store("expandSuggestionDocs",e,0,0)}forceRenderingAbove(){this._forceRenderingAbove||(this._forceRenderingAbove=!0,this._layout(this._persistedSize.restore()))}stopForceRenderingAbove(){this._forceRenderingAbove=!1}},Hp=bh,bh.LOADING_MESSAGE=p("suggestWidget.loading","Loading..."),bh.NO_SUGGESTIONS_MESSAGE=p("suggestWidget.noSuggestions","No suggestions."),bh);U2=Hp=NLe([v1(1,Yr),v1(2,Ee),v1(3,zi),v1(4,Ce)],U2);class MLe{constructor(e,t){this._widget=e,this._editor=t,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this._preferenceLocked=!1,this._added=!1,this._hidden=!1}dispose(){this._added&&(this._added=!1,this._editor.removeContentWidget(this))}getId(){return"editor.widget.suggestWidget"}getDomNode(){return this._widget.element.domNode}show(){this._hidden=!1,this._added||(this._added=!0,this._editor.addContentWidget(this))}hide(){this._hidden||(this._hidden=!0,this.layout())}layout(){this._editor.layoutContentWidget(this)}getPosition(){return this._hidden||!this._position||!this._preference?null:{position:this._position,preference:[this._preference]}}beforeRender(){const{height:e,width:t}=this._widget.element.size,{borderWidth:i,horizontalPadding:n}=this._widget.getLayoutInfo();return new wt(t+2*i+n,e+2*i)}afterRender(e){this._widget._afterRender(e)}setPreference(e){this._preferenceLocked||(this._preference=e)}lockPreference(){this._preferenceLocked=!0}unlockPreference(){this._preferenceLocked=!1}setPosition(e){this._position=e}}var OLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ip=function(o,e){return function(t,i){e(t,i,o)}},G2;class FLe{constructor(e,t){if(this._model=e,this._position=t,this._decorationOptions=Fe.register({description:"suggest-line-suffix",stickiness:1}),e.getLineMaxColumn(t.lineNumber)!==t.column){const n=e.getOffsetAt(t),s=e.getPositionAt(n+1);e.changeDecorations(r=>{this._marker&&r.removeDecoration(this._marker),this._marker=r.addDecoration(L.fromPositions(t,s),this._decorationOptions)})}}dispose(){this._marker&&!this._model.isDisposed()&&this._model.changeDecorations(e=>{e.removeDecoration(this._marker),this._marker=void 0})}delta(e){if(this._model.isDisposed()||this._position.lineNumber!==e.lineNumber)return 0;if(this._marker){const t=this._model.getDecorationRange(this._marker);return this._model.getOffsetAt(t.getStartPosition())-this._model.getOffsetAt(e)}else return this._model.getLineMaxColumn(e.lineNumber)-e.column}}var qg;let Fr=(qg=class{static get(e){return e.getContribution(G2.ID)}constructor(e,t,i,n,s,r,a){this._memoryService=t,this._commandService=i,this._contextKeyService=n,this._instantiationService=s,this._logService=r,this._telemetryService=a,this._lineSuffix=new Yi,this._toDispose=new $,this._selectors=new BLe(h=>h.priority),this._onWillInsertSuggestItem=new O,this.onWillInsertSuggestItem=this._onWillInsertSuggestItem.event,this.editor=e,this.model=s.createInstance(KL,this.editor),this._selectors.register({priority:0,select:(h,u,g)=>this._memoryService.select(h,u,g)});const l=ze.InsertMode.bindTo(n);l.set(e.getOption(119).insertMode),this._toDispose.add(this.model.onDidTrigger(()=>l.set(e.getOption(119).insertMode))),this.widget=this._toDispose.add(new XD(xe(e.getDomNode()),()=>{const h=this._instantiationService.createInstance(U2,this.editor);this._toDispose.add(h),this._toDispose.add(h.onDidSelect(_=>this._insertSuggestion(_,0),this));const u=new bLe(this.editor,h,this.model,_=>this._insertSuggestion(_,2));this._toDispose.add(u);const g=ze.MakesTextEdit.bindTo(this._contextKeyService),f=ze.HasInsertAndReplaceRange.bindTo(this._contextKeyService),m=ze.CanResolve.bindTo(this._contextKeyService);return this._toDispose.add(ve(()=>{g.reset(),f.reset(),m.reset()})),this._toDispose.add(h.onDidFocus(({item:_})=>{const b=this.editor.getPosition(),v=_.editStart.column,y=b.column;let C=!0;this.editor.getOption(1)==="smart"&&this.model.state===2&&!_.completion.additionalTextEdits&&!(_.completion.insertTextRules&4)&&y-v===_.completion.insertText.length&&(C=this.editor.getModel().getValueInRange({startLineNumber:b.lineNumber,startColumn:v,endLineNumber:b.lineNumber,endColumn:y})!==_.completion.insertText),g.set(C),f.set(!A.equals(_.editInsertEnd,_.editReplaceEnd)),m.set(!!_.provider.resolveCompletionItem||!!_.completion.documentation||_.completion.detail!==_.completion.label)})),this._toDispose.add(h.onDetailsKeyDown(_=>{if(_.toKeyCodeChord().equals(new $c(!0,!1,!1,!1,33))||Qe&&_.toKeyCodeChord().equals(new $c(!1,!1,!1,!0,33))){_.stopPropagation();return}_.toKeyCodeChord().isModifierKey()||this.editor.focus()})),h})),this._overtypingCapturer=this._toDispose.add(new XD(xe(e.getDomNode()),()=>this._toDispose.add(new W2(this.editor,this.model)))),this._alternatives=this._toDispose.add(new XD(xe(e.getDomNode()),()=>this._toDispose.add(new q_(this.editor,this._contextKeyService)))),this._toDispose.add(s.createInstance(UL,e)),this._toDispose.add(this.model.onDidTrigger(h=>{this.widget.value.showTriggered(h.auto,h.shy?250:50),this._lineSuffix.value=new FLe(this.editor.getModel(),h.position)})),this._toDispose.add(this.model.onDidSuggest(h=>{if(h.triggerOptions.shy)return;let u=-1;for(const f of this._selectors.itemsOrderedByPriorityDesc)if(u=f.select(this.editor.getModel(),this.editor.getPosition(),h.completionModel.items),u!==-1)break;if(u===-1&&(u=0),this.model.state===0)return;let g=!1;if(h.triggerOptions.auto){const f=this.editor.getOption(119);f.selectionMode==="never"||f.selectionMode==="always"?g=f.selectionMode==="never":f.selectionMode==="whenTriggerCharacter"?g=h.triggerOptions.triggerKind!==1:f.selectionMode==="whenQuickSuggestion"&&(g=h.triggerOptions.triggerKind===1&&!h.triggerOptions.refilter)}this.widget.value.showSuggestions(h.completionModel,u,h.isFrozen,h.triggerOptions.auto,g)})),this._toDispose.add(this.model.onDidCancel(h=>{h.retrigger||this.widget.value.hideWidget()})),this._toDispose.add(this.editor.onDidBlurEditorWidget(()=>{this.model.cancel(),this.model.clear()}));const c=ze.AcceptSuggestionsOnEnter.bindTo(n),d=()=>{const h=this.editor.getOption(1);c.set(h==="on"||h==="smart")};this._toDispose.add(this.editor.onDidChangeConfiguration(()=>d())),d()}dispose(){this._alternatives.dispose(),this._toDispose.dispose(),this.widget.dispose(),this.model.dispose(),this._lineSuffix.dispose(),this._onWillInsertSuggestItem.dispose()}_insertSuggestion(e,t){if(!e||!e.item){this._alternatives.value.reset(),this.model.cancel(),this.model.clear();return}if(!this.editor.hasModel())return;const i=ms.get(this.editor);if(!i)return;this._onWillInsertSuggestItem.fire({item:e.item});const n=this.editor.getModel(),s=n.getAlternativeVersionId(),{item:r}=e,a=[],l=new ri;t&1||this.editor.pushUndoStop();const c=this.getOverwriteInfo(r,!!(t&8));this._memoryService.memorize(n,this.editor.getPosition(),r);const d=r.isResolved;let h=-1,u=-1;if(Array.isArray(r.completion.additionalTextEdits)){this.model.cancel();const f=Ma.capture(this.editor);this.editor.executeEdits("suggestController.additionalTextEdits.sync",r.completion.additionalTextEdits.map(m=>{let _=L.lift(m.range);if(_.startLineNumber===r.position.lineNumber&&_.startColumn>r.position.column){const b=this.editor.getPosition().column-r.position.column,v=b,y=L.spansMultipleLines(_)?0:b;_=new L(_.startLineNumber,_.startColumn+v,_.endLineNumber,_.endColumn+y)}return si.replaceMove(_,m.text)})),f.restoreRelativeVerticalPositionOfCursor(this.editor)}else if(!d){const f=new rn;let m;const _=n.onDidChangeContent(C=>{if(C.isFlush){l.cancel(),_.dispose();return}for(const w of C.changes){const x=L.getEndPosition(w.range);(!m||A.isBefore(x,m))&&(m=x)}}),b=t;t|=2;let v=!1;const y=this.editor.onWillType(()=>{y.dispose(),v=!0,b&2||this.editor.pushUndoStop()});a.push(r.resolve(l.token).then(()=>{if(!r.completion.additionalTextEdits||l.token.isCancellationRequested)return;if(m&&r.completion.additionalTextEdits.some(w=>A.isBefore(m,L.getStartPosition(w.range))))return!1;v&&this.editor.pushUndoStop();const C=Ma.capture(this.editor);return this.editor.executeEdits("suggestController.additionalTextEdits.async",r.completion.additionalTextEdits.map(w=>si.replaceMove(L.lift(w.range),w.text))),C.restoreRelativeVerticalPositionOfCursor(this.editor),(v||!(b&2))&&this.editor.pushUndoStop(),!0}).then(C=>{this._logService.trace("[suggest] async resolving of edits DONE (ms, applied?)",f.elapsed(),C),u=C===!0?1:C===!1?0:-2}).finally(()=>{_.dispose(),y.dispose()}))}let{insertText:g}=r.completion;if(r.completion.insertTextRules&4||(g=Pf.escape(g)),this.model.cancel(),i.insert(g,{overwriteBefore:c.overwriteBefore,overwriteAfter:c.overwriteAfter,undoStopBefore:!1,undoStopAfter:!1,adjustWhitespace:!(r.completion.insertTextRules&1),clipboardText:e.model.clipboardText,overtypingCapturer:this._overtypingCapturer.value}),t&2||this.editor.pushUndoStop(),r.completion.command)if(r.completion.command.id===jL.id)this.model.trigger({auto:!0,retrigger:!0});else{const f=new rn;a.push(this._commandService.executeCommand(r.completion.command.id,...r.completion.command.arguments?[...r.completion.command.arguments]:[]).catch(m=>{r.completion.extensionId?yi(m):Ae(m)}).finally(()=>{h=f.elapsed()}))}t&4&&this._alternatives.value.set(e,f=>{for(l.cancel();n.canUndo();){s!==n.getAlternativeVersionId()&&n.undo(),this._insertSuggestion(f,3|(t&8?8:0));break}}),this._alertCompletionItem(r),Promise.all(a).finally(()=>{this._reportSuggestionAcceptedTelemetry(r,n,d,h,u,e.index,e.model.items),this.model.clear(),l.dispose()})}_reportSuggestionAcceptedTelemetry(e,t,i,n,s,r,a){if(Math.floor(Math.random()*100)===0)return;const l=new Map;for(let u=0;u<Math.min(30,a.length);u++){const g=a[u].textLabel;l.has(g)?l.get(g).push(u):l.set(g,[u])}const c=l.get(e.textLabel),h=c&&c.length>1?c[0]:-1;this._telemetryService.publicLog2("suggest.acceptedSuggestion",{extensionId:e.extensionId?.value??"unknown",providerId:e.provider._debugDisplayName??"unknown",kind:e.completion.kind,basenameHash:sT(fr(t.uri)).toString(16),languageId:t.getLanguageId(),fileExtension:bre(t.uri),resolveInfo:e.provider.resolveCompletionItem?i?1:0:-1,resolveDuration:e.resolveDuration,commandDuration:n,additionalEditsAsync:s,index:r,firstIndex:h})}getOverwriteInfo(e,t){ut(this.editor.hasModel());let i=this.editor.getOption(119).insertMode==="replace";t&&(i=!i);const n=e.position.column-e.editStart.column,s=(i?e.editReplaceEnd.column:e.editInsertEnd.column)-e.position.column,r=this.editor.getPosition().column-e.position.column,a=this._lineSuffix.value?this._lineSuffix.value.delta(this.editor.getPosition()):0;return{overwriteBefore:n+r,overwriteAfter:s+a}}_alertCompletionItem(e){if(Yn(e.completion.additionalTextEdits)){const t=p("aria.alert.snippet","Accepting '{0}' made {1} additional edits",e.textLabel,e.completion.additionalTextEdits.length);ps(t)}}triggerSuggest(e,t,i){this.editor.hasModel()&&(this.model.trigger({auto:t??!1,completionOptions:{providerFilter:e,kindFilter:i?new Set:void 0}}),this.editor.revealPosition(this.editor.getPosition(),0),this.editor.focus())}triggerSuggestAndAcceptBest(e){if(!this.editor.hasModel())return;const t=this.editor.getPosition(),i=()=>{t.equals(this.editor.getPosition())&&this._commandService.executeCommand(e.fallback)},n=s=>{if(s.completion.insertTextRules&4||s.completion.additionalTextEdits)return!0;const r=this.editor.getPosition(),a=s.editStart.column,l=r.column;return l-a!==s.completion.insertText.length?!0:this.editor.getModel().getValueInRange({startLineNumber:r.lineNumber,startColumn:a,endLineNumber:r.lineNumber,endColumn:l})!==s.completion.insertText};se.once(this.model.onDidTrigger)(s=>{const r=[];se.any(this.model.onDidTrigger,this.model.onDidCancel)(()=>{Dt(r),i()},void 0,r),this.model.onDidSuggest(({completionModel:a})=>{if(Dt(r),a.items.length===0){i();return}const l=this._memoryService.select(this.editor.getModel(),this.editor.getPosition(),a.items),c=a.items[l];if(!n(c)){i();return}this.editor.pushUndoStop(),this._insertSuggestion({index:l,item:c,model:a},7)},void 0,r)}),this.model.trigger({auto:!1,shy:!0}),this.editor.revealPosition(t,0),this.editor.focus()}acceptSelectedSuggestion(e,t){const i=this.widget.value.getFocusedItem();let n=0;e&&(n|=4),t&&(n|=8),this._insertSuggestion(i,n)}acceptNextSuggestion(){this._alternatives.value.next()}acceptPrevSuggestion(){this._alternatives.value.prev()}cancelSuggestWidget(){this.model.cancel(),this.model.clear(),this.widget.value.hideWidget()}focusSuggestion(){this.widget.value.focusSelected()}selectNextSuggestion(){this.widget.value.selectNext()}selectNextPageSuggestion(){this.widget.value.selectNextPage()}selectLastSuggestion(){this.widget.value.selectLast()}selectPrevSuggestion(){this.widget.value.selectPrevious()}selectPrevPageSuggestion(){this.widget.value.selectPreviousPage()}selectFirstSuggestion(){this.widget.value.selectFirst()}toggleSuggestionDetails(){this.widget.value.toggleDetails()}toggleExplainMode(){this.widget.value.toggleExplainMode()}toggleSuggestionFocus(){this.widget.value.toggleDetailsFocus()}resetWidgetSize(){this.widget.value.resetPersistedSize()}forceRenderingAbove(){this.widget.value.forceRenderingAbove()}stopForceRenderingAbove(){this.widget.isInitialized&&this.widget.value.stopForceRenderingAbove()}registerSelector(e){return this._selectors.register(e)}},G2=qg,qg.ID="editor.contrib.suggestController",qg);Fr=G2=OLe([Ip(1,TD),Ip(2,Ft),Ip(3,Ee),Ip(4,Ce),Ip(5,Tn),Ip(6,Fn)],Fr);class BLe{constructor(e){this.prioritySelector=e,this._items=new Array}register(e){if(this._items.indexOf(e)!==-1)throw new Error("Value is already registered");return this._items.push(e),this._items.sort((t,i)=>this.prioritySelector(i)-this.prioritySelector(t)),{dispose:()=>{const t=this._items.indexOf(e);t>=0&&this._items.splice(t,1)}}}get itemsOrderedByPriorityDesc(){return this._items}}const CE=class CE extends de{constructor(){super({id:CE.id,label:p("suggest.trigger.label","Trigger Suggest"),alias:"Trigger Suggest",precondition:K.and(T.writable,T.hasCompletionItemProvider,ze.Visible.toNegated()),kbOpts:{kbExpr:T.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[521,2087]},weight:100}})}run(e,t,i){const n=Fr.get(t);if(!n)return;let s;i&&typeof i=="object"&&i.auto===!0&&(s=!0),n.triggerSuggest(void 0,s,void 0)}};CE.id="editor.action.triggerSuggest";let jL=CE;at(Fr.ID,Fr,2);X(jL);const Ho=190,Cs=Hi.bindToContribution(Fr.get);oe(new Cs({id:"acceptSelectedSuggestion",precondition:K.and(ze.Visible,ze.HasFocusedSuggestion),handler(o){o.acceptSelectedSuggestion(!0,!1)},kbOpts:[{primary:2,kbExpr:K.and(ze.Visible,T.textInputFocus),weight:Ho},{primary:3,kbExpr:K.and(ze.Visible,T.textInputFocus,ze.AcceptSuggestionsOnEnter,ze.MakesTextEdit),weight:Ho}],menuOpts:[{menuId:ah,title:p("accept.insert","Insert"),group:"left",order:1,when:ze.HasInsertAndReplaceRange.toNegated()},{menuId:ah,title:p("accept.insert","Insert"),group:"left",order:1,when:K.and(ze.HasInsertAndReplaceRange,ze.InsertMode.isEqualTo("insert"))},{menuId:ah,title:p("accept.replace","Replace"),group:"left",order:1,when:K.and(ze.HasInsertAndReplaceRange,ze.InsertMode.isEqualTo("replace"))}]}));oe(new Cs({id:"acceptAlternativeSelectedSuggestion",precondition:K.and(ze.Visible,T.textInputFocus,ze.HasFocusedSuggestion),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:1027,secondary:[1026]},handler(o){o.acceptSelectedSuggestion(!1,!0)},menuOpts:[{menuId:ah,group:"left",order:2,when:K.and(ze.HasInsertAndReplaceRange,ze.InsertMode.isEqualTo("insert")),title:p("accept.replace","Replace")},{menuId:ah,group:"left",order:2,when:K.and(ze.HasInsertAndReplaceRange,ze.InsertMode.isEqualTo("replace")),title:p("accept.insert","Insert")}]}));st.registerCommandAlias("acceptSelectedSuggestionOnEnter","acceptSelectedSuggestion");oe(new Cs({id:"hideSuggestWidget",precondition:ze.Visible,handler:o=>o.cancelSuggestWidget(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:9,secondary:[1033]}}));oe(new Cs({id:"selectNextSuggestion",precondition:K.and(ze.Visible,K.or(ze.MultipleSuggestions,ze.HasFocusedSuggestion.negate())),handler:o=>o.selectNextSuggestion(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:18,secondary:[2066],mac:{primary:18,secondary:[2066,300]}}}));oe(new Cs({id:"selectNextPageSuggestion",precondition:K.and(ze.Visible,K.or(ze.MultipleSuggestions,ze.HasFocusedSuggestion.negate())),handler:o=>o.selectNextPageSuggestion(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:12,secondary:[2060]}}));oe(new Cs({id:"selectLastSuggestion",precondition:K.and(ze.Visible,K.or(ze.MultipleSuggestions,ze.HasFocusedSuggestion.negate())),handler:o=>o.selectLastSuggestion()}));oe(new Cs({id:"selectPrevSuggestion",precondition:K.and(ze.Visible,K.or(ze.MultipleSuggestions,ze.HasFocusedSuggestion.negate())),handler:o=>o.selectPrevSuggestion(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:16,secondary:[2064],mac:{primary:16,secondary:[2064,302]}}}));oe(new Cs({id:"selectPrevPageSuggestion",precondition:K.and(ze.Visible,K.or(ze.MultipleSuggestions,ze.HasFocusedSuggestion.negate())),handler:o=>o.selectPrevPageSuggestion(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:11,secondary:[2059]}}));oe(new Cs({id:"selectFirstSuggestion",precondition:K.and(ze.Visible,K.or(ze.MultipleSuggestions,ze.HasFocusedSuggestion.negate())),handler:o=>o.selectFirstSuggestion()}));oe(new Cs({id:"focusSuggestion",precondition:K.and(ze.Visible,ze.HasFocusedSuggestion.negate()),handler:o=>o.focusSuggestion(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}}}));oe(new Cs({id:"focusAndAcceptSuggestion",precondition:K.and(ze.Visible,ze.HasFocusedSuggestion.negate()),handler:o=>{o.focusSuggestion(),o.acceptSelectedSuggestion(!0,!1)}}));oe(new Cs({id:"toggleSuggestionDetails",precondition:K.and(ze.Visible,ze.HasFocusedSuggestion),handler:o=>o.toggleSuggestionDetails(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:2058,secondary:[2087],mac:{primary:266,secondary:[2087]}},menuOpts:[{menuId:ah,group:"right",order:1,when:K.and(ze.DetailsVisible,ze.CanResolve),title:p("detail.more","Show Less")},{menuId:ah,group:"right",order:1,when:K.and(ze.DetailsVisible.toNegated(),ze.CanResolve),title:p("detail.less","Show More")}]}));oe(new Cs({id:"toggleExplainMode",precondition:ze.Visible,handler:o=>o.toggleExplainMode(),kbOpts:{weight:100,primary:2138}}));oe(new Cs({id:"toggleSuggestionFocus",precondition:ze.Visible,handler:o=>o.toggleSuggestionFocus(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:2570,mac:{primary:778}}}));oe(new Cs({id:"insertBestCompletion",precondition:K.and(T.textInputFocus,K.equals("config.editor.tabCompletion","on"),UL.AtEnd,ze.Visible.toNegated(),q_.OtherSuggestions.toNegated(),ms.InSnippetMode.toNegated()),handler:(o,e)=>{o.triggerSuggestAndAcceptBest(nn(e)?{fallback:"tab",...e}:{fallback:"tab"})},kbOpts:{weight:Ho,primary:2}}));oe(new Cs({id:"insertNextSuggestion",precondition:K.and(T.textInputFocus,K.equals("config.editor.tabCompletion","on"),q_.OtherSuggestions,ze.Visible.toNegated(),ms.InSnippetMode.toNegated()),handler:o=>o.acceptNextSuggestion(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:2}}));oe(new Cs({id:"insertPrevSuggestion",precondition:K.and(T.textInputFocus,K.equals("config.editor.tabCompletion","on"),q_.OtherSuggestions,ze.Visible.toNegated(),ms.InSnippetMode.toNegated()),handler:o=>o.acceptPrevSuggestion(),kbOpts:{weight:Ho,kbExpr:T.textInputFocus,primary:1026}}));X(class extends de{constructor(){super({id:"editor.action.resetSuggestSize",label:p("suggest.reset.label","Reset Suggest Widget Size"),alias:"Reset Suggest Widget Size",precondition:void 0})}run(o,e){Fr.get(e)?.resetWidgetSize()}});class WLe extends F{get selectedItem(){return this._currentSuggestItemInfo}constructor(e,t,i){super(),this.editor=e,this.suggestControllerPreselector=t,this.onWillAccept=i,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this._onDidSelectedItemChange=this._register(new O),this.onDidSelectedItemChange=this._onDidSelectedItemChange.event,this._register(e.onKeyDown(s=>{s.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))})),this._register(e.onKeyUp(s=>{s.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))}));const n=Fr.get(this.editor);if(n){this._register(n.registerSelector({priority:100,select:(a,l,c)=>{const d=this.editor.getModel();if(!d)return-1;const h=this.suggestControllerPreselector(),u=h?mg(h,d):void 0;if(!u)return-1;const g=A.lift(l),f=c.map((_,b)=>{const v=gC.fromSuggestion(n,d,g,_,this.isShiftKeyPressed),y=mg(v.toSingleTextEdit(),d),C=EZ(u,y);return{index:b,valid:C,prefixLength:y.text.length,suggestItem:_}}).filter(_=>_&&_.valid&&_.prefixLength>0),m=e5(f,cs(_=>_.prefixLength,Br));return m?m.index:-1}}));let s=!1;const r=()=>{s||(s=!0,this._register(n.widget.value.onDidShow(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})),this._register(n.widget.value.onDidHide(()=>{this.isSuggestWidgetVisible=!1,this.update(!1)})),this._register(n.widget.value.onDidFocus(()=>{this.isSuggestWidgetVisible=!0,this.update(!0)})))};this._register(se.once(n.model.onDidTrigger)(a=>{r()})),this._register(n.onWillInsertSuggestItem(a=>{const l=this.editor.getPosition(),c=this.editor.getModel();if(!l||!c)return;const d=gC.fromSuggestion(n,c,l,a.item,this.isShiftKeyPressed);this.onWillAccept(d)}))}this.update(this._isActive)}update(e){const t=this.getSuggestItemInfo();(this._isActive!==e||!VLe(this._currentSuggestItemInfo,t))&&(this._isActive=e,this._currentSuggestItemInfo=t,this._onDidSelectedItemChange.fire())}getSuggestItemInfo(){const e=Fr.get(this.editor);if(!e||!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem(),i=this.editor.getPosition(),n=this.editor.getModel();if(!(!t||!i||!n))return gC.fromSuggestion(e,n,i,t.item,this.isShiftKeyPressed)}stopForceRenderingAbove(){Fr.get(this.editor)?.stopForceRenderingAbove()}forceRenderingAbove(){Fr.get(this.editor)?.forceRenderingAbove()}}class gC{static fromSuggestion(e,t,i,n,s){let{insertText:r}=n.completion,a=!1;if(n.completion.insertTextRules&4){const c=new Pf().parse(r);c.children.length<100&&zL.adjustWhitespace(t,i,!0,c),r=c.toString(),a=!0}const l=e.getOverwriteInfo(n,s);return new gC(L.fromPositions(i.delta(0,-l.overwriteBefore),i.delta(0,Math.max(l.overwriteAfter,0))),r,n.completion.kind,a)}constructor(e,t,i,n){this.range=e,this.insertText=t,this.completionItemKind=i,this.isSnippetText=n}equals(e){return this.range.equalsRange(e.range)&&this.insertText===e.insertText&&this.completionItemKind===e.completionItemKind&&this.isSnippetText===e.isSnippetText}toSelectedSuggestionInfo(){return new Cz(this.range,this.insertText,this.completionItemKind,this.isSnippetText)}toSingleTextEdit(){return new Dl(this.range,this.insertText)}}function VLe(o,e){return o===e?!0:!o||!e?!1:o.equals(e)}var HLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Jl=function(o,e){return function(t,i){e(t,i,o)}},$2,Zg;let mr=(Zg=class extends F{static get(e){return e.getContribution($2.ID)}constructor(e,t,i,n,s,r,a,l,c,d){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._configurationService=n,this._commandService=s,this._debounceService=r,this._languageFeaturesService=a,this._accessibilitySignalService=l,this._keybindingService=c,this._accessibilityService=d,this._editorObs=Qs(this.editor),this._positions=me(this,u=>this._editorObs.selections.read(u)?.map(g=>g.getEndPosition())??[new A(1,1)]),this._suggestWidgetAdaptor=this._register(new WLe(this.editor,()=>(this._editorObs.forceUpdate(),this.model.get()?.selectedInlineCompletion.get()?.toSingleTextEdit(void 0)),u=>this._editorObs.forceUpdate(g=>{this.model.get()?.handleSuggestAccepted(u)}))),this._suggestWidgetSelectedItem=yt(this,u=>this._suggestWidgetAdaptor.onDidSelectedItemChange(()=>{this._editorObs.forceUpdate(g=>u(void 0))}),()=>this._suggestWidgetAdaptor.selectedItem),this._enabledInConfig=yt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).enabled),this._isScreenReaderEnabled=yt(this,this._accessibilityService.onDidChangeScreenReaderOptimized,()=>this._accessibilityService.isScreenReaderOptimized()),this._editorDictationInProgress=yt(this,this._contextKeyService.onDidChangeContext,()=>this._contextKeyService.getContext(this.editor.getDomNode()).getValue("editorDictation.inProgress")===!0),this._enabled=me(this,u=>this._enabledInConfig.read(u)&&(!this._isScreenReaderEnabled.read(u)||!this._editorDictationInProgress.read(u))),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this.model=Kn(this,u=>{if(this._editorObs.isReadonly.read(u))return;const g=this._editorObs.model.read(u);return g?this._instantiationService.createInstance(M2,g,this._suggestWidgetSelectedItem,this._editorObs.versionId,this._positions,this._debounceValue,yt(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(119).preview),yt(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(119).previewMode),yt(this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).mode),this._enabled):void 0}).recomputeInitiallyAndOnChange(this._store),this._ghostTexts=me(this,u=>this.model.read(u)?.ghostTexts.read(u)??[]),this._stablizedGhostTexts=zLe(this._ghostTexts,this._store),this._ghostTextWidgets=ule(this,this._stablizedGhostTexts,(u,g)=>g.add(this._instantiationService.createInstance(P2,this.editor,{ghostText:u,minReservedLineCount:rr(0),targetTextModel:this.model.map(f=>f?.textModel)}))).recomputeInitiallyAndOnChange(this._store),this._playAccessibilitySignal=gb(this),this._fontFamily=yt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(62).fontFamily),this._register(new oo(this._contextKeyService,this.model)),this._register(vO(this._editorObs.onDidType,(u,g)=>{this._enabled.get()&&this.model.get()?.trigger()})),this._register(this._commandService.onDidExecuteCommand(u=>{new Set([Zm.Tab.id,Zm.DeleteLeft.id,Zm.DeleteRight.id,Oq,"acceptSelectedSuggestion"]).has(u.commandId)&&e.hasTextFocus()&&this._enabled.get()&&this._editorObs.forceUpdate(f=>{this.model.get()?.trigger(f)})})),this._register(vO(this._editorObs.selections,(u,g)=>{g.some(f=>f.reason===3||f.source==="api")&&this.model.get()?.stop()})),this._register(this.editor.onDidBlurEditorWidget(()=>{this._contextKeyService.getContextKeyValue("accessibleViewIsShown")||this._configurationService.getValue("editor.inlineSuggest.keepOnBlur")||e.getOption(62).keepOnBlur||z_.dropDownVisible||oi(u=>{this.model.get()?.stop(u)})})),this._register(Re(u=>{const g=this.model.read(u)?.state.read(u);g?.suggestItem?g.primaryGhostText.lineCount>=2&&this._suggestWidgetAdaptor.forceRenderingAbove():this._suggestWidgetAdaptor.stopForceRenderingAbove()})),this._register(ve(()=>{this._suggestWidgetAdaptor.stopForceRenderingAbove()}));const h=Bw(this,(u,g)=>{const m=this.model.read(u)?.state.read(u);return this._suggestWidgetSelectedItem.get()?g:m?.inlineCompletion?.semanticId});this._register(Wbe(me(u=>(this._playAccessibilitySignal.read(u),h.read(u),{})),async(u,g,f)=>{const m=this.model.get(),_=m?.state.get();if(!_||!m)return;const b=m.textModel.getLineContent(_.primaryGhostText.lineNumber);await Kc(50,QN(f)),await YG(this._suggestWidgetSelectedItem,Zn,()=>!1,QN(f)),await this._accessibilitySignalService.playSignal(xo.inlineSuggestion),this.editor.getOption(8)&&this._provideScreenReaderUpdate(_.primaryGhostText.renderForScreenReader(b))})),this._register(new QO(this.editor,this.model,this._instantiationService)),this._register(Rxe(me(u=>{const g=this._fontFamily.read(u);return g===""||g==="default"?"":`
.monaco-editor .ghost-text-decoration,
.monaco-editor .ghost-text-decoration-preview,
.monaco-editor .ghost-text {
	font-family: ${g};
}`}))),this._register(this._configurationService.onDidChangeConfiguration(u=>{u.affectsConfiguration("accessibility.verbosity.inlineCompletions")&&this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})})),this.editor.updateOptions({inlineCompletionsAccessibilityVerbose:this._configurationService.getValue("accessibility.verbosity.inlineCompletions")})}playAccessibilitySignal(e){this._playAccessibilitySignal.trigger(e)}_provideScreenReaderUpdate(e){const t=this._contextKeyService.getContextKeyValue("accessibleViewIsShown"),i=this._keybindingService.lookupKeybinding("editor.action.accessibleView");let n;!t&&i&&this.editor.getOption(150)&&(n=p("showAccessibleViewHint","Inspect this in the accessible view ({0})",i.getAriaLabel())),ps(n?e+", "+n:e)}shouldShowHoverAt(e){const t=this.model.get()?.primaryGhostText.get();return t?t.parts.some(i=>e.containsPosition(new A(t.lineNumber,i.column))):!1}shouldShowHoverAtViewZone(e){return this._ghostTextWidgets.get()[0]?.ownsViewZone(e)??!1}},$2=Zg,Zg.ID="editor.contrib.inlineCompletionsController",Zg);mr=$2=HLe([Jl(1,Ce),Jl(2,Ee),Jl(3,Ke),Jl(4,Ft),Jl(5,Uo),Jl(6,ue),Jl(7,Jh),Jl(8,vt),Jl(9,ho)],mr);function zLe(o,e){const t=$e("result",[]),i=[];return e.add(Re(n=>{const s=o.read(n);oi(r=>{if(s.length!==i.length){i.length=s.length;for(let a=0;a<i.length;a++)i[a]||(i[a]=$e("item",s[a]));t.set([...i],r)}i.forEach((a,l)=>a.set(s[l],r))})})),t}const yE=class yE extends de{constructor(){super({id:yE.ID,label:p("action.inlineSuggest.showNext","Show Next Inline Suggestion"),alias:"Show Next Inline Suggestion",precondition:K.and(T.writable,oo.inlineSuggestionVisible),kbOpts:{weight:100,primary:606}})}async run(e,t){mr.get(t)?.model.get()?.next()}};yE.ID=Bq;let K2=yE;const wE=class wE extends de{constructor(){super({id:wE.ID,label:p("action.inlineSuggest.showPrevious","Show Previous Inline Suggestion"),alias:"Show Previous Inline Suggestion",precondition:K.and(T.writable,oo.inlineSuggestionVisible),kbOpts:{weight:100,primary:604}})}async run(e,t){mr.get(t)?.model.get()?.previous()}};wE.ID=Fq;let j2=wE;class ULe extends de{constructor(){super({id:"editor.action.inlineSuggest.trigger",label:p("action.inlineSuggest.trigger","Trigger Inline Suggestion"),alias:"Trigger Inline Suggestion",precondition:T.writable})}async run(e,t){const i=mr.get(t);await jG(async n=>{await i?.model.get()?.triggerExplicitly(n),i?.playAccessibilitySignal(n)})}}class GLe extends de{constructor(){super({id:"editor.action.inlineSuggest.acceptNextWord",label:p("action.inlineSuggest.acceptNextWord","Accept Next Word Of Inline Suggestion"),alias:"Accept Next Word Of Inline Suggestion",precondition:K.and(T.writable,oo.inlineSuggestionVisible),kbOpts:{weight:101,primary:2065,kbExpr:K.and(T.writable,oo.inlineSuggestionVisible)},menuOpts:[{menuId:fe.InlineSuggestionToolbar,title:p("acceptWord","Accept Word"),group:"primary",order:2}]})}async run(e,t){const i=mr.get(t);await i?.model.get()?.acceptNextWord(i.editor)}}class $Le extends de{constructor(){super({id:"editor.action.inlineSuggest.acceptNextLine",label:p("action.inlineSuggest.acceptNextLine","Accept Next Line Of Inline Suggestion"),alias:"Accept Next Line Of Inline Suggestion",precondition:K.and(T.writable,oo.inlineSuggestionVisible),kbOpts:{weight:101},menuOpts:[{menuId:fe.InlineSuggestionToolbar,title:p("acceptLine","Accept Line"),group:"secondary",order:2}]})}async run(e,t){const i=mr.get(t);await i?.model.get()?.acceptNextLine(i.editor)}}class KLe extends de{constructor(){super({id:Oq,label:p("action.inlineSuggest.accept","Accept Inline Suggestion"),alias:"Accept Inline Suggestion",precondition:oo.inlineSuggestionVisible,menuOpts:[{menuId:fe.InlineSuggestionToolbar,title:p("accept","Accept"),group:"primary",order:1}],kbOpts:{primary:2,weight:200,kbExpr:K.and(oo.inlineSuggestionVisible,T.tabMovesFocus.toNegated(),oo.inlineSuggestionHasIndentationLessThanTabSize,ze.Visible.toNegated(),T.hoverFocused.toNegated())}})}async run(e,t){const i=mr.get(t);i&&(i.model.get()?.accept(i.editor),i.editor.focus())}}const SE=class SE extends de{constructor(){super({id:SE.ID,label:p("action.inlineSuggest.hide","Hide Inline Suggestion"),alias:"Hide Inline Suggestion",precondition:oo.inlineSuggestionVisible,kbOpts:{weight:100,primary:9}})}async run(e,t){const i=mr.get(t);oi(n=>{i?.model.get()?.stop(n)})}};SE.ID="editor.action.inlineSuggest.hide";let q2=SE;const xE=class xE extends _s{constructor(){super({id:xE.ID,title:p("action.inlineSuggest.alwaysShowToolbar","Always Show Toolbar"),f1:!1,precondition:void 0,menu:[{id:fe.InlineSuggestionToolbar,group:"secondary",order:10}],toggled:K.equals("config.editor.inlineSuggest.showToolbar","always")})}async run(e,t){const i=e.get(Ke),s=i.getValue("editor.inlineSuggest.showToolbar")==="always"?"onHover":"always";i.updateValue("editor.inlineSuggest.showToolbar",s)}};xE.ID="editor.action.inlineSuggest.toggleAlwaysShowToolbar";let Z2=xE;var jLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},rv=function(o,e){return function(t,i){e(t,i,o)}};class qLe{constructor(e,t,i){this.owner=e,this.range=t,this.controller=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}let Y2=class{constructor(e,t,i,n,s,r){this._editor=e,this._languageService=t,this._openerService=i,this.accessibilityService=n,this._instantiationService=s,this._telemetryService=r,this.hoverOrdinal=4}suggestHoverAnchor(e){const t=mr.get(this._editor);if(!t)return null;const i=e.target;if(i.type===8){const n=i.detail;if(t.shouldShowHoverAtViewZone(n.viewZoneId))return new i0(1e3,this,L.fromPositions(this._editor.getModel().validatePosition(n.positionBefore||n.position)),e.event.posx,e.event.posy,!1)}return i.type===7&&t.shouldShowHoverAt(i.range)?new i0(1e3,this,i.range,e.event.posx,e.event.posy,!1):i.type===6&&i.detail.mightBeForeignElement&&t.shouldShowHoverAt(i.range)?new i0(1e3,this,i.range,e.event.posx,e.event.posy,!1):null}computeSync(e,t){if(this._editor.getOption(62).showToolbar!=="onHover")return[];const i=mr.get(this._editor);return i&&i.shouldShowHoverAt(e.range)?[new qLe(this,e.range,i)]:[]}renderHoverParts(e,t){const i=new $,n=t[0];this._telemetryService.publicLog2("inlineCompletionHover.shown"),this.accessibilityService.isScreenReaderOptimized()&&!this._editor.getOption(8)&&i.add(this.renderScreenReaderText(e,n));const s=n.controller.model.get(),r=this._instantiationService.createInstance(z_,this._editor,!1,rr(null),s.selectedInlineCompletionIndex,s.inlineCompletionsCount,s.activeCommands),a=r.getDomNode();e.fragment.appendChild(a),s.triggerExplicitly(),i.add(r);const l={hoverPart:n,hoverElement:a,dispose(){i.dispose()}};return new Ff([l])}renderScreenReaderText(e,t){const i=new $,n=ie,s=n("div.hover-row.markdown-hover"),r=Y(s,n("div.hover-contents",{"aria-live":"assertive"})),a=i.add(new Zc({editor:this._editor},this._languageService,this._openerService)),l=c=>{i.add(a.onDidRenderAsync(()=>{r.className="hover-contents code-hover-contents",e.onContentsChanged()}));const d=p("inlineSuggestionFollows","Suggestion:"),h=i.add(a.render(new Pn().appendText(d).appendCodeblock("text",c)));r.replaceChildren(h.element)};return i.add(Re(c=>{const d=t.controller.model.read(c)?.primaryGhostText.read(c);if(d){const h=this._editor.getModel().getLineContent(d.lineNumber);l(d.renderForScreenReader(h))}else pn(r)})),e.fragment.appendChild(s),i}};Y2=jLe([rv(1,ti),rv(2,Fs),rv(3,ho),rv(4,Ce),rv(5,Fn)],Y2);class ZLe{}const DD=new class{constructor(){this._implementations=[]}register(e){return this._implementations.push(e),{dispose:()=>{const t=this._implementations.indexOf(e);t!==-1&&this._implementations.splice(t,1)}}}getImplementations(){return this._implementations}};at(mr.ID,mr,3);X(ULe);X(K2);X(j2);X(GLe);X($Le);X(KLe);X(q2);At(Z2);np.register(Y2);DD.register(new ZLe);var YLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},RN=function(o,e){return function(t,i){e(t,i,o)}},kv,vh;let sw=(vh=class{constructor(e,t,i,n){this.textModelResolverService=t,this.languageService=i,this.languageFeaturesService=n,this.toUnhook=new $,this.toUnhookForKeyboard=new $,this.currentWordAtPosition=null,this.previousPromise=null,this.editor=e,this.linkDecorations=this.editor.createDecorationsCollection();const s=new yD(e);this.toUnhook.add(s),this.toUnhook.add(s.onMouseMoveOrRelevantKeyDown(([r,a])=>{this.startFindDefinitionFromMouse(r,a??void 0)})),this.toUnhook.add(s.onExecute(r=>{this.isEnabled(r)&&this.gotoDefinition(r.target.position,r.hasSideBySideModifier).catch(a=>{Ae(a)}).finally(()=>{this.removeLinkDecorations()})})),this.toUnhook.add(s.onCancel(()=>{this.removeLinkDecorations(),this.currentWordAtPosition=null}))}static get(e){return e.getContribution(kv.ID)}async startFindDefinitionFromCursor(e){await this.startFindDefinition(e),this.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(()=>{this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear()})),this.toUnhookForKeyboard.add(this.editor.onKeyDown(t=>{t&&(this.currentWordAtPosition=null,this.removeLinkDecorations(),this.toUnhookForKeyboard.clear())}))}startFindDefinitionFromMouse(e,t){if(e.target.type===9&&this.linkDecorations.length>0)return;if(!this.editor.hasModel()||!this.isEnabled(e,t)){this.currentWordAtPosition=null,this.removeLinkDecorations();return}const i=e.target.position;this.startFindDefinition(i)}async startFindDefinition(e){this.toUnhookForKeyboard.clear();const t=e?this.editor.getModel()?.getWordAtPosition(e):null;if(!t){this.currentWordAtPosition=null,this.removeLinkDecorations();return}if(this.currentWordAtPosition&&this.currentWordAtPosition.startColumn===t.startColumn&&this.currentWordAtPosition.endColumn===t.endColumn&&this.currentWordAtPosition.word===t.word)return;this.currentWordAtPosition=t;const i=new Cj(this.editor,15);this.previousPromise&&(this.previousPromise.cancel(),this.previousPromise=null),this.previousPromise=ji(r=>this.findDefinition(e,r));let n;try{n=await this.previousPromise}catch(r){Ae(r);return}if(!n||!n.length||!i.validate(this.editor)){this.removeLinkDecorations();return}const s=n[0].originSelectionRange?L.lift(n[0].originSelectionRange):new L(e.lineNumber,t.startColumn,e.lineNumber,t.endColumn);if(n.length>1){let r=s;for(const{originSelectionRange:a}of n)a&&(r=L.plusRange(r,a));this.addDecoration(r,new Pn().appendText(p("multipleResults","Click to show {0} definitions.",n.length)))}else{const r=n[0];if(!r.uri)return;this.textModelResolverService.createModelReference(r.uri).then(a=>{if(!a.object||!a.object.textEditorModel){a.dispose();return}const{object:{textEditorModel:l}}=a,{startLineNumber:c}=r.range;if(c<1||c>l.getLineCount()){a.dispose();return}const d=this.getPreviewValue(l,c,r),h=this.languageService.guessLanguageIdByFilepathOrFirstLine(l.uri);this.addDecoration(s,d?new Pn().appendCodeblock(h||"",d):void 0),a.dispose()})}}getPreviewValue(e,t,i){let n=i.range;return n.endLineNumber-n.startLineNumber>=kv.MAX_SOURCE_PREVIEW_LINES&&(n=this.getPreviewRangeBasedOnIndentation(e,t)),this.stripIndentationFromPreviewRange(e,t,n)}stripIndentationFromPreviewRange(e,t,i){let s=e.getLineFirstNonWhitespaceColumn(t);for(let a=t+1;a<i.endLineNumber;a++){const l=e.getLineFirstNonWhitespaceColumn(a);s=Math.min(s,l)}return e.getValueInRange(i).replace(new RegExp(`^\\s{${s-1}}`,"gm"),"").trim()}getPreviewRangeBasedOnIndentation(e,t){const i=e.getLineFirstNonWhitespaceColumn(t),n=Math.min(e.getLineCount(),t+kv.MAX_SOURCE_PREVIEW_LINES);let s=t+1;for(;s<n;s++){const r=e.getLineFirstNonWhitespaceColumn(s);if(i===r)break}return new L(t,1,s+1,1)}addDecoration(e,t){const i={range:e,options:{description:"goto-definition-link",inlineClassName:"goto-definition-link",hoverMessage:t}};this.linkDecorations.set([i])}removeLinkDecorations(){this.linkDecorations.clear()}isEnabled(e,t){return this.editor.hasModel()&&e.isLeftClick&&e.isNoneOrSingleMouseDown&&e.target.type===6&&!(e.target.detail.injectedText?.options instanceof Wh)&&(e.hasTriggerModifier||(t?t.keyCodeIsTriggerKey:!1))&&this.languageFeaturesService.definitionProvider.has(this.editor.getModel())}findDefinition(e,t){const i=this.editor.getModel();return i?iS(this.languageFeaturesService.definitionProvider,i,e,!1,t):Promise.resolve(null)}gotoDefinition(e,t){return this.editor.setPosition(e),this.editor.invokeWithinContext(i=>{const n=!t&&this.editor.getOption(89)&&!this.isInPeekEditor(i);return new sS({openToSide:t,openInPeek:n,muteMessage:!0},{title:{value:"",original:""},id:"",precondition:void 0}).run(i)})}isInPeekEditor(e){const t=e.get(Ee);return Ps.inPeekEditor.getValue(t)}dispose(){this.toUnhook.dispose(),this.toUnhookForKeyboard.dispose()}},kv=vh,vh.ID="editor.contrib.gotodefinitionatposition",vh.MAX_SOURCE_PREVIEW_LINES=8,vh);sw=kv=YLe([RN(1,Ms),RN(2,ti),RN(3,ue)],sw);at(sw.ID,sw,2);var DZ=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},qL=function(o,e){return function(t,i){e(t,i,o)}};class g6{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let X2=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new O,this.onDidChange=this._onDidChange.event,this._dispoables=new $,this._markers=[],this._nextIdx=-1,ye.isUri(e)?this._resourceFilter=a=>a.toString()===e.toString():e&&(this._resourceFilter=e);const n=this._configService.getValue("problems.sortOrder"),s=(a,l)=>{let c=jC(a.resource.toString(),l.resource.toString());return c===0&&(n==="position"?c=L.compareRangesUsingStarts(a,l)||pi.compare(a.severity,l.severity):c=pi.compare(a.severity,l.severity)||L.compareRangesUsingStarts(a,l)),c},r=()=>{this._markers=this._markerService.read({resource:ye.isUri(e)?e:void 0,severities:pi.Error|pi.Warning|pi.Info}),typeof e=="function"&&(this._markers=this._markers.filter(a=>this._resourceFilter(a.resource))),this._markers.sort(s)};r(),this._dispoables.add(t.onMarkerChanged(a=>{(!this._resourceFilter||a.some(l=>this._resourceFilter(l)))&&(r(),this._nextIdx=-1,this._onDidChange.fire())}))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e?!0:!this._resourceFilter||!e?!1:this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new g6(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let n=!1,s=this._markers.findIndex(r=>r.resource.toString()===e.uri.toString());s<0&&(s=BC(this._markers,{resource:e.uri},(r,a)=>jC(r.resource.toString(),a.resource.toString())),s<0&&(s=~s));for(let r=s;r<this._markers.length;r++){let a=L.lift(this._markers[r]);if(a.isEmpty()){const l=e.getWordAtPosition(a.getStartPosition());l&&(a=new L(a.startLineNumber,l.startColumn,a.startLineNumber,l.endColumn))}if(t&&(a.containsPosition(t)||t.isBeforeOrEqual(a.getStartPosition()))){this._nextIdx=r,n=!0;break}if(this._markers[r].resource.toString()!==e.uri.toString())break}n||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(this._markers.length===0)return!1;const n=this._nextIdx;return this._nextIdx===-1?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),n!==this._nextIdx}find(e,t){let i=this._markers.findIndex(n=>n.resource.toString()===e.toString());if(!(i<0)){for(;i<this._markers.length;i++)if(L.containsPosition(this._markers[i],t))return new g6(this._markers[i],i+1,this._markers.length)}}};X2=DZ([qL(1,Ul),qL(2,Ke)],X2);const IZ=Je("IMarkerNavigationService");let Q2=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new os}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new X2(e,this._markerService,this._configService)}};Q2=DZ([qL(0,Ul),qL(1,Ke)],Q2);it(IZ,Q2,1);var J2;(function(o){function e(t){switch(t){case ki.Ignore:return"severity-ignore "+ke.asClassName(J.info);case ki.Info:return ke.asClassName(J.info);case ki.Warning:return ke.asClassName(J.warning);case ki.Error:return ke.asClassName(J.error);default:return""}}o.className=e})(J2||(J2={}));var XLe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Np=function(o,e){return function(t,i){e(t,i,o)}},eF;class QLe{constructor(e,t,i,n,s){this._openerService=n,this._labelService=s,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new $,this._editor=t;const r=document.createElement("div");r.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),r.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),r.appendChild(this._relatedBlock),this._disposables.add(ci(this._relatedBlock,"click",a=>{a.preventDefault();const l=this._relatedDiagnostics.get(a.target);l&&i(l)})),this._scrollable=new vG(r,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll(a=>{r.style.left=`-${a.scrollLeft}px`,r.style.top=`-${a.scrollTop}px`})),this._disposables.add(this._scrollable)}dispose(){Dt(this._disposables)}update(e){const{source:t,message:i,relatedInformation:n,code:s}=e;let r=(t?.length||0)+2;s&&(typeof s=="string"?r+=s.length:r+=s.value.length);const a=Bl(i);this._lines=a.length,this._longestLineLength=0;for(const u of a)this._longestLineLength=Math.max(u.length+r,this._longestLineLength);fn(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let l=this._messageBlock;for(const u of a)l=document.createElement("div"),l.innerText=u,u===""&&(l.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(l);if(t||s){const u=document.createElement("span");if(u.classList.add("details"),l.appendChild(u),t){const g=document.createElement("span");g.innerText=t,g.classList.add("source"),u.appendChild(g)}if(s)if(typeof s=="string"){const g=document.createElement("span");g.innerText=`(${s})`,g.classList.add("code"),u.appendChild(g)}else{this._codeLink=ie("a.code-link"),this._codeLink.setAttribute("href",`${s.target.toString()}`),this._codeLink.onclick=f=>{this._openerService.open(s.target,{allowCommands:!0}),f.preventDefault(),f.stopPropagation()};const g=Y(this._codeLink,ie("span"));g.innerText=s.value,u.appendChild(this._codeLink)}}if(fn(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),Yn(n)){const u=this._relatedBlock.appendChild(document.createElement("div"));u.style.paddingTop=`${Math.floor(this._editor.getOption(67)*.66)}px`,this._lines+=1;for(const g of n){const f=document.createElement("div"),m=document.createElement("a");m.classList.add("filename"),m.innerText=`${this._labelService.getUriBasenameLabel(g.resource)}(${g.startLineNumber}, ${g.startColumn}): `,m.title=this._labelService.getUriLabel(g.resource),this._relatedDiagnostics.set(m,g);const _=document.createElement("span");_.innerText=g.message,f.appendChild(m),f.appendChild(_),this._lines+=1,u.appendChild(f)}}const c=this._editor.getOption(50),d=Math.ceil(c.typicalFullwidthCharacterWidth*this._longestLineLength*.75),h=c.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:d,scrollHeight:h})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case pi.Error:t=p("Error","Error");break;case pi.Warning:t=p("Warning","Warning");break;case pi.Info:t=p("Info","Info");break;case pi.Hint:t=p("Hint","Hint");break}let i=p("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const n=this._editor.getModel();return n&&e.startLineNumber<=n.getLineCount()&&e.startLineNumber>=1&&(i=`${n.getLineContent(e.startLineNumber)}, ${i}`),i}}var Yg;let ow=(Yg=class extends LL{constructor(e,t,i,n,s,r,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},s),this._themeService=t,this._openerService=i,this._menuService=n,this._contextKeyService=r,this._labelService=a,this._callOnDispose=new $,this._onDidSelectRelatedInformation=new O,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=pi.Warning,this._backgroundColor=j.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(ike);let t=tF,i=JLe;this._severity===pi.Warning?(t=r0,i=eke):this._severity===pi.Info&&(t=iF,i=tke);const n=e.getColor(t),s=e.getColor(i);this.style({arrowColor:n,frameColor:n,headerBackgroundColor:s,primaryHeadingColor:e.getColor(qq),secondaryHeadingColor:e.getColor(Zq)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(e){super._fillHead(e),this._disposables.add(this._actionbarWidget.actionRunner.onWillRun(n=>this.editor.focus()));const t=[],i=this._menuService.getMenuActions(eF.TitleMenu,this._contextKeyService);$T(i,t),this._actionbarWidget.push(t,{label:!1,icon:!0,index:0})}_fillTitleIcon(e){this._icon=Y(e,ie(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new QLe(this._container,this.editor,t=>this._onDidSelectRelatedInformation.fire(t),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const n=L.lift(e),s=this.editor.getPosition(),r=s&&n.containsPosition(s)?s:n.getStartPosition();super.show(r,this.computeRequiredHeight());const a=this.editor.getModel();if(a){const l=i>1?p("problems","{0} of {1} problems",t,i):p("change","{0} of {1} problem",t,i);this.setTitle(fr(a.uri),l)}this._icon.className=`codicon ${J2.className(pi.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(r,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}},eF=Yg,Yg.TitleMenu=new fe("gotoErrorTitleMenu"),Yg);ow=eF=XLe([Np(1,zi),Np(2,Fs),Np(3,zo),Np(4,Ce),Np(5,Ee),Np(6,E_)],ow);const f6=sy(ET,Kne),p6=sy(qc,oy),m6=sy(Nl,ry),tF=D("editorMarkerNavigationError.background",{dark:f6,light:f6,hcDark:rt,hcLight:rt},p("editorMarkerNavigationError","Editor marker navigation widget error color.")),JLe=D("editorMarkerNavigationError.headerBackground",{dark:Ue(tF,.1),light:Ue(tF,.1),hcDark:null,hcLight:null},p("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),r0=D("editorMarkerNavigationWarning.background",{dark:p6,light:p6,hcDark:rt,hcLight:rt},p("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),eke=D("editorMarkerNavigationWarning.headerBackground",{dark:Ue(r0,.1),light:Ue(r0,.1),hcDark:"#0C141F",hcLight:Ue(r0,.2)},p("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),iF=D("editorMarkerNavigationInfo.background",{dark:m6,light:m6,hcDark:rt,hcLight:rt},p("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),tke=D("editorMarkerNavigationInfo.headerBackground",{dark:Ue(iF,.1),light:Ue(iF,.1),hcDark:null,hcLight:null},p("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),ike=D("editorMarkerNavigation.background",$r,p("editorMarkerNavigationBackground","Editor marker navigation widget background."));var nke=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},C1=function(o,e){return function(t,i){e(t,i,o)}},Ev,Xg;let Vf=(Xg=class{static get(e){return e.getContribution(Ev.ID)}constructor(e,t,i,n,s){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=n,this._instantiationService=s,this._sessionDispoables=new $,this._editor=e,this._widgetVisible=NZ.bindTo(this._contextKeyService)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance(ow,this._editor),this._widget.onDidClose(()=>this.close(),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition(i=>{(!this._model?.selected||!L.containsPosition(this._model?.selected.marker,i.position))&&this._model?.resetIndex()})),this._sessionDispoables.add(this._model.onDidChange(()=>{if(!this._widget||!this._widget.position||!this._model)return;const i=this._model.find(this._editor.getModel().uri,this._widget.position);i?this._widget.updateMarker(i.marker):this._widget.showStale()})),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation(i=>{this._editorService.openCodeEditor({resource:i.resource,options:{pinned:!0,revealIfOpened:!0,selection:L.lift(i).collapseToStart()}},this._editor),this.close(!1)})),this._sessionDispoables.add(this._editor.onDidChangeModel(()=>this._cleanUp())),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new A(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}async nagivate(e,t){if(this._editor.hasModel()){const i=this._getOrCreateModel(t?void 0:this._editor.getModel().uri);if(i.move(e,this._editor.getModel(),this._editor.getPosition()),!i.selected)return;if(i.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const n=await this._editorService.openCodeEditor({resource:i.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:i.selected.marker}},this._editor);n&&(Ev.get(n)?.close(),Ev.get(n)?.nagivate(e,t))}else this._widget.showAtMarker(i.selected.marker,i.selected.index,i.selected.total)}}},Ev=Xg,Xg.ID="editor.contrib.markerController",Xg);Vf=Ev=nke([C1(1,IZ),C1(2,Ee),C1(3,gt),C1(4,Ce)],Vf);class ID extends de{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}async run(e,t){t.hasModel()&&Vf.get(t)?.nagivate(this._next,this._multiFile)}}const Zu=class Zu extends ID{constructor(){super(!0,!1,{id:Zu.ID,label:Zu.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:578,weight:100},menuOpts:{menuId:ow.TitleMenu,title:Zu.LABEL,icon:Gt("marker-navigation-next",J.arrowDown,p("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}};Zu.ID="editor.action.marker.next",Zu.LABEL=p("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");let ZL=Zu;const Yu=class Yu extends ID{constructor(){super(!1,!1,{id:Yu.ID,label:Yu.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:1602,weight:100},menuOpts:{menuId:ow.TitleMenu,title:Yu.LABEL,icon:Gt("marker-navigation-previous",J.arrowUp,p("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}};Yu.ID="editor.action.marker.prev",Yu.LABEL=p("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");let nF=Yu;class ske extends ID{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:p("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:66,weight:100},menuOpts:{menuId:fe.MenubarGoMenu,title:p({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}class oke extends ID{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:p("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:1090,weight:100},menuOpts:{menuId:fe.MenubarGoMenu,title:p({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}}at(Vf.ID,Vf,4);X(ZL);X(nF);X(ske);X(oke);const NZ=new re("markersNavigationVisible",!1),rke=Hi.bindToContribution(Vf.get);oe(new rke({id:"closeMarkersNavigation",precondition:NZ,handler:o=>o.close(),kbOpts:{weight:150,kbExpr:T.focus,primary:9,secondary:[1033]}}));var ra;(function(o){o.NoAutoFocus="noAutoFocus",o.FocusIfVisible="focusIfVisible",o.AutoFocusImmediately="autoFocusImmediately"})(ra||(ra={}));class ake extends de{constructor(){super({id:Mq,label:p({key:"showOrFocusHover",comment:["Label for action that will trigger the showing/focusing of a hover in the editor.","If the hover is not visible, it will show the hover.","This allows for users to show the hover without using the mouse."]},"Show or Focus Hover"),metadata:{description:De("showOrFocusHoverDescription","Show or focus the editor hover which shows documentation, references, and other content for a symbol at the current cursor position."),args:[{name:"args",schema:{type:"object",properties:{focus:{description:"Controls if and when the hover should take focus upon being triggered by this action.",enum:[ra.NoAutoFocus,ra.FocusIfVisible,ra.AutoFocusImmediately],enumDescriptions:[p("showOrFocusHover.focus.noAutoFocus","The hover will not automatically take focus."),p("showOrFocusHover.focus.focusIfVisible","The hover will take focus only if it is already visible."),p("showOrFocusHover.focus.autoFocusImmediately","The hover will automatically take focus when it appears.")],default:ra.FocusIfVisible}}}}]},alias:"Show or Focus Hover",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2087),weight:100}})}run(e,t,i){if(!t.hasModel())return;const n=Qn.get(t);if(!n)return;const s=i?.focus;let r=ra.FocusIfVisible;Object.values(ra).includes(s)?r=s:typeof s=="boolean"&&s&&(r=ra.AutoFocusImmediately);const a=c=>{const d=t.getPosition(),h=new L(d.lineNumber,d.column,d.lineNumber,d.column);n.showContentHover(h,1,1,c)},l=t.getOption(2)===2;n.isHoverVisible?r!==ra.NoAutoFocus?n.focus():a(l):a(l||r===ra.AutoFocusImmediately)}}class lke extends de{constructor(){super({id:LSe,label:p({key:"showDefinitionPreviewHover",comment:["Label for action that will trigger the showing of definition preview hover in the editor.","This allows for users to show the definition preview hover without using the mouse."]},"Show Definition Preview Hover"),alias:"Show Definition Preview Hover",precondition:void 0,metadata:{description:De("showDefinitionPreviewHoverDescription","Show the definition preview hover in the editor.")}})}run(e,t){const i=Qn.get(t);if(!i)return;const n=t.getPosition();if(!n)return;const s=new L(n.lineNumber,n.column,n.lineNumber,n.column),r=sw.get(t);if(!r)return;r.startFindDefinitionFromCursor(n).then(()=>{i.showContentHover(s,1,1,!0)})}}class cke extends de{constructor(){super({id:kSe,label:p({key:"scrollUpHover",comment:["Action that allows to scroll up in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Up Hover"),alias:"Scroll Up Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:16,weight:100},metadata:{description:De("scrollUpHoverDescription","Scroll up the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.scrollUp()}}class dke extends de{constructor(){super({id:ESe,label:p({key:"scrollDownHover",comment:["Action that allows to scroll down in the hover widget with the up arrow when the hover widget is focused."]},"Scroll Down Hover"),alias:"Scroll Down Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:18,weight:100},metadata:{description:De("scrollDownHoverDescription","Scroll down the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.scrollDown()}}class hke extends de{constructor(){super({id:TSe,label:p({key:"scrollLeftHover",comment:["Action that allows to scroll left in the hover widget with the left arrow when the hover widget is focused."]},"Scroll Left Hover"),alias:"Scroll Left Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:15,weight:100},metadata:{description:De("scrollLeftHoverDescription","Scroll left the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.scrollLeft()}}class uke extends de{constructor(){super({id:DSe,label:p({key:"scrollRightHover",comment:["Action that allows to scroll right in the hover widget with the right arrow when the hover widget is focused."]},"Scroll Right Hover"),alias:"Scroll Right Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:17,weight:100},metadata:{description:De("scrollRightHoverDescription","Scroll right the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.scrollRight()}}class gke extends de{constructor(){super({id:ISe,label:p({key:"pageUpHover",comment:["Action that allows to page up in the hover widget with the page up command when the hover widget is focused."]},"Page Up Hover"),alias:"Page Up Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:11,secondary:[528],weight:100},metadata:{description:De("pageUpHoverDescription","Page up the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.pageUp()}}class fke extends de{constructor(){super({id:NSe,label:p({key:"pageDownHover",comment:["Action that allows to page down in the hover widget with the page down command when the hover widget is focused."]},"Page Down Hover"),alias:"Page Down Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:12,secondary:[530],weight:100},metadata:{description:De("pageDownHoverDescription","Page down the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.pageDown()}}class pke extends de{constructor(){super({id:RSe,label:p({key:"goToTopHover",comment:["Action that allows to go to the top of the hover widget with the home command when the hover widget is focused."]},"Go To Top Hover"),alias:"Go To Bottom Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:14,secondary:[2064],weight:100},metadata:{description:De("goToTopHoverDescription","Go to the top of the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.goToTop()}}class mke extends de{constructor(){super({id:PSe,label:p({key:"goToBottomHover",comment:["Action that allows to go to the bottom in the hover widget with the end command when the hover widget is focused."]},"Go To Bottom Hover"),alias:"Go To Bottom Hover",precondition:T.hoverFocused,kbOpts:{kbExpr:T.hoverFocused,primary:13,secondary:[2066],weight:100},metadata:{description:De("goToBottomHoverDescription","Go to the bottom of the editor hover.")}})}run(e,t){const i=Qn.get(t);i&&i.goToBottom()}}class _ke extends de{constructor(){super({id:bD,label:ASe,alias:"Increase Hover Verbosity Level",precondition:T.hoverVisible})}run(e,t,i){const n=Qn.get(t);if(!n)return;const s=i?.index!==void 0?i.index:n.focusedHoverPartIndex();n.updateHoverVerbosityLevel(Zs.Increase,s,i?.focus)}}class bke extends de{constructor(){super({id:vD,label:MSe,alias:"Decrease Hover Verbosity Level",precondition:T.hoverVisible})}run(e,t,i){const n=Qn.get(t);if(!n)return;const s=i?.index!==void 0?i.index:n.focusedHoverPartIndex();Qn.get(t)?.updateHoverVerbosityLevel(Zs.Decrease,s,i?.focus)}}var vke=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},PN=function(o,e){return function(t,i){e(t,i,o)}};const Sr=ie;class Cke{constructor(e,t,i){this.owner=e,this.range=t,this.marker=i}isValidForHoverAnchor(e){return e.type===1&&this.range.startColumn<=e.range.startColumn&&this.range.endColumn>=e.range.endColumn}}const _6={type:1,filter:{include:jt.QuickFix},triggerAction:lo.QuickFixHover};let sF=class{constructor(e,t,i,n){this._editor=e,this._markerDecorationsService=t,this._openerService=i,this._languageFeaturesService=n,this.hoverOrdinal=1,this.recentMarkerCodeActionsInfo=void 0}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1&&!e.supportsMarkerHover)return[];const i=this._editor.getModel(),n=e.range.startLineNumber,s=i.getLineMaxColumn(n),r=[];for(const a of t){const l=a.range.startLineNumber===n?a.range.startColumn:1,c=a.range.endLineNumber===n?a.range.endColumn:s,d=this._markerDecorationsService.getMarker(i.uri,a);if(!d)continue;const h=new L(e.range.startLineNumber,l,e.range.startLineNumber,c);r.push(new Cke(this,h,d))}return r}renderHoverParts(e,t){if(!t.length)return new Ff([]);const i=new $,n=[];t.forEach(r=>{const a=this._renderMarkerHover(r);e.fragment.appendChild(a.hoverElement),n.push(a)});const s=t.length===1?t[0]:t.sort((r,a)=>pi.compare(r.marker.severity,a.marker.severity))[0];return this.renderMarkerStatusbar(e,s,i),new Ff(n)}_renderMarkerHover(e){const t=new $,i=Sr("div.hover-row"),n=Y(i,Sr("div.marker.hover-contents")),{source:s,message:r,code:a,relatedInformation:l}=e.marker;this._editor.applyFontInfo(n);const c=Y(n,Sr("span"));if(c.style.whiteSpace="pre-wrap",c.innerText=r,s||a)if(a&&typeof a!="string"){const h=Sr("span");if(s){const m=Y(h,Sr("span"));m.innerText=s}const u=Y(h,Sr("a.code-link"));u.setAttribute("href",a.target.toString()),t.add(H(u,"click",m=>{this._openerService.open(a.target,{allowCommands:!0}),m.preventDefault(),m.stopPropagation()}));const g=Y(u,Sr("span"));g.innerText=a.value;const f=Y(n,h);f.style.opacity="0.6",f.style.paddingLeft="6px"}else{const h=Y(n,Sr("span"));h.style.opacity="0.6",h.style.paddingLeft="6px",h.innerText=s&&a?`${s}(${a})`:s||`(${a})`}if(Yn(l))for(const{message:h,resource:u,startLineNumber:g,startColumn:f}of l){const m=Y(n,Sr("div"));m.style.marginTop="8px";const _=Y(m,Sr("a"));_.innerText=`${fr(u)}(${g}, ${f}): `,_.style.cursor="pointer",t.add(H(_,"click",v=>{if(v.stopPropagation(),v.preventDefault(),this._openerService){const y={selection:{startLineNumber:g,startColumn:f}};this._openerService.open(u,{fromUserGesture:!0,editorOptions:y}).catch(Ae)}}));const b=Y(m,Sr("span"));b.innerText=h,this._editor.applyFontInfo(b)}return{hoverPart:e,hoverElement:i,dispose:()=>t.dispose()}}renderMarkerStatusbar(e,t,i){if(t.marker.severity===pi.Error||t.marker.severity===pi.Warning||t.marker.severity===pi.Info){const n=Vf.get(this._editor);n&&e.statusBar.addAction({label:p("view problem","View Problem"),commandId:ZL.ID,run:()=>{e.hide(),n.showAtMarker(t.marker),this._editor.focus()}})}if(!this._editor.getOption(92)){const n=e.statusBar.append(Sr("div"));this.recentMarkerCodeActionsInfo&&(_x.makeKey(this.recentMarkerCodeActionsInfo.marker)===_x.makeKey(t.marker)?this.recentMarkerCodeActionsInfo.hasCodeActions||(n.textContent=p("noQuickFixes","No quick fixes available")):this.recentMarkerCodeActionsInfo=void 0);const s=this.recentMarkerCodeActionsInfo&&!this.recentMarkerCodeActionsInfo.hasCodeActions?F.None:Rh(()=>n.textContent=p("checkingForQuickFixes","Checking for quick fixes..."),200,i);n.textContent||(n.textContent=" ");const r=this.getCodeActions(t.marker);i.add(ve(()=>r.cancel())),r.then(a=>{if(s.dispose(),this.recentMarkerCodeActionsInfo={marker:t.marker,hasCodeActions:a.validActions.length>0},!this.recentMarkerCodeActionsInfo.hasCodeActions){a.dispose(),n.textContent=p("noQuickFixes","No quick fixes available");return}n.style.display="none";let l=!1;i.add(ve(()=>{l||a.dispose()})),e.statusBar.addAction({label:p("quick fixes","Quick Fix..."),commandId:pW,run:c=>{l=!0;const d=V_.get(this._editor),h=Ci(c);e.hide(),d?.showCodeActions(_6,a,{x:h.left,y:h.top,width:h.width,height:h.height})}})},Ae)}}getCodeActions(e){return ji(t=>rm(this._languageFeaturesService.codeActionProvider,this._editor.getModel(),new L(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),_6,va.None,t))}};sF=vke([PN(1,H5),PN(2,Fs),PN(3,ue)],sF);class yke{get lineNumber(){return this._lineNumber}set lineNumber(e){this._lineNumber=e}get lane(){return this._laneOrLine}set lane(e){this._laneOrLine=e}constructor(e){this._editor=e,this._lineNumber=-1,this._laneOrLine=Ur.Center}computeSync(){const e=s=>({value:s}),t=this._editor.getLineDecorations(this._lineNumber),i=[],n=this._laneOrLine==="lineNo";if(!t)return i;for(const s of t){const r=s.options.glyphMargin?.position??Ur.Center;if(!n&&r!==this._laneOrLine)continue;const a=n?s.options.lineNumberHoverMessage:s.options.glyphMarginHoverMessage;!a||L_(a)||i.push(...b4(a).map(e))}return i}}var wke=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},b6=function(o,e){return function(t,i){e(t,i,o)}},oF;const v6=ie;var Qg;let rF=(Qg=class extends F{constructor(e,t,i){super(),this._renderDisposeables=this._register(new $),this._editor=e,this._isVisible=!1,this._messages=[],this._hover=this._register(new v5),this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible),this._markdownRenderer=this._register(new Zc({editor:this._editor},t,i)),this._computer=new yke(this._editor),this._hoverOperation=this._register(new Wq(this._editor,this._computer)),this._register(this._hoverOperation.onResult(n=>{this._withResult(n.value)})),this._register(this._editor.onDidChangeModelDecorations(()=>this._onModelDecorationsChanged())),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(50)&&this._updateFont()})),this._register(ci(this._hover.containerDomNode,"mouseleave",n=>{this._onMouseLeave(n)})),this._editor.addOverlayWidget(this)}dispose(){this._editor.removeOverlayWidget(this),super.dispose()}getId(){return oF.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){return null}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach(t=>this._editor.applyFontInfo(t))}_onModelDecorationsChanged(){this._isVisible&&(this._hoverOperation.cancel(),this._hoverOperation.start(0))}showsOrWillShow(e){const t=e.target;return t.type===2&&t.detail.glyphMarginLane?(this._startShowingAt(t.position.lineNumber,t.detail.glyphMarginLane),!0):t.type===3?(this._startShowingAt(t.position.lineNumber,"lineNo"),!0):!1}_startShowingAt(e,t){this._computer.lineNumber===e&&this._computer.lane===t||(this._hoverOperation.cancel(),this.hide(),this._computer.lineNumber=e,this._computer.lane=t,this._hoverOperation.start(0))}hide(){this._computer.lineNumber=-1,this._hoverOperation.cancel(),this._isVisible&&(this._isVisible=!1,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible))}_withResult(e){this._messages=e,this._messages.length>0?this._renderMessages(this._computer.lineNumber,this._messages):this.hide()}_renderMessages(e,t){this._renderDisposeables.clear();const i=document.createDocumentFragment();for(const n of t){const s=v6("div.hover-row.markdown-hover"),r=Y(s,v6("div.hover-contents")),a=this._renderDisposeables.add(this._markdownRenderer.render(n.value));r.appendChild(a.element),i.appendChild(s)}this._updateContents(i),this._showAt(e)}_updateContents(e){this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(e),this._updateFont()}_showAt(e){this._isVisible||(this._isVisible=!0,this._hover.containerDomNode.classList.toggle("hidden",!this._isVisible));const t=this._editor.getLayoutInfo(),i=this._editor.getTopForLineNumber(e),n=this._editor.getScrollTop(),s=this._editor.getOption(67),r=this._hover.containerDomNode.clientHeight,a=i-n-(r-s)/2,l=t.glyphMarginLeft+t.glyphMarginWidth+(this._computer.lane==="lineNo"?t.lineNumbersWidth:0);this._hover.containerDomNode.style.left=`${l}px`,this._hover.containerDomNode.style.top=`${Math.max(Math.round(a),0)}px`}_onMouseLeave(e){const t=this._editor.getDomNode();(!t||!CD(t,e.x,e.y))&&this.hide()}},oF=Qg,Qg.ID="editor.contrib.modesGlyphHoverWidget",Qg);rF=oF=wke([b6(1,ti),b6(2,Fs)],rF);var Ske=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},xke=function(o,e){return function(t,i){e(t,i,o)}},a_;let YL=(a_=class extends F{constructor(e,t){super(),this._editor=e,this._instantiationService=t,this.shouldKeepOpenOnEditorMouseMoveOrLeave=!1,this._listenersStore=new $,this._hoverState={mouseDown:!1},this._reactToEditorMouseMoveRunner=this._register(new xt(()=>this._reactToEditorMouseMove(this._mouseMoveEvent),0)),this._hookListeners(),this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(60)&&(this._unhookListeners(),this._hookListeners())}))}_hookListeners(){const e=this._editor.getOption(60);this._hoverSettings={enabled:e.enabled,sticky:e.sticky,hidingDelay:e.hidingDelay},e.enabled?(this._listenersStore.add(this._editor.onMouseDown(t=>this._onEditorMouseDown(t))),this._listenersStore.add(this._editor.onMouseUp(()=>this._onEditorMouseUp())),this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))):(this._listenersStore.add(this._editor.onMouseMove(t=>this._onEditorMouseMove(t))),this._listenersStore.add(this._editor.onKeyDown(t=>this._onKeyDown(t)))),this._listenersStore.add(this._editor.onMouseLeave(t=>this._onEditorMouseLeave(t))),this._listenersStore.add(this._editor.onDidChangeModel(()=>{this._cancelScheduler(),this._hideWidgets()})),this._listenersStore.add(this._editor.onDidChangeModelContent(()=>this._cancelScheduler())),this._listenersStore.add(this._editor.onDidScrollChange(t=>this._onEditorScrollChanged(t)))}_unhookListeners(){this._listenersStore.clear()}_cancelScheduler(){this._mouseMoveEvent=void 0,this._reactToEditorMouseMoveRunner.cancel()}_onEditorScrollChanged(e){(e.scrollTopChanged||e.scrollLeftChanged)&&this._hideWidgets()}_onEditorMouseDown(e){this._hoverState.mouseDown=!0,!this._isMouseOnMarginHoverWidget(e)&&this._hideWidgets()}_isMouseOnMarginHoverWidget(e){const t=this._glyphWidget?.getDomNode();return t?CD(t,e.event.posx,e.event.posy):!1}_onEditorMouseUp(){this._hoverState.mouseDown=!1}_onEditorMouseLeave(e){this.shouldKeepOpenOnEditorMouseMoveOrLeave||(this._cancelScheduler(),this._isMouseOnMarginHoverWidget(e))||this._hideWidgets()}_shouldNotRecomputeCurrentHoverWidget(e){const t=this._hoverSettings.sticky,i=this._isMouseOnMarginHoverWidget(e);return t&&i}_onEditorMouseMove(e){if(this.shouldKeepOpenOnEditorMouseMoveOrLeave)return;if(this._mouseMoveEvent=e,this._shouldNotRecomputeCurrentHoverWidget(e)){this._reactToEditorMouseMoveRunner.cancel();return}this._reactToEditorMouseMove(e)}_reactToEditorMouseMove(e){!e||this._tryShowHoverWidget(e)||this._hideWidgets()}_tryShowHoverWidget(e){return this._getOrCreateGlyphWidget().showsOrWillShow(e)}_onKeyDown(e){this._editor.hasModel()&&(e.keyCode===5||e.keyCode===6||e.keyCode===57||e.keyCode===4||this._hideWidgets())}_hideWidgets(){this._glyphWidget?.hide()}_getOrCreateGlyphWidget(){return this._glyphWidget||(this._glyphWidget=this._instantiationService.createInstance(rF,this._editor)),this._glyphWidget}dispose(){super.dispose(),this._unhookListeners(),this._listenersStore.dispose(),this._glyphWidget?.dispose()}},a_.ID="editor.contrib.marginHover",a_);YL=Ske([xke(1,Ce)],YL);class Lke{}class kke{}class Eke{}at(Qn.ID,Qn,2);at(YL.ID,YL,2);X(ake);X(lke);X(cke);X(dke);X(hke);X(uke);X(gke);X(fke);X(pke);X(mke);X(_ke);X(bke);np.register(Jy);np.register(sF);br((o,e)=>{const t=o.getColor(rG);t&&(e.addRule(`.monaco-editor .monaco-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-top: 1px solid ${t.transparent(.5)}; }`),e.addRule(`.monaco-editor .monaco-hover hr { border-bottom: 0px solid ${t.transparent(.5)}; }`))});DD.register(new Lke);DD.register(new kke);DD.register(new Eke);function $s(o,e){let t=0;for(let i=0;i<o.length;i++)o.charAt(i)==="	"?t+=e:t++;return t}function fC(o,e,t){o=o<0?0:o;let i="";if(!t){const n=Math.floor(o/e);o=o%e;for(let s=0;s<n;s++)i+="	"}for(let n=0;n<o;n++)i+=" ";return i}function RZ(o,e,t,i){if(o.getLineCount()===1&&o.getLineMaxColumn(1)===1)return[];const n=e.getLanguageConfiguration(o.getLanguageId()).indentRulesSupport;if(!n)return[];const s=new EB(o,n,e);for(i=Math.min(i,o.getLineCount());t<=i&&s.shouldIgnore(t);)t++;if(t>i-1)return[];const{tabSize:r,indentSize:a,insertSpaces:l}=o.getOptions(),c=(m,_)=>(_=_||1,pr.shiftIndent(m,m.length+_,r,a,l)),d=(m,_)=>(_=_||1,pr.unshiftIndent(m,m.length+_,r,a,l)),h=[],u=o.getLineContent(t);let g=Tt(u),f=g;s.shouldIncrease(t)?(f=c(f),g=c(g)):s.shouldIndentNextLine(t)&&(f=c(f)),t++;for(let m=t;m<=i;m++){if(Tke(o,m))continue;const _=o.getLineContent(m),b=Tt(_),v=f;s.shouldDecrease(m,v)&&(f=d(f),g=d(g)),b!==f&&h.push(si.replaceMove(new pe(m,1,m,b.length+1),z5(f,a,l))),!s.shouldIgnore(m)&&(s.shouldIncrease(m,v)?(g=c(g),f=g):s.shouldIndentNextLine(m,v)?f=c(f):f=g)}return h}function Tke(o,e){return o.tokenization.isCheapToTokenize(e)?o.tokenization.getLineTokens(e).getStandardTokenType(0)===2:!1}var Dke=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ike=function(o,e){return function(t,i){e(t,i,o)}};const LE=class LE extends de{constructor(){super({id:LE.ID,label:p("indentationToSpaces","Convert Indentation to Spaces"),alias:"Convert Indentation to Spaces",precondition:T.writable,metadata:{description:De("indentationToSpacesDescription","Convert the tab indentation to spaces.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),s=t.getSelection();if(!s)return;const r=new Mke(s,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!0})}};LE.ID="editor.action.indentationToSpaces";let aF=LE;const kE=class kE extends de{constructor(){super({id:kE.ID,label:p("indentationToTabs","Convert Indentation to Tabs"),alias:"Convert Indentation to Tabs",precondition:T.writable,metadata:{description:De("indentationToTabsDescription","Convert the spaces indentation to tabs.")}})}run(e,t){const i=t.getModel();if(!i)return;const n=i.getOptions(),s=t.getSelection();if(!s)return;const r=new Oke(s,n.tabSize);t.pushUndoStop(),t.executeCommands(this.id,[r]),t.pushUndoStop(),i.updateOptions({insertSpaces:!1})}};kE.ID="editor.action.indentationToTabs";let lF=kE;class HW extends de{constructor(e,t,i){super(i),this.insertSpaces=e,this.displaySizeOnly=t}run(e,t){const i=e.get(vr),n=e.get(Ut),s=t.getModel();if(!s)return;const r=n.getCreationOptions(s.getLanguageId(),s.uri,s.isForSimpleWidget),a=s.getOptions(),l=[1,2,3,4,5,6,7,8].map(d=>({id:d.toString(),label:d.toString(),description:d===r.tabSize&&d===a.tabSize?p("configuredTabSize","Configured Tab Size"):d===r.tabSize?p("defaultTabSize","Default Tab Size"):d===a.tabSize?p("currentTabSize","Current Tab Size"):void 0})),c=Math.min(s.getOptions().tabSize-1,7);setTimeout(()=>{i.pick(l,{placeHolder:p({key:"selectTabWidth",comment:["Tab corresponds to the tab key"]},"Select Tab Size for Current File"),activeItem:l[c]}).then(d=>{if(d&&s&&!s.isDisposed()){const h=parseInt(d.label,10);this.displaySizeOnly?s.updateOptions({tabSize:h}):s.updateOptions({tabSize:h,indentSize:h,insertSpaces:this.insertSpaces})}})},50)}}const EE=class EE extends HW{constructor(){super(!1,!1,{id:EE.ID,label:p("indentUsingTabs","Indent Using Tabs"),alias:"Indent Using Tabs",precondition:void 0,metadata:{description:De("indentUsingTabsDescription","Use indentation with tabs.")}})}};EE.ID="editor.action.indentUsingTabs";let cF=EE;const TE=class TE extends HW{constructor(){super(!0,!1,{id:TE.ID,label:p("indentUsingSpaces","Indent Using Spaces"),alias:"Indent Using Spaces",precondition:void 0,metadata:{description:De("indentUsingSpacesDescription","Use indentation with spaces.")}})}};TE.ID="editor.action.indentUsingSpaces";let dF=TE;const DE=class DE extends HW{constructor(){super(!0,!0,{id:DE.ID,label:p("changeTabDisplaySize","Change Tab Display Size"),alias:"Change Tab Display Size",precondition:void 0,metadata:{description:De("changeTabDisplaySizeDescription","Change the space size equivalent of the tab.")}})}};DE.ID="editor.action.changeTabDisplaySize";let hF=DE;const IE=class IE extends de{constructor(){super({id:IE.ID,label:p("detectIndentation","Detect Indentation from Content"),alias:"Detect Indentation from Content",precondition:void 0,metadata:{description:De("detectIndentationDescription","Detect the indentation from content.")}})}run(e,t){const i=e.get(Ut),n=t.getModel();if(!n)return;const s=i.getCreationOptions(n.getLanguageId(),n.uri,n.isForSimpleWidget);n.detectIndentation(s.insertSpaces,s.tabSize)}};IE.ID="editor.action.detectIndentation";let uF=IE;class Nke extends de{constructor(){super({id:"editor.action.reindentlines",label:p("editor.reindentlines","Reindent Lines"),alias:"Reindent Lines",precondition:T.writable,metadata:{description:De("editor.reindentlinesDescription","Reindent the lines of the editor.")}})}run(e,t){const i=e.get(li),n=t.getModel();if(!n)return;const s=RZ(n,i,1,n.getLineCount());s.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,s),t.pushUndoStop())}}class Rke extends de{constructor(){super({id:"editor.action.reindentselectedlines",label:p("editor.reindentselectedlines","Reindent Selected Lines"),alias:"Reindent Selected Lines",precondition:T.writable,metadata:{description:De("editor.reindentselectedlinesDescription","Reindent the selected lines of the editor.")}})}run(e,t){const i=e.get(li),n=t.getModel();if(!n)return;const s=t.getSelections();if(s===null)return;const r=[];for(const a of s){let l=a.startLineNumber,c=a.endLineNumber;if(l!==c&&a.endColumn===1&&c--,l===1){if(l===c)continue}else l--;const d=RZ(n,i,l,c);r.push(...d)}r.length>0&&(t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop())}}class Pke{constructor(e,t){this._initialSelection=t,this._edits=[],this._selectionId=null;for(const i of e)i.range&&typeof i.text=="string"&&this._edits.push(i)}getEditOperations(e,t){for(const n of this._edits)t.addEditOperation(L.lift(n.range),n.text);let i=!1;Array.isArray(this._edits)&&this._edits.length===1&&this._initialSelection.isEmpty()&&(this._edits[0].range.startColumn===this._initialSelection.endColumn&&this._edits[0].range.startLineNumber===this._initialSelection.endLineNumber?(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!0)):this._edits[0].range.endColumn===this._initialSelection.startColumn&&this._edits[0].range.endLineNumber===this._initialSelection.startLineNumber&&(i=!0,this._selectionId=t.trackSelection(this._initialSelection,!1))),i||(this._selectionId=t.trackSelection(this._initialSelection))}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}var l_;let XL=(l_=class{constructor(e,t){this.editor=e,this._languageConfigurationService=t,this.callOnDispose=new $,this.callOnModel=new $,this.callOnDispose.add(e.onDidChangeConfiguration(()=>this.update())),this.callOnDispose.add(e.onDidChangeModel(()=>this.update())),this.callOnDispose.add(e.onDidChangeModelLanguage(()=>this.update()))}update(){this.callOnModel.clear(),!(this.editor.getOption(12)<4||this.editor.getOption(55))&&this.editor.hasModel()&&this.callOnModel.add(this.editor.onDidPaste(({range:e})=>{this.trigger(e)}))}trigger(e){const t=this.editor.getSelections();if(t===null||t.length>1)return;const i=this.editor.getModel();if(!i||this.rangeContainsOnlyWhitespaceCharacters(i,e)||Ake(i,e)||!i.tokenization.isCheapToTokenize(e.getStartPosition().lineNumber))return;const s=this.editor.getOption(12),{tabSize:r,indentSize:a,insertSpaces:l}=i.getOptions(),c=[],d={shiftIndent:f=>pr.shiftIndent(f,f.length+1,r,a,l),unshiftIndent:f=>pr.unshiftIndent(f,f.length+1,r,a,l)};let h=e.startLineNumber;for(;h<=e.endLineNumber;){if(this.shouldIgnoreLine(i,h)){h++;continue}break}if(h>e.endLineNumber)return;let u=i.getLineContent(h);if(!/\S/.test(u.substring(0,e.startColumn-1))){const f=eC(s,i,i.getLanguageId(),h,d,this._languageConfigurationService);if(f!==null){const m=Tt(u),_=$s(f,r),b=$s(m,r);if(_!==b){const v=fC(_,r,l);c.push({range:new L(h,1,h,m.length+1),text:v}),u=v+u.substring(m.length)}else{const v=$K(i,h,this._languageConfigurationService);if(v===0||v===8)return}}}const g=h;for(;h<e.endLineNumber;){if(!/\S/.test(i.getLineContent(h+1))){h++;continue}break}if(h!==e.endLineNumber){const m=eC(s,{tokenization:{getLineTokens:_=>i.tokenization.getLineTokens(_),getLanguageId:()=>i.getLanguageId(),getLanguageIdAtPosition:(_,b)=>i.getLanguageIdAtPosition(_,b)},getLineContent:_=>_===g?u:i.getLineContent(_)},i.getLanguageId(),h+1,d,this._languageConfigurationService);if(m!==null){const _=$s(m,r),b=$s(Tt(i.getLineContent(h+1)),r);if(_!==b){const v=_-b;for(let y=h+1;y<=e.endLineNumber;y++){const C=i.getLineContent(y),w=Tt(C),k=$s(w,r)+v,E=fC(k,r,l);E!==w&&c.push({range:new L(y,1,y,w.length+1),text:E})}}}}if(c.length>0){this.editor.pushUndoStop();const f=new Pke(c,this.editor.getSelection());this.editor.executeCommand("autoIndentOnPaste",f),this.editor.pushUndoStop()}}rangeContainsOnlyWhitespaceCharacters(e,t){const i=s=>s.trim().length===0;let n=!0;if(t.startLineNumber===t.endLineNumber){const r=e.getLineContent(t.startLineNumber).substring(t.startColumn-1,t.endColumn-1);n=i(r)}else for(let s=t.startLineNumber;s<=t.endLineNumber;s++){const r=e.getLineContent(s);if(s===t.startLineNumber){const a=r.substring(t.startColumn-1);n=i(a)}else if(s===t.endLineNumber){const a=r.substring(0,t.endColumn-1);n=i(a)}else n=e.getLineFirstNonWhitespaceColumn(s)===0;if(!n)break}return n}shouldIgnoreLine(e,t){e.tokenization.forceTokenization(t);const i=e.getLineFirstNonWhitespaceColumn(t);if(i===0)return!0;const n=e.tokenization.getLineTokens(t);if(n.getCount()>0){const s=n.findTokenIndexAtOffset(i);if(s>=0&&n.getStandardTokenType(s)===1)return!0}return!1}dispose(){this.callOnDispose.dispose(),this.callOnModel.dispose()}},l_.ID="editor.contrib.autoIndentOnPaste",l_);XL=Dke([Ike(1,li)],XL);function Ake(o,e){const t=i=>Jre(o,i)===2;return t(e.getStartPosition())||t(e.getEndPosition())}function PZ(o,e,t,i){if(o.getLineCount()===1&&o.getLineMaxColumn(1)===1)return;let n="";for(let r=0;r<t;r++)n+=" ";const s=new RegExp(n,"gi");for(let r=1,a=o.getLineCount();r<=a;r++){let l=o.getLineFirstNonWhitespaceColumn(r);if(l===0&&(l=o.getLineMaxColumn(r)),l===1)continue;const c=new L(r,1,r,l),d=o.getValueInRange(c),h=i?d.replace(/\t/ig,n):d.replace(s,"	");e.addEditOperation(c,h)}}class Mke{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),PZ(e,t,this.tabSize,!0)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}class Oke{constructor(e,t){this.selection=e,this.tabSize=t,this.selectionId=null}getEditOperations(e,t){this.selectionId=t.trackSelection(this.selection),PZ(e,t,this.tabSize,!1)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}}at(XL.ID,XL,2);X(aF);X(lF);X(cF);X(dF);X(hF);X(uF);X(Nke);X(Rke);at(tw.ID,tw,1);np.register(DL);class Fke{constructor(e,t,i){this._editRange=e,this._originalSelection=t,this._text=i}getEditOperations(e,t){t.addTrackedEditOperation(this._editRange,this._text)}computeCursorState(e,t){const n=t.getInverseEditOperations()[0].range;return this._originalSelection.isEmpty()?new pe(n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn),n.endLineNumber,Math.min(this._originalSelection.positionColumn,n.endColumn)):new pe(n.endLineNumber,n.endColumn-this._text.length,n.endLineNumber,n.endColumn)}}var Bke=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Wke=function(o,e){return function(t,i){e(t,i,o)}},a0,Ch;let Z_=(Ch=class{static get(e){return e.getContribution(a0.ID)}constructor(e,t){this.editor=e,this.editorWorkerService=t,this.decorations=this.editor.createDecorationsCollection()}dispose(){}run(e,t){this.currentRequest?.cancel();const i=this.editor.getSelection(),n=this.editor.getModel();if(!n||!i)return;let s=i;if(s.startLineNumber!==s.endLineNumber)return;const r=new Cj(this.editor,5),a=n.uri;return this.editorWorkerService.canNavigateValueSet(a)?(this.currentRequest=ji(l=>this.editorWorkerService.navigateValueSet(a,s,t)),this.currentRequest.then(l=>{if(!l||!l.range||!l.value||!r.validate(this.editor))return;const c=L.lift(l.range);let d=l.range;const h=l.value.length-(s.endColumn-s.startColumn);d={startLineNumber:d.startLineNumber,startColumn:d.startColumn,endLineNumber:d.endLineNumber,endColumn:d.startColumn+l.value.length},h>1&&(s=new pe(s.startLineNumber,s.startColumn,s.endLineNumber,s.endColumn+h-1));const u=new Fke(c,s,l.value);this.editor.pushUndoStop(),this.editor.executeCommand(e,u),this.editor.pushUndoStop(),this.decorations.set([{range:d,options:a0.DECORATION}]),this.decorationRemover?.cancel(),this.decorationRemover=Kc(350),this.decorationRemover.then(()=>this.decorations.clear()).catch(Ae)}).catch(Ae)):Promise.resolve(void 0)}},a0=Ch,Ch.ID="editor.contrib.inPlaceReplaceController",Ch.DECORATION=Fe.register({description:"in-place-replace",className:"valueSetReplacement"}),Ch);Z_=a0=Bke([Wke(1,Bs)],Z_);class Vke extends de{constructor(){super({id:"editor.action.inPlaceReplace.up",label:p("InPlaceReplaceAction.previous.label","Replace with Previous Value"),alias:"Replace with Previous Value",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:3159,weight:100}})}run(e,t){const i=Z_.get(t);return i?i.run(this.id,!1):Promise.resolve(void 0)}}class Hke extends de{constructor(){super({id:"editor.action.inPlaceReplace.down",label:p("InPlaceReplaceAction.next.label","Replace with Next Value"),alias:"Replace with Next Value",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:3161,weight:100}})}run(e,t){const i=Z_.get(t);return i?i.run(this.id,!0):Promise.resolve(void 0)}}at(Z_.ID,Z_,4);X(Vke);X(Hke);class zke extends de{constructor(){super({id:"expandLineSelection",label:p("expandLineSelection","Expand Line Selection"),alias:"Expand Line Selection",precondition:void 0,kbOpts:{weight:0,kbExpr:T.textInputFocus,primary:2090}})}run(e,t,i){if(i=i||{},!t.hasModel())return;const n=t._getViewModel();n.model.pushStackElement(),n.setCursorStates(i.source,3,dn.expandLineSelection(n,n.getCursorStates())),n.revealAllCursors(i.source,!0)}}X(zke);class Uke{constructor(e,t,i){this._selection=e,this._cursors=t,this._selectionId=null,this._trimInRegexesAndStrings=i}getEditOperations(e,t){const i=Gke(e,this._cursors,this._trimInRegexesAndStrings);for(let n=0,s=i.length;n<s;n++){const r=i[n];t.addEditOperation(r.range,r.text)}this._selectionId=t.trackSelection(this._selection)}computeCursorState(e,t){return t.getTrackedSelection(this._selectionId)}}function Gke(o,e,t){e.sort((a,l)=>a.lineNumber===l.lineNumber?a.column-l.column:a.lineNumber-l.lineNumber);for(let a=e.length-2;a>=0;a--)e[a].lineNumber===e[a+1].lineNumber&&e.splice(a,1);const i=[];let n=0,s=0;const r=e.length;for(let a=1,l=o.getLineCount();a<=l;a++){const c=o.getLineContent(a),d=c.length+1;let h=0;if(s<r&&e[s].lineNumber===a&&(h=e[s].column,s++,h===d)||c.length===0)continue;const u=Sa(c);let g=0;if(u===-1)g=1;else if(u!==c.length-1)g=u+2;else continue;if(!t){if(!o.tokenization.hasAccurateTokensForLine(a))continue;const f=o.tokenization.getLineTokens(a),m=f.getStandardTokenType(f.findTokenIndexAtOffset(g));if(m===2||m===3)continue}g=Math.max(h,g),i[n++]=si.delete(new L(a,g,a,d))}return i}class AZ{constructor(e,t,i){this._selection=e,this._isCopyingDown=t,this._noop=i||!1,this._selectionDirection=0,this._selectionId=null,this._startLineNumberDelta=0,this._endLineNumberDelta=0}getEditOperations(e,t){let i=this._selection;this._startLineNumberDelta=0,this._endLineNumberDelta=0,i.startLineNumber<i.endLineNumber&&i.endColumn===1&&(this._endLineNumberDelta=1,i=i.setEndPosition(i.endLineNumber-1,e.getLineMaxColumn(i.endLineNumber-1)));const n=[];for(let r=i.startLineNumber;r<=i.endLineNumber;r++)n.push(e.getLineContent(r));const s=n.join(`
`);s===""&&this._isCopyingDown&&(this._startLineNumberDelta++,this._endLineNumberDelta++),this._noop?t.addEditOperation(new L(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber+1,1),i.endLineNumber===e.getLineCount()?"":`
`):this._isCopyingDown?t.addEditOperation(new L(i.startLineNumber,1,i.startLineNumber,1),s+`
`):t.addEditOperation(new L(i.endLineNumber,e.getLineMaxColumn(i.endLineNumber),i.endLineNumber,e.getLineMaxColumn(i.endLineNumber)),`
`+s),this._selectionId=t.trackSelection(i),this._selectionDirection=this._selection.getDirection()}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);if(this._startLineNumberDelta!==0||this._endLineNumberDelta!==0){let n=i.startLineNumber,s=i.startColumn,r=i.endLineNumber,a=i.endColumn;this._startLineNumberDelta!==0&&(n=n+this._startLineNumberDelta,s=1),this._endLineNumberDelta!==0&&(r=r+this._endLineNumberDelta,a=1),i=pe.createWithDirection(n,s,r,a,this._selectionDirection)}return i}}var $ke=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Kke=function(o,e){return function(t,i){e(t,i,o)}};let gF=class{constructor(e,t,i,n){this._languageConfigurationService=n,this._selection=e,this._isMovingDown=t,this._autoIndent=i,this._selectionId=null,this._moveEndLineSelectionShrink=!1}getEditOperations(e,t){const i=()=>e.getLanguageId(),n=(h,u)=>e.getLanguageIdAtPosition(h,u),s=e.getLineCount();if(this._isMovingDown&&this._selection.endLineNumber===s){this._selectionId=t.trackSelection(this._selection);return}if(!this._isMovingDown&&this._selection.startLineNumber===1){this._selectionId=t.trackSelection(this._selection);return}this._moveEndPositionDown=!1;let r=this._selection;r.startLineNumber<r.endLineNumber&&r.endColumn===1&&(this._moveEndPositionDown=!0,r=r.setEndPosition(r.endLineNumber-1,e.getLineMaxColumn(r.endLineNumber-1)));const{tabSize:a,indentSize:l,insertSpaces:c}=e.getOptions(),d=this.buildIndentConverter(a,l,c);if(r.startLineNumber===r.endLineNumber&&e.getLineMaxColumn(r.startLineNumber)===1){const h=r.startLineNumber,u=this._isMovingDown?h+1:h-1;e.getLineMaxColumn(u)===1?t.addEditOperation(new L(1,1,1,1),null):(t.addEditOperation(new L(h,1,h,1),e.getLineContent(u)),t.addEditOperation(new L(u,1,u,e.getLineMaxColumn(u)),null)),r=new pe(u,1,u,1)}else{let h,u;if(this._isMovingDown){h=r.endLineNumber+1,u=e.getLineContent(h),t.addEditOperation(new L(h-1,e.getLineMaxColumn(h-1),h,e.getLineMaxColumn(h)),null);let g=u;if(this.shouldAutoIndent(e,r)){const f=this.matchEnterRule(e,d,a,h,r.startLineNumber-1);if(f!==null){const _=Tt(e.getLineContent(h)),b=f+$s(_,a);g=fC(b,a,c)+this.trimStart(u)}else{const _={tokenization:{getLineTokens:v=>v===r.startLineNumber?e.tokenization.getLineTokens(h):e.tokenization.getLineTokens(v),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:v=>v===r.startLineNumber?e.getLineContent(h):e.getLineContent(v)},b=eC(this._autoIndent,_,e.getLanguageIdAtPosition(h,1),r.startLineNumber,d,this._languageConfigurationService);if(b!==null){const v=Tt(e.getLineContent(h)),y=$s(b,a),C=$s(v,a);y!==C&&(g=fC(y,a,c)+this.trimStart(u))}}t.addEditOperation(new L(r.startLineNumber,1,r.startLineNumber,1),g+`
`);const m=this.matchEnterRuleMovingDown(e,d,a,r.startLineNumber,h,g);if(m!==null)m!==0&&this.getIndentEditsOfMovingBlock(e,t,r,a,c,m);else{const _={tokenization:{getLineTokens:v=>v===r.startLineNumber?e.tokenization.getLineTokens(h):v>=r.startLineNumber+1&&v<=r.endLineNumber+1?e.tokenization.getLineTokens(v-1):e.tokenization.getLineTokens(v),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:v=>v===r.startLineNumber?g:v>=r.startLineNumber+1&&v<=r.endLineNumber+1?e.getLineContent(v-1):e.getLineContent(v)},b=eC(this._autoIndent,_,e.getLanguageIdAtPosition(h,1),r.startLineNumber+1,d,this._languageConfigurationService);if(b!==null){const v=Tt(e.getLineContent(r.startLineNumber)),y=$s(b,a),C=$s(v,a);if(y!==C){const w=y-C;this.getIndentEditsOfMovingBlock(e,t,r,a,c,w)}}}}else t.addEditOperation(new L(r.startLineNumber,1,r.startLineNumber,1),g+`
`)}else if(h=r.startLineNumber-1,u=e.getLineContent(h),t.addEditOperation(new L(h,1,h+1,1),null),t.addEditOperation(new L(r.endLineNumber,e.getLineMaxColumn(r.endLineNumber),r.endLineNumber,e.getLineMaxColumn(r.endLineNumber)),`
`+u),this.shouldAutoIndent(e,r)){const g={tokenization:{getLineTokens:m=>m===h?e.tokenization.getLineTokens(r.startLineNumber):e.tokenization.getLineTokens(m),getLanguageId:i,getLanguageIdAtPosition:n},getLineContent:m=>m===h?e.getLineContent(r.startLineNumber):e.getLineContent(m)},f=this.matchEnterRule(e,d,a,r.startLineNumber,r.startLineNumber-2);if(f!==null)f!==0&&this.getIndentEditsOfMovingBlock(e,t,r,a,c,f);else{const m=eC(this._autoIndent,g,e.getLanguageIdAtPosition(r.startLineNumber,1),h,d,this._languageConfigurationService);if(m!==null){const _=Tt(e.getLineContent(r.startLineNumber)),b=$s(m,a),v=$s(_,a);if(b!==v){const y=b-v;this.getIndentEditsOfMovingBlock(e,t,r,a,c,y)}}}}}this._selectionId=t.trackSelection(r)}buildIndentConverter(e,t,i){return{shiftIndent:n=>pr.shiftIndent(n,n.length+1,e,t,i),unshiftIndent:n=>pr.unshiftIndent(n,n.length+1,e,t,i)}}parseEnterResult(e,t,i,n,s){if(s){let r=s.indentation;s.indentAction===Oi.None||s.indentAction===Oi.Indent?r=s.indentation+s.appendText:s.indentAction===Oi.IndentOutdent?r=s.indentation:s.indentAction===Oi.Outdent&&(r=t.unshiftIndent(s.indentation)+s.appendText);const a=e.getLineContent(n);if(this.trimStart(a).indexOf(this.trimStart(r))>=0){const l=Tt(e.getLineContent(n));let c=Tt(r);const d=$K(e,n,this._languageConfigurationService);d!==null&&d&2&&(c=t.unshiftIndent(c));const h=$s(c,i),u=$s(l,i);return h-u}}return null}matchEnterRuleMovingDown(e,t,i,n,s,r){if(Sa(r)>=0){const a=e.getLineMaxColumn(s),l=qm(this._autoIndent,e,new L(s,a,s,a),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,l)}else{let a=n-1;for(;a>=1;){const d=e.getLineContent(a);if(Sa(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=qm(this._autoIndent,e,new L(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}}matchEnterRule(e,t,i,n,s,r){let a=s;for(;a>=1;){let d;if(a===s&&r!==void 0?d=r:d=e.getLineContent(a),Sa(d)>=0)break;a--}if(a<1||n>e.getLineCount())return null;const l=e.getLineMaxColumn(a),c=qm(this._autoIndent,e,new L(a,l,a,l),this._languageConfigurationService);return this.parseEnterResult(e,t,i,n,c)}trimStart(e){return e.replace(/^\s+/,"")}shouldAutoIndent(e,t){if(this._autoIndent<4||!e.tokenization.isCheapToTokenize(t.startLineNumber))return!1;const i=e.getLanguageIdAtPosition(t.startLineNumber,1),n=e.getLanguageIdAtPosition(t.endLineNumber,1);return!(i!==n||this._languageConfigurationService.getLanguageConfiguration(i).indentRulesSupport===null)}getIndentEditsOfMovingBlock(e,t,i,n,s,r){for(let a=i.startLineNumber;a<=i.endLineNumber;a++){const l=e.getLineContent(a),c=Tt(l),h=$s(c,n)+r,u=fC(h,n,s);u!==c&&(t.addEditOperation(new L(a,1,a,c.length+1),u),a===i.endLineNumber&&i.endColumn<=c.length+1&&u===""&&(this._moveEndLineSelectionShrink=!0))}}computeCursorState(e,t){let i=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(i=i.setEndPosition(i.endLineNumber+1,1)),this._moveEndLineSelectionShrink&&i.startLineNumber<i.endLineNumber&&(i=i.setEndPosition(i.endLineNumber,2)),i}};gF=$ke([Kke(3,li)],gF);const km=class km{static getCollator(){return km._COLLATOR||(km._COLLATOR=new Intl.Collator),km._COLLATOR}constructor(e,t){this.selection=e,this.descending=t,this.selectionId=null}getEditOperations(e,t){const i=jke(e,this.selection,this.descending);i&&t.addEditOperation(i.range,i.text),this.selectionId=t.trackSelection(this.selection)}computeCursorState(e,t){return t.getTrackedSelection(this.selectionId)}static canRun(e,t,i){if(e===null)return!1;const n=MZ(e,t,i);if(!n)return!1;for(let s=0,r=n.before.length;s<r;s++)if(n.before[s]!==n.after[s])return!0;return!1}};km._COLLATOR=null;let rw=km;function MZ(o,e,t){const i=e.startLineNumber;let n=e.endLineNumber;if(e.endColumn===1&&n--,i>=n)return null;const s=[];for(let a=i;a<=n;a++)s.push(o.getLineContent(a));let r=s.slice(0);return r.sort(rw.getCollator().compare),t===!0&&(r=r.reverse()),{startLineNumber:i,endLineNumber:n,before:s,after:r}}function jke(o,e,t){const i=MZ(o,e,t);return i?si.replace(new L(i.startLineNumber,1,i.endLineNumber,o.getLineMaxColumn(i.endLineNumber)),i.after.join(`
`)):null}class OZ extends de{constructor(e,t){super(t),this.down=e}run(e,t){if(!t.hasModel())return;const i=t.getSelections().map((r,a)=>({selection:r,index:a,ignore:!1}));i.sort((r,a)=>L.compareRangesUsingStarts(r.selection,a.selection));let n=i[0];for(let r=1;r<i.length;r++){const a=i[r];n.selection.endLineNumber===a.selection.startLineNumber&&(n.index<a.index?a.ignore=!0:(n.ignore=!0,n=a))}const s=[];for(const r of i)s.push(new AZ(r.selection,this.down,r.ignore));t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}class qke extends OZ{constructor(){super(!1,{id:"editor.action.copyLinesUpAction",label:p("lines.copyUp","Copy Line Up"),alias:"Copy Line Up",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:1552,linux:{primary:3600},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"2_line",title:p({key:"miCopyLinesUp",comment:["&& denotes a mnemonic"]},"&&Copy Line Up"),order:1}})}}class Zke extends OZ{constructor(){super(!0,{id:"editor.action.copyLinesDownAction",label:p("lines.copyDown","Copy Line Down"),alias:"Copy Line Down",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:1554,linux:{primary:3602},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"2_line",title:p({key:"miCopyLinesDown",comment:["&& denotes a mnemonic"]},"Co&&py Line Down"),order:2}})}}class Yke extends de{constructor(){super({id:"editor.action.duplicateSelection",label:p("duplicateSelection","Duplicate Selection"),alias:"Duplicate Selection",precondition:T.writable,menuOpts:{menuId:fe.MenubarSelectionMenu,group:"2_line",title:p({key:"miDuplicateSelection",comment:["&& denotes a mnemonic"]},"&&Duplicate Selection"),order:5}})}run(e,t,i){if(!t.hasModel())return;const n=[],s=t.getSelections(),r=t.getModel();for(const a of s)if(a.isEmpty())n.push(new AZ(a,!0));else{const l=new pe(a.endLineNumber,a.endColumn,a.endLineNumber,a.endColumn);n.push(new Ape(l,r.getValueInRange(a)))}t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class FZ extends de{constructor(e,t){super(t),this.down=e}run(e,t){const i=e.get(li),n=[],s=t.getSelections()||[],r=t.getOption(12);for(const a of s)n.push(new gF(a,this.down,r,i));t.pushUndoStop(),t.executeCommands(this.id,n),t.pushUndoStop()}}class Xke extends FZ{constructor(){super(!1,{id:"editor.action.moveLinesUpAction",label:p("lines.moveUp","Move Line Up"),alias:"Move Line Up",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:528,linux:{primary:528},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"2_line",title:p({key:"miMoveLinesUp",comment:["&& denotes a mnemonic"]},"Mo&&ve Line Up"),order:3}})}}class Qke extends FZ{constructor(){super(!0,{id:"editor.action.moveLinesDownAction",label:p("lines.moveDown","Move Line Down"),alias:"Move Line Down",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:530,linux:{primary:530},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"2_line",title:p({key:"miMoveLinesDown",comment:["&& denotes a mnemonic"]},"Move &&Line Down"),order:4}})}}class BZ extends de{constructor(e,t){super(t),this.descending=e}run(e,t){if(!t.hasModel())return;const i=t.getModel();let n=t.getSelections();n.length===1&&n[0].isEmpty()&&(n=[new pe(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))]);for(const r of n)if(!rw.canRun(t.getModel(),r,this.descending))return;const s=[];for(let r=0,a=n.length;r<a;r++)s[r]=new rw(n[r],this.descending);t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}class Jke extends BZ{constructor(){super(!1,{id:"editor.action.sortLinesAscending",label:p("lines.sortAscending","Sort Lines Ascending"),alias:"Sort Lines Ascending",precondition:T.writable})}}class eEe extends BZ{constructor(){super(!0,{id:"editor.action.sortLinesDescending",label:p("lines.sortDescending","Sort Lines Descending"),alias:"Sort Lines Descending",precondition:T.writable})}}class tEe extends de{constructor(){super({id:"editor.action.removeDuplicateLines",label:p("lines.deleteDuplicates","Delete Duplicate Lines"),alias:"Delete Duplicate Lines",precondition:T.writable})}run(e,t){if(!t.hasModel())return;const i=t.getModel();if(i.getLineCount()===1&&i.getLineMaxColumn(1)===1)return;const n=[],s=[];let r=0,a=!0,l=t.getSelections();l.length===1&&l[0].isEmpty()&&(l=[new pe(1,1,i.getLineCount(),i.getLineMaxColumn(i.getLineCount()))],a=!1);for(const c of l){const d=new Set,h=[];for(let m=c.startLineNumber;m<=c.endLineNumber;m++){const _=i.getLineContent(m);d.has(_)||(h.push(_),d.add(_))}const u=new pe(c.startLineNumber,1,c.endLineNumber,i.getLineMaxColumn(c.endLineNumber)),g=c.startLineNumber-r,f=new pe(g,1,g+h.length-1,h[h.length-1].length);n.push(si.replace(u,h.join(`
`))),s.push(f),r+=c.endLineNumber-c.startLineNumber+1-h.length}t.pushUndoStop(),t.executeEdits(this.id,n,a?s:void 0),t.pushUndoStop()}}const NE=class NE extends de{constructor(){super({id:NE.ID,label:p("lines.trimTrailingWhitespace","Trim Trailing Whitespace"),alias:"Trim Trailing Whitespace",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:Fi(2089,2102),weight:100}})}run(e,t,i){let n=[];i.reason==="auto-save"&&(n=(t.getSelections()||[]).map(d=>new A(d.positionLineNumber,d.positionColumn)));const s=t.getSelection();if(s===null)return;const r=e.get(Ke),a=t.getModel(),l=r.getValue("files.trimTrailingWhitespaceInRegexAndStrings",{overrideIdentifier:a?.getLanguageId(),resource:a?.uri}),c=new Uke(s,n,l);t.pushUndoStop(),t.executeCommands(this.id,[c]),t.pushUndoStop()}};NE.ID="editor.action.trimTrailingWhitespace";let fF=NE;class iEe extends de{constructor(){super({id:"editor.action.deleteLines",label:p("lines.delete","Delete Line"),alias:"Delete Line",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:3113,weight:100}})}run(e,t){if(!t.hasModel())return;const i=this._getLinesToRemove(t),n=t.getModel();if(n.getLineCount()===1&&n.getLineMaxColumn(1)===1)return;let s=0;const r=[],a=[];for(let l=0,c=i.length;l<c;l++){const d=i[l];let h=d.startLineNumber,u=d.endLineNumber,g=1,f=n.getLineMaxColumn(u);u<n.getLineCount()?(u+=1,f=1):h>1&&(h-=1,g=n.getLineMaxColumn(h)),r.push(si.replace(new pe(h,g,u,f),"")),a.push(new pe(h-s,d.positionColumn,h-s,d.positionColumn)),s+=d.endLineNumber-d.startLineNumber+1}t.pushUndoStop(),t.executeEdits(this.id,r,a),t.pushUndoStop()}_getLinesToRemove(e){const t=e.getSelections().map(s=>{let r=s.endLineNumber;return s.startLineNumber<s.endLineNumber&&s.endColumn===1&&(r-=1),{startLineNumber:s.startLineNumber,selectionStartColumn:s.selectionStartColumn,endLineNumber:r,positionColumn:s.positionColumn}});t.sort((s,r)=>s.startLineNumber===r.startLineNumber?s.endLineNumber-r.endLineNumber:s.startLineNumber-r.startLineNumber);const i=[];let n=t[0];for(let s=1;s<t.length;s++)n.endLineNumber+1>=t[s].startLineNumber?n.endLineNumber=t[s].endLineNumber:(i.push(n),n=t[s]);return i.push(n),i}}class nEe extends de{constructor(){super({id:"editor.action.indentLines",label:p("lines.indent","Indent Line"),alias:"Indent Line",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:2142,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,Fd.indent(i.cursorConfig,t.getModel(),t.getSelections())),t.pushUndoStop())}}class sEe extends de{constructor(){super({id:"editor.action.outdentLines",label:p("lines.outdent","Outdent Line"),alias:"Outdent Line",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:2140,weight:100}})}run(e,t){Zm.Outdent.runEditorCommand(e,t,null)}}class oEe extends de{constructor(){super({id:"editor.action.insertLineBefore",label:p("lines.insertBefore","Insert Line Above"),alias:"Insert Line Above",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:3075,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,rD.lineInsertBefore(i.cursorConfig,t.getModel(),t.getSelections())))}}class rEe extends de{constructor(){super({id:"editor.action.insertLineAfter",label:p("lines.insertAfter","Insert Line Below"),alias:"Insert Line Below",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:2051,weight:100}})}run(e,t){const i=t._getViewModel();i&&(t.pushUndoStop(),t.executeCommands(this.id,rD.lineInsertAfter(i.cursorConfig,t.getModel(),t.getSelections())))}}class WZ extends de{run(e,t){if(!t.hasModel())return;const i=t.getSelection(),n=this._getRangesToDelete(t),s=[];for(let l=0,c=n.length-1;l<c;l++){const d=n[l],h=n[l+1];L.intersectRanges(d,h)===null?s.push(d):n[l+1]=L.plusRange(d,h)}s.push(n[n.length-1]);const r=this._getEndCursorState(i,s),a=s.map(l=>si.replace(l,""));t.pushUndoStop(),t.executeEdits(this.id,a,r),t.pushUndoStop()}}class aEe extends WZ{constructor(){super({id:"deleteAllLeft",label:p("lines.deleteAllLeft","Delete All Left"),alias:"Delete All Left",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:2049},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];let s=0;return t.forEach(r=>{let a;if(r.endColumn===1&&s>0){const l=r.startLineNumber-s;a=new pe(l,r.startColumn,l,r.startColumn)}else a=new pe(r.startLineNumber,r.startColumn,r.startLineNumber,r.startColumn);s+=r.endLineNumber-r.startLineNumber,r.intersectRanges(e)?i=a:n.push(a)}),i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getSelections();if(t===null)return[];let i=t;const n=e.getModel();return n===null?[]:(i.sort(L.compareRangesUsingStarts),i=i.map(s=>{if(s.isEmpty())if(s.startColumn===1){const r=Math.max(1,s.startLineNumber-1),a=s.startLineNumber===1?1:n.getLineLength(r)+1;return new L(r,a,s.startLineNumber,1)}else return new L(s.startLineNumber,1,s.startLineNumber,s.startColumn);else return new L(s.startLineNumber,1,s.endLineNumber,s.endColumn)}),i)}}class lEe extends WZ{constructor(){super({id:"deleteAllRight",label:p("lines.deleteAllRight","Delete All Right"),alias:"Delete All Right",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:297,secondary:[2068]},weight:100}})}_getEndCursorState(e,t){let i=null;const n=[];for(let s=0,r=t.length,a=0;s<r;s++){const l=t[s],c=new pe(l.startLineNumber-a,l.startColumn,l.startLineNumber-a,l.startColumn);l.intersectRanges(e)?i=c:n.push(c)}return i&&n.unshift(i),n}_getRangesToDelete(e){const t=e.getModel();if(t===null)return[];const i=e.getSelections();if(i===null)return[];const n=i.map(s=>{if(s.isEmpty()){const r=t.getLineMaxColumn(s.startLineNumber);return s.startColumn===r?new L(s.startLineNumber,s.startColumn,s.startLineNumber+1,1):new L(s.startLineNumber,s.startColumn,s.startLineNumber,r)}return s});return n.sort(L.compareRangesUsingStarts),n}}class cEe extends de{constructor(){super({id:"editor.action.joinLines",label:p("lines.joinLines","Join Lines"),alias:"Join Lines",precondition:T.writable,kbOpts:{kbExpr:T.editorTextFocus,primary:0,mac:{primary:296},weight:100}})}run(e,t){const i=t.getSelections();if(i===null)return;let n=t.getSelection();if(n===null)return;i.sort(L.compareRangesUsingStarts);const s=[],r=i.reduce((u,g)=>u.isEmpty()?u.endLineNumber===g.startLineNumber?(n.equalsSelection(u)&&(n=g),g):g.startLineNumber>u.endLineNumber+1?(s.push(u),g):new pe(u.startLineNumber,u.startColumn,g.endLineNumber,g.endColumn):g.startLineNumber>u.endLineNumber?(s.push(u),g):new pe(u.startLineNumber,u.startColumn,g.endLineNumber,g.endColumn));s.push(r);const a=t.getModel();if(a===null)return;const l=[],c=[];let d=n,h=0;for(let u=0,g=s.length;u<g;u++){const f=s[u],m=f.startLineNumber,_=1;let b=0,v,y;const C=a.getLineLength(f.endLineNumber)-f.endColumn;if(f.isEmpty()||f.startLineNumber===f.endLineNumber){const k=f.getStartPosition();k.lineNumber<a.getLineCount()?(v=m+1,y=a.getLineMaxColumn(v)):(v=k.lineNumber,y=a.getLineMaxColumn(k.lineNumber))}else v=f.endLineNumber,y=a.getLineMaxColumn(v);let w=a.getLineContent(m);for(let k=m+1;k<=v;k++){const E=a.getLineContent(k),N=a.getLineFirstNonWhitespaceColumn(k);if(N>=1){let z=!0;w===""&&(z=!1),z&&(w.charAt(w.length-1)===" "||w.charAt(w.length-1)==="	")&&(z=!1,w=w.replace(/[\s\uFEFF\xA0]+$/g," "));const B=E.substr(N-1);w+=(z?" ":"")+B,z?b=B.length+1:b=B.length}else b=0}const x=new L(m,_,v,y);if(!x.isEmpty()){let k;f.isEmpty()?(l.push(si.replace(x,w)),k=new pe(x.startLineNumber-h,w.length-b+1,m-h,w.length-b+1)):f.startLineNumber===f.endLineNumber?(l.push(si.replace(x,w)),k=new pe(f.startLineNumber-h,f.startColumn,f.endLineNumber-h,f.endColumn)):(l.push(si.replace(x,w)),k=new pe(f.startLineNumber-h,f.startColumn,f.startLineNumber-h,w.length-C)),L.intersectRanges(x,n)!==null?d=k:c.push(k)}h+=x.endLineNumber-x.startLineNumber}c.unshift(d),t.pushUndoStop(),t.executeEdits(this.id,l,c),t.pushUndoStop()}}class dEe extends de{constructor(){super({id:"editor.action.transpose",label:p("editor.transpose","Transpose Characters around the Cursor"),alias:"Transpose Characters around the Cursor",precondition:T.writable})}run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const s=[];for(let r=0,a=i.length;r<a;r++){const l=i[r];if(!l.isEmpty())continue;const c=l.getStartPosition(),d=n.getLineMaxColumn(c.lineNumber);if(c.column>=d){if(c.lineNumber===n.getLineCount())continue;const h=new L(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),u=n.getValueInRange(h).split("").reverse().join("");s.push(new xn(new pe(c.lineNumber,Math.max(1,c.column-1),c.lineNumber+1,1),u))}else{const h=new L(c.lineNumber,Math.max(1,c.column-1),c.lineNumber,c.column+1),u=n.getValueInRange(h).split("").reverse().join("");s.push(new kB(h,u,new pe(c.lineNumber,c.column+1,c.lineNumber,c.column+1)))}}t.pushUndoStop(),t.executeCommands(this.id,s),t.pushUndoStop()}}class rp extends de{run(e,t){const i=t.getSelections();if(i===null)return;const n=t.getModel();if(n===null)return;const s=t.getOption(132),r=[];for(const a of i)if(a.isEmpty()){const l=a.getStartPosition(),c=t.getConfiguredWordAtPosition(l);if(!c)continue;const d=new L(l.lineNumber,c.startColumn,l.lineNumber,c.endColumn),h=n.getValueInRange(d);r.push(si.replace(d,this._modifyText(h,s)))}else{const l=n.getValueInRange(a);r.push(si.replace(a,this._modifyText(l,s)))}t.pushUndoStop(),t.executeEdits(this.id,r),t.pushUndoStop()}}class hEe extends rp{constructor(){super({id:"editor.action.transformToUppercase",label:p("editor.transformToUppercase","Transform to Uppercase"),alias:"Transform to Uppercase",precondition:T.writable})}_modifyText(e,t){return e.toLocaleUpperCase()}}class uEe extends rp{constructor(){super({id:"editor.action.transformToLowercase",label:p("editor.transformToLowercase","Transform to Lowercase"),alias:"Transform to Lowercase",precondition:T.writable})}_modifyText(e,t){return e.toLocaleLowerCase()}}class zc{constructor(e,t){this._pattern=e,this._flags=t,this._actual=null,this._evaluated=!1}get(){if(!this._evaluated){this._evaluated=!0;try{this._actual=new RegExp(this._pattern,this._flags)}catch{}}return this._actual}isSupported(){return this.get()!==null}}const RE=class RE extends rp{constructor(){super({id:"editor.action.transformToTitlecase",label:p("editor.transformToTitlecase","Transform to Title Case"),alias:"Transform to Title Case",precondition:T.writable})}_modifyText(e,t){const i=RE.titleBoundary.get();return i?e.toLocaleLowerCase().replace(i,n=>n.toLocaleUpperCase()):e}};RE.titleBoundary=new zc("(^|[^\\p{L}\\p{N}']|((^|\\P{L})'))\\p{L}","gmu");let QL=RE;const Em=class Em extends rp{constructor(){super({id:"editor.action.transformToSnakecase",label:p("editor.transformToSnakecase","Transform to Snake Case"),alias:"Transform to Snake Case",precondition:T.writable})}_modifyText(e,t){const i=Em.caseBoundary.get(),n=Em.singleLetters.get();return!i||!n?e:e.replace(i,"$1_$2").replace(n,"$1_$2$3").toLocaleLowerCase()}};Em.caseBoundary=new zc("(\\p{Ll})(\\p{Lu})","gmu"),Em.singleLetters=new zc("(\\p{Lu}|\\p{N})(\\p{Lu})(\\p{Ll})","gmu");let pC=Em;const PE=class PE extends rp{constructor(){super({id:"editor.action.transformToCamelcase",label:p("editor.transformToCamelcase","Transform to Camel Case"),alias:"Transform to Camel Case",precondition:T.writable})}_modifyText(e,t){const i=PE.wordBoundary.get();if(!i)return e;const n=e.split(i);return n.shift()+n.map(r=>r.substring(0,1).toLocaleUpperCase()+r.substring(1)).join("")}};PE.wordBoundary=new zc("[_\\s-]","gm");let JL=PE;const Tm=class Tm extends rp{constructor(){super({id:"editor.action.transformToPascalcase",label:p("editor.transformToPascalcase","Transform to Pascal Case"),alias:"Transform to Pascal Case",precondition:T.writable})}_modifyText(e,t){const i=Tm.wordBoundary.get(),n=Tm.wordBoundaryToMaintain.get();return!i||!n?e:e.split(n).map(a=>a.split(i)).flat().map(a=>a.substring(0,1).toLocaleUpperCase()+a.substring(1)).join("")}};Tm.wordBoundary=new zc("[_\\s-]","gm"),Tm.wordBoundaryToMaintain=new zc("(?<=\\.)","gm");let ek=Tm;const Nd=class Nd extends rp{static isSupported(){return[this.caseBoundary,this.singleLetters,this.underscoreBoundary].every(t=>t.isSupported())}constructor(){super({id:"editor.action.transformToKebabcase",label:p("editor.transformToKebabcase","Transform to Kebab Case"),alias:"Transform to Kebab Case",precondition:T.writable})}_modifyText(e,t){const i=Nd.caseBoundary.get(),n=Nd.singleLetters.get(),s=Nd.underscoreBoundary.get();return!i||!n||!s?e:e.replace(s,"$1-$3").replace(i,"$1-$2").replace(n,"$1-$2").toLocaleLowerCase()}};Nd.caseBoundary=new zc("(\\p{Ll})(\\p{Lu})","gmu"),Nd.singleLetters=new zc("(\\p{Lu}|\\p{N})(\\p{Lu}\\p{Ll})","gmu"),Nd.underscoreBoundary=new zc("(\\S)(_)(\\S)","gm");let tk=Nd;X(qke);X(Zke);X(Yke);X(Xke);X(Qke);X(Jke);X(eEe);X(tEe);X(fF);X(iEe);X(nEe);X(sEe);X(oEe);X(rEe);X(aEe);X(lEe);X(cEe);X(dEe);X(hEe);X(uEe);pC.caseBoundary.isSupported()&&pC.singleLetters.isSupported()&&X(pC);JL.wordBoundary.isSupported()&&X(JL);ek.wordBoundary.isSupported()&&X(ek);QL.titleBoundary.isSupported()&&X(QL);tk.isSupported()&&X(tk);var gEe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},y1=function(o,e){return function(t,i){e(t,i,o)}},l0;const VZ=new re("LinkedEditingInputVisible",!1),fEe="linked-editing-decoration";var yh;let Y_=(yh=class extends F{static get(e){return e.getContribution(l0.ID)}constructor(e,t,i,n,s){super(),this.languageConfigurationService=n,this._syncRangesToken=0,this._localToDispose=this._register(new $),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=VZ.bindTo(t),this._debounceInformation=s.for(this._providers,"Linked Editing",{max:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new $),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequestCts=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel(()=>this.reinitialize(!0))),this._register(this._editor.onDidChangeConfiguration(r=>{(r.hasChanged(70)||r.hasChanged(94))&&this.reinitialize(!1)})),this._register(this._providers.onDidChange(()=>this.reinitialize(!1))),this._register(this._editor.onDidChangeModelLanguage(()=>this.reinitialize(!0))),this.reinitialize(!0)}reinitialize(e){const t=this._editor.getModel(),i=t!==null&&(this._editor.getOption(70)||this._editor.getOption(94))&&this._providers.has(t);if(i===this._enabled&&!e||(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||t===null))return;this._localToDispose.add(se.runAndSubscribe(t.onDidChangeLanguageConfiguration,()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()}));const n=new hr(this._debounceInformation.get(t)),s=()=>{this._rangeUpdateTriggerPromise=n.trigger(()=>this.updateRanges(),this._debounceDuration??this._debounceInformation.get(t))},r=new hr(0),a=l=>{this._rangeSyncTriggerPromise=r.trigger(()=>this._syncRanges(l))};this._localToDispose.add(this._editor.onDidChangeCursorPosition(()=>{s()})),this._localToDispose.add(this._editor.onDidChangeModelContent(l=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const c=this._currentDecorations.getRange(0);if(c&&l.changes.every(d=>c.intersectRanges(d.range))){a(this._syncRangesToken);return}}s()})),this._localToDispose.add({dispose:()=>{n.dispose(),r.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||this._currentDecorations.length===0)return;const t=this._editor.getModel(),i=this._currentDecorations.getRange(0);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const r=n.match(this._currentWordPattern);if((r?r[0].length:0)!==n.length)return this.clearRanges()}const s=[];for(let r=1,a=this._currentDecorations.length;r<a;r++){const l=this._currentDecorations.getRange(r);if(l)if(l.startLineNumber!==l.endLineNumber)s.push({range:l,text:n});else{let c=t.getValueInRange(l),d=n,h=l.startColumn,u=l.endColumn;const g=Dh(c,d);h+=g,c=c.substr(g),d=d.substr(g);const f=E0(c,d);u-=f,c=c.substr(0,c.length-f),d=d.substr(0,d.length-f),(h!==u||d.length!==0)&&s.push({range:new L(l.startLineNumber,h,l.endLineNumber,u),text:d})}}if(s.length!==0)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const r=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",s),this._editor._getViewModel().setPrevEditOperationType(r)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequestCts&&(this._currentRequestCts.cancel(),this._currentRequestCts=null,this._currentRequestPosition=null)}async updateRanges(e=!1){if(!this._editor.hasModel()){this.clearRanges();return}const t=this._editor.getPosition();if(!this._enabled&&!e||this._editor.getSelections().length>1){this.clearRanges();return}const i=this._editor.getModel(),n=i.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===n){if(t.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const r=this._currentDecorations.getRange(0);if(r&&r.containsPosition(t))return}}this.clearRanges(),this._currentRequestPosition=t,this._currentRequestModelVersion=n;const s=this._currentRequestCts=new ri;try{const r=new rn(!1),a=await HZ(this._providers,i,t,s.token);if(this._debounceInformation.update(i,r.elapsed()),s!==this._currentRequestCts||(this._currentRequestCts=null,n!==i.getVersionId()))return;let l=[];a?.ranges&&(l=a.ranges),this._currentWordPattern=a?.wordPattern||this._languageWordPattern;let c=!1;for(let h=0,u=l.length;h<u;h++)if(L.containsPosition(l[h],t)){if(c=!0,h!==0){const g=l[h];l.splice(h,1),l.unshift(g)}break}if(!c){this.clearRanges();return}const d=l.map(h=>({range:h,options:l0.DECORATION}));this._visibleContextKey.set(!0),this._currentDecorations.set(d),this._syncRangesToken++}catch(r){_r(r)||Ae(r),(this._currentRequestCts===s||!this._currentRequestCts)&&this.clearRanges()}}},l0=yh,yh.ID="editor.contrib.linkedEditing",yh.DECORATION=Fe.register({description:"linked-editing",stickiness:0,className:fEe}),yh);Y_=l0=gEe([y1(1,Ee),y1(2,ue),y1(3,li),y1(4,Uo)],Y_);class pEe extends de{constructor(){super({id:"editor.action.linkedEditing",label:p("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:K.and(T.writable,T.hasRenameProvider),kbOpts:{kbExpr:T.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(gt),[n,s]=Array.isArray(t)&&t||[void 0,void 0];return ye.isUri(n)&&A.isIPosition(s)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(r=>{r&&(r.setPosition(s),r.invokeWithinContext(a=>(this.reportTelemetry(a,r),this.run(a,r))))},Ae):super.runCommand(e,t)}run(e,t){const i=Y_.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const mEe=Hi.bindToContribution(Y_.get);oe(new mEe({id:"cancelLinkedEditingInput",precondition:VZ,handler:o=>o.clearRanges(),kbOpts:{kbExpr:T.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));function HZ(o,e,t,i){const n=o.ordered(e);return B4(n.map(s=>async()=>{try{return await s.provideLinkedEditingRanges(e,t,i)}catch(r){yi(r);return}}),s=>!!s&&Yn(s?.ranges))}D("editor.linkedEditingBackground",{dark:j.fromHex("#f00").transparent(.3),light:j.fromHex("#f00").transparent(.3),hcDark:j.fromHex("#f00").transparent(.3),hcLight:j.white},p("editorLinkedEditingBackground","Background color when the editor auto renames on type."));Os("_executeLinkedEditingProvider",(o,e,t)=>{const{linkedEditingRangeProvider:i}=o.get(ue);return HZ(i,e,t,He.None)});at(Y_.ID,Y_,1);X(pEe);let _Ee=class{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}async resolve(e){return this._link.url?this._link.url:typeof this._provider.resolveLink=="function"?Promise.resolve(this._provider.resolveLink(this._link,e)).then(t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing")))):Promise.reject(new Error("missing"))}};class ik{constructor(e){this._disposables=new $;let t=[];for(const[i,n]of e){const s=i.links.map(r=>new _Ee(r,n));t=ik._union(t,s),JE(i)&&this._disposables.add(i)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){const i=[];let n,s,r,a;for(n=0,r=0,s=e.length,a=t.length;n<s&&r<a;){const l=e[n],c=t[r];if(L.areIntersectingOrTouching(l.range,c.range)){n++;continue}L.compareRangesUsingStarts(l.range,c.range)<0?(i.push(l),n++):(i.push(c),r++)}for(;n<s;n++)i.push(e[n]);for(;r<a;r++)i.push(t[r]);return i}}function zZ(o,e,t){const i=[],n=o.ordered(e).reverse().map((s,r)=>Promise.resolve(s.provideLinks(e,t)).then(a=>{a&&(i[r]=[a,s])},yi));return Promise.all(n).then(()=>{const s=new ik(Vr(i));return t.isCancellationRequested?(s.dispose(),new ik([])):s})}st.registerCommand("_executeLinkProvider",async(o,...e)=>{let[t,i]=e;ut(t instanceof ye),typeof i!="number"&&(i=0);const{linkProvider:n}=o.get(ue),s=o.get(Ut).getModel(t);if(!s)return[];const r=await zZ(n,s,He.None);if(!r)return[];for(let l=0;l<Math.min(i,r.links.length);l++)await r.links[l].resolve(He.None);const a=r.links.slice(0);return r.dispose(),a});var bEe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},w1=function(o,e){return function(t,i){e(t,i,o)}},pF,Jg;let aw=(Jg=class extends F{static get(e){return e.getContribution(pF.ID)}constructor(e,t,i,n,s){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=n,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=s.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new xt(()=>this.computeLinksNow(),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const r=this._register(new yD(e));this._register(r.onMouseMoveOrRelevantKeyDown(([a,l])=>{this._onEditorMouseMove(a,l)})),this._register(r.onExecute(a=>{this.onEditorMouseUp(a)})),this._register(r.onCancel(a=>{this.cleanUpActiveLinkDecoration()})),this._register(e.onDidChangeConfiguration(a=>{a.hasChanged(71)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))})),this._register(e.onDidChangeModelContent(a=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))})),this._register(e.onDidChangeModel(a=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)})),this._register(e.onDidChangeModelLanguage(a=>{this.stop(),this.computeLinks.schedule(0)})),this._register(this.providers.onDidChange(a=>{this.stop(),this.computeLinks.schedule(0)})),this.computeLinks.schedule(0)}async computeLinksNow(){if(!this.editor.hasModel()||!this.editor.getOption(71))return;const e=this.editor.getModel();if(!e.isTooLargeForSyncing()&&this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=ji(t=>zZ(this.providers,e,t));try{const t=new rn(!1);if(this.activeLinksList=await this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(t){Ae(t)}finally{this.computePromise=null}}}updateDecorations(e){const t=this.editor.getOption(78)==="altKey",i=[],n=Object.keys(this.currentOccurrences);for(const r of n){const a=this.currentOccurrences[r];i.push(a.decorationId)}const s=[];if(e)for(const r of e)s.push(Jm.decoration(r,t));this.editor.changeDecorations(r=>{const a=r.deltaDecorations(i,s);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let l=0,c=a.length;l<c;l++){const d=new Jm(e[l],a[l]);this.currentOccurrences[d.decorationId]=d}})}_onEditorMouseMove(e,t){const i=this.editor.getOption(78)==="altKey";if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const n=this.getLinkOccurrence(e.target.position);n&&this.editor.changeDecorations(s=>{n.activate(s,i),this.activeLinkDecorationId=n.decorationId})}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e=this.editor.getOption(78)==="altKey";if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations(i=>{t.deactivate(i,e)}),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,i=!1){if(!this.openerService)return;const{link:n}=e;n.resolve(He.None).then(s=>{if(typeof s=="string"&&this.editor.hasModel()){const r=this.editor.getModel().uri;if(r.scheme===Oe.file&&s.startsWith(`${Oe.file}:`)){const a=ye.parse(s);if(a.scheme===Oe.file){const l=Qa(a);let c=null;l.startsWith("/./")||l.startsWith("\\.\\")?c=`.${l.substr(1)}`:(l.startsWith("//./")||l.startsWith("\\\\.\\"))&&(c=`.${l.substr(2)}`),c&&(s=vre(r,c))}}}return this.openerService.open(s,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})},s=>{const r=s instanceof Error?s.message:s;r==="invalid"?this.notificationService.warn(p("invalid.url","Failed to open this link because it is not well-formed: {0}",n.url.toString())):r==="missing"?this.notificationService.warn(p("missing.url","Failed to open this link because its target is missing.")):Ae(s)})}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const i of t){const n=this.currentOccurrences[i.id];if(n)return n}return null}isEnabled(e,t){return!!(e.target.type===6&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){this.computeLinks.cancel(),this.activeLinksList&&(this.activeLinksList?.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}},pF=Jg,Jg.ID="editor.linkDetector",Jg);aw=pF=bEe([w1(1,Fs),w1(2,Ei),w1(3,ue),w1(4,Uo)],aw);const C6={general:Fe.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:Fe.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class Jm{static decoration(e,t){return{range:e.range,options:Jm._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n={...i?C6.active:C6.general};return n.hoverMessage=vEe(e,t),n}constructor(e,t){this.link=e,this.decorationId=t}activate(e,t){e.changeDecorationOptions(this.decorationId,Jm._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,Jm._getOptions(this.link,t,!1))}}function vEe(o,e){const t=o.url&&/^command:/i.test(o.url.toString()),i=o.tooltip?o.tooltip:t?p("links.navigate.executeCmd","Execute command"):p("links.navigate.follow","Follow link"),n=e?Qe?p("links.navigate.kb.meta.mac","cmd + click"):p("links.navigate.kb.meta","ctrl + click"):Qe?p("links.navigate.kb.alt.mac","option + click"):p("links.navigate.kb.alt","alt + click");if(o.url){let s="";if(/^command:/i.test(o.url.toString())){const a=o.url.toString().match(/^command:([^?#]+)/);if(a){const l=a[1];s=p("tooltip.explanation","Execute command {0}",l)}}return new Pn("",!0).appendLink(o.url.toString(!0).replace(/ /g,"%20"),i,s).appendMarkdown(` (${n})`)}else return new Pn().appendText(`${i} (${n})`)}class CEe extends de{constructor(){super({id:"editor.action.openLink",label:p("label","Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){const i=aw.get(t);if(!i||!t.hasModel())return;const n=t.getSelections();for(const s of n){const r=i.getLinkOccurrence(s.getEndPosition());r&&i.openLinkOccurrence(r,!1)}}}at(aw.ID,aw,1);X(CEe);const l3=class l3 extends F{constructor(e){super(),this._editor=e,this._register(this._editor.onMouseDown(t=>{const i=this._editor.getOption(118);i>=0&&t.target.type===6&&t.target.position.column>=i&&this._editor.updateOptions({stopRenderingLineAfter:-1})}))}};l3.ID="editor.contrib.longLinesHelper";let nk=l3;at(nk.ID,nk,2);const yEe=D("editor.wordHighlightBackground",{dark:"#575757B8",light:"#57575740",hcDark:null,hcLight:null},p("wordHighlight","Background color of a symbol during read-access, like reading a variable. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.wordHighlightStrongBackground",{dark:"#004972B8",light:"#0e639c40",hcDark:null,hcLight:null},p("wordHighlightStrong","Background color of a symbol during write-access, like writing to a variable. The color must not be opaque so as not to hide underlying decorations."),!0);D("editor.wordHighlightTextBackground",yEe,p("wordHighlightText","Background color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0);const wEe=D("editor.wordHighlightBorder",{light:null,dark:null,hcDark:qt,hcLight:qt},p("wordHighlightBorder","Border color of a symbol during read-access, like reading a variable."));D("editor.wordHighlightStrongBorder",{light:null,dark:null,hcDark:qt,hcLight:qt},p("wordHighlightStrongBorder","Border color of a symbol during write-access, like writing to a variable."));D("editor.wordHighlightTextBorder",wEe,p("wordHighlightTextBorder","Border color of a textual occurrence for a symbol."));const SEe=D("editorOverviewRuler.wordHighlightForeground","#A0A0A0CC",p("overviewRulerWordHighlightForeground","Overview ruler marker color for symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),xEe=D("editorOverviewRuler.wordHighlightStrongForeground","#C0A0C0CC",p("overviewRulerWordHighlightStrongForeground","Overview ruler marker color for write-access symbol highlights. The color must not be opaque so as not to hide underlying decorations."),!0),LEe=D("editorOverviewRuler.wordHighlightTextForeground",cG,p("overviewRulerWordHighlightTextForeground","Overview ruler marker color of a textual occurrence for a symbol. The color must not be opaque so as not to hide underlying decorations."),!0),kEe=Fe.register({description:"word-highlight-strong",stickiness:1,className:"wordHighlightStrong",overviewRuler:{color:fi(xEe),position:Ao.Center},minimap:{color:fi(TT),position:1}}),EEe=Fe.register({description:"word-highlight-text",stickiness:1,className:"wordHighlightText",overviewRuler:{color:fi(LEe),position:Ao.Center},minimap:{color:fi(TT),position:1}}),TEe=Fe.register({description:"selection-highlight-overview",stickiness:1,className:"selectionHighlight",overviewRuler:{color:fi(cG),position:Ao.Center},minimap:{color:fi(TT),position:1}}),DEe=Fe.register({description:"selection-highlight",stickiness:1,className:"selectionHighlight"}),IEe=Fe.register({description:"word-highlight",stickiness:1,className:"wordHighlight",overviewRuler:{color:fi(SEe),position:Ao.Center},minimap:{color:fi(TT),position:1}});function NEe(o){return o===f_.Write?kEe:o===f_.Text?EEe:IEe}function REe(o){return o?DEe:TEe}br((o,e)=>{const t=o.getColor(h5);t&&e.addRule(`.monaco-editor .selectionHighlight { background-color: ${t.transparent(.5)}; }`)});var PEe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},AEe=function(o,e){return function(t,i){e(t,i,o)}},mF;function tu(o,e){const t=e.filter(i=>!o.find(n=>n.equals(i)));if(t.length>=1){const i=t.map(s=>`line ${s.viewState.position.lineNumber} column ${s.viewState.position.column}`).join(", "),n=t.length===1?p("cursorAdded","Cursor added: {0}",i):p("cursorsAdded","Cursors added: {0}",i);Rl(n)}}class MEe extends de{constructor(){super({id:"editor.action.insertCursorAbove",label:p("mutlicursor.insertAbove","Add Cursor Above"),alias:"Add Cursor Above",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:2576,linux:{primary:1552,secondary:[3088]},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"3_multi",title:p({key:"miInsertCursorAbove",comment:["&& denotes a mnemonic"]},"&&Add Cursor Above"),order:2}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const r=s.getCursorStates();s.setCursorStates(i.source,3,dn.addCursorUp(s,r,n)),s.revealTopMostCursor(i.source),tu(r,s.getCursorStates())}}class OEe extends de{constructor(){super({id:"editor.action.insertCursorBelow",label:p("mutlicursor.insertBelow","Add Cursor Below"),alias:"Add Cursor Below",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:2578,linux:{primary:1554,secondary:[3090]},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"3_multi",title:p({key:"miInsertCursorBelow",comment:["&& denotes a mnemonic"]},"A&&dd Cursor Below"),order:3}})}run(e,t,i){if(!t.hasModel())return;let n=!0;i&&i.logicalLine===!1&&(n=!1);const s=t._getViewModel();if(s.cursorConfig.readOnly)return;s.model.pushStackElement();const r=s.getCursorStates();s.setCursorStates(i.source,3,dn.addCursorDown(s,r,n)),s.revealBottomMostCursor(i.source),tu(r,s.getCursorStates())}}class FEe extends de{constructor(){super({id:"editor.action.insertCursorAtEndOfEachLineSelected",label:p("mutlicursor.insertAtEndOfEachLineSelected","Add Cursors to Line Ends"),alias:"Add Cursors to Line Ends",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:1575,weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"3_multi",title:p({key:"miInsertCursorAtEndOfEachLineSelected",comment:["&& denotes a mnemonic"]},"Add C&&ursors to Line Ends"),order:4}})}getCursorsForSelection(e,t,i){if(!e.isEmpty()){for(let n=e.startLineNumber;n<e.endLineNumber;n++){const s=t.getLineMaxColumn(n);i.push(new pe(n,s,n,s))}e.endColumn>1&&i.push(new pe(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn))}}run(e,t){if(!t.hasModel())return;const i=t.getModel(),n=t.getSelections(),s=t._getViewModel(),r=s.getCursorStates(),a=[];n.forEach(l=>this.getCursorsForSelection(l,i,a)),a.length>0&&t.setSelections(a),tu(r,s.getCursorStates())}}class BEe extends de{constructor(){super({id:"editor.action.addCursorsToBottom",label:p("mutlicursor.addCursorsToBottom","Add Cursors To Bottom"),alias:"Add Cursors To Bottom",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=t.getModel().getLineCount(),s=[];for(let l=i[0].startLineNumber;l<=n;l++)s.push(new pe(l,i[0].startColumn,l,i[0].endColumn));const r=t._getViewModel(),a=r.getCursorStates();s.length>0&&t.setSelections(s),tu(a,r.getCursorStates())}}class WEe extends de{constructor(){super({id:"editor.action.addCursorsToTop",label:p("mutlicursor.addCursorsToTop","Add Cursors To Top"),alias:"Add Cursors To Top",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getSelections(),n=[];for(let a=i[0].startLineNumber;a>=1;a--)n.push(new pe(a,i[0].startColumn,a,i[0].endColumn));const s=t._getViewModel(),r=s.getCursorStates();n.length>0&&t.setSelections(n),tu(r,s.getCursorStates())}}class S1{constructor(e,t,i){this.selections=e,this.revealRange=t,this.revealScrollType=i}}class lw{static create(e,t){if(!e.hasModel())return null;const i=t.getState();if(!e.hasTextFocus()&&i.isRevealed&&i.searchString.length>0)return new lw(e,t,!1,i.searchString,i.wholeWord,i.matchCase,null);let n=!1,s,r;const a=e.getSelections();a.length===1&&a[0].isEmpty()?(n=!0,s=!0,r=!0):(s=i.wholeWord,r=i.matchCase);const l=e.getSelection();let c,d=null;if(l.isEmpty()){const h=e.getConfiguredWordAtPosition(l.getStartPosition());if(!h)return null;c=h.word,d=new pe(l.startLineNumber,h.startColumn,l.startLineNumber,h.endColumn)}else c=e.getModel().getValueInRange(l).replace(/\r\n/g,`
`);return new lw(e,t,n,c,s,r,d)}constructor(e,t,i,n,s,r,a){this._editor=e,this.findController=t,this.isDisconnectedFromFindController=i,this.searchText=n,this.wholeWord=s,this.matchCase=r,this.currentMatch=a}addSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new S1(t.concat(e),e,0)}moveSelectionToNextFindMatch(){if(!this._editor.hasModel())return null;const e=this._getNextMatch();if(!e)return null;const t=this._editor.getSelections();return new S1(t.slice(0,t.length-1).concat(e),e,0)}_getNextMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findNextMatch(this.searchText,t.getEndPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1);return i?new pe(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}addSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new S1(t.concat(e),e,0)}moveSelectionToPreviousFindMatch(){if(!this._editor.hasModel())return null;const e=this._getPreviousMatch();if(!e)return null;const t=this._editor.getSelections();return new S1(t.slice(0,t.length-1).concat(e),e,0)}_getPreviousMatch(){if(!this._editor.hasModel())return null;if(this.currentMatch){const n=this.currentMatch;return this.currentMatch=null,n}this.findController.highlightFindOptions();const e=this._editor.getSelections(),t=e[e.length-1],i=this._editor.getModel().findPreviousMatch(this.searchText,t.getStartPosition(),!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1);return i?new pe(i.range.startLineNumber,i.range.startColumn,i.range.endLineNumber,i.range.endColumn):null}selectAll(e){if(!this._editor.hasModel())return[];this.findController.highlightFindOptions();const t=this._editor.getModel();return e?t.findMatches(this.searchText,e,!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1,1073741824):t.findMatches(this.searchText,!0,!1,this.matchCase,this.wholeWord?this._editor.getOption(132):null,!1,1073741824)}}const AE=class AE extends F{static get(e){return e.getContribution(AE.ID)}constructor(e){super(),this._sessionDispose=this._register(new $),this._editor=e,this._ignoreSelectionChange=!1,this._session=null}dispose(){this._endSession(),super.dispose()}_beginSessionIfNeeded(e){if(!this._session){const t=lw.create(this._editor,e);if(!t)return;this._session=t;const i={searchString:this._session.searchText};this._session.isDisconnectedFromFindController&&(i.wholeWordOverride=1,i.matchCaseOverride=1,i.isRegexOverride=2),e.getState().change(i,!1),this._sessionDispose.add(this._editor.onDidChangeCursorSelection(n=>{this._ignoreSelectionChange||this._endSession()})),this._sessionDispose.add(this._editor.onDidBlurEditorText(()=>{this._endSession()})),this._sessionDispose.add(e.getState().onFindReplaceStateChange(n=>{(n.matchCase||n.wholeWord)&&this._endSession()}))}}_endSession(){if(this._sessionDispose.clear(),this._session&&this._session.isDisconnectedFromFindController){const e={wholeWordOverride:0,matchCaseOverride:0,isRegexOverride:0};this._session.findController.getState().change(e,!1)}this._session=null}_setSelections(e){this._ignoreSelectionChange=!0,this._editor.setSelections(e),this._ignoreSelectionChange=!1}_expandEmptyToWord(e,t){if(!t.isEmpty())return t;const i=this._editor.getConfiguredWordAtPosition(t.getStartPosition());return i?new pe(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):t}_applySessionResult(e){e&&(this._setSelections(e.selections),e.revealRange&&this._editor.revealRangeInCenterIfOutsideViewport(e.revealRange,e.revealScrollType))}getSession(e){return this._session}addSelectionToNextFindMatch(e){if(this._editor.hasModel()){if(!this._session){const t=this._editor.getSelections();if(t.length>1){const n=e.getState().matchCase;if(!UZ(this._editor.getModel(),t,n)){const r=this._editor.getModel(),a=[];for(let l=0,c=t.length;l<c;l++)a[l]=this._expandEmptyToWord(r,t[l]);this._editor.setSelections(a);return}}}this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToNextFindMatch())}}addSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.addSelectionToPreviousFindMatch())}moveSelectionToNextFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToNextFindMatch())}moveSelectionToPreviousFindMatch(e){this._beginSessionIfNeeded(e),this._session&&this._applySessionResult(this._session.moveSelectionToPreviousFindMatch())}selectAll(e){if(!this._editor.hasModel())return;let t=null;const i=e.getState();if(i.isRevealed&&i.searchString.length>0&&i.isRegex){const n=this._editor.getModel();i.searchScope?t=n.findMatches(i.searchString,i.searchScope,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(132):null,!1,1073741824):t=n.findMatches(i.searchString,!0,i.isRegex,i.matchCase,i.wholeWord?this._editor.getOption(132):null,!1,1073741824)}else{if(this._beginSessionIfNeeded(e),!this._session)return;t=this._session.selectAll(i.searchScope)}if(t.length>0){const n=this._editor.getSelection();for(let s=0,r=t.length;s<r;s++){const a=t[s];if(a.range.intersectRanges(n)){t[s]=t[0],t[0]=a;break}}this._setSelections(t.map(s=>new pe(s.range.startLineNumber,s.range.startColumn,s.range.endLineNumber,s.range.endColumn)))}}};AE.ID="editor.contrib.multiCursorController";let X_=AE;class kb extends de{run(e,t){const i=X_.get(t);if(!i)return;const n=t._getViewModel();if(n){const s=n.getCursorStates(),r=As.get(t);if(r)this._run(i,r);else{const a=e.get(Ce).createInstance(As,t);this._run(i,a),a.dispose()}tu(s,n.getCursorStates())}}}class VEe extends kb{constructor(){super({id:"editor.action.addSelectionToNextFindMatch",label:p("addSelectionToNextFindMatch","Add Selection To Next Find Match"),alias:"Add Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:2082,weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"3_multi",title:p({key:"miAddSelectionToNextFindMatch",comment:["&& denotes a mnemonic"]},"Add &&Next Occurrence"),order:5}})}_run(e,t){e.addSelectionToNextFindMatch(t)}}class HEe extends kb{constructor(){super({id:"editor.action.addSelectionToPreviousFindMatch",label:p("addSelectionToPreviousFindMatch","Add Selection To Previous Find Match"),alias:"Add Selection To Previous Find Match",precondition:void 0,menuOpts:{menuId:fe.MenubarSelectionMenu,group:"3_multi",title:p({key:"miAddSelectionToPreviousFindMatch",comment:["&& denotes a mnemonic"]},"Add P&&revious Occurrence"),order:6}})}_run(e,t){e.addSelectionToPreviousFindMatch(t)}}class zEe extends kb{constructor(){super({id:"editor.action.moveSelectionToNextFindMatch",label:p("moveSelectionToNextFindMatch","Move Last Selection To Next Find Match"),alias:"Move Last Selection To Next Find Match",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:Fi(2089,2082),weight:100}})}_run(e,t){e.moveSelectionToNextFindMatch(t)}}class UEe extends kb{constructor(){super({id:"editor.action.moveSelectionToPreviousFindMatch",label:p("moveSelectionToPreviousFindMatch","Move Last Selection To Previous Find Match"),alias:"Move Last Selection To Previous Find Match",precondition:void 0})}_run(e,t){e.moveSelectionToPreviousFindMatch(t)}}class GEe extends kb{constructor(){super({id:"editor.action.selectHighlights",label:p("selectAllOccurrencesOfFindMatch","Select All Occurrences of Find Match"),alias:"Select All Occurrences of Find Match",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:3114,weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"3_multi",title:p({key:"miSelectHighlights",comment:["&& denotes a mnemonic"]},"Select All &&Occurrences"),order:7}})}_run(e,t){e.selectAll(t)}}class $Ee extends kb{constructor(){super({id:"editor.action.changeAll",label:p("changeAll.label","Change All Occurrences"),alias:"Change All Occurrences",precondition:K.and(T.writable,T.editorTextFocus),kbOpts:{kbExpr:T.editorTextFocus,primary:2108,weight:100},contextMenuOpts:{group:"1_modification",order:1.2}})}_run(e,t){e.selectAll(t)}}class KEe{constructor(e,t,i,n,s){this._model=e,this._searchText=t,this._matchCase=i,this._wordSeparators=n,this._modelVersionId=this._model.getVersionId(),this._cachedFindMatches=null,s&&this._model===s._model&&this._searchText===s._searchText&&this._matchCase===s._matchCase&&this._wordSeparators===s._wordSeparators&&this._modelVersionId===s._modelVersionId&&(this._cachedFindMatches=s._cachedFindMatches)}findMatches(){return this._cachedFindMatches===null&&(this._cachedFindMatches=this._model.findMatches(this._searchText,!0,!1,this._matchCase,this._wordSeparators,!1).map(e=>e.range),this._cachedFindMatches.sort(L.compareRangesUsingStarts)),this._cachedFindMatches}}var ef;let sk=(ef=class extends F{constructor(e,t){super(),this._languageFeaturesService=t,this.editor=e,this._isEnabled=e.getOption(109),this._decorations=e.createDecorationsCollection(),this.updateSoon=this._register(new xt(()=>this._update(),300)),this.state=null,this._register(e.onDidChangeConfiguration(n=>{this._isEnabled=e.getOption(109)})),this._register(e.onDidChangeCursorSelection(n=>{this._isEnabled&&(n.selection.isEmpty()?n.reason===3?(this.state&&this._setState(null),this.updateSoon.schedule()):this._setState(null):this._update())})),this._register(e.onDidChangeModel(n=>{this._setState(null)})),this._register(e.onDidChangeModelContent(n=>{this._isEnabled&&this.updateSoon.schedule()}));const i=As.get(e);i&&this._register(i.getState().onFindReplaceStateChange(n=>{this._update()})),this.updateSoon.schedule()}_update(){this._setState(mF._createState(this.state,this._isEnabled,this.editor))}static _createState(e,t,i){if(!t||!i.hasModel())return null;const n=i.getSelection();if(n.startLineNumber!==n.endLineNumber)return null;const s=X_.get(i);if(!s)return null;const r=As.get(i);if(!r)return null;let a=s.getSession(r);if(!a){const d=i.getSelections();if(d.length>1){const u=r.getState().matchCase;if(!UZ(i.getModel(),d,u))return null}a=lw.create(i,r)}if(!a||a.currentMatch||/^[ \t]+$/.test(a.searchText)||a.searchText.length>200)return null;const l=r.getState(),c=l.matchCase;if(l.isRevealed){let d=l.searchString;c||(d=d.toLowerCase());let h=a.searchText;if(c||(h=h.toLowerCase()),d===h&&a.matchCase===l.matchCase&&a.wholeWord===l.wholeWord&&!l.isRegex)return null}return new KEe(i.getModel(),a.searchText,a.matchCase,a.wholeWord?i.getOption(132):null,e)}_setState(e){if(this.state=e,!this.state){this._decorations.clear();return}if(!this.editor.hasModel())return;const t=this.editor.getModel();if(t.isTooLargeForTokenization())return;const i=this.state.findMatches(),n=this.editor.getSelections();n.sort(L.compareRangesUsingStarts);const s=[];for(let c=0,d=0,h=i.length,u=n.length;c<h;){const g=i[c];if(d>=u)s.push(g),c++;else{const f=L.compareRangesUsingStarts(g,n[d]);f<0?((n[d].isEmpty()||!L.areIntersecting(g,n[d]))&&s.push(g),c++):(f>0||c++,d++)}}const r=this.editor.getOption(81)!=="off",a=this._languageFeaturesService.documentHighlightProvider.has(t)&&r,l=s.map(c=>({range:c,options:REe(a)}));this._decorations.set(l)}dispose(){this._setState(null),super.dispose()}},mF=ef,ef.ID="editor.contrib.selectionHighlighter",ef);sk=mF=PEe([AEe(1,ue)],sk);function UZ(o,e,t){const i=y6(o,e[0],!t);for(let n=1,s=e.length;n<s;n++){const r=e[n];if(r.isEmpty())return!1;const a=y6(o,r,!t);if(i!==a)return!1}return!0}function y6(o,e,t){const i=o.getValueInRange(e);return t?i.toLowerCase():i}class jEe extends de{constructor(){super({id:"editor.action.focusNextCursor",label:p("mutlicursor.focusNextCursor","Focus Next Cursor"),metadata:{description:p("mutlicursor.focusNextCursor.description","Focuses the next cursor"),args:[]},alias:"Focus Next Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const s=Array.from(n.getCursorStates()),r=s.shift();r&&(s.push(r),n.setCursorStates(i.source,3,s),n.revealPrimaryCursor(i.source,!0),tu(s,n.getCursorStates()))}}class qEe extends de{constructor(){super({id:"editor.action.focusPreviousCursor",label:p("mutlicursor.focusPreviousCursor","Focus Previous Cursor"),metadata:{description:p("mutlicursor.focusPreviousCursor.description","Focuses the previous cursor"),args:[]},alias:"Focus Previous Cursor",precondition:void 0})}run(e,t,i){if(!t.hasModel())return;const n=t._getViewModel();if(n.cursorConfig.readOnly)return;n.model.pushStackElement();const s=Array.from(n.getCursorStates()),r=s.pop();r&&(s.unshift(r),n.setCursorStates(i.source,3,s),n.revealPrimaryCursor(i.source,!0),tu(s,n.getCursorStates()))}}at(X_.ID,X_,4);at(sk.ID,sk,1);X(MEe);X(OEe);X(FEe);X(VEe);X(HEe);X(zEe);X(UEe);X(GEe);X($Ee);X(BEe);X(WEe);X(jEe);X(qEe);const ZEe="editor.action.inlineEdit.accept",YEe="editor.action.inlineEdit.reject",XEe="editor.action.inlineEdit.jumpTo",QEe="editor.action.inlineEdit.jumpBack";var JEe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},eTe=function(o,e){return function(t,i){e(t,i,o)}};const AN="inline-edit";let _F=class extends F{constructor(e,t,i){super(),this.editor=e,this.model=t,this.languageService=i,this.isDisposed=$e(this,!1),this.currentTextModel=yt(this,this.editor.onDidChangeModel,()=>this.editor.getModel()),this.uiState=me(this,n=>{if(this.isDisposed.read(n))return;const s=this.currentTextModel.read(n);if(s!==this.model.targetTextModel.read(n))return;const r=this.model.ghostText.read(n);if(!r)return;let a=this.model.range?.read(n);a&&a.startLineNumber===a.endLineNumber&&a.startColumn===a.endColumn&&(a=void 0);const l=(a?a.startLineNumber===a.endLineNumber:!0)&&r.parts.length===1&&r.parts[0].lines.length===1,c=r.parts.length===1&&r.parts[0].lines.every(v=>v.length===0),d=[],h=[];function u(v,y){if(h.length>0){const C=h[h.length-1];y&&C.decorations.push(new as(C.content.length+1,C.content.length+1+v[0].length,y,0)),C.content+=v[0],v=v.slice(1)}for(const C of v)h.push({content:C,decorations:y?[new as(1,C.length+1,y,0)]:[]})}const g=s.getLineContent(r.lineNumber);let f,m=0;if(!c&&(l||!a)){for(const v of r.parts){let y=v.lines;a&&!l&&(u(y,AN),y=[]),f===void 0?(d.push({column:v.column,text:y[0],preview:v.preview}),y=y.slice(1)):u([g.substring(m,v.column-1)],void 0),y.length>0&&(u(y,AN),f===void 0&&v.column<=g.length&&(f=v.column)),m=v.column-1}f!==void 0&&u([g.substring(m)],void 0)}const _=f!==void 0?new xZ(f,g.length+1):void 0,b=l||!a?r.lineNumber:a.endLineNumber-1;return{inlineTexts:d,additionalLines:h,hiddenRange:_,lineNumber:b,additionalReservedLineCount:this.model.minReservedLineCount.read(n),targetTextModel:s,range:a,isSingleLine:l,isPureRemove:c}}),this.decorations=me(this,n=>{const s=this.uiState.read(n);if(!s)return[];const r=[];if(s.hiddenRange&&r.push({range:s.hiddenRange.toRange(s.lineNumber),options:{inlineClassName:"inline-edit-hidden",description:"inline-edit-hidden"}}),s.range){const a=[];if(s.isSingleLine)a.push(s.range);else if(!s.isPureRemove){const l=s.range.endLineNumber-s.range.startLineNumber;for(let c=0;c<l;c++){const d=s.range.startLineNumber+c,h=s.targetTextModel.getLineFirstNonWhitespaceColumn(d),u=s.targetTextModel.getLineLastNonWhitespaceColumn(d),g=new L(d,h,d,u);a.push(g)}}for(const l of a)r.push({range:l,options:F_})}if(s.range&&!s.isSingleLine&&s.isPureRemove){const a=new L(s.range.startLineNumber,1,s.range.endLineNumber-1,1);r.push({range:a,options:Wy})}for(const a of s.inlineTexts)r.push({range:L.fromPositions(new A(s.lineNumber,a.column)),options:{description:AN,after:{content:a.text,inlineClassName:a.preview?"inline-edit-decoration-preview":"inline-edit-decoration",cursorStops:Or.Left},showIfCollapsed:!0}});return r}),this._register(ve(()=>{this.isDisposed.set(!0,void 0)})),this._register(LZ(this.editor,this.decorations))}};_F=JEe([eTe(2,ti)],_F);var zW=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},gl=function(o,e){return function(t,i){e(t,i,o)}},c0;let bF=class extends F{constructor(e,t,i){super(),this.editor=e,this.model=t,this.instantiationService=i,this.alwaysShowToolbar=yt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).showToolbar==="always"),this.sessionPosition=void 0,this.position=me(this,n=>{const s=this.model.read(n)?.model.ghostText.read(n);if(!this.alwaysShowToolbar.read(n)||!s||s.parts.length===0)return this.sessionPosition=void 0,null;const r=s.parts[0].column;this.sessionPosition&&this.sessionPosition.lineNumber!==s.lineNumber&&(this.sessionPosition=void 0);const a=new A(s.lineNumber,Math.min(r,this.sessionPosition?.column??Number.MAX_SAFE_INTEGER));return this.sessionPosition=a,a}),this._register(Is((n,s)=>{if(!this.model.read(n)||!this.alwaysShowToolbar.read(n))return;const a=s.add(this.instantiationService.createInstance(vF,this.editor,!0,this.position));e.addContentWidget(a),s.add(ve(()=>e.removeContentWidget(a)))}))}};bF=zW([gl(2,Ce)],bF);var wh;let vF=(wh=class extends F{constructor(e,t,i,n,s,r){super(),this.editor=e,this.withBorder=t,this._position=i,this._contextKeyService=s,this._menuService=r,this.id=`InlineEditHintsContentWidget${c0.id++}`,this.allowEditorOverflow=!0,this.suppressMouseDown=!1,this.nodes=Ye("div.inlineEditHints",{className:this.withBorder?".withBorder":""},[Ye("div@toolBar")]),this.inlineCompletionsActionsMenus=this._register(this._menuService.createMenu(fe.InlineEditActions,this._contextKeyService)),this.toolBar=this._register(n.createInstance(CF,this.nodes.toolBar,this.editor,fe.InlineEditToolbar,{menuOptions:{renderShortTitle:!0},toolbarOptions:{primaryGroup:a=>a.startsWith("primary")},actionViewItemProvider:(a,l)=>{if(a instanceof io)return n.createInstance(tTe,a,void 0)},telemetrySource:"InlineEditToolbar"})),this._register(this.toolBar.onDidChangeDropdownVisibility(a=>{c0._dropDownVisible=a})),this._register(Re(a=>{this._position.read(a),this.editor.layoutContentWidget(this)})),this._register(Re(a=>{const l=[];for(const[c,d]of this.inlineCompletionsActionsMenus.getActions())for(const h of d)h instanceof io&&l.push(h);l.length>0&&l.unshift(new Zi),this.toolBar.setAdditionalSecondaryActions(l)}))}getId(){return this.id}getDomNode(){return this.nodes.root}getPosition(){return{position:this._position.get(),preference:[1,2],positionAffinity:3}}},c0=wh,wh._dropDownVisible=!1,wh.id=0,wh);vF=c0=zW([gl(3,Ce),gl(4,Ee),gl(5,zo)],vF);class tTe extends Fh{updateLabel(){const e=this._keybindingService.lookupKeybinding(this._action.id,this._contextKeyService);if(!e)return super.updateLabel();if(this.label){const t=Ye("div.keybinding").root;this._register(new _b(t,Js,{disableTitle:!0,...mK})).set(e),this.label.textContent=this._action.label,this.label.appendChild(t),this.label.classList.add("inlineEditStatusBarItemLabel")}}updateTooltip(){}}let CF=class extends Hy{constructor(e,t,i,n,s,r,a,l,c,d){super(e,{resetMenu:i,...n},s,r,a,l,c,d),this.editor=t,this.menuId=i,this.options2=n,this.menuService=s,this.contextKeyService=r,this.menu=this._store.add(this.menuService.createMenu(this.menuId,this.contextKeyService,{emitEventsForSubmenuChanges:!0})),this.additionalActions=[],this.prependedPrimaryActions=[],this._store.add(this.menu.onDidChange(()=>this.updateToolbar())),this._store.add(this.editor.onDidChangeCursorPosition(()=>this.updateToolbar())),this.updateToolbar()}updateToolbar(){const e=[],t=[];$T(this.menu,this.options2?.menuOptions,{primary:e,secondary:t},this.options2?.toolbarOptions?.primaryGroup,this.options2?.toolbarOptions?.shouldInlineSubmenu,this.options2?.toolbarOptions?.useSeparatorsInPrimaryActions),t.push(...this.additionalActions),e.unshift(...this.prependedPrimaryActions),this.setActions(e,t)}setAdditionalSecondaryActions(e){ei(this.additionalActions,e,(t,i)=>t===i)||(this.additionalActions=e,this.updateToolbar())}};CF=zW([gl(4,zo),gl(5,Ee),gl(6,co),gl(7,vt),gl(8,Ft),gl(9,Fn)],CF);var GZ=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},d0=function(o,e){return function(t,i){e(t,i,o)}},Tv,yF;function*iTe(o,e,t=1){e===void 0&&([e,o]=[o,0]);for(let i=o;i<e;i+=t)yield i}function MN(o){const e=o[0].match(/^\s*/)?.[0]??"",t=e.length;return{text:o.map(i=>i.replace(new RegExp("^"+e),"")),shift:t}}var tf;let wF=(tf=class extends F{static _createUniqueUri(){return ye.from({scheme:"inline-edit-widget",path:new Date().toString()+String(Tv._modelId++)})}constructor(e,t,i,n,s){super(),this._editor=e,this._model=t,this._instantiationService=i,this._diffProviderFactoryService=n,this._modelService=s,this._position=me(this,r=>{const a=this._model.read(r);if(!a||a.text.length===0||a.range.startLineNumber===a.range.endLineNumber&&!(a.range.startColumn===a.range.endColumn&&a.range.startColumn===1))return null;const l=this._editor.getModel();if(!l)return null;const c=Array.from(iTe(a.range.startLineNumber,a.range.endLineNumber+1)),d=c.map(m=>l.getLineLastNonWhitespaceColumn(m)),h=Math.max(...d),u=c[d.indexOf(h)],g=new A(u,h);return{top:a.range.startLineNumber,left:g}}),this._text=me(this,r=>{const a=this._model.read(r);if(!a)return{text:"",shift:0};const l=MN(a.text.split(`
`));return{text:l.text.join(`
`),shift:l.shift}}),this._originalModel=Kn(()=>this._modelService.createModel("",null,Tv._createUniqueUri())).keepObserved(this._store),this._modifiedModel=Kn(()=>this._modelService.createModel("",null,Tv._createUniqueUri())).keepObserved(this._store),this._diff=me(this,r=>this._diffPromise.read(r)?.promiseResult.read(r)?.data),this._diffPromise=me(this,r=>{const a=this._model.read(r);if(!a)return;const l=this._editor.getModel();if(!l)return;const c=MN(l.getValueInRange(a.range).split(`
`)).text.join(`
`),d=MN(a.text.split(`
`)).text.join(`
`);this._originalModel.get().setValue(c),this._modifiedModel.get().setValue(d);const h=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:"advanced"});return zT.fromFn(async()=>{const u=await h.computeDiff(this._originalModel.get(),this._modifiedModel.get(),{computeMoves:!1,ignoreTrimWhitespace:!1,maxComputationTimeMs:1e3},He.None);if(!u.identical)return u.changes})}),this._register(Is((r,a)=>{if(!this._model.read(r)||this._position.get()===null)return;const c=a.add(this._instantiationService.createInstance(SF,this._editor,this._position,this._text.map(d=>d.text),this._text.map(d=>d.shift),this._diff));e.addOverlayWidget(c),a.add(ve(()=>e.removeOverlayWidget(c)))}))}},Tv=tf,tf._modelId=0,tf);wF=Tv=GZ([d0(2,Ce),d0(3,jw),d0(4,Ut)],wF);var nf;let SF=(nf=class extends F{constructor(e,t,i,n,s,r){super(),this._editor=e,this._position=t,this._text=i,this._shift=n,this._diff=s,this._instantiationService=r,this.id=`InlineEditSideBySideContentWidget${yF.id++}`,this.allowEditorOverflow=!1,this._nodes=ie("div.inlineEditSideBySide",void 0),this._scrollChanged=Sn("editor.onDidScrollChange",this._editor.onDidScrollChange),this._previewEditor=this._register(this._instantiationService.createInstance(jr,this._nodes,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0,scrollbar:{vertical:"hidden",horizontal:"hidden",alwaysConsumeMouseWheel:!1,handleMouseWheel:!1},readOnly:!0,wordWrap:"off",wordWrapOverride1:"off",wordWrapOverride2:"off",wrappingIndent:"none",wrappingStrategy:void 0},{contributions:[],isSimpleWidget:!0},this._editor)),this._previewEditorObs=Qs(this._previewEditor),this._editorObs=Qs(this._editor),this._previewTextModel=this._register(this._instantiationService.createInstance(Ca,"",this._editor.getModel()?.getLanguageId()??hs,Ca.DEFAULT_CREATION_OPTIONS,null)),this._setText=me(a=>{const l=this._text.read(a);l&&this._previewTextModel.setValue(l)}).recomputeInitiallyAndOnChange(this._store),this._decorations=me(this,a=>{this._setText.read(a);const l=this._position.read(a);if(!l)return{org:[],mod:[]};const c=this._diff.read(a);if(!c)return{org:[],mod:[]};const d=[],h=[];if(c.length===1&&c[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange()))return{org:[],mod:[]};const u=this._shift.get(),g=f=>new L(f.startLineNumber+l.top-1,f.startColumn+u,f.endLineNumber+l.top-1,f.endColumn+u);for(const f of c)if(f.original.isEmpty||d.push({range:g(f.original.toInclusiveRange()),options:Wy}),f.modified.isEmpty||h.push({range:f.modified.toInclusiveRange(),options:lL}),f.modified.isEmpty||f.original.isEmpty)f.original.isEmpty||d.push({range:g(f.original.toInclusiveRange()),options:qB}),f.modified.isEmpty||h.push({range:f.modified.toInclusiveRange(),options:KB});else for(const m of f.innerChanges||[])f.original.contains(m.originalRange.startLineNumber)&&d.push({range:g(m.originalRange),options:m.originalRange.isEmpty()?ZB:F_}),f.modified.contains(m.modifiedRange.startLineNumber)&&h.push({range:m.modifiedRange,options:m.modifiedRange.isEmpty()?jB:cL});return{org:d,mod:h}}),this._originalDecorations=me(this,a=>this._decorations.read(a).org),this._modifiedDecorations=me(this,a=>this._decorations.read(a).mod),this._previewEditor.setModel(this._previewTextModel),this._register(this._editorObs.setDecorations(this._originalDecorations)),this._register(this._previewEditorObs.setDecorations(this._modifiedDecorations)),this._register(Re(a=>{const l=this._previewEditorObs.contentWidth.read(a),c=this._text.read(a).split(`
`).length-1,d=this._editor.getOption(67)*c;l<=0||this._previewEditor.layout({height:d,width:l})})),this._register(Re(a=>{this._position.read(a),this._editor.layoutOverlayWidget(this)})),this._register(Re(a=>{this._scrollChanged.read(a),this._position.read(a)&&this._editor.layoutOverlayWidget(this)}))}getId(){return this.id}getDomNode(){return this._nodes}getPosition(){const e=this._position.get();if(!e)return null;const t=this._editor.getLayoutInfo(),i=this._editor.getScrolledVisiblePosition(new A(e.top,1));if(!i)return null;const n=i.top-1,s=this._editor.getOffsetForColumn(e.left.lineNumber,e.left.column);return{preference:{left:t.contentLeft+s+10,top:n}}}},yF=nf,nf.id=0,nf);SF=yF=GZ([d0(5,Ce)],SF);var nTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},vu=function(o,e){return function(t,i){e(t,i,o)}},Dv,er;let ls=(er=class extends F{static get(e){return e.getContribution(Dv.ID)}constructor(e,t,i,n,s,r,a,l){super(),this.editor=e,this.instantiationService=t,this.contextKeyService=i,this.languageFeaturesService=n,this._commandService=s,this._configurationService=r,this._diffProviderFactoryService=a,this._modelService=l,this._isVisibleContext=Dv.inlineEditVisibleContext.bindTo(this.contextKeyService),this._isCursorAtInlineEditContext=Dv.cursorAtInlineEditContext.bindTo(this.contextKeyService),this._currentEdit=$e(this,void 0),this._currentWidget=Kn(this._currentEdit,f=>{const m=this._currentEdit.read(f);if(!m)return;const _=m.range.endLineNumber,b=m.range.endColumn,v=m.text.endsWith(`
`)&&!(m.range.startLineNumber===m.range.endLineNumber&&m.range.startColumn===m.range.endColumn)?m.text.slice(0,-1):m.text,y=new iw(_,[new FL(b,v,!1)]),C=m.range.startLineNumber===m.range.endLineNumber&&y.parts.length===1&&y.parts[0].lines.length===1,w=m.text==="";return!C&&!w?void 0:this.instantiationService.createInstance(_F,this.editor,{ghostText:rr(y),minReservedLineCount:rr(0),targetTextModel:rr(this.editor.getModel()??void 0),range:rr(m.range)})}),this._isAccepting=$e(this,!1),this._enabled=yt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).enabled),this._fontFamily=yt(this,this.editor.onDidChangeConfiguration,()=>this.editor.getOption(63).fontFamily);const c=Sn("InlineEditController.modelContentChangedSignal",e.onDidChangeModelContent);this._register(Re(f=>{this._enabled.read(f)&&(c.read(f),!this._isAccepting.read(f)&&this.getInlineEdit(e,!0))}));const d=yt(this,e.onDidChangeCursorPosition,()=>e.getPosition());this._register(Re(f=>{if(!this._enabled.read(f))return;const m=d.read(f);m&&this.checkCursorPosition(m)})),this._register(Re(f=>{const m=this._currentEdit.read(f);if(this._isCursorAtInlineEditContext.set(!1),!m){this._isVisibleContext.set(!1);return}this._isVisibleContext.set(!0);const _=e.getPosition();_&&this.checkCursorPosition(_)}));const h=Sn("InlineEditController.editorBlurSignal",e.onDidBlurEditorWidget);this._register(Re(async f=>{this._enabled.read(f)&&(h.read(f),!(this._configurationService.getValue("editor.experimentalInlineEdit.keepOnBlur")||e.getOption(63).keepOnBlur)&&(this._currentRequestCts?.dispose(!0),this._currentRequestCts=void 0,await this.clear(!1)))}));const u=Sn("InlineEditController.editorFocusSignal",e.onDidFocusEditorText);this._register(Re(f=>{this._enabled.read(f)&&(u.read(f),this.getInlineEdit(e,!0))}));const g=this._register(Qz());this._register(Re(f=>{const m=this._fontFamily.read(f);g.setStyle(m===""||m==="default"?"":`
.monaco-editor .inline-edit-decoration,
.monaco-editor .inline-edit-decoration-preview,
.monaco-editor .inline-edit {
	font-family: ${m};
}`)})),this._register(new bF(this.editor,this._currentWidget,this.instantiationService)),this._register(new wF(this.editor,this._currentEdit,this.instantiationService,this._diffProviderFactoryService,this._modelService))}checkCursorPosition(e){if(!this._currentEdit){this._isCursorAtInlineEditContext.set(!1);return}const t=this._currentEdit.get();if(!t){this._isCursorAtInlineEditContext.set(!1);return}this._isCursorAtInlineEditContext.set(L.containsPosition(t.range,e))}validateInlineEdit(e,t){if(t.text.includes(`
`)&&t.range.startLineNumber!==t.range.endLineNumber&&t.range.startColumn!==t.range.endColumn){if(t.range.startColumn!==1)return!1;const n=t.range.endLineNumber,s=t.range.endColumn,r=e.getModel()?.getLineLength(n)??0;if(s!==r+1)return!1}return!0}async fetchInlineEdit(e,t){this._currentRequestCts&&this._currentRequestCts.dispose(!0);const i=e.getModel();if(!i)return;const n=i.getVersionId(),s=this.languageFeaturesService.inlineEditProvider.all(i);if(s.length===0)return;const r=s[0];this._currentRequestCts=new ri;const a=this._currentRequestCts.token,l=t?k0.Automatic:k0.Invoke;if(t&&await sTe(50,a),a.isCancellationRequested||i.isDisposed()||i.getVersionId()!==n)return;const d=await r.provideInlineEdit(i,{triggerKind:l},a);if(d&&!(a.isCancellationRequested||i.isDisposed()||i.getVersionId()!==n)&&this.validateInlineEdit(e,d))return d}async getInlineEdit(e,t){this._isCursorAtInlineEditContext.set(!1),await this.clear();const i=await this.fetchInlineEdit(e,t);i&&this._currentEdit.set(i,void 0)}async trigger(){await this.getInlineEdit(this.editor,!1)}async jumpBack(){this._jumpBackPosition&&(this.editor.setPosition(this._jumpBackPosition),this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition))}async accept(){this._isAccepting.set(!0,void 0);const e=this._currentEdit.get();if(!e)return;let t=e.text;e.text.startsWith(`
`)&&(t=e.text.substring(1)),this.editor.pushUndoStop(),this.editor.executeEdits("acceptCurrent",[si.replace(L.lift(e.range),t)]),e.accepted&&await this._commandService.executeCommand(e.accepted.id,...e.accepted.arguments||[]).then(void 0,yi),this.freeEdit(e),oi(i=>{this._currentEdit.set(void 0,i),this._isAccepting.set(!1,i)})}jumpToCurrent(){this._jumpBackPosition=this.editor.getSelection()?.getStartPosition();const e=this._currentEdit.get();if(!e)return;const t=A.lift({lineNumber:e.range.startLineNumber,column:e.range.startColumn});this.editor.setPosition(t),this.editor.revealPositionInCenterIfOutsideViewport(t)}async clear(e=!0){const t=this._currentEdit.get();t&&t?.rejected&&e&&await this._commandService.executeCommand(t.rejected.id,...t.rejected.arguments||[]).then(void 0,yi),t&&this.freeEdit(t),this._currentEdit.set(void 0,void 0)}freeEdit(e){const t=this.editor.getModel();if(!t)return;const i=this.languageFeaturesService.inlineEditProvider.all(t);i.length!==0&&i[0].freeInlineEdit(e)}},Dv=er,er.ID="editor.contrib.inlineEditController",er.inlineEditVisibleKey="inlineEditVisible",er.inlineEditVisibleContext=new re(er.inlineEditVisibleKey,!1),er.cursorAtInlineEditKey="cursorAtInlineEdit",er.cursorAtInlineEditContext=new re(er.cursorAtInlineEditKey,!1),er);ls=Dv=nTe([vu(1,Ce),vu(2,Ee),vu(3,ue),vu(4,Ft),vu(5,Ke),vu(6,jw),vu(7,Ut)],ls);function sTe(o,e){return new Promise(t=>{let i;const n=setTimeout(()=>{i&&i.dispose(),t()},o);e&&(i=e.onCancellationRequested(()=>{clearTimeout(n),i&&i.dispose(),t()}))})}let oTe=class extends de{constructor(){super({id:ZEe,label:"Accept Inline Edit",alias:"Accept Inline Edit",precondition:K.and(T.writable,ls.inlineEditVisibleContext),kbOpts:[{weight:101,primary:2,kbExpr:K.and(T.writable,ls.inlineEditVisibleContext,ls.cursorAtInlineEditContext)}],menuOpts:[{menuId:fe.InlineEditToolbar,title:"Accept",group:"primary",order:1}]})}async run(e,t){await ls.get(t)?.accept()}};class rTe extends de{constructor(){const e=K.and(T.writable,K.not(ls.inlineEditVisibleKey));super({id:"editor.action.inlineEdit.trigger",label:"Trigger Inline Edit",alias:"Trigger Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e}})}async run(e,t){ls.get(t)?.trigger()}}class aTe extends de{constructor(){const e=K.and(T.writable,ls.inlineEditVisibleContext,K.not(ls.cursorAtInlineEditKey));super({id:XEe,label:"Jump to Inline Edit",alias:"Jump to Inline Edit",precondition:e,kbOpts:{weight:101,primary:2646,kbExpr:e},menuOpts:[{menuId:fe.InlineEditToolbar,title:"Jump To Edit",group:"primary",order:3,when:e}]})}async run(e,t){ls.get(t)?.jumpToCurrent()}}class lTe extends de{constructor(){const e=K.and(T.writable,ls.cursorAtInlineEditContext);super({id:QEe,label:"Jump Back from Inline Edit",alias:"Jump Back from Inline Edit",precondition:e,kbOpts:{weight:110,primary:2646,kbExpr:e},menuOpts:[{menuId:fe.InlineEditToolbar,title:"Jump Back",group:"primary",order:3,when:e}]})}async run(e,t){ls.get(t)?.jumpBack()}}class cTe extends de{constructor(){const e=K.and(T.writable,ls.inlineEditVisibleContext);super({id:YEe,label:"Reject Inline Edit",alias:"Reject Inline Edit",precondition:e,kbOpts:{weight:100,primary:9,kbExpr:e},menuOpts:[{menuId:fe.InlineEditToolbar,title:"Reject",group:"secondary",order:2}]})}async run(e,t){await ls.get(t)?.clear()}}X(oTe);X(cTe);X(aTe);X(lTe);X(rTe);at(ls.ID,ls,3);const dTe="editor.action.inlineEdits.accept",hTe="editor.action.inlineEdits.showPrevious",uTe="editor.action.inlineEdits.showNext",Q_=new re("inlineEditsVisible",!1,p("inlineEditsVisible","Whether an inline edit is visible")),gTe=new re("inlineEditsIsPinned",!1,p("isPinned","Whether an inline edit is visible")),c3=class c3 extends F{constructor(e){super(),this._editor=e,this._editorObs=Qs(this._editor),this._placeholderText=this._editorObs.getOption(88),this._state=Eo({owner:this,equalsFn:cx},t=>{const i=this._placeholderText.read(t);if(i&&this._editorObs.valueIsEmpty.read(t))return{placeholder:i}}),this._shouldViewBeAlive=fTe(this,t=>this._state.read(t)?.placeholder!==void 0),this._view=Xh((t,i)=>{if(!this._shouldViewBeAlive.read(t))return;const n=Ye("div.editorPlaceholder");i.add(Re(s=>{const r=this._state.read(s),a=r?.placeholder!==void 0;n.root.style.display=a?"block":"none",n.root.innerText=r?.placeholder??""})),i.add(Re(s=>{const r=this._editorObs.layoutInfo.read(s);n.root.style.left=`${r.contentLeft}px`,n.root.style.width=r.contentWidth-r.verticalScrollbarWidth+"px",n.root.style.top=`${this._editor.getTopForLineNumber(0)}px`})),i.add(Re(s=>{n.root.style.fontFamily=this._editorObs.getOption(49).read(s),n.root.style.fontSize=this._editorObs.getOption(52).read(s)+"px",n.root.style.lineHeight=this._editorObs.getOption(67).read(s)+"px"})),i.add(this._editorObs.createOverlayWidget({allowEditorOverflow:!1,minContentWidthInPx:rr(0),position:rr(null),domNode:n.root}))}),this._view.recomputeInitiallyAndOnChange(this._store)}};c3.ID="editor.contrib.placeholderText";let cw=c3;function fTe(o,e){return Bw(o,(t,i)=>i===!0?!0:e(t))}var pTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},mTe=function(o,e){return function(t,i){e(t,i,o)}};class _Te{constructor(e,t,i){this.range=e,this.newLines=t,this.changes=i}}let xF=class extends F{constructor(e,t,i,n){super(),this._editor=e,this._edit=t,this._userPrompt=i,this._instantiationService=n,this._editorObs=Qs(this._editor),this._elements=Ye("div.inline-edits-widget",{style:{position:"absolute",overflow:"visible",top:"0px",left:"0px"}},[Ye("div@editorContainer",{style:{position:"absolute",top:"0px",left:"0px",width:"500px",height:"500px"}},[Ye("div.toolbar@toolbar",{style:{position:"absolute",top:"-25px",left:"0px"}}),Ye("div.promptEditor@promptEditor",{style:{position:"absolute",top:"-25px",left:"80px",width:"300px",height:"22px"}}),Ye("div.preview@editor",{style:{position:"absolute",top:"0px",left:"0px"}})]),gp("svg",{style:{overflow:"visible",pointerEvents:"none"}},[gp("defs",[gp("linearGradient",{id:"Gradient2",x1:"0",y1:"0",x2:"1",y2:"0"},[gp("stop",{offset:"0%",class:"gradient-stop"}),gp("stop",{offset:"100%",class:"gradient-stop"})])]),gp("path@path",{d:"",fill:"url(#Gradient2)"})])]),this._previewTextModel=this._register(this._instantiationService.createInstance(Ca,"",hs,Ca.DEFAULT_CREATION_OPTIONS,null)),this._setText=me(r=>{const a=this._edit.read(r);a&&this._previewTextModel.setValue(a.newLines.join(`
`))}).recomputeInitiallyAndOnChange(this._store),this._promptTextModel=this._register(this._instantiationService.createInstance(Ca,"",hs,Ca.DEFAULT_CREATION_OPTIONS,null)),this._promptEditor=this._register(this._instantiationService.createInstance(jr,this._elements.promptEditor,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0,placeholder:"Describe the change you want...",fontFamily:JK},{contributions:lg.getSomeEditorContributions([Fr.ID,cw.ID,G_.ID]),isSimpleWidget:!0},this._editor)),this._previewEditor=this._register(this._instantiationService.createInstance(jr,this._elements.editor,{glyphMargin:!1,lineNumbers:"off",minimap:{enabled:!1},guides:{indentation:!1,bracketPairs:!1,bracketPairsHorizontal:!1,highlightActiveIndentation:!1},folding:!1,selectOnLineNumbers:!1,selectionHighlight:!1,columnSelection:!1,overviewRulerBorder:!1,overviewRulerLanes:0,lineDecorationsWidth:0,lineNumbersMinChars:0},{contributions:[]},this._editor)),this._previewEditorObs=Qs(this._previewEditor),this._decorations=me(this,r=>{this._setText.read(r);const a=this._edit.read(r)?.changes;if(!a)return[];const l=[],c=[];if(a.length===1&&a[0].innerChanges[0].modifiedRange.equalsRange(this._previewTextModel.getFullModelRange()))return[];for(const d of a)if(d.original.isEmpty||l.push({range:d.original.toInclusiveRange(),options:Wy}),d.modified.isEmpty||c.push({range:d.modified.toInclusiveRange(),options:lL}),d.modified.isEmpty||d.original.isEmpty)d.original.isEmpty||l.push({range:d.original.toInclusiveRange(),options:qB}),d.modified.isEmpty||c.push({range:d.modified.toInclusiveRange(),options:KB});else for(const h of d.innerChanges||[])d.original.contains(h.originalRange.startLineNumber)&&l.push({range:h.originalRange,options:h.originalRange.isEmpty()?ZB:F_}),d.modified.contains(h.modifiedRange.startLineNumber)&&c.push({range:h.modifiedRange,options:h.modifiedRange.isEmpty()?jB:cL});return c}),this._layout1=me(this,r=>{const a=this._editor.getModel(),l=this._edit.read(r);if(!l)return null;const c=l.range;let d=0;for(let g=c.startLineNumber;g<c.endLineNumberExclusive;g++){const f=a.getLineMaxColumn(g),m=this._editor.getOffsetForColumn(g,f);d=Math.max(d,m)}return{left:this._editor.getLayoutInfo().contentLeft+d}}),this._layout=me(this,r=>{const a=this._edit.read(r);if(!a)return null;const l=a.range,c=this._editorObs.scrollLeft.read(r),d=this._layout1.read(r).left+20-c,h=this._editor.getTopForLineNumber(l.startLineNumber)-this._editorObs.scrollTop.read(r),u=this._editor.getTopForLineNumber(l.endLineNumberExclusive)-this._editorObs.scrollTop.read(r),g=new hm(d,h),f=new hm(d,u),m=u-h,_=50,b=this._editor.getOption(67)*a.newLines.length,v=m-b,y=new hm(d+_,h+v/2),C=new hm(d+_,u-v/2);return{topCode:g,bottomCode:f,codeHeight:m,topEdit:y,bottomEdit:C,editHeight:b}});const s=me(this,r=>this._edit.read(r)!==void 0||this._userPrompt.read(r)!==void 0);this._register(Yc(this._elements.root,{display:me(this,r=>s.read(r)?"block":"none")})),this._register(sm(this._editor.getDomNode(),this._elements.root)),this._register(Qs(e).createOverlayWidget({domNode:this._elements.root,position:rr(null),allowEditorOverflow:!1,minContentWidthInPx:me(r=>{const a=this._layout1.read(r)?.left;if(a===void 0)return 0;const l=this._previewEditorObs.contentWidth.read(r);return a+l})})),this._previewEditor.setModel(this._previewTextModel),this._register(this._previewEditorObs.setDecorations(this._decorations)),this._register(Re(r=>{const a=this._layout.read(r);if(!a)return;const{topCode:l,bottomCode:c,topEdit:d,bottomEdit:h,editHeight:u}=a,g=10,f=0,m=40,_=new vTe().moveTo(l).lineTo(l.deltaX(g)).curveTo(l.deltaX(g+m),d.deltaX(-m-f),d.deltaX(-f)).lineTo(d).lineTo(h).lineTo(h.deltaX(-f)).curveTo(h.deltaX(-m-f),c.deltaX(g+m),c.deltaX(g)).lineTo(c).build();this._elements.path.setAttribute("d",_),this._elements.editorContainer.style.top=`${d.y}px`,this._elements.editorContainer.style.left=`${d.x}px`,this._elements.editorContainer.style.height=`${u}px`;const b=this._previewEditorObs.contentWidth.read(r);this._previewEditor.layout({height:u,width:b})})),this._promptEditor.setModel(this._promptTextModel),this._promptEditor.layout(),this._register(CTe(bTe(this._userPrompt,r=>r??"",r=>r),Qs(this._promptEditor).value)),this._register(Re(r=>{const a=Qs(this._promptEditor).isFocused.read(r);this._elements.root.classList.toggle("focused",a)}))}};xF=pTe([mTe(3,Ce)],xF);function bTe(o,e,t){return Mw(void 0,i=>e(o.read(i)),(i,n)=>o.set(t(i),n))}class hm{constructor(e,t){this.x=e,this.y=t}deltaX(e){return new hm(this.x+e,this.y)}}class vTe{constructor(){this._data=""}moveTo(e){return this._data+=`M ${e.x} ${e.y} `,this}lineTo(e){return this._data+=`L ${e.x} ${e.y} `,this}curveTo(e,t,i){return this._data+=`C ${e.x} ${e.y} ${t.x} ${t.y} ${i.x} ${i.y} `,this}build(){return this._data}}function CTe(o,e){const t=new $;return t.add(Re(i=>{const n=o.read(i);e.set(n,void 0)})),t.add(Re(i=>{const n=e.read(i);o.set(n,void 0)})),t}var yTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},ON=function(o,e){return function(t,i){e(t,i,o)}},Iv,sf;let LF=(sf=class extends F{static _createUniqueUri(){return ye.from({scheme:"inline-edits",path:new Date().toString()+String(Iv._modelId++)})}constructor(e,t,i,n,s,r,a){super(),this.textModel=e,this._textModelVersionId=t,this._selection=i,this._debounceValue=n,this.languageFeaturesService=s,this._diffProviderFactoryService=r,this._modelService=a,this._forceUpdateExplicitlySignal=gb(this),this._selectedInlineCompletionId=$e(this,void 0),this._isActive=$e(this,!1),this._originalModel=Kn(()=>this._modelService.createModel("",null,Iv._createUniqueUri())).keepObserved(this._store),this._modifiedModel=Kn(()=>this._modelService.createModel("",null,Iv._createUniqueUri())).keepObserved(this._store),this._pinnedRange=new STe(this.textModel,this._textModelVersionId),this.isPinned=this._pinnedRange.range.map(l=>!!l),this.userPrompt=$e(this,void 0),this.inlineEdit=me(this,l=>this._inlineEdit.read(l)?.promiseResult.read(l)?.data),this._inlineEdit=me(this,l=>{const c=this.selectedInlineEdit.read(l);if(!c)return;const d=c.inlineCompletion.range;if(c.inlineCompletion.insertText.trim()==="")return;let h=c.inlineCompletion.insertText.split(/\r\n|\r|\n/);function u(_){const b=_[0].match(/^\s*/)?.[0]??"";return _.map(v=>v.replace(new RegExp("^"+b),""))}h=u(h);let f=this.textModel.getValueInRange(d).split(/\r\n|\r|\n/);f=u(f),this._originalModel.get().setValue(f.join(`
`)),this._modifiedModel.get().setValue(h.join(`
`));const m=this._diffProviderFactoryService.createDiffProvider({diffAlgorithm:"advanced"});return zT.fromFn(async()=>{const _=await m.computeDiff(this._originalModel.get(),this._modifiedModel.get(),{computeMoves:!1,ignoreTrimWhitespace:!1,maxComputationTimeMs:1e3},He.None);if(!_.identical)return new _Te(Be.fromRangeInclusive(d),u(h),_.changes)})}),this._fetchStore=this._register(new $),this._inlineEditsFetchResult=my(this,void 0),this._inlineEdits=Eo({owner:this,equalsFn:cx},l=>this._inlineEditsFetchResult.read(l)?.completions.map(c=>new wTe(c))??[]),this._fetchInlineEditsPromise=qG({owner:this,createEmptyChangeSummary:()=>({inlineCompletionTriggerKind:wa.Automatic}),handleChange:(l,c)=>(l.didChange(this._forceUpdateExplicitlySignal)&&(c.inlineCompletionTriggerKind=wa.Explicit),!0)},async(l,c)=>{this._fetchStore.clear(),this._forceUpdateExplicitlySignal.read(l),this._textModelVersionId.read(l);function d(m,_){return _(m)}const h=this._pinnedRange.range.read(l)??d(this._selection.read(l),m=>m.isEmpty()?void 0:m);if(!h){this._inlineEditsFetchResult.set(void 0,void 0),this.userPrompt.set(void 0,void 0);return}const u={triggerKind:c.inlineCompletionTriggerKind,selectedSuggestionInfo:void 0,userPrompt:this.userPrompt.read(l)},g=QN(this._fetchStore);await Kc(200,g);const f=await kZ(this.languageFeaturesService.inlineCompletionsProvider,h,this.textModel,u,g);g.isCancellationRequested||this._inlineEditsFetchResult.set(f,void 0)}),this._filteredInlineEditItems=Eo({owner:this,equalsFn:lx()},l=>this._inlineEdits.read(l)),this.selectedInlineCompletionIndex=me(this,l=>{const c=this._selectedInlineCompletionId.read(l),d=this._filteredInlineEditItems.read(l),h=this._selectedInlineCompletionId===void 0?-1:d.findIndex(u=>u.semanticId===c);return h===-1?(this._selectedInlineCompletionId.set(void 0,void 0),0):h}),this.selectedInlineEdit=me(this,l=>{const c=this._filteredInlineEditItems.read(l),d=this.selectedInlineCompletionIndex.read(l);return c[d]}),this._register(fb(this._fetchInlineEditsPromise))}async triggerExplicitly(e){kf(e,t=>{this._isActive.set(!0,t),this._forceUpdateExplicitlySignal.trigger(t)}),await this._fetchInlineEditsPromise.get()}stop(e){kf(e,t=>{this.userPrompt.set(void 0,t),this._isActive.set(!1,t),this._inlineEditsFetchResult.set(void 0,t),this._pinnedRange.setRange(void 0,t)})}async _deltaSelectedInlineCompletionIndex(e){await this.triggerExplicitly();const t=this._filteredInlineEditItems.get()||[];if(t.length>0){const i=(this.selectedInlineCompletionIndex.get()+e+t.length)%t.length;this._selectedInlineCompletionId.set(t[i].semanticId,void 0)}else this._selectedInlineCompletionId.set(void 0,void 0)}async next(){await this._deltaSelectedInlineCompletionIndex(1)}async previous(){await this._deltaSelectedInlineCompletionIndex(-1)}async accept(e){if(e.getModel()!==this.textModel)throw new pt;const t=this.selectedInlineEdit.get();t&&(e.pushUndoStop(),e.executeEdits("inlineSuggestion.accept",[t.inlineCompletion.toSingleTextEdit().toSingleEditOperation()]),this.stop())}},Iv=sf,sf._modelId=0,sf);LF=Iv=yTe([ON(4,ue),ON(5,jw),ON(6,Ut)],LF);class wTe{constructor(e){this.inlineCompletion=e,this.semanticId=this.inlineCompletion.hash()}}class STe extends F{constructor(e,t){super(),this._textModel=e,this._versionId=t,this._decorations=$e(this,[]),this.range=me(this,i=>{this._versionId.read(i);const n=this._decorations.read(i)[0];return n?this._textModel.getDecorationRange(n)??null:null}),this._register(ve(()=>{this._textModel.deltaDecorations(this._decorations.get(),[])}))}setRange(e,t){this._decorations.set(this._textModel.deltaDecorations(this._decorations.get(),e?[{range:e,options:{description:"trackedRange"}}]:[]),t)}}var xTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},av=function(o,e){return function(t,i){e(t,i,o)}},kF,of;let ed=(of=class extends F{static get(e){return e.getContribution(kF.ID)}constructor(e,t,i,n,s,r){super(),this.editor=e,this._instantiationService=t,this._contextKeyService=i,this._debounceService=n,this._languageFeaturesService=s,this._configurationService=r,this._enabled=$be("editor.inlineEdits.enabled",!1,this._configurationService),this._editorObs=Qs(this.editor),this._selection=me(this,a=>this._editorObs.cursorSelection.read(a)??new pe(1,1,1,1)),this._debounceValue=this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider,"InlineEditsDebounce",{min:50,max:50}),this.model=Kn(this,a=>{if(!this._enabled.read(a)||this._editorObs.isReadonly.read(a))return;const l=this._editorObs.model.read(a);return l?this._instantiationService.createInstance(qs(LF,a),l,this._editorObs.versionId,this._selection,this._debounceValue):void 0}),this._hadInlineEdit=Bw(this,(a,l)=>l||this.model.read(a)?.inlineEdit.read(a)!==void 0),this._widget=Kn(this,a=>{if(this._hadInlineEdit.read(a))return this._instantiationService.createInstance(qs(xF,a),this.editor,this.model.map((l,c)=>l?.inlineEdit.read(c)),LTe(l=>this.model.read(l)?.userPrompt??$e("empty","")))}),this._register(sa(Q_,this._contextKeyService,a=>!!this.model.read(a)?.inlineEdit.read(a))),this._register(sa(gTe,this._contextKeyService,a=>!!this.model.read(a)?.isPinned.read(a))),this.model.recomputeInitiallyAndOnChange(this._store),this._widget.recomputeInitiallyAndOnChange(this._store)}},kF=of,of.ID="editor.contrib.inlineEditsController",of);ed=kF=xTe([av(1,Ce),av(2,Ee),av(3,Uo),av(4,ue),av(5,Ke)],ed);function LTe(o){return Mw(void 0,e=>o(e).read(e),(e,t)=>{o(void 0).set(e,t)})}function rS(o){return{label:o.value,alias:o.original}}const ME=class ME extends de{constructor(){super({id:ME.ID,...rS(De("action.inlineEdits.showNext","Show Next Inline Edit")),precondition:K.and(T.writable,Q_),kbOpts:{weight:100,primary:606}})}async run(e,t){ed.get(t)?.model.get()?.next()}};ME.ID=uTe;let EF=ME;const OE=class OE extends de{constructor(){super({id:OE.ID,...rS(De("action.inlineEdits.showPrevious","Show Previous Inline Edit")),precondition:K.and(T.writable,Q_),kbOpts:{weight:100,primary:604}})}async run(e,t){ed.get(t)?.model.get()?.previous()}};OE.ID=hTe;let TF=OE;class kTe extends de{constructor(){super({id:"editor.action.inlineEdits.trigger",...rS(De("action.inlineEdits.trigger","Trigger Inline Edit")),precondition:T.writable})}async run(e,t){const i=ed.get(t);await jG(async n=>{await i?.model.get()?.triggerExplicitly(n)})}}class ETe extends de{constructor(){super({id:dTe,...rS(De("action.inlineEdits.accept","Accept Inline Edit")),precondition:Q_,menuOpts:{menuId:fe.InlineEditsActions,title:p("inlineEditsActions","Accept Inline Edit"),group:"primary",order:1,icon:J.check},kbOpts:{primary:2058,weight:2e4,kbExpr:Q_}})}async run(e,t){t instanceof jr&&(t=t.getParentEditor());const i=ed.get(t);i&&(i.model.get()?.accept(i.editor),i.editor.focus())}}const FE=class FE extends de{constructor(){super({id:FE.ID,...rS(De("action.inlineEdits.hide","Hide Inline Edit")),precondition:Q_,kbOpts:{weight:100,primary:9}})}async run(e,t){const i=ed.get(t);oi(n=>{i?.model.get()?.stop(n)})}};FE.ID="editor.action.inlineEdits.hide";let DF=FE;at(ed.ID,ed,3);X(kTe);X(EF);X(TF);X(ETe);X(DF);const Hf={Visible:new re("parameterHintsVisible",!1),MultipleSignatures:new re("parameterHintsMultipleSignatures",!1)};async function $Z(o,e,t,i,n){const s=o.ordered(e);for(const r of s)try{const a=await r.provideSignatureHelp(e,t,n,i);if(a)return a}catch(a){yi(a)}}st.registerCommand("_executeSignatureHelpProvider",async(o,...e)=>{const[t,i,n]=e;ut(ye.isUri(t)),ut(A.isIPosition(i)),ut(typeof n=="string"||!n);const s=o.get(ue),r=await o.get(Ms).createModelReference(t);try{const a=await $Z(s.signatureHelpProvider,r.object.textEditorModel,A.lift(i),{triggerKind:xl.Invoke,isRetrigger:!1,triggerCharacter:n},He.None);return a?(setTimeout(()=>a.dispose(),0),a.value):void 0}finally{r.dispose()}});var Ld;(function(o){o.Default={type:0};class e{constructor(n,s){this.request=n,this.previouslyActiveHints=s,this.type=2}}o.Pending=e;class t{constructor(n){this.hints=n,this.type=1}}o.Active=t})(Ld||(Ld={}));const BE=class BE extends F{constructor(e,t,i=BE.DEFAULT_DELAY){super(),this._onChangedHints=this._register(new O),this.onChangedHints=this._onChangedHints.event,this.triggerOnType=!1,this._state=Ld.Default,this._pendingTriggers=[],this._lastSignatureHelpResult=this._register(new Yi),this.triggerChars=new V0,this.retriggerChars=new V0,this.triggerId=0,this.editor=e,this.providers=t,this.throttledDelayer=new hr(i),this._register(this.editor.onDidBlurEditorWidget(()=>this.cancel())),this._register(this.editor.onDidChangeConfiguration(()=>this.onEditorConfigurationChange())),this._register(this.editor.onDidChangeModel(n=>this.onModelChanged())),this._register(this.editor.onDidChangeModelLanguage(n=>this.onModelChanged())),this._register(this.editor.onDidChangeCursorSelection(n=>this.onCursorChange(n))),this._register(this.editor.onDidChangeModelContent(n=>this.onModelContentChange())),this._register(this.providers.onDidChange(this.onModelChanged,this)),this._register(this.editor.onDidType(n=>this.onDidType(n))),this.onEditorConfigurationChange(),this.onModelChanged()}get state(){return this._state}set state(e){this._state.type===2&&this._state.request.cancel(),this._state=e}cancel(e=!1){this.state=Ld.Default,this.throttledDelayer.cancel(),e||this._onChangedHints.fire(void 0)}trigger(e,t){const i=this.editor.getModel();if(!i||!this.providers.has(i))return;const n=++this.triggerId;this._pendingTriggers.push(e),this.throttledDelayer.trigger(()=>this.doTrigger(n),t).catch(Ae)}next(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t%e===e-1,n=this.editor.getOption(86).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?0:t+1)}previous(){if(this.state.type!==1)return;const e=this.state.hints.signatures.length,t=this.state.hints.activeSignature,i=t===0,n=this.editor.getOption(86).cycle;if((e<2||i)&&!n){this.cancel();return}this.updateActiveSignature(i&&n?e-1:t-1)}updateActiveSignature(e){this.state.type===1&&(this.state=new Ld.Active({...this.state.hints,activeSignature:e}),this._onChangedHints.fire(this.state.hints))}async doTrigger(e){const t=this.state.type===1||this.state.type===2,i=this.getLastActiveHints();if(this.cancel(!0),this._pendingTriggers.length===0)return!1;const n=this._pendingTriggers.reduce(TTe);this._pendingTriggers=[];const s={triggerKind:n.triggerKind,triggerCharacter:n.triggerCharacter,isRetrigger:t,activeSignatureHelp:i};if(!this.editor.hasModel())return!1;const r=this.editor.getModel(),a=this.editor.getPosition();this.state=new Ld.Pending(ji(l=>$Z(this.providers,r,a,s,l)),i);try{const l=await this.state.request;return e!==this.triggerId?(l?.dispose(),!1):!l||!l.value.signatures||l.value.signatures.length===0?(l?.dispose(),this._lastSignatureHelpResult.clear(),this.cancel(),!1):(this.state=new Ld.Active(l.value),this._lastSignatureHelpResult.value=l,this._onChangedHints.fire(this.state.hints),!0)}catch(l){return e===this.triggerId&&(this.state=Ld.Default),Ae(l),!1}}getLastActiveHints(){switch(this.state.type){case 1:return this.state.hints;case 2:return this.state.previouslyActiveHints;default:return}}get isTriggered(){return this.state.type===1||this.state.type===2||this.throttledDelayer.isTriggered()}onModelChanged(){this.cancel(),this.triggerChars.clear(),this.retriggerChars.clear();const e=this.editor.getModel();if(e)for(const t of this.providers.ordered(e)){for(const i of t.signatureHelpTriggerCharacters||[])if(i.length){const n=i.charCodeAt(0);this.triggerChars.add(n),this.retriggerChars.add(n)}for(const i of t.signatureHelpRetriggerCharacters||[])i.length&&this.retriggerChars.add(i.charCodeAt(0))}}onDidType(e){if(!this.triggerOnType)return;const t=e.length-1,i=e.charCodeAt(t);(this.triggerChars.has(i)||this.isTriggered&&this.retriggerChars.has(i))&&this.trigger({triggerKind:xl.TriggerCharacter,triggerCharacter:e.charAt(t)})}onCursorChange(e){e.source==="mouse"?this.cancel():this.isTriggered&&this.trigger({triggerKind:xl.ContentChange})}onModelContentChange(){this.isTriggered&&this.trigger({triggerKind:xl.ContentChange})}onEditorConfigurationChange(){this.triggerOnType=this.editor.getOption(86).enabled,this.triggerOnType||this.cancel()}dispose(){this.cancel(!0),super.dispose()}};BE.DEFAULT_DELAY=120;let IF=BE;function TTe(o,e){switch(e.triggerKind){case xl.Invoke:return e;case xl.ContentChange:return o;case xl.TriggerCharacter:default:return e}}var DTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},x1=function(o,e){return function(t,i){e(t,i,o)}},NF;const mo=ie,ITe=Gt("parameter-hints-next",J.chevronDown,p("parameterHintsNextIcon","Icon for show next parameter hint.")),NTe=Gt("parameter-hints-previous",J.chevronUp,p("parameterHintsPreviousIcon","Icon for show previous parameter hint."));var rf;let RF=(rf=class extends F{constructor(e,t,i,n,s,r){super(),this.editor=e,this.model=t,this.telemetryService=r,this.renderDisposeables=this._register(new $),this.visible=!1,this.announcedLabel=null,this.allowEditorOverflow=!0,this.markdownRenderer=this._register(new Zc({editor:e},s,n)),this.keyVisible=Hf.Visible.bindTo(i),this.keyMultipleSignatures=Hf.MultipleSignatures.bindTo(i)}createParameterHintDOMNodes(){const e=mo(".editor-widget.parameter-hints-widget"),t=Y(e,mo(".phwrapper"));t.tabIndex=-1;const i=Y(t,mo(".controls")),n=Y(i,mo(".button"+ke.asCSSSelector(NTe))),s=Y(i,mo(".overloads")),r=Y(i,mo(".button"+ke.asCSSSelector(ITe)));this._register(H(n,"click",u=>{tt.stop(u),this.previous()})),this._register(H(r,"click",u=>{tt.stop(u),this.next()}));const a=mo(".body"),l=new Iw(a,{alwaysConsumeMouseWheel:!0});this._register(l),t.appendChild(l.getDomNode());const c=Y(a,mo(".signature")),d=Y(a,mo(".docs"));e.style.userSelect="text",this.domNodes={element:e,signature:c,overloads:s,docs:d,scrollbar:l},this.editor.addContentWidget(this),this.hide(),this._register(this.editor.onDidChangeCursorSelection(u=>{this.visible&&this.editor.layoutContentWidget(this)}));const h=()=>{if(!this.domNodes)return;const u=this.editor.getOption(50),g=this.domNodes.element;g.style.fontSize=`${u.fontSize}px`,g.style.lineHeight=`${u.lineHeight/u.fontSize}`,g.style.setProperty("--vscode-parameterHintsWidget-editorFontFamily",u.fontFamily),g.style.setProperty("--vscode-parameterHintsWidget-editorFontFamilyDefault",ds.fontFamily)};h(),this._register(se.chain(this.editor.onDidChangeConfiguration.bind(this.editor),u=>u.filter(g=>g.hasChanged(50)))(h)),this._register(this.editor.onDidLayoutChange(u=>this.updateMaxHeight())),this.updateMaxHeight()}show(){this.visible||(this.domNodes||this.createParameterHintDOMNodes(),this.keyVisible.set(!0),this.visible=!0,setTimeout(()=>{this.domNodes?.element.classList.add("visible")},100),this.editor.layoutContentWidget(this))}hide(){this.renderDisposeables.clear(),this.visible&&(this.keyVisible.reset(),this.visible=!1,this.announcedLabel=null,this.domNodes?.element.classList.remove("visible"),this.editor.layoutContentWidget(this))}getPosition(){return this.visible?{position:this.editor.getPosition(),preference:[1,2]}:null}render(e){if(this.renderDisposeables.clear(),!this.domNodes)return;const t=e.signatures.length>1;this.domNodes.element.classList.toggle("multiple",t),this.keyMultipleSignatures.set(t),this.domNodes.signature.innerText="",this.domNodes.docs.innerText="";const i=e.signatures[e.activeSignature];if(!i)return;const n=Y(this.domNodes.signature,mo(".code")),s=i.parameters.length>0,r=i.activeParameter??e.activeParameter;if(s)this.renderParameters(n,i,r);else{const c=Y(n,mo("span"));c.textContent=i.label}const a=i.parameters[r];if(a?.documentation){const c=mo("span.documentation");if(typeof a.documentation=="string")c.textContent=a.documentation;else{const d=this.renderMarkdownDocs(a.documentation);c.appendChild(d.element)}Y(this.domNodes.docs,mo("p",{},c))}if(i.documentation!==void 0)if(typeof i.documentation=="string")Y(this.domNodes.docs,mo("p",{},i.documentation));else{const c=this.renderMarkdownDocs(i.documentation);Y(this.domNodes.docs,c.element)}const l=this.hasDocs(i,a);if(this.domNodes.signature.classList.toggle("has-docs",l),this.domNodes.docs.classList.toggle("empty",!l),this.domNodes.overloads.textContent=String(e.activeSignature+1).padStart(e.signatures.length.toString().length,"0")+"/"+e.signatures.length,a){let c="";const d=i.parameters[r];Array.isArray(d.label)?c=i.label.substring(d.label[0],d.label[1]):c=d.label,d.documentation&&(c+=typeof d.documentation=="string"?`, ${d.documentation}`:`, ${d.documentation.value}`),i.documentation&&(c+=typeof i.documentation=="string"?`, ${i.documentation}`:`, ${i.documentation.value}`),this.announcedLabel!==c&&(ps(p("hint","{0}, hint",c)),this.announcedLabel=c)}this.editor.layoutContentWidget(this),this.domNodes.scrollbar.scanDomNode()}renderMarkdownDocs(e){const t=new rn,i=this.renderDisposeables.add(this.markdownRenderer.render(e,{asyncRenderCallback:()=>{this.domNodes?.scrollbar.scanDomNode()}}));i.element.classList.add("markdown-docs");const n=t.elapsed();return n>300&&this.telemetryService.publicLog2("parameterHints.parseMarkdown",{renderDuration:n}),i}hasDocs(e,t){return!!(t&&typeof t.documentation=="string"&&Vd(t.documentation).length>0||t&&typeof t.documentation=="object"&&Vd(t.documentation).value.length>0||e.documentation&&typeof e.documentation=="string"&&Vd(e.documentation).length>0||e.documentation&&typeof e.documentation=="object"&&Vd(e.documentation.value).length>0)}renderParameters(e,t,i){const[n,s]=this.getParameterLabelOffsets(t,i),r=document.createElement("span");r.textContent=t.label.substring(0,n);const a=document.createElement("span");a.textContent=t.label.substring(n,s),a.className="parameter active";const l=document.createElement("span");l.textContent=t.label.substring(s),Y(e,r,a,l)}getParameterLabelOffsets(e,t){const i=e.parameters[t];if(i){if(Array.isArray(i.label))return i.label;if(i.label.length){const n=new RegExp(`(\\W|^)${Fo(i.label)}(?=\\W|$)`,"g");n.test(e.label);const s=n.lastIndex-i.label.length;return s>=0?[s,n.lastIndex]:[0,0]}else return[0,0]}else return[0,0]}next(){this.editor.focus(),this.model.next()}previous(){this.editor.focus(),this.model.previous()}getDomNode(){return this.domNodes||this.createParameterHintDOMNodes(),this.domNodes.element}getId(){return NF.ID}updateMaxHeight(){if(!this.domNodes)return;const t=`${Math.max(this.editor.getLayoutInfo().height/4,250)}px`;this.domNodes.element.style.maxHeight=t;const i=this.domNodes.element.getElementsByClassName("phwrapper");i.length&&(i[0].style.maxHeight=t)}},NF=rf,rf.ID="editor.widget.parameterHintsWidget",rf);RF=NF=DTe([x1(2,Ee),x1(3,Fs),x1(4,ti),x1(5,Fn)],RF);D("editorHoverWidget.highlightForeground",qp,p("editorHoverWidgetHighlightForeground","Foreground color of the active item in the parameter hint."));var RTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},w6=function(o,e){return function(t,i){e(t,i,o)}},PF,af;let J_=(af=class extends F{static get(e){return e.getContribution(PF.ID)}constructor(e,t,i){super(),this.editor=e,this.model=this._register(new IF(e,i.signatureHelpProvider)),this._register(this.model.onChangedHints(n=>{n?(this.widget.value.show(),this.widget.value.render(n)):this.widget.rawValue?.hide()})),this.widget=new Da(()=>this._register(t.createInstance(RF,this.editor,this.model)))}cancel(){this.model.cancel()}previous(){this.widget.rawValue?.previous()}next(){this.widget.rawValue?.next()}trigger(e){this.model.trigger(e,0)}},PF=af,af.ID="editor.controller.parameterHints",af);J_=PF=RTe([w6(1,Ce),w6(2,ue)],J_);class PTe extends de{constructor(){super({id:"editor.action.triggerParameterHints",label:p("parameterHints.trigger.label","Trigger Parameter Hints"),alias:"Trigger Parameter Hints",precondition:T.hasSignatureHelpProvider,kbOpts:{kbExpr:T.editorTextFocus,primary:3082,weight:100}})}run(e,t){J_.get(t)?.trigger({triggerKind:xl.Invoke})}}at(J_.ID,J_,2);X(PTe);const UW=175,GW=Hi.bindToContribution(J_.get);oe(new GW({id:"closeParameterHints",precondition:Hf.Visible,handler:o=>o.cancel(),kbOpts:{weight:UW,kbExpr:T.focus,primary:9,secondary:[1033]}}));oe(new GW({id:"showPrevParameterHint",precondition:K.and(Hf.Visible,Hf.MultipleSignatures),handler:o=>o.previous(),kbOpts:{weight:UW,kbExpr:T.focus,primary:16,secondary:[528],mac:{primary:16,secondary:[528,302]}}}));oe(new GW({id:"showNextParameterHint",precondition:K.and(Hf.Visible,Hf.MultipleSignatures),handler:o=>o.next(),kbOpts:{weight:UW,kbExpr:T.focus,primary:18,secondary:[530],mac:{primary:18,secondary:[530,300]}}}));var ATe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},MTe=function(o,e){return function(t,i){e(t,i,o)}};class OTe{constructor(e){this.instantiationService=e}init(...e){}}function FTe(o,e){return class extends e{constructor(){super(...arguments),this._autorun=void 0}init(...i){this._autorun=Is((n,s)=>{const r=qs(o(),n);s.add(this.instantiationService.createInstance(r,...i))})}dispose(){this._autorun?.dispose()}}}function BTe(o){return cD()?FTe(o,AF):o()}let AF=class extends OTe{constructor(e,t){super(t),this.init(e)}};AF=ATe([MTe(1,Ce)],AF);at(cw.ID,BTe(()=>cw),0);D("editor.placeholder.foreground",Rce,p("placeholderForeground","Foreground color of the placeholder text in the editor."));var WTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},L1=function(o,e){return function(t,i){e(t,i,o)}};const Eb=new re("renameInputVisible",!1,p("renameInputVisible","Whether the rename input widget is visible"));new re("renameInputFocused",!1,p("renameInputFocused","Whether the rename input widget is focused"));let MF=class{constructor(e,t,i,n,s,r){this._editor=e,this._acceptKeybindings=t,this._themeService=i,this._keybindingService=n,this._logService=r,this.allowEditorOverflow=!0,this._disposables=new $,this._visibleContextKey=Eb.bindTo(s),this._isEditingRenameCandidate=!1,this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,this._candidates=new Set,this._beforeFirstInputFieldEditSW=new rn,this._inputWithButton=new VTe,this._disposables.add(this._inputWithButton),this._editor.addContentWidget(this),this._disposables.add(this._editor.onDidChangeConfiguration(a=>{a.hasChanged(50)&&this._updateFont()})),this._disposables.add(i.onDidColorThemeChange(this._updateStyles,this))}dispose(){this._disposables.dispose(),this._editor.removeContentWidget(this)}getId(){return"__renameInputWidget"}getDomNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="monaco-editor rename-box",this._domNode.appendChild(this._inputWithButton.domNode),this._renameCandidateListView=this._disposables.add(new $W(this._domNode,{fontInfo:this._editor.getOption(50),onFocusChange:e=>{this._inputWithButton.input.value=e,this._isEditingRenameCandidate=!1},onSelectionChange:()=>{this._isEditingRenameCandidate=!1,this.acceptInput(!1)}})),this._disposables.add(this._inputWithButton.onDidInputChange(()=>{this._renameCandidateListView?.focusedCandidate!==void 0&&(this._isEditingRenameCandidate=!0),this._timeBeforeFirstInputFieldEdit??=this._beforeFirstInputFieldEditSW.elapsed(),this._renameCandidateProvidersCts?.token.isCancellationRequested===!1&&this._renameCandidateProvidersCts.cancel(),this._renameCandidateListView?.clearFocus()})),this._label=document.createElement("div"),this._label.className="rename-label",this._domNode.appendChild(this._label),this._updateFont(),this._updateStyles(this._themeService.getColorTheme())),this._domNode}_updateStyles(e){if(!this._domNode)return;const t=e.getColor(lb),i=e.getColor(aG);this._domNode.style.backgroundColor=String(e.getColor(Ro)??""),this._domNode.style.boxShadow=t?` 0 0 8px 2px ${t}`:"",this._domNode.style.border=i?`1px solid ${i}`:"",this._domNode.style.color=String(e.getColor(dG)??"");const n=e.getColor(hG);this._inputWithButton.domNode.style.backgroundColor=String(e.getColor(qP)??""),this._inputWithButton.input.style.backgroundColor=String(e.getColor(qP)??""),this._inputWithButton.domNode.style.borderWidth=n?"1px":"0px",this._inputWithButton.domNode.style.borderStyle=n?"solid":"none",this._inputWithButton.domNode.style.borderColor=n?.toString()??"none"}_updateFont(){if(this._domNode===void 0)return;ut(this._label!==void 0,"RenameWidget#_updateFont: _label must not be undefined given _domNode is defined"),this._editor.applyFontInfo(this._inputWithButton.input);const e=this._editor.getOption(50);this._label.style.fontSize=`${this._computeLabelFontSize(e.fontSize)}px`}_computeLabelFontSize(e){return e*.8}getPosition(){if(!this._visible||!this._editor.hasModel()||!this._editor.getDomNode())return null;const e=Ph(this.getDomNode().ownerDocument.body),t=Ci(this._editor.getDomNode()),i=this._getTopForPosition();this._nPxAvailableAbove=i+t.top,this._nPxAvailableBelow=e.height-this._nPxAvailableAbove;const n=this._editor.getOption(67),{totalHeight:s}=dw.getLayoutInfo({lineHeight:n}),r=this._nPxAvailableBelow>s*6?[2,1]:[1,2];return{position:this._position,preference:r}}beforeRender(){const[e,t]=this._acceptKeybindings;return this._label.innerText=p({key:"label",comment:['placeholders are keybindings, e.g "F2 to Rename, Shift+F2 to Preview"']},"{0} to Rename, {1} to Preview",this._keybindingService.lookupKeybinding(e)?.getLabel(),this._keybindingService.lookupKeybinding(t)?.getLabel()),this._domNode.style.minWidth="200px",null}afterRender(e){if(e===null){this.cancelInput(!0,"afterRender (because position is null)");return}if(!this._editor.hasModel()||!this._editor.getDomNode())return;ut(this._renameCandidateListView),ut(this._nPxAvailableAbove!==void 0),ut(this._nPxAvailableBelow!==void 0);const t=xc(this._inputWithButton.domNode),i=xc(this._label);let n;e===2?n=this._nPxAvailableBelow:n=this._nPxAvailableAbove,this._renameCandidateListView.layout({height:n-i-t,width:Ks(this._inputWithButton.domNode)})}acceptInput(e){this._trace("invoking acceptInput"),this._currentAcceptInput?.(e)}cancelInput(e,t){this._currentCancelInput?.(e)}focusNextRenameSuggestion(){this._renameCandidateListView?.focusNext()||(this._inputWithButton.input.value=this._currentName)}focusPreviousRenameSuggestion(){this._renameCandidateListView?.focusPrevious()||(this._inputWithButton.input.value=this._currentName)}getInput(e,t,i,n,s){const{start:r,end:a}=this._getSelection(e,t);this._renameCts=s;const l=new $;this._nRenameSuggestionsInvocations=0,this._hadAutomaticRenameSuggestionsInvocation=!1,n===void 0?this._inputWithButton.button.style.display="none":(this._inputWithButton.button.style.display="flex",this._requestRenameCandidatesOnce=n,this._requestRenameCandidates(t,!1),l.add(H(this._inputWithButton.button,"click",()=>this._requestRenameCandidates(t,!0))),l.add(H(this._inputWithButton.button,ee.KEY_DOWN,d=>{const h=new Pt(d);(h.equals(3)||h.equals(10))&&(h.stopPropagation(),h.preventDefault(),this._requestRenameCandidates(t,!0))}))),this._isEditingRenameCandidate=!1,this._domNode.classList.toggle("preview",i),this._position=new A(e.startLineNumber,e.startColumn),this._currentName=t,this._inputWithButton.input.value=t,this._inputWithButton.input.setAttribute("selectionStart",r.toString()),this._inputWithButton.input.setAttribute("selectionEnd",a.toString()),this._inputWithButton.input.size=Math.max((e.endColumn-e.startColumn)*1.1,20),this._beforeFirstInputFieldEditSW.reset(),l.add(ve(()=>{this._renameCts=void 0,s.dispose(!0)})),l.add(ve(()=>{this._renameCandidateProvidersCts!==void 0&&(this._renameCandidateProvidersCts.dispose(!0),this._renameCandidateProvidersCts=void 0)})),l.add(ve(()=>this._candidates.clear()));const c=new ib;return c.p.finally(()=>{l.dispose(),this._hide()}),this._currentCancelInput=d=>(this._trace("invoking _currentCancelInput"),this._currentAcceptInput=void 0,this._currentCancelInput=void 0,this._renameCandidateListView?.clearCandidates(),c.complete(d),!0),this._currentAcceptInput=d=>{this._trace("invoking _currentAcceptInput"),ut(this._renameCandidateListView!==void 0);const h=this._renameCandidateListView.nCandidates;let u,g;const f=this._renameCandidateListView.focusedCandidate;if(f!==void 0?(this._trace("using new name from renameSuggestion"),u=f,g={k:"renameSuggestion"}):(this._trace("using new name from inputField"),u=this._inputWithButton.input.value,g=this._isEditingRenameCandidate?{k:"userEditedRenameSuggestion"}:{k:"inputField"}),u===t||u.trim().length===0){this.cancelInput(!0,"_currentAcceptInput (because newName === value || newName.trim().length === 0)");return}this._currentAcceptInput=void 0,this._currentCancelInput=void 0,this._renameCandidateListView.clearCandidates(),c.complete({newName:u,wantsPreview:i&&d,stats:{source:g,nRenameSuggestions:h,timeBeforeFirstInputFieldEdit:this._timeBeforeFirstInputFieldEdit,nRenameSuggestionsInvocations:this._nRenameSuggestionsInvocations,hadAutomaticRenameSuggestionsInvocation:this._hadAutomaticRenameSuggestionsInvocation}})},l.add(s.token.onCancellationRequested(()=>this.cancelInput(!0,"cts.token.onCancellationRequested"))),l.add(this._editor.onDidBlurEditorWidget(()=>this.cancelInput(!this._domNode?.ownerDocument.hasFocus(),"editor.onDidBlurEditorWidget"))),this._show(),c.p}_requestRenameCandidates(e,t){if(this._requestRenameCandidatesOnce!==void 0&&(this._renameCandidateProvidersCts!==void 0&&this._renameCandidateProvidersCts.dispose(!0),ut(this._renameCts),this._inputWithButton.buttonState!=="stop")){this._renameCandidateProvidersCts=new ri;const i=t?KC.Invoke:KC.Automatic,n=this._requestRenameCandidatesOnce(i,this._renameCandidateProvidersCts.token);if(n.length===0){this._inputWithButton.setSparkleButton();return}t||(this._hadAutomaticRenameSuggestionsInvocation=!0),this._nRenameSuggestionsInvocations+=1,this._inputWithButton.setStopButton(),this._updateRenameCandidates(n,e,this._renameCts.token)}}_getSelection(e,t){ut(this._editor.hasModel());const i=this._editor.getSelection();let n=0,s=t.length;return!L.isEmpty(i)&&!L.spansMultipleLines(i)&&L.containsRange(e,i)&&(n=Math.max(0,i.startColumn-e.startColumn),s=Math.min(e.endColumn,i.endColumn)-e.startColumn),{start:n,end:s}}_show(){this._trace("invoking _show"),this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber,0),this._visible=!0,this._visibleContextKey.set(!0),this._editor.layoutContentWidget(this),setTimeout(()=>{this._inputWithButton.input.focus(),this._inputWithButton.input.setSelectionRange(parseInt(this._inputWithButton.input.getAttribute("selectionStart")),parseInt(this._inputWithButton.input.getAttribute("selectionEnd")))},100)}async _updateRenameCandidates(e,t,i){const n=(...c)=>this._trace("_updateRenameCandidates",...c);n("start");const s=await Lw(Promise.allSettled(e),i);if(this._inputWithButton.setSparkleButton(),s===void 0){n("returning early - received updateRenameCandidates results - undefined");return}const r=s.flatMap(c=>c.status==="fulfilled"&&Sl(c.value)?c.value:[]);n(`received updateRenameCandidates results - total (unfiltered) ${r.length} candidates.`);const a=Uc(r,c=>c.newSymbolName);n(`distinct candidates - ${a.length} candidates.`);const l=a.filter(({newSymbolName:c})=>c.trim().length>0&&c!==this._inputWithButton.input.value&&c!==t&&!this._candidates.has(c));if(n(`valid distinct candidates - ${r.length} candidates.`),l.forEach(c=>this._candidates.add(c.newSymbolName)),l.length<1){n("returning early - no valid distinct candidates");return}n("setting candidates"),this._renameCandidateListView.setCandidates(l),n("asking editor to re-layout"),this._editor.layoutContentWidget(this)}_hide(){this._trace("invoked _hide"),this._visible=!1,this._visibleContextKey.reset(),this._editor.layoutContentWidget(this)}_getTopForPosition(){const e=this._editor.getVisibleRanges();let t;return e.length>0?t=e[0].startLineNumber:(this._logService.warn("RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty"),t=Math.max(1,this._position.lineNumber-5)),this._editor.getTopForLineNumber(this._position.lineNumber)-this._editor.getTopForLineNumber(t)}_trace(...e){this._logService.trace("RenameWidget",...e)}};MF=WTe([L1(2,zi),L1(3,vt),L1(4,Ee),L1(5,Tn)],MF);class $W{constructor(e,t){this._disposables=new $,this._availableHeight=0,this._minimumWidth=0,this._lineHeight=t.fontInfo.lineHeight,this._typicalHalfwidthCharacterWidth=t.fontInfo.typicalHalfwidthCharacterWidth,this._listContainer=document.createElement("div"),this._listContainer.className="rename-box rename-candidate-list-container",e.appendChild(this._listContainer),this._listWidget=$W._createListWidget(this._listContainer,this._candidateViewHeight,t.fontInfo),this._listWidget.onDidChangeFocus(i=>{i.elements.length===1&&t.onFocusChange(i.elements[0].newSymbolName)},this._disposables),this._listWidget.onDidChangeSelection(i=>{i.elements.length===1&&t.onSelectionChange()},this._disposables),this._disposables.add(this._listWidget.onDidBlur(i=>{this._listWidget.setFocus([])})),this._listWidget.style(Zf({listInactiveFocusForeground:ly,listInactiveFocusBackground:cy}))}dispose(){this._listWidget.dispose(),this._disposables.dispose()}layout({height:e,width:t}){this._availableHeight=e,this._minimumWidth=t}setCandidates(e){this._listWidget.splice(0,0,e);const t=this._pickListHeight(this._listWidget.length),i=this._pickListWidth(e);this._listWidget.layout(t,i),this._listContainer.style.height=`${t}px`,this._listContainer.style.width=`${i}px`,Rl(p("renameSuggestionsReceivedAria","Received {0} rename suggestions",e.length))}clearCandidates(){this._listContainer.style.height="0px",this._listContainer.style.width="0px",this._listWidget.splice(0,this._listWidget.length,[])}get nCandidates(){return this._listWidget.length}get focusedCandidate(){if(this._listWidget.length===0)return;const e=this._listWidget.getSelectedElements()[0];if(e!==void 0)return e.newSymbolName;const t=this._listWidget.getFocusedElements()[0];if(t!==void 0)return t.newSymbolName}focusNext(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0)return this._listWidget.focusFirst(),this._listWidget.reveal(0),!0;if(e[0]===this._listWidget.length-1)return this._listWidget.setFocus([]),this._listWidget.reveal(0),!1;{this._listWidget.focusNext();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}focusPrevious(){if(this._listWidget.length===0)return!1;const e=this._listWidget.getFocus();if(e.length===0){this._listWidget.focusLast();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}else{if(e[0]===0)return this._listWidget.setFocus([]),!1;{this._listWidget.focusPrevious();const t=this._listWidget.getFocus()[0];return this._listWidget.reveal(t),!0}}}clearFocus(){this._listWidget.setFocus([])}get _candidateViewHeight(){const{totalHeight:e}=dw.getLayoutInfo({lineHeight:this._lineHeight});return e}_pickListHeight(e){const t=this._candidateViewHeight*e;return Math.min(t,this._availableHeight,this._candidateViewHeight*7)}_pickListWidth(e){const t=Math.ceil(Math.max(...e.map(n=>n.newSymbolName.length))*this._typicalHalfwidthCharacterWidth);return Math.max(this._minimumWidth,25+t+10)}static _createListWidget(e,t,i){const n=new class{getTemplateId(r){return"candidate"}getHeight(r){return t}},s=new class{constructor(){this.templateId="candidate"}renderTemplate(r){return new dw(r,i)}renderElement(r,a,l){l.populate(r)}disposeTemplate(r){r.dispose()}};return new $o("NewSymbolNameCandidates",e,n,[s],{keyboardSupport:!1,mouseSupport:!0,multipleSelectionSupport:!1})}}class VTe{constructor(){this._onDidInputChange=new O,this.onDidInputChange=this._onDidInputChange.event,this._disposables=new $}get domNode(){return this._domNode||(this._domNode=document.createElement("div"),this._domNode.className="rename-input-with-button",this._domNode.style.display="flex",this._domNode.style.flexDirection="row",this._domNode.style.alignItems="center",this._inputNode=document.createElement("input"),this._inputNode.className="rename-input",this._inputNode.type="text",this._inputNode.style.border="none",this._inputNode.setAttribute("aria-label",p("renameAriaLabel","Rename input. Type new name and press Enter to commit.")),this._domNode.appendChild(this._inputNode),this._buttonNode=document.createElement("div"),this._buttonNode.className="rename-suggestions-button",this._buttonNode.setAttribute("tabindex","0"),this._buttonGenHoverText=p("generateRenameSuggestionsButton","Generate new name suggestions"),this._buttonCancelHoverText=p("cancelRenameSuggestionsButton","Cancel"),this._buttonHover=Ba().setupManagedHover(bs("element"),this._buttonNode,this._buttonGenHoverText),this._disposables.add(this._buttonHover),this._domNode.appendChild(this._buttonNode),this._disposables.add(H(this.input,ee.INPUT,()=>this._onDidInputChange.fire())),this._disposables.add(H(this.input,ee.KEY_DOWN,e=>{const t=new Pt(e);(t.keyCode===15||t.keyCode===17)&&this._onDidInputChange.fire()})),this._disposables.add(H(this.input,ee.CLICK,()=>this._onDidInputChange.fire())),this._disposables.add(H(this.input,ee.FOCUS,()=>{this.domNode.style.outlineWidth="1px",this.domNode.style.outlineStyle="solid",this.domNode.style.outlineOffset="-1px",this.domNode.style.outlineColor="var(--vscode-focusBorder)"})),this._disposables.add(H(this.input,ee.BLUR,()=>{this.domNode.style.outline="none"}))),this._domNode}get input(){return ut(this._inputNode),this._inputNode}get button(){return ut(this._buttonNode),this._buttonNode}get buttonState(){return this._buttonState}setSparkleButton(){this._buttonState="sparkle",this._sparkleIcon??=Sf(J.sparkle),fn(this.button),this.button.appendChild(this._sparkleIcon),this.button.setAttribute("aria-label","Generating new name suggestions"),this._buttonHover?.update(this._buttonGenHoverText),this.input.focus()}setStopButton(){this._buttonState="stop",this._stopIcon??=Sf(J.primitiveSquare),fn(this.button),this.button.appendChild(this._stopIcon),this.button.setAttribute("aria-label","Cancel generating new name suggestions"),this._buttonHover?.update(this._buttonCancelHoverText),this.input.focus()}dispose(){this._disposables.dispose()}}const FC=class FC{constructor(e,t){this._domNode=document.createElement("div"),this._domNode.className="rename-box rename-candidate",this._domNode.style.display="flex",this._domNode.style.columnGap="5px",this._domNode.style.alignItems="center",this._domNode.style.height=`${t.lineHeight}px`,this._domNode.style.padding=`${FC._PADDING}px`;const i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.width=i.style.height=`${t.lineHeight*.8}px`,this._domNode.appendChild(i),this._icon=Sf(J.sparkle),this._icon.style.display="none",i.appendChild(this._icon),this._label=document.createElement("div"),mn(this._label,t),this._domNode.appendChild(this._label),e.appendChild(this._domNode)}populate(e){this._updateIcon(e),this._updateLabel(e)}_updateIcon(e){const t=!!e.tags?.includes(oR.AIGenerated);this._icon.style.display=t?"inherit":"none"}_updateLabel(e){this._label.innerText=e.newSymbolName}static getLayoutInfo({lineHeight:e}){return{totalHeight:e+FC._PADDING*2}}dispose(){}};FC._PADDING=2;let dw=FC;var HTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},vd=function(o,e){return function(t,i){e(t,i,o)}},OF;class KW{constructor(e,t,i){this.model=e,this.position=t,this._providerRenameIdx=0,this._providers=i.ordered(e)}hasProvider(){return this._providers.length>0}async resolveRenameLocation(e){const t=[];for(this._providerRenameIdx=0;this._providerRenameIdx<this._providers.length;this._providerRenameIdx++){const n=this._providers[this._providerRenameIdx];if(!n.resolveRenameLocation)break;const s=await n.resolveRenameLocation(this.model,this.position,e);if(s){if(s.rejectReason){t.push(s.rejectReason);continue}return s}}this._providerRenameIdx=0;const i=this.model.getWordAtPosition(this.position);return i?{range:new L(this.position.lineNumber,i.startColumn,this.position.lineNumber,i.endColumn),text:i.word,rejectReason:t.length>0?t.join(`
`):void 0}:{range:L.fromPositions(this.position),text:"",rejectReason:t.length>0?t.join(`
`):void 0}}async provideRenameEdits(e,t){return this._provideRenameEdits(e,this._providerRenameIdx,[],t)}async _provideRenameEdits(e,t,i,n){const s=this._providers[t];if(!s)return{edits:[],rejectReason:i.join(`
`)};const r=await s.provideRenameEdits(this.model,this.position,e,n);if(r){if(r.rejectReason)return this._provideRenameEdits(e,t+1,i.concat(r.rejectReason),n)}else return this._provideRenameEdits(e,t+1,i.concat(p("no result","No result.")),n);return r}}async function zTe(o,e,t,i){const n=new KW(e,t,o),s=await n.resolveRenameLocation(He.None);return s?.rejectReason?{edits:[],rejectReason:s.rejectReason}:n.provideRenameEdits(i,He.None)}var lf;let Kh=(lf=class{static get(e){return e.getContribution(OF.ID)}constructor(e,t,i,n,s,r,a,l,c){this.editor=e,this._instaService=t,this._notificationService=i,this._bulkEditService=n,this._progressService=s,this._logService=r,this._configService=a,this._languageFeaturesService=l,this._telemetryService=c,this._disposableStore=new $,this._cts=new ri,this._renameWidget=this._disposableStore.add(this._instaService.createInstance(MF,this.editor,["acceptRenameInput","acceptRenameInputWithPreview"]))}dispose(){this._disposableStore.dispose(),this._cts.dispose(!0)}async run(){const e=this._logService.trace.bind(this._logService,"[rename]");if(this._cts.dispose(!0),this._cts=new ri,!this.editor.hasModel()){e("editor has no model");return}const t=this.editor.getPosition(),i=new KW(this.editor.getModel(),t,this._languageFeaturesService.renameProvider);if(!i.hasProvider()){e("skeleton has no provider");return}const n=new zh(this.editor,5,void 0,this._cts.token);let s;try{e("resolving rename location");const f=i.resolveRenameLocation(n.token);this._progressService.showWhile(f,250),s=await f,e("resolved rename location")}catch(f){f instanceof Hr?e("resolve rename location cancelled",JSON.stringify(f,null,"	")):(e("resolve rename location failed",f instanceof Error?f:JSON.stringify(f,null,"	")),(typeof f=="string"||Ea(f))&&no.get(this.editor)?.showMessage(f||p("resolveRenameLocationFailed","An unknown error occurred while resolving rename location"),t));return}finally{n.dispose()}if(!s){e("returning early - no loc");return}if(s.rejectReason){e(`returning early - rejected with reason: ${s.rejectReason}`,s.rejectReason),no.get(this.editor)?.showMessage(s.rejectReason,t);return}if(n.token.isCancellationRequested){e("returning early - cts1 cancelled");return}const r=new zh(this.editor,5,s.range,this._cts.token),a=this.editor.getModel(),l=this._languageFeaturesService.newSymbolNamesProvider.all(a),c=await Promise.all(l.map(async f=>[f,await f.supportsAutomaticNewSymbolNamesTriggerKind??!1])),d=(f,m)=>{let _=c.slice();return f===KC.Automatic&&(_=_.filter(([b,v])=>v)),_.map(([b])=>b.provideNewSymbolNames(a,s.range,f,m))};e("creating rename input field and awaiting its result");const h=this._bulkEditService.hasPreviewHandler()&&this._configService.getValue(this.editor.getModel().uri,"editor.rename.enablePreview"),u=await this._renameWidget.getInput(s.range,s.text,h,l.length>0?d:void 0,r);if(e("received response from rename input field"),l.length>0&&this._reportTelemetry(l.length,a.getLanguageId(),u),typeof u=="boolean"){e(`returning early - rename input field response - ${u}`),u&&this.editor.focus(),r.dispose();return}this.editor.focus(),e("requesting rename edits");const g=Lw(i.provideRenameEdits(u.newName,r.token),r.token).then(async f=>{if(!f){e("returning early - no rename edits result");return}if(!this.editor.hasModel()){e("returning early - no model after rename edits are provided");return}if(f.rejectReason){e(`returning early - rejected with reason: ${f.rejectReason}`),this._notificationService.info(f.rejectReason);return}this.editor.setSelection(L.fromPositions(this.editor.getSelection().getPosition())),e("applying edits"),this._bulkEditService.apply(f,{editor:this.editor,showPreview:u.wantsPreview,label:p("label","Renaming '{0}' to '{1}'",s?.text,u.newName),code:"undoredo.rename",quotableLabel:p("quotableLabel","Renaming {0} to {1}",s?.text,u.newName),respectAutoSaveConfig:!0}).then(m=>{e("edits applied"),m.ariaSummary&&ps(p("aria","Successfully renamed '{0}' to '{1}'. Summary: {2}",s.text,u.newName,m.ariaSummary))}).catch(m=>{e(`error when applying edits ${JSON.stringify(m,null,"	")}`),this._notificationService.error(p("rename.failedApply","Rename failed to apply edits")),this._logService.error(m)})},f=>{e("error when providing rename edits",JSON.stringify(f,null,"	")),this._notificationService.error(p("rename.failed","Rename failed to compute edits")),this._logService.error(f)}).finally(()=>{r.dispose()});return e("returning rename operation"),this._progressService.showWhile(g,250),g}acceptRenameInput(e){this._renameWidget.acceptInput(e)}cancelRenameInput(){this._renameWidget.cancelInput(!0,"cancelRenameInput command")}focusNextRenameSuggestion(){this._renameWidget.focusNextRenameSuggestion()}focusPreviousRenameSuggestion(){this._renameWidget.focusPreviousRenameSuggestion()}_reportTelemetry(e,t,i){const n=typeof i=="boolean"?{kind:"cancelled",languageId:t,nRenameSuggestionProviders:e}:{kind:"accepted",languageId:t,nRenameSuggestionProviders:e,source:i.stats.source.k,nRenameSuggestions:i.stats.nRenameSuggestions,timeBeforeFirstInputFieldEdit:i.stats.timeBeforeFirstInputFieldEdit,wantsPreview:i.wantsPreview,nRenameSuggestionsInvocations:i.stats.nRenameSuggestionsInvocations,hadAutomaticRenameSuggestionsInvocation:i.stats.hadAutomaticRenameSuggestionsInvocation};this._telemetryService.publicLog2("renameInvokedEvent",n)}},OF=lf,lf.ID="editor.contrib.renameController",lf);Kh=OF=HTe([vd(1,Ce),vd(2,Ei),vd(3,Pw),vd(4,Yh),vd(5,Tn),vd(6,wT),vd(7,ue),vd(8,Fn)],Kh);class UTe extends de{constructor(){super({id:"editor.action.rename",label:p("rename.label","Rename Symbol"),alias:"Rename Symbol",precondition:K.and(T.writable,T.hasRenameProvider),kbOpts:{kbExpr:T.editorTextFocus,primary:60,weight:100},contextMenuOpts:{group:"1_modification",order:1.1}})}runCommand(e,t){const i=e.get(gt),[n,s]=Array.isArray(t)&&t||[void 0,void 0];return ye.isUri(n)&&A.isIPosition(s)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then(r=>{r&&(r.setPosition(s),r.invokeWithinContext(a=>(this.reportTelemetry(a,r),this.run(a,r))))},Ae):super.runCommand(e,t)}run(e,t){const i=e.get(Tn),n=Kh.get(t);return n?(i.trace("[RenameAction] got controller, running..."),n.run()):(i.trace("[RenameAction] returning early - controller missing"),Promise.resolve())}}at(Kh.ID,Kh,4);X(UTe);const jW=Hi.bindToContribution(Kh.get);oe(new jW({id:"acceptRenameInput",precondition:Eb,handler:o=>o.acceptRenameInput(!1),kbOpts:{weight:199,kbExpr:K.and(T.focus,K.not("isComposing")),primary:3}}));oe(new jW({id:"acceptRenameInputWithPreview",precondition:K.and(Eb,K.has("config.editor.rename.enablePreview")),handler:o=>o.acceptRenameInput(!0),kbOpts:{weight:199,kbExpr:K.and(T.focus,K.not("isComposing")),primary:2051}}));oe(new jW({id:"cancelRenameInput",precondition:Eb,handler:o=>o.cancelRenameInput(),kbOpts:{weight:199,kbExpr:T.focus,primary:9,secondary:[1033]}}));At(class extends _s{constructor(){super({id:"focusNextRenameSuggestion",title:{...De("focusNextRenameSuggestion","Focus Next Rename Suggestion")},precondition:Eb,keybinding:[{primary:18,weight:199}]})}run(e){const t=e.get(gt).getFocusedCodeEditor();if(!t)return;const i=Kh.get(t);i&&i.focusNextRenameSuggestion()}});At(class extends _s{constructor(){super({id:"focusPreviousRenameSuggestion",title:{...De("focusPreviousRenameSuggestion","Focus Previous Rename Suggestion")},precondition:Eb,keybinding:[{primary:16,weight:199}]})}run(e){const t=e.get(gt).getFocusedCodeEditor();if(!t)return;const i=Kh.get(t);i&&i.focusPreviousRenameSuggestion()}});Os("_executeDocumentRenameProvider",function(o,e,t,...i){const[n]=i;ut(typeof n=="string");const{renameProvider:s}=o.get(ue);return zTe(s,e,t,n)});Os("_executePrepareRename",async function(o,e,t){const{renameProvider:i}=o.get(ue),s=await new KW(e,t,i).resolveRenameLocation(He.None);if(s?.rejectReason)throw new Error(s.rejectReason);return s});ai.as(Zr.Configuration).registerConfiguration({id:"editor",properties:{"editor.rename.enablePreview":{scope:5,description:p("enablePreview","Enable/disable the ability to preview changes before renaming"),default:!0,type:"boolean"}}});var GTe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},S6=function(o,e){return function(t,i){e(t,i,o)}},c_;let ok=(c_=class extends F{constructor(e,t,i){super(),this.editor=e,this.languageConfigurationService=t,this.editorWorkerService=i,this.decorations=this.editor.createDecorationsCollection(),this.options=this.createOptions(e.getOption(73)),this.computePromise=null,this.currentOccurrences={},this._register(e.onDidChangeModel(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(e.onDidChangeModelLanguage(n=>{this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0)})),this._register(t.onDidChange(n=>{const s=this.editor.getModel()?.getLanguageId();s&&n.affects(s)&&(this.currentOccurrences={},this.options=this.createOptions(e.getOption(73)),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(e.onDidChangeConfiguration(n=>{this.options&&!n.hasChanged(73)||(this.options=this.createOptions(e.getOption(73)),this.updateDecorations([]),this.stop(),this.computeSectionHeaders.schedule(0))})),this._register(this.editor.onDidChangeModelContent(n=>{this.computeSectionHeaders.schedule()})),this._register(e.onDidChangeModelTokens(n=>{this.computeSectionHeaders.isScheduled()||this.computeSectionHeaders.schedule(1e3)})),this.computeSectionHeaders=this._register(new xt(()=>{this.findSectionHeaders()},250)),this.computeSectionHeaders.schedule(0)}createOptions(e){if(!e||!this.editor.hasModel())return;const t=this.editor.getModel().getLanguageId();if(!t)return;const i=this.languageConfigurationService.getLanguageConfiguration(t).comments,n=this.languageConfigurationService.getLanguageConfiguration(t).foldingRules;if(!(!i&&!n?.markers))return{foldingRules:n,findMarkSectionHeaders:e.showMarkSectionHeaders,findRegionSectionHeaders:e.showRegionSectionHeaders}}findSectionHeaders(){if(!this.editor.hasModel()||!this.options?.findMarkSectionHeaders&&!this.options?.findRegionSectionHeaders)return;const e=this.editor.getModel();if(e.isDisposed()||e.isTooLargeForSyncing())return;const t=e.getVersionId();this.editorWorkerService.findSectionHeaders(e.uri,this.options).then(i=>{e.isDisposed()||e.getVersionId()!==t||this.updateDecorations(i)})}updateDecorations(e){const t=this.editor.getModel();t&&(e=e.filter(s=>{if(!s.shouldBeInComments)return!0;const r=t.validateRange(s.range),a=t.tokenization.getLineTokens(r.startLineNumber),l=a.findTokenIndexAtOffset(r.startColumn-1),c=a.getStandardTokenType(l);return a.getLanguageId(l)===t.getLanguageId()&&c===1}));const i=Object.values(this.currentOccurrences).map(s=>s.decorationId),n=e.map(s=>$Te(s));this.editor.changeDecorations(s=>{const r=s.deltaDecorations(i,n);this.currentOccurrences={};for(let a=0,l=r.length;a<l;a++){const c={sectionHeader:e[a],decorationId:r[a]};this.currentOccurrences[c.decorationId]=c}})}stop(){this.computeSectionHeaders.cancel(),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop(),this.decorations.clear()}},c_.ID="editor.sectionHeaderDetector",c_);ok=GTe([S6(1,li),S6(2,Bs)],ok);function $Te(o){return{range:o.range,options:Fe.createDynamic({description:"section-header",stickiness:3,collapseOnReplaceEdit:!0,minimap:{color:void 0,position:1,sectionHeaderStyle:o.hasSeparatorLine?2:1,sectionHeaderText:o.text}})}}at(ok.ID,ok,1);function KTe(o){for(let e=0,t=o.length;e<t;e+=4){const i=o[e+0],n=o[e+1],s=o[e+2],r=o[e+3];o[e+0]=r,o[e+1]=s,o[e+2]=n,o[e+3]=i}}function jTe(o){const e=new Uint8Array(o.buffer,o.byteOffset,o.length*4);return tz()||KTe(e),vT.wrap(e)}function KZ(o){const e=new Uint32Array(qTe(o));let t=0;if(e[t++]=o.id,o.type==="full")e[t++]=1,e[t++]=o.data.length,e.set(o.data,t),t+=o.data.length;else{e[t++]=2,e[t++]=o.deltas.length;for(const i of o.deltas)e[t++]=i.start,e[t++]=i.deleteCount,i.data?(e[t++]=i.data.length,e.set(i.data,t),t+=i.data.length):e[t++]=0}return jTe(e)}function qTe(o){let e=0;if(e+=2,o.type==="full")e+=1+o.data.length;else{e+=1,e+=3*o.deltas.length;for(const t of o.deltas)t.data&&(e+=t.data.length)}return e}function ND(o){return o&&!!o.data}function jZ(o){return o&&Array.isArray(o.edits)}class ZTe{constructor(e,t,i){this.provider=e,this.tokens=t,this.error=i}}function qZ(o,e){return o.has(e)}function YTe(o,e){const t=o.orderedGroups(e);return t.length>0?t[0]:[]}async function ZZ(o,e,t,i,n){const s=YTe(o,e),r=await Promise.all(s.map(async a=>{let l,c=null;try{l=await a.provideDocumentSemanticTokens(e,a===t?i:null,n)}catch(d){c=d,l=null}return(!l||!ND(l)&&!jZ(l))&&(l=null),new ZTe(a,l,c)}));for(const a of r){if(a.error)throw a.error;if(a.tokens)return a}return r.length>0?r[0]:null}function XTe(o,e){const t=o.orderedGroups(e);return t.length>0?t[0]:null}class QTe{constructor(e,t){this.provider=e,this.tokens=t}}function JTe(o,e){return o.has(e)}function YZ(o,e){const t=o.orderedGroups(e);return t.length>0?t[0]:[]}async function qW(o,e,t,i){const n=YZ(o,e),s=await Promise.all(n.map(async r=>{let a;try{a=await r.provideDocumentRangeSemanticTokens(e,t,i)}catch(l){yi(l),a=null}return(!a||!ND(a))&&(a=null),new QTe(r,a)}));for(const r of s)if(r.tokens)return r;return s.length>0?s[0]:null}st.registerCommand("_provideDocumentSemanticTokensLegend",async(o,...e)=>{const[t]=e;ut(t instanceof ye);const i=o.get(Ut).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=o.get(ue),s=XTe(n,i);return s?s[0].getLegend():o.get(Ft).executeCommand("_provideDocumentRangeSemanticTokensLegend",t)});st.registerCommand("_provideDocumentSemanticTokens",async(o,...e)=>{const[t]=e;ut(t instanceof ye);const i=o.get(Ut).getModel(t);if(!i)return;const{documentSemanticTokensProvider:n}=o.get(ue);if(!qZ(n,i))return o.get(Ft).executeCommand("_provideDocumentRangeSemanticTokens",t,i.getFullModelRange());const s=await ZZ(n,i,null,null,He.None);if(!s)return;const{provider:r,tokens:a}=s;if(!a||!ND(a))return;const l=KZ({id:0,type:"full",data:a.data});return a.resultId&&r.releaseDocumentSemanticTokens(a.resultId),l});st.registerCommand("_provideDocumentRangeSemanticTokensLegend",async(o,...e)=>{const[t,i]=e;ut(t instanceof ye);const n=o.get(Ut).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:s}=o.get(ue),r=YZ(s,n);if(r.length===0)return;if(r.length===1)return r[0].getLegend();if(!i||!L.isIRange(i))return console.warn("provideDocumentRangeSemanticTokensLegend might be out-of-sync with provideDocumentRangeSemanticTokens unless a range argument is passed in"),r[0].getLegend();const a=await qW(s,n,L.lift(i),He.None);if(a)return a.provider.getLegend()});st.registerCommand("_provideDocumentRangeSemanticTokens",async(o,...e)=>{const[t,i]=e;ut(t instanceof ye),ut(L.isIRange(i));const n=o.get(Ut).getModel(t);if(!n)return;const{documentRangeSemanticTokensProvider:s}=o.get(ue),r=await qW(s,n,L.lift(i),He.None);if(!(!r||!r.tokens))return KZ({id:0,type:"full",data:r.tokens.data})});const ZW="editor.semanticHighlighting";function h0(o,e,t){const i=t.getValue(ZW,{overrideIdentifier:o.getLanguageId(),resource:o.uri})?.enabled;return typeof i=="boolean"?i:e.getColorTheme().semanticHighlighting}var XZ=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},fl=function(o,e){return function(t,i){e(t,i,o)}},Sd;let FF=class extends F{constructor(e,t,i,n,s,r){super(),this._watchers=Object.create(null);const a=d=>{this._watchers[d.uri.toString()]=new BF(d,e,i,s,r)},l=(d,h)=>{h.dispose(),delete this._watchers[d.uri.toString()]},c=()=>{for(const d of t.getModels()){const h=this._watchers[d.uri.toString()];h0(d,i,n)?h||a(d):h&&l(d,h)}};t.getModels().forEach(d=>{h0(d,i,n)&&a(d)}),this._register(t.onModelAdded(d=>{h0(d,i,n)&&a(d)})),this._register(t.onModelRemoved(d=>{const h=this._watchers[d.uri.toString()];h&&l(d,h)})),this._register(n.onDidChangeConfiguration(d=>{d.affectsConfiguration(ZW)&&c()})),this._register(i.onDidColorThemeChange(c))}dispose(){for(const e of Object.values(this._watchers))e.dispose();super.dispose()}};FF=XZ([fl(0,xT),fl(1,Ut),fl(2,zi),fl(3,Ke),fl(4,Uo),fl(5,ue)],FF);var Sh;let BF=(Sh=class extends F{constructor(e,t,i,n,s){super(),this._semanticTokensStylingService=t,this._isDisposed=!1,this._model=e,this._provider=s.documentSemanticTokensProvider,this._debounceInformation=n.for(this._provider,"DocumentSemanticTokens",{min:Sd.REQUEST_MIN_DELAY,max:Sd.REQUEST_MAX_DELAY}),this._fetchDocumentSemanticTokens=this._register(new xt(()=>this._fetchDocumentSemanticTokensNow(),Sd.REQUEST_MIN_DELAY)),this._currentDocumentResponse=null,this._currentDocumentRequestCancellationTokenSource=null,this._documentProvidersChangeListeners=[],this._providersChangedDuringRequest=!1,this._register(this._model.onDidChangeContent(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeAttached(()=>{this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(this._model.onDidChangeLanguage(()=>{this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(0)}));const r=()=>{Dt(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[];for(const a of this._provider.all(e))typeof a.onDidChange=="function"&&this._documentProvidersChangeListeners.push(a.onDidChange(()=>{if(this._currentDocumentRequestCancellationTokenSource){this._providersChangedDuringRequest=!0;return}this._fetchDocumentSemanticTokens.schedule(0)}))};r(),this._register(this._provider.onDidChange(()=>{r(),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._register(i.onDidColorThemeChange(a=>{this._setDocumentSemanticTokens(null,null,null,[]),this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))})),this._fetchDocumentSemanticTokens.schedule(0)}dispose(){this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._currentDocumentRequestCancellationTokenSource&&(this._currentDocumentRequestCancellationTokenSource.cancel(),this._currentDocumentRequestCancellationTokenSource=null),Dt(this._documentProvidersChangeListeners),this._documentProvidersChangeListeners=[],this._setDocumentSemanticTokens(null,null,null,[]),this._isDisposed=!0,super.dispose()}_fetchDocumentSemanticTokensNow(){if(this._currentDocumentRequestCancellationTokenSource)return;if(!qZ(this._provider,this._model)){this._currentDocumentResponse&&this._model.tokenization.setSemanticTokens(null,!1);return}if(!this._model.isAttachedToEditor())return;const e=new ri,t=this._currentDocumentResponse?this._currentDocumentResponse.provider:null,i=this._currentDocumentResponse&&this._currentDocumentResponse.resultId||null,n=ZZ(this._provider,this._model,t,i,e.token);this._currentDocumentRequestCancellationTokenSource=e,this._providersChangedDuringRequest=!1;const s=[],r=this._model.onDidChangeContent(l=>{s.push(l)}),a=new rn(!1);n.then(l=>{if(this._debounceInformation.update(this._model,a.elapsed()),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),!l)this._setDocumentSemanticTokens(null,null,null,s);else{const{provider:c,tokens:d}=l,h=this._semanticTokensStylingService.getStyling(c);this._setDocumentSemanticTokens(c,d||null,h,s)}},l=>{l&&(_r(l)||typeof l.message=="string"&&l.message.indexOf("busy")!==-1)||Ae(l),this._currentDocumentRequestCancellationTokenSource=null,r.dispose(),(s.length>0||this._providersChangedDuringRequest)&&(this._fetchDocumentSemanticTokens.isScheduled()||this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model)))})}static _copy(e,t,i,n,s){s=Math.min(s,i.length-n,e.length-t);for(let r=0;r<s;r++)i[n+r]=e[t+r]}_setDocumentSemanticTokens(e,t,i,n){const s=this._currentDocumentResponse,r=()=>{(n.length>0||this._providersChangedDuringRequest)&&!this._fetchDocumentSemanticTokens.isScheduled()&&this._fetchDocumentSemanticTokens.schedule(this._debounceInformation.get(this._model))};if(this._currentDocumentResponse&&(this._currentDocumentResponse.dispose(),this._currentDocumentResponse=null),this._isDisposed){e&&t&&e.releaseDocumentSemanticTokens(t.resultId);return}if(!e||!i){this._model.tokenization.setSemanticTokens(null,!1);return}if(!t){this._model.tokenization.setSemanticTokens(null,!0),r();return}if(jZ(t)){if(!s){this._model.tokenization.setSemanticTokens(null,!0);return}if(t.edits.length===0)t={resultId:t.resultId,data:s.data};else{let a=0;for(const u of t.edits)a+=(u.data?u.data.length:0)-u.deleteCount;const l=s.data,c=new Uint32Array(l.length+a);let d=l.length,h=c.length;for(let u=t.edits.length-1;u>=0;u--){const g=t.edits[u];if(g.start>l.length){i.warnInvalidEditStart(s.resultId,t.resultId,u,g.start,l.length),this._model.tokenization.setSemanticTokens(null,!0);return}const f=d-(g.start+g.deleteCount);f>0&&(Sd._copy(l,d-f,c,h-f,f),h-=f),g.data&&(Sd._copy(g.data,0,c,h-g.data.length,g.data.length),h-=g.data.length),d=g.start}d>0&&Sd._copy(l,0,c,0,d),t={resultId:t.resultId,data:c}}}if(ND(t)){this._currentDocumentResponse=new eDe(e,t.resultId,t.data);const a=KU(t,i,this._model.getLanguageId());if(n.length>0)for(const l of n)for(const c of a)for(const d of l.changes)c.applyEdit(d.range,d.text);this._model.tokenization.setSemanticTokens(a,!0)}else this._model.tokenization.setSemanticTokens(null,!0);r()}},Sd=Sh,Sh.REQUEST_MIN_DELAY=300,Sh.REQUEST_MAX_DELAY=2e3,Sh);BF=Sd=XZ([fl(1,xT),fl(2,zi),fl(3,Uo),fl(4,ue)],BF);class eDe{constructor(e,t,i){this.provider=e,this.resultId=t,this.data=i}dispose(){this.provider.releaseDocumentSemanticTokens(this.resultId)}}vb(FF);var tDe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},lv=function(o,e){return function(t,i){e(t,i,o)}},d_;let rk=(d_=class extends F{constructor(e,t,i,n,s,r){super(),this._semanticTokensStylingService=t,this._themeService=i,this._configurationService=n,this._editor=e,this._provider=r.documentRangeSemanticTokensProvider,this._debounceInformation=s.for(this._provider,"DocumentRangeSemanticTokens",{min:100,max:500}),this._tokenizeViewport=this._register(new xt(()=>this._tokenizeViewportNow(),100)),this._outstandingRequests=[];const a=()=>{this._editor.hasModel()&&this._tokenizeViewport.schedule(this._debounceInformation.get(this._editor.getModel()))};this._register(this._editor.onDidScrollChange(()=>{a()})),this._register(this._editor.onDidChangeModel(()=>{this._cancelAll(),a()})),this._register(this._editor.onDidChangeModelContent(l=>{this._cancelAll(),a()})),this._register(this._provider.onDidChange(()=>{this._cancelAll(),a()})),this._register(this._configurationService.onDidChangeConfiguration(l=>{l.affectsConfiguration(ZW)&&(this._cancelAll(),a())})),this._register(this._themeService.onDidColorThemeChange(()=>{this._cancelAll(),a()})),a()}_cancelAll(){for(const e of this._outstandingRequests)e.cancel();this._outstandingRequests=[]}_removeOutstandingRequest(e){for(let t=0,i=this._outstandingRequests.length;t<i;t++)if(this._outstandingRequests[t]===e){this._outstandingRequests.splice(t,1);return}}_tokenizeViewportNow(){if(!this._editor.hasModel())return;const e=this._editor.getModel();if(e.tokenization.hasCompleteSemanticTokens())return;if(!h0(e,this._themeService,this._configurationService)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}if(!JTe(this._provider,e)){e.tokenization.hasSomeSemanticTokens()&&e.tokenization.setSemanticTokens(null,!1);return}const t=this._editor.getVisibleRangesPlusViewportAboveBelow();this._outstandingRequests=this._outstandingRequests.concat(t.map(i=>this._requestRange(e,i)))}_requestRange(e,t){const i=e.getVersionId(),n=ji(r=>Promise.resolve(qW(this._provider,e,t,r))),s=new rn(!1);return n.then(r=>{if(this._debounceInformation.update(e,s.elapsed()),!r||!r.tokens||e.isDisposed()||e.getVersionId()!==i)return;const{provider:a,tokens:l}=r,c=this._semanticTokensStylingService.getStyling(a);e.tokenization.setPartialSemanticTokens(t,KU(l,c,e.getLanguageId()))}).then(()=>this._removeOutstandingRequest(n),()=>this._removeOutstandingRequest(n)),n}},d_.ID="editor.contrib.viewportSemanticTokens",d_);rk=tDe([lv(1,xT),lv(2,zi),lv(3,Ke),lv(4,Uo),lv(5,ue)],rk);at(rk.ID,rk,1);class iDe{constructor(e=!0){this.selectSubwords=e}provideSelectionRanges(e,t){const i=[];for(const n of t){const s=[];i.push(s),this.selectSubwords&&this._addInWordRanges(s,e,n),this._addWordRanges(s,e,n),this._addWhitespaceLine(s,e,n),s.push({range:e.getFullModelRange()})}return i}_addInWordRanges(e,t,i){const n=t.getWordAtPosition(i);if(!n)return;const{word:s,startColumn:r}=n,a=i.column-r;let l=a,c=a,d=0;for(;l>=0;l--){const h=s.charCodeAt(l);if(l!==a&&(h===95||h===45))break;if(Hd(h)&&dl(d))break;d=h}for(l+=1;c<s.length;c++){const h=s.charCodeAt(c);if(dl(h)&&Hd(d))break;if(h===95||h===45)break;d=h}l<c&&e.push({range:new L(i.lineNumber,r+l,i.lineNumber,r+c)})}_addWordRanges(e,t,i){const n=t.getWordAtPosition(i);n&&e.push({range:new L(i.lineNumber,n.startColumn,i.lineNumber,n.endColumn)})}_addWhitespaceLine(e,t,i){t.getLineLength(i.lineNumber)>0&&t.getLineFirstNonWhitespaceColumn(i.lineNumber)===0&&t.getLineLastNonWhitespaceColumn(i.lineNumber)===0&&e.push({range:new L(i.lineNumber,1,i.lineNumber,t.getLineMaxColumn(i.lineNumber))})}}var nDe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},sDe=function(o,e){return function(t,i){e(t,i,o)}},WF;class YW{constructor(e,t){this.index=e,this.ranges=t}mov(e){const t=this.index+(e?1:-1);if(t<0||t>=this.ranges.length)return this;const i=new YW(t,this.ranges);return i.ranges[t].equalsRange(this.ranges[this.index])?i.mov(e):i}}var cf;let hw=(cf=class{static get(e){return e.getContribution(WF.ID)}constructor(e,t){this._editor=e,this._languageFeaturesService=t,this._ignoreSelection=!1}dispose(){this._selectionListener?.dispose()}async run(e){if(!this._editor.hasModel())return;const t=this._editor.getSelections(),i=this._editor.getModel();if(this._state||await JZ(this._languageFeaturesService.selectionRangeProvider,i,t.map(s=>s.getPosition()),this._editor.getOption(114),He.None).then(s=>{if(!(!Yn(s)||s.length!==t.length)&&!(!this._editor.hasModel()||!ei(this._editor.getSelections(),t,(r,a)=>r.equalsSelection(a)))){for(let r=0;r<s.length;r++)s[r]=s[r].filter(a=>a.containsPosition(t[r].getStartPosition())&&a.containsPosition(t[r].getEndPosition())),s[r].unshift(t[r]);this._state=s.map(r=>new YW(0,r)),this._selectionListener?.dispose(),this._selectionListener=this._editor.onDidChangeCursorPosition(()=>{this._ignoreSelection||(this._selectionListener?.dispose(),this._state=void 0)})}}),!this._state)return;this._state=this._state.map(s=>s.mov(e));const n=this._state.map(s=>pe.fromPositions(s.ranges[s.index].getStartPosition(),s.ranges[s.index].getEndPosition()));this._ignoreSelection=!0;try{this._editor.setSelections(n)}finally{this._ignoreSelection=!1}}},WF=cf,cf.ID="editor.contrib.smartSelectController",cf);hw=WF=nDe([sDe(1,ue)],hw);class QZ extends de{constructor(e,t){super(t),this._forward=e}async run(e,t){const i=hw.get(t);i&&await i.run(this._forward)}}class oDe extends QZ{constructor(){super(!0,{id:"editor.action.smartSelect.expand",label:p("smartSelect.expand","Expand Selection"),alias:"Expand Selection",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:1553,mac:{primary:3345,secondary:[1297]},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSmartSelectGrow",comment:["&& denotes a mnemonic"]},"&&Expand Selection"),order:2}})}}st.registerCommandAlias("editor.action.smartSelect.grow","editor.action.smartSelect.expand");class rDe extends QZ{constructor(){super(!1,{id:"editor.action.smartSelect.shrink",label:p("smartSelect.shrink","Shrink Selection"),alias:"Shrink Selection",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:1551,mac:{primary:3343,secondary:[1295]},weight:100},menuOpts:{menuId:fe.MenubarSelectionMenu,group:"1_basic",title:p({key:"miSmartSelectShrink",comment:["&& denotes a mnemonic"]},"&&Shrink Selection"),order:3}})}}at(hw.ID,hw,4);X(oDe);X(rDe);async function JZ(o,e,t,i,n){const s=o.all(e).concat(new iDe(i.selectSubwords));s.length===1&&s.unshift(new GL);const r=[],a=[];for(const l of s)r.push(Promise.resolve(l.provideSelectionRanges(e,t,n)).then(c=>{if(Yn(c)&&c.length===t.length)for(let d=0;d<t.length;d++){a[d]||(a[d]=[]);for(const h of c[d])L.isIRange(h.range)&&L.containsPosition(h.range,t[d])&&a[d].push(L.lift(h.range))}},yi));return await Promise.all(r),a.map(l=>{if(l.length===0)return[];l.sort((u,g)=>A.isBefore(u.getStartPosition(),g.getStartPosition())?1:A.isBefore(g.getStartPosition(),u.getStartPosition())||A.isBefore(u.getEndPosition(),g.getEndPosition())?-1:A.isBefore(g.getEndPosition(),u.getEndPosition())?1:0);const c=[];let d;for(const u of l)(!d||L.containsRange(u,d)&&!L.equalsRange(u,d))&&(c.push(u),d=u);if(!i.selectLeadingAndTrailingWhitespace)return c;const h=[c[0]];for(let u=1;u<c.length;u++){const g=c[u-1],f=c[u];if(f.startLineNumber!==g.startLineNumber||f.endLineNumber!==g.endLineNumber){const m=new L(g.startLineNumber,e.getLineFirstNonWhitespaceColumn(g.startLineNumber),g.endLineNumber,e.getLineLastNonWhitespaceColumn(g.endLineNumber));m.containsRange(g)&&!m.equalsRange(g)&&f.containsRange(m)&&!f.equalsRange(m)&&h.push(m);const _=new L(g.startLineNumber,1,g.endLineNumber,e.getLineMaxColumn(g.endLineNumber));_.containsRange(g)&&!_.equalsRange(m)&&f.containsRange(_)&&!f.equalsRange(_)&&h.push(_)}h.push(f)}return h})}st.registerCommand("_executeSelectionRangeProvider",async function(o,...e){const[t,i]=e;ut(ye.isUri(t));const n=o.get(ue).selectionRangeProvider,s=await o.get(Ms).createModelReference(t);try{return JZ(n,s.object.textEditorModel,i,{selectLeadingAndTrailingWhitespace:!0,selectSubwords:!0},He.None)}finally{s.dispose()}});const aDe=Object.freeze({View:De("view","View"),Help:De("help","Help"),Test:De("test","Test"),File:De("file","File"),Preferences:De("preferences","Preferences"),Developer:De({key:"developer",comment:["A developer on Code itself or someone diagnosing issues in Code"]},"Developer")});class mC{constructor(e,t,i,n=null){this.startLineNumbers=e,this.endLineNumbers=t,this.lastLineRelativePosition=i,this.showEndForLine=n}equals(e){return!!e&&this.lastLineRelativePosition===e.lastLineRelativePosition&&this.showEndForLine===e.showEndForLine&&ei(this.startLineNumbers,e.startLineNumbers)&&ei(this.endLineNumbers,e.endLineNumbers)}static get Empty(){return new mC([],[],0)}}const x6=nd("stickyScrollViewLayer",{createHTML:o=>o}),FN="data-sticky-line-index",L6="data-sticky-is-line",lDe="data-sticky-is-line-number",k6="data-sticky-is-folding-icon";class cDe extends F{constructor(e){super(),this._editor=e,this._foldingIconStore=new $,this._rootDomNode=document.createElement("div"),this._lineNumbersDomNode=document.createElement("div"),this._linesDomNodeScrollable=document.createElement("div"),this._linesDomNode=document.createElement("div"),this._lineHeight=this._editor.getOption(67),this._renderedStickyLines=[],this._lineNumbers=[],this._lastLineRelativePosition=0,this._minContentWidthInPx=0,this._isOnGlyphMargin=!1,this._lineNumbersDomNode.className="sticky-widget-line-numbers",this._lineNumbersDomNode.setAttribute("role","none"),this._linesDomNode.className="sticky-widget-lines",this._linesDomNode.setAttribute("role","list"),this._linesDomNodeScrollable.className="sticky-widget-lines-scrollable",this._linesDomNodeScrollable.appendChild(this._linesDomNode),this._rootDomNode.className="sticky-widget",this._rootDomNode.classList.toggle("peek",e instanceof jr),this._rootDomNode.appendChild(this._lineNumbersDomNode),this._rootDomNode.appendChild(this._linesDomNodeScrollable);const t=()=>{this._linesDomNode.style.left=this._editor.getOption(116).scrollWithEditor?`-${this._editor.getScrollLeft()}px`:"0px"};this._register(this._editor.onDidChangeConfiguration(i=>{i.hasChanged(116)&&t(),i.hasChanged(67)&&(this._lineHeight=this._editor.getOption(67))})),this._register(this._editor.onDidScrollChange(i=>{i.scrollLeftChanged&&t(),i.scrollWidthChanged&&this._updateWidgetWidth()})),this._register(this._editor.onDidChangeModel(()=>{t(),this._updateWidgetWidth()})),this._register(this._foldingIconStore),t(),this._register(this._editor.onDidLayoutChange(i=>{this._updateWidgetWidth()})),this._updateWidgetWidth()}get lineNumbers(){return this._lineNumbers}get lineNumberCount(){return this._lineNumbers.length}getRenderedStickyLine(e){return this._renderedStickyLines.find(t=>t.lineNumber===e)}getCurrentLines(){return this._lineNumbers}setState(e,t,i){if(i===void 0&&(!this._previousState&&!e||this._previousState&&this._previousState.equals(e)))return;const n=this._isWidgetHeightZero(e),s=n?void 0:e,r=n?0:this._findLineToRebuildWidgetFrom(e,i);this._renderRootNode(s,t,r),this._previousState=e}_isWidgetHeightZero(e){if(!e)return!0;const t=e.startLineNumbers.length*this._lineHeight+e.lastLineRelativePosition;if(t>0){this._lastLineRelativePosition=e.lastLineRelativePosition;const i=[...e.startLineNumbers];e.showEndForLine!==null&&(i[e.showEndForLine]=e.endLineNumbers[e.showEndForLine]),this._lineNumbers=i}else this._lastLineRelativePosition=0,this._lineNumbers=[];return t===0}_findLineToRebuildWidgetFrom(e,t){if(!e||!this._previousState)return 0;if(t!==void 0)return t;const i=this._previousState,n=e.startLineNumbers.findIndex(s=>!i.startLineNumbers.includes(s));return n===-1?0:n}_updateWidgetWidth(){const e=this._editor.getLayoutInfo(),t=e.contentLeft;this._lineNumbersDomNode.style.width=`${t}px`,this._linesDomNodeScrollable.style.setProperty("--vscode-editorStickyScroll-scrollableWidth",`${this._editor.getScrollWidth()-e.verticalScrollbarWidth}px`),this._rootDomNode.style.width=`${e.width-e.verticalScrollbarWidth}px`}_clearStickyLinesFromLine(e){this._foldingIconStore.clear();for(let t=e;t<this._renderedStickyLines.length;t++){const i=this._renderedStickyLines[t];i.lineNumberDomNode.remove(),i.lineDomNode.remove()}this._renderedStickyLines=this._renderedStickyLines.slice(0,e),this._rootDomNode.style.display="none"}_useFoldingOpacityTransition(e){this._lineNumbersDomNode.style.setProperty("--vscode-editorStickyScroll-foldingOpacityTransition",`opacity ${e?.5:0}s`)}_setFoldingIconsVisibility(e){for(const t of this._renderedStickyLines){const i=t.foldingIcon;i&&i.setVisible(e?!0:i.isCollapsed)}}async _renderRootNode(e,t,i){if(this._clearStickyLinesFromLine(i),!e)return;for(const a of this._renderedStickyLines)this._updateTopAndZIndexOfStickyLine(a);const n=this._editor.getLayoutInfo(),s=this._lineNumbers.slice(i);for(const[a,l]of s.entries()){const c=this._renderChildNode(a+i,l,t,n);c&&(this._linesDomNode.appendChild(c.lineDomNode),this._lineNumbersDomNode.appendChild(c.lineNumberDomNode),this._renderedStickyLines.push(c))}t&&(this._setFoldingHoverListeners(),this._useFoldingOpacityTransition(!this._isOnGlyphMargin));const r=this._lineNumbers.length*this._lineHeight+this._lastLineRelativePosition;this._rootDomNode.style.display="block",this._lineNumbersDomNode.style.height=`${r}px`,this._linesDomNodeScrollable.style.height=`${r}px`,this._rootDomNode.style.height=`${r}px`,this._rootDomNode.style.marginLeft="0px",this._minContentWidthInPx=Math.max(...this._renderedStickyLines.map(a=>a.scrollWidth))+n.verticalScrollbarWidth,this._editor.layoutOverlayWidget(this)}_setFoldingHoverListeners(){this._editor.getOption(111)==="mouseover"&&(this._foldingIconStore.add(H(this._lineNumbersDomNode,ee.MOUSE_ENTER,()=>{this._isOnGlyphMargin=!0,this._setFoldingIconsVisibility(!0)})),this._foldingIconStore.add(H(this._lineNumbersDomNode,ee.MOUSE_LEAVE,()=>{this._isOnGlyphMargin=!1,this._useFoldingOpacityTransition(!0),this._setFoldingIconsVisibility(!1)})))}_renderChildNode(e,t,i,n){const s=this._editor._getViewModel();if(!s)return;const r=s.coordinatesConverter.convertModelPositionToViewPosition(new A(t,1)).lineNumber,a=s.getViewLineRenderingData(r),l=this._editor.getOption(68);let c;try{c=as.filter(a.inlineDecorations,r,a.minColumn,a.maxColumn)}catch{c=[]}const d=new eu(!0,!0,a.content,a.continuesWithWrappedLine,a.isBasicASCII,a.containsRTL,0,a.tokens,c,a.tabSize,a.startVisibleColumn,1,1,1,500,"none",!0,!0,null),h=new rb(2e3),u=$w(d,h);let g;x6?g=x6.createHTML(h.build()):g=h.build();const f=document.createElement("span");f.setAttribute(FN,String(e)),f.setAttribute(L6,""),f.setAttribute("role","listitem"),f.tabIndex=0,f.className="sticky-line-content",f.classList.add(`stickyLine${t}`),f.style.lineHeight=`${this._lineHeight}px`,f.innerHTML=g;const m=document.createElement("span");m.setAttribute(FN,String(e)),m.setAttribute(lDe,""),m.className="sticky-line-number",m.style.lineHeight=`${this._lineHeight}px`;const _=n.contentLeft;m.style.width=`${_}px`;const b=document.createElement("span");l.renderType===1||l.renderType===3&&t%10===0?b.innerText=t.toString():l.renderType===2&&(b.innerText=Math.abs(t-this._editor.getPosition().lineNumber).toString()),b.className="sticky-line-number-inner",b.style.lineHeight=`${this._lineHeight}px`,b.style.width=`${n.lineNumbersWidth}px`,b.style.paddingLeft=`${n.lineNumbersLeft}px`,m.appendChild(b);const v=this._renderFoldingIconForLine(i,t);v&&m.appendChild(v.domNode),this._editor.applyFontInfo(f),this._editor.applyFontInfo(b),m.style.lineHeight=`${this._lineHeight}px`,f.style.lineHeight=`${this._lineHeight}px`,m.style.height=`${this._lineHeight}px`,f.style.height=`${this._lineHeight}px`;const y=new dDe(e,t,f,m,v,u.characterMapping,f.scrollWidth);return this._updateTopAndZIndexOfStickyLine(y)}_updateTopAndZIndexOfStickyLine(e){const t=e.index,i=e.lineDomNode,n=e.lineNumberDomNode,s=t===this._lineNumbers.length-1,r="0",a="1";i.style.zIndex=s?r:a,n.style.zIndex=s?r:a;const l=`${t*this._lineHeight+this._lastLineRelativePosition+(e.foldingIcon?.isCollapsed?1:0)}px`,c=`${t*this._lineHeight}px`;return i.style.top=s?l:c,n.style.top=s?l:c,e}_renderFoldingIconForLine(e,t){const i=this._editor.getOption(111);if(!e||i==="never")return;const n=e.regions,s=n.findRange(t),r=n.getStartLineNumber(s);if(!(t===r))return;const l=n.isCollapsed(s),c=new hDe(l,r,n.getEndLineNumber(s),this._lineHeight);return c.setVisible(this._isOnGlyphMargin?!0:l||i==="always"),c.domNode.setAttribute(k6,""),c}getId(){return"editor.contrib.stickyScrollWidget"}getDomNode(){return this._rootDomNode}getPosition(){return{preference:2,stackOridinal:10}}getMinContentWidthInPx(){return this._minContentWidthInPx}focusLineWithIndex(e){0<=e&&e<this._renderedStickyLines.length&&this._renderedStickyLines[e].lineDomNode.focus()}getEditorPositionFromNode(e){if(!e||e.children.length>0)return null;const t=this._getRenderedStickyLineFromChildDomNode(e);if(!t)return null;const i=xB(t.characterMapping,e,0);return new A(t.lineNumber,i)}getLineNumberFromChildDomNode(e){return this._getRenderedStickyLineFromChildDomNode(e)?.lineNumber??null}_getRenderedStickyLineFromChildDomNode(e){const t=this.getLineIndexFromChildDomNode(e);return t===null||t<0||t>=this._renderedStickyLines.length?null:this._renderedStickyLines[t]}getLineIndexFromChildDomNode(e){const t=this._getAttributeValue(e,FN);return t?parseInt(t,10):null}isInStickyLine(e){return this._getAttributeValue(e,L6)!==void 0}isInFoldingIconDomNode(e){return this._getAttributeValue(e,k6)!==void 0}_getAttributeValue(e,t){for(;e&&e!==this._rootDomNode;){const i=e.getAttribute(t);if(i!==null)return i;e=e.parentElement}}}class dDe{constructor(e,t,i,n,s,r,a){this.index=e,this.lineNumber=t,this.lineDomNode=i,this.lineNumberDomNode=n,this.foldingIcon=s,this.characterMapping=r,this.scrollWidth=a}}class hDe{constructor(e,t,i,n){this.isCollapsed=e,this.foldingStartLine=t,this.foldingEndLine=i,this.dimension=n,this.domNode=document.createElement("div"),this.domNode.style.width=`${n}px`,this.domNode.style.height=`${n}px`,this.domNode.className=ke.asClassName(e?PL:RL)}setVisible(e){this.domNode.style.cursor=e?"pointer":"default",this.domNode.style.opacity=e?"1":"0"}}class _C{constructor(e,t){this.startLineNumber=e,this.endLineNumber=t}}class ak{constructor(e,t,i){this.range=e,this.children=t,this.parent=i}}class eY{constructor(e,t,i,n){this.uri=e,this.version=t,this.element=i,this.outlineProviderId=n}}var RD=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},uw=function(o,e){return function(t,i){e(t,i,o)}},bC;(function(o){o.OUTLINE_MODEL="outlineModel",o.FOLDING_PROVIDER_MODEL="foldingProviderModel",o.INDENTATION_MODEL="indentationModel"})(bC||(bC={}));var Jd;(function(o){o[o.VALID=0]="VALID",o[o.INVALID=1]="INVALID",o[o.CANCELED=2]="CANCELED"})(Jd||(Jd={}));let VF=class extends F{constructor(e,t,i,n){switch(super(),this._editor=e,this._modelProviders=[],this._modelPromise=null,this._updateScheduler=this._register(new hr(300)),this._updateOperation=this._register(new $),this._editor.getOption(116).defaultModel){case bC.OUTLINE_MODEL:this._modelProviders.push(new HF(this._editor,n));case bC.FOLDING_PROVIDER_MODEL:this._modelProviders.push(new UF(this._editor,t,n));case bC.INDENTATION_MODEL:this._modelProviders.push(new zF(this._editor,i));break}}dispose(){this._modelProviders.forEach(e=>e.dispose()),this._updateOperation.clear(),this._cancelModelPromise(),super.dispose()}_cancelModelPromise(){this._modelPromise&&(this._modelPromise.cancel(),this._modelPromise=null)}async update(e){return this._updateOperation.clear(),this._updateOperation.add({dispose:()=>{this._cancelModelPromise(),this._updateScheduler.cancel()}}),this._cancelModelPromise(),await this._updateScheduler.trigger(async()=>{for(const t of this._modelProviders){const{statusPromise:i,modelPromise:n}=t.computeStickyModel(e);this._modelPromise=n;const s=await i;if(this._modelPromise!==n)return null;switch(s){case Jd.CANCELED:return this._updateOperation.clear(),null;case Jd.VALID:return t.stickyModel}}return null}).catch(t=>(Ae(t),null))}};VF=RD([uw(2,Ce),uw(3,ue)],VF);class tY extends F{constructor(e){super(),this._editor=e,this._stickyModel=null}get stickyModel(){return this._stickyModel}_invalid(){return this._stickyModel=null,Jd.INVALID}computeStickyModel(e){if(e.isCancellationRequested||!this.isProviderValid())return{statusPromise:this._invalid(),modelPromise:null};const t=ji(i=>this.createModelFromProvider(i));return{statusPromise:t.then(i=>this.isModelValid(i)?e.isCancellationRequested?Jd.CANCELED:(this._stickyModel=this.createStickyModel(e,i),Jd.VALID):this._invalid()).then(void 0,i=>(Ae(i),Jd.CANCELED)),modelPromise:t}}isModelValid(e){return!0}isProviderValid(){return!0}}let HF=class extends tY{constructor(e,t){super(e),this._languageFeaturesService=t}createModelFromProvider(e){return _c.create(this._languageFeaturesService.documentSymbolProvider,this._editor.getModel(),e)}createStickyModel(e,t){const{stickyOutlineElement:i,providerID:n}=this._stickyModelFromOutlineModel(t,this._stickyModel?.outlineProviderId),s=this._editor.getModel();return new eY(s.uri,s.getVersionId(),i,n)}isModelValid(e){return e&&e.children.size>0}_stickyModelFromOutlineModel(e,t){let i;if(nt.first(e.children.values())instanceof wZ){const a=nt.find(e.children.values(),l=>l.id===t);if(a)i=a.children;else{let l="",c=-1,d;for(const[h,u]of e.children.entries()){const g=this._findSumOfRangesOfGroup(u);g>c&&(d=u,c=g,l=u.id)}t=l,i=d.children}}else i=e.children;const n=[],s=Array.from(i.values()).sort((a,l)=>{const c=new _C(a.symbol.range.startLineNumber,a.symbol.range.endLineNumber),d=new _C(l.symbol.range.startLineNumber,l.symbol.range.endLineNumber);return this._comparator(c,d)});for(const a of s)n.push(this._stickyModelFromOutlineElement(a,a.symbol.selectionRange.startLineNumber));return{stickyOutlineElement:new ak(void 0,n,void 0),providerID:t}}_stickyModelFromOutlineElement(e,t){const i=[];for(const s of e.children.values())if(s.symbol.selectionRange.startLineNumber!==s.symbol.range.endLineNumber)if(s.symbol.selectionRange.startLineNumber!==t)i.push(this._stickyModelFromOutlineElement(s,s.symbol.selectionRange.startLineNumber));else for(const r of s.children.values())i.push(this._stickyModelFromOutlineElement(r,s.symbol.selectionRange.startLineNumber));i.sort((s,r)=>this._comparator(s.range,r.range));const n=new _C(e.symbol.selectionRange.startLineNumber,e.symbol.range.endLineNumber);return new ak(n,i,void 0)}_comparator(e,t){return e.startLineNumber!==t.startLineNumber?e.startLineNumber-t.startLineNumber:t.endLineNumber-e.endLineNumber}_findSumOfRangesOfGroup(e){let t=0;for(const i of e.children.values())t+=this._findSumOfRangesOfGroup(i);return e instanceof I2?t+e.symbol.range.endLineNumber-e.symbol.selectionRange.startLineNumber:t}};HF=RD([uw(1,ue)],HF);class iY extends tY{constructor(e){super(e),this._foldingLimitReporter=new vZ(e)}createStickyModel(e,t){const i=this._fromFoldingRegions(t),n=this._editor.getModel();return new eY(n.uri,n.getVersionId(),i,void 0)}isModelValid(e){return e!==null}_fromFoldingRegions(e){const t=e.length,i=[],n=new ak(void 0,[],void 0);for(let s=0;s<t;s++){const r=e.getParentIndex(s);let a;r!==-1?a=i[r]:a=n;const l=new ak(new _C(e.getStartLineNumber(s),e.getEndLineNumber(s)+1),[],a);a.children.push(l),i.push(l)}return n}}let zF=class extends iY{constructor(e,t){super(e),this._languageConfigurationService=t,this.provider=this._register(new MW(e.getModel(),this._languageConfigurationService,this._foldingLimitReporter))}async createModelFromProvider(e){return this.provider.compute(e)}};zF=RD([uw(1,li)],zF);let UF=class extends iY{constructor(e,t,i){super(e),this._languageFeaturesService=i;const n=$h.getFoldingRangeProviders(this._languageFeaturesService,e.getModel());n.length>0&&(this.provider=this._register(new OW(e.getModel(),n,t,this._foldingLimitReporter,void 0)))}isProviderValid(){return this.provider!==void 0}async createModelFromProvider(e){return this.provider?.compute(e)??null}};UF=RD([uw(2,ue)],UF);var uDe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},E6=function(o,e){return function(t,i){e(t,i,o)}};class gDe{constructor(e,t,i){this.startLineNumber=e,this.endLineNumber=t,this.nestingDepth=i}}let GF=class extends F{constructor(e,t,i){super(),this._languageFeaturesService=t,this._languageConfigurationService=i,this._onDidChangeStickyScroll=this._register(new O),this.onDidChangeStickyScroll=this._onDidChangeStickyScroll.event,this._model=null,this._cts=null,this._stickyModelProvider=null,this._editor=e,this._sessionStore=this._register(new $),this._updateSoon=this._register(new xt(()=>this.update(),50)),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(116)&&this.readConfiguration()})),this.readConfiguration()}readConfiguration(){this._sessionStore.clear(),this._editor.getOption(116).enabled&&(this._sessionStore.add(this._editor.onDidChangeModel(()=>{this._model=null,this.updateStickyModelProvider(),this._onDidChangeStickyScroll.fire(),this.update()})),this._sessionStore.add(this._editor.onDidChangeHiddenAreas(()=>this.update())),this._sessionStore.add(this._editor.onDidChangeModelContent(()=>this._updateSoon.schedule())),this._sessionStore.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>this.update())),this._sessionStore.add(ve(()=>{this._stickyModelProvider?.dispose(),this._stickyModelProvider=null})),this.updateStickyModelProvider(),this.update())}getVersionId(){return this._model?.version}updateStickyModelProvider(){this._stickyModelProvider?.dispose(),this._stickyModelProvider=null;const e=this._editor;e.hasModel()&&(this._stickyModelProvider=new VF(e,()=>this._updateSoon.schedule(),this._languageConfigurationService,this._languageFeaturesService))}async update(){this._cts?.dispose(!0),this._cts=new ri,await this.updateStickyModel(this._cts.token),this._onDidChangeStickyScroll.fire()}async updateStickyModel(e){if(!this._editor.hasModel()||!this._stickyModelProvider||this._editor.getModel().isTooLargeForTokenization()){this._model=null;return}const t=await this._stickyModelProvider.update(e);e.isCancellationRequested||(this._model=t)}updateIndex(e){return e===-1?e=0:e<0&&(e=-e-2),e}getCandidateStickyLinesIntersectingFromStickyModel(e,t,i,n,s){if(t.children.length===0)return;let r=s;const a=[];for(let d=0;d<t.children.length;d++){const h=t.children[d];h.range&&a.push(h.range.startLineNumber)}const l=this.updateIndex(BC(a,e.startLineNumber,(d,h)=>d-h)),c=this.updateIndex(BC(a,e.startLineNumber+n,(d,h)=>d-h));for(let d=l;d<=c;d++){const h=t.children[d];if(!h)return;if(h.range){const u=h.range.startLineNumber,g=h.range.endLineNumber;e.startLineNumber<=g+1&&u-1<=e.endLineNumber&&u!==r&&(r=u,i.push(new gDe(u,g-1,n+1)),this.getCandidateStickyLinesIntersectingFromStickyModel(e,h,i,n+1,u))}else this.getCandidateStickyLinesIntersectingFromStickyModel(e,h,i,n,s)}}getCandidateStickyLinesIntersecting(e){if(!this._model?.element)return[];let t=[];this.getCandidateStickyLinesIntersectingFromStickyModel(e,this._model.element,t,0,-1);const i=this._editor._getViewModel()?.getHiddenAreas();if(i)for(const n of i)t=t.filter(s=>!(s.startLineNumber>=n.startLineNumber&&s.endLineNumber<=n.endLineNumber+1));return t}};GF=uDe([E6(1,ue),E6(2,li)],GF);var fDe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Rp=function(o,e){return function(t,i){e(t,i,o)}},$F,df;let td=(df=class extends F{constructor(e,t,i,n,s,r,a){super(),this._editor=e,this._contextMenuService=t,this._languageFeaturesService=i,this._instaService=n,this._contextKeyService=a,this._sessionStore=new $,this._maxStickyLines=Number.MAX_SAFE_INTEGER,this._candidateDefinitionsLength=-1,this._focusedStickyElementIndex=-1,this._enabled=!1,this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1,this._endLineNumbers=[],this._stickyScrollWidget=new cDe(this._editor),this._stickyLineCandidateProvider=new GF(this._editor,i,s),this._register(this._stickyScrollWidget),this._register(this._stickyLineCandidateProvider),this._widgetState=mC.Empty,this._onDidResize(),this._readConfiguration();const l=this._stickyScrollWidget.getDomNode();this._register(this._editor.onDidChangeConfiguration(d=>{this._readConfigurationChange(d)})),this._register(H(l,ee.CONTEXT_MENU,async d=>{this._onContextMenu(xe(l),d)})),this._stickyScrollFocusedContextKey=T.stickyScrollFocused.bindTo(this._contextKeyService),this._stickyScrollVisibleContextKey=T.stickyScrollVisible.bindTo(this._contextKeyService);const c=this._register(Ia(l));this._register(c.onDidBlur(d=>{this._positionRevealed===!1&&l.clientHeight===0?(this._focusedStickyElementIndex=-1,this.focus()):this._disposeFocusStickyScrollStore()})),this._register(c.onDidFocus(d=>{this.focus()})),this._registerMouseListeners(),this._register(H(l,ee.MOUSE_DOWN,d=>{this._onMouseDown=!0}))}static get(e){return e.getContribution($F.ID)}_disposeFocusStickyScrollStore(){this._stickyScrollFocusedContextKey.set(!1),this._focusDisposableStore?.dispose(),this._focused=!1,this._positionRevealed=!1,this._onMouseDown=!1}focus(){if(this._onMouseDown){this._onMouseDown=!1,this._editor.focus();return}this._stickyScrollFocusedContextKey.get()!==!0&&(this._focused=!0,this._focusDisposableStore=new $,this._stickyScrollFocusedContextKey.set(!0),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumbers.length-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}focusNext(){this._focusedStickyElementIndex<this._stickyScrollWidget.lineNumberCount-1&&this._focusNav(!0)}focusPrevious(){this._focusedStickyElementIndex>0&&this._focusNav(!1)}selectEditor(){this._editor.focus()}_focusNav(e){this._focusedStickyElementIndex=e?this._focusedStickyElementIndex+1:this._focusedStickyElementIndex-1,this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex)}goToFocused(){const e=this._stickyScrollWidget.lineNumbers;this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:e[this._focusedStickyElementIndex],column:1})}_revealPosition(e){this._reveaInEditor(e,()=>this._editor.revealPosition(e))}_revealLineInCenterIfOutsideViewport(e){this._reveaInEditor(e,()=>this._editor.revealLineInCenterIfOutsideViewport(e.lineNumber,0))}_reveaInEditor(e,t){this._focused&&this._disposeFocusStickyScrollStore(),this._positionRevealed=!0,t(),this._editor.setSelection(L.fromPositions(e)),this._editor.focus()}_registerMouseListeners(){const e=this._register(new $),t=this._register(new yD(this._editor,{extractLineNumberFromMouseEvent:s=>{const r=this._stickyScrollWidget.getEditorPositionFromNode(s.target.element);return r?r.lineNumber:0}})),i=s=>{if(!this._editor.hasModel()||s.target.type!==12||s.target.detail!==this._stickyScrollWidget.getId())return null;const r=s.target.element;if(!r||r.innerText!==r.innerHTML)return null;const a=this._stickyScrollWidget.getEditorPositionFromNode(r);return a?{range:new L(a.lineNumber,a.column,a.lineNumber,a.column+r.innerText.length),textElement:r}:null},n=this._stickyScrollWidget.getDomNode();this._register(ci(n,ee.CLICK,s=>{if(s.ctrlKey||s.altKey||s.metaKey||!s.leftButton)return;if(s.shiftKey){const c=this._stickyScrollWidget.getLineIndexFromChildDomNode(s.target);if(c===null)return;const d=new A(this._endLineNumbers[c],1);this._revealLineInCenterIfOutsideViewport(d);return}if(this._stickyScrollWidget.isInFoldingIconDomNode(s.target)){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(s.target);this._toggleFoldingRegionForLine(c);return}if(!this._stickyScrollWidget.isInStickyLine(s.target))return;let l=this._stickyScrollWidget.getEditorPositionFromNode(s.target);if(!l){const c=this._stickyScrollWidget.getLineNumberFromChildDomNode(s.target);if(c===null)return;l=new A(c,1)}this._revealPosition(l)})),this._register(ci(n,ee.MOUSE_MOVE,s=>{if(s.shiftKey){const r=this._stickyScrollWidget.getLineIndexFromChildDomNode(s.target);if(r===null||this._showEndForLine!==null&&this._showEndForLine===r)return;this._showEndForLine=r,this._renderStickyScroll();return}this._showEndForLine!==void 0&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._register(H(n,ee.MOUSE_LEAVE,s=>{this._showEndForLine!==void 0&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._register(t.onMouseMoveOrRelevantKeyDown(([s,r])=>{const a=i(s);if(!a||!s.hasTriggerModifier||!this._editor.hasModel()){e.clear();return}const{range:l,textElement:c}=a;if(!l.equalsRange(this._stickyRangeProjectedOnEditor))this._stickyRangeProjectedOnEditor=l,e.clear();else if(c.style.textDecoration==="underline")return;const d=new ri;e.add(ve(()=>d.dispose(!0)));let h;iS(this._languageFeaturesService.definitionProvider,this._editor.getModel(),new A(l.startLineNumber,l.startColumn+1),!1,d.token).then(u=>{if(!d.token.isCancellationRequested)if(u.length!==0){this._candidateDefinitionsLength=u.length;const g=c;h!==g?(e.clear(),h=g,h.style.textDecoration="underline",e.add(ve(()=>{h.style.textDecoration="none"}))):h||(h=g,h.style.textDecoration="underline",e.add(ve(()=>{h.style.textDecoration="none"})))}else e.clear()})})),this._register(t.onCancel(()=>{e.clear()})),this._register(t.onExecute(async s=>{if(s.target.type!==12||s.target.detail!==this._stickyScrollWidget.getId())return;const r=this._stickyScrollWidget.getEditorPositionFromNode(s.target.element);r&&(!this._editor.hasModel()||!this._stickyRangeProjectedOnEditor||(this._candidateDefinitionsLength>1&&(this._focused&&this._disposeFocusStickyScrollStore(),this._revealPosition({lineNumber:r.lineNumber,column:1})),this._instaService.invokeFunction(iZ,s,this._editor,{uri:this._editor.getModel().uri,range:this._stickyRangeProjectedOnEditor})))}))}_onContextMenu(e,t){const i=new Mr(e,t);this._contextMenuService.showContextMenu({menuId:fe.StickyScrollContext,getAnchor:()=>i})}_toggleFoldingRegionForLine(e){if(!this._foldingModel||e===null)return;const t=this._stickyScrollWidget.getRenderedStickyLine(e),i=t?.foldingIcon;if(!i)return;RW(this._foldingModel,Number.MAX_VALUE,[e]),i.isCollapsed=!i.isCollapsed;const n=(i.isCollapsed?this._editor.getTopForLineNumber(i.foldingEndLine):this._editor.getTopForLineNumber(i.foldingStartLine))-this._editor.getOption(67)*t.index+1;this._editor.setScrollTop(n),this._renderStickyScroll(e)}_readConfiguration(){const e=this._editor.getOption(116);if(e.enabled===!1){this._editor.removeOverlayWidget(this._stickyScrollWidget),this._sessionStore.clear(),this._enabled=!1;return}else e.enabled&&!this._enabled&&(this._editor.addOverlayWidget(this._stickyScrollWidget),this._sessionStore.add(this._editor.onDidScrollChange(i=>{i.scrollTopChanged&&(this._showEndForLine=void 0,this._renderStickyScroll())})),this._sessionStore.add(this._editor.onDidLayoutChange(()=>this._onDidResize())),this._sessionStore.add(this._editor.onDidChangeModelTokens(i=>this._onTokensChange(i))),this._sessionStore.add(this._stickyLineCandidateProvider.onDidChangeStickyScroll(()=>{this._showEndForLine=void 0,this._renderStickyScroll()})),this._enabled=!0);this._editor.getOption(68).renderType===2&&this._sessionStore.add(this._editor.onDidChangeCursorPosition(()=>{this._showEndForLine=void 0,this._renderStickyScroll(0)}))}_readConfigurationChange(e){(e.hasChanged(116)||e.hasChanged(73)||e.hasChanged(67)||e.hasChanged(111)||e.hasChanged(68))&&this._readConfiguration(),e.hasChanged(68)&&this._renderStickyScroll(0)}_needsUpdate(e){const t=this._stickyScrollWidget.getCurrentLines();for(const i of t)for(const n of e.ranges)if(i>=n.fromLineNumber&&i<=n.toLineNumber)return!0;return!1}_onTokensChange(e){this._needsUpdate(e)&&this._renderStickyScroll(0)}_onDidResize(){const t=this._editor.getLayoutInfo().height/this._editor.getOption(67);this._maxStickyLines=Math.round(t*.25)}async _renderStickyScroll(e){const t=this._editor.getModel();if(!t||t.isTooLargeForTokenization()){this._resetState();return}const i=this._updateAndGetMinRebuildFromLine(e),n=this._stickyLineCandidateProvider.getVersionId();if(n===void 0||n===t.getVersionId())if(!this._focused)await this._updateState(i);else if(this._focusedStickyElementIndex===-1)await this._updateState(i),this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1,this._focusedStickyElementIndex!==-1&&this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex);else{const r=this._stickyScrollWidget.lineNumbers[this._focusedStickyElementIndex];await this._updateState(i),this._stickyScrollWidget.lineNumberCount===0?this._focusedStickyElementIndex=-1:(this._stickyScrollWidget.lineNumbers.includes(r)||(this._focusedStickyElementIndex=this._stickyScrollWidget.lineNumberCount-1),this._stickyScrollWidget.focusLineWithIndex(this._focusedStickyElementIndex))}}_updateAndGetMinRebuildFromLine(e){if(e!==void 0){const t=this._minRebuildFromLine!==void 0?this._minRebuildFromLine:1/0;this._minRebuildFromLine=Math.min(e,t)}return this._minRebuildFromLine}async _updateState(e){this._minRebuildFromLine=void 0,this._foldingModel=await $h.get(this._editor)?.getFoldingModel()??void 0,this._widgetState=this.findScrollWidgetState();const t=this._widgetState.startLineNumbers.length>0;this._stickyScrollVisibleContextKey.set(t),this._stickyScrollWidget.setState(this._widgetState,this._foldingModel,e)}async _resetState(){this._minRebuildFromLine=void 0,this._foldingModel=void 0,this._widgetState=mC.Empty,this._stickyScrollVisibleContextKey.set(!1),this._stickyScrollWidget.setState(void 0,void 0)}findScrollWidgetState(){const e=this._editor.getOption(67),t=Math.min(this._maxStickyLines,this._editor.getOption(116).maxLineCount),i=this._editor.getScrollTop();let n=0;const s=[],r=[],a=this._editor.getVisibleRanges();if(a.length!==0){const l=new _C(a[0].startLineNumber,a[a.length-1].endLineNumber),c=this._stickyLineCandidateProvider.getCandidateStickyLinesIntersecting(l);for(const d of c){const h=d.startLineNumber,u=d.endLineNumber,g=d.nestingDepth;if(u-h>0){const f=(g-1)*e,m=g*e,_=this._editor.getBottomForLineNumber(h)-i,b=this._editor.getTopForLineNumber(u)-i,v=this._editor.getBottomForLineNumber(u)-i;if(f>b&&f<=v){s.push(h),r.push(u+1),n=v-m;break}else m>_&&m<=v&&(s.push(h),r.push(u+1));if(s.length===t)break}}}return this._endLineNumbers=r,new mC(s,r,n,this._showEndForLine)}dispose(){super.dispose(),this._sessionStore.dispose()}},$F=df,df.ID="store.contrib.stickyScrollController",df);td=$F=fDe([Rp(1,co),Rp(2,ue),Rp(3,Ce),Rp(4,li),Rp(5,Uo),Rp(6,Ee)],td);class pDe extends _s{constructor(){super({id:"editor.action.toggleStickyScroll",title:{...De("toggleEditorStickyScroll","Toggle Editor Sticky Scroll"),mnemonicTitle:p({key:"mitoggleStickyScroll",comment:["&& denotes a mnemonic"]},"&&Toggle Editor Sticky Scroll")},metadata:{description:De("toggleEditorStickyScroll.description","Toggle/enable the editor sticky scroll which shows the nested scopes at the top of the viewport")},category:aDe.View,toggled:{condition:K.equals("config.editor.stickyScroll.enabled",!0),title:p("stickyScroll","Sticky Scroll"),mnemonicTitle:p({key:"miStickyScroll",comment:["&& denotes a mnemonic"]},"&&Sticky Scroll")},menu:[{id:fe.CommandPalette},{id:fe.MenubarAppearanceMenu,group:"4_editor",order:3},{id:fe.StickyScrollContext}]})}async run(e){const t=e.get(Ke),i=!t.getValue("editor.stickyScroll.enabled");return t.updateValue("editor.stickyScroll.enabled",i)}}const PD=100;class mDe extends Fa{constructor(){super({id:"editor.action.focusStickyScroll",title:{...De("focusStickyScroll","Focus on the editor sticky scroll"),mnemonicTitle:p({key:"mifocusStickyScroll",comment:["&& denotes a mnemonic"]},"&&Focus Sticky Scroll")},precondition:K.and(K.has("config.editor.stickyScroll.enabled"),T.stickyScrollVisible),menu:[{id:fe.CommandPalette}]})}runEditorCommand(e,t){td.get(t)?.focus()}}class _De extends Fa{constructor(){super({id:"editor.action.selectNextStickyScrollLine",title:De("selectNextStickyScrollLine.title","Select the next editor sticky scroll line"),precondition:T.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:PD,primary:18}})}runEditorCommand(e,t){td.get(t)?.focusNext()}}class bDe extends Fa{constructor(){super({id:"editor.action.selectPreviousStickyScrollLine",title:De("selectPreviousStickyScrollLine.title","Select the previous sticky scroll line"),precondition:T.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:PD,primary:16}})}runEditorCommand(e,t){td.get(t)?.focusPrevious()}}class vDe extends Fa{constructor(){super({id:"editor.action.goToFocusedStickyScrollLine",title:De("goToFocusedStickyScrollLine.title","Go to the focused sticky scroll line"),precondition:T.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:PD,primary:3}})}runEditorCommand(e,t){td.get(t)?.goToFocused()}}class CDe extends Fa{constructor(){super({id:"editor.action.selectEditor",title:De("selectEditor.title","Select Editor"),precondition:T.stickyScrollFocused.isEqualTo(!0),keybinding:{weight:PD,primary:9}})}runEditorCommand(e,t){td.get(t)?.selectEditor()}}at(td.ID,td,1);At(pDe);At(mDe);At(bDe);At(_De);At(vDe);At(CDe);var nY=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Nv=function(o,e){return function(t,i){e(t,i,o)}};class yDe{constructor(e,t,i,n,s,r){this.range=e,this.insertText=t,this.filterText=i,this.additionalTextEdits=n,this.command=s,this.completion=r}}let KF=class extends jX{constructor(e,t,i,n,s,r){super(s.disposable),this.model=e,this.line=t,this.word=i,this.completionModel=n,this._suggestMemoryService=r}canBeReused(e,t,i){return this.model===e&&this.line===t&&this.word.word.length>0&&this.word.startColumn===i.startColumn&&this.word.endColumn<i.endColumn&&this.completionModel.getIncompleteProvider().size===0}get items(){const e=[],{items:t}=this.completionModel,i=this._suggestMemoryService.select(this.model,{lineNumber:this.line,column:this.word.endColumn+this.completionModel.lineContext.characterCountDelta},t),n=nt.slice(t,i),s=nt.slice(t,0,i);let r=5;for(const a of nt.concat(n,s)){if(a.score===ka.Default)continue;const l=new L(a.editStart.lineNumber,a.editStart.column,a.editInsertEnd.lineNumber,a.editInsertEnd.column+this.completionModel.lineContext.characterCountDelta),c=a.completion.insertTextRules&&a.completion.insertTextRules&4?{snippet:a.completion.insertText}:a.completion.insertText;e.push(new yDe(l,c,a.filterTextLow??a.labelLow,a.completion.additionalTextEdits,a.completion.command,a)),r-->=0&&a.resolve(He.None)}return e}};KF=nY([Nv(5,TD)],KF);let jF=class extends F{constructor(e,t,i,n){super(),this._languageFeatureService=e,this._clipboardService=t,this._suggestMemoryService=i,this._editorService=n,this._store.add(e.inlineCompletionsProvider.register("*",this))}async provideInlineCompletions(e,t,i,n){if(i.selectedSuggestionInfo)return;let s;for(const g of this._editorService.listCodeEditors())if(g.getModel()===e){s=g;break}if(!s)return;const r=s.getOption(90);if(dm.isAllOff(r))return;e.tokenization.tokenizeIfCheap(t.lineNumber);const a=e.tokenization.getLineTokens(t.lineNumber),l=a.getStandardTokenType(a.findTokenIndexAtOffset(Math.max(t.column-1-1,0)));if(dm.valueFor(r,l)!=="inline")return;let c=e.getWordAtPosition(t),d;if(c?.word||(d=this._getTriggerCharacterInfo(e,t)),!c?.word&&!d||(c||(c=e.getWordUntilPosition(t)),c.endColumn!==t.column))return;let h;const u=e.getValueInRange(new L(t.lineNumber,1,t.lineNumber,t.column));if(!d&&this._lastResult?.canBeReused(e,t.lineNumber,c)){const g=new u6(u,t.column-this._lastResult.word.endColumn);this._lastResult.completionModel.lineContext=g,this._lastResult.acquire(),h=this._lastResult}else{const g=await FW(this._languageFeatureService.completionProvider,e,t,new nw(void 0,KL.createSuggestFilter(s).itemKind,d?.providers),d&&{triggerKind:1,triggerCharacter:d.ch},n);let f;g.needsClipboard&&(f=await this._clipboardService.readText());const m=new Bd(g.items,t.column,new u6(u,0),$L.None,s.getOption(119),s.getOption(113),{boostFullMatch:!1,firstMatchCanBeWeak:!1},f);h=new KF(e,t.lineNumber,c,m,g,this._suggestMemoryService)}return this._lastResult=h,h}handleItemDidShow(e,t){t.completion.resolve(He.None)}freeInlineCompletions(e){e.release()}_getTriggerCharacterInfo(e,t){const i=e.getValueInRange(L.fromPositions({lineNumber:t.lineNumber,column:t.column-1},t)),n=new Set;for(const s of this._languageFeatureService.completionProvider.all(e))s.triggerCharacters?.includes(i)&&n.add(s);if(n.size!==0)return{providers:n,ch:i}}};jF=nY([Nv(0,ue),Nv(1,ad),Nv(2,TD),Nv(3,gt)],jF);vb(jF);class wDe extends de{constructor(){super({id:"editor.action.forceRetokenize",label:p("forceRetokenize","Developer: Force Retokenize"),alias:"Developer: Force Retokenize",precondition:void 0})}run(e,t){if(!t.hasModel())return;const i=t.getModel();i.tokenization.resetTokenization();const n=new rn;i.tokenization.forceTokenization(i.getLineCount()),n.stop(),console.log(`tokenization took ${n.elapsed()}`)}}X(wDe);const WE=class WE extends _s{constructor(){super({id:WE.ID,title:De({key:"toggle.tabMovesFocus",comment:["Turn on/off use of tab key for moving focus around VS Code"]},"Toggle Tab Key Moves Focus"),precondition:void 0,keybinding:{primary:2091,mac:{primary:1323},weight:100},metadata:{description:De("tabMovesFocusDescriptions","Determines whether the tab key moves focus around the workbench or inserts the tab character in the current editor. This is also called tab trapping, tab navigation, or tab focus mode.")},f1:!0})}run(){const t=!M_.getTabFocusMode();M_.setTabFocusMode(t),ps(t?p("toggle.tabMovesFocus.on","Pressing Tab will now move focus to the next focusable element"):p("toggle.tabMovesFocus.off","Pressing Tab will now insert the tab character"))}};WE.ID="editor.action.toggleTabFocusMode";let qF=WE;At(qF);var SDe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},T6=function(o,e){return function(t,i){e(t,i,o)}};let ZF=class extends F{get enabled(){return this._enabled}set enabled(e){e?(this.el.setAttribute("aria-disabled","false"),this.el.tabIndex=0,this.el.style.pointerEvents="auto",this.el.style.opacity="1",this.el.style.cursor="pointer",this._enabled=!1):(this.el.setAttribute("aria-disabled","true"),this.el.tabIndex=-1,this.el.style.pointerEvents="none",this.el.style.opacity="0.4",this.el.style.cursor="default",this._enabled=!0),this._enabled=e}constructor(e,t,i={},n,s){super(),this._link=t,this._hoverService=n,this._enabled=!0,this.el=Y(e,ie("a.monaco-link",{tabIndex:t.tabIndex??0,href:t.href},t.label)),this.hoverDelegate=i.hoverDelegate??bs("mouse"),this.setTooltip(t.title),this.el.setAttribute("role","button");const r=this._register(new et(this.el,"click")),a=this._register(new et(this.el,"keypress")),l=se.chain(a.event,h=>h.map(u=>new Pt(u)).filter(u=>u.keyCode===3)),c=this._register(new et(this.el,Ot.Tap)).event;this._register(Mn.addTarget(this.el));const d=se.any(r.event,l,c);this._register(d(h=>{this.enabled&&(tt.stop(h,!0),i?.opener?i.opener(this._link.href):s.open(this._link.href,{allowCommands:!0}))})),this.enabled=!0}setTooltip(e){this.hoverDelegate.showNativeHover?this.el.title=e??"":!this.hover&&e?this.hover=this._register(this._hoverService.setupManagedHover(this.hoverDelegate,this.el,e)):this.hover&&this.hover.update(e)}};ZF=SDe([T6(3,zl),T6(4,Fs)],ZF);var sY=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},oY=function(o,e){return function(t,i){e(t,i,o)}};const xDe=26;let YF=class extends F{constructor(e,t){super(),this._editor=e,this.instantiationService=t,this.banner=this._register(this.instantiationService.createInstance(XF))}hide(){this._editor.setBanner(null,0),this.banner.clear()}show(e){this.banner.show({...e,onClose:()=>{this.hide(),e.onClose?.()}}),this._editor.setBanner(this.banner.element,xDe)}};YF=sY([oY(1,Ce)],YF);let XF=class extends F{constructor(e){super(),this.instantiationService=e,this.markdownRenderer=this.instantiationService.createInstance(Zc,{}),this.element=ie("div.editor-banner"),this.element.tabIndex=0}getAriaLabel(e){if(e.ariaLabel)return e.ariaLabel;if(typeof e.message=="string")return e.message}getBannerMessage(e){if(typeof e=="string"){const t=ie("span");return t.innerText=e,t}return this.markdownRenderer.render(e).element}clear(){fn(this.element)}show(e){fn(this.element);const t=this.getAriaLabel(e);t&&this.element.setAttribute("aria-label",t);const i=Y(this.element,ie("div.icon-container"));i.setAttribute("aria-hidden","true"),e.icon&&i.appendChild(ie(`div${ke.asCSSSelector(e.icon)}`));const n=Y(this.element,ie("div.message-container"));if(n.setAttribute("aria-hidden","true"),n.appendChild(this.getBannerMessage(e.message)),this.messageActionsContainer=Y(this.element,ie("div.message-actions-container")),e.actions)for(const r of e.actions)this._register(this.instantiationService.createInstance(ZF,this.messageActionsContainer,{...r,tabIndex:-1},{}));const s=Y(this.element,ie("div.action-container"));this.actionBar=this._register(new Oo(s)),this.actionBar.push(this._register(new to("banner.close","Close Banner",ke.asClassName(LK),!0,()=>{typeof e.onClose=="function"&&e.onClose()})),{icon:!0,label:!1}),this.actionBar.setFocusable(!1)}};XF=sY([oY(0,Ce)],XF);var XW=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},e_=function(o,e){return function(t,i){e(t,i,o)}};const LDe=Gt("extensions-warning-message",J.warning,p("warningIcon","Icon shown with a warning message in the extensions editor."));var h_;let gw=(h_=class extends F{constructor(e,t,i,n){super(),this._editor=e,this._editorWorkerService=t,this._workspaceTrustService=i,this._highlighter=null,this._bannerClosed=!1,this._updateState=s=>{if(s&&s.hasMore){if(this._bannerClosed)return;const r=Math.max(s.ambiguousCharacterCount,s.nonBasicAsciiCharacterCount,s.invisibleCharacterCount);let a;if(s.nonBasicAsciiCharacterCount>=r)a={message:p("unicodeHighlighting.thisDocumentHasManyNonBasicAsciiUnicodeCharacters","This document contains many non-basic ASCII unicode characters"),command:new pw};else if(s.ambiguousCharacterCount>=r)a={message:p("unicodeHighlighting.thisDocumentHasManyAmbiguousUnicodeCharacters","This document contains many ambiguous unicode characters"),command:new zf};else if(s.invisibleCharacterCount>=r)a={message:p("unicodeHighlighting.thisDocumentHasManyInvisibleUnicodeCharacters","This document contains many invisible unicode characters"),command:new fw};else throw new Error("Unreachable");this._bannerController.show({id:"unicodeHighlightBanner",message:a.message,icon:LDe,actions:[{label:a.command.shortLabel,href:`command:${a.command.id}`}],onClose:()=>{this._bannerClosed=!0}})}else this._bannerController.hide()},this._bannerController=this._register(n.createInstance(YF,e)),this._register(this._editor.onDidChangeModel(()=>{this._bannerClosed=!1,this._updateHighlighter()})),this._options=e.getOption(126),this._register(i.onDidChangeTrust(s=>{this._updateHighlighter()})),this._register(e.onDidChangeConfiguration(s=>{s.hasChanged(126)&&(this._options=e.getOption(126),this._updateHighlighter())})),this._updateHighlighter()}dispose(){this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),super.dispose()}_updateHighlighter(){if(this._updateState(null),this._highlighter&&(this._highlighter.dispose(),this._highlighter=null),!this._editor.hasModel())return;const e=kDe(this._workspaceTrustService.isWorkspaceTrusted(),this._options);if([e.nonBasicASCII,e.ambiguousCharacters,e.invisibleCharacters].every(i=>i===!1))return;const t={nonBasicASCII:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments,includeStrings:e.includeStrings,allowedCodePoints:Object.keys(e.allowedCharacters).map(i=>i.codePointAt(0)),allowedLocales:Object.keys(e.allowedLocales).map(i=>i==="_os"?new Intl.NumberFormat().resolvedOptions().locale:i==="_vscode"?$Y:i)};this._editorWorkerService.canComputeUnicodeHighlights(this._editor.getModel().uri)?this._highlighter=new QF(this._editor,t,this._updateState,this._editorWorkerService):this._highlighter=new EDe(this._editor,t,this._updateState)}getDecorationInfo(e){return this._highlighter?this._highlighter.getDecorationInfo(e):null}},h_.ID="editor.contrib.unicodeHighlighter",h_);gw=XW([e_(1,Bs),e_(2,HG),e_(3,Ce)],gw);function kDe(o,e){return{nonBasicASCII:e.nonBasicASCII===vo?!o:e.nonBasicASCII,ambiguousCharacters:e.ambiguousCharacters,invisibleCharacters:e.invisibleCharacters,includeComments:e.includeComments===vo?!o:e.includeComments,includeStrings:e.includeStrings===vo?!o:e.includeStrings,allowedCharacters:e.allowedCharacters,allowedLocales:e.allowedLocales}}let QF=class extends F{constructor(e,t,i,n){super(),this._editor=e,this._options=t,this._updateState=i,this._editorWorkerService=n,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new xt(()=>this._update(),250)),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._model.getVersionId();this._editorWorkerService.computedUnicodeHighlights(this._model.uri,this._options).then(t=>{if(this._model.isDisposed()||this._model.getVersionId()!==e)return;this._updateState(t);const i=[];if(!t.hasMore)for(const n of t.ranges)i.push({range:n,options:lk.instance.getDecorationFromOptions(this._options)});this._decorations.set(i)})}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel();if(!WB(t,e))return null;const i=t.getValueInRange(e.range);return{reason:aY(i,this._options),inComment:VB(t,e),inString:HB(t,e)}}};QF=XW([e_(3,Bs)],QF);class EDe extends F{constructor(e,t,i){super(),this._editor=e,this._options=t,this._updateState=i,this._model=this._editor.getModel(),this._decorations=this._editor.createDecorationsCollection(),this._updateSoon=this._register(new xt(()=>this._update(),250)),this._register(this._editor.onDidLayoutChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidScrollChange(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeHiddenAreas(()=>{this._updateSoon.schedule()})),this._register(this._editor.onDidChangeModelContent(()=>{this._updateSoon.schedule()})),this._updateSoon.schedule()}dispose(){this._decorations.clear(),super.dispose()}_update(){if(this._model.isDisposed())return;if(!this._model.mightContainNonBasicASCII()){this._decorations.clear();return}const e=this._editor.getVisibleRanges(),t=[],i={ranges:[],ambiguousCharacterCount:0,invisibleCharacterCount:0,nonBasicAsciiCharacterCount:0,hasMore:!1};for(const n of e){const s=Q4.computeUnicodeHighlights(this._model,this._options,n);for(const r of s.ranges)i.ranges.push(r);i.ambiguousCharacterCount+=i.ambiguousCharacterCount,i.invisibleCharacterCount+=i.invisibleCharacterCount,i.nonBasicAsciiCharacterCount+=i.nonBasicAsciiCharacterCount,i.hasMore=i.hasMore||s.hasMore}if(!i.hasMore)for(const n of i.ranges)t.push({range:n,options:lk.instance.getDecorationFromOptions(this._options)});this._updateState(i),this._decorations.set(t)}getDecorationInfo(e){if(!this._decorations.has(e))return null;const t=this._editor.getModel(),i=t.getValueInRange(e.range);return WB(t,e)?{reason:aY(i,this._options),inComment:VB(t,e),inString:HB(t,e)}:null}}const rY=p("unicodeHighlight.configureUnicodeHighlightOptions","Configure Unicode Highlight Options");let JF=class{constructor(e,t,i){this._editor=e,this._languageService=t,this._openerService=i,this.hoverOrdinal=5}computeSync(e,t){if(!this._editor.hasModel()||e.type!==1)return[];const i=this._editor.getModel(),n=this._editor.getContribution(gw.ID);if(!n)return[];const s=[],r=new Set;let a=300;for(const l of t){const c=n.getDecorationInfo(l);if(!c)continue;const h=i.getValueInRange(l.range).codePointAt(0),u=BN(h);let g;switch(c.reason.kind){case 0:{Sw(c.reason.confusableWith)?g=p("unicodeHighlight.characterIsAmbiguousASCII","The character {0} could be confused with the ASCII character {1}, which is more common in source code.",u,BN(c.reason.confusableWith.codePointAt(0))):g=p("unicodeHighlight.characterIsAmbiguous","The character {0} could be confused with the character {1}, which is more common in source code.",u,BN(c.reason.confusableWith.codePointAt(0)));break}case 1:g=p("unicodeHighlight.characterIsInvisible","The character {0} is invisible.",u);break;case 2:g=p("unicodeHighlight.characterIsNonBasicAscii","The character {0} is not a basic ASCII character.",u);break}if(r.has(g))continue;r.add(g);const f={codePoint:h,reason:c.reason,inComment:c.inComment,inString:c.inString},m=p("unicodeHighlight.adjustSettings","Adjust settings"),_=`command:${ck.ID}?${encodeURIComponent(JSON.stringify(f))}`,b=new Pn("",!0).appendMarkdown(g).appendText(" ").appendLink(_,m,rY);s.push(new Ar(this,l.range,[b],!1,a++))}return s}renderHoverParts(e,t){return i1e(e,t,this._editor,this._languageService,this._openerService)}};JF=XW([e_(1,ti),e_(2,Fs)],JF);function e4(o){return`U+${o.toString(16).padStart(4,"0")}`}function BN(o){let e=`\`${e4(o)}\``;return og.isInvisibleCharacter(o)||(e+=` "${`${TDe(o)}`}"`),e}function TDe(o){return o===96?"`` ` ``":"`"+String.fromCodePoint(o)+"`"}function aY(o,e){return Q4.computeUnicodeHighlightReason(o,e)}const VE=class VE{constructor(){this.map=new Map}getDecorationFromOptions(e){return this.getDecoration(!e.includeComments,!e.includeStrings)}getDecoration(e,t){const i=`${e}${t}`;let n=this.map.get(i);return n||(n=Fe.createDynamic({description:"unicode-highlight",stickiness:1,className:"unicode-highlight",showIfCollapsed:!0,overviewRuler:null,minimap:null,hideInCommentTokens:e,hideInStringTokens:t}),this.map.set(i,n)),n}};VE.instance=new VE;let lk=VE;class DDe extends de{constructor(){super({id:zf.ID,label:p("action.unicodeHighlight.disableHighlightingInComments","Disable highlighting of characters in comments"),alias:"Disable highlighting of characters in comments",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingInComments.shortLabel","Disable Highlight In Comments")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(xs.includeComments,!1,2)}}class IDe extends de{constructor(){super({id:zf.ID,label:p("action.unicodeHighlight.disableHighlightingInStrings","Disable highlighting of characters in strings"),alias:"Disable highlighting of characters in strings",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingInStrings.shortLabel","Disable Highlight In Strings")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(xs.includeStrings,!1,2)}}const HE=class HE extends de{constructor(){super({id:HE.ID,label:p("action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","Disable highlighting of ambiguous characters"),alias:"Disable highlighting of ambiguous characters",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingOfAmbiguousCharacters.shortLabel","Disable Ambiguous Highlight")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(xs.ambiguousCharacters,!1,2)}};HE.ID="editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters";let zf=HE;const zE=class zE extends de{constructor(){super({id:zE.ID,label:p("action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","Disable highlighting of invisible characters"),alias:"Disable highlighting of invisible characters",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingOfInvisibleCharacters.shortLabel","Disable Invisible Highlight")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(xs.invisibleCharacters,!1,2)}};zE.ID="editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters";let fw=zE;const UE=class UE extends de{constructor(){super({id:UE.ID,label:p("action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","Disable highlighting of non basic ASCII characters"),alias:"Disable highlighting of non basic ASCII characters",precondition:void 0}),this.shortLabel=p("unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters.shortLabel","Disable Non ASCII Highlight")}async run(e,t,i){const n=e?.get(Ke);n&&this.runAction(n)}async runAction(e){await e.updateValue(xs.nonBasicASCII,!1,2)}};UE.ID="editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters";let pw=UE;const GE=class GE extends de{constructor(){super({id:GE.ID,label:p("action.unicodeHighlight.showExcludeOptions","Show Exclude Options"),alias:"Show Exclude Options",precondition:void 0})}async run(e,t,i){const{codePoint:n,reason:s,inString:r,inComment:a}=i,l=String.fromCodePoint(n),c=e.get(vr),d=e.get(Ke);function h(f){return og.isInvisibleCharacter(f)?p("unicodeHighlight.excludeInvisibleCharFromBeingHighlighted","Exclude {0} (invisible character) from being highlighted",e4(f)):p("unicodeHighlight.excludeCharFromBeingHighlighted","Exclude {0} from being highlighted",`${e4(f)} "${l}"`)}const u=[];if(s.kind===0)for(const f of s.notAmbiguousInLocales)u.push({label:p("unicodeHighlight.allowCommonCharactersInLanguage",'Allow unicode characters that are more common in the language "{0}".',f),run:async()=>{RDe(d,[f])}});if(u.push({label:h(n),run:()=>NDe(d,[n])}),a){const f=new DDe;u.push({label:f.label,run:async()=>f.runAction(d)})}else if(r){const f=new IDe;u.push({label:f.label,run:async()=>f.runAction(d)})}if(s.kind===0){const f=new zf;u.push({label:f.label,run:async()=>f.runAction(d)})}else if(s.kind===1){const f=new fw;u.push({label:f.label,run:async()=>f.runAction(d)})}else if(s.kind===2){const f=new pw;u.push({label:f.label,run:async()=>f.runAction(d)})}else PDe(s);const g=await c.pick(u,{title:rY});g&&await g.run()}};GE.ID="editor.action.unicodeHighlight.showExcludeOptions";let ck=GE;async function NDe(o,e){const t=o.getValue(xs.allowedCharacters);let i;typeof t=="object"&&t?i=t:i={};for(const n of e)i[String.fromCodePoint(n)]=!0;await o.updateValue(xs.allowedCharacters,i,2)}async function RDe(o,e){const t=o.inspect(xs.allowedLocales).user?.value;let i;typeof t=="object"&&t?i=Object.assign({},t):i={};for(const n of e)i[n]=!0;await o.updateValue(xs.allowedLocales,i,2)}function PDe(o){throw new Error(`Unexpected value: ${o}`)}X(zf);X(fw);X(pw);X(ck);at(gw.ID,gw,1);np.register(JF);var ADe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},D6=function(o,e){return function(t,i){e(t,i,o)}};const lY="ignoreUnusualLineTerminators";function MDe(o,e,t){o.setModelProperty(e.uri,lY,t)}function ODe(o,e){return o.getModelProperty(e.uri,lY)}var u_;let dk=(u_=class extends F{constructor(e,t,i){super(),this._editor=e,this._dialogService=t,this._codeEditorService=i,this._isPresentingDialog=!1,this._config=this._editor.getOption(127),this._register(this._editor.onDidChangeConfiguration(n=>{n.hasChanged(127)&&(this._config=this._editor.getOption(127),this._checkForUnusualLineTerminators())})),this._register(this._editor.onDidChangeModel(()=>{this._checkForUnusualLineTerminators()})),this._register(this._editor.onDidChangeModelContent(n=>{n.isUndoing||this._checkForUnusualLineTerminators()})),this._checkForUnusualLineTerminators()}async _checkForUnusualLineTerminators(){if(this._config==="off"||!this._editor.hasModel())return;const e=this._editor.getModel();if(!e.mightContainUnusualLineTerminators()||ODe(this._codeEditorService,e)===!0||this._editor.getOption(92))return;if(this._config==="auto"){e.removeUnusualLineTerminators(this._editor.getSelections());return}if(this._isPresentingDialog)return;let i;try{this._isPresentingDialog=!0,i=await this._dialogService.confirm({title:p("unusualLineTerminators.title","Unusual Line Terminators"),message:p("unusualLineTerminators.message","Detected unusual line terminators"),detail:p("unusualLineTerminators.detail","The file '{0}' contains one or more unusual line terminator characters, like Line Separator (LS) or Paragraph Separator (PS).\n\nIt is recommended to remove them from the file. This can be configured via `editor.unusualLineTerminators`.",fr(e.uri)),primaryButton:p({key:"unusualLineTerminators.fix",comment:["&& denotes a mnemonic"]},"&&Remove Unusual Line Terminators"),cancelButton:p("unusualLineTerminators.ignore","Ignore")})}finally{this._isPresentingDialog=!1}if(!i.confirmed){MDe(this._codeEditorService,e,!0);return}e.removeUnusualLineTerminators(this._editor.getSelections())}},u_.ID="editor.contrib.unusualLineTerminatorsDetector",u_);dk=ADe([D6(1,Tw),D6(2,gt)],dk);at(dk.ID,dk,1);var FDe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},BDe=function(o,e){return function(t,i){e(t,i,o)}};class I6{constructor(){this.selector={language:"*"}}provideDocumentHighlights(e,t,i){const n=[],s=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});return s?e.isDisposed()?void 0:e.findMatches(s.word,!0,!1,!0,b0,!1).map(a=>({range:a.range,kind:f_.Text})):Promise.resolve(n)}provideMultiDocumentHighlights(e,t,i,n){const s=new on,r=e.getWordAtPosition({lineNumber:t.lineNumber,column:t.column});if(!r)return Promise.resolve(s);for(const a of[e,...i]){if(a.isDisposed())continue;const c=a.findMatches(r.word,!0,!1,!0,b0,!1).map(d=>({range:d.range,kind:f_.Text}));c&&s.set(a.uri,c)}return s}}let t4=class extends F{constructor(e){super(),this._register(e.documentHighlightProvider.register("*",new I6)),this._register(e.multiDocumentHighlightProvider.register("*",new I6))}};t4=FDe([BDe(0,ue)],t4);var cY=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},u0=function(o,e){return function(t,i){e(t,i,o)}},Si,i4;const QW=new re("hasWordHighlights",!1);function dY(o,e,t,i){const n=o.ordered(e);return B4(n.map(s=>()=>Promise.resolve(s.provideDocumentHighlights(e,t,i)).then(void 0,yi)),s=>s!=null).then(s=>{if(s){const r=new on;return r.set(e.uri,s),r}return new on})}function WDe(o,e,t,i,n,s){const r=o.ordered(e);return B4(r.map(a=>()=>{const l=s.filter(c=>EU(c)).filter(c=>a5(a.selector,c.uri,c.getLanguageId(),!0,void 0,void 0)>0);return Promise.resolve(a.provideMultiDocumentHighlights(e,t,l,n)).then(void 0,yi)}),a=>a!=null)}class hY{constructor(e,t,i){this._model=e,this._selection=t,this._wordSeparators=i,this._wordRange=this._getCurrentWordRange(e,t),this._result=null}get result(){return this._result||(this._result=ji(e=>this._compute(this._model,this._selection,this._wordSeparators,e))),this._result}_getCurrentWordRange(e,t){const i=e.getWordAtPosition(t.getPosition());return i?new L(t.startLineNumber,i.startColumn,t.startLineNumber,i.endColumn):null}isValid(e,t,i){const n=t.startLineNumber,s=t.startColumn,r=t.endColumn,a=this._getCurrentWordRange(e,t);let l=!!(this._wordRange&&this._wordRange.equalsRange(a));for(let c=0,d=i.length;!l&&c<d;c++){const h=i.getRange(c);h&&h.startLineNumber===n&&h.startColumn<=s&&h.endColumn>=r&&(l=!0)}return l}cancel(){this.result.cancel()}}class VDe extends hY{constructor(e,t,i,n){super(e,t,i),this._providers=n}_compute(e,t,i,n){return dY(this._providers,e,t.getPosition(),n).then(s=>s||new on)}}class HDe extends hY{constructor(e,t,i,n,s){super(e,t,i),this._providers=n,this._otherModels=s}_compute(e,t,i,n){return WDe(this._providers,e,t.getPosition(),i,n,this._otherModels).then(s=>s||new on)}}function zDe(o,e,t,i,n){return new VDe(e,t,n,o)}function UDe(o,e,t,i,n,s){return new HDe(e,t,n,o,s)}Os("_executeDocumentHighlights",async(o,e,t)=>{const i=o.get(ue);return(await dY(i.documentHighlightProvider,e,t,He.None))?.get(e.uri)});var xh;let n4=(xh=class{constructor(e,t,i,n,s){this.toUnhook=new $,this.workerRequestTokenId=0,this.workerRequestCompleted=!1,this.workerRequestValue=new on,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,this.runDelayer=this.toUnhook.add(new hr(50)),this.editor=e,this.providers=t,this.multiDocumentProviders=i,this.codeEditorService=s,this._hasWordHighlights=QW.bindTo(n),this._ignorePositionChangeEvent=!1,this.occurrencesHighlight=this.editor.getOption(81),this.model=this.editor.getModel(),this.toUnhook.add(e.onDidChangeCursorPosition(r=>{this._ignorePositionChangeEvent||this.occurrencesHighlight!=="off"&&this.runDelayer.trigger(()=>{this._onPositionChanged(r)})})),this.toUnhook.add(e.onDidFocusEditorText(r=>{this.occurrencesHighlight!=="off"&&(this.workerRequest||this.runDelayer.trigger(()=>{this._run()}))})),this.toUnhook.add(e.onDidChangeModelContent(r=>{iT(this.model.uri,"output")||this._stopAll()})),this.toUnhook.add(e.onDidChangeModel(r=>{!r.newModelUrl&&r.oldModelUrl?this._stopSingular():Si.query&&this._run()})),this.toUnhook.add(e.onDidChangeConfiguration(r=>{const a=this.editor.getOption(81);if(this.occurrencesHighlight!==a)switch(this.occurrencesHighlight=a,a){case"off":this._stopAll();break;case"singleFile":this._stopAll(Si.query?.modelInfo?.model);break;case"multiFile":Si.query&&this._run(!0);break;default:console.warn("Unknown occurrencesHighlight setting value:",a);break}})),this.decorations=this.editor.createDecorationsCollection(),this.workerRequestTokenId=0,this.workerRequest=null,this.workerRequestCompleted=!1,this.lastCursorPositionChangeTime=0,this.renderDecorationsTimer=-1,Si.query&&this._run()}hasDecorations(){return this.decorations.length>0}restore(){this.occurrencesHighlight!=="off"&&(this.runDelayer.cancel(),this._run())}_getSortedHighlights(){return this.decorations.getRanges().sort(L.compareRangesUsingStarts)}moveNext(){const e=this._getSortedHighlights(),i=(e.findIndex(s=>s.containsPosition(this.editor.getPosition()))+1)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const s=this._getWord();if(s){const r=this.editor.getModel().getLineContent(n.startLineNumber);ps(`${r}, ${i+1} of ${e.length} for '${s.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}moveBack(){const e=this._getSortedHighlights(),i=(e.findIndex(s=>s.containsPosition(this.editor.getPosition()))-1+e.length)%e.length,n=e[i];try{this._ignorePositionChangeEvent=!0,this.editor.setPosition(n.getStartPosition()),this.editor.revealRangeInCenterIfOutsideViewport(n);const s=this._getWord();if(s){const r=this.editor.getModel().getLineContent(n.startLineNumber);ps(`${r}, ${i+1} of ${e.length} for '${s.word}'`)}}finally{this._ignorePositionChangeEvent=!1}}_removeSingleDecorations(){if(!this.editor.hasModel())return;const e=Si.storedDecorationIDs.get(this.editor.getModel().uri);e&&(this.editor.removeDecorations(e),Si.storedDecorationIDs.delete(this.editor.getModel().uri),this.decorations.length>0&&(this.decorations.clear(),this._hasWordHighlights.set(!1)))}_removeAllDecorations(e){const t=this.codeEditorService.listCodeEditors(),i=[];for(const n of t){if(!n.hasModel()||gy(n.getModel().uri,e?.uri))continue;const s=Si.storedDecorationIDs.get(n.getModel().uri);if(!s)continue;n.removeDecorations(s),i.push(n.getModel().uri);const r=jh.get(n);r?.wordHighlighter&&r.wordHighlighter.decorations.length>0&&(r.wordHighlighter.decorations.clear(),r.wordHighlighter.workerRequest=null,r.wordHighlighter._hasWordHighlights.set(!1))}for(const n of i)Si.storedDecorationIDs.delete(n)}_stopSingular(){this._removeSingleDecorations(),this.editor.hasTextFocus()&&(this.editor.getModel()?.uri.scheme!==Oe.vscodeNotebookCell&&Si.query?.modelInfo?.model.uri.scheme!==Oe.vscodeNotebookCell?(Si.query=null,this._run()):Si.query?.modelInfo&&(Si.query.modelInfo=null)),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_stopAll(e){this._removeAllDecorations(e),this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1),this.workerRequest!==null&&(this.workerRequest.cancel(),this.workerRequest=null),this.workerRequestCompleted||(this.workerRequestTokenId++,this.workerRequestCompleted=!0)}_onPositionChanged(e){if(this.occurrencesHighlight==="off"){this._stopAll();return}if(e.reason!==3&&this.editor.getModel()?.uri.scheme!==Oe.vscodeNotebookCell){this._stopAll();return}this._run()}_getWord(){const e=this.editor.getSelection(),t=e.startLineNumber,i=e.startColumn;return this.model.isDisposed()?null:this.model.getWordAtPosition({lineNumber:t,column:i})}getOtherModelsToHighlight(e){if(!e)return[];if(e.uri.scheme===Oe.vscodeNotebookCell){const s=[],r=this.codeEditorService.listCodeEditors();for(const a of r){const l=a.getModel();l&&l!==e&&l.uri.scheme===Oe.vscodeNotebookCell&&s.push(l)}return s}const i=[],n=this.codeEditorService.listCodeEditors();for(const s of n){if(!sW(s))continue;const r=s.getModel();r&&e===r.modified&&i.push(r.modified)}if(i.length)return i;if(this.occurrencesHighlight==="singleFile")return[];for(const s of n){const r=s.getModel();r&&r!==e&&i.push(r)}return i}_run(e){let t;if(this.editor.hasTextFocus()){const n=this.editor.getSelection();if(!n||n.startLineNumber!==n.endLineNumber){Si.query=null,this._stopAll();return}const s=n.startColumn,r=n.endColumn,a=this._getWord();if(!a||a.startColumn>s||a.endColumn<r){Si.query=null,this._stopAll();return}t=this.workerRequest&&this.workerRequest.isValid(this.model,n,this.decorations),Si.query={modelInfo:{model:this.model,selection:n},word:a}}else if(!Si.query){this._stopAll();return}if(this.lastCursorPositionChangeTime=new Date().getTime(),t)this.workerRequestCompleted&&this.renderDecorationsTimer!==-1&&(clearTimeout(this.renderDecorationsTimer),this.renderDecorationsTimer=-1,this._beginRenderDecorations());else if(gy(this.editor.getModel().uri,Si.query.modelInfo?.model.uri)){if(!e){const r=this.decorations.getRanges();for(const a of r)if(a.containsPosition(this.editor.getPosition()))return}this._stopAll(e?this.model:void 0);const n=++this.workerRequestTokenId;this.workerRequestCompleted=!1;const s=this.getOtherModelsToHighlight(this.editor.getModel());if(!Si.query||!Si.query.modelInfo||Si.query.modelInfo.model.isDisposed())return;this.workerRequest=this.computeWithModel(Si.query.modelInfo.model,Si.query.modelInfo.selection,Si.query.word,s),this.workerRequest?.result.then(r=>{n===this.workerRequestTokenId&&(this.workerRequestCompleted=!0,this.workerRequestValue=r||[],this._beginRenderDecorations())},Ae)}}computeWithModel(e,t,i,n){return n.length?UDe(this.multiDocumentProviders,e,t,i,this.editor.getOption(132),n):zDe(this.providers,e,t,i,this.editor.getOption(132))}_beginRenderDecorations(){const e=new Date().getTime(),t=this.lastCursorPositionChangeTime+250;e>=t?(this.renderDecorationsTimer=-1,this.renderDecorations()):this.renderDecorationsTimer=setTimeout(()=>{this.renderDecorations()},t-e)}renderDecorations(){this.renderDecorationsTimer=-1;const e=this.codeEditorService.listCodeEditors();for(const t of e){const i=jh.get(t);if(!i)continue;const n=[],s=t.getModel()?.uri;if(s&&this.workerRequestValue.has(s)){const r=Si.storedDecorationIDs.get(s),a=this.workerRequestValue.get(s);if(a)for(const c of a)c.range&&n.push({range:c.range,options:NEe(c.kind)});let l=[];t.changeDecorations(c=>{l=c.deltaDecorations(r??[],n)}),Si.storedDecorationIDs=Si.storedDecorationIDs.set(s,l),n.length>0&&(i.wordHighlighter?.decorations.set(n),i.wordHighlighter?._hasWordHighlights.set(!0))}}}dispose(){this._stopSingular(),this.toUnhook.dispose()}},Si=xh,xh.storedDecorationIDs=new on,xh.query=null,xh);n4=Si=cY([u0(4,gt)],n4);var hf;let jh=(hf=class extends F{static get(e){return e.getContribution(i4.ID)}constructor(e,t,i,n){super(),this._wordHighlighter=null;const s=()=>{e.hasModel()&&!e.getModel().isTooLargeForTokenization()&&(this._wordHighlighter=new n4(e,i.documentHighlightProvider,i.multiDocumentHighlightProvider,t,n))};this._register(e.onDidChangeModel(r=>{this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),s()})),s()}get wordHighlighter(){return this._wordHighlighter}saveViewState(){return!!(this._wordHighlighter&&this._wordHighlighter.hasDecorations())}moveNext(){this._wordHighlighter?.moveNext()}moveBack(){this._wordHighlighter?.moveBack()}restoreViewState(e){this._wordHighlighter&&e&&this._wordHighlighter.restore()}dispose(){this._wordHighlighter&&(this._wordHighlighter.dispose(),this._wordHighlighter=null),super.dispose()}},i4=hf,hf.ID="editor.contrib.wordHighlighter",hf);jh=i4=cY([u0(1,Ee),u0(2,ue),u0(3,gt)],jh);class uY extends de{constructor(e,t){super(t),this._isNext=e}run(e,t){const i=jh.get(t);i&&(this._isNext?i.moveNext():i.moveBack())}}class GDe extends uY{constructor(){super(!0,{id:"editor.action.wordHighlight.next",label:p("wordHighlight.next.label","Go to Next Symbol Highlight"),alias:"Go to Next Symbol Highlight",precondition:QW,kbOpts:{kbExpr:T.editorTextFocus,primary:65,weight:100}})}}class $De extends uY{constructor(){super(!1,{id:"editor.action.wordHighlight.prev",label:p("wordHighlight.previous.label","Go to Previous Symbol Highlight"),alias:"Go to Previous Symbol Highlight",precondition:QW,kbOpts:{kbExpr:T.editorTextFocus,primary:1089,weight:100}})}}class KDe extends de{constructor(){super({id:"editor.action.wordHighlight.trigger",label:p("wordHighlight.trigger.label","Trigger Symbol Highlight"),alias:"Trigger Symbol Highlight",precondition:void 0,kbOpts:{kbExpr:T.editorTextFocus,primary:0,weight:100}})}run(e,t,i){const n=jh.get(t);n&&n.restoreViewState(!0)}}at(jh.ID,jh,0);X(GDe);X($De);X(KDe);vb(t4);class AD extends Hi{constructor(e){super(e),this._inSelectionMode=e.inSelectionMode,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){if(!t.hasModel())return;const n=gr(t.getOption(132),t.getOption(131)),s=t.getModel(),r=t.getSelections(),a=r.length>1,l=r.map(c=>{const d=new A(c.positionLineNumber,c.positionColumn),h=this._move(n,s,d,this._wordNavigationType,a);return this._moveTo(c,h,this._inSelectionMode)});if(s.pushStackElement(),t._getViewModel().setCursorStates("moveWordCommand",3,l.map(c=>ht.fromModelSelection(c))),l.length===1){const c=new A(l[0].positionLineNumber,l[0].positionColumn);t.revealPosition(c,0)}}_moveTo(e,t,i){return i?new pe(e.selectionStartLineNumber,e.selectionStartColumn,t.lineNumber,t.column):new pe(t.lineNumber,t.column,t.lineNumber,t.column)}}class iu extends AD{_move(e,t,i,n,s){return _t.moveWordLeft(e,t,i,n,s)}}class nu extends AD{_move(e,t,i,n,s){return _t.moveWordRight(e,t,i,n)}}class jDe extends iu{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartLeft",precondition:void 0})}}class qDe extends iu{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndLeft",precondition:void 0})}}class ZDe extends iu{constructor(){super({inSelectionMode:!1,wordNavigationType:1,id:"cursorWordLeft",precondition:void 0,kbOpts:{kbExpr:K.and(T.textInputFocus,K.and(Rw,qT)?.negate()),primary:2063,mac:{primary:527},weight:100}})}}class YDe extends iu{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartLeftSelect",precondition:void 0})}}class XDe extends iu{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndLeftSelect",precondition:void 0})}}class QDe extends iu{constructor(){super({inSelectionMode:!0,wordNavigationType:1,id:"cursorWordLeftSelect",precondition:void 0,kbOpts:{kbExpr:K.and(T.textInputFocus,K.and(Rw,qT)?.negate()),primary:3087,mac:{primary:1551},weight:100}})}}class JDe extends iu{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityLeft",precondition:void 0})}_move(e,t,i,n,s){return super._move(gr(Oa.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,s)}}class eIe extends iu{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityLeftSelect",precondition:void 0})}_move(e,t,i,n,s){return super._move(gr(Oa.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,s)}}class tIe extends nu{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordStartRight",precondition:void 0})}}class iIe extends nu{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordEndRight",precondition:void 0,kbOpts:{kbExpr:K.and(T.textInputFocus,K.and(Rw,qT)?.negate()),primary:2065,mac:{primary:529},weight:100}})}}class nIe extends nu{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordRight",precondition:void 0})}}class sIe extends nu{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordStartRightSelect",precondition:void 0})}}class oIe extends nu{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordEndRightSelect",precondition:void 0,kbOpts:{kbExpr:K.and(T.textInputFocus,K.and(Rw,qT)?.negate()),primary:3089,mac:{primary:1553},weight:100}})}}class rIe extends nu{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordRightSelect",precondition:void 0})}}class aIe extends nu{constructor(){super({inSelectionMode:!1,wordNavigationType:3,id:"cursorWordAccessibilityRight",precondition:void 0})}_move(e,t,i,n,s){return super._move(gr(Oa.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,s)}}class lIe extends nu{constructor(){super({inSelectionMode:!0,wordNavigationType:3,id:"cursorWordAccessibilityRightSelect",precondition:void 0})}_move(e,t,i,n,s){return super._move(gr(Oa.wordSeparators.defaultValue,e.intlSegmenterLocales),t,i,n,s)}}class MD extends Hi{constructor(e){super(e),this._whitespaceHeuristics=e.whitespaceHeuristics,this._wordNavigationType=e.wordNavigationType}runEditorCommand(e,t,i){const n=e.get(li);if(!t.hasModel())return;const s=gr(t.getOption(132),t.getOption(131)),r=t.getModel(),a=t.getSelections(),l=t.getOption(6),c=t.getOption(11),d=n.getLanguageConfiguration(r.getLanguageId()).getAutoClosingPairs(),h=t._getViewModel(),u=a.map(g=>{const f=this._delete({wordSeparators:s,model:r,selection:g,whitespaceHeuristics:this._whitespaceHeuristics,autoClosingDelete:t.getOption(9),autoClosingBrackets:l,autoClosingQuotes:c,autoClosingPairs:d,autoClosedCharacters:h.getCursorAutoClosedCharacters()},this._wordNavigationType);return new xn(f,"")});t.pushUndoStop(),t.executeCommands(this.id,u),t.pushUndoStop()}}class JW extends MD{_delete(e,t){const i=_t.deleteWordLeft(e,t);return i||new L(1,1,1,1)}}class e3 extends MD{_delete(e,t){const i=_t.deleteWordRight(e,t);if(i)return i;const n=e.model.getLineCount(),s=e.model.getLineMaxColumn(n);return new L(n,s,n,s)}}class cIe extends JW{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartLeft",precondition:T.writable})}}class dIe extends JW{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndLeft",precondition:T.writable})}}class hIe extends JW{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordLeft",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:2049,mac:{primary:513},weight:100}})}}class uIe extends e3{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:0,id:"deleteWordStartRight",precondition:T.writable})}}class gIe extends e3{constructor(){super({whitespaceHeuristics:!1,wordNavigationType:2,id:"deleteWordEndRight",precondition:T.writable})}}class fIe extends e3{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordRight",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:2068,mac:{primary:532},weight:100}})}}class pIe extends de{constructor(){super({id:"deleteInsideWord",precondition:T.writable,label:p("deleteInsideWord","Delete Word"),alias:"Delete Word"})}run(e,t,i){if(!t.hasModel())return;const n=gr(t.getOption(132),t.getOption(131)),s=t.getModel(),a=t.getSelections().map(l=>{const c=_t.deleteInsideWord(n,s,l);return new xn(c,"")});t.pushUndoStop(),t.executeCommands(this.id,a),t.pushUndoStop()}}oe(new jDe);oe(new qDe);oe(new ZDe);oe(new YDe);oe(new XDe);oe(new QDe);oe(new tIe);oe(new iIe);oe(new nIe);oe(new sIe);oe(new oIe);oe(new rIe);oe(new JDe);oe(new eIe);oe(new aIe);oe(new lIe);oe(new cIe);oe(new dIe);oe(new hIe);oe(new uIe);oe(new gIe);oe(new fIe);X(pIe);class mIe extends MD{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:0,id:"deleteWordPartLeft",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:769},weight:100}})}_delete(e,t){const i=oD.deleteWordPartLeft(e);return i||new L(1,1,1,1)}}class _Ie extends MD{constructor(){super({whitespaceHeuristics:!0,wordNavigationType:2,id:"deleteWordPartRight",precondition:T.writable,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:788},weight:100}})}_delete(e,t){const i=oD.deleteWordPartRight(e);if(i)return i;const n=e.model.getLineCount(),s=e.model.getLineMaxColumn(n);return new L(n,s,n,s)}}class gY extends AD{_move(e,t,i,n,s){return oD.moveWordPartLeft(e,t,i,s)}}class bIe extends gY{constructor(){super({inSelectionMode:!1,wordNavigationType:0,id:"cursorWordPartLeft",precondition:void 0,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:783},weight:100}})}}st.registerCommandAlias("cursorWordPartStartLeft","cursorWordPartLeft");class vIe extends gY{constructor(){super({inSelectionMode:!0,wordNavigationType:0,id:"cursorWordPartLeftSelect",precondition:void 0,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:1807},weight:100}})}}st.registerCommandAlias("cursorWordPartStartLeftSelect","cursorWordPartLeftSelect");class fY extends AD{_move(e,t,i,n,s){return oD.moveWordPartRight(e,t,i)}}class CIe extends fY{constructor(){super({inSelectionMode:!1,wordNavigationType:2,id:"cursorWordPartRight",precondition:void 0,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:785},weight:100}})}}class yIe extends fY{constructor(){super({inSelectionMode:!0,wordNavigationType:2,id:"cursorWordPartRightSelect",precondition:void 0,kbOpts:{kbExpr:T.textInputFocus,primary:0,mac:{primary:1809},weight:100}})}}oe(new mIe);oe(new _Ie);oe(new bIe);oe(new vIe);oe(new CIe);oe(new yIe);const d3=class d3 extends F{constructor(e){super(),this.editor=e,this._register(this.editor.onDidAttemptReadOnlyEdit(()=>this._onDidAttemptReadOnlyEdit()))}_onDidAttemptReadOnlyEdit(){const e=no.get(this.editor);if(e&&this.editor.hasModel()){let t=this.editor.getOptions().get(93);t||(this.editor.isSimpleWidget?t=new Pn(p("editor.simple.readonly","Cannot edit in read-only input")):t=new Pn(p("editor.readonly","Cannot edit in read-only editor"))),e.showMessage(t,this.editor.getPosition())}}};d3.ID="editor.contrib.readOnlyMessageController";let hk=d3;at(hk.ID,hk,2);var wIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},N6=function(o,e){return function(t,i){e(t,i,o)}};let s4=class extends F{constructor(e,t,i){super(),this._textModel=e,this._languageFeaturesService=t,this._outlineModelService=i,this._currentModel=$e(this,void 0);const n=Sn("documentSymbolProvider.onDidChange",this._languageFeaturesService.documentSymbolProvider.onDidChange),s=Sn("_textModel.onDidChangeContent",se.debounce(r=>this._textModel.onDidChangeContent(r),()=>{},100));this._register(Is(async(r,a)=>{n.read(r),s.read(r);const l=a.add(new cbe),c=await this._outlineModelService.getOrCreate(this._textModel,l.token);a.isDisposed||this._currentModel.set(c,void 0)}))}getBreadcrumbItems(e,t){const i=this._currentModel.read(t);if(!i)return[];const n=i.asListOfDocumentSymbols().filter(s=>e.contains(s.range.startLineNumber)&&!e.contains(s.range.endLineNumber));return n.sort($6(cs(s=>s.range.endLineNumber-s.range.startLineNumber,Br))),n.map(s=>({name:s.name,kind:s.kind,startLineNumber:s.range.startLineNumber}))}};s4=wIe([N6(1,ue),N6(2,oS)],s4);hL.setBreadcrumbsSourceFactory((o,e)=>e.createInstance(s4,o));const h3=class h3 extends F{constructor(e){super(),this.editor=e,this.widget=null,Ta&&(this._register(e.onDidChangeConfiguration(()=>this.update())),this.update())}update(){const e=!this.editor.getOption(92);!this.widget&&e?this.widget=new o4(this.editor):this.widget&&!e&&(this.widget.dispose(),this.widget=null)}dispose(){super.dispose(),this.widget&&(this.widget.dispose(),this.widget=null)}};h3.ID="editor.contrib.iPadShowKeyboard";let uk=h3;const $E=class $E extends F{constructor(e){super(),this.editor=e,this._domNode=document.createElement("textarea"),this._domNode.className="iPadShowKeyboard",this._register(H(this._domNode,"touchstart",t=>{this.editor.focus()})),this._register(H(this._domNode,"focus",t=>{this.editor.focus()})),this.editor.addOverlayWidget(this)}dispose(){this.editor.removeOverlayWidget(this),super.dispose()}getId(){return $E.ID}getDomNode(){return this._domNode}getPosition(){return{preference:1}}};$E.ID="editor.contrib.ShowKeyboardWidget";let o4=$E;at(uk.ID,uk,3);var SIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},R6=function(o,e){return function(t,i){e(t,i,o)}},r4,uf;let mw=(uf=class extends F{static get(e){return e.getContribution(r4.ID)}constructor(e,t,i){super(),this._editor=e,this._languageService=i,this._widget=null,this._register(this._editor.onDidChangeModel(n=>this.stop())),this._register(this._editor.onDidChangeModelLanguage(n=>this.stop())),this._register(gi.onDidChange(n=>this.stop())),this._register(this._editor.onKeyUp(n=>n.keyCode===9&&this.stop()))}dispose(){this.stop(),super.dispose()}launch(){this._widget||this._editor.hasModel()&&(this._widget=new a4(this._editor,this._languageService))}stop(){this._widget&&(this._widget.dispose(),this._widget=null)}},r4=uf,uf.ID="editor.contrib.inspectTokens",uf);mw=r4=SIe([R6(1,Ko),R6(2,ti)],mw);class xIe extends de{constructor(){super({id:"editor.action.inspectTokens",label:fA.inspectTokensAction,alias:"Developer: Inspect Tokens",precondition:void 0})}run(e,t){mw.get(t)?.launch()}}function LIe(o){let e="";for(let t=0,i=o.length;t<i;t++){const n=o.charCodeAt(t);switch(n){case 9:e+="→";break;case 32:e+="·";break;default:e+=String.fromCharCode(n)}}return e}function kIe(o,e){const t=gi.get(e);if(t)return t;const i=o.encodeLanguageId(e);return{getInitialState:()=>k_,tokenize:(n,s,r)=>I5(e,r),tokenizeEncoded:(n,s,r)=>BT(i,r)}}const KE=class KE extends F{constructor(e,t){super(),this.allowEditorOverflow=!0,this._editor=e,this._languageService=t,this._model=this._editor.getModel(),this._domNode=document.createElement("div"),this._domNode.className="tokens-inspect-widget",this._tokenizationSupport=kIe(this._languageService.languageIdCodec,this._model.getLanguageId()),this._compute(this._editor.getPosition()),this._register(this._editor.onDidChangeCursorPosition(i=>this._compute(this._editor.getPosition()))),this._editor.addContentWidget(this)}dispose(){this._editor.removeContentWidget(this),super.dispose()}getId(){return KE._ID}_compute(e){const t=this._getTokensAtLine(e.lineNumber);let i=0;for(let l=t.tokens1.length-1;l>=0;l--){const c=t.tokens1[l];if(e.column-1>=c.offset){i=l;break}}let n=0;for(let l=t.tokens2.length>>>1;l>=0;l--)if(e.column-1>=t.tokens2[l<<1]){n=l;break}const s=this._model.getLineContent(e.lineNumber);let r="";if(i<t.tokens1.length){const l=t.tokens1[i].offset,c=i+1<t.tokens1.length?t.tokens1[i+1].offset:s.length;r=s.substring(l,c)}pn(this._domNode,ie("h2.tm-token",void 0,LIe(r),ie("span.tm-token-length",void 0,`${r.length} ${r.length===1?"char":"chars"}`))),Y(this._domNode,ie("hr.tokens-inspect-separator",{style:"clear:both"}));const a=(n<<1)+1<t.tokens2.length?this._decodeMetadata(t.tokens2[(n<<1)+1]):null;Y(this._domNode,ie("table.tm-metadata-table",void 0,ie("tbody",void 0,ie("tr",void 0,ie("td.tm-metadata-key",void 0,"language"),ie("td.tm-metadata-value",void 0,`${a?a.languageId:"-?-"}`)),ie("tr",void 0,ie("td.tm-metadata-key",void 0,"token type"),ie("td.tm-metadata-value",void 0,`${a?this._tokenTypeToString(a.tokenType):"-?-"}`)),ie("tr",void 0,ie("td.tm-metadata-key",void 0,"font style"),ie("td.tm-metadata-value",void 0,`${a?this._fontStyleToString(a.fontStyle):"-?-"}`)),ie("tr",void 0,ie("td.tm-metadata-key",void 0,"foreground"),ie("td.tm-metadata-value",void 0,`${a?j.Format.CSS.formatHex(a.foreground):"-?-"}`)),ie("tr",void 0,ie("td.tm-metadata-key",void 0,"background"),ie("td.tm-metadata-value",void 0,`${a?j.Format.CSS.formatHex(a.background):"-?-"}`))))),Y(this._domNode,ie("hr.tokens-inspect-separator")),i<t.tokens1.length&&Y(this._domNode,ie("span.tm-token-type",void 0,t.tokens1[i].type)),this._editor.layoutContentWidget(this)}_decodeMetadata(e){const t=gi.getColorMap(),i=ks.getLanguageId(e),n=ks.getTokenType(e),s=ks.getFontStyle(e),r=ks.getForeground(e),a=ks.getBackground(e);return{languageId:this._languageService.languageIdCodec.decodeLanguageId(i),tokenType:n,fontStyle:s,foreground:t[r],background:t[a]}}_tokenTypeToString(e){switch(e){case 0:return"Other";case 1:return"Comment";case 2:return"String";case 3:return"RegEx";default:return"??"}}_fontStyleToString(e){let t="";return e&1&&(t+="italic "),e&2&&(t+="bold "),e&4&&(t+="underline "),e&8&&(t+="strikethrough "),t.length===0&&(t="---"),t}_getTokensAtLine(e){const t=this._getStateBeforeLine(e),i=this._tokenizationSupport.tokenize(this._model.getLineContent(e),!0,t),n=this._tokenizationSupport.tokenizeEncoded(this._model.getLineContent(e),!0,t);return{startState:t,tokens1:i.tokens,tokens2:n.tokens,endState:i.endState}}_getStateBeforeLine(e){let t=this._tokenizationSupport.getInitialState();for(let i=1;i<e;i++)t=this._tokenizationSupport.tokenize(this._model.getLineContent(i),!0,t).endState;return t}getDomNode(){return this._domNode}getPosition(){return{position:this._editor.getPosition(),preference:[2,1]}}};KE._ID="editor.contrib.inspectTokensWidget";let a4=KE;at(mw.ID,mw,4);X(xIe);var EIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},P6=function(o,e){return function(t,i){e(t,i,o)}},Rv,gf;let l4=(gf=class{constructor(e,t){this.quickInputService=e,this.keybindingService=t,this.registry=ai.as(Yf.Quickaccess)}provide(e){const t=new $;return t.add(e.onDidAccept(()=>{const[i]=e.selectedItems;i&&this.quickInputService.quickAccess.show(i.prefix,{preserveValue:!0})})),t.add(e.onDidChangeValue(i=>{const n=this.registry.getQuickAccessProvider(i.substr(Rv.PREFIX.length));n&&n.prefix&&n.prefix!==Rv.PREFIX&&this.quickInputService.quickAccess.show(n.prefix,{preserveValue:!0})})),e.items=this.getQuickAccessProviders().filter(i=>i.prefix!==Rv.PREFIX),t}getQuickAccessProviders(){return this.registry.getQuickAccessProviders().sort((t,i)=>t.prefix.localeCompare(i.prefix)).flatMap(t=>this.createPicks(t))}createPicks(e){return e.helpEntries.map(t=>{const i=t.prefix||e.prefix,n=i||"…";return{prefix:i,label:n,keybinding:t.commandId?this.keybindingService.lookupKeybinding(t.commandId):void 0,ariaLabel:p("helpPickAriaLabel","{0}, {1}",n,t.description),description:t.description}})}},Rv=gf,gf.PREFIX="?",gf);l4=Rv=EIe([P6(0,vr),P6(1,vt)],l4);ai.as(Yf.Quickaccess).registerQuickAccessProvider({ctor:l4,prefix:"",helpEntries:[{description:pA.helpQuickAccessActionLabel}]});class pY{constructor(e){this.options=e,this.rangeHighlightDecorationId=void 0}provide(e,t,i){const n=new $;e.canAcceptInBackground=!!this.options?.canAcceptInBackground,e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;const s=n.add(new Yi);return s.value=this.doProvide(e,t,i),n.add(this.onDidActiveTextEditorControlChange(()=>{s.value=void 0,s.value=this.doProvide(e,t)})),n}doProvide(e,t,i){const n=new $,s=this.activeTextEditorControl;if(s&&this.canProvideWithTextEditor(s)){const r={editor:s},a=yj(s);if(a){let l=s.saveViewState()??void 0;n.add(a.onDidChangeCursorPosition(()=>{l=s.saveViewState()??void 0})),r.restoreViewState=()=>{l&&s===this.activeTextEditorControl&&s.restoreViewState(l)},n.add(Eh(t.onCancellationRequested)(()=>r.restoreViewState?.()))}n.add(ve(()=>this.clearDecorations(s))),n.add(this.provideWithTextEditor(r,e,t,i))}else n.add(this.provideWithoutTextEditor(e,t));return n}canProvideWithTextEditor(e){return!0}gotoLocation({editor:e},t){e.setSelection(t.range,"code.jump"),e.revealRangeInCenter(t.range,0),t.preserveFocus||e.focus();const i=e.getModel();i&&"getLineContent"in i&&Rl(`${i.getLineContent(t.range.startLineNumber)}`)}getModel(e){return sW(e)?e.getModel()?.modified:e.getModel()}addDecorations(e,t){e.changeDecorations(i=>{const n=[];this.rangeHighlightDecorationId&&(n.push(this.rangeHighlightDecorationId.overviewRulerDecorationId),n.push(this.rangeHighlightDecorationId.rangeHighlightId),this.rangeHighlightDecorationId=void 0);const s=[{range:t,options:{description:"quick-access-range-highlight",className:"rangeHighlight",isWholeLine:!0}},{range:t,options:{description:"quick-access-range-highlight-overview",overviewRuler:{color:fi(u$),position:Ao.Full}}}],[r,a]=i.deltaDecorations(n,s);this.rangeHighlightDecorationId={rangeHighlightId:r,overviewRulerDecorationId:a}})}clearDecorations(e){const t=this.rangeHighlightDecorationId;t&&(e.changeDecorations(i=>{i.deltaDecorations([t.overviewRulerDecorationId,t.rangeHighlightId],[])}),this.rangeHighlightDecorationId=void 0)}}const jE=class jE extends pY{constructor(){super({canAcceptInBackground:!0})}provideWithoutTextEditor(e){const t=p("cannotRunGotoLine","Open a text editor first to go to a line.");return e.items=[{label:t}],e.ariaLabel=t,F.None}provideWithTextEditor(e,t,i){const n=e.editor,s=new $;s.add(t.onDidAccept(l=>{const[c]=t.selectedItems;if(c){if(!this.isValidLineNumber(n,c.lineNumber))return;this.gotoLocation(e,{range:this.toRange(c.lineNumber,c.column),keyMods:t.keyMods,preserveFocus:l.inBackground}),l.inBackground||t.hide()}}));const r=()=>{const l=this.parsePosition(n,t.value.trim().substr(jE.PREFIX.length)),c=this.getPickLabel(n,l.lineNumber,l.column);if(t.items=[{lineNumber:l.lineNumber,column:l.column,label:c}],t.ariaLabel=c,!this.isValidLineNumber(n,l.lineNumber)){this.clearDecorations(n);return}const d=this.toRange(l.lineNumber,l.column);n.revealRangeInCenter(d,0),this.addDecorations(n,d)};r(),s.add(t.onDidChangeValue(()=>r()));const a=yj(n);return a&&a.getOptions().get(68).renderType===2&&(a.updateOptions({lineNumbers:"on"}),s.add(ve(()=>a.updateOptions({lineNumbers:"relative"})))),s}toRange(e=1,t=1){return{startLineNumber:e,startColumn:t,endLineNumber:e,endColumn:t}}parsePosition(e,t){const i=t.split(/,|:|#/).map(s=>parseInt(s,10)).filter(s=>!isNaN(s)),n=this.lineCount(e)+1;return{lineNumber:i[0]>0?i[0]:n+i[0],column:i[1]}}getPickLabel(e,t,i){if(this.isValidLineNumber(e,t))return this.isValidColumn(e,t,i)?p("gotoLineColumnLabel","Go to line {0} and character {1}.",t,i):p("gotoLineLabel","Go to line {0}.",t);const n=e.getPosition()||{lineNumber:1,column:1},s=this.lineCount(e);return s>1?p("gotoLineLabelEmptyWithLimit","Current Line: {0}, Character: {1}. Type a line number between 1 and {2} to navigate to.",n.lineNumber,n.column,s):p("gotoLineLabelEmpty","Current Line: {0}, Character: {1}. Type a line number to navigate to.",n.lineNumber,n.column)}isValidLineNumber(e,t){return!t||typeof t!="number"?!1:t>0&&t<=this.lineCount(e)}isValidColumn(e,t,i){if(!i||typeof i!="number")return!1;const n=this.getModel(e);if(!n)return!1;const s={lineNumber:t,column:i};return n.validatePosition(s).equals(s)}lineCount(e){return this.getModel(e)?.getLineCount()??0}};jE.PREFIX=":";let c4=jE;var TIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},DIe=function(o,e){return function(t,i){e(t,i,o)}};let _w=class extends c4{constructor(e){super(),this.editorService=e,this.onDidActiveTextEditorControlChange=se.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};_w=TIe([DIe(0,gt)],_w);var ff;let mY=(ff=class extends de{constructor(){super({id:ff.ID,label:rx.gotoLineActionLabel,alias:"Go to Line/Column...",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:2085,mac:{primary:293},weight:100}})}run(e){e.get(vr).quickAccess.show(_w.PREFIX)}},ff.ID="editor.action.gotoLine",ff);X(mY);ai.as(Yf.Quickaccess).registerQuickAccessProvider({ctor:_w,prefix:_w.PREFIX,helpEntries:[{description:rx.gotoLineActionLabel,commandId:mY.ID}]});const _Y=[void 0,[]];function WN(o,e,t=0,i=0){const n=e;return n.values&&n.values.length>1?IIe(o,n.values,t,i):bY(o,e,t,i)}function IIe(o,e,t,i){let n=0;const s=[];for(const r of e){const[a,l]=bY(o,r,t,i);if(typeof a!="number")return _Y;n+=a,s.push(...l)}return[n,NIe(s)]}function bY(o,e,t,i){const n=xf(e.original,e.originalLowercase,t,o,o.toLowerCase(),i,{firstMatchCanBeWeak:!0,boostFullMatch:!0});return n?[n[0],Nw(n)]:_Y}function NIe(o){const e=o.sort((n,s)=>n.start-s.start),t=[];let i;for(const n of e)!i||!RIe(i,n)?(i=n,t.push(n)):(i.start=Math.min(i.start,n.start),i.end=Math.max(i.end,n.end));return t}function RIe(o,e){return!(o.end<e.start||e.end<o.start)}function A6(o){return o.startsWith('"')&&o.endsWith('"')}const vY=" ";function d4(o){typeof o!="string"&&(o="");const e=o.toLowerCase(),{pathNormalized:t,normalized:i,normalizedLowercase:n}=M6(o),s=t.indexOf(ya)>=0,r=A6(o);let a;const l=o.split(vY);if(l.length>1)for(const c of l){const d=A6(c),{pathNormalized:h,normalized:u,normalizedLowercase:g}=M6(c);u&&(a||(a=[]),a.push({original:c,originalLowercase:c.toLowerCase(),pathNormalized:h,normalized:u,normalizedLowercase:g,expectContiguousMatch:d}))}return{original:o,originalLowercase:e,pathNormalized:t,normalized:i,normalizedLowercase:n,values:a,containsPathSeparator:s,expectContiguousMatch:r}}function M6(o){let e;En?e=o.replace(/\//g,ya):e=o.replace(/\\/g,ya);const t=VQ(e).replace(/\s|"/g,"");return{pathNormalized:e,normalized:t,normalizedLowercase:t.toLowerCase()}}function O6(o){return Array.isArray(o)?d4(o.map(e=>e.original).join(vY)):d4(o.original)}var PIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},F6=function(o,e){return function(t,i){e(t,i,o)}},g0,ma;let _g=(ma=class extends pY{constructor(e,t,i=Object.create(null)){super(i),this._languageFeaturesService=e,this._outlineModelService=t,this.options=i,this.options.canAcceptInBackground=!0}provideWithoutTextEditor(e){return this.provideLabelPick(e,p("cannotRunGotoSymbolWithoutEditor","To go to a symbol, first open a text editor with symbol information.")),F.None}provideWithTextEditor(e,t,i,n){const s=e.editor,r=this.getModel(s);return r?this._languageFeaturesService.documentSymbolProvider.has(r)?this.doProvideWithEditorSymbols(e,r,t,i,n):this.doProvideWithoutEditorSymbols(e,r,t,i):F.None}doProvideWithoutEditorSymbols(e,t,i,n){const s=new $;return this.provideLabelPick(i,p("cannotRunGotoSymbolWithoutSymbolProvider","The active text editor does not provide symbol information.")),(async()=>!await this.waitForLanguageSymbolRegistry(t,s)||n.isCancellationRequested||s.add(this.doProvideWithEditorSymbols(e,t,i,n)))(),s}provideLabelPick(e,t){e.items=[{label:t,index:0,kind:14}],e.ariaLabel=t}async waitForLanguageSymbolRegistry(e,t){if(this._languageFeaturesService.documentSymbolProvider.has(e))return!0;const i=new ib,n=t.add(this._languageFeaturesService.documentSymbolProvider.onDidChange(()=>{this._languageFeaturesService.documentSymbolProvider.has(e)&&(n.dispose(),i.complete(!0))}));return t.add(ve(()=>i.complete(!1))),i.p}doProvideWithEditorSymbols(e,t,i,n,s){const r=e.editor,a=new $;a.add(i.onDidAccept(h=>{const[u]=i.selectedItems;u&&u.range&&(this.gotoLocation(e,{range:u.range.selection,keyMods:i.keyMods,preserveFocus:h.inBackground}),s?.handleAccept?.(u),h.inBackground||i.hide())})),a.add(i.onDidTriggerItemButton(({item:h})=>{h&&h.range&&(this.gotoLocation(e,{range:h.range.selection,keyMods:i.keyMods,forceSideBySide:!0}),i.hide())}));const l=this.getDocumentSymbols(t,n);let c;const d=async h=>{c?.dispose(!0),i.busy=!1,c=new ri(n),i.busy=!0;try{const u=d4(i.value.substr(g0.PREFIX.length).trim()),g=await this.doGetSymbolPicks(l,u,void 0,c.token,t);if(n.isCancellationRequested)return;if(g.length>0){if(i.items=g,h&&u.original.length===0){const f=JC(g,m=>!!(m.type!=="separator"&&m.range&&L.containsPosition(m.range.decoration,h)));f&&(i.activeItems=[f])}}else u.original.length>0?this.provideLabelPick(i,p("noMatchingSymbolResults","No matching editor symbols")):this.provideLabelPick(i,p("noSymbolResults","No editor symbols"))}finally{n.isCancellationRequested||(i.busy=!1)}};return a.add(i.onDidChangeValue(()=>d(void 0))),d(r.getSelection()?.getPosition()),a.add(i.onDidChangeActive(()=>{const[h]=i.activeItems;h&&h.range&&(r.revealRangeInCenter(h.range.selection,0),this.addDecorations(r,h.range.decoration))})),a}async doGetSymbolPicks(e,t,i,n,s){const r=await e;if(n.isCancellationRequested)return[];const a=t.original.indexOf(g0.SCOPE_PREFIX)===0,l=a?1:0;let c,d;t.values&&t.values.length>1?(c=O6(t.values[0]),d=O6(t.values.slice(1))):c=t;let h;const u=this.options?.openSideBySideDirection?.();u&&(h=[{iconClass:u==="right"?ke.asClassName(J.splitHorizontal):ke.asClassName(J.splitVertical),tooltip:u==="right"?p("openToSide","Open to the Side"):p("openToBottom","Open to the Bottom")}]);const g=[];for(let _=0;_<r.length;_++){const b=r[_],v=BQ(b.name),y=`$(${x0.toIcon(b.kind).id}) ${v}`,C=y.length-v.length;let w=b.containerName;i?.extraContainerLabel&&(w?w=`${i.extraContainerLabel} • ${w}`:w=i.extraContainerLabel);let x,k,E,N;if(t.original.length>l){let B=!1;if(c!==t&&([x,k]=WN(y,{...t,values:void 0},l,C),typeof x=="number"&&(B=!0)),typeof x!="number"&&([x,k]=WN(y,c,l,C),typeof x!="number"))continue;if(!B&&d){if(w&&d.original.length>0&&([E,N]=WN(w,d)),typeof E!="number")continue;typeof x=="number"&&(x+=E)}}const z=b.tags&&b.tags.indexOf(1)>=0;g.push({index:_,kind:b.kind,score:x,label:y,ariaLabel:NQ(b.name,b.kind),description:w,highlights:z?void 0:{label:k,description:N},range:{selection:L.collapseToStart(b.selectionRange),decoration:b.range},uri:s.uri,symbolName:v,strikethrough:z,buttons:h})}const f=g.sort((_,b)=>a?this.compareByKindAndScore(_,b):this.compareByScore(_,b));let m=[];if(a){let y=function(){b&&typeof _=="number"&&v>0&&(b.label=mf(HN[_]||VN,v))},_,b,v=0;for(const C of f)_!==C.kind?(y(),_=C.kind,v=1,b={type:"separator"},m.push(b)):v++,m.push(C);y()}else f.length>0&&(m=[{label:p("symbols","symbols ({0})",g.length),type:"separator"},...f]);return m}compareByScore(e,t){if(typeof e.score!="number"&&typeof t.score=="number")return 1;if(typeof e.score=="number"&&typeof t.score!="number")return-1;if(typeof e.score=="number"&&typeof t.score=="number"){if(e.score>t.score)return-1;if(e.score<t.score)return 1}return e.index<t.index?-1:e.index>t.index?1:0}compareByKindAndScore(e,t){const i=HN[e.kind]||VN,n=HN[t.kind]||VN,s=i.localeCompare(n);return s===0?this.compareByScore(e,t):s}async getDocumentSymbols(e,t){const i=await this._outlineModelService.getOrCreate(e,t);return t.isCancellationRequested?[]:i.asListOfDocumentSymbols()}},g0=ma,ma.PREFIX="@",ma.SCOPE_PREFIX=":",ma.PREFIX_BY_CATEGORY=`${ma.PREFIX}${ma.SCOPE_PREFIX}`,ma);_g=g0=PIe([F6(0,ue),F6(1,oS)],_g);const VN=p("property","properties ({0})"),HN={5:p("method","methods ({0})"),11:p("function","functions ({0})"),8:p("_constructor","constructors ({0})"),12:p("variable","variables ({0})"),4:p("class","classes ({0})"),22:p("struct","structs ({0})"),23:p("event","events ({0})"),24:p("operator","operators ({0})"),10:p("interface","interfaces ({0})"),2:p("namespace","namespaces ({0})"),3:p("package","packages ({0})"),25:p("typeParameter","type parameters ({0})"),1:p("modules","modules ({0})"),6:p("property","properties ({0})"),9:p("enum","enumerations ({0})"),21:p("enumMember","enumeration members ({0})"),14:p("string","strings ({0})"),0:p("file","files ({0})"),17:p("array","arrays ({0})"),15:p("number","numbers ({0})"),16:p("boolean","booleans ({0})"),18:p("object","objects ({0})"),19:p("key","keys ({0})"),7:p("field","fields ({0})"),13:p("constant","constants ({0})")};var AIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},zN=function(o,e){return function(t,i){e(t,i,o)}};let h4=class extends _g{constructor(e,t,i){super(t,i),this.editorService=e,this.onDidActiveTextEditorControlChange=se.None}get activeTextEditorControl(){return this.editorService.getFocusedCodeEditor()??void 0}};h4=AIe([zN(0,gt),zN(1,ue),zN(2,oS)],h4);const qE=class qE extends de{constructor(){super({id:qE.ID,label:py.quickOutlineActionLabel,alias:"Go to Symbol...",precondition:T.hasDocumentSymbolProvider,kbOpts:{kbExpr:T.focus,primary:3117,weight:100},contextMenuOpts:{group:"navigation",order:3}})}run(e){e.get(vr).quickAccess.show(_g.PREFIX,{itemActivation:ca.NONE})}};qE.ID="editor.action.quickOutline";let gk=qE;X(gk);ai.as(Yf.Quickaccess).registerQuickAccessProvider({ctor:h4,prefix:_g.PREFIX,helpEntries:[{description:py.quickOutlineActionLabel,prefix:_g.PREFIX,commandId:gk.ID},{description:py.quickOutlineByCategoryActionLabel,prefix:_g.PREFIX_BY_CATEGORY}]});function MIe(o){const e=new Map;for(const t of o)e.set(t,(e.get(t)??0)+1);return e}class vC{constructor(){this.chunkCount=0,this.chunkOccurrences=new Map,this.documents=new Map}calculateScores(e,t){const i=this.computeEmbedding(e),n=new Map,s=[];for(const[r,a]of this.documents){if(t.isCancellationRequested)return[];for(const l of a.chunks){const c=this.computeSimilarityScore(l,i,n);c>0&&s.push({key:r,score:c})}}return s}static termFrequencies(e){return MIe(vC.splitTerms(e))}static*splitTerms(e){const t=i=>i.toLowerCase();for(const[i]of e.matchAll(new RegExp("\\b\\p{Letter}[\\p{Letter}\\d]{2,}\\b","gu"))){yield t(i);const n=i.replace(/([a-z])([A-Z])/g,"$1 $2").split(/\s+/g);if(n.length>1)for(const s of n)s.length>2&&new RegExp("\\p{Letter}{3,}","gu").test(s)&&(yield t(s))}}updateDocuments(e){for(const{key:t}of e)this.deleteDocument(t);for(const t of e){const i=[];for(const n of t.textChunks){const s=vC.termFrequencies(n);for(const r of s.keys())this.chunkOccurrences.set(r,(this.chunkOccurrences.get(r)??0)+1);i.push({text:n,tf:s})}this.chunkCount+=i.length,this.documents.set(t.key,{chunks:i})}return this}deleteDocument(e){const t=this.documents.get(e);if(t){this.documents.delete(e),this.chunkCount-=t.chunks.length;for(const i of t.chunks)for(const n of i.tf.keys()){const s=this.chunkOccurrences.get(n);if(typeof s=="number"){const r=s-1;r<=0?this.chunkOccurrences.delete(n):this.chunkOccurrences.set(n,r)}}}}computeSimilarityScore(e,t,i){let n=0;for(const[s,r]of Object.entries(t)){const a=e.tf.get(s);if(!a)continue;let l=i.get(s);typeof l!="number"&&(l=this.computeIdf(s),i.set(s,l));const c=a*l;n+=c*r}return n}computeEmbedding(e){const t=vC.termFrequencies(e);return this.computeTfidf(t)}computeIdf(e){const t=this.chunkOccurrences.get(e)??0;return t>0?Math.log((this.chunkCount+1)/t):0}computeTfidf(e){const t=Object.create(null);for(const[i,n]of e){const s=this.computeIdf(i);s>0&&(t[i]=n*s)}return t}}function OIe(o){const e=o.slice(0);e.sort((i,n)=>n.score-i.score);const t=e[0]?.score??0;if(t>0)for(const i of e)i.score/=t;return e}var um;(function(o){o[o.NO_ACTION=0]="NO_ACTION",o[o.CLOSE_PICKER=1]="CLOSE_PICKER",o[o.REFRESH_PICKER=2]="REFRESH_PICKER",o[o.REMOVE_ITEM=3]="REMOVE_ITEM"})(um||(um={}));function UN(o){const e=o;return Array.isArray(e.items)}function B6(o){const e=o;return!!e.picks&&e.additionalPicks instanceof Promise}class FIe extends F{constructor(e,t){super(),this.prefix=e,this.options=t}provide(e,t,i){const n=new $;e.canAcceptInBackground=!!this.options?.canAcceptInBackground,e.matchOnLabel=e.matchOnDescription=e.matchOnDetail=e.sortByLabel=!1;let s;const r=n.add(new Yi),a=async()=>{const c=r.value=new $;s?.dispose(!0),e.busy=!1,s=new ri(t);const d=s.token;let h=e.value.substring(this.prefix.length);this.options?.shouldSkipTrimPickFilter||(h=h.trim());const u=this._getPicks(h,c,d,i),g=(m,_)=>{let b,v;if(UN(m)?(b=m.items,v=m.active):b=m,b.length===0){if(_)return!1;(h.length>0||e.hideInput)&&this.options?.noResultsPick&&(VC(this.options.noResultsPick)?b=[this.options.noResultsPick(h)]:b=[this.options.noResultsPick])}return e.items=b,v&&(e.activeItems=[v]),!0},f=async m=>{let _=!1,b=!1;await Promise.all([(async()=>{typeof m.mergeDelay=="number"&&(await Kc(m.mergeDelay),d.isCancellationRequested)||b||(_=g(m.picks,!0))})(),(async()=>{e.busy=!0;try{const v=await m.additionalPicks;if(d.isCancellationRequested)return;let y,C;UN(m.picks)?(y=m.picks.items,C=m.picks.active):y=m.picks;let w,x;if(UN(v)?(w=v.items,x=v.active):w=v,w.length>0||!_){let k;if(!C&&!x){const E=e.activeItems[0];E&&y.indexOf(E)!==-1&&(k=E)}g({items:[...y,...w],active:C||x||k})}}finally{d.isCancellationRequested||(e.busy=!1),b=!0}})()])};if(u!==null)if(B6(u))await f(u);else if(!(u instanceof Promise))g(u);else{e.busy=!0;try{const m=await u;if(d.isCancellationRequested)return;B6(m)?await f(m):g(m)}finally{d.isCancellationRequested||(e.busy=!1)}}};n.add(e.onDidChangeValue(()=>a())),a(),n.add(e.onDidAccept(c=>{if(i?.handleAccept){c.inBackground||e.hide(),i.handleAccept?.(e.activeItems[0]);return}const[d]=e.selectedItems;typeof d?.accept=="function"&&(c.inBackground||e.hide(),d.accept(e.keyMods,c))}));const l=async(c,d)=>{if(typeof d.trigger!="function")return;const h=d.buttons?.indexOf(c)??-1;if(h>=0){const u=d.trigger(h,e.keyMods),g=typeof u=="number"?u:await u;if(t.isCancellationRequested)return;switch(g){case um.NO_ACTION:break;case um.CLOSE_PICKER:e.hide();break;case um.REFRESH_PICKER:a();break;case um.REMOVE_ITEM:{const f=e.items.indexOf(d);if(f!==-1){const m=e.items.slice(),_=m.splice(f,1),b=e.activeItems.filter(y=>y!==_[0]),v=e.keepScrollPosition;e.keepScrollPosition=!0,e.items=m,b&&(e.activeItems=b),e.keepScrollPosition=v}break}}}};return n.add(e.onDidTriggerItemButton(({button:c,item:d})=>l(c,d))),n.add(e.onDidTriggerSeparatorButton(({button:c,separator:d})=>l(c,d))),n}}var CY=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Wd=function(o,e){return function(t,i){e(t,i,o)}},Iu,Wi,Cl;let u4=(Cl=class extends FIe{constructor(e,t,i,n,s,r){super(Iu.PREFIX,e),this.instantiationService=t,this.keybindingService=i,this.commandService=n,this.telemetryService=s,this.dialogService=r,this.commandsHistory=this._register(this.instantiationService.createInstance(g4)),this.options=e}async _getPicks(e,t,i,n){const s=await this.getCommandPicks(i);if(i.isCancellationRequested)return[];const r=Eh(()=>{const g=new vC;g.updateDocuments(s.map(m=>({key:m.commandId,textChunks:[this.getTfIdfChunk(m)]})));const f=g.calculateScores(e,i);return OIe(f).filter(m=>m.score>Iu.TFIDF_THRESHOLD).slice(0,Iu.TFIDF_MAX_RESULTS)}),a=[];for(const g of s){const f=Iu.WORD_FILTER(e,g.label)??void 0,m=g.commandAlias?Iu.WORD_FILTER(e,g.commandAlias)??void 0:void 0;if(f||m)g.highlights={label:f,detail:this.options.showAlias?m:void 0},a.push(g);else if(e===g.commandId)a.push(g);else if(e.length>=3){const _=r();if(i.isCancellationRequested)return[];const b=_.find(v=>v.key===g.commandId);b&&(g.tfIdfScore=b.score,a.push(g))}}const l=new Map;for(const g of a){const f=l.get(g.label);f?(g.description=g.commandId,f.description=f.commandId):l.set(g.label,g)}a.sort((g,f)=>{if(g.tfIdfScore&&f.tfIdfScore)return g.tfIdfScore===f.tfIdfScore?g.label.localeCompare(f.label):f.tfIdfScore-g.tfIdfScore;if(g.tfIdfScore)return 1;if(f.tfIdfScore)return-1;const m=this.commandsHistory.peek(g.commandId),_=this.commandsHistory.peek(f.commandId);if(m&&_)return m>_?-1:1;if(m)return-1;if(_)return 1;if(this.options.suggestedCommandIds){const b=this.options.suggestedCommandIds.has(g.commandId),v=this.options.suggestedCommandIds.has(f.commandId);if(b&&v)return 0;if(b)return-1;if(v)return 1}return g.label.localeCompare(f.label)});const c=[];let d=!1,h=!0,u=!!this.options.suggestedCommandIds;for(let g=0;g<a.length;g++){const f=a[g];g===0&&this.commandsHistory.peek(f.commandId)&&(c.push({type:"separator",label:p("recentlyUsed","recently used")}),d=!0),h&&f.tfIdfScore!==void 0&&(c.push({type:"separator",label:p("suggested","similar commands")}),h=!1),u&&f.tfIdfScore===void 0&&!this.commandsHistory.peek(f.commandId)&&this.options.suggestedCommandIds?.has(f.commandId)&&(c.push({type:"separator",label:p("commonlyUsed","commonly used")}),d=!0,u=!1),d&&f.tfIdfScore===void 0&&!this.commandsHistory.peek(f.commandId)&&!this.options.suggestedCommandIds?.has(f.commandId)&&(c.push({type:"separator",label:p("morecCommands","other commands")}),d=!1),c.push(this.toCommandPick(f,n))}return this.hasAdditionalCommandPicks(e,i)?{picks:c,additionalPicks:(async()=>{const g=await this.getAdditionalCommandPicks(s,a,e,i);if(i.isCancellationRequested)return[];const f=g.map(m=>this.toCommandPick(m,n));return h&&f[0]?.type!=="separator"&&f.unshift({type:"separator",label:p("suggested","similar commands")}),f})()}:c}toCommandPick(e,t){if(e.type==="separator")return e;const i=this.keybindingService.lookupKeybinding(e.commandId),n=i?p("commandPickAriaLabelWithKeybinding","{0}, {1}",e.label,i.getAriaLabel()):e.label;return{...e,ariaLabel:n,detail:this.options.showAlias&&e.commandAlias!==e.label?e.commandAlias:void 0,keybinding:i,accept:async()=>{this.commandsHistory.push(e.commandId),this.telemetryService.publicLog2("workbenchActionExecuted",{id:e.commandId,from:t?.from??"quick open"});try{e.args?.length?await this.commandService.executeCommand(e.commandId,...e.args):await this.commandService.executeCommand(e.commandId)}catch(s){_r(s)||this.dialogService.error(p("canNotRun","Command '{0}' resulted in an error",e.label),vL(s))}}}}getTfIdfChunk({label:e,commandAlias:t,commandDescription:i}){let n=e;return t&&t!==e&&(n+=` - ${t}`),i&&i.value!==e&&(n+=` - ${i.value===i.original?i.value:`${i.value} (${i.original})`}`),n}},Iu=Cl,Cl.PREFIX=">",Cl.TFIDF_THRESHOLD=.5,Cl.TFIDF_MAX_RESULTS=5,Cl.WORD_FILTER=y5(hy,Qoe,LG),Cl);u4=Iu=CY([Wd(1,Ce),Wd(2,vt),Wd(3,Ft),Wd(4,Fn),Wd(5,Tw)],u4);var _a;let g4=(_a=class extends F{constructor(e,t,i){super(),this.storageService=e,this.configurationService=t,this.logService=i,this.configuredCommandsHistoryLength=0,this.updateConfiguration(),this.load(),this.registerListeners()}registerListeners(){this._register(this.configurationService.onDidChangeConfiguration(e=>this.updateConfiguration(e))),this._register(this.storageService.onWillSaveState(e=>{e.reason===vy.SHUTDOWN&&this.saveState()}))}updateConfiguration(e){e&&!e.affectsConfiguration("workbench.commandPalette.history")||(this.configuredCommandsHistoryLength=Wi.getConfiguredCommandHistoryLength(this.configurationService),Wi.cache&&Wi.cache.limit!==this.configuredCommandsHistoryLength&&(Wi.cache.limit=this.configuredCommandsHistoryLength,Wi.hasChanges=!0))}load(){const e=this.storageService.get(Wi.PREF_KEY_CACHE,0);let t;if(e)try{t=JSON.parse(e)}catch(n){this.logService.error(`[CommandsHistory] invalid data: ${n}`)}const i=Wi.cache=new Vl(this.configuredCommandsHistoryLength,1);if(t){let n;t.usesLRU?n=t.entries:n=t.entries.sort((s,r)=>s.value-r.value),n.forEach(s=>i.set(s.key,s.value))}Wi.counter=this.storageService.getNumber(Wi.PREF_KEY_COUNTER,0,Wi.counter)}push(e){Wi.cache&&(Wi.cache.set(e,Wi.counter++),Wi.hasChanges=!0)}peek(e){return Wi.cache?.peek(e)}saveState(){if(!Wi.cache||!Wi.hasChanges)return;const e={usesLRU:!0,entries:[]};Wi.cache.forEach((t,i)=>e.entries.push({key:i,value:t})),this.storageService.store(Wi.PREF_KEY_CACHE,JSON.stringify(e),0,0),this.storageService.store(Wi.PREF_KEY_COUNTER,Wi.counter,0,0),Wi.hasChanges=!1}static getConfiguredCommandHistoryLength(e){const i=e.getValue().workbench?.commandPalette?.history;return typeof i=="number"?i:Wi.DEFAULT_COMMANDS_HISTORY_LENGTH}},Wi=_a,_a.DEFAULT_COMMANDS_HISTORY_LENGTH=50,_a.PREF_KEY_CACHE="commandPalette.mru.cache",_a.PREF_KEY_COUNTER="commandPalette.mru.counter",_a.counter=1,_a.hasChanges=!1,_a);g4=Wi=CY([Wd(0,Yr),Wd(1,Ke),Wd(2,Tn)],g4);class BIe extends u4{constructor(e,t,i,n,s,r){super(e,t,i,n,s,r)}getCodeEditorCommandPicks(){const e=this.activeTextEditorControl;if(!e)return[];const t=[];for(const i of e.getSupportedActions()){let n;i.metadata?.description&&(Yle(i.metadata.description)?n=i.metadata.description:n={original:i.metadata.description,value:i.metadata.description}),t.push({commandId:i.id,commandAlias:i.alias,commandDescription:n,label:E5(i.label)||i.id})}return t}}var WIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Pp=function(o,e){return function(t,i){e(t,i,o)}};let bw=class extends BIe{get activeTextEditorControl(){return this.codeEditorService.getFocusedCodeEditor()??void 0}constructor(e,t,i,n,s,r){super({showAlias:!1},e,i,n,s,r),this.codeEditorService=t}async getCommandPicks(){return this.getCodeEditorCommandPicks()}hasAdditionalCommandPicks(){return!1}async getAdditionalCommandPicks(){return[]}};bw=WIe([Pp(0,Ce),Pp(1,gt),Pp(2,vt),Pp(3,Ft),Pp(4,Fn),Pp(5,Tw)],bw);const ZE=class ZE extends de{constructor(){super({id:ZE.ID,label:ax.quickCommandActionLabel,alias:"Command Palette",precondition:void 0,kbOpts:{kbExpr:T.focus,primary:59,weight:100},contextMenuOpts:{group:"z_commands",order:1}})}run(e){e.get(vr).quickAccess.show(bw.PREFIX)}};ZE.ID="editor.action.quickCommand";let fk=ZE;X(fk);ai.as(Yf.Quickaccess).registerQuickAccessProvider({ctor:bw,prefix:bw.PREFIX,helpEntries:[{description:ax.quickCommandHelp,commandId:fk.ID}]});var VIe=function(o,e,t,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(o,e,t,i);else for(var a=o.length-1;a>=0;a--)(r=o[a])&&(s=(n<3?r(s):n>3?r(e,t,s):r(e,t))||s);return n>3&&s&&Object.defineProperty(e,t,s),s},Ap=function(o,e){return function(t,i){e(t,i,o)}};let f4=class extends Bf{constructor(e,t,i,n,s,r,a){super(!0,e,t,i,n,s,r,a)}};f4=VIe([Ap(1,Ee),Ap(2,gt),Ap(3,Ei),Ap(4,Ce),Ap(5,Yr),Ap(6,Ke)],f4);at(Bf.ID,f4,4);class HIe extends de{constructor(){super({id:"editor.action.toggleHighContrast",label:_A.toggleHighContrast,alias:"Toggle High Contrast Theme",precondition:void 0}),this._originalThemeName=null}run(e,t){const i=e.get(Ko),n=i.getColorTheme();xa(n.type)?(i.setTheme(this._originalThemeName||(v_(n.type)?Gm:yc)),this._originalThemeName=null):(i.setTheme(v_(n.type)?ug:gg),this._originalThemeName=n.themeName)}}X(HIe);var GN={exports:{}},W6;function zIe(){return W6||(W6=1,function(o){var e=function(){var t=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function r(l,c){if(!s[l]){s[l]={};for(var d=0;d<l.length;d++)s[l][l.charAt(d)]=d}return s[l][c]}var a={compressToBase64:function(l){if(l==null)return"";var c=a._compress(l,6,function(d){return i.charAt(d)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:a._decompress(l.length,32,function(c){return r(i,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":a._compress(l,15,function(c){return t(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:a._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=a.compress(l),d=new Uint8Array(c.length*2),h=0,u=c.length;h<u;h++){var g=c.charCodeAt(h);d[h*2]=g>>>8,d[h*2+1]=g%256}return d},decompressFromUint8Array:function(l){if(l==null)return a.decompress(l);for(var c=new Array(l.length/2),d=0,h=c.length;d<h;d++)c[d]=l[d*2]*256+l[d*2+1];var u=[];return c.forEach(function(g){u.push(t(g))}),a.decompress(u.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":a._compress(l,6,function(c){return n.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),a._decompress(l.length,32,function(c){return r(n,l.charAt(c))}))},compress:function(l){return a._compress(l,16,function(c){return t(c)})},_compress:function(l,c,d){if(l==null)return"";var h,u,g={},f={},m="",_="",b="",v=2,y=3,C=2,w=[],x=0,k=0,E;for(E=0;E<l.length;E+=1)if(m=l.charAt(E),Object.prototype.hasOwnProperty.call(g,m)||(g[m]=y++,f[m]=!0),_=b+m,Object.prototype.hasOwnProperty.call(g,_))b=_;else{if(Object.prototype.hasOwnProperty.call(f,b)){if(b.charCodeAt(0)<256){for(h=0;h<C;h++)x=x<<1,k==c-1?(k=0,w.push(d(x)),x=0):k++;for(u=b.charCodeAt(0),h=0;h<8;h++)x=x<<1|u&1,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=u>>1}else{for(u=1,h=0;h<C;h++)x=x<<1|u,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=0;for(u=b.charCodeAt(0),h=0;h<16;h++)x=x<<1|u&1,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=u>>1}v--,v==0&&(v=Math.pow(2,C),C++),delete f[b]}else for(u=g[b],h=0;h<C;h++)x=x<<1|u&1,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=u>>1;v--,v==0&&(v=Math.pow(2,C),C++),g[_]=y++,b=String(m)}if(b!==""){if(Object.prototype.hasOwnProperty.call(f,b)){if(b.charCodeAt(0)<256){for(h=0;h<C;h++)x=x<<1,k==c-1?(k=0,w.push(d(x)),x=0):k++;for(u=b.charCodeAt(0),h=0;h<8;h++)x=x<<1|u&1,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=u>>1}else{for(u=1,h=0;h<C;h++)x=x<<1|u,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=0;for(u=b.charCodeAt(0),h=0;h<16;h++)x=x<<1|u&1,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=u>>1}v--,v==0&&(v=Math.pow(2,C),C++),delete f[b]}else for(u=g[b],h=0;h<C;h++)x=x<<1|u&1,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=u>>1;v--,v==0&&(v=Math.pow(2,C),C++)}for(u=2,h=0;h<C;h++)x=x<<1|u&1,k==c-1?(k=0,w.push(d(x)),x=0):k++,u=u>>1;for(;;)if(x=x<<1,k==c-1){w.push(d(x));break}else k++;return w.join("")},decompress:function(l){return l==null?"":l==""?null:a._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,d){var h=[],u=4,g=4,f=3,m="",_=[],b,v,y,C,w,x,k,E={val:d(0),position:c,index:1};for(b=0;b<3;b+=1)h[b]=b;for(y=0,w=Math.pow(2,2),x=1;x!=w;)C=E.val&E.position,E.position>>=1,E.position==0&&(E.position=c,E.val=d(E.index++)),y|=(C>0?1:0)*x,x<<=1;switch(y){case 0:for(y=0,w=Math.pow(2,8),x=1;x!=w;)C=E.val&E.position,E.position>>=1,E.position==0&&(E.position=c,E.val=d(E.index++)),y|=(C>0?1:0)*x,x<<=1;k=t(y);break;case 1:for(y=0,w=Math.pow(2,16),x=1;x!=w;)C=E.val&E.position,E.position>>=1,E.position==0&&(E.position=c,E.val=d(E.index++)),y|=(C>0?1:0)*x,x<<=1;k=t(y);break;case 2:return""}for(h[3]=k,v=k,_.push(k);;){if(E.index>l)return"";for(y=0,w=Math.pow(2,f),x=1;x!=w;)C=E.val&E.position,E.position>>=1,E.position==0&&(E.position=c,E.val=d(E.index++)),y|=(C>0?1:0)*x,x<<=1;switch(k=y){case 0:for(y=0,w=Math.pow(2,8),x=1;x!=w;)C=E.val&E.position,E.position>>=1,E.position==0&&(E.position=c,E.val=d(E.index++)),y|=(C>0?1:0)*x,x<<=1;h[g++]=t(y),k=g-1,u--;break;case 1:for(y=0,w=Math.pow(2,16),x=1;x!=w;)C=E.val&E.position,E.position>>=1,E.position==0&&(E.position=c,E.val=d(E.index++)),y|=(C>0?1:0)*x,x<<=1;h[g++]=t(y),k=g-1,u--;break;case 2:return _.join("")}if(u==0&&(u=Math.pow(2,f),f++),h[k])m=h[k];else if(k===g)m=v+v.charAt(0);else return null;_.push(m),h[g++]=v+m.charAt(0),u--,v=m,u==0&&(u=Math.pow(2,f),f++)}}};return a}();o!=null?o.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})}(GN)),GN.exports}var yY=zIe();function V6(o){return new Worker("/excalibur-playground/assets/ts.worker-DeK82eqm.js",{name:o?.name})}const UIe=`/**
 * Flags is a feature flag implementation for Excalibur. They can only be operated **before {@apilink Engine} construction**
 * after which they are frozen and are read-only.
 *
 * Flags are used to enable experimental or preview features in Excalibur.
 */
declare class Flags {
    private static _FROZEN;
    private static _FLAGS;
    /**
     * Force excalibur to load the Canvas 2D graphics context fallback
     * @warning not all features of excalibur are supported in the Canvas 2D fallback
     */
    static useCanvasGraphicsContext(): void;
    /**
     * Force excalibur to use the less optimized image renderer
     */
    static useLegacyImageRenderer(): void;
    /**
     * Freeze all flag modifications making them readonly
     */
    static freeze(): void;
    /**
     * Resets internal flag state, not meant to be called by users. Only used for testing.
     *
     * Calling this in your game is UNSUPPORTED
     * @internal
     */
    static _reset(): void;
    /**
     * Enable a specific feature flag by name. **Note: can only be set before {@apilink Engine} constructor time**
     * @param flagName
     */
    static enable(flagName: string): void;
    /**
     * Disable a specific feature flag by name. **Note: can only be set before {@apilink Engine} constructor time**
     * @param flagName
     */
    static disable(flagName: string): void;
    /**
     * Check if a flag is enabled. If the flag is disabled or does not exist \`false\` is returned
     * @param flagName
     */
    static isEnabled(flagName: string): boolean;
    /**
     * Show a list of currently known flags
     */
    static show(): string[];
}

type Id<T extends string> = {
    type: T;
    value: number;
};
/**
 * Create a branded ID type from a number
 */
declare function createId<T extends string>(type: T, value: number): Id<T>;

type EventMap = Record<string, any>;
type EventKey<T extends EventMap> = string & keyof T;
type Handler<EventType> = (event: EventType) => void;
/**
 * Interface that represents a handle to a subscription that can be closed
 */
interface Subscription {
    /**
     * Removes the associated event handler, synonymous with events.off(...);
     */
    close(): void;
}
/**
 * Excalibur's typed event emitter, this allows events to be sent with any string to Type mapping
 */
declare class EventEmitter<TEventMap extends EventMap = any> {
    private _paused;
    private _empty;
    private _listeners;
    private _listenersOnce;
    private _pipes;
    /**
     * Removes all listeners and pipes
     */
    clear(): void;
    on<TEventName extends EventKey<TEventMap>>(eventName: TEventName, handler: Handler<TEventMap[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<TEventMap>>(eventName: TEventName, handler: Handler<TEventMap[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<TEventMap>>(eventName: TEventName, handler: Handler<TEventMap[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    emit<TEventName extends EventKey<TEventMap>>(eventName: TEventName, event: TEventMap[TEventName]): void;
    emit(eventName: string, event?: any): void;
    /**
     * Replay events from this emitter to another
     * @param emitter
     */
    pipe(emitter: EventEmitter<any>): Subscription;
    /**
     * Remove any piped emitters
     * @param emitter
     */
    unpipe(emitter: EventEmitter<any>): void;
    /**
     * Paused event emitters do not emit events
     */
    pause(): void;
    /**
     * Unpaused event emitter do emit events
     */
    unpause(): void;
}

/**
 * Determines the scope of handling mouse/touch events.
 */
declare enum PointerScope {
    /**
     * Handle events on the \`canvas\` element only. Events originating outside the
     * \`canvas\` will not be handled.
     */
    Canvas = "Canvas",
    /**
     * Handles events on the entire document. All events will be handled by Excalibur.
     */
    Document = "Document"
}

/**
 * Provides standard colors (e.g. {@apilink Color.Black})
 * but you can also create custom colors using RGB, HSL, or Hex. Also provides
 * useful color operations like {@apilink Color.lighten}, {@apilink Color.darken}, and more.
 */
declare class Color {
    /**
     * Red channel
     */
    r: number;
    /**
     * Green channel
     */
    g: number;
    /**
     * Blue channel
     */
    b: number;
    /**
     * Alpha channel (between 0 and 1)
     */
    a: number;
    /**
     * Hue
     */
    h: number;
    /**
     * Saturation
     */
    s: number;
    /**
     * Lightness
     */
    l: number;
    /**
     * Creates a new instance of Color from an r, g, b, a
     * @param r  The red component of color (0-255)
     * @param g  The green component of color (0-255)
     * @param b  The blue component of color (0-255)
     * @param a  The alpha component of color (0-1.0)
     */
    constructor(r: number, g: number, b: number, a?: number);
    /**
     * Creates a new instance of Color from an r, g, b, a
     * @param r  The red component of color (0-255)
     * @param g  The green component of color (0-255)
     * @param b  The blue component of color (0-255)
     * @param a  The alpha component of color (0-1.0)
     */
    static fromRGB(r: number, g: number, b: number, a?: number): Color;
    /**
     * Creates a new instance of Color from a rgb string
     * @param string  CSS color string of the form rgba(255, 255, 255, 1) or rgb(255, 255, 255)
     */
    static fromRGBString(string: string): Color;
    /**
     * Creates a new instance of Color from a hex string
     * @param hex  CSS color string of the form #ffffff, the alpha component is optional
     */
    static fromHex(hex: string): Color;
    /**
     * Creates a new instance of Color from hsla values
     * @param h  Hue is represented [0-1]
     * @param s  Saturation is represented [0-1]
     * @param l  Luminance is represented [0-1]
     * @param a  Alpha is represented [0-1]
     */
    static fromHSL(h: number, s: number, l: number, a?: number): Color;
    /**
     * Lightens the current color by a specified amount
     * @param factor  The amount to lighten by [0-1]
     */
    lighten(factor?: number): Color;
    /**
     * Darkens the current color by a specified amount
     * @param factor  The amount to darken by [0-1]
     */
    darken(factor?: number): Color;
    /**
     * Saturates the current color by a specified amount
     * @param factor  The amount to saturate by [0-1]
     */
    saturate(factor?: number): Color;
    /**
     * Desaturates the current color by a specified amount
     * @param factor  The amount to desaturate by [0-1]
     */
    desaturate(factor?: number): Color;
    /**
     * Multiplies a color by another, results in a darker color
     * @param color  The other color
     */
    multiply(color: Color): Color;
    /**
     * Screens a color by another, results in a lighter color
     * @param color  The other color
     */
    screen(color: Color): Color;
    /**
     * Inverts the current color
     */
    invert(): Color;
    /**
     * Averages the current color with another
     * @param color  The other color
     */
    average(color: Color): Color;
    equal(color: Color): boolean;
    /**
     * Returns a CSS string representation of a color.
     * @param format Color representation, accepts: rgb, hsl, or hex
     */
    toString(format?: 'rgb' | 'hsl' | 'hex'): string;
    /**
     * Returns Hex Value of a color component
     * @param c color component
     * @see https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb
     */
    private _componentToHex;
    /**
     * Return Hex representation of a color.
     */
    toHex(): string;
    /**
     * Return RGBA representation of a color.
     */
    toRGBA(): string;
    /**
     * Return HSLA representation of a color.
     */
    toHSLA(): string;
    /**
     * Returns a CSS string representation of a color.
     */
    fillStyle(): string;
    /**
     * Returns a clone of the current color.
     */
    clone(dest?: Color): Color;
    /**
     * Black (#000000)
     */
    static get Black(): Color;
    /**
     * White (#FFFFFF)
     */
    static get White(): Color;
    /**
     * Gray (#808080)
     */
    static get Gray(): Color;
    /**
     * Light gray (#D3D3D3)
     */
    static get LightGray(): Color;
    /**
     * Dark gray (#A9A9A9)
     */
    static get DarkGray(): Color;
    /**
     * Yellow (#FFFF00)
     */
    static get Yellow(): Color;
    /**
     * Orange (#FFA500)
     */
    static get Orange(): Color;
    /**
     * Red (#FF0000)
     */
    static get Red(): Color;
    /**
     * Vermilion (#FF5B31)
     */
    static get Vermilion(): Color;
    /**
     * Rose (#FF007F)
     */
    static get Rose(): Color;
    /**
     * Pink (#FFC0CB)
     */
    static get Pink(): Color;
    /**
     * Magenta (#FF00FF)
     */
    static get Magenta(): Color;
    /**
     * Violet (#7F00FF)
     */
    static get Violet(): Color;
    /**
     * Purple (#800080)
     */
    static get Purple(): Color;
    /**
     * Blue (#0000FF)
     */
    static get Blue(): Color;
    /**
     * Azure (#007FFF)
     */
    static get Azure(): Color;
    /**
     * Cyan (#00FFFF)
     */
    static get Cyan(): Color;
    /**
     * Viridian (#59978F)
     */
    static get Viridian(): Color;
    /**
     * Teal (#008080)
     */
    static get Teal(): Color;
    /**
     * Green (#00FF00)
     */
    static get Green(): Color;
    /**
     * Chartreuse (#7FFF00)
     */
    static get Chartreuse(): Color;
    /**
     * Transparent (#FFFFFF00)
     */
    static get Transparent(): Color;
    /**
     * ExcaliburBlue (#176BAA)
     */
    static get ExcaliburBlue(): Color;
    /**
     * Brown (#964B00)
     */
    static get Brown(): Color;
}

/**
 * Logging level that Excalibur will tag
 */
declare enum LogLevel {
    Debug = 0,
    Info = 1,
    Warn = 2,
    Error = 3,
    Fatal = 4
}
/**
 * Static singleton that represents the logging facility for Excalibur.
 * Excalibur comes built-in with a {@apilink ConsoleAppender} and {@apilink ScreenAppender}.
 * Derive from {@apilink Appender} to create your own logging appenders.
 */
declare class Logger {
    private static _INSTANCE;
    private _appenders;
    constructor();
    /**
     * Gets or sets the default logging level. Excalibur will only log
     * messages if equal to or above this level. Default: {@apilink LogLevel.Info}
     */
    defaultLevel: LogLevel;
    /**
     * Gets the current static instance of Logger
     */
    static getInstance(): Logger;
    /**
     * Adds a new {@apilink Appender} to the list of appenders to write to
     */
    addAppender(appender: Appender): void;
    /**
     * Clears all appenders from the logger
     */
    clearAppenders(): void;
    /**
     * Logs a message at a given LogLevel
     * @param level  The LogLevel\`to log the message at
     * @param args   An array of arguments to write to an appender
     */
    private _log;
    private _logOnceSet;
    private _logOnce;
    /**
     * Writes a log message at the {@apilink LogLevel.Debug} level
     * @param args  Accepts any number of arguments
     */
    debug(...args: any[]): void;
    /**
     * Writes a log message once at the {@apilink LogLevel.Fatal} level, if it sees the same args again it wont log
     * @param args  Accepts any number of arguments
     */
    debugOnce(...args: any[]): void;
    /**
     * Writes a log message at the {@apilink LogLevel.Info} level
     * @param args  Accepts any number of arguments
     */
    info(...args: any[]): void;
    /**
     * Writes a log message once at the {@apilink LogLevel.Info} level, if it sees the same args again it wont log
     * @param args  Accepts any number of arguments
     */
    infoOnce(...args: any[]): void;
    /**
     * Writes a log message at the {@apilink LogLevel.Warn} level
     * @param args  Accepts any number of arguments
     */
    warn(...args: any[]): void;
    /**
     * Writes a log message once at the {@apilink LogLevel.Warn} level, if it sees the same args again it won't log
     * @param args  Accepts any number of arguments
     */
    warnOnce(...args: any[]): void;
    /**
     * Writes a log message at the {@apilink LogLevel.Error} level
     * @param args  Accepts any number of arguments
     */
    error(...args: any[]): void;
    /**
     * Writes a log message once at the {@apilink LogLevel.Error} level, if it sees the same args again it won't log
     * @param args  Accepts any number of arguments
     */
    errorOnce(...args: any[]): void;
    /**
     * Writes a log message at the {@apilink LogLevel.Fatal} level
     * @param args  Accepts any number of arguments
     */
    fatal(...args: any[]): void;
    /**
     * Writes a log message once at the {@apilink LogLevel.Fatal} level, if it sees the same args again it won't log
     * @param args  Accepts any number of arguments
     */
    fatalOnce(...args: any[]): void;
}
/**
 * Contract for any log appender (such as console/screen)
 */
interface Appender {
    /**
     * Logs a message at the given {@apilink LogLevel}
     * @param level  Level to log at
     * @param args   Arguments to log
     */
    log(level: LogLevel, args: any[]): void;
}
/**
 * Console appender for browsers (i.e. \`console.log\`)
 */
declare class ConsoleAppender implements Appender {
    /**
     * Logs a message at the given {@apilink LogLevel}
     * @param level  Level to log at
     * @param args   Arguments to log
     */
    log(level: LogLevel, args: any[]): void;
}
interface ScreenAppenderOptions {
    engine: Engine;
    /**
     * Optionally set the width of the overlay canvas
     */
    width?: number;
    /**
     * Optionally set the height of the overlay canvas
     */
    height?: number;
    /**
     * Adjust the text offset from the left side of the screen
     */
    xPos?: number;
    /**
     * Provide a text color
     */
    color?: Color;
    /**
     * Optionally set the CSS zindex of the overlay canvas
     */
    zIndex?: number;
}
/**
 * On-screen (canvas) appender
 */
declare class ScreenAppender implements Appender {
    private _messages;
    canvas: HTMLCanvasElement;
    private _ctx;
    private _pos;
    private _color;
    private _options;
    constructor(options: ScreenAppenderOptions);
    private _positionScreenAppenderCanvas;
    /**
     * Logs a message at the given {@apilink LogLevel}
     * @param level  Level to log at
     * @param args   Arguments to log
     */
    log(level: LogLevel, args: any[]): void;
}

interface Clonable<T> {
    clone(): T;
}

/**
 * An enum that describes the strategies that rotation actions can use
 */
declare enum RotationType {
    /**
     * Rotation via \`ShortestPath\` will use the smallest angle
     * between the starting and ending points. This strategy is the default behavior.
     */
    ShortestPath = "shortest-path",
    /**
     * Rotation via \`LongestPath\` will use the largest angle
     * between the starting and ending points.
     */
    LongestPath = "longest-path",
    /**
     * Rotation via \`Clockwise\` will travel in a clockwise direction,
     * regardless of the starting and ending points.
     */
    Clockwise = "clockwise",
    /**
     * Rotation via \`CounterClockwise\` will travel in a counterclockwise direction,
     * regardless of the starting and ending points.
     */
    CounterClockwise = "counter-clockwise"
}

/**
 * A 2D vector on a plane.
 */
declare class Vector implements Clonable<Vector> {
    /**
     * Get or set the vector equals epsilon, by default 0.001 meaning vectors within that tolerance on x or y will be considered equal.
     */
    static EQUALS_EPSILON: number;
    /**
     * A (0, 0) vector
     */
    static get Zero(): Vector;
    /**
     * A (1, 1) vector
     */
    static get One(): Vector;
    /**
     * A (0.5, 0.5) vector
     */
    static get Half(): Vector;
    /**
     * A unit vector pointing up (0, -1)
     */
    static get Up(): Vector;
    /**
     * A unit vector pointing down (0, 1)
     */
    static get Down(): Vector;
    /**
     * A unit vector pointing left (-1, 0)
     */
    static get Left(): Vector;
    /**
     * A unit vector pointing right (1, 0)
     */
    static get Right(): Vector;
    /**
     * Returns a vector of unit length in the direction of the specified angle in Radians.
     * @param angle The angle to generate the vector
     */
    static fromAngle(angle: number): Vector;
    /**
     * Checks if vector is not null, undefined, or if any of its components are NaN or Infinity.
     */
    static isValid(vec: Vector): boolean;
    /**
     * Calculates distance between two Vectors
     * @param vec1
     * @param vec2
     */
    static distance(vec1: Vector, vec2: Vector): number;
    static min(vec1: Vector, vec2: Vector): Vector;
    static max(vec1: Vector, vec2: Vector): Vector;
    /**
     * @param x  X component of the Vector
     * @param y  Y component of the Vector
     */
    constructor(x: number, y: number);
    protected _x: number;
    /**
     * Get the x component of the vector
     */
    get x(): number;
    /**
     * Set the x component, THIS MUTATES the current vector. It is usually better to create a new vector.
     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**
     */
    set x(val: number);
    protected _y: number;
    /**
     * Get the y component of the vector
     */
    get y(): number;
    /**
     * Set the y component, THIS MUTATES the current vector. It is usually better to create a new vector.
     * @warning **Be very careful setting components on shared vectors, mutating shared vectors can cause hard to find bugs**
     */
    set y(val: number);
    /**
     * Sets the x and y components at once, THIS MUTATES the current vector. It is usually better to create a new vector.
     * @warning **Be very careful using this, mutating vectors can cause hard to find bugs**
     */
    setTo(x: number, y: number): void;
    /**
     * Compares this point against another and tests for equality
     * @param vector The other point to compare to
     * @param tolerance Amount of euclidean distance off we are willing to tolerate
     */
    equals(vector: Vector, tolerance?: number): boolean;
    /**
     * The distance to another vector. If no other Vector is specified, this will return the {@apilink magnitude}.
     * @param v  The other vector. Leave blank to use origin vector.
     */
    distance(v?: Vector): number;
    squareDistance(v?: Vector): number;
    /**
     * Clamps the current vector's magnitude mutating it
     * @param magnitude
     */
    clampMagnitude(magnitude: number): Vector;
    /**
     * The size (magnitude) of the Vector
     * @deprecated Will be removed in v1, use Vector.magnitude
     */
    get size(): number;
    /**
     * Setting the size mutates the current vector
     * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**
     * @deprecated Will be removed in v1, use Vector.magnitude
     */
    set size(newLength: number);
    /**
     * The magnitude (length) of the Vector
     */
    get magnitude(): number;
    /**
     * Setting the size mutates the current vector
     * @warning Can be used to set the size of the vector, **be very careful using this, mutating vectors can cause hard to find bugs**
     */
    set magnitude(newMagnitude: number);
    /**
     * Normalizes a non-zero vector to have a magnitude of 1. Zero vectors return a new zero vector.
     */
    normalize(): Vector;
    /**
     * Returns the average (midpoint) between the current point and the specified
     */
    average(vec: Vector): Vector;
    /**
     * Scales a vector's by a factor of size
     * @param size  The factor to scale the magnitude by
     * @param dest  Optionally provide a destination vector for the result
     */
    scale(scale: Vector, dest?: Vector): Vector;
    scale(size: number, dest?: Vector): Vector;
    /**
     * Adds one vector to another
     * @param v The vector to add
     * @param dest Optionally copy the result into a provided vector
     */
    add(v: Vector, dest?: Vector): Vector;
    /**
     * Subtracts a vector from another, if you subtract vector \`B.sub(A)\` the resulting vector points from A -> B
     * @param v The vector to subtract
     */
    sub(v: Vector, dest?: Vector): Vector;
    /**
     * Adds one vector to this one modifying the original
     * @param v The vector to add
     * @warning Be very careful using this, mutating vectors can cause hard to find bugs
     */
    addEqual(v: Vector): Vector;
    /**
     * Subtracts a vector from this one modifying the original
     * @param v The vector to subtract
     * @warning Be very careful using this, mutating vectors can cause hard to find bugs
     */
    subEqual(v: Vector): Vector;
    /**
     * Scales this vector by a factor of size and modifies the original
     * @warning Be very careful using this, mutating vectors can cause hard to find bugs
     */
    scaleEqual(size: number): Vector;
    /**
     * Performs a dot product with another vector
     * @param v  The vector to dot
     */
    dot(v: Vector): number;
    /**
     * Performs a 2D cross product with scalar. 2D cross products with a scalar return a vector.
     * @param v  The scalar to cross
     */
    cross(v: number): Vector;
    /**
     * Performs a 2D cross product with another vector. 2D cross products return a scalar value not a vector.
     * @param v  The vector to cross
     */
    cross(v: Vector): number;
    static cross(num: number, vec: Vector): Vector;
    /**
     * Returns the perpendicular vector to this one
     */
    perpendicular(): Vector;
    /**
     * Returns the normal vector to this one, same as the perpendicular of length 1
     */
    normal(): Vector;
    /**
     * Negate the current vector
     */
    negate(): Vector;
    /**
     * Returns the angle of this vector, in range [0, 2*PI)
     */
    toAngle(): number;
    /**
     * Returns the difference in radians between the angle of this vector and given angle,
     * using the given rotation type.
     * @param angle in radians to which the vector has to be rotated, using {@apilink rotate}
     * @param rotationType what {@apilink RotationType} to use for the rotation
     * @returns the angle by which the vector needs to be rotated to match the given angle
     */
    angleBetween(angle: number, rotationType: RotationType): number;
    /**
     * Rotates the current vector around a point by a certain angle in radians.
     * Positive angle means rotation clockwise.
     */
    rotate(angle: number, anchor?: Vector, dest?: Vector): Vector;
    /**
     * Creates new vector that has the same values as the previous.
     */
    clone(dest?: Vector): Vector;
    /**
     * Returns a string representation of the vector.
     */
    toString(fixed?: number): string;
    /**
     * Linearly interpolates between the current vector and the target vector.
     * At \`t = 0\`, the result is the current vector, and at \`t = 1\`, the result is the target vector.
     * Values of \`t\` outside the range [0, 1] will be clamped to that range.
     *
     * @param target The target vector to interpolate towards.
     * @param t The interpolation factor, clamped between 0 and 1.
     * @returns A new vector that is the result of the linear interpolation.
     */
    lerp(target: Vector, t: number): Vector;
}
/**
 * Shorthand for creating new Vectors - returns a new Vector instance with the
 * provided X and Y components.
 * @param x  X component of the Vector
 * @param y  Y component of the Vector
 */
declare function vec(x: number, y: number): Vector;

/**
 * An enum that describes the types of collisions bodies can participate in
 */
declare enum CollisionType {
    /**
     * Bodies with the \`PreventCollision\` setting do not participate in any
     * collisions and do not raise collision events.
     */
    PreventCollision = "PreventCollision",
    /**
     * Bodies with the \`Passive\` setting only raise collision events, but are not
     * influenced or moved by other bodies and do not influence or move other bodies.
     * This is useful for use in trigger type behavior.
     */
    Passive = "Passive",
    /**
     * Bodies with the \`Active\` setting raise collision events and participate
     * in collisions with other bodies and will be push or moved by bodies sharing
     * the \`Active\` or \`Fixed\` setting.
     */
    Active = "Active",
    /**
     * Bodies with the \`Fixed\` setting raise collision events and participate in
     * collisions with other bodies. Actors with the \`Fixed\` setting will not be
     * pushed or moved by other bodies sharing the \`Fixed\`. Think of Fixed
     * bodies as "immovable/unstoppable" objects. If two \`Fixed\` bodies meet they will
     * not be pushed or moved by each other, they will not interact except to throw
     * collision events.
     */
    Fixed = "Fixed"
}

/**
 * Enum representing the coordinate plane for the position 2D vector in the {@apilink TransformComponent}
 */
declare enum CoordPlane {
    /**
     * The world coordinate plane (default) represents world space, any entities drawn with world
     * space move when the camera moves.
     */
    World = "world",
    /**
     * The screen coordinate plane represents screen space, entities drawn in screen space are pinned
     * to screen coordinates ignoring the camera.
     */
    Screen = "screen"
}

declare enum MatrixLocations {
    X = 12,
    Y = 13
}
/**
 * Excalibur Matrix helper for 4x4 matrices
 *
 * Useful for webgl 4x4 matrices
 */
declare class Matrix {
    /**
     *  4x4 matrix in column major order
     *
     * |         |         |          |          |
     * | ------- | ------- | -------- | -------- |
     * | data[0] | data[4] | data[8]  | data[12] |
     * | data[1] | data[5] | data[9]  | data[13] |
     * | data[2] | data[6] | data[10] | data[14] |
     * | data[3] | data[7] | data[11] | data[15] |
     *
     */
    data: Float32Array;
    /**
     * Creates an orthographic (flat non-perspective) projection
     * https://en.wikipedia.org/wiki/Orthographic_projection
     * @param left
     * @param right
     * @param bottom
     * @param top
     * @param near
     * @param far
     */
    static ortho(left: number, right: number, bottom: number, top: number, near: number, far: number): Matrix;
    /**
     * Creates a new Matrix with the same data as the current 4x4
     */
    clone(dest?: Matrix): Matrix;
    /**
     * Converts the current matrix into a DOMMatrix
     *
     * This is useful when working with the browser Canvas context
     * @returns {DOMMatrix} DOMMatrix
     */
    toDOMMatrix(): DOMMatrix;
    static fromFloat32Array(data: Float32Array): Matrix;
    /**
     * Creates a new identity matrix (a matrix that when applied does nothing)
     */
    static identity(): Matrix;
    /**
     * Resets the current matrix to the identity matrix, mutating it
     * @returns {Matrix} Current matrix as identity
     */
    reset(): Matrix;
    /**
     * Creates a brand new translation matrix at the specified 3d point
     * @param x
     * @param y
     */
    static translation(x: number, y: number): Matrix;
    /**
     * Creates a brand new scaling matrix with the specified scaling factor
     * @param sx
     * @param sy
     */
    static scale(sx: number, sy: number): Matrix;
    /**
     * Creates a brand new rotation matrix with the specified angle in radians
     * @param angle
     */
    static rotation(angle: number): Matrix;
    /**
     * Multiply the current matrix by a vector producing a new vector
     * @param vector
     * @param dest
     */
    multiply(vector: Vector, dest?: Vector): Vector;
    /**
     * Multiply the current matrix by another matrix producing a new matrix
     * @param matrix
     * @param dest
     */
    multiply(matrix: Matrix, dest?: Matrix): Matrix;
    /**
     * Applies translation to the current matrix mutating it
     * @param x
     * @param y
     */
    translate(x: number, y: number): this;
    setPosition(x: number, y: number): void;
    getPosition(): Vector;
    /**
     * Applies rotation to the current matrix mutating it
     * @param angle in Radians
     */
    rotate(angle: number): this;
    /**
     * Applies scaling to the current matrix mutating it
     * @param x
     * @param y
     */
    scale(x: number, y: number): this;
    setRotation(angle: number): void;
    getRotation(): number;
    getScaleX(): number;
    getScaleY(): number;
    /**
     * Get the scale of the matrix
     */
    getScale(): Vector;
    private _scaleX;
    private _scaleSignX;
    setScaleX(val: number): void;
    private _scaleY;
    private _scaleSignY;
    setScaleY(val: number): void;
    setScale(scale: Vector): void;
    /**
     * Determinant of the upper left 2x2 matrix
     */
    getBasisDeterminant(): number;
    /**
     * Return the affine inverse, optionally store it in a target matrix.
     *
     * It's recommended you call .reset() the target unless you know what you're doing
     * @param target
     */
    getAffineInverse(target?: Matrix): Matrix;
    isIdentity(): boolean;
    toString(): string;
}

declare class AffineMatrix {
    /**
     * |         |         |          |
     * | ------- | ------- | -------- |
     * | data[0] | data[2] | data[4]  |
     * | data[1] | data[3] | data[5]  |
     * |   0     |    0    |    1     |
     */
    data: Float64Array<ArrayBuffer>;
    /**
     * Converts the current matrix into a DOMMatrix
     *
     * This is useful when working with the browser Canvas context
     * @returns {DOMMatrix} DOMMatrix
     */
    toDOMMatrix(): DOMMatrix;
    static identity(): AffineMatrix;
    /**
     * Creates a brand new translation matrix at the specified 3d point
     * @param x
     * @param y
     */
    static translation(x: number, y: number): AffineMatrix;
    /**
     * Creates a brand new scaling matrix with the specified scaling factor
     * @param sx
     * @param sy
     */
    static scale(sx: number, sy: number): AffineMatrix;
    /**
     * Creates a brand new rotation matrix with the specified angle in radians
     * @param angle
     */
    static rotation(angle: number): AffineMatrix;
    setPosition(x: number, y: number): void;
    getPosition(): Vector;
    /**
     * Applies rotation to the current matrix mutating it
     * @param angle in Radians
     */
    rotate(angle: number): this;
    /**
     * Applies translation to the current matrix mutating it
     * @param x
     * @param y
     */
    translate(x: number, y: number): this;
    /**
     * Applies scaling to the current matrix mutating it
     * @param x
     * @param y
     */
    scale(x: number, y: number): this;
    determinant(): number;
    /**
     * Return the affine inverse, optionally store it in a target matrix.
     *
     * It's recommended you call .reset() the target unless you know what you're doing
     * @param target
     */
    inverse(target?: AffineMatrix): AffineMatrix;
    /**
     * Multiply the current matrix by a vector producing a new vector
     * @param vector
     * @param dest
     */
    multiply(vector: Vector, dest?: Vector): Vector;
    /**
     * Multiply the current matrix by another matrix producing a new matrix
     * @param matrix
     * @param dest
     */
    multiply(matrix: AffineMatrix, dest?: AffineMatrix): AffineMatrix;
    /**
     * Packed array of length 8, that contains 4 vertices, with 2 components each
     * So: [x0, y0, x1, y1, x2, y2, x3, y3]
     * @param quad
     */
    multiplyQuadInPlace(quad: number[]): void;
    to4x4(): Matrix;
    setRotation(angle: number): void;
    getRotation(): number;
    getScaleX(): number;
    getScaleY(): number;
    /**
     * Get the scale of the matrix
     */
    getScale(): Vector;
    private _scale;
    private _scaleSignX;
    setScaleX(val: number): void;
    private _scaleSignY;
    setScaleY(val: number): void;
    setScale(scale: Vector): void;
    isIdentity(): boolean;
    /**
     * Resets the current matrix to the identity matrix, mutating it
     * @returns {AffineMatrix} Current matrix as identity
     */
    reset(): AffineMatrix;
    /**
     * Creates a new Matrix with the same data as the current {@apilink AffineMatrix}
     */
    clone(dest?: AffineMatrix): AffineMatrix;
    toString(): string;
}

declare class Transform {
    private _parent;
    get parent(): Transform | null;
    set parent(transform: Transform | null);
    get children(): readonly Transform[];
    private _children;
    private _pos;
    set pos(v: Vector);
    get pos(): Vector;
    set globalPos(v: Vector);
    private _globalPos;
    get globalPos(): Vector;
    private _rotation;
    set rotation(rotation: number);
    get rotation(): number;
    set globalRotation(rotation: number);
    get globalRotation(): number;
    private _scale;
    set scale(v: Vector);
    get scale(): Vector;
    set globalScale(v: Vector);
    private _globalScale;
    get globalScale(): Vector;
    private _z;
    set z(z: number);
    get z(): number;
    set globalZ(z: number);
    get globalZ(): number;
    private _isDirty;
    private _isInverseDirty;
    private _matrix;
    private _inverse;
    /**
     * Calculates and returns the matrix representation of this transform
     *
     * Avoid mutating the matrix to update the transform, it is not the source of truth.
     * Update the transform pos, rotation, scale.
     */
    get matrix(): AffineMatrix;
    /**
     * Calculates and returns the inverse matrix representation of this transform
     */
    get inverse(): AffineMatrix;
    private _scratch;
    private _calculateMatrix;
    flagDirty(): void;
    apply(point: Vector): Vector;
    applyInverse(point: Vector): Vector;
    setTransform(pos: Vector, rotation: number, scale: Vector): void;
    /**
     * Returns true if the transform has a negative x scale or y scale, but not both
     */
    isMirrored(): boolean;
    /**
     * Clones the current transform
     * **Warning does not clone the parent**
     * @param dest
     */
    clone(dest?: Transform): Transform;
    /**
     * Clones but keeps the same parent reference
     */
    cloneWithParent(dest?: Transform): Transform;
    toString(): string;
}

/**
 * Defines a generic message that can contain any data
 * @template T is the typescript Type of the data
 */
interface Message<T> {
    type: string;
    data: T;
}
/**
 * Defines an interface for an observer to receive a message via a notify() method
 */
interface Observer<T> {
    notify(message: T): void;
}
/**
 * Defines an interface for something that might be an observer if a notify() is present
 */
type MaybeObserver<T> = Partial<Observer<T>>;
/**
 * Simple Observable implementation
 * @template T is the typescript Type that defines the data being observed
 */
declare class Observable<T> {
    observers: Observer<T>[];
    subscriptions: ((val: T) => any)[];
    /**
     * Register an observer to listen to this observable
     * @param observer
     */
    register(observer: Observer<T>): void;
    /**
     * Register a callback to listen to this observable
     * @param func
     */
    subscribe(func: (val: T) => any): void;
    /**
     * Remove an observer from the observable
     * @param observer
     */
    unregister(observer: Observer<T>): void;
    /**
     * Remove a callback that is listening to this observable
     * @param func
     */
    unsubscribe(func: (val: T) => any): void;
    /**
     * Broadcasts a message to all observers and callbacks
     * @param message
     */
    notifyAll(message: T): void;
    /**
     * Removes all observers and callbacks
     */
    clear(): void;
}

type MaybeKnownComponent<Component, TKnownComponents> = Component extends TKnownComponents ? Component : Component | undefined;

/**
 * Interface holding an entity component pair
 */
interface EntityComponent {
    component: Component;
    entity: Entity;
}
/**
 * AddedComponent message
 */
declare class AddedComponent implements Message<EntityComponent> {
    data: EntityComponent;
    readonly type: 'Component Added';
    constructor(data: EntityComponent);
}
/**
 * Type guard to know if message is f an Added Component
 */
declare function isAddedComponent(x: Message<EntityComponent>): x is AddedComponent;
/**
 * RemovedComponent message
 */
declare class RemovedComponent implements Message<EntityComponent> {
    data: EntityComponent;
    readonly type: 'Component Removed';
    constructor(data: EntityComponent);
}
/**
 * Type guard to know if message is for a Removed Component
 */
declare function isRemovedComponent(x: Message<EntityComponent>): x is RemovedComponent;
/**
 * Built in events supported by all entities
 */
type EntityEvents = {
    initialize: InitializeEvent;
    add: AddEvent;
    remove: RemoveEvent;
    preupdate: PreUpdateEvent;
    postupdate: PostUpdateEvent;
    kill: KillEvent;
};
declare const EntityEvents: {
    readonly Add: "add";
    readonly Remove: "remove";
    readonly Initialize: "initialize";
    readonly PreUpdate: "preupdate";
    readonly PostUpdate: "postupdate";
    readonly Kill: "kill";
};
interface EntityOptions<TComponents extends Component> {
    name?: string;
    components?: TComponents[];
}
/**
 * An Entity is the base type of anything that can have behavior in Excalibur, they are part of the built in entity component system
 *
 * Entities can be strongly typed with the components they contain
 *
 * \`\`\`typescript
 * const entity = new Entity<ComponentA | ComponentB>();
 * entity.components.a; // Type ComponentA
 * entity.components.b; // Type ComponentB
 * \`\`\`
 */
declare class Entity<TKnownComponents extends Component = any> implements OnInitialize, OnPreUpdate, OnPostUpdate, OnAdd, OnRemove {
    private static _ID;
    /**
     * The unique identifier for the entity
     */
    id: number;
    name: string;
    /**
     * Listen to or emit events for an entity
     */
    events: EventEmitter<EntityEvents>;
    private _tags;
    componentAdded$: Observable<Component>;
    componentRemoved$: Observable<Component>;
    tagAdded$: Observable<string>;
    tagRemoved$: Observable<string>;
    /**
     * Current components on the entity
     *
     * **Do not modify**
     *
     * Use addComponent/removeComponent otherwise the ECS will not be notified of changes.
     */
    readonly components: Map<Function, Component>;
    componentValues: Component[];
    private _componentsToRemove;
    constructor(options: EntityOptions<TKnownComponents>);
    constructor(components?: TKnownComponents[], name?: string);
    /**
     * The current scene that the entity is in, if any
     */
    scene: Scene | null;
    /**
     * Whether this entity is active, if set to false it will be reclaimed
     * @deprecated use isActive
     */
    get active(): boolean;
    /**
     * Whether this entity is active, if set to false it will be reclaimed
     * @deprecated use isActive
     */
    set active(val: boolean);
    /**
     * Whether this entity is active, if set to false it will be reclaimed
     */
    isActive: boolean;
    /**
     * Kill the entity, means it will no longer be updated. Kills are deferred to the end of the update.
     * If parented it will be removed from the parent when killed.
     */
    kill(): void;
    isKilled(): boolean;
    /**
     * Specifically get the tags on the entity from {@apilink TagsComponent}
     */
    get tags(): Set<string>;
    /**
     * Check if a tag exists on the entity
     * @param tag name to check for
     */
    hasTag(tag: string): boolean;
    /**
     * Adds a tag to an entity
     * @param tag
     */
    addTag(tag: string): Entity<TKnownComponents>;
    /**
     * Removes a tag on the entity
     *
     * Removals are deferred until the end of update
     * @param tag
     */
    removeTag(tag: string): Entity<TKnownComponents>;
    /**
     * The types of the components on the Entity
     */
    get types(): ComponentCtor[];
    /**
     * Returns all component instances on entity
     */
    getComponents(): Component[];
    /**
     * Verifies that an entity has all the required types
     * @param requiredTypes
     */
    hasAll<TComponent extends Component>(requiredTypes: ComponentCtor<TComponent>[]): boolean;
    /**
     * Verifies that an entity has all the required tags
     * @param requiredTags
     */
    hasAllTags(requiredTags: string[]): boolean;
    get<TComponent extends Component>(type: ComponentCtor<TComponent>): MaybeKnownComponent<TComponent, TKnownComponents>;
    private _parent;
    get parent(): Entity | null;
    childrenAdded$: Observable<Entity<any>>;
    childrenRemoved$: Observable<Entity<any>>;
    private _children;
    /**
     * Get the direct children of this entity
     */
    get children(): readonly Entity[];
    /**
     * Unparents this entity, if there is a parent. Otherwise it does nothing.
     */
    unparent(): void;
    /**
     * Adds an entity to be a child of this entity
     * @param entity
     */
    addChild(entity: Entity): Entity;
    /**
     * Remove an entity from children if it exists
     * @param entity
     */
    removeChild(entity: Entity): Entity;
    /**
     * Removes all children from this entity
     */
    removeAllChildren(): Entity;
    /**
     * Returns a list of parent entities starting with the topmost parent. Includes the current entity.
     */
    getAncestors(): Entity[];
    /**
     * Returns a list of all the entities that descend from this entity. Includes the current entity.
     */
    getDescendants(): Entity[];
    /**
     * Creates a deep copy of the entity and a copy of all its components
     */
    clone(): Entity;
    /**
     * Adds a copy of all the components from another template entity as a "prefab"
     * @param templateEntity Entity to use as a template
     * @param force Force component replacement if it already exists on the target entity
     */
    addTemplate(templateEntity: Entity, force?: boolean): Entity;
    private _getClassHierarchyRoot;
    /**
     * Adds a component to the entity
     * @param component Component or Entity to add copy of components from
     * @param force Optionally overwrite any existing components of the same type
     */
    addComponent<TComponent extends Component>(component: TComponent, force?: boolean): Entity<TKnownComponents | TComponent>;
    /**
     * Removes a component from the entity, by default removals are deferred to the end of entity update to avoid consistency issues
     *
     * Components can be force removed with the \`force\` flag, the removal is not deferred and happens immediately
     * @param typeOrInstance
     * @param force
     */
    removeComponent<TComponent extends Component>(typeOrInstance: ComponentCtor<TComponent> | TComponent, force?: boolean): Entity<Exclude<TKnownComponents, TComponent>>;
    clearComponents(): void;
    /**
     * @hidden
     * @internal
     */
    processComponentRemoval(): void;
    /**
     * Check if a component type exists
     * @param type
     */
    has<TComponent extends Component>(type: ComponentCtor<TComponent>): boolean;
    private _isInitialized;
    private _isAdded;
    /**
     * Gets whether the actor is Initialized
     */
    get isInitialized(): boolean;
    get isAdded(): boolean;
    /**
     * Initializes this entity, meant to be called by the Scene before first update not by users of Excalibur.
     *
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     * @internal
     */
    _initialize(engine: Engine): void;
    /**
     * Adds this Actor, meant to be called by the Scene when Actor is added.
     *
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     * @internal
     */
    _add(engine: Engine): void;
    /**
     * Removes Actor, meant to be called by the Scene when Actor is added.
     *
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     * @internal
     */
    _remove(engine: Engine): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPreUpdate} lifecycle event
     * @internal
     */
    _preupdate(engine: Engine, elapsed: number): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPostUpdate} lifecycle event
     * @internal
     */
    _postupdate(engine: Engine, elapsed: number): void;
    /**
     * \`onInitialize\` is called before the first update of the entity. This method is meant to be
     * overridden.
     *
     * Synonymous with the event handler \`.on('initialize', (evt) => {...})\`
     */
    onInitialize(engine: Engine): void;
    /**
     * \`onAdd\` is called when Actor is added to scene. This method is meant to be
     * overridden.
     *
     * Synonymous with the event handler \`.on('add', (evt) => {...})\`
     */
    onAdd(engine: Engine): void;
    /**
     * \`onRemove\` is called when Actor is added to scene. This method is meant to be
     * overridden.
     *
     * Synonymous with the event handler \`.on('remove', (evt) => {...})\`
     */
    onRemove(engine: Engine): void;
    /**
     * Safe to override onPreUpdate lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPreUpdate\` is called directly before an entity is updated.
     */
    onPreUpdate(engine: Engine, elapsed: number): void;
    /**
     * Safe to override onPostUpdate lifecycle event handler. Synonymous with \`.on('postupdate', (evt) =>{...})\`
     *
     * \`onPostUpdate\` is called directly after an entity is updated.
     */
    onPostUpdate(engine: Engine, elapsed: number): void;
    /**
     *
     * Entity update lifecycle, called internally
     * @internal
     * @param engine
     * @param elapsed
     */
    update(engine: Engine, elapsed: number): void;
    emit<TEventName extends EventKey<EntityEvents>>(eventName: TEventName, event: EntityEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<EntityEvents>>(eventName: TEventName, handler: Handler<EntityEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<EntityEvents>>(eventName: TEventName, handler: Handler<EntityEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<EntityEvents>>(eventName: TEventName, handler: Handler<EntityEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
}

/**
 * Component Constructor Types
 */
declare type ComponentCtor<TComponent extends Component = Component> = new (...args: any[]) => TComponent;
/**
 *
 */
declare function isComponentCtor(value: any): value is ComponentCtor<Component>;
/**
 * Components are containers for state in Excalibur, the are meant to convey capabilities that an Entity possesses
 *
 * Implementations of Component must have a zero-arg constructor to support dependencies
 *
 * \`\`\`typescript
 * class MyComponent extends ex.Component {
 *   // zero arg support required if you want to use component dependencies
 *   constructor(public optionalPos?: ex.Vector) {}
 * }
 * \`\`\`
 */
declare abstract class Component {
    /**
     * Optionally list any component types this component depends on
     * If the owner entity does not have these components, new components will be added to the entity
     *
     * Only components with zero-arg constructors are supported as automatic component dependencies
     */
    readonly dependencies?: ComponentCtor[];
    /**
     * Current owning {@apilink Entity}, if any, of this component. Null if not added to any {@apilink Entity}
     */
    owner?: Entity;
    /**
     * Clones any properties on this component, if that property value has a \`clone()\` method it will be called
     */
    clone(): Component;
    /**
     * Optional callback called when a component is added to an entity
     */
    onAdd?(owner: Entity): void;
    /**
     * Optional callback called when a component is removed from an entity
     */
    onRemove?(previousOwner: Entity): void;
}

declare class TransformComponent extends Component {
    private _logger;
    private _parentComponent;
    private _transform;
    get(): Transform;
    private _addChildTransform;
    onAdd(owner: Entity): void;
    onRemove(_previousOwner: Entity): void;
    /**
     * Observable that emits when the z index changes on this component
     */
    zIndexChanged$: Observable<number>;
    /**
     * The z-index ordering of the entity, a higher values are drawn on top of lower values.
     * For example z=99 would be drawn on top of z=0.
     */
    get z(): number;
    set z(val: number);
    get globalZ(): number;
    set globalZ(z: number);
    private _coordPlane;
    /**
     * The {@apilink CoordPlane | \`coordinate plane\`} for this transform for the entity.
     */
    get coordPlane(): CoordPlane;
    set coordPlane(value: CoordPlane);
    get pos(): Vector;
    set pos(v: Vector);
    get globalPos(): Vector;
    set globalPos(v: Vector);
    get rotation(): number;
    set rotation(rotation: number);
    get globalRotation(): number;
    set globalRotation(rotation: number);
    get scale(): Vector;
    set scale(v: Vector);
    get globalScale(): Vector;
    set globalScale(v: Vector);
    applyInverse(v: Vector): Vector;
    apply(v: Vector): Vector;
    clone(): TransformComponent;
}

interface Motion {
    /**
     * The velocity of an entity in pixels per second
     */
    vel: Vector;
    /**
     * The maximum component-wise velocity of an entity in pixels per second
     */
    maxVel: Vector;
    /**
     * The acceleration of entity in pixels per second^2
     */
    acc: Vector;
    /**
     * The scale rate of change in scale units per second
     */
    scaleFactor: Vector;
    /**
     * The angular velocity which is how quickly the entity is rotating in radians per second
     */
    angularVelocity: number;
    /**
     * The amount of torque applied to the entity, angular acceleration is torque * inertia
     */
    torque: number;
    /**
     * Inertia can be thought of as the resistance to motion
     */
    inertia: number;
}
declare class MotionComponent extends Component {
    /**
     * The velocity of an entity in pixels per second
     */
    vel: Vector;
    /**
     * The maximum component-wise velocity of an entity in pixels per second
     */
    maxVel: Vector;
    /**
     * The acceleration of entity in pixels per second^2
     */
    acc: Vector;
    /**
     * The scale rate of change in scale units per second
     */
    scaleFactor: Vector;
    /**
     * The angular velocity which is how quickly the entity is rotating in radians per second
     */
    angularVelocity: number;
    /**
     * The amount of torque applied to the entity, angular acceleration is torque * inertia
     */
    torque: number;
    /**
     * Inertia can be thought of as the resistance to motion
     */
    inertia: number;
}

/**
 * CollisionGroups indicate like members that do not collide with each other. Use {@apilink CollisionGroupManager} to create {@apilink CollisionGroup}s
 *
 * For example:
 *
 * Players have collision group "player"
 *
 * ![Player Collision Group](/assets/images/docs/CollisionGroupsPlayer.png)
 *
 * Enemies have collision group "enemy"
 *
 * ![Enemy Collision Group](/assets/images/docs/CollisionGroupsEnemy.png)
 *
 * Blocks have collision group "ground"
 *
 * ![Ground collision group](/assets/images/docs/CollisionGroupsGround.png)
 *
 * Players don't collide with each other, but enemies and blocks. Likewise, enemies don't collide with each other but collide
 * with players and blocks.
 *
 * This is done with bitmasking, see the following pseudo-code
 *
 * PlayerGroup = \`0b001\`
 * PlayerGroupMask = \`0b110\`
 *
 * EnemyGroup = \`0b010\`
 * EnemyGroupMask = \`0b101\`
 *
 * BlockGroup = \`0b100\`
 * BlockGroupMask = \`0b011\`
 *
 * Should Players collide? No because the bitwise mask evaluates to 0
 * \`(player1.group & player2.mask) === 0\`
 * \`(0b001 & 0b110) === 0\`
 *
 * Should Players and Enemies collide? Yes because the bitwise mask is non-zero
 * \`(player1.group & enemy1.mask) === 1\`
 * \`(0b001 & 0b101) === 1\`
 *
 * Should Players and Blocks collide? Yes because the bitwise mask is non-zero
 * \`(player1.group & blocks1.mask) === 1\`
 * \`(0b001 & 0b011) === 1\`
 */
declare class CollisionGroup {
    /**
     * The \`All\` {@apilink CollisionGroup} is a special group that collides with all other groups including itself,
     * it is the default collision group on colliders.
     */
    static All: CollisionGroup;
    private _name;
    private _category;
    private _mask;
    /**
     * STOP!!** It is preferred that {@apilink CollisionGroupManager.create} is used to create collision groups
     *  unless you know how to construct the proper bitmasks. See https://github.com/excaliburjs/Excalibur/issues/1091 for more info.
     * @param name Name of the collision group
     * @param category 32 bit category for the group, should be a unique power of 2. For example \`0b001\` or \`0b010\`
     * @param mask 32 bit mask of category, or \`~category\` generally. For a category of \`0b001\`, the mask would be \`0b110\`
     */
    constructor(name: string, category: number, mask: number);
    /**
     * Get the name of the collision group
     */
    get name(): string;
    /**
     * Get the category of the collision group, a 32 bit number which should be a unique power of 2
     */
    get category(): number;
    /**
     * Get the mask for this collision group
     */
    get mask(): number;
    /**
     * Evaluates whether 2 collision groups can collide
     *
     * This means the mask has the same bit set the other category and vice versa
     * @param other  CollisionGroup
     */
    canCollide(other: CollisionGroup): boolean;
    /**
     * Inverts the collision group. For example, if before the group specified "players",
     * inverting would specify all groups except players
     * @returns CollisionGroup
     */
    invert(): CollisionGroup;
    /**
     * Combine collision groups with each other. The new group includes all of the previous groups.
     * @param collisionGroups
     */
    static combine(collisionGroups: CollisionGroup[]): CollisionGroup;
    /**
     * Creates a collision group that collides with the listed groups
     * @param collisionGroups
     */
    static collidesWith(collisionGroups: CollisionGroup[]): CollisionGroup;
    toString(): string;
}

type DeepRequired<T> = Required<{
    [K in keyof T]: T[K] extends Required<T[K]> ? T[K] : DeepRequired<T[K]>;
}>;

/**
 * Possible collision resolution strategies
 *
 * The default is {@apilink SolverStrategy.Arcade} which performs simple axis aligned arcade style physics. This is useful for things
 * like platformers or top down games.
 *
 * More advanced rigid body physics are enabled by setting {@apilink SolverStrategy.Realistic} which allows for complicated
 * simulated physical interactions.
 */
declare enum SolverStrategy {
    Arcade = "arcade",
    Realistic = "realistic"
}

/**
 * Tells the Arcade collision solver to prefer certain contacts over others
 */
declare enum ContactSolveBias {
    None = "none",
    VerticalFirst = "vertical-first",
    HorizontalFirst = "horizontal-first"
}
/**
 * Contact bias values
 */
interface ContactBias {
    vertical: number;
    horizontal: number;
}
/**
 * Vertical First contact solve bias Used by the {@apilink ArcadeSolver} to sort contacts
 */
declare const VerticalFirst: ContactBias;
/**
 * Horizontal First contact solve bias Used by the {@apilink ArcadeSolver} to sort contacts
 */
declare const HorizontalFirst: ContactBias;
/**
 * None value, {@apilink ArcadeSolver} sorts contacts using distance by default
 */
declare const None: ContactBias;

/**
 * Possible collision resolution strategies
 *
 * The default is {@apilink SolverStrategy.Arcade} which performs simple axis aligned arcade style physics. This is useful for things
 * like platformers or top down games.
 *
 * More advanced rigid body physics are enabled by setting {@apilink SolverStrategy.Realistic} which allows for complicated
 * simulated physical interactions.
 */
declare enum SpatialPartitionStrategy {
    DynamicTree = "dynamic-tree",
    SparseHashGrid = "sparse-hash-grid"
}

interface DynamicTreeConfig {
    /**
     * Pad collider BoundingBox by a constant amount for purposes of potential pairs
     *
     * Default 5 pixels
     */
    boundsPadding?: number;
    /**
     * Factor to add to the collider BoundingBox, bounding box (dimensions += vel * dynamicTreeVelocityMultiplier);
     *
     * Default 2
     */
    velocityMultiplier?: number;
}
interface SparseHashGridConfig {
    /**
     * Size of the grid cells, default is 100x100 pixels.
     *
     * A good size means that your average collider in your game would fit inside the cell size by size dimension.
     */
    size: number;
}
interface PhysicsConfig {
    /**
     * Excalibur physics simulation is enabled
     */
    enabled?: boolean;
    /**
     * Configure gravity that applies to all {@apilink CollisionType.Active} bodies.
     *
     * This is acceleration in pixels/sec^2
     *
     * Default vec(0, 0)
     *
     * {@apilink BodyComponent.useGravity} to opt out
     */
    gravity?: Vector;
    /**
     * Configure the type of physics simulation you would like
     *
     * * {@apilink SolverStrategy.Arcade} is suitable for games where you might be doing platforming or top down movement.
     * * {@apilink SolverStrategy.Realistic} is where you need objects to bounce off each other and respond like real world objects.
     *
     * Default is Arcade
     */
    solver?: SolverStrategy;
    /**
     * Configure physics sub-stepping, this can increase simulation fidelity by doing smaller physics steps
     *
     * Default is 1 step
     */
    substep?: number;
    /**
     * Configure colliders
     */
    colliders?: {
        /**
         * Treat composite collider's member colliders as either separate colliders for the purposes of onCollisionStart/onCollision
         * or as a single collider together.
         *
         * This property can be overridden on individual {@apilink CompositeColliders}.
         *
         * For composites without gaps or small groups of colliders, you probably want 'together'
         *
         * For composites with deliberate gaps, like a platforming level layout, you probably want 'separate'
         *
         * Default is 'together' if unset
         */
        compositeStrategy?: 'separate' | 'together';
    };
    /**
     * Configure excalibur continuous collision (WIP)
     */
    continuous?: {
        /**
         * Enable fast moving body checking, this enables checking for collision pairs via raycast for fast moving objects to prevent
         * bodies from tunneling through one another.
         *
         * Default true
         */
        checkForFastBodies?: boolean;
        /**
         * Disable minimum fast moving body raycast, by default if checkForFastBodies = true Excalibur will only check if the
         * body is moving at least half of its minimum dimension in an update. If disableMinimumSpeedForFastBody is set to true,
         * Excalibur will always perform the fast body raycast regardless of speed.
         *
         * Default false
         */
        disableMinimumSpeedForFastBody?: boolean;
        /**
         * Surface epsilon is used to help deal with predicting collisions by applying a slop
         *
         * Default 0.1
         */
        surfaceEpsilon?: number;
    };
    /**
     * Configure body defaults
     */
    bodies?: {
        /**
         * Configure default mass that bodies have
         *
         * Default 10 mass units
         */
        defaultMass?: number;
        /**
         * Sleep epsilon
         *
         * Default 0.07
         */
        sleepEpsilon?: number;
        /**
         * Wake Threshold, the amount of "motion" need to wake a body from sleep
         *
         * Default 0.07 * 3;
         */
        wakeThreshold?: number;
        /**
         * Sleep bias
         *
         * Default 0.9
         */
        sleepBias?: number;
        /**
         * By default bodies do not sleep, this can be turned on to improve perf if you have a lot of bodies.
         *
         * Default false
         */
        canSleepByDefault?: boolean;
    };
    /**
     * Configure the spatial data structure for locating pairs and raycasts
     */
    spatialPartition?: SpatialPartitionStrategy;
    sparseHashGrid?: SparseHashGridConfig;
    dynamicTree?: DynamicTreeConfig;
    /**
     * Configure the {@apilink ArcadeSolver}
     */
    arcade?: {
        /**
         * Hints the {@apilink ArcadeSolver} to preferentially solve certain contact directions first.
         *
         * Options:
         * * Solve {@apilink ContactSolveBias.VerticalFirst} which will do vertical contact resolution first (useful for platformers
         * with up/down gravity)
         * * Solve {@apilink ContactSolveBias.HorizontalFirst} which will do horizontal contact resolution first (useful for games with
         * left/right forces)
         * * By default {@apilink ContactSolveBias.None} which sorts by distance
         */
        contactSolveBias?: ContactSolveBias;
    };
    /**
     * Configure the {@apilink RealisticSolver}
     */
    realistic?: {
        contactSolveBias?: ContactSolveBias;
        /**
         * Number of position iterations (overlap) to run in the solver
         *
         * Default 3 iterations
         */
        positionIterations?: number;
        /**
         * Number of velocity iteration (response) to run in the solver
         *
         * Default 8 iterations
         */
        velocityIterations?: number;
        /**
         * Amount of overlap to tolerate in pixels
         *
         * Default 1 pixel
         */
        slop?: number;
        /**
         * Amount of positional overlap correction to apply each position iteration of the solver
         * 0 - meaning no correction, 1 - meaning correct all overlap. Generally values 0 < .5 look nice.
         *
         * Default 0.2
         */
        steeringFactor?: number;
        /**
         * Warm start set to true re-uses impulses from previous frames back in the solver. Re-using impulses helps
         * the solver converge quicker
         *
         * Default true
         */
        warmStart?: boolean;
    };
}
declare const getDefaultPhysicsConfig: () => DeepRequired<PhysicsConfig>;

type ComponentInstance<T> = T extends ComponentCtor<infer R> ? R : never;
/**
 * Turns \`Entity<A | B>\` into \`Entity<A> | Entity<B>\`
 */
type DistributeEntity<T> = T extends infer U extends Component ? Entity<U> : never;
interface QueryParams<TKnownComponentCtors extends ComponentCtor<Component> = never, TAnyComponentCtors extends ComponentCtor<Component> = never> {
    components?: {
        all?: TKnownComponentCtors[];
        any?: TAnyComponentCtors[];
        not?: ComponentCtor<Component>[];
    };
    tags?: {
        all?: string[];
        any?: string[];
        not?: string[];
    };
}
type QueryEntity<TAllComponentCtors extends ComponentCtor<Component> = never, TAnyComponentCtors extends ComponentCtor<Component> = never> = [TAnyComponentCtors] extends [never] ? Entity<ComponentInstance<TAllComponentCtors>> : Entity<ComponentInstance<TAllComponentCtors>> | DistributeEntity<ComponentInstance<TAnyComponentCtors>>;
/**
 * Represents query for entities that match a list of types that is cached and observable
 *
 * Queries can be strongly typed by supplying a type union in the optional type parameter
 * \`\`\`typescript
 * const queryAB = new ex.Query<ComponentTypeA | ComponentTypeB>(['A', 'B']);
 * \`\`\`
 */
declare class Query<TAllComponentCtors extends ComponentCtor<Component> = never, TAnyComponentCtors extends ComponentCtor<Component> = never> {
    readonly id: string;
    entities: QueryEntity<TAllComponentCtors, TAnyComponentCtors>[];
    /**
     * This fires right after the component is added
     */
    entityAdded$: Observable<QueryEntity<TAllComponentCtors, TAnyComponentCtors>>;
    /**
     * This fires right before the component is actually removed from the entity, it will still be available for cleanup purposes
     */
    entityRemoved$: Observable<QueryEntity<TAllComponentCtors, TAnyComponentCtors>>;
    readonly filter: {
        components: {
            all: Set<TAllComponentCtors>;
            any: Set<TAnyComponentCtors>;
            not: Set<ComponentCtor<Component>>;
        };
        tags: {
            all: Set<string>;
            any: Set<string>;
            not: Set<string>;
        };
    };
    constructor(params: TAllComponentCtors[] | QueryParams<TAllComponentCtors, TAnyComponentCtors>);
    static createId(params: Function[] | QueryParams<any, any>): string;
    static hashTags(set: Set<string>): string;
    static hashComponents(set: Set<ComponentCtor<Component>>): string;
    matches(entity: Entity): boolean;
    /**
     * Potentially adds an entity to a query index, returns true if added, false if not
     * @param entity
     */
    checkAndAdd(entity: Entity): boolean;
    removeEntity(entity: Entity): void;
    /**
     * Returns a list of entities that match the query
     * @param sort Optional sorting function to sort entities returned from the query
     */
    getEntities(sort?: (a: Entity, b: Entity) => number): QueryEntity<TAllComponentCtors, TAnyComponentCtors>[];
}

declare class TagQuery<TKnownTags extends string = never> {
    readonly requiredTags: TKnownTags[];
    readonly id: string;
    tags: Set<TKnownTags>;
    entities: Entity<any>[];
    /**
     * This fires right after the component is added
     */
    entityAdded$: Observable<Entity<any>>;
    /**
     * This fires right before the component is actually removed from the entity, it will still be available for cleanup purposes
     */
    entityRemoved$: Observable<Entity<any>>;
    constructor(requiredTags: TKnownTags[]);
    static createId(requiredComponents: string[]): string;
    checkAndAdd(entity: Entity): boolean;
    removeEntity(entity: Entity): void;
    /**
     * Returns a list of entities that match the query
     * @param sort Optional sorting function to sort entities returned from the query
     */
    getEntities(sort?: (a: Entity, b: Entity) => number): Entity<any>[];
}

/**
 * The query manager is responsible for updating all queries when entities/components change
 */
declare class QueryManager {
    private _world;
    private _queries;
    private _addComponentHandlers;
    private _removeComponentHandlers;
    private _componentToQueriesIndex;
    private _tagQueries;
    private _addTagHandlers;
    private _removeTagHandlers;
    private _tagToQueriesIndex;
    constructor(_world: World);
    createQuery<TKnownComponentCtors extends ComponentCtor<Component> = never, TAnyComponentCtors extends ComponentCtor<Component> = never>(params: TKnownComponentCtors[] | QueryParams<TKnownComponentCtors, TAnyComponentCtors>): Query<TKnownComponentCtors, TAnyComponentCtors>;
    createTagQuery<TKnownTags extends string>(requiredTags: TKnownTags[]): TagQuery<TKnownTags>;
    private _createAddComponentHandler;
    private _createRemoveComponentHandler;
    private _createAddTagHandler;
    private _createRemoveTagHandler;
    /**
     * Scans queries and locates any that need this entity added
     * @param entity
     */
    addEntity(entity: Entity): void;
    /**
     * Scans queries and locates any that need this entity removed
     * @param entity
     */
    removeEntity(entity: Entity): void;
    /**
     * Updates any queries when a component is added to an entity
     * @param entity
     * @param component
     */
    addComponent(entity: Entity, component: Component): void;
    /**
     * Updates any queries when a component is removed from an entity
     * @param entity
     * @param component
     */
    removeComponent(entity: Entity, component: Component): void;
    /**
     * Updates any queries when a tag is added to an entity
     * @param entity
     * @param tag
     */
    addTag(entity: Entity, tag: string): void;
    /**
     * Updates any queries when a component is removed from an entity
     * @param entity
     * @param tag
     */
    removeTag(entity: Entity, tag: string): void;
}

/**
 * Enum that determines whether to run the system in the update or draw phase
 */
declare enum SystemType {
    Update = "update",
    Draw = "draw"
}
/**
 * An Excalibur {@apilink System} that updates entities of certain types.
 * Systems are scene specific
 *
 *
 *
 * Excalibur Systems currently require at least 1 Component type to operated
 *
 * Multiple types are declared as a type union
 * For example:
 *
 * \`\`\`typescript
 * class MySystem extends System {
 *   static priority = SystemPriority.Lowest;
 *   public readonly systemType = SystemType.Update;
 *   public query: Query<typeof TransformComponent>;
 *   constructor(public world: World) {
 *   super();
 *      this.query = this.world.query([TransformComponent]);
 *   }
 *   public update(elapsed: number) {
 *      ...
 *   }
 * }
 * \`\`\`
 */
declare abstract class System {
    /**
     * Determine whether the system is called in the {@apilink SystemType.Update} or the {@apilink SystemType.Draw} phase. Update is first, then Draw.
     */
    abstract readonly systemType: SystemType;
    /**
     * System can execute in priority order, by default all systems are priority 0. Lower values indicated higher priority.
     * For a system to execute before all other a lower priority value (-1 for example) must be set.
     * For a system to execute after all other a higher priority value (10 for example) must be set.
     */
    static priority: number;
    /**
     * Optionally specify an initialize handler
     * @param scene
     */
    initialize?(world: World, scene: Scene): void;
    /**
     * Update all entities that match this system's types
     * @param elapsed Time in milliseconds
     */
    abstract update(elapsed: number): void;
    /**
     * Optionally run a preupdate before the system processes matching entities
     * @param scene
     * @param elapsed Time in milliseconds since the last frame
     */
    preupdate?(scene: Scene, elapsed: number): void;
    /**
     * Optionally run a postupdate after the system processes matching entities
     * @param scene
     * @param elapsed Time in milliseconds since the last frame
     */
    postupdate?(scene: Scene, elapsed: number): void;
}

interface SystemCtor<T extends System> {
    new (...args: any[]): T;
}
/**
 *
 */
declare function isSystemConstructor(x: any): x is SystemCtor<System>;
/**
 * The SystemManager is responsible for keeping track of all systems in a scene.
 * Systems are scene specific
 */
declare class SystemManager {
    private _world;
    /**
     * List of systems, to add a new system call {@apilink SystemManager.addSystem}
     */
    systems: System[];
    initialized: boolean;
    constructor(_world: World);
    /**
     * Get a system registered in the manager by type
     * @param systemType
     */
    get<T extends System>(systemType: SystemCtor<T>): T | null;
    /**
     * Adds a system to the manager, it will now be updated every frame
     * @param systemOrCtor
     */
    addSystem(systemOrCtor: SystemCtor<System> | System): void;
    /**
     * Removes a system from the manager, it will no longer be updated
     * @param system
     */
    removeSystem(system: System): void;
    /**
     * Initialize all systems in the manager
     *
     * Systems added after initialize() will be initialized on add
     */
    initialize(): void;
    /**
     * Updates all systems
     * @param type whether this is an update or draw system
     * @param scene context reference
     * @param elapsed time in milliseconds
     */
    updateSystems(type: SystemType, scene: Scene, elapsed: number): void;
    clear(): void;
}

/**
 * The World is a self-contained entity component system for a particular context.
 */
declare class World {
    scene: Scene;
    private _logger;
    queryManager: QueryManager;
    entityManager: EntityManager;
    systemManager: SystemManager;
    /**
     * The context type is passed to the system updates
     * @param scene
     */
    constructor(scene: Scene);
    /**
     * Query the ECS world for entities that match your components
     */
    query<TKnownComponentCtors extends ComponentCtor<Component> = never, TAnyComponentCtors extends ComponentCtor<Component> = never>(params: TKnownComponentCtors[] | QueryParams<TKnownComponentCtors, TAnyComponentCtors>): Query<TKnownComponentCtors, TAnyComponentCtors>;
    queryTags<TKnownTags extends string>(requiredTags: TKnownTags[]): TagQuery<TKnownTags>;
    /**
     * Update systems by type and time elapsed in milliseconds
     */
    update(type: SystemType, elapsed: number): void;
    /**
     * Add an entity to the ECS world
     * @param entity
     */
    add(entity: Entity): void;
    /**
     * Add a system to the ECS world
     * @param system
     */
    add(system: System): void;
    add(system: SystemCtor<System>): void;
    /**
     * Get a system out of the ECS world
     */
    get(system: SystemCtor<System>): System;
    /**
     * Remove an entity from the ECS world
     * @param entity
     */
    remove(entity: Entity, deferred?: boolean): void;
    /**
     * Remove a system from the ECS world
     * @param system
     */
    remove(system: System): void;
    get entities(): Entity<any>[];
    clearEntities(): void;
    clearSystems(): void;
}

declare class EntityManager {
    private _world;
    entities: Entity[];
    _entityIndex: {
        [entityId: string]: Entity;
    };
    private _childAddedHandlerMap;
    private _childRemovedHandlerMap;
    constructor(_world: World);
    /**
     * Runs the entity lifecycle
     * @param scene
     * @param elapsed
     */
    updateEntities(scene: Scene, elapsed: number): void;
    findEntitiesForRemoval(): void;
    private _createChildAddedHandler;
    private _createChildRemovedHandler;
    /**
     * Adds an entity to be tracked by the EntityManager
     * @param entity
     */
    addEntity(entity: Entity): void;
    removeEntity(entity: Entity, deferred?: boolean): void;
    removeEntity(id: number, deferred?: boolean): void;
    private _entitiesToRemove;
    processEntityRemovals(): void;
    processComponentRemovals(): void;
    getById(id: number): Entity | undefined;
    getByName(name: string): Entity[];
    clear(): void;
}

/**
 * Higher priorities run earlier than others in the system update
 */
declare const SystemPriority: {
    readonly Highest: number;
    readonly Higher: -5;
    readonly Average: 0;
    readonly Lower: 5;
    readonly Lowest: number;
};

interface BodyComponentOptions {
    type?: CollisionType;
    group?: CollisionGroup;
    useGravity?: boolean;
    config?: Pick<PhysicsConfig, 'bodies'>['bodies'];
}
declare enum DegreeOfFreedom {
    Rotation = "rotation",
    X = "x",
    Y = "y"
}
/**
 * Body describes all the physical properties pos, vel, acc, rotation, angular velocity for the purpose of
 * of physics simulation.
 */
declare class BodyComponent extends Component implements Clonable<BodyComponent> {
    dependencies: (typeof TransformComponent | typeof MotionComponent)[];
    static _ID: number;
    readonly id: Id<'body'>;
    events: EventEmitter<any>;
    oldTransform: Transform;
    /**
     * Indicates whether the old transform has been captured at least once for interpolation
     * @internal
     */
    __oldTransformCaptured: boolean;
    /**
     * Enable or disabled the fixed update interpolation, by default interpolation is on.
     */
    enableFixedUpdateInterpolate: boolean;
    private _bodyConfig;
    private static _DEFAULT_CONFIG;
    wakeThreshold: number;
    constructor(options?: BodyComponentOptions);
    get matrix(): AffineMatrix;
    /**
     * Called by excalibur to update physics config defaults if they change
     * @param config
     */
    updatePhysicsConfig(config: DeepRequired<Pick<PhysicsConfig, 'bodies'>['bodies']>): void;
    /**
     * Called by excalibur to update defaults
     * @param config
     */
    static updateDefaultPhysicsConfig(config: DeepRequired<Pick<PhysicsConfig, 'bodies'>['bodies']>): void;
    /**
     * Collision type for the rigidbody physics simulation, by default {@apilink CollisionType.PreventCollision}
     */
    collisionType: CollisionType;
    /**
     * The collision group for the body's colliders, by default body colliders collide with everything
     */
    group: CollisionGroup;
    /**
     * The amount of mass the body has
     */
    private _mass;
    get mass(): number;
    set mass(newMass: number);
    /**
     * The inverse mass (1/mass) of the body. If {@apilink CollisionType.Fixed} this is 0, meaning "infinite" mass
     */
    get inverseMass(): number;
    /**
     * Amount of "motion" the body has before sleeping. If below {@apilink Physics.sleepEpsilon} it goes to "sleep"
     */
    sleepMotion: number;
    /**
     * Can this body sleep, by default bodies do not sleep
     */
    canSleep: boolean;
    private _sleeping;
    /**
     * Whether this body is sleeping or not
     * @deprecated use isSleeping
     */
    get sleeping(): boolean;
    /**
     * Whether this body is sleeping or not
     */
    get isSleeping(): boolean;
    /**
     * Set the sleep state of the body
     * @param sleeping
     * @deprecated use isSleeping
     */
    setSleeping(sleeping: boolean): void;
    set isSleeping(sleeping: boolean);
    /**
     * Update body's {@apilink BodyComponent.sleepMotion} for the purpose of sleeping
     */
    updateMotion(): void;
    private _cachedInertia;
    /**
     * Get the moment of inertia from the {@apilink ColliderComponent}
     */
    get inertia(): number;
    private _cachedInverseInertia;
    /**
     * Get the inverse moment of inertial from the {@apilink ColliderComponent}. If {@apilink CollisionType.Fixed} this is 0, meaning "infinite" mass
     */
    get inverseInertia(): number;
    /**
     * The also known as coefficient of restitution of this actor, represents the amount of energy preserved after collision or the
     * bounciness. If 1, it is 100% bouncy, 0 it completely absorbs.
     */
    bounciness: number;
    /**
     * The coefficient of friction on this actor.
     *
     * The {@apilink SolverStrategy.Arcade} does not support this property.
     *
     */
    friction: number;
    /**
     * Should use global gravity {@apilink Physics.gravity} in it's physics simulation, default is true
     */
    useGravity: boolean;
    /**
     * Degrees of freedom to limit
     *
     * Note: this only limits responses in the realistic solver, if velocity/angularVelocity is set the actor will still respond
     */
    limitDegreeOfFreedom: DegreeOfFreedom[];
    /**
     * Returns if the owner is active
     * @deprecated use isActive
     */
    get active(): boolean;
    /**
     * Returns if the owner is active
     */
    get isActive(): boolean;
    /**
     * @deprecated Use globalPos
     */
    get center(): Vector;
    transform: TransformComponent;
    motion: MotionComponent;
    onAdd(owner: Entity<any>): void;
    get pos(): Vector;
    set pos(val: Vector);
    /**
     * The (x, y) position of the actor this will be in the middle of the actor if the
     * {@apilink Actor.anchor} is set to (0.5, 0.5) which is default.
     * If you want the (x, y) position to be the top left of the actor specify an anchor of (0, 0).
     */
    get globalPos(): Vector;
    set globalPos(val: Vector);
    private _oldGlobalPos;
    /**
     * The position of the actor last frame (x, y) in pixels
     */
    get oldPos(): Vector;
    /**
     * The global position of the actor last frame (x, y) in pixels
     */
    get oldGlobalPos(): Vector;
    /**
     * The current velocity vector (vx, vy) of the actor in pixels/second
     */
    get vel(): Vector;
    set vel(val: Vector);
    /**
     * The velocity of the actor last frame (vx, vy) in pixels/second
     */
    oldVel: Vector;
    /**
     * The current acceleration vector (ax, ay) of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may
     * be useful to simulate a gravitational effect.
     */
    get acc(): Vector;
    set acc(val: Vector);
    /**
     * Gets/sets the acceleration of the actor from the last frame. This does not include the global acc {@apilink Physics.acc}.
     */
    oldAcc: Vector;
    /**
     * The current torque applied to the actor
     */
    get torque(): number;
    set torque(val: number);
    /**
     * Gets/sets the rotation of the body from the last frame.
     */
    get oldRotation(): number;
    /**
     * The rotation of the body in radians
     */
    get rotation(): number;
    set rotation(val: number);
    /**
     * The scale vector of the actor
     */
    get scale(): Vector;
    set scale(val: Vector);
    /**
     * The scale of the actor last frame
     */
    get oldScale(): Vector;
    /**
     * The scale rate of change of the actor in scale/second
     */
    get scaleFactor(): Vector;
    set scaleFactor(scaleFactor: Vector);
    /**
     * Get the angular velocity in radians/second
     */
    get angularVelocity(): number;
    /**
     * Set the angular velocity in radians/second
     */
    set angularVelocity(value: number);
    private _impulseScratch;
    private _distanceFromCenterScratch;
    /**
     * Apply a specific impulse to the body
     * @param point
     * @param impulse
     */
    applyImpulse(point: Vector, impulse: Vector): void;
    /**
     * Apply only linear impulse to the body
     * @param impulse
     */
    applyLinearImpulse(impulse: Vector): void;
    /**
     * Apply only angular impulse to the body
     * @param point
     * @param impulse
     */
    applyAngularImpulse(point: Vector, impulse: Vector): void;
    /**
     * Sets the old versions of pos, vel, acc, and scale.
     */
    captureOldTransform(): void;
    clone(): BodyComponent;
}

interface Eventable {
    /**
     * Emits an event for target
     * @param eventName  The name of the event to publish
     * @param event      Optionally pass an event data object to the handler
     */
    emit(eventName: string, event: any): void;
    /**
     * Subscribe an event handler to a particular event name, multiple handlers per event name are allowed.
     * @param eventName  The name of the event to subscribe to
     * @param handler    The handler callback to fire on this event
     */
    on(eventName: string, handler: Handler<any>): void;
    /**
     * Unsubscribe an event handler(s) from an event. If a specific handler
     * is specified for an event, only that handler will be unsubscribed.
     * Otherwise all handlers will be unsubscribed for that event.
     * @param eventName  The name of the event to unsubscribe
     * @param handler    Optionally the specific handler to unsubscribe
     */
    off(eventName: string, handler?: Handler<any>): void;
    /**
     * Once listens to an event once then auto unsubscribes from that event
     * @param eventName The name of the event to subscribe to once
     * @param handler   The handler of the event that will be auto unsubscribed
     */
    once(eventName: string, handler: Handler<any>): void;
}

declare class GlobalCoordinates {
    worldPos: Vector;
    pagePos: Vector;
    screenPos: Vector;
    static fromPagePosition(x: number, y: number, engine: Engine): GlobalCoordinates;
    static fromPagePosition(pos: Vector, engine: Engine): GlobalCoordinates;
    constructor(worldPos: Vector, pagePos: Vector, screenPos: Vector);
}

/**
 * The mouse button being pressed.
 */
declare enum PointerButton {
    Left = "Left",
    Middle = "Middle",
    Right = "Right",
    Unknown = "Unknown",
    NoButton = "NoButton"
}

/**
 * The type of pointer for a {@apilink PointerEvent}.
 */
declare enum PointerType {
    Touch = "Touch",
    Mouse = "Mouse",
    Pen = "Pen",
    Unknown = "Unknown"
}

declare class PointerEvent {
    type: 'down' | 'up' | 'move' | 'cancel';
    pointerId: number;
    button: PointerButton;
    pointerType: PointerType;
    coordinates: GlobalCoordinates;
    nativeEvent: Event;
    active: boolean;
    cancel(): void;
    get pagePos(): Vector;
    get screenPos(): Vector;
    get worldPos(): Vector;
    constructor(type: 'down' | 'up' | 'move' | 'cancel', pointerId: number, button: PointerButton, pointerType: PointerType, coordinates: GlobalCoordinates, nativeEvent: Event);
}

declare enum WheelDeltaMode {
    Pixel = "Pixel",
    Line = "Line",
    Page = "Page"
}

declare class WheelEvent {
    x: number;
    y: number;
    pageX: number;
    pageY: number;
    screenX: number;
    screenY: number;
    index: number;
    deltaX: number;
    deltaY: number;
    deltaZ: number;
    deltaMode: WheelDeltaMode;
    ev: Event;
    active: boolean;
    cancel(): void;
    constructor(x: number, y: number, pageX: number, pageY: number, screenX: number, screenY: number, index: number, deltaX: number, deltaY: number, deltaZ: number, deltaMode: WheelDeltaMode, ev: Event);
}

interface PointerEvents$1 {
    on(eventName: pointerup, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerdown, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerenter, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerleave, handler: (event: PointerEvent) => void): void;
    on(eventName: pointermove, handler: (event: PointerEvent) => void): void;
    on(eventName: pointercancel, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerwheel, handler: (event: WheelEvent) => void): void;
    on(eventName: pointerdragstart, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerdragend, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerdragenter, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerdragleave, handler: (event: PointerEvent) => void): void;
    on(eventName: pointerdragmove, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerup, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerdown, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerenter, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerleave, handler: (event: PointerEvent) => void): void;
    once(eventName: pointermove, handler: (event: PointerEvent) => void): void;
    once(eventName: pointercancel, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerwheel, handler: (event: WheelEvent) => void): void;
    once(eventName: pointerdragstart, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerdragend, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerdragenter, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerdragleave, handler: (event: PointerEvent) => void): void;
    once(eventName: pointerdragmove, handler: (event: PointerEvent) => void): void;
    off(eventName: pointerup, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerdown, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerenter, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerleave, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointermove, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointercancel, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerwheel, handler?: (event: WheelEvent) => void): void;
    off(eventName: pointerdragstart, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerdragend, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerdragenter, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerdragleave, handler?: (event: PointerEvent) => void): void;
    off(eventName: pointerdragmove, handler?: (event: PointerEvent) => void): void;
}

/**
 * A definition of an EasingFunction. See {@apilink EasingFunctions}.
 */
interface EasingFunction<TValueToEase = number> {
    (currentTime: number, startValue: TValueToEase, endValue: TValueToEase, duration: number): TValueToEase;
}
/**
 * Standard easing functions for motion in Excalibur, defined on a domain of [0, duration] and a range from [+startValue,+endValue]
 * Given a time, the function will return a value from positive startValue to positive endValue.
 *
 * \`\`\`js
 * function Linear (t) {
 *    return t * t;
 * }
 *
 * // accelerating from zero velocity
 * function EaseInQuad (t) {
 *    return t * t;
 * }
 *
 * // decelerating to zero velocity
 * function EaseOutQuad (t) {
 *    return t * (2 - t);
 * }
 *
 * // acceleration until halfway, then deceleration
 * function EaseInOutQuad (t) {
 *    return t < .5 ? 2 * t * t : -1 + (4 - 2 * t) * t;
 * }
 *
 * // accelerating from zero velocity
 * function EaseInCubic (t) {
 *    return t * t * t;
 * }
 *
 * // decelerating to zero velocity
 * function EaseOutCubic (t) {
 *    return (--t) * t * t + 1;
 * }
 *
 * // acceleration until halfway, then deceleration
 * function EaseInOutCubic (t) {
 *    return t < .5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1;
 * }
 * \`\`\`
 */
declare class EasingFunctions {
    static CreateReversibleEasingFunction(easing: EasingFunction): EasingFunction;
    static CreateVectorEasingFunction(easing: EasingFunction<number>): EasingFunction<Vector>;
    static Linear: EasingFunction;
    static EaseInQuad: EasingFunction<number>;
    static EaseOutQuad: EasingFunction;
    static EaseInOutQuad: EasingFunction;
    static EaseInCubic: EasingFunction;
    static EaseOutCubic: EasingFunction;
    static EaseInOutCubic: EasingFunction;
}

/**
 * A 2D line segment
 */
declare class LineSegment {
    begin: Vector;
    end: Vector;
    /**
     * @param begin  The starting point of the line segment
     * @param end  The ending point of the line segment
     */
    constructor(begin: Vector, end: Vector);
    clone(dest?: LineSegment): LineSegment;
    transform(matrix: AffineMatrix, dest?: LineSegment): LineSegment;
    /**
     * Gets the raw slope (m) of the line. Will return (+/-)Infinity for vertical lines.
     */
    get slope(): number;
    /**
     * Gets the Y-intercept (b) of the line. Will return (+/-)Infinity if there is no intercept.
     */
    get intercept(): number;
    private _normal;
    /**
     * Gets the normal of the line
     */
    normal(): Vector;
    private _dir;
    dir(): Vector;
    getPoints(): Vector[];
    private _slope;
    /**
     * Returns the slope of the line in the form of a vector of length 1
     */
    getSlope(): Vector;
    /**
     * Returns the edge of the line as vector, the length of the vector is the length of the edge
     */
    getEdge(): Vector;
    /**
     * Returns the length of the line segment in pixels
     */
    getLength(): number;
    /**
     * Returns the midpoint of the edge
     */
    get midpoint(): Vector;
    /**
     * Flips the direction of the line segment
     */
    flip(): LineSegment;
    /**
     * Tests if a given point is below the line, points in the normal direction above the line are considered above.
     * @param point
     */
    below(point: Vector): boolean;
    /**
     * Returns the clip point
     * @param sideVector Vector that traces the line
     * @param length Length to clip along side
     */
    clip(sideVector: Vector, length: number, normalize?: boolean): LineSegment;
    /**
     * Find the perpendicular distance from the line to a point
     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line
     * @param point
     */
    distanceToPoint(point: Vector, signed?: boolean): number;
    /**
     * Find the perpendicular line from the line to a point
     * https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_line
     * (a - p) - ((a - p) * n)n
     * a is a point on the line
     * p is the arbitrary point above the line
     * n is a unit vector in direction of the line
     * @param point
     */
    findVectorToPoint(point: Vector): Vector;
    /**
     * Finds a point on the line given only an X or a Y value. Given an X value, the function returns
     * a new point with the calculated Y value and vice-versa.
     * @param x The known X value of the target point
     * @param y The known Y value of the target point
     * @returns A new point with the other calculated axis value
     */
    findPoint(x?: number, y?: number): Vector;
    /**
     * Whether or not the given point lies on this line. This method is precise by default
     * meaning the point must lie exactly on the line. Adjust threshold to
     * loosen the strictness of the check for floating-point calculations.
     */
    hasPoint(x: number, y: number, threshold?: number): boolean;
    /**
     * Whether or not the given point lies on this line. This method is precise by default
     * meaning the point must lie exactly on the line. Adjust threshold to
     * loosen the strictness of the check for floating-point calculations.
     */
    hasPoint(v: Vector, threshold?: number): boolean;
}

/**
 * A 2D ray that can be cast into the scene to do collision detection
 */
declare class Ray {
    pos: Vector;
    dir: Vector;
    /**
     * @param pos The starting position for the ray
     * @param dir The vector indicating the direction of the ray
     */
    constructor(pos: Vector, dir: Vector);
    /**
     * Tests a whether this ray intersects with a line segment. Returns a number greater than or equal to 0 on success.
     * This number indicates the mathematical intersection time.
     * @param line  The line to test
     */
    intersect(line: LineSegment): number;
    intersectPoint(line: LineSegment): Vector;
    /**
     * Returns the point of intersection given the intersection time
     */
    getPoint(time: number): Vector;
}

/**
 * An enum that describes the sides of an axis aligned box for collision
 */
declare enum Side {
    None = "None",
    Top = "Top",
    Bottom = "Bottom",
    Left = "Left",
    Right = "Right"
}
declare namespace Side {
    /**
     * Returns the opposite side from the current
     */
    function getOpposite(side: Side): Side;
    /**
     * Given a vector, return the Side most in that direction
     */
    function fromDirection(direction: Vector): Side;
}

interface BoundingBoxOptions {
    left: number;
    right: number;
    top: number;
    bottom: number;
}
/**
 * Axis Aligned collision primitive for Excalibur.
 */
declare class BoundingBox {
    top: number;
    right: number;
    bottom: number;
    left: number;
    /**
     * Constructor allows passing of either an object with all coordinate components,
     * or the coordinate components passed separately.
     * @param leftOrOptions    Either x coordinate of the left edge or an options object
     * containing the four coordinate components.
     * @param top     y coordinate of the top edge
     * @param right   x coordinate of the right edge
     * @param bottom  y coordinate of the bottom edge
     */
    constructor(leftOrOptions?: number | BoundingBoxOptions, top?: number, right?: number, bottom?: number);
    /**
     * Returns a new instance of {@apilink BoundingBox} that is a copy of the current instance
     */
    clone(dest?: BoundingBox): BoundingBox;
    /**
     * Resets the bounds to a zero width/height box
     */
    reset(): void;
    /**
     * Given bounding box A & B, returns the side relative to A when intersection is performed.
     * @param intersection Intersection vector between 2 bounding boxes
     */
    static getSideFromIntersection(intersection: Vector): Side;
    static fromPoints(points: Vector[]): BoundingBox;
    /**
     * Creates a bounding box from a width and height
     * @param width
     * @param height
     * @param anchor Default Vector.Half
     * @param pos Default Vector.Zero
     */
    static fromDimension(width: number, height: number, anchor?: Vector, pos?: Vector): BoundingBox;
    /**
     * Returns the calculated width of the bounding box
     */
    get width(): number;
    /**
     * Returns the calculated height of the bounding box
     */
    get height(): number;
    /**
     * Return whether the bounding box has zero dimensions in height,width or both
     */
    hasZeroDimensions(): boolean;
    /**
     * Returns the center of the bounding box
     */
    get center(): Vector;
    get topLeft(): Vector;
    get bottomRight(): Vector;
    get topRight(): Vector;
    get bottomLeft(): Vector;
    translate(pos: Vector): BoundingBox;
    /**
     * Rotates a bounding box by and angle and around a point, if no point is specified (0, 0) is used by default. The resulting bounding
     * box is also axis-align. This is useful when a new axis-aligned bounding box is needed for rotated geometry.
     */
    rotate(angle: number, point?: Vector): BoundingBox;
    /**
     * Scale a bounding box by a scale factor, optionally provide a point
     * @param scale
     * @param point
     */
    scale(scale: Vector, point?: Vector): BoundingBox;
    /**
     * Transform the axis aligned bounding box by a {@apilink Matrix}, producing a new axis aligned bounding box
     * @param matrix
     */
    transform(matrix: AffineMatrix): BoundingBox;
    /**
     * Returns the perimeter of the bounding box
     */
    getPerimeter(): number;
    private _points;
    private _left?;
    private _right?;
    private _top?;
    private _bottom?;
    /**
     * Returns the world space points that make up the corners of the bounding box as a polygon
     */
    getPoints(): readonly Vector[];
    /**
     * Determines whether a ray intersects with a bounding box
     */
    rayCast(ray: Ray, farClipDistance?: number): boolean;
    /**
     * Returns the time along the ray where a raycast hits
     */
    rayCastTime(ray: Ray, farClipDistance?: number): number;
    /**
     * Tests whether a point is contained within the bounding box
     * @param p  The point to test
     */
    contains(p: Vector): boolean;
    /**
     * Tests whether another bounding box is totally contained in this one
     * @param bb  The bounding box to test
     */
    contains(bb: BoundingBox): boolean;
    /**
     * Combines this bounding box and another together returning a new bounding box
     * @param other  The bounding box to combine
     */
    combine(other: BoundingBox, dest?: BoundingBox): BoundingBox;
    get dimensions(): Vector;
    /**
     * Returns true if the bounding boxes overlap.
     * @param other
     * @param epsilon Optionally specify a small epsilon (default 0) as amount of overlap to ignore as overlap.
     * This epsilon is useful in stable collision simulations.
     */
    overlaps(other: BoundingBox, epsilon?: number): boolean;
    private static _SCRATCH_INTERSECT;
    /**
     * Test wether this bounding box intersects with another returning
     * the intersection vector that can be used to resolve the collision. If there
     * is no intersection null is returned.
     * @param other  Other {@apilink BoundingBox} to test intersection with
     * @returns A Vector in the direction of the current BoundingBox, this <- other
     */
    intersect(other: BoundingBox): Vector;
    /**
     * Test whether the bounding box has intersected with another bounding box, returns the side of the current bb that intersected.
     * @param bb The other actor to test
     */
    intersectWithSide(bb: BoundingBox): Side;
    /**
     * Draw a debug bounding box
     * @param ex
     * @param color
     */
    draw(ex: ExcaliburGraphicsContext, color?: Color): void;
}

/**
 * Interface that describes a custom camera strategy for tracking targets
 */
interface CameraStrategy<T> {
    /**
     * Target of the camera strategy that will be passed to the action
     */
    target: T;
    /**
     * Camera strategies perform an action to calculate a new focus returned out of the strategy
     * @param target The target object to apply this camera strategy (if any)
     * @param camera The current camera implementation in excalibur running the game
     * @param engine The current engine running the game
     * @param elapsed The elapsed time in milliseconds since the last frame
     */
    action: (target: T, camera: Camera, engine: Engine, elapsed: number) => Vector;
}
/**
 * Container to house convenience strategy methods
 * @internal
 */
declare class StrategyContainer {
    camera: Camera;
    constructor(camera: Camera);
    /**
     * Creates and adds the {@apilink LockCameraToActorStrategy} on the current camera.
     * @param actor The actor to lock the camera to
     */
    lockToActor(actor: Actor): void;
    /**
     * Creates and adds the {@apilink LockCameraToActorAxisStrategy} on the current camera
     * @param actor The actor to lock the camera to
     * @param axis The axis to follow the actor on
     */
    lockToActorAxis(actor: Actor, axis: Axis): void;
    /**
     * Creates and adds the {@apilink ElasticToActorStrategy} on the current camera
     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing
     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over
     * correct and bounce around the target
     * @param actor Target actor to elastically follow
     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target
     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target
     */
    elasticToActor(actor: Actor, cameraElasticity: number, cameraFriction: number): void;
    /**
     * Creates and adds the {@apilink RadiusAroundActorStrategy} on the current camera
     * @param actor Target actor to follow when it is "radius" pixels away
     * @param radius Number of pixels away before the camera will follow
     */
    radiusAroundActor(actor: Actor, radius: number): void;
    /**
     * Creates and adds the {@apilink LimitCameraBoundsStrategy} on the current camera
     * @param box The bounding box to limit the camera to.
     */
    limitCameraBounds(box: BoundingBox): void;
}
/**
 * Camera axis enum
 */
declare enum Axis {
    X = 0,
    Y = 1
}
/**
 * Lock a camera to the exact x/y position of an actor.
 */
declare class LockCameraToActorStrategy implements CameraStrategy<Actor> {
    target: Actor;
    constructor(target: Actor);
    action: (target: Actor, camera: Camera, engine: Engine, elapsed: number) => Vector;
}
/**
 * Lock a camera to a specific axis around an actor.
 */
declare class LockCameraToActorAxisStrategy implements CameraStrategy<Actor> {
    target: Actor;
    axis: Axis;
    constructor(target: Actor, axis: Axis);
    action: (target: Actor, cam: Camera, _eng: Engine, elapsed: number) => Vector;
}
/**
 * Using [Hook's law](https://en.wikipedia.org/wiki/Hooke's_law), elastically move the camera towards the target actor.
 */
declare class ElasticToActorStrategy implements CameraStrategy<Actor> {
    target: Actor;
    cameraElasticity: number;
    cameraFriction: number;
    /**
     * If cameraElasticity < cameraFriction < 1.0, the behavior will be a dampened spring that will slowly end at the target without bouncing
     * If cameraFriction < cameraElasticity < 1.0, the behavior will be an oscillating spring that will over
     * correct and bounce around the target
     * @param target Target actor to elastically follow
     * @param cameraElasticity [0 - 1.0] The higher the elasticity the more force that will drive the camera towards the target
     * @param cameraFriction [0 - 1.0] The higher the friction the more that the camera will resist motion towards the target
     */
    constructor(target: Actor, cameraElasticity: number, cameraFriction: number);
    action: (target: Actor, cam: Camera, _eng: Engine, elapsed: number) => Vector;
}
declare class RadiusAroundActorStrategy implements CameraStrategy<Actor> {
    target: Actor;
    radius: number;
    /**
     *
     * @param target Target actor to follow when it is "radius" pixels away
     * @param radius Number of pixels away before the camera will follow
     */
    constructor(target: Actor, radius: number);
    action: (target: Actor, cam: Camera, _eng: Engine, elapsed: number) => Vector;
}
/**
 * Prevent a camera from going beyond the given camera dimensions.
 */
declare class LimitCameraBoundsStrategy implements CameraStrategy<BoundingBox> {
    target: BoundingBox;
    /**
     * Useful for limiting the camera to a {@apilink TileMap}'s dimensions, or a specific area inside the map.
     *
     * Note that this strategy does not perform any movement by itself.
     * It only sets the camera position to within the given bounds when the camera has gone beyond them.
     * Thus, it is a good idea to combine it with other camera strategies and set this strategy as the last one.
     *
     * Make sure that the camera bounds are at least as large as the viewport size.
     * @param target The bounding box to limit the camera to
     */
    boundSizeChecked: boolean;
    constructor(target: BoundingBox);
    action: (target: BoundingBox, cam: Camera, _eng: Engine, elapsed: number) => Vector;
}
type CameraEvents = {
    preupdate: PreUpdateEvent<Camera>;
    postupdate: PostUpdateEvent<Camera>;
    initialize: InitializeEvent<Camera>;
};
declare const CameraEvents: {
    Initialize: string;
    PreUpdate: string;
    PostUpdate: string;
};
/**
 * Cameras
 *
 * {@apilink Camera} is the base class for all Excalibur cameras. Cameras are used
 * to move around your game and set focus. They are used to determine
 * what is "off screen" and can be used to scale the game.
 *
 */
declare class Camera implements CanUpdate, CanInitialize {
    events: EventEmitter<CameraEvents>;
    transform: AffineMatrix;
    inverse: AffineMatrix;
    protected _follow: Actor;
    private _cameraStrategies;
    get strategies(): CameraStrategy<any>[];
    strategy: StrategyContainer;
    /**
     * Get or set current zoom of the camera, defaults to 1
     */
    private _z;
    get zoom(): number;
    set zoom(val: number);
    /**
     * Get or set rate of change in zoom, defaults to 0
     */
    dz: number;
    /**
     * Get or set zoom acceleration
     */
    az: number;
    /**
     * Current rotation of the camera
     */
    rotation: number;
    private _angularVelocity;
    /**
     * Get or set the camera's angular velocity
     */
    get angularVelocity(): number;
    set angularVelocity(value: number);
    private _posChanged;
    private _pos;
    /**
     * Get or set the camera's position
     */
    get pos(): Vector;
    set pos(vec: Vector);
    /**
     * Has the position changed since the last update
     */
    hasChanged(): boolean;
    /**
     * Interpolated camera position if more draws are running than updates
     *
     * Enabled when \`Engine.fixedUpdateFps\` is enabled, in all other cases this will be the same as pos
     */
    drawPos: Vector;
    private _oldPos;
    /**
     * Get or set the camera's velocity
     */
    vel: Vector;
    /**
     * Get or set the camera's acceleration
     */
    acc: Vector;
    private _cameraMoving;
    private _currentLerpTime;
    private _lerpDuration;
    private _lerpStart;
    private _lerpEnd;
    private _lerpResolve;
    private _lerpPromise;
    protected _isShaking: boolean;
    private _shakeMagnitudeX;
    private _shakeMagnitudeY;
    private _shakeDuration;
    private _elapsedShakeTime;
    private _xShake;
    private _yShake;
    protected _isZooming: boolean;
    private _zoomStart;
    private _zoomEnd;
    private _currentZoomTime;
    private _zoomDuration;
    private _zoomResolve;
    private _zoomPromise;
    private _zoomEasing;
    private _easing;
    private _halfWidth;
    private _halfHeight;
    /**
     * Get the camera's x position
     */
    get x(): number;
    /**
     * Set the camera's x position (cannot be set when following an {@apilink Actor} or when moving)
     */
    set x(value: number);
    /**
     * Get the camera's y position
     */
    get y(): number;
    /**
     * Set the camera's y position (cannot be set when following an {@apilink Actor} or when moving)
     */
    set y(value: number);
    /**
     * Get or set the camera's x velocity
     */
    get dx(): number;
    set dx(value: number);
    /**
     * Get or set the camera's y velocity
     */
    get dy(): number;
    set dy(value: number);
    /**
     * Get or set the camera's x acceleration
     */
    get ax(): number;
    set ax(value: number);
    /**
     * Get or set the camera's y acceleration
     */
    get ay(): number;
    set ay(value: number);
    /**
     * Returns the focal point of the camera, a new point giving the x and y position of the camera
     */
    getFocus(): Vector;
    /**
     * This moves the camera focal point to the specified position using specified easing function. Cannot move when following an Actor.
     * @param pos The target position to move to
     * @param duration The duration in milliseconds the move should last
     * @param [easingFn] An optional easing function ({@apilink EasingFunctions.EaseInOutCubic} by default)
     * @returns A {@apilink Promise} that resolves when movement is finished, including if it's interrupted.
     *          The {@apilink Promise} value is the {@apilink Vector} of the target position. It will be rejected if a move cannot be made.
     */
    move(pos: Vector, duration: number, easingFn?: EasingFunction): Promise<Vector>;
    /**
     * Sets the camera to shake at the specified magnitudes for the specified duration
     * @param magnitudeX  The x magnitude of the shake
     * @param magnitudeY  The y magnitude of the shake
     * @param duration    The duration of the shake in milliseconds
     */
    shake(magnitudeX: number, magnitudeY: number, duration: number): void;
    /**
     * Zooms the camera in or out by the specified scale over the specified duration.
     * If no duration is specified, it take effect immediately.
     * @param scale    The scale of the zoom
     * @param duration The duration of the zoom in milliseconds
     */
    zoomOverTime(scale: number, duration?: number, easingFn?: EasingFunction): Promise<boolean>;
    private _viewport;
    /**
     * Gets the bounding box of the viewport of this camera in world coordinates
     */
    get viewport(): BoundingBox;
    /**
     * Adds one or more new camera strategies to this camera
     * @param cameraStrategy Instance of an {@apilink CameraStrategy}
     */
    addStrategy<T extends CameraStrategy<any>[]>(...cameraStrategies: T): void;
    /**
     * Sets the strategies of this camera, replacing all existing strategies
     * @param cameraStrategies Array of {@apilink CameraStrategy}
     */
    setStrategies<T extends CameraStrategy<any>[]>(cameraStrategies: T): void;
    /**
     * Removes a camera strategy by reference
     * @param cameraStrategy Instance of an {@apilink CameraStrategy}
     */
    removeStrategy<T>(cameraStrategy: CameraStrategy<T>): void;
    /**
     * Clears all camera strategies from the camera
     */
    clearAllStrategies(): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPreUpdate} lifecycle event
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     * @internal
     */
    _preupdate(engine: Engine, elapsed: number): void;
    /**
     * Safe to override onPreUpdate lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPreUpdate\` is called directly before a scene is updated.
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     */
    onPreUpdate(engine: Engine, elapsed: number): void;
    /**
     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPostUpdate} lifecycle event
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     * @internal
     */
    _postupdate(engine: Engine, elapsed: number): void;
    /**
     * Safe to override onPostUpdate lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPostUpdate\` is called directly after a scene is updated.
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     */
    onPostUpdate(engine: Engine, elapsed: number): void;
    private _engine;
    private _screen;
    private _isInitialized;
    get isInitialized(): boolean;
    _initialize(engine: Engine): void;
    /**
     * Safe to override onPostUpdate lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPostUpdate\` is called directly after a scene is updated.
     */
    onInitialize(engine: Engine): void;
    emit<TEventName extends EventKey<CameraEvents>>(eventName: TEventName, event: CameraEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<CameraEvents>>(eventName: TEventName, handler: Handler<CameraEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<CameraEvents>>(eventName: TEventName, handler: Handler<CameraEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<CameraEvents>>(eventName: TEventName, handler: Handler<CameraEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    runStrategies(engine: Engine, elapsed: number): void;
    updateViewport(): void;
    update(engine: Engine, elapsed: number): void;
    private _snapPos;
    /**
     * Applies the relevant transformations to the game canvas to "move" or apply effects to the Camera
     * @param ctx Canvas context to apply transformations
     */
    draw(ctx: ExcaliburGraphicsContext): void;
    updateTransform(pos: Vector): void;
    private _isDoneShaking;
}

interface NativeEventable {
    addEventListener(name: string, handler: (...any: any[]) => any): any;
    removeEventListener(name: string, handler: (...any: any[]) => any): any;
}
declare class BrowserComponent<T extends NativeEventable> {
    nativeComponent: T;
    private _paused;
    private _nativeHandlers;
    on(eventName: string, handler: (evt: any) => void): void;
    off(eventName: string, handler?: (event: any) => void): void;
    private _decorate;
    pause(): void;
    resume(): void;
    clear(): void;
    constructor(nativeComponent: T);
}
declare class BrowserEvents {
    private _windowGlobal;
    private _documentGlobal;
    private _windowComponent;
    private _documentComponent;
    constructor(_windowGlobal: Window, _documentGlobal: Document);
    get window(): BrowserComponent<Window>;
    get document(): BrowserComponent<Document>;
    pause(): void;
    resume(): void;
    clear(): void;
}

/**
 * A 1 dimensional projection on an axis, used to test overlaps
 */
declare class Projection {
    min: number;
    max: number;
    constructor(min: number, max: number);
    overlaps(projection: Projection): boolean;
    getOverlap(projection: Projection): number;
}

interface RayCastHit {
    /**
     * The distance along the ray cast in pixels that a hit was detected
     */
    distance: number;
    /**
     * Reference to the collider that was hit
     */
    collider: Collider;
    /**
     * Reference to the body that was hit
     */
    body: BodyComponent;
    /**
     * World space point of the hit
     */
    point: Vector;
    /**
     * Normal vector of hit collider
     */
    normal: Vector;
}

declare class CompositeCollider extends Collider {
    private _transform;
    private _collisionProcessor;
    private _dynamicAABBTree;
    private _colliders;
    private _compositeStrategy?;
    /**
     * Treat composite collider's member colliders as either separate colliders for the purposes of onCollisionStart/onCollision
     * or as a single collider together.
     *
     * This property can be overridden on individual {@apilink CompositeColliders}.
     *
     * For composites without gaps or small groups of colliders, you probably want 'together'
     *
     * For composites with deliberate gaps, like a platforming level layout, you probably want 'separate'
     *
     * Default is 'together' if unset
     */
    set compositeStrategy(value: 'separate' | 'together');
    get compositeStrategy(): "separate" | "together";
    constructor(colliders: Collider[]);
    clearColliders(): void;
    addCollider(collider: Collider): void;
    removeCollider(collider: Collider): void;
    getColliders(): Collider[];
    get worldPos(): Vector;
    get center(): Vector;
    get bounds(): BoundingBox;
    get localBounds(): BoundingBox;
    get axes(): Vector[];
    getFurthestPoint(direction: Vector): Vector;
    getInertia(mass: number): number;
    collide(other: Collider): CollisionContact[];
    getClosestLineBetween(other: Collider): LineSegment;
    contains(point: Vector): boolean;
    rayCast(ray: Ray, max?: number): RayCastHit | null;
    project(axis: Vector): Projection;
    update(transform: Transform): void;
    debug(ex: ExcaliburGraphicsContext, color: Color, options?: {
        lineWidth: number;
        pointSize: number;
    }): void;
    clone(): Collider;
}

/**
 * A collision collider specifies the geometry that can detect when other collision colliders intersect
 * for the purposes of colliding 2 objects in excalibur.
 */
declare abstract class Collider implements Clonable<Collider> {
    private static _ID;
    readonly id: Id<'collider'>;
    /**
     * Composite collider if any this collider is attached to
     *
     * **WARNING** do not tamper with this property
     */
    composite: CompositeCollider | null;
    events: EventEmitter<any>;
    /**
     * Returns a boolean indicating whether this body collided with
     * or was in stationary contact with
     * the body of the other {@apilink Collider}
     */
    touching(other: Collider): boolean;
    owner: Entity;
    /**
     * Pixel offset of the collision collider relative to the collider, by default (0, 0) meaning the collider is positioned
     * on top of the collider.
     */
    offset: Vector;
    /**
     * Position of the collision collider in world coordinates
     */
    abstract get worldPos(): Vector;
    /**
     * The center point of the collision collider, for example if the collider is a circle it would be the center.
     */
    abstract get center(): Vector;
    /**
     * Return the axis-aligned bounding box of the collision collider in world coordinates
     */
    abstract get bounds(): BoundingBox;
    /**
     * Return the axis-aligned bounding box of the collision collider in local coordinates
     */
    abstract get localBounds(): BoundingBox;
    /**
     * Return the axes of this particular collider
     */
    abstract get axes(): Vector[];
    /**
     * Find the furthest point on the convex hull of this particular collider in a certain direction.
     */
    abstract getFurthestPoint(direction: Vector): Vector;
    abstract getInertia(mass: number): number;
    abstract collide(collider: Collider): CollisionContact[];
    /**
     * Returns the closest line between the surfaces this collider and another
     * @param collider
     */
    abstract getClosestLineBetween(collider: Collider): LineSegment;
    /**
     * Return wether the collider contains a point inclusive to it's border
     */
    abstract contains(point: Vector): boolean;
    /**
     * Return the point on the border of the collision collider that intersects with a ray (if any).
     */
    abstract rayCast(ray: Ray, max?: number): RayCastHit | null;
    /**
     * Create a projection of this collider along an axis. Think of this as casting a "shadow" along an axis
     */
    abstract project(axis: Vector): Projection;
    /**
     * Updates collider world space geometry
     */
    abstract update(transform: Transform): void;
    abstract debug(ex: ExcaliburGraphicsContext, color: Color, options?: {
        lineWidth: number;
        pointSize: number;
    }): void;
    abstract clone(): Collider;
}

interface CircleColliderOptions {
    /**
     * Optional pixel offset to shift the circle relative to the collider, by default (0, 0).
     */
    offset?: Vector;
    /**
     * Required radius of the circle
     */
    radius: number;
}
/**
 * This is a circle collider for the excalibur rigid body physics simulation
 */
declare class CircleCollider extends Collider {
    /**
     * Position of the circle relative to the collider, by default (0, 0).
     */
    offset: Vector;
    private _globalMatrix;
    get worldPos(): Vector;
    private _naturalRadius;
    private _radius;
    /**
     * Get the radius of the circle
     */
    get radius(): number;
    /**
     * Set the radius of the circle
     */
    set radius(val: number);
    private _transform;
    constructor(options: CircleColliderOptions);
    /**
     * Returns a clone of this shape, not associated with any collider
     */
    clone(): CircleCollider;
    /**
     * Get the center of the collider in world coordinates
     */
    get center(): Vector;
    /**
     * Tests if a point is contained in this collider
     */
    contains(point: Vector): boolean;
    /**
     * Casts a ray at the Circle collider and returns the nearest point of collision
     * @param ray
     */
    rayCast(ray: Ray, max?: number): RayCastHit | null;
    getClosestLineBetween(shape: Collider): LineSegment;
    /**
     * @inheritdoc
     */
    collide(collider: Collider): CollisionContact[];
    /**
     * Find the point on the collider furthest in the direction specified
     */
    getFurthestPoint(direction: Vector): Vector;
    /**
     * Find the local point on the shape in the direction specified
     * @param direction
     */
    getFurthestLocalPoint(direction: Vector): Vector;
    /**
     * Get the axis aligned bounding box for the circle collider in world coordinates
     */
    get bounds(): BoundingBox;
    private _localBoundsDirty;
    private _localBounds;
    /**
     * Get the axis aligned bounding box for the circle collider in local coordinates
     */
    get localBounds(): BoundingBox;
    /**
     * Get axis not implemented on circles, since there are infinite axis in a circle
     */
    get axes(): Vector[];
    /**
     * Returns the moment of inertia of a circle given it's mass
     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia
     */
    getInertia(mass: number): number;
    update(transform: Transform): void;
    /**
     * Project the circle along a specified axis
     */
    project(axis: Vector): Projection;
    debug(ex: ExcaliburGraphicsContext, color: Color, options?: {
        lineWidth: number;
    }): void;
}

interface PolygonColliderOptions {
    /**
     * Pixel offset relative to a collider's body transform position.
     */
    offset?: Vector;
    /**
     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.
     * **Must be at least 3 points**
     */
    points: Vector[];
    /**
     * Suppresses convexity warning
     */
    suppressConvexWarning?: boolean;
}
/**
 * Polygon collider for detecting collisions
 */
declare class PolygonCollider extends Collider {
    private _logger;
    /**
     * Pixel offset relative to a collider's body transform position.
     */
    offset: Vector;
    flagDirty(): void;
    private _points;
    private _normals;
    get normals(): readonly Vector[];
    /**
     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.
     * Excalibur stores these in counter-clockwise order
     */
    set points(points: Vector[]);
    private _calculateNormals;
    /**
     * Points in the polygon in order around the perimeter in local coordinates. These are relative from the body transform position.
     * Excalibur stores these in counter-clockwise order
     */
    get points(): Vector[];
    private _transform;
    get transform(): Transform;
    private _transformedPoints;
    private _sides;
    private _localSides;
    constructor(options: PolygonColliderOptions);
    private _checkAndUpdateWinding;
    _isCounterClockwiseWinding(points: Vector[]): boolean;
    /**
     * Returns if the polygon collider is convex, Excalibur does not handle non-convex collision shapes.
     * Call {@apilink Polygon.triangulate} to generate a {@apilink CompositeCollider} from this non-convex shape
     */
    isConvex(): boolean;
    /**
     * Tessellates the polygon into a triangle fan as a {@apilink CompositeCollider} of triangle polygons
     */
    tessellate(): CompositeCollider;
    /**
     * Triangulate the polygon collider using the "Ear Clipping" algorithm.
     * Returns a new {@apilink CompositeCollider} made up of smaller triangles.
     */
    triangulate(): CompositeCollider;
    /**
     * Returns a clone of this ConvexPolygon, not associated with any collider
     */
    clone(): PolygonCollider;
    /**
     * Returns the world position of the collider, which is the current body transform plus any defined offset
     */
    get worldPos(): Vector;
    /**
     * Get the center of the collider in world coordinates
     */
    get center(): Vector;
    private _transformedPointsDirty;
    /**
     * Calculates the underlying transformation from the body relative space to world space
     */
    private _calculateTransformation;
    /**
     * Gets the points that make up the polygon in world space, from actor relative space (if specified)
     */
    getTransformedPoints(): Vector[];
    private _sidesDirty;
    /**
     * Gets the sides of the polygon in world space
     */
    getSides(): LineSegment[];
    private _localSidesDirty;
    /**
     * Returns the local coordinate space sides
     */
    getLocalSides(): LineSegment[];
    /**
     * Given a direction vector find the world space side that is most in that direction
     * @param direction
     */
    findSide(direction: Vector): LineSegment;
    /**
     * Given a direction vector find the local space side that is most in that direction
     * @param direction
     */
    findLocalSide(direction: Vector): LineSegment;
    /**
     * Get the axis associated with the convex polygon
     */
    get axes(): Vector[];
    /**
     * Updates the transform for the collision geometry
     *
     * Collision geometry (points/bounds) will not change until this is called.
     * @param transform
     */
    update(transform: Transform): void;
    /**
     * Tests if a point is contained in this collider in world space
     */
    contains(point: Vector): boolean;
    getClosestLineBetween(collider: Collider): LineSegment;
    /**
     * Returns a collision contact if the 2 colliders collide, otherwise collide will
     * return null.
     * @param collider
     */
    collide(collider: Collider): CollisionContact[];
    /**
     * Find the point on the collider furthest in the direction specified
     */
    getFurthestPoint(direction: Vector): Vector;
    /**
     * Find the local point on the collider furthest in the direction specified
     * @param direction
     */
    getFurthestLocalPoint(direction: Vector): Vector;
    /**
     * Finds the closes face to the point using perpendicular distance
     * @param point point to test against polygon
     */
    getClosestFace(point: Vector): {
        distance: Vector;
        face: LineSegment;
    };
    /**
     * Get the axis aligned bounding box for the polygon collider in world coordinates
     */
    get bounds(): BoundingBox;
    private _localBoundsDirty;
    private _localBounds;
    /**
     * Get the axis aligned bounding box for the polygon collider in local coordinates
     */
    get localBounds(): BoundingBox;
    private _cachedMass;
    private _cachedInertia;
    /**
     * Get the moment of inertia for an arbitrary polygon
     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia
     */
    getInertia(mass: number): number;
    /**
     * Casts a ray into the polygon and returns a vector representing the point of contact (in world space) or null if no collision.
     */
    rayCast(ray: Ray, max?: number): RayCastHit | null;
    /**
     * Project the edges of the polygon along a specified axis
     */
    project(axis: Vector): Projection;
    debug(ex: ExcaliburGraphicsContext, color: Color, options?: {
        lineWidth: number;
        pointSize: number;
    }): void;
}

declare class Pool<Type> {
    builder: () => Type;
    recycler?: (instance: Type) => Type;
    maxObjects: number;
    totalAllocations: number;
    index: number;
    objects: Type[];
    disableWarnings: boolean;
    private _logger;
    constructor(builder: () => Type, recycler?: (instance: Type) => Type, maxObjects?: number);
    dispose(): void;
    preallocate(): void;
    /**
     * Use many instances out of the in the context and return all to the pool.
     *
     * By returning values out of the context they will be un-hooked from the pool and are free to be passed to consumers
     * @param context
     */
    using(context: (pool: Pool<Type>) => Type[] | void): Type[];
    /**
     * Use a single instance out of th pool and immediately return it to the pool
     * @param context
     */
    borrow(context: (object: Type) => void): void;
    /**
     * Retrieve a value from the pool, will allocate a new instance if necessary or recycle from the pool
     */
    get(): Type;
    /**
     * Signals we are done with the pool objects for now, Reclaims all objects in the pool.
     *
     * If a list of pooled objects is passed to done they are un-hooked from the pool and are free
     * to be passed to consumers
     * @param objects A list of object to separate from the pool
     */
    done(...objects: Type[]): Type[];
    done(): void;
}

/**
 * Specific information about a contact and it's separation
 */
declare class SeparationInfo {
    /**
     * Collider A
     */
    collider: Collider;
    /**
     * Signed value (negative means overlap, positive no overlap)
     */
    separation: number;
    /**
     * Axis of separation from the collider's perspective
     */
    axis: Vector;
    /**
     * Local axis of separation from the collider's perspective
     */
    localAxis?: Vector;
    /**
     * Side of separation (reference) from the collider's perspective
     */
    side?: LineSegment;
    /**
     * Local side of separation (reference) from the collider's perspective
     */
    localSide?: LineSegment;
    /**
     * Index of the separation side (reference) from the collider's perspective
     */
    sideId?: number;
    /**
     * Point on collider B (incident point)
     */
    point: Vector;
    /**
     * Local point on collider B (incident point)
     */
    localPoint?: Vector;
}
declare class SeparatingAxis {
    static SeparationPool: Pool<SeparationInfo>;
    private static _ZERO;
    private static _SCRATCH_POINT;
    private static _SCRATCH_SUB_POINT;
    private static _SCRATCH_NORMAL;
    private static _SCRATCH_MATRIX;
    static findPolygonPolygonSeparation(polyA: PolygonCollider, polyB: PolygonCollider): SeparationInfo;
    static findCirclePolygonSeparation(circle: CircleCollider, polygon: PolygonCollider): Vector | null;
    static findPolygonPolygonSeparationDegenerate(polyA: PolygonCollider, polyB: PolygonCollider): SeparationInfo;
}

/**
 * Collision contacts are used internally by Excalibur to resolve collision between colliders. This
 * Pair prevents collisions from being evaluated more than one time
 */
declare class CollisionContact {
    private _canceled;
    /**
     * Currently the ids between colliders
     */
    readonly id: string;
    /**
     * The first collider in the collision
     */
    colliderA: Collider;
    /**
     * The second collider in the collision
     */
    colliderB: Collider;
    /**
     * The minimum translation vector to resolve overlap, pointing away from colliderA
     */
    mtv: Vector;
    /**
     * World space contact points between colliderA and colliderB
     */
    points: Vector[];
    /**
     * Local space contact points between colliderA and colliderB
     */
    localPoints: Vector[];
    /**
     * The collision normal, pointing away from colliderA
     */
    normal: Vector;
    /**
     * The collision tangent
     */
    tangent: Vector;
    /**
     * Information about the specifics of the collision contact separation
     */
    info: SeparationInfo;
    bodyA: BodyComponent | null;
    bodyB: BodyComponent | null;
    constructor(colliderA: Collider, colliderB: Collider, mtv: Vector, normal: Vector, tangent: Vector, points: Vector[], localPoints: Vector[], info: SeparationInfo);
    /**
     * Match contact awake state, except if body's are Fixed
     */
    matchAwake(): void;
    isCanceled(): boolean;
    cancel(): void;
    /**
     * Biases the contact so that the given collider is colliderA
     */
    bias(collider: Collider): this;
}

interface EdgeColliderOptions {
    /**
     * The beginning of the edge defined in local coordinates to the collider
     */
    begin: Vector;
    /**
     * The ending of the edge defined in local coordinates to the collider
     */
    end: Vector;
    /**
     * Optionally specify an offset
     */
    offset?: Vector;
}
/**
 * Edge is a single line collider to create collisions with a single line.
 */
declare class EdgeCollider extends Collider {
    offset: Vector;
    begin: Vector;
    end: Vector;
    private _transform;
    private _globalMatrix;
    constructor(options: EdgeColliderOptions);
    /**
     * Returns a clone of this Edge, not associated with any collider
     */
    clone(): EdgeCollider;
    get worldPos(): Vector;
    /**
     * Get the center of the collision area in world coordinates
     */
    get center(): Vector;
    private _getTransformedBegin;
    private _getTransformedEnd;
    /**
     * Returns the slope of the line in the form of a vector
     */
    getSlope(): Vector;
    /**
     * Returns the length of the line segment in pixels
     */
    getLength(): number;
    /**
     * Tests if a point is contained in this collision area
     */
    contains(): boolean;
    /**
     * @inheritdoc
     */
    rayCast(ray: Ray, max?: number): RayCastHit | null;
    /**
     * Returns the closes line between this and another collider, from this -> collider
     * @param shape
     */
    getClosestLineBetween(shape: Collider): LineSegment;
    /**
     * @inheritdoc
     */
    collide(shape: Collider): CollisionContact[];
    /**
     * Find the point on the collider furthest in the direction specified
     */
    getFurthestPoint(direction: Vector): Vector;
    private _boundsFromBeginEnd;
    /**
     * Get the axis aligned bounding box for the edge collider in world space
     */
    get bounds(): BoundingBox;
    /**
     * Get the axis aligned bounding box for the edge collider in local space
     */
    get localBounds(): BoundingBox;
    /**
     * Returns this edge represented as a line in world coordinates
     */
    asLine(): LineSegment;
    /**
     * Return this edge as a line in local line coordinates (relative to the position)
     */
    asLocalLine(): LineSegment;
    /**
     * Get the axis associated with the edge
     */
    get axes(): Vector[];
    /**
     * Get the moment of inertia for an edge
     * https://en.wikipedia.org/wiki/List_of_moments_of_inertia
     */
    getInertia(mass: number): number;
    /**
     * @inheritdoc
     */
    update(transform: Transform): void;
    /**
     * Project the edge along a specified axis
     */
    project(axis: Vector): Projection;
    debug(ex: ExcaliburGraphicsContext, color: Color): void;
}

declare class ColliderComponent extends Component {
    events: EventEmitter<any>;
    /**
     * Observable that notifies when a collider is added to the body
     */
    $colliderAdded: Observable<Collider>;
    /**
     * Observable that notifies when a collider is removed from the body
     */
    $colliderRemoved: Observable<Collider>;
    constructor(collider?: Collider);
    private _collider;
    /**
     * Get the current collider geometry
     */
    get(): Collider | undefined;
    /**
     * Set the collider geometry
     * @param collider
     * @returns the collider you set
     */
    set<T extends Collider>(collider: T): T;
    private _collidersToRemove;
    /**
     * Remove collider geometry from collider component
     */
    clear(): void;
    processColliderRemoval(): void;
    clone(): ColliderComponent;
    /**
     * Return world space bounds
     */
    get bounds(): BoundingBox;
    /**
     * Return local space bounds
     */
    get localBounds(): BoundingBox;
    /**
     * Update the collider's transformed geometry
     */
    update(): void;
    /**
     * Collide component with another
     * @param other
     */
    collide(other: ColliderComponent): CollisionContact[];
    onAdd(entity: Entity): void;
    onRemove(): void;
    /**
     * Sets up a box geometry based on the current bounds of the associated actor of this physics body.
     *
     * If no width/height are specified the body will attempt to use the associated actor's width/height.
     *
     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.
     */
    useBoxCollider(width: number, height: number, anchor?: Vector, center?: Vector): PolygonCollider;
    /**
     * Sets up a {@apilink PolygonCollider | \`polygon\`} collision geometry based on a list of of points relative
     *  to the anchor of the associated actor
     * of this physics body.
     *
     * Only [convex polygon](https://en.wikipedia.org/wiki/Convex_polygon) definitions are supported.
     *
     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.
     */
    usePolygonCollider(points: Vector[], center?: Vector): PolygonCollider;
    /**
     * Sets up a {@apilink Circle | \`circle collision geometry\`} as the only collider with a specified radius in pixels.
     *
     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.
     */
    useCircleCollider(radius: number, center?: Vector): CircleCollider;
    /**
     * Sets up an {@apilink Edge | \`edge collision geometry\`} with a start point and an end point relative to the anchor of the associated actor
     * of this physics body.
     *
     * By default, the box is center is at (0, 0) which means it is centered around the actors anchor.
     */
    useEdgeCollider(begin: Vector, end: Vector): EdgeCollider;
    /**
     * Setups up a {@apilink CompositeCollider} which can define any arbitrary set of excalibur colliders
     * @param colliders
     */
    useCompositeCollider(colliders: Collider[]): CompositeCollider;
}

/**
 * Excalibur helper for defining colliders quickly
 */
declare class Shape {
    /**
     * Creates a box collider, under the hood defines a {@apilink PolygonCollider} collider
     * @param width Width of the box
     * @param height Height of the box
     * @param anchor Anchor of the box (default (.5, .5)) which positions the box relative to the center of the collider's position
     * @param offset Optional offset relative to the collider in local coordinates
     */
    static Box(width: number, height: number, anchor?: Vector, offset?: Vector): PolygonCollider;
    /**
     * Creates a new {@apilink PolygonCollider | \`arbitrary polygon\`} collider
     *
     * PolygonColliders are useful for creating convex polygon shapes
     * @param points Points specified in counter clockwise
     * @param offset Optional offset relative to the collider in local coordinates
     */
    static Polygon(points: Vector[], offset?: Vector, suppressConvexWarning?: boolean): PolygonCollider;
    /**
     * Creates a new {@apilink CircleCollider | \`circle\`} collider
     *
     * Circle colliders are useful for balls, or to make collisions more forgiving on sharp edges
     * @param radius Radius of the circle collider
     * @param offset Optional offset relative to the collider in local coordinates
     */
    static Circle(radius: number, offset?: Vector): CircleCollider;
    /**
     * Creates a new {@apilink EdgeCollider | \`edge\`} collider
     *
     * Edge colliders are useful for  floors, walls, and other barriers
     * @param begin Beginning of the edge in local coordinates to the collider
     * @param end Ending of the edge in local coordinates to the collider
     */
    static Edge(begin: Vector, end: Vector): EdgeCollider;
    /**
     * Creates a new capsule shaped {@apilink CompositeCollider} using 2 circles and a box
     *
     * Capsule colliders are useful for platformers with incline or jagged floors to have a smooth
     * player experience.
     * @param width
     * @param height
     * @param offset Optional offset
     */
    static Capsule(width: number, height: number, offset?: Vector): CompositeCollider;
}

declare const CollisionJumpTable: {
    CollideCircleCircle(circleA: CircleCollider, circleB: CircleCollider): CollisionContact[];
    CollideCirclePolygon(circle: CircleCollider, polygon: PolygonCollider): CollisionContact[];
    CollideCircleEdge(circle: CircleCollider, edge: EdgeCollider): CollisionContact[];
    CollideEdgeEdge(): CollisionContact[];
    CollidePolygonEdge(polygon: PolygonCollider, edge: EdgeCollider): CollisionContact[];
    CollidePolygonPolygon(polyA: PolygonCollider, polyB: PolygonCollider): CollisionContact[];
    FindContactSeparation(contact: CollisionContact, localPoint: Vector): number;
};

declare const ClosestLineJumpTable: {
    PolygonPolygonClosestLine(polygonA: PolygonCollider, polygonB: PolygonCollider): LineSegment;
    PolygonEdgeClosestLine(polygon: PolygonCollider, edge: EdgeCollider): LineSegment;
    PolygonCircleClosestLine(polygon: PolygonCollider, circle: CircleCollider): LineSegment;
    CircleCircleClosestLine(circleA: CircleCollider, circleB: CircleCollider): LineSegment;
    CircleEdgeClosestLine(circle: CircleCollider, edge: EdgeCollider): LineSegment;
    EdgeEdgeClosestLine(edgeA: EdgeCollider, edgeB: EdgeCollider): LineSegment;
};

/**
 * Static class for managing collision groups in excalibur, there is a maximum of 32 collision groups possible in excalibur
 */
declare class CollisionGroupManager {
    private static _STARTING_BIT;
    private static _MAX_GROUPS;
    private static _CURRENT_GROUP;
    private static _CURRENT_BIT;
    private static _GROUPS;
    /**
     * Create a new named collision group up to a max of 32.
     * @param name Name for the collision group
     * @param mask Optionally provide your own 32-bit mask, if none is provide the manager will generate one
     */
    static create(name: string, mask?: number): CollisionGroup;
    /**
     * Get all collision groups currently tracked by excalibur
     */
    static get groups(): CollisionGroup[];
    /**
     * Get a collision group by it's name
     * @param name
     */
    static groupByName(name: string): CollisionGroup;
    /**
     * Resets the managers internal group management state
     */
    static reset(): void;
}

/**
 * Models a potential collision between 2 colliders
 */
declare class Pair {
    colliderA: Collider;
    colliderB: Collider;
    id: string;
    constructor(colliderA: Collider, colliderB: Collider);
    /**
     * Returns whether a it is allowed for 2 colliders in a Pair to collide
     * @param colliderA
     * @param colliderB
     */
    static canCollide(colliderA: Collider, colliderB: Collider): boolean;
    /**
     * Returns whether or not it is possible for the pairs to collide
     */
    get canCollide(): boolean;
    /**
     * Runs the collision intersection logic on the members of this pair
     */
    collide(): CollisionContact[];
    /**
     * Check if the collider is part of the pair
     * @param collider
     */
    hasCollider(collider: Collider): boolean;
    /**
     * Calculates the unique pair hash id for this collision pair (owning id)
     */
    static calculatePairHash(idA: Id<'collider'>, idB: Id<'collider'>): string;
}

interface RayCastOptions {
    /**
     * Optionally specify the maximum distance in pixels to ray cast, default is Infinity
     */
    maxDistance?: number;
    /**
     * Optionally specify a collision group to target in the ray cast, default is All.
     */
    collisionGroup?: CollisionGroup;
    /**
     * Optionally specify a collision mask to target multiple collision categories
     */
    collisionMask?: number;
    /**
     * Optionally search for all colliders that intersect the ray cast.
     *
     * Default false
     */
    searchAllColliders?: boolean;
    /**
     * Optionally ignore things with CollisionGroup.All and only test against things with an explicit group
     *
     * Default false
     */
    ignoreCollisionGroupAll?: boolean;
    /**
     * Optionally provide a any filter function to filter on arbitrary qualities of a ray cast hit
     *
     * Filters run after any collision mask/collision group filtering, it is the last decision
     *
     * Returning true means you want to include the collider in your results, false means exclude it
     */
    filter?: (hit: RayCastHit) => boolean;
}

declare enum ColorBlindnessMode {
    Protanope = "Protanope",
    Deuteranope = "Deuteranope",
    Tritanope = "Tritanope"
}

declare class ColorBlindFlags {
    private _engine;
    private _colorBlindPostProcessor;
    constructor(engine: Engine);
    /**
     * Correct colors for a specified color blindness
     * @param colorBlindness
     */
    correct(colorBlindness: ColorBlindnessMode): void;
    /**
     * Simulate colors for a specified color blindness
     * @param colorBlindness
     */
    simulate(colorBlindness: ColorBlindnessMode): void;
    /**
     * Remove color blindness post processor
     */
    clear(): void;
}

interface FpsSamplerOptions {
    /**
     * Specify the sampling period in milliseconds (default 100)
     */
    samplePeriod?: number;
    /**
     * Specify the initial FPS
     */
    initialFps: number;
    /**
     * Specify the function used to return the current time (in milliseconds)
     */
    nowFn: () => number;
}
declare class FpsSampler {
    private _fps;
    private _samplePeriod;
    private _currentFrameTime;
    private _frames;
    private _previousSampleTime;
    private _beginFrameTime;
    private _nowFn;
    constructor(options: FpsSamplerOptions);
    /**
     * Start of code block to sample FPS for
     */
    start(): void;
    /**
     * End of code block to sample FPS for
     */
    end(): void;
    /**
     * Return the currently sampled fps over the last sample period, by default every 100ms
     */
    get fps(): number;
    /**
     * Return the instantaneous fps, this can be less useful because it will fluctuate given the current frames time
     */
    get instant(): number;
}

type ScheduledCallbackTiming = 'preframe' | 'postframe' | 'preupdate' | 'postupdate' | 'predraw' | 'postdraw';
/**
 * Unique identifier for a scheduled callback
 */
type ScheduleId = number;
interface ClockOptions {
    /**
     * Define the function you'd like the clock to tick when it is started
     */
    tick: (elapsed: number) => any;
    /**
     * Optionally define the fatal exception handler, used if an error is thrown in tick
     */
    onFatalException?: (e: unknown) => any;
    /**
     * Optionally limit the maximum FPS of the clock
     */
    maxFps?: number;
}
/**
 * Abstract Clock is the base type of all Clocks
 *
 * It has a few opinions
 * 1. It manages the calculation of what "elapsed" time means and thus maximum fps
 * 2. The default timing api is implemented in now()
 *
 * To implement your own clock, extend Clock and override start/stop to start and stop the clock, then call update() with whatever
 * method is unique to your clock implementation.
 */
declare abstract class Clock {
    protected tick: (elapsed: number) => any;
    private _onFatalException;
    private _maxFps;
    private _lastTime;
    fpsSampler: FpsSampler;
    private _options;
    private _elapsed;
    private _scheduledCbs;
    private _totalElapsed;
    private _nextScheduleId;
    constructor(options: ClockOptions);
    /**
     * Get the elapsed time for the last completed frame
     */
    elapsed(): number;
    /**
     * Get the current time in milliseconds
     */
    now(): number;
    toTestClock(): TestClock;
    toStandardClock(): StandardClock;
    setFatalExceptionHandler(handler: (e: unknown) => any): void;
    /**
     * Schedule a callback to fire given a timeout in milliseconds using the excalibur {@apilink Clock}
     *
     * This is useful to use over the built in browser \`setTimeout\` because callbacks will be tied to the
     * excalibur update clock, instead of browser time, this means that callbacks wont fire if the game is
     * stopped or paused.
     * @param cb callback to fire
     * @param timeoutMs Optionally specify a timeout in milliseconds from now, default is 0ms which means the next possible tick
     * @param timing Optionally specify a timeout in milliseconds from now, default is 0ms which means the next possible tick
     * @returns A unique identifier that can be used to clear the scheduled callback with {@apilink clearSchedule}
     */
    schedule(cb: (elapsed: number) => any, timeoutMs?: number, timing?: ScheduledCallbackTiming): ScheduleId;
    /**
     * Clears a scheduled callback using the ID returned from {@apilink schedule}
     * @param id The ID of the scheduled callback to clear
     */
    clearSchedule(id: ScheduleId): void;
    /**
     * Called internally to trigger scheduled callbacks in the clock
     * @param timing
     * @internal
     */
    __runScheduledCbs(timing?: ScheduledCallbackTiming): void;
    protected update(overrideUpdateMs?: number): void;
    /**
     * Returns if the clock is currently running
     */
    abstract isRunning(): boolean;
    /**
     * Start the clock, it will then periodically call the tick(elapsedMilliseconds) since the last tick
     */
    abstract start(): void;
    /**
     * Stop the clock, tick() is no longer called
     */
    abstract stop(): void;
}
/**
 * The {@apilink StandardClock} implements the requestAnimationFrame browser api to run the tick()
 */
declare class StandardClock extends Clock {
    private _running;
    private _requestId;
    constructor(options: ClockOptions);
    isRunning(): boolean;
    start(): void;
    stop(): void;
}
interface TestClockOptions {
    /**
     * Specify the update milliseconds to use for each manual step()
     */
    defaultUpdateMs: number;
}
/**
 * The TestClock is meant for debugging interactions in excalibur that require precise timing to replicate or test
 */
declare class TestClock extends Clock {
    private _logger;
    private _updateMs;
    private _running;
    private _currentTime;
    constructor(options: ClockOptions & TestClockOptions);
    /**
     * Get the current time in milliseconds
     */
    now(): number;
    isRunning(): boolean;
    start(): void;
    stop(): void;
    /**
     * Manually step the clock forward 1 tick, optionally specify an elapsed time in milliseconds
     * @param overrideUpdateMs
     */
    step(overrideUpdateMs?: number): void;
    /**
     * Run a number of steps that tick the clock, optionally specify an elapsed time in milliseconds
     * @param numberOfSteps
     * @param overrideUpdateMs
     */
    run(numberOfSteps: number, overrideUpdateMs?: number): void;
}

/**
 * Debug stats containing current and previous frame statistics
 */
interface DebugStats {
    currFrame: FrameStats;
    prevFrame: FrameStats;
}
/**
 * Represents a frame's individual statistics
 */
interface FrameStatistics {
    /**
     * The number of the frame
     */
    id: number;
    /**
     * Gets the frame's delta (time since last frame scaled by {@apilink Engine.timescale}) (in ms)
     *
     * Excalibur extension depends on this
     */
    elapsedMs: number;
    /**
     * Gets the frame's frames-per-second (FPS)
     */
    fps: number;
    /**
     * Duration statistics (in ms)
     */
    duration: FrameDurationStats;
    /**
     * Actor statistics
     */
    actors: FrameActorStats;
    /**
     * Physics statistics
     */
    physics: PhysicsStatistics;
    /**
     * Graphics statistics
     */
    graphics: GraphicsStatistics;
}
/**
 * Represents actor stats for a frame
 */
interface FrameActorStats {
    /**
     * Gets the frame's number of actors (alive)
     */
    alive: number;
    /**
     * Gets the frame's number of actors (killed)
     */
    killed: number;
    /**
     * Gets the frame's number of remaining actors (alive - killed)
     */
    remaining: number;
    /**
     * Gets the frame's number of UI actors
     */
    ui: number;
    /**
     * Gets the frame's number of total actors (remaining + UI)
     */
    total: number;
}
/**
 * Represents duration stats for a frame
 */
interface FrameDurationStats {
    /**
     * Gets the frame's total time to run the update function (in ms)
     */
    update: number;
    /**
     * Gets the frame's total time to run the draw function (in ms)
     */
    draw: number;
    /**
     * Gets the frame's total render duration (update + draw duration) (in ms)
     */
    total: number;
}
/**
 * Represents physics stats for the current frame
 */
interface PhysicsStatistics {
    /**
     * Gets the number of broadphase collision pairs which
     */
    pairs: number;
    /**
     * Gets the number of actual collisions
     */
    collisions: number;
    /**
     * Copy of the current frame contacts (only updated if debug is toggled on)
     */
    contacts: Map<string, CollisionContact>;
    /**
     * Gets the number of fast moving bodies using raycast continuous collisions in the scene
     */
    fastBodies: number;
    /**
     * Gets the number of bodies that had a fast body collision resolution
     */
    fastBodyCollisions: number;
    /**
     * Gets the time it took to calculate the broadphase pairs
     */
    broadphase: number;
    /**
     * Gets the time it took to calculate the narrowphase
     */
    narrowphase: number;
}
interface GraphicsStatistics {
    drawCalls: number;
    drawnImages: number;
}
/**
 * Debug statistics and flags for Excalibur. If polling these values, it would be
 * best to do so on the \`postupdate\` event for {@apilink Engine}, after all values have been
 * updated during a frame.
 */
declare class DebugConfig {
    private _engine;
    constructor(engine: Engine);
    /**
     * Switch the current excalibur clock with the {@apilink TestClock} and return
     * it in the same running state.
     *
     * This is useful when you need to debug frame by frame.
     */
    useTestClock(): TestClock;
    /**
     * Switch the current excalibur clock with the {@apilink StandardClock} and
     * return it in the same running state.
     *
     * This is useful when you need to switch back to normal mode after
     * debugging.
     */
    useStandardClock(): StandardClock;
    /**
     * Performance statistics
     */
    stats: DebugStats;
    /**
     * Correct or simulate color blindness using {@apilink ColorBlindnessPostProcessor}.
     * @warning Will reduce FPS.
     */
    colorBlindMode: ColorBlindFlags;
    /**
     * Filter debug context to named entities or entity ids
     */
    filter: {
        useFilter: boolean;
        nameQuery: string;
        ids: number[];
    };
    /**
     * Entity debug settings
     */
    entity: {
        showAll: boolean;
        showId: boolean;
        showName: boolean;
    };
    /**
     * Transform component debug settings
     */
    transform: {
        showAll: boolean;
        debugZIndex: number;
        showPosition: boolean;
        showPositionLabel: boolean;
        positionColor: Color;
        showZIndex: boolean;
        showScale: boolean;
        scaleColor: Color;
        showRotation: boolean;
        rotationColor: Color;
    };
    /**
     * Graphics component debug settings
     */
    graphics: {
        showAll: boolean;
        showBounds: boolean;
        boundsColor: Color;
    };
    /**
     * Collider component debug settings
     */
    collider: {
        showAll: boolean;
        showBounds: boolean;
        boundsColor: Color;
        showOwner: boolean;
        showGeometry: boolean;
        geometryColor: Color;
        geometryLineWidth: number;
        geometryPointSize: number;
    };
    /**
     * Physics simulation debug settings
     */
    physics: {
        showAll: boolean;
        showBroadphaseSpacePartitionDebug: boolean;
        showCollisionNormals: boolean;
        collisionNormalColor: Color;
        showCollisionContacts: boolean;
        contactSize: number;
        collisionContactColor: Color;
    };
    /**
     * Motion component debug settings
     */
    motion: {
        showAll: boolean;
        showVelocity: boolean;
        velocityColor: Color;
        showAcceleration: boolean;
        accelerationColor: Color;
    };
    /**
     * Body component debug settings
     */
    body: {
        showAll: boolean;
        showCollisionGroup: boolean;
        showCollisionType: boolean;
        showSleeping: boolean;
        showMotion: boolean;
        showMass: boolean;
    };
    /**
     * Camera debug settings
     */
    camera: {
        showAll: boolean;
        showFocus: boolean;
        focusColor: Color;
        showZoom: boolean;
    };
    tilemap: {
        showAll: boolean;
        showGrid: boolean;
        gridColor: Color;
        gridWidth: number;
        showSolidBounds: boolean;
        solidBoundsColor: Color;
        showColliderGeometry: boolean;
    };
    isometric: {
        showAll: boolean;
        showPosition: boolean;
        positionColor: Color;
        positionSize: number;
        showGrid: boolean;
        gridColor: Color;
        gridWidth: number;
        showColliderGeometry: boolean;
    };
}
/**
 * Implementation of a frame's stats. Meant to have values copied via {@apilink FrameStats.reset}, avoid
 * creating instances of this every frame.
 */
declare class FrameStats implements FrameStatistics {
    private _id;
    private _elapsedMs;
    private _fps;
    private _actorStats;
    private _durationStats;
    private _physicsStats;
    private _graphicsStats;
    /**
     * Zero out values or clone other IFrameStat stats. Allows instance reuse.
     * @param [otherStats] Optional stats to clone
     */
    reset(otherStats?: FrameStatistics): void;
    /**
     * Provides a clone of this instance.
     */
    clone(): FrameStats;
    /**
     * Gets the frame's id
     */
    get id(): number;
    /**
     * Sets the frame's id
     */
    set id(value: number);
    /**
     * Gets the frame's delta (time since last frame)
     */
    get elapsedMs(): number;
    /**
     * Sets the frame's delta (time since last frame). Internal use only.
     * @internal
     */
    set elapsedMs(value: number);
    /**
     * Gets the frame's frames-per-second (FPS)
     */
    get fps(): number;
    /**
     * Sets the frame's frames-per-second (FPS). Internal use only.
     * @internal
     */
    set fps(value: number);
    /**
     * Gets the frame's actor statistics
     */
    get actors(): FrameActorStats;
    /**
     * Gets the frame's duration statistics
     */
    get duration(): FrameDurationStats;
    /**
     * Gets the frame's physics statistics
     */
    get physics(): PhysicsStats;
    /**
     * Gets the frame's graphics statistics
     */
    get graphics(): GraphicsStatistics;
}
declare class PhysicsStats implements PhysicsStatistics {
    private _pairs;
    private _collisions;
    private _contacts;
    private _fastBodies;
    private _fastBodyCollisions;
    private _broadphase;
    private _narrowphase;
    /**
     * Zero out values or clone other IPhysicsStats stats. Allows instance reuse.
     * @param [otherStats] Optional stats to clone
     */
    reset(otherStats?: PhysicsStatistics): void;
    /**
     * Provides a clone of this instance.
     */
    clone(): PhysicsStatistics;
    get pairs(): number;
    set pairs(value: number);
    get collisions(): number;
    set collisions(value: number);
    get contacts(): Map<string, CollisionContact>;
    set contacts(contacts: Map<string, CollisionContact>);
    get fastBodies(): number;
    set fastBodies(value: number);
    get fastBodyCollisions(): number;
    set fastBodyCollisions(value: number);
    get broadphase(): number;
    set broadphase(value: number);
    get narrowphase(): number;
    set narrowphase(value: number);
}

declare class DebugSystem extends System {
    world: World;
    static priority: number;
    readonly systemType = SystemType.Draw;
    private _graphicsContext;
    private _collisionSystem;
    private _camera;
    private _engine;
    query: Query<typeof TransformComponent>;
    constructor(world: World);
    initialize(world: World, scene: Scene): void;
    update(): void;
    postupdate(engine: Scene<unknown>, elapsed: number): void;
    /**
     * This applies the current entity transform to the graphics context
     * @param entity
     */
    private _applyTransform;
    /**
     * Applies the current camera transform if in world coordinates
     * @param transform
     */
    private _pushCameraTransform;
    /**
     * Resets the current camera transform if in world coordinates
     * @param transform
     */
    private _popCameraTransform;
}

/**
 * Definition for collision processor
 *
 * Collision processors are responsible for tracking colliders and identifying contacts between them
 */
interface CollisionProcessor {
    /**
     *
     */
    rayCast(ray: Ray, options?: RayCastOptions): RayCastHit[];
    /**
     * Query the collision processor for colliders that contain the point
     * @param point
     */
    query(point: Vector): Collider[];
    /**
     * Query the collision processor for colliders that overlap with the bounds
     * @param bounds
     */
    query(bounds: BoundingBox): Collider[];
    /**
     * Get all tracked colliders
     */
    getColliders(): readonly Collider[];
    /**
     * Track collider in collision processor
     */
    track(target: Collider): void;
    /**
     * Untrack collider in collision processor
     */
    untrack(target: Collider): void;
    /**
     * Detect potential collision pairs given a list of colliders
     */
    broadphase(targets: Collider[], elapsed: number, stats?: FrameStats): Pair[];
    /**
     * Identify actual collisions from those pairs, and calculate collision impulse
     */
    narrowphase(pairs: Pair[], stats?: FrameStats): CollisionContact[];
    /**
     * Update the internal structures to track colliders
     */
    update(targets: Collider[], elapsed: number): number;
    /**
     * Draw any debug information
     */
    debug(ex: ExcaliburGraphicsContext, elapsed: number): void;
}

/**
 * Dynamic Tree Node used for tracking bounds within the tree
 */
declare class TreeNode<T> {
    parent?: TreeNode<T>;
    left: TreeNode<T>;
    right: TreeNode<T>;
    bounds: BoundingBox;
    height: number;
    data: T;
    constructor(parent?: TreeNode<T>);
    isLeaf(): boolean;
}
interface ColliderProxy<T> {
    id: Id<'collider'>;
    owner: T;
    bounds: BoundingBox;
}
/**
 * The DynamicTrees provides a spatial partitioning data structure for quickly querying for overlapping bounding boxes for
 * all tracked bodies. The worst case performance of this is O(n*log(n)) where n is the number of bodies in the tree.
 *
 * Internally the bounding boxes are organized as a balanced binary tree of bounding boxes, where the leaf nodes are tracked bodies.
 * Every non-leaf node is a bounding box that contains child bounding boxes.
 */
declare class DynamicTree<TProxy extends ColliderProxy<Entity>> {
    private _config;
    worldBounds: BoundingBox;
    root: TreeNode<TProxy>;
    nodes: {
        [key: number]: TreeNode<TProxy>;
    };
    constructor(_config: Required<DynamicTreeConfig>, worldBounds?: BoundingBox);
    /**
     * Inserts a node into the dynamic tree
     */
    private _insert;
    /**
     * Removes a node from the dynamic tree
     */
    private _remove;
    /**
     * Tracks a body in the dynamic tree
     */
    trackCollider(collider: TProxy): void;
    /**
     * Updates the dynamic tree given the current bounds of each body being tracked
     */
    updateCollider(collider: TProxy): boolean;
    /**
     * Untracks a body from the dynamic tree
     */
    untrackCollider(collider: TProxy): void;
    /**
     * Balances the tree about a node
     */
    private _balance;
    /**
     * Returns the internal height of the tree, shorter trees are better. Performance drops as the tree grows
     */
    getHeight(): number;
    /**
     * Queries the Dynamic Axis Aligned Tree for bodies that could be colliding with the provided body.
     *
     * In the query callback, it will be passed a potential collider. Returning true from this callback indicates
     * that you are complete with your query and you do not want to continue. Returning false will continue searching
     * the tree until all possible colliders have been returned.
     */
    query(collider: TProxy, callback: (other: TProxy) => boolean): void;
    /**
     * Queries the Dynamic Axis Aligned Tree for bodies that could be intersecting. By default the raycast query uses an infinitely
     * long ray to test the tree specified by \`max\`.
     *
     * In the query callback, it will be passed a potential body that intersects with the raycast. Returning true from this
     * callback indicates that your are complete with your query and do not want to continue. Return false will continue searching
     * the tree until all possible bodies that would intersect with the ray have been returned.
     */
    rayCastQuery(ray: Ray, max: number, callback: (other: TProxy) => boolean): void;
    getNodes(): TreeNode<TProxy>[];
    debug(ex: ExcaliburGraphicsContext): void;
}

/**
 * Responsible for performing the collision broadphase (locating potential collisions) and
 * the narrowphase (actual collision contacts)
 */
declare class DynamicTreeCollisionProcessor implements CollisionProcessor {
    private _config;
    private _dynamicCollisionTree;
    private _pairs;
    private _collisionPairCache;
    private _colliders;
    constructor(_config: DeepRequired<PhysicsConfig>);
    getColliders(): readonly Collider[];
    query(point: Vector): Collider[];
    query(bounds: BoundingBox): Collider[];
    rayCast(ray: Ray, options?: RayCastOptions): RayCastHit[];
    /**
     * Tracks a physics body for collisions
     */
    track(target: Collider): void;
    /**
     * Untracks a physics body
     */
    untrack(target: Collider): void;
    private _pairExists;
    /**
     * Detects potential collision pairs in a broadphase approach with the dynamic AABB tree strategy
     */
    broadphase(targets: Collider[], elapsed: number, stats?: FrameStats): Pair[];
    /**
     * Applies narrow phase on collision pairs to find actual area intersections
     * Adds actual colliding pairs to stats' Frame data
     */
    narrowphase(pairs: Pair[], stats?: FrameStats): CollisionContact[];
    /**
     * Update the dynamic tree positions
     */
    update(targets: Collider[]): number;
    debug(ex: ExcaliburGraphicsContext): void;
}

declare class HashGridProxy<T extends {
    bounds: BoundingBox;
}> {
    object: T;
    id: number;
    /**
     * left bounds x hash coordinate
     */
    leftX: number;
    /**
     * right bounds x hash coordinate
     */
    rightX: number;
    /**
     * bottom bounds y hash coordinate
     */
    bottomY: number;
    /**
     * top bounds y hash coordinate
     */
    topY: number;
    bounds: BoundingBox;
    cells: HashGridCell<T>[];
    hasZeroBounds: boolean;
    /**
     * Grid size in pixels
     */
    readonly gridSize: number;
    constructor(object: T, gridSize: number);
    /**
     * Has the hashed bounds changed
     */
    hasChanged(): boolean;
    /**
     * Clears all collider references
     */
    clear(): void;
    /**
     * Update bounds of the proxy
     */
    updateBounds(): void;
    /**
     * Updates the hashed bounds coordinates
     */
    update(): void;
}
declare class HashGridCell<TObject extends {
    bounds: BoundingBox;
}, TProxy extends HashGridProxy<TObject> = HashGridProxy<TObject>> {
    proxies: TProxy[];
    key: string;
    x: number;
    y: number;
    configure(x: number, y: number): void;
    static calculateHashKey(x: number, y: number): string;
}
declare class SparseHashGrid<TObject extends {
    bounds: BoundingBox;
}, TProxy extends HashGridProxy<TObject> = HashGridProxy<TObject>> {
    readonly gridSize: number;
    readonly sparseHashGrid: Map<string, HashGridCell<TObject, TProxy>>;
    readonly objectToProxy: Map<TObject, TProxy>;
    bounds: BoundingBox;
    private _hashGridCellPool;
    private _buildProxy;
    constructor(options: {
        size: number;
        proxyFactory?: (object: TObject, gridSize: number) => TProxy;
    });
    query(point: Vector): TObject[];
    query(bounds: BoundingBox): TObject[];
    get(xCoord: number, yCoord: number): HashGridCell<TObject>;
    private _insert;
    private _remove;
    track(target: TObject): void;
    untrack(target: TObject): void;
    update(targets: TObject[]): number;
    debug(ex: ExcaliburGraphicsContext, elapsed: number): void;
}

/**
 * Proxy type to stash collision info
 */
declare class HashColliderProxy extends HashGridProxy<Collider> {
    collider: Collider;
    id: number;
    owner: Entity;
    body?: BodyComponent;
    collisionType: CollisionType;
    hasZeroBounds: boolean;
    /**
     * left bounds x hash coordinate
     */
    leftX: number;
    /**
     * right bounds x hash coordinate
     */
    rightX: number;
    /**
     * bottom bounds y hash coordinate
     */
    bottomY: number;
    /**
     * top bounds y hash coordinate
     */
    topY: number;
    /**
     * References to the hash cell the collider is a current member of
     */
    cells: HashGridCell<Collider, HashColliderProxy>[];
    /**
     * Grid size in pixels
     */
    readonly gridSize: number;
    constructor(collider: Collider, gridSize: number);
    /**
     * Updates the hashed bounds coordinates
     */
    update(): void;
}
/**
 * This collision processor uses a sparsely populated grid of uniform cells to bucket potential
 * colliders together for the purpose of detecting collision pairs and collisions.
 */
declare class SparseHashGridCollisionProcessor implements CollisionProcessor {
    readonly gridSize: number;
    readonly hashGrid: SparseHashGrid<Collider, HashColliderProxy>;
    private _pairs;
    private _nonPairs;
    _pairPool: Pool<Pair>;
    constructor(options: {
        size: number;
    });
    getColliders(): readonly Collider[];
    query(point: Vector): Collider[];
    query(bound: BoundingBox): Collider[];
    rayCast(ray: Ray, options?: RayCastOptions): RayCastHit[];
    /**
     * Adds the collider to the internal data structure for collision tracking
     * @param target
     */
    track(target: Collider): void;
    /**
     * Removes a collider from the internal data structure for tracking collisions
     * @param target
     */
    untrack(target: Collider): void;
    private _canCollide;
    /**
     * Runs the broadphase sweep over tracked colliders and returns possible collision pairs
     * @param targets
     * @param elapsed
     */
    broadphase(targets: Collider[], elapsed: number): Pair[];
    /**
     * Runs a fine grain pass on collision pairs and does geometry intersection tests producing any contacts
     * @param pairs
     * @param stats
     */
    narrowphase(pairs: Pair[], stats?: FrameStats): CollisionContact[];
    /**
     * Perform data structure maintenance, returns number of colliders updated
     */
    update(targets: Collider[], elapsed: number): number;
    /**
     * Draws the internal data structure
     * @param ex
     * @param elapsed
     */
    debug(ex: ExcaliburGraphicsContext, elapsed: number): void;
}

/**
 * Represents an audio control implementation
 */
interface Audio {
    /**
     * Whether the audio should loop (repeat forever)
     */
    loop: boolean;
    /**
     * The volume (between 0 and 1)
     */
    volume: number;
    /**
     * Set the playbackRate, default is 1.0 at normal speed.
     * For example 2.0 is double speed, and 0.5 is half speed.
     */
    playbackRate: number;
    /**
     * Whether or not any audio is playing
     */
    isPlaying(): boolean;
    /**
     * Returns if the audio is paused
     */
    isPaused(): boolean;
    /**
     * Returns if the audio is stopped
     */
    isStopped(): boolean;
    /**
     * Will play the sound or resume if paused
     */
    play(): Promise<any>;
    /**
     * Seek to a position (in seconds) in the audio
     * @param position
     */
    seek(position: number): void;
    /**
     * Return the duration of the sound
     */
    getTotalPlaybackDuration(): number;
    /**
     * Return the current playback time of the playing track in seconds from the start
     */
    getPlaybackPosition(): number;
    /**
     * Pause the sound
     */
    pause(): void;
    /**
     * Stop playing the sound and reset
     */
    stop(): void;
}

type ExResponseType = '' | 'arraybuffer' | 'blob' | 'document' | 'json' | 'text';
interface ExResponseTypesLookup {
    [name: string]: ExResponseType;
}
declare class ExResponse {
    static type: ExResponseTypesLookup;
}
/**
 * Represents an audio implementation like {@apilink WebAudioInstance}
 */
interface AudioImplementation {
    /**
     * XHR response type
     */
    responseType: ExResponseType;
    /**
     * Processes raw data and transforms into sound data
     */
    processData(data: Blob | ArrayBuffer): Promise<string | AudioBuffer>;
    /**
     * Factory method that returns an instance of a played audio track
     */
    createInstance(data: string | AudioBuffer): Audio;
}

/**
 * An interface describing loadable resources in Excalibur. Built-in loadable
 * resources include {@apilink Texture}, {@apilink Sound}, and a generic {@apilink Resource}.
 */
interface Loadable<T> {
    /**
     * Data associated with a loadable
     */
    data: T;
    /**
     * Begins loading the resource and returns a promise to be resolved on completion
     */
    load(): Promise<T>;
    /**
     * Returns true if the loadable is loaded
     */
    isLoaded(): boolean;
}

/**
 * Describes the different image filtering modes
 */
declare enum ImageFiltering {
    /**
     * Pixel is useful when you do not want smoothing aka antialiasing applied to your graphics.
     *
     * Useful for Pixel art aesthetics.
     */
    Pixel = "Pixel",
    /**
     * Blended is useful when you have high resolution artwork and would like it blended and smoothed
     */
    Blended = "Blended"
}
/**
 * Parse the image filtering attribute value, if it doesn't match returns null
 */
declare function parseImageFiltering(val: string): ImageFiltering | undefined;

/**
 * Describes the different image wrapping modes
 */
declare enum ImageWrapping {
    Clamp = "Clamp",
    Repeat = "Repeat",
    Mirror = "Mirror"
}
/**
 *
 */
declare function parseImageWrapping(val: string): ImageWrapping;

interface ImageSourceOptions {
    filtering?: ImageFiltering;
    wrapping?: ImageWrapConfiguration | ImageWrapping;
    bustCache?: boolean;
}
interface ImageWrapConfiguration {
    x: ImageWrapping;
    y: ImageWrapping;
}
declare const ImageSourceAttributeConstants: {
    readonly Filtering: "filtering";
    readonly WrappingX: "wrapping-x";
    readonly WrappingY: "wrapping-y";
};
declare class ImageSource implements Loadable<HTMLImageElement> {
    private _logger;
    private _resource;
    filtering?: ImageFiltering;
    wrapping?: ImageWrapConfiguration;
    /**
     * The original size of the source image in pixels
     */
    get width(): number;
    /**
     * The original height of the source image in pixels
     */
    get height(): number;
    private _src?;
    /**
     * Returns true if the Texture is completely loaded and is ready
     * to be drawn.
     */
    isLoaded(): boolean;
    /**
     * Access to the underlying html image element
     */
    data: HTMLImageElement;
    get image(): HTMLImageElement;
    private _readyFuture;
    /**
     * Promise the resolves when the image is loaded and ready for use, does not initiate loading
     */
    ready: Promise<HTMLImageElement>;
    readonly path: string;
    /**
     * The path to the image, can also be a data url like 'data:image/'
     * @param pathOrBase64 {string} Path to the image resource relative from the HTML document hosting the game, or absolute
     * @param options
     */
    constructor(pathOrBase64: string, options?: ImageSourceOptions);
    /**
     * The path to the image, can also be a data url like 'data:image/'
     * @param pathOrBase64 {string} Path to the image resource relative from the HTML document hosting the game, or absolute
     * @param bustCache {boolean} Should excalibur add a cache busting querystring?
     * @param filtering {ImageFiltering} Optionally override the image filtering set by {@apilink EngineOptions.antialiasing}
     */
    constructor(pathOrBase64: string, bustCache: boolean, filtering?: ImageFiltering);
    /**
     * Create an ImageSource from and HTML <image> tag element
     * @param image
     */
    static fromHtmlImageElement(image: HTMLImageElement, options?: ImageSourceOptions): ImageSource;
    static fromHtmlCanvasElement(image: HTMLCanvasElement, options?: ImageSourceOptions): ImageSource;
    static fromSvgString(svgSource: string, options?: ImageSourceOptions): ImageSource;
    /**
     * Should excalibur add a cache busting querystring? By default false.
     * Must be set before loading
     */
    get bustCache(): boolean;
    set bustCache(val: boolean);
    /**
     * Begins loading the image and returns a promise that resolves when the image is loaded
     */
    load(): Promise<HTMLImageElement>;
    /**
     * Build a sprite from this ImageSource
     */
    toSprite(options?: Omit<GraphicOptions & SpriteOptions, 'image'>): Sprite;
    /**
     * Unload images from memory
     */
    unload(): void;
}

type SourceView = {
    x: number;
    y: number;
    width: number;
    height: number;
};
type DestinationSize = {
    width: number;
    height: number;
};
interface SpriteOptions {
    /**
     * Image to create a sprite from
     */
    image: ImageSource;
    /**
     * By default the source is the entire dimension of the {@apilink ImageSource}
     */
    sourceView?: {
        x: number;
        y: number;
        width: number;
        height: number;
    };
    /**
     * By default the size of the final sprite is the size of the {@apilink ImageSource}
     */
    destSize?: {
        width: number;
        height: number;
    };
}
declare class Sprite extends Graphic {
    private _logger;
    image: ImageSource;
    sourceView: SourceView;
    destSize: DestinationSize;
    private _dirty;
    static from(image: ImageSource, options?: Omit<GraphicOptions & SpriteOptions, 'image'>): Sprite;
    constructor(options: GraphicOptions & SpriteOptions);
    get width(): number;
    get height(): number;
    set width(newWidth: number);
    set height(newHeight: number);
    private _updateSpriteDimensions;
    protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    clone(): Sprite;
}

interface TiledSpriteOptions {
    image: ImageSource;
    /**
     * Source view into the {@link ImageSource image}
     */
    sourceView?: SourceView;
    /**
     * Optionally override {@link ImageFiltering filtering}
     */
    filtering?: ImageFiltering;
    /**
     * Optionally override {@link ImageWrapping wrapping} , default wrapping is Repeat for TiledSprite
     */
    wrapping?: ImageWrapConfiguration | ImageWrapping;
    /**
     * Total width in pixels for the tiling to take place over
     */
    width: number;
    /**
     * Total height in pixels for the tiling to take place over
     */
    height: number;
}
declare class TiledSprite extends Sprite {
    private _ready;
    ready: Promise<void>;
    private _options;
    constructor(options: TiledSpriteOptions & GraphicOptions);
    static fromSprite(sprite: Sprite, options?: Partial<Omit<TiledSpriteOptions & GraphicOptions, 'image'>>): TiledSprite;
    private _applyTiling;
}

/**
 * Specify sprite sheet spacing options, useful if your sprites are not tightly packed
 * and have space between them.
 */
interface SpriteSheetSpacingDimensions {
    /**
     * The starting point to offset and start slicing the sprite sheet from the top left of the image.
     * Default is (0, 0)
     */
    originOffset?: {
        x?: number;
        y?: number;
    } | Vector;
    /**
     * The margin between sprites.
     * Default is (0, 0)
     */
    margin?: {
        x?: number;
        y?: number;
    } | Vector;
}
/**
 * Sprite sheet options for slicing up images
 */
interface SpriteSheetGridOptions {
    /**
     * Source image to use for each sprite
     */
    image: ImageSource;
    /**
     * Grid definition for the sprite sheet
     */
    grid: {
        /**
         * Number of rows in the sprite sheet
         */
        rows: number;
        /**
         * Number of columns in the sprite sheet
         */
        columns: number;
        /**
         * Width of each individual sprite
         */
        spriteWidth: number;
        /**
         * Height of each individual sprite
         */
        spriteHeight: number;
    };
    /**
     * Optionally specify any spacing information between sprites
     */
    spacing?: SpriteSheetSpacingDimensions;
}
interface SpriteSheetSparseOptions {
    /**
     * Source image to use for each sprite
     */
    image: ImageSource;
    /**
     * List of source view rectangles to create a sprite sheet from
     */
    sourceViews: SourceView[];
}
interface SpriteSheetOptions {
    /**
     * Source sprites for the sprite sheet
     */
    sprites: Sprite[];
    /**
     * Optionally specify the number of rows in a sprite sheet (default 1 row)
     */
    rows?: number;
    /**
     * Optionally specify the number of columns in a sprite sheet (default sprites.length)
     */
    columns?: number;
}
interface GetSpriteOptions extends GraphicOptions {
}
/**
 * Represents a collection of sprites from a source image with some organization in a grid
 */
declare class SpriteSheet {
    readonly sprites: Sprite[];
    readonly rows: number;
    readonly columns: number;
    /**
     * Build a new sprite sheet from a list of sprites
     *
     * Use {@apilink SpriteSheet.fromImageSource} to create a SpriteSheet from an {@apilink ImageSource} organized in a grid
     * @param options
     */
    constructor(options: SpriteSheetOptions);
    /**
     * Find a sprite by their x/y integer coordinates in the SpriteSheet, for example \`getSprite(0, 0)\` is the {@apilink Sprite} in the top-left
     * and \`getSprite(1, 0)\` is the sprite one to the right.
     * @param x
     * @param y
     */
    getSprite(x: number, y: number, options?: GetSpriteOptions): Sprite;
    /**
     * Find a sprite by their x/y integer coordinates in the SpriteSheet and configures tiling to repeat by default,
     * for example \`getTiledSprite(0, 0)\` is the {@apilink TiledSprite} in the top-left
     * and \`getTiledSprite(1, 0)\` is the sprite one to the right.
     *
     * Example:
     *
     * \`\`\`typescript
     * spriteSheet.getTiledSprite(1, 0, {
     * width: game.screen.width,
     * height: 200,
     * wrapping: {
     * x: ex.ImageWrapping.Repeat,
     * y: ex.ImageWrapping.Clamp
     * }
     * });
     * \`\`\`
     * @param x
     * @param y
     * @param options
     */
    getTiledSprite(x: number, y: number, options?: Partial<Omit<TiledSpriteOptions & GraphicOptions, 'image'>>): TiledSprite;
    /**
     * Create a sprite sheet from a sparse set of {@apilink SourceView} rectangles
     * @param options
     */
    static fromImageSourceWithSourceViews(options: SpriteSheetSparseOptions): SpriteSheet;
    /**
     * Create a SpriteSheet from an {@apilink ImageSource} organized in a grid
     *
     * Example:
     * \`\`\`
     * const spriteSheet = SpriteSheet.fromImageSource({
     *   image: imageSource,
     *   grid: {
     *     rows: 5,
     *     columns: 2,
     *     spriteWidth: 32, // pixels
     *     spriteHeight: 32 // pixels
     *   },
     *   // Optionally specify spacing
     *   spacing: {
     *     // pixels from the top left to start the sprite parsing
     *     originOffset: {
     *       x: 5,
     *       y: 5
     *     },
     *     // pixels between each sprite while parsing
     *     margin: {
     *       x: 1,
     *       y: 1
     *     }
     *   }
     * })
     * \`\`\`
     * @param options
     */
    static fromImageSource(options: SpriteSheetGridOptions): SpriteSheet;
    clone(): SpriteSheet;
}

interface HasTick {
    /**
     *
     * @param elapsed The amount of real world time in milliseconds that has elapsed that must be updated in the animation
     * @param idempotencyToken Optional idempotencyToken prevents a ticking animation from updating twice per frame
     */
    tick(elapsed: number, idempotencyToken?: number): void;
}
declare enum AnimationDirection {
    /**
     * Animation is playing forwards
     */
    Forward = "forward",
    /**
     * Animation is playing backwards
     */
    Backward = "backward"
}
declare enum AnimationStrategy {
    /**
     * Animation ends without displaying anything
     */
    End = "end",
    /**
     * Animation loops to the first frame after the last frame
     */
    Loop = "loop",
    /**
     * Animation plays to the last frame, then backwards to the first frame, then repeats
     */
    PingPong = "pingpong",
    /**
     * Animation ends stopping on the last frame
     */
    Freeze = "freeze"
}
/**
 * Frame of animation
 */
interface Frame {
    /**
     * Optionally specify a graphic to show, no graphic shows an empty frame
     */
    graphic?: Graphic;
    /**
     * Optionally specify the number of ms the frame should be visible, overrides the animation duration (default 100 ms)
     */
    duration?: number;
}
interface FrameEvent extends Frame {
    frameIndex: number;
}
/**
 * Animation options for building an animation via constructor.
 */
interface AnimationOptions {
    /**
     * List of frames in the order you wish to play them
     */
    frames: Frame[];
    /**
     * Optionally set a positive speed multiplier on the animation.
     *
     * By default 1, meaning 1x speed. If set to 2, it will play the animation twice as fast.
     */
    speed?: number;
    /**
     * Optionally reverse the direction of play
     */
    reverse?: boolean;
    /**
     * Optionally specify a default frame duration in ms (Default is 100)
     */
    frameDuration?: number;
    /**
     * Optionally specify a total duration of the animation in ms to calculate each frame's duration
     */
    totalDuration?: number;
    /**
     * Optionally specify the {@apilink AnimationStrategy} for the Animation
     */
    strategy?: AnimationStrategy;
    /**
     * Optionally set arbitrary meta data for the animation
     */
    data?: Record<string, any>;
}
type AnimationEvents = {
    frame: FrameEvent;
    loop: Animation;
    end: Animation;
};
declare const AnimationEvents: {
    Frame: string;
    Loop: string;
    End: string;
};
interface FromSpriteSheetOptions {
    /**
     * {@apilink SpriteSheet} to source the animation frames from
     */
    spriteSheet: SpriteSheet;
    /**
     * The list of (x, y) positions of sprites in the {@apilink SpriteSheet} of each frame, for example (0, 0)
     * is the the top left sprite, (0, 1) is the sprite directly below that, and so on.
     *
     * You may optionally specify a duration for the frame in milliseconds as well, this will override
     * the default duration.
     */
    frameCoordinates: {
        x: number;
        y: number;
        duration?: number;
        options?: GetSpriteOptions;
    }[];
    /**
     * Optionally specify a default duration for frames in milliseconds
     * @deprecated use \`durationPerFrame\`
     */
    durationPerFrameMs?: number;
    /**
     * Optionally specify a default duration for frames in milliseconds
     */
    durationPerFrame?: number;
    /**
     * Optionally set a positive speed multiplier on the animation.
     *
     * By default 1, meaning 1x speed. If set to 2, it will play the animation twice as fast.
     */
    speed?: number;
    /**
     * Optionally specify the animation strategy for this animation, by default animations loop {@apilink AnimationStrategy.Loop}
     */
    strategy?: AnimationStrategy;
    /**
     * Optionally specify the animation should be reversed
     */
    reverse?: boolean;
    /**
     * Optionally set arbitrary meta data for the animation
     */
    data?: Record<string, any>;
}
/**
 * Create an Animation given a list of {@apilink Frame | \`frames\`} in {@apilink AnimationOptions}
 *
 * To create an Animation from a {@apilink SpriteSheet}, use {@apilink Animation.fromSpriteSheet}
 */
declare class Animation extends Graphic implements HasTick {
    private static _LOGGER;
    events: EventEmitter<AnimationEvents>;
    frames: Frame[];
    strategy: AnimationStrategy;
    frameDuration: number;
    data: Map<string, any>;
    private _idempotencyToken;
    private _firstTick;
    private _currentFrame;
    private _timeLeftInFrame;
    private _pingPongDirection;
    private _done;
    private _playing;
    private _speed;
    private _wasResetDuringFrameCalc;
    constructor(options: GraphicOptions & AnimationOptions);
    clone<T extends typeof Animation>(): InstanceType<T>;
    get width(): number;
    get height(): number;
    /**
     * Create an Animation from a {@apilink SpriteSheet}, a list of indices into the sprite sheet, a duration per frame
     * and optional {@apilink AnimationStrategy}
     *
     * Example:
     * \`\`\`typescript
     * const spriteSheet = SpriteSheet.fromImageSource({...});
     *
     * const anim = Animation.fromSpriteSheet(spriteSheet, range(0, 5), 200, AnimationStrategy.Loop);
     * \`\`\`
     * @param spriteSheet ex.SpriteSheet
     * @param spriteSheetIndex 0 based index from left to right, top down (row major order) of the ex.SpriteSheet
     * @param durationPerFrame duration per frame in milliseconds
     * @param strategy Optional strategy, default AnimationStrategy.Loop
     */
    static fromSpriteSheet<T extends typeof Animation>(this: T, spriteSheet: SpriteSheet, spriteSheetIndex: number[], durationPerFrame: number, strategy?: AnimationStrategy, data?: Record<string, any>): InstanceType<T>;
    /**
     * Create an {@apilink Animation} from a {@apilink SpriteSheet} given a list of coordinates
     *
     * Example:
     * \`\`\`typescript
     * const spriteSheet = SpriteSheet.fromImageSource({...});
     *
     * const anim = Animation.fromSpriteSheetCoordinates({
     *  spriteSheet,
     *  frameCoordinates: [
     *    {x: 0, y: 5, duration: 100, options { flipHorizontal: true }},
     *    {x: 1, y: 5, duration: 200},
     *    {x: 2, y: 5},
     *    {x: 3, y: 5}
     *  ],
     *  strategy: AnimationStrategy.PingPong
     * });
     * \`\`\`
     * @param options
     * @returns Animation
     */
    static fromSpriteSheetCoordinates<T extends typeof Animation>(this: T, options: FromSpriteSheetOptions): InstanceType<T>;
    /**
     * Current animation speed
     *
     * 1 meaning normal 1x speed.
     * 2 meaning 2x speed and so on.
     */
    get speed(): number;
    /**
     * Current animation speed
     *
     * 1 meaning normal 1x speed.
     * 2 meaning 2x speed and so on.
     */
    set speed(val: number);
    /**
     * Returns the current Frame of the animation
     *
     * Use {@apilink Animation.currentFrameIndex} to get the frame number and
     * {@apilink Animation.goToFrame} to set the current frame index
     */
    get currentFrame(): Frame | null;
    /**
     * Returns the current frame index of the animation
     *
     * Use {@apilink Animation.currentFrame} to grab the current {@apilink Frame} object
     */
    get currentFrameIndex(): number;
    /**
     * Returns the amount of time in milliseconds left in the current frame
     */
    get currentFrameTimeLeft(): number;
    /**
     * Returns \`true\` if the animation is playing
     */
    get isPlaying(): boolean;
    private _reversed;
    get isReversed(): boolean;
    /**
     * Reverses the play direction of the Animation, this preserves the current frame
     */
    reverse(): void;
    /**
     * Returns the current play direction of the animation
     */
    get direction(): AnimationDirection;
    /**
     * Plays or resumes the animation from the current frame
     */
    play(): void;
    /**
     * Pauses the animation on the current frame
     */
    pause(): void;
    /**
     * Reset the animation back to the beginning, including if the animation were done
     */
    reset(): void;
    /**
     * Returns \`true\` if the animation can end
     */
    get canFinish(): boolean;
    /**
     * Returns \`true\` if the animation is done, for looping type animations
     * \`ex.AnimationStrategy.PingPong\` and \`ex.AnimationStrategy.Loop\` this will always return \`false\`
     *
     * See the \`ex.Animation.canFinish()\` method to know if an animation type can end
     */
    get done(): boolean;
    /**
     * Jump the animation immediately to a specific frame if it exists
     *
     * Optionally specify an override for the duration of the frame, useful for
     * keeping multiple animations in sync with one another.
     * @param frameNumber
     * @param duration
     */
    goToFrame(frameNumber: number, duration?: number): void;
    private _nextFrame;
    /**
     * Called internally by Excalibur to update the state of the animation potential update the current frame
     * @param elapsed Milliseconds elapsed
     * @param idempotencyToken Prevents double ticking in a frame by passing a unique token to the frame
     */
    tick(elapsed: number, idempotencyToken?: number): void;
    protected _drawImage(ctx: ExcaliburGraphicsContext, x: number, y: number): void;
}

interface GraphicsGroupingOptions {
    members: (GraphicsGrouping | Graphic)[];
    /**
     * Default true, GraphicsGroup will use the anchor to position all the graphics based on their combined bounds
     *
     * Setting to false will ignore anchoring from parent components and position the top left of all graphics at the actor's position,
     * positioning graphics in the group is done with the \`offset\` property.
     */
    useAnchor?: boolean;
}
interface GraphicsGrouping {
    offset: Vector;
    graphic: Graphic;
    /**
     * Optionally disable this graphics bounds as part of group calculation, default true
     * if unspecified
     *
     * You may want disable this if you're using text because their bounds will affect
     * the centering of the whole group.
     *
     * **WARNING** having inaccurate bounds can cause offscreen culling issues.
     */
    useBounds?: boolean;
}
declare class GraphicsGroup extends Graphic implements HasTick {
    private _logger;
    useAnchor: boolean;
    members: (GraphicsGrouping | Graphic)[];
    constructor(options: GraphicsGroupingOptions & GraphicOptions);
    clone(): GraphicsGroup;
    private _updateDimensions;
    get localBounds(): BoundingBox;
    private _isAnimationOrGroup;
    tick(elapsed: number, idempotencyToken?: number): void;
    reset(): void;
    protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void;
}

interface LineOptions {
    start: Vector;
    end: Vector;
    color?: Color;
    thickness?: number;
}
declare class Line extends Graphic {
    readonly start: Vector;
    readonly end: Vector;
    color: Color;
    thickness: number;
    private _localBounds;
    constructor(options: LineOptions);
    get localBounds(): BoundingBox;
    private _calculateBounds;
    protected _drawImage(ctx: ExcaliburGraphicsContext, _x: number, _y: number): void;
    clone(): Line;
}

/**
 * Provide arbitrary drawing for the purposes of debugging your game
 *
 * Will only show when the Engine is set to debug mode {@apilink Engine.showDebug} or {@apilink Engine.toggleDebug}
 *
 */
declare class DebugGraphicsComponent extends Component {
    draw: (ctx: ExcaliburGraphicsContext, debugFlags: DebugConfig) => void;
    useTransform: boolean;
    constructor(draw: (ctx: ExcaliburGraphicsContext, debugFlags: DebugConfig) => void, useTransform?: boolean);
}

declare class GraphicsSystem extends System {
    world: World;
    static priority: 0;
    readonly systemType = SystemType.Draw;
    private _token;
    private _graphicsContext;
    private _camera;
    private _engine;
    private _sortedTransforms;
    query: Query<typeof TransformComponent | typeof GraphicsComponent>;
    get sortedTransforms(): TransformComponent[];
    constructor(world: World);
    initialize(world: World, scene: Scene): void;
    private _zHasChanged;
    private _zIndexUpdate;
    preupdate(): void;
    update(elapsed: number): void;
    private _drawGraphicsComponent;
    private _targetInterpolationTransform;
    /**
     * This applies the current entity transform to the graphics context
     * @param entity
     */
    private _applyTransform;
    private _applyOpacity;
}

declare class OffscreenSystem extends System {
    world: World;
    static priority: number;
    systemType: SystemType;
    private _camera;
    private _screen;
    private _worldBounds;
    query: Query<typeof TransformComponent | typeof GraphicsComponent>;
    constructor(world: World);
    initialize(world: World, scene: Scene): void;
    update(): void;
    private _isOffscreen;
}

declare class ParallaxComponent extends Component {
    parallaxFactor: Vector;
    constructor(parallaxFactor?: Vector);
}

interface RasterOptions extends GraphicOptions {
    /**
     * Optionally specify a quality number, which is how much to scale the internal Raster. Default is 1.
     *
     * For example if the quality is set to 2, it doubles the internal raster bitmap in memory.
     *
     * Adjusting this value can be useful if you are working with small rasters.
     */
    quality?: number;
    /**
     * Optionally specify "smoothing" if you want antialiasing to apply to the raster's bitmap context, by default \`false\`
     */
    smoothing?: boolean;
    /**
     * Optionally specify the color of the raster's bitmap context, by default {@apilink Color.Black}
     */
    color?: Color;
    /**
     * Optionally specify the stroke color of the raster's bitmap context, by default undefined
     */
    strokeColor?: Color;
    /**
     * Optionally specify the line width of the raster's bitmap, by default 1 pixel
     */
    lineWidth?: number;
    /**
     * Optionally specify the line dash of the raster's bitmap, by default \`[]\` which means none
     */
    lineDash?: number[];
    /**
     * Optionally specify the line end style, default is "butt".
     */
    lineCap?: 'butt' | 'round' | 'square';
    /**
     * Optionally specify the padding to apply to the bitmap
     */
    padding?: number;
    /**
     * Optionally specify what image filtering mode should be used, {@apilink ImageFiltering.Pixel} for pixel art,
     * {@apilink ImageFiltering.Blended} for hi-res art
     *
     * By default unset, rasters defer to the engine antialiasing setting
     */
    filtering?: ImageFiltering;
}
/**
 * A Raster is a Graphic that needs to be first painted to a HTMLCanvasElement before it can be drawn to the
 * {@apilink ExcaliburGraphicsContext}. This is useful for generating custom images using the 2D canvas api.
 *
 * Implementors must implement the {@apilink Raster.execute} method to rasterize their drawing.
 */
declare abstract class Raster extends Graphic {
    filtering?: ImageFiltering;
    lineCap: 'butt' | 'round' | 'square';
    quality: number;
    _bitmap: HTMLCanvasElement;
    protected _ctx: CanvasRenderingContext2D;
    private _dirty;
    constructor(options?: RasterOptions);
    cloneRasterOptions(): RasterOptions;
    /**
     * Gets whether the graphic is dirty, this means there are changes that haven't been re-rasterized
     */
    get dirty(): boolean;
    /**
     * Flags the graphic as dirty, meaning it must be re-rasterized before draw.
     * This should be called any time the graphics state changes such that it affects the outputted drawing
     */
    flagDirty(): void;
    private _originalWidth?;
    /**
     * Gets or sets the current width of the Raster graphic. Setting the width will cause the raster
     * to be flagged dirty causing a re-raster on the next draw.
     *
     * Any \`padding\`s or \`quality\` set will be factored into the width
     */
    get width(): number;
    set width(value: number);
    private _originalHeight?;
    /**
     * Gets or sets the current height of the Raster graphic. Setting the height will cause the raster
     * to be flagged dirty causing a re-raster on the next draw.
     *
     * Any \`padding\` or \`quality\` set will be factored into the height
     */
    get height(): number;
    set height(value: number);
    private _getTotalWidth;
    private _getTotalHeight;
    /**
     * Returns the local bounds of the Raster including the padding
     */
    get localBounds(): BoundingBox;
    private _smoothing;
    /**
     * Gets or sets the smoothing (anti-aliasing of the graphic). Setting the height will cause the raster
     * to be flagged dirty causing a re-raster on the next draw.
     */
    get smoothing(): boolean;
    set smoothing(value: boolean);
    private _color;
    /**
     * Gets or sets the fillStyle of the Raster graphic. Setting the fillStyle will cause the raster to be
     * flagged dirty causing a re-raster on the next draw.
     */
    get color(): Color;
    set color(value: Color);
    private _strokeColor;
    /**
     * Gets or sets the strokeStyle of the Raster graphic. Setting the strokeStyle will cause the raster to be
     * flagged dirty causing a re-raster on the next draw.
     */
    get strokeColor(): Color | undefined;
    set strokeColor(value: Color | undefined);
    private _lineWidth;
    /**
     * Gets or sets the line width of the Raster graphic. Setting the lineWidth will cause the raster to be
     * flagged dirty causing a re-raster on the next draw.
     */
    get lineWidth(): number;
    set lineWidth(value: number);
    private _lineDash;
    get lineDash(): number[];
    set lineDash(value: number[]);
    private _padding;
    get padding(): number;
    set padding(value: number);
    /**
     * Rasterize the graphic to a bitmap making it usable as in excalibur. Rasterize is called automatically if
     * the graphic is {@apilink Raster.dirty} on the next {@apilink Graphic.draw} call
     */
    rasterize(): void;
    protected _applyRasterProperties(ctx: CanvasRenderingContext2D): void;
    protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    /**
     * Executes drawing implementation of the graphic, this is where the specific drawing code for the graphic
     * should be implemented. Once \`rasterize()\` the graphic can be drawn to the {@apilink ExcaliburGraphicsContext} via \`draw(...)\`
     * @param ctx Canvas to draw the graphic to
     */
    abstract execute(ctx: CanvasRenderingContext2D): void;
}

interface CircleOptions {
    radius: number;
}
/**
 * A circle {@apilink Graphic} for drawing circles to the {@apilink ExcaliburGraphicsContext}
 *
 * Circles default to {@apilink ImageFiltering.Blended}
 */
declare class Circle extends Raster {
    private _radius;
    get radius(): number;
    set radius(value: number);
    constructor(options: RasterOptions & CircleOptions);
    clone(): Circle;
    execute(ctx: CanvasRenderingContext2D): void;
}

interface RectangleOptions {
    width: number;
    height: number;
}
/**
 * A Rectangle {@apilink Graphic} for drawing rectangles to the {@apilink ExcaliburGraphicsContext}
 */
declare class Rectangle extends Raster {
    constructor(options: RasterOptions & RectangleOptions);
    clone(): Rectangle;
    execute(ctx: CanvasRenderingContext2D): void;
}

interface PolygonOptions {
    points: Vector[];
}
/**
 * A polygon {@apilink Graphic} for drawing arbitrary polygons to the {@apilink ExcaliburGraphicsContext}
 *
 * Polygons default to {@apilink ImageFiltering.Blended}
 */
declare class Polygon extends Raster {
    private _points;
    get points(): Vector[];
    set points(points: Vector[]);
    get minPoint(): Vector;
    constructor(options: RasterOptions & PolygonOptions);
    clone(): Polygon;
    execute(ctx: CanvasRenderingContext2D): void;
}

/**
 * Enum representing the different font size units
 * https://developer.mozilla.org/en-US/docs/Web/CSS/font-size
 */
declare enum FontUnit {
    /**
     * Em is a scalable unit, 1 em is equal to the current font size of the current element, parent elements can effect em values
     */
    Em = "em",
    /**
     * Rem is similar to the Em, it is a scalable unit. 1 rem is equal to the font size of the root element
     */
    Rem = "rem",
    /**
     * Pixel is a unit of length in screen pixels
     */
    Px = "px",
    /**
     * Point is a physical unit length (1/72 of an inch)
     */
    Pt = "pt",
    /**
     * Percent is a scalable unit similar to Em, the only difference is the Em units scale faster when Text-Size stuff
     */
    Percent = "%"
}
/**
 * Enum representing the different horizontal text alignments
 */
declare enum TextAlign {
    /**
     * The text is left-aligned.
     */
    Left = "left",
    /**
     * The text is right-aligned.
     */
    Right = "right",
    /**
     * The text is centered.
     */
    Center = "center",
    /**
     * The text is aligned at the normal start of the line (left-aligned for left-to-right locales,
     * right-aligned for right-to-left locales).
     */
    Start = "start",
    /**
     * The text is aligned at the normal end of the line (right-aligned for left-to-right locales,
     * left-aligned for right-to-left locales).
     */
    End = "end"
}
/**
 * Enum representing the different baseline text alignments
 */
declare enum BaseAlign {
    /**
     * The text baseline is the top of the em square.
     */
    Top = "top",
    /**
     * The text baseline is the hanging baseline.  Currently unsupported; this will act like
     * alphabetic.
     */
    Hanging = "hanging",
    /**
     * The text baseline is the middle of the em square.
     */
    Middle = "middle",
    /**
     * The text baseline is the normal alphabetic baseline.
     */
    Alphabetic = "alphabetic",
    /**
     * The text baseline is the ideographic baseline; this is the bottom of
     * the body of the characters, if the main body of characters protrudes
     * beneath the alphabetic baseline.  Currently unsupported; this will
     * act like alphabetic.
     */
    Ideographic = "ideographic",
    /**
     * The text baseline is the bottom of the bounding box.  This differs
     * from the ideographic baseline in that the ideographic baseline
     * doesn't consider descenders.
     */
    Bottom = "bottom"
}
/**
 * Enum representing the different possible font styles
 */
declare enum FontStyle {
    Normal = "normal",
    Italic = "italic",
    Oblique = "oblique"
}
/**
 * Enum representing the text direction, useful for other languages, or writing text in reverse
 */
declare enum Direction {
    LeftToRight = "ltr",
    RightToLeft = "rtl"
}
/**
 * Font rendering option
 */
interface FontOptions {
    /**
     * Optionally the size of the font in the specified {@apilink FontUnit} by default 10.
     */
    size?: number;
    /**
     * Optionally specify unit to measure fonts in, by default Pixels
     */
    unit?: FontUnit;
    /**
     * Optionally specify the font family, by default 'sans-serif'
     */
    family?: string;
    /**
     * Optionally specify the font style, by default Normal
     */
    style?: FontStyle;
    /**
     * Optionally set whether the font is bold, by default false
     */
    bold?: boolean;
    /**
     * Optionally specify the text align, by default Left
     */
    textAlign?: TextAlign;
    /**
     * Optionally specify the text base align, by default Alphabetic
     */
    baseAlign?: BaseAlign;
    /**
     * Optionally specify the text direction, by default LeftToRight
     */
    direction?: Direction;
    /**
     * Optionally override the text line height in pixels, useful for multiline text. If unset will use default.
     */
    lineHeight?: number | undefined;
    /**
     * Optionally specify the quality of the text bitmap, it is a multiplier on the size size, by default 2.
     * Higher quality text has a higher memory impact
     */
    quality?: number;
    /**
     * Optionally specify a text shadow, by default none is specified
     */
    shadow?: {
        blur?: number;
        offset?: Vector;
        color?: Color;
    };
}
/**
 * @internal
 */
interface FontRenderer {
    measureText(text: string): BoundingBox;
    render(ex: ExcaliburGraphicsContext, text: string, color: Color, x: number, y: number): void;
}

interface SpriteFontOptions {
    /**
     * Alphabet string in spritesheet order (default is row column order)
     * example: 'abcdefghijklmnopqrstuvwxyz'
     */
    alphabet: string;
    /**
     * {@apilink SpriteSheet} to source character sprites from
     */
    spriteSheet: SpriteSheet;
    /**
     * Optionally ignore case in the supplied text;
     */
    caseInsensitive?: boolean;
    /**
     * Optionally override the text line height, useful for multiline text. If unset will use default.
     */
    lineHeight?: number | undefined;
    /**
     * Optionally adjust the spacing between character sprites
     */
    spacing?: number;
    /**
     * Optionally specify a "shadow"
     */
    shadow?: {
        offset: Vector;
    };
}
declare class SpriteFont extends Graphic implements FontRenderer {
    private _text;
    alphabet: string;
    spriteSheet: SpriteSheet;
    shadow?: {
        offset: Vector;
    };
    caseInsensitive: boolean;
    spacing: number;
    lineHeight: number | undefined;
    private _logger;
    constructor(options: SpriteFontOptions & GraphicOptions);
    private _getCharacterSprites;
    measureText(text: string, maxWidth?: number): BoundingBox;
    protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number, maxWidth?: number): void;
    render(ex: ExcaliburGraphicsContext, text: string, _color: any, x: number, y: number, maxWidth?: number): void;
    clone(): SpriteFont;
    /**
     * Return array of lines split based on the \\n character, and the maxWidth? constraint
     * @param text
     * @param maxWidth
     */
    private _cachedText?;
    private _cachedLines?;
    private _cachedRenderWidth?;
    private _getLinesFromText;
}

/**
 * Represents a system or web font in Excalibur
 *
 * If no options specified, the system sans-serif 10 pixel is used
 *
 * If loading a custom web font be sure to have the font loaded before you use it https://erikonarheim.com/posts/dont-test-fonts/
 */
declare class Font extends Graphic implements FontRenderer {
    /**
     * Set the font filtering mode, by default set to {@apilink ImageFiltering.Blended} regardless of the engine default smoothing
     *
     * If you have a pixel style font that may be a reason to switch this to {@apilink ImageFiltering.Pixel}
     */
    filtering: ImageFiltering;
    constructor(options?: FontOptions & GraphicOptions & RasterOptions);
    clone(): Font;
    /**
     * Font quality determines the size of the underlying raster text, higher quality means less jagged edges.
     * If quality is set to 1, then just enough raster bitmap is generated to render the text.
     *
     * You can think of quality as how zoomed in to the text you can get before seeing jagged edges.
     *
     * (Default 2)
     */
    quality: number;
    padding: number;
    smoothing: boolean;
    lineWidth: number;
    lineDash: number[];
    color: Color;
    strokeColor?: Color;
    family: string;
    style: FontStyle;
    bold: boolean;
    unit: FontUnit;
    textAlign: TextAlign;
    baseAlign: BaseAlign;
    direction: Direction;
    /**
     * Font line height in pixels, default line height if unset
     */
    lineHeight: number | undefined;
    size: number;
    shadow?: {
        blur?: number;
        offset?: Vector;
        color?: Color;
    };
    get fontString(): string;
    private _textBounds;
    get localBounds(): BoundingBox;
    protected _drawImage(_ex: ExcaliburGraphicsContext, _x: number, _y: number): void;
    protected _rotate(ex: ExcaliburGraphicsContext): void;
    protected _flip(ex: ExcaliburGraphicsContext): void;
    private _textMeasurement;
    measureTextWithoutCache(text: string, maxWidth?: number): BoundingBox;
    /**
     * Returns a BoundingBox that is the total size of the text including multiple lines
     *
     * Does not include any padding or adjustment
     * @param text
     * @returns BoundingBox
     */
    measureText(text: string, maxWidth?: number): BoundingBox;
    protected _postDraw(ex: ExcaliburGraphicsContext): void;
    render(ex: ExcaliburGraphicsContext, text: string, colorOverride: Color, x: number, y: number, maxWidth?: number): void;
}

interface TextOptions {
    /**
     * Text to draw
     */
    text: string;
    /**
     * Optionally override the font color, currently unsupported by SpriteFont
     */
    color?: Color;
    /**
     * Optionally specify a font, if none specified a default font is used (System sans-serif 10 pixel)
     */
    font?: Font | SpriteFont;
    /**
     * Optionally specify a maximum width in pixels for our text, and wrap to the next line if needed.
     */
    maxWidth?: number;
}
/**
 * Represent Text graphics in excalibur
 *
 * Useful for in game labels, ui, or overlays
 */
declare class Text extends Graphic {
    color?: Color;
    maxWidth?: number;
    constructor(options: TextOptions & GraphicOptions);
    clone(): Text;
    private _text;
    get text(): string;
    set text(value: string);
    private _font;
    get font(): Font | SpriteFont;
    set font(font: Font | SpriteFont);
    private _textWidth;
    get width(): number;
    private _textHeight;
    get height(): number;
    private _calculateDimension;
    get localBounds(): BoundingBox;
    protected _rotate(_ex: ExcaliburGraphicsContext): void;
    protected _flip(_ex: ExcaliburGraphicsContext): void;
    protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void;
}

declare class FontTextInstance {
    readonly font: Font;
    readonly text: string;
    readonly color: Color;
    readonly maxWidth?: number;
    canvas: HTMLCanvasElement;
    ctx: CanvasRenderingContext2D;
    private _textFragments;
    dimensions: BoundingBox;
    disposed: boolean;
    private _lastHashCode;
    constructor(font: Font, text: string, color: Color, maxWidth?: number);
    measureText(text: string, maxWidth?: number): BoundingBox;
    private _setDimension;
    static getHashCode(font: Font, text: string, color?: Color): string;
    getHashCode(includeColor?: boolean): string;
    protected _applyRasterProperties(ctx: CanvasRenderingContext2D): void;
    private _applyFont;
    private _drawText;
    private _splitTextBitmap;
    flagDirty(): void;
    private _dirty;
    private _ex?;
    render(ex: ExcaliburGraphicsContext, x: number, y: number, maxWidth?: number): void;
    dispose(): void;
    /**
     * Return array of lines split based on the \\n character, and the maxWidth? constraint
     * @param text
     * @param maxWidth
     */
    private _cachedText?;
    private _cachedLines?;
    private _cachedRenderWidth?;
    private _getLinesFromText;
}

declare class FontCache {
    static FONT_TIMEOUT: number;
    private static _LOGGER;
    private static _TEXT_USAGE;
    private static _TEXT_CACHE;
    private static _MEASURE_CACHE;
    static measureText(text: string, font: Font, maxWidth?: number): BoundingBox;
    static getTextInstance(text: string, font: Font, color: Color): FontTextInstance;
    static checkAndClearCache(): void;
    static get cacheSize(): number;
    /**
     * Force clear all cached text bitmaps
     */
    static clearCache(): void;
}

interface CanvasOptions {
    draw?: (ctx: CanvasRenderingContext2D) => void;
    cache?: boolean;
}
/**
 * A canvas {@apilink Graphic} to provide an adapter between the 2D Canvas API and the {@apilink ExcaliburGraphicsContext}.
 *
 * The {@apilink Canvas} works by re-rastering a draw handler to a HTMLCanvasElement for every draw which is then passed
 * to the {@apilink ExcaliburGraphicsContext} implementation as a rendered image.
 *
 * **Low performance API**
 */
declare class Canvas extends Raster {
    private _options;
    /**
     * Return the 2D graphics context of this canvas
     */
    get ctx(): CanvasRenderingContext2D;
    constructor(_options?: GraphicOptions & RasterOptions & CanvasOptions);
    clone(): Canvas;
    execute(ctx: CanvasRenderingContext2D): void;
}

/**
 * Nine slice stretch mode
 */
declare enum NineSliceStretch {
    /**
     * Stretch the image across a dimension
     */
    Stretch = "stretch",
    /**
     * Tile the image across a dimension
     */
    Tile = "tile",
    /**
     * Tile the image across a dimension but only by whole image amounts
     */
    TileFit = "tile-fit"
}
type NineSliceConfig = GraphicOptions & {
    /**
     * Final width of the nine slice graphic
     */
    width: number;
    /**
     * Final height of the nine slice graphic
     */
    height: number;
    /**
     *  Image source that's loaded from a Loader or individually
     *
     */
    source: ImageSource;
    /**
     *  Configuration for the source
     *
     *  Details for the source image, including:
     *
     *  width and height as numbers of the source image
     *
     *  and the 9 slice margins
     */
    sourceConfig: {
        width: number;
        height: number;
        topMargin: number;
        leftMargin: number;
        bottomMargin: number;
        rightMargin: number;
    };
    /**
     *  Configuration for the destination
     *
     *  Details for the destination image, including:
     *
     *  stretching strategies for horizontal and vertical stretching
     *
     *  and flag for drawing the center tile if desired
     */
    destinationConfig: {
        /**
         * Draw the center part of the nine slice, if false it's a completely transparent gap
         */
        drawCenter: boolean;
        /**
         * Horizontal stretch configuration
         */
        horizontalStretch: NineSliceStretch;
        /**
         * Vertical stretch configuration
         */
        verticalStretch: NineSliceStretch;
    };
};
declare class NineSlice extends Graphic {
    private _imgSource;
    private _sourceSprite?;
    private _canvasA;
    private _canvasB;
    private _canvasC;
    private _canvasD;
    private _canvasE;
    private _canvasF;
    private _canvasG;
    private _canvasH;
    private _canvasI;
    private _logger;
    private _config;
    constructor(config: NineSliceConfig);
    /**
     * Sets the target width of the 9 slice (pixels), and recalculates the 9 slice if desired (auto)
     * @param newWidth
     * @param auto
     */
    setTargetWidth(newWidth: number, auto?: boolean): void;
    /**
     * Sets the target height of the 9 slice (pixels), and recalculates the 9 slice if desired (auto)
     * @param newHeight
     * @param auto
     */
    setTargetHeight(newHeight: number, auto?: boolean): void;
    /**
     *  Sets the 9 slice margins (pixels), and recalculates the 9 slice if desired (auto)
     */
    setMargins(left: number, top: number, right: number, bottom: number, auto?: boolean): void;
    /**
     *  Sets the stretching strategy for the 9 slice, and recalculates the 9 slice if desired (auto)
     *
     */
    setStretch(type: 'horizontal' | 'vertical' | 'both', stretch: NineSliceStretch, auto?: boolean): void;
    /**
     *  Returns the config of the 9 slice
     */
    getConfig(): NineSliceConfig;
    /**
     * Draws 1 of the 9 tiles based on parameters passed in
     * context is the ExcaliburGraphicsContext from the _drawImage function
     * destinationSize is the size of the destination image as a vector (width,height)
     * targetCanvas is the canvas to draw to
     * horizontalStretch and verticalStretch are the horizontal and vertical stretching strategies
     * marginW and marginH are optional margins for the 9 slice for positioning
     * @param context
     * @param targetCanvas
     * @param destinationSize
     * @param horizontalStretch
     * @param verticalStretch
     * @param marginWidth
     * @param marginHeight
     */
    protected _drawTile(context: ExcaliburGraphicsContext, targetCanvas: HTMLCanvasElement, destinationSize: Vector, horizontalStretch: NineSliceStretch, verticalStretch: NineSliceStretch, marginWidth?: number, marginHeight?: number): void;
    /**
     *  Draws the 9 slices to the canvas
     */
    protected _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    /**
     * Slices the source sprite into the 9 slice canvases internally
     */
    protected _initialize(): void;
    /**
     * Clones the 9 slice
     */
    clone(): NineSlice;
    /**
     * Returns the number of tiles
     */
    protected _getNumberOfTiles(tileSize: number, destinationSize: number, strategy: NineSliceStretch): number;
    /**
     * Returns the position and size of the tile
     */
    protected _calculateParams(tileNum: number, numTiles: number, tileSize: number, destinationSize: number, strategy: NineSliceStretch): {
        tempPosition: number;
        tempSize: number;
    };
}

interface TiledAnimationOptions {
    /**
     * Animation to tile
     */
    animation: Animation;
    /**
     * Optionally override source view on frame graphics
     */
    sourceView?: Partial<SourceView>;
    /**
     * Optionally override filtering options
     */
    filtering?: ImageFiltering;
    /**
     * Default wrapping is Repeat for TiledAnimation
     */
    wrapping?: ImageWrapConfiguration | ImageWrapping;
    /**
     * Total width in pixels for the tiling to take place
     */
    width: number;
    /**
     * Total height in pixels for the tiling to take place
     */
    height: number;
}
declare class TiledAnimation extends Animation {
    private _ready;
    ready: Promise<void>;
    private _tiledWidth;
    private _tiledHeight;
    private _sourceView;
    constructor(options: GraphicOptions & Omit<AnimationOptions, 'frames'> & TiledAnimationOptions);
    static fromAnimation(animation: Animation, options?: Omit<TiledAnimationOptions, 'animation'>): TiledAnimation;
    private _updateSourceView;
    get sourceView(): Partial<SourceView>;
    set sourceView(sourceView: Partial<SourceView>);
    private _updateWidthHeight;
    get width(): number;
    get height(): number;
    set width(width: number);
    set height(height: number);
}

type UniformDictionary = Record<string, number | boolean | Vector | Color | AffineMatrix | Float32Array | [uniformData: Float32Array, bindingPoint: number]>;
type UniformTypeNames = 'uniform1f' | 'uniform1i' | 'uniform1ui' | 'uniform2f' | 'uniform2i' | 'uniform2ui' | 'uniform3f' | 'uniform3i' | 'uniform3ui' | 'uniform4f' | 'uniform4i' | 'uniform4ui' | 'uniform1fv' | 'uniform1iv' | 'uniform1uiv' | 'uniform2fv' | 'uniform2iv' | 'uniform2uiv' | 'uniform3fv' | 'uniform3iv' | 'uniform3uiv' | 'uniform4fv' | 'uniform4iv' | 'uniform4uiv' | 'uniformMatrix2fv' | 'uniformMatrix2x3fv' | 'uniformMatrix2x4fv' | 'uniformMatrix3fv' | 'uniformMatrix3x2fv' | 'uniformMatrix3x4fv' | 'uniformMatrix4fv' | 'uniformMatrix4x2fv' | 'uniformMatrix4x3fv';
/**
 *
 */
declare function glTypeToUniformTypeName(gl: WebGL2RenderingContext, glType: number): UniformTypeNames;
type RemoveFirstFromTuple<T extends any[]> = T['length'] extends 0 ? [] : ((...b: T) => void) extends (a: any, ...b: infer I) => void ? I : [];
type UniformParameters<TUniformType extends UniformTypeNames> = RemoveFirstFromTuple<Parameters<WebGL2RenderingContext[TUniformType]>>;
interface UniformDefinition {
    name: string;
    glType: number;
    location: WebGLUniformLocation;
}
interface VertexAttributeDefinition {
    /**
     * string name of the attribute in the shader program, commonly \`a_nameofmyvariable\`
     */
    name: string;
    /**
     * Number of components for a given attribute
     * Must be 1, 2, 3, or 4
     *
     * For example a vec4 attribute would be \`4\` floats, so 4
     */
    size: number;
    /**
     * Supported types in webgl 1
     * * gl.BYTE
     * * gl.SHORT
     * * gl.UNSIGNED_BYTE
     * * gl.UNSIGNED_SHORT
     * * gl.FLOAT
     * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer
     */
    glType: number;
    /**
     * Is the attribute normalized between (0-1)
     */
    normalized: boolean;
    /**
     * Location index in the shader program
     */
    location: number;
}
interface ShaderOptions {
    /**
     * ExcaliburGraphicsContextWebGL this layout will be attached to, these cannot be reused across webgl contexts.
     */
    graphicsContext: ExcaliburGraphicsContext;
    /**
     * Optionally provide a name for the shader (useful for debugging purposes)
     */
    name?: string;
    /**
     * Vertex shader source code in glsl #version 300 es
     */
    vertexSource: string;
    /**
     * Fragment shader source code in glsl #version 300 es
     */
    fragmentSource: string;
    /**
     * Set initial uniforms
     */
    uniforms?: UniformDictionary;
    /**
     * Set initial images as uniform sampler2D
     */
    images?: Record<string, ImageSource>;
    /**
     * Optionally set the starting texture slot, default 0
     */
    startingTextureSlot?: number;
    /**
     * Callback to fire directly before linking the program
     */
    onPreLink?: (program: WebGLProgram) => void;
    /**
     * Callback to fire directly after the progam has finished compiling
     */
    onPostCompile?: (shader: Shader) => void;
}
declare class Shader {
    readonly name: string;
    readonly vertexSource: string;
    readonly fragmentSource: string;
    private static _ACTIVE_SHADER_INSTANCE;
    private _logger;
    private _gl;
    private _textureLoader;
    private _textures;
    program: WebGLProgram;
    attributes: {
        [variableName: string]: VertexAttributeDefinition;
    };
    private _uniforms;
    private _uniformBuffers;
    private _compiled;
    private _onPreLink?;
    private _onPostCompile?;
    private _dirtyUniforms;
    private _maxTextureSlots;
    private _startingTextureSlot;
    /**
     * Flags uniforms need to be re-uploaded on the next call to .use()
     */
    flagUniformsDirty(): void;
    /**
     * Set uniforms key value pairs
     */
    uniforms: UniformDictionary;
    /**
     * Set images to load into the shader as a sampler2d
     */
    images: Record<string, ImageSource>;
    /**
     * Returns whether the shader is compiled
     */
    get compiled(): boolean;
    /**
     * Create a shader program in excalibur
     * @param options specify shader vertex and fragment source
     */
    constructor(options: ShaderOptions);
    /**
     * Deletes the webgl program from the gpu
     */
    dispose(): void;
    /**
     * Binds the shader program
     */
    use(): void;
    unuse(): void;
    isCurrentlyBound(): boolean;
    private _setUniforms;
    private _loadImageSource;
    _setImages(suppressWarning?: boolean): void;
    /**
     * Compile the current shader against a webgl context
     */
    compile(): WebGLProgram;
    /**
     * Get's the uniform definitons
     */
    getUniformDefinitions(): UniformDefinition[];
    getAttributeDefinitions(): VertexAttributeDefinition[];
    addImageSource(samplerName: string, image: ImageSource): void;
    removeImageSource(samplerName: string): void;
    /**
     * Set a texture in a gpu texture slot
     * @param slotNumber
     * @param texture
     */
    setTexture(slotNumber: number, texture: WebGLTexture): void;
    /**
     * Set a uniform buffer block with a Float32Array
     * @param name The of the binding block
     * @param data Float32Array
     * @param [bindingPoint]
     */
    setUniformBuffer(name: string, data: Float32Array, bindingPoint?: number): void;
    trySetUniformBuffer(name: string, data: Float32Array, bindingPoint?: number): boolean;
    /**
     * Set an integer uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformInt(name: string, value: number): void;
    /**
     * Set an integer uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformInt(name: string, value: number): boolean;
    /**
     * Set an integer array uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformIntArray(name: string, value: number[]): void;
    /**
     * Set an integer array uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformIntArray(name: string, value: number[]): boolean;
    /**
     * Set a boolean uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformBoolean(name: string, value: boolean): void;
    /**
     * Set a boolean uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformBoolean(name: string, value: boolean): boolean;
    /**
     * Set a float uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformFloat(name: string, value: number): void;
    /**
     * Set a float uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformFloat(name: string, value: number): boolean;
    /**
     * Set a float array uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformFloatArray(name: string, value: number[]): void;
    /**
     * Set a float array uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformFloatArray(name: string, value: number[]): boolean;
    /**
     * Set a {@apilink Vector} uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformFloatVector(name: string, value: Vector): void;
    /**
     * Set a {@apilink Vector} uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformFloatVector(name: string, value: Vector): boolean;
    /**
     * Set a {@apilink Color} uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformFloatColor(name: string, value: Color): void;
    /**
     * Set a {@apilink Color} uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformFloatColor(name: string, value: Color): boolean;
    /**
     * Set an {@apilink Matrix} uniform for the current shader
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    setUniformMatrix(name: string, value: Matrix): void;
    setUniformAffineMatrix(name: string, value: AffineMatrix): void;
    /**
     * Set an {@apilink Matrix} uniform for the current shader, WILL NOT THROW on error.
     *
     * **Important** Must call ex.Shader.use() before setting a uniform!
     * @param name
     * @param value
     */
    trySetUniformMatrix(name: string, value: Matrix): boolean;
    /**
     * Set any available uniform type in webgl
     *
     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat\`, ...);
     */
    setUniform<TUniformType extends UniformTypeNames>(uniformType: TUniformType, name: string, ...value: UniformParameters<TUniformType>): void;
    /**
     * Set any available uniform type in webgl. Will try to set the uniform, will return false if the uniform didn't exist,
     * true if it was set.
     *
     * WILL NOT THROW on error
     *
     * For example setUniform('uniformMatrix2fv', 'u_my2x2_mat\`, ...);
     *
     */
    trySetUniform<TUniformType extends UniformTypeNames>(uniformType: TUniformType, name: string, ...value: UniformParameters<TUniformType>): boolean;
    private _createProgram;
    private _compileShader;
    private _processSourceForError;
}

interface VertexBufferOptions {
    /**
     * WebGL2RenderingContext this layout will be attached to, these cannot be reused across contexts.
     */
    gl: WebGL2RenderingContext;
    /**
     * Size in number of floats, so [4.2, 4.0, 2.1] is size = 3
     *
     * Ignored if data is passed directly
     */
    size?: number;
    /**
     * If the vertices never change switching 'static' can be more efficient on the gpu
     *
     * Default is 'dynamic'
     */
    type?: 'static' | 'dynamic';
    /**
     * Optionally pass pre-seeded data, size parameter is ignored
     */
    data?: Float32Array;
}
/**
 * Helper around vertex buffer to simplify creating and uploading geometry
 *
 * Under the hood uses Float32Array
 */
declare class VertexBuffer {
    private _gl;
    /**
     * Access to the webgl buffer handle
     */
    readonly buffer: WebGLBuffer;
    /**
     * Access to the raw data of the vertex buffer
     */
    readonly bufferData: Float32Array;
    /**
     * If the vertices never change switching 'static' can be more efficient on the gpu
     *
     * Default is 'dynamic'
     */
    type: 'static' | 'dynamic';
    constructor(options: VertexBufferOptions);
    /**
     * Bind this vertex buffer
     */
    bind(): void;
    unbind(): void;
    /**
     * Upload vertex buffer geometry to the GPU
     */
    upload(count?: number): void;
    dispose(): void;
}

interface VertexLayoutOptions {
    /**
     * WebGL2RenderingContext this layout will be attached to, these cannot be reused across contexts.
     */
    gl: WebGL2RenderingContext;
    /**
     * Shader that this layout will be for, if null you must set a shader before using it.
     */
    shader?: Shader;
    /**
     * Vertex buffer to use for vertex data
     */
    vertexBuffer: VertexBuffer;
    /**
     * Starting index for the attribute pointer
     */
    attributePointerStartIndex?: number;
    /**
     * Specify the attributes that will exist in the vertex buffer
     *
     * **Important** must specify them in the order that they will be in the vertex buffer!!
     */
    attributes: [name: string, numberOfComponents: number, type?: 'int' | 'matrix' | 'float'][];
    /**
     * Optionally suppress any warnings out of vertex layouts
     *
     * **BEWARE** this may cause you to have issues go unnoticed
     */
    suppressWarnings?: boolean;
}
/**
 * Helper around creating vertex attributes in a given {@apilink VertexBuffer}, this is useful for describing
 * the memory layout for your vertices inside a particular buffer
 *
 * Note: This helper assumes interleaved attributes in one {@apilink VertexBuffer}, not many.
 *
 * Working with \`gl.vertexAttribPointer\` can be tricky, and this attempts to double check you
 */
declare class VertexLayout {
    private _gl;
    private _logger;
    private _suppressWarnings;
    private _shader;
    private _layout;
    private _attributes;
    private _vertexBuffer;
    private _vao;
    get vertexBuffer(): VertexBuffer;
    get attributes(): readonly [name: string, numberOfComponents: number, type?: 'int' | 'matrix' | 'float'][];
    constructor(options: VertexLayoutOptions);
    private _vertexTotalSizeBytes;
    /**
     * Total number of bytes that the vertex will take up
     */
    get totalVertexSizeBytes(): number;
    set shader(shader: Shader);
    get shader(): Shader;
    private _initialized;
    /**
     * Layouts need shader locations and must be bound to a shader
     */
    initialize(): void;
    /**
     * Bind this layout with it's associated vertex buffer
     * @param uploadBuffer Optionally indicate you wish to upload the buffer to the GPU associated with this layout
     */
    use(uploadBuffer?: boolean, count?: number): void;
}

declare class TransformStack {
    private _pool;
    private _transforms;
    private _currentTransform;
    save(): void;
    restore(): void;
    translate(x: number, y: number): AffineMatrix;
    rotate(angle: number): AffineMatrix;
    scale(x: number, y: number): AffineMatrix;
    reset(): void;
    set current(matrix: AffineMatrix);
    get current(): AffineMatrix;
}

interface MaterialOptions {
    /**
     * Name the material for debugging
     */
    name?: string;
    /**
     * Excalibur graphics context to create the material (only WebGL is supported at the moment)
     */
    graphicsContext?: ExcaliburGraphicsContext;
    /**
     * Optionally specify a vertex shader
     *
     * If none supplied the default will be used
     *
     * \`\`\`
     *  #version 300 es
     *  // vertex position in local space
     *  in vec2 a_position;
     *  in vec2 a_uv;
     *  out vec2 v_uv;
     *  // orthographic projection matrix
     *  uniform mat4 u_matrix;
     *  // world space transform matrix
     *  uniform mat4 u_transform;
     *  void main() {
     *    // Set the vertex position using the ortho & transform matrix
     *    gl_Position = u_matrix * u_transform * vec4(a_position, 0.0, 1.0);
     *    // Pass through the UV coord to the fragment shader
     *    v_uv = a_uv;
     *  }
     * \`\`\`
     */
    vertexSource?: string;
    /**
     * Add custom fragment shader
     *
     * *Note: Excalibur image alpha's are pre-multiplied
     *
     * Pre-built varyings:
     *
     * * \`in vec2 v_uv\` - UV coordinate
     * * \`in vec2 v_screenuv\` - UV coordinate
     *
     * Pre-built uniforms:
     *
     * * \`uniform sampler2D u_graphic\` - The current graphic displayed by the GraphicsComponent
     * * \`uniform vec2 u_resolution\` - The current resolution of the screen
     * * \`uniform vec2 u_size;\` - The current size of the graphic
     * * \`uniform vec4 u_color\` - The current color of the material
     * * \`uniform float u_opacity\` - The current opacity of the graphics context
     *
     */
    fragmentSource: string;
    /**
     * Add custom color, by default ex.Color.Transparent
     */
    color?: Color;
    /**
     * Add additional images to the material, you are limited by the GPU's maximum texture slots
     *
     * Specify a dictionary of uniform sampler names to ImageSource
     */
    images?: Record<string, ImageSource>;
    /**
     * Optionally set starting uniforms on a shader
     */
    uniforms?: UniformDictionary;
}
interface MaterialImageOptions {
    filtering?: ImageFiltering;
}
declare class Material {
    private _logger;
    private _name;
    private _shader;
    private _color;
    private _initialized;
    private _fragmentSource;
    private _vertexSource;
    private _images;
    private _uniforms;
    constructor(options: MaterialOptions);
    private _initialize;
    get uniforms(): UniformDictionary;
    get images(): Record<string, ImageSource>;
    get color(): Color;
    set color(c: Color);
    get name(): string;
    get isUsingScreenTexture(): boolean;
    update(callback: (shader: Shader) => any): void;
    getShader(): Shader | null;
    addImageSource(samplerName: string, image: ImageSource): void;
    removeImageSource(samplerName: string): void;
    use(): void;
}

declare class StateStack {
    private _pool;
    current: ExcaliburGraphicsContextState;
    private _states;
    private _cloneState;
    save(): void;
    restore(): void;
}

interface GarbageCollectionOptions {
    /**
     * Textures that aren't drawn after a certain number of milliseconds are unloaded from the GPU
     * Default 60_000 ms
     */
    textureCollectInterval?: number;
}
declare const DefaultGarbageCollectionOptions: GarbageCollectionOptions;
interface GarbageCollectorOptions {
    /**
     * Returns a timestamp in milliseconds representing now
     */
    getTimestamp: () => number;
}
declare class GarbageCollector {
    options: GarbageCollectorOptions;
    private _collectHandle;
    private _running;
    private _collectionMap;
    private _collectors;
    constructor(options: GarbageCollectorOptions);
    /**
     *
     * @param type Resource type
     * @param timeoutInterval If resource type exceeds interval in milliseconds collect() is called
     * @param collect Collection implementation, returns true if collected
     */
    registerCollector(type: string, timeoutInterval: number, collect: (resource: any) => boolean): void;
    /**
     * Add a resource to be tracked for collection
     * @param type
     * @param resource
     */
    addCollectableResource(type: string, resource: any): void;
    /**
     * Update the resource last used timestamp preventing collection
     * @param resource
     */
    touch(resource: any): void;
    /**
     * Runs the collection loop to cleanup any stale resources given the registered collect handlers
     */
    collectStaleResources: (deadline?: IdleDeadline) => void;
    /**
     * Force collect all resources, useful for shutting down a game
     * or if you know that you will not use anything you've allocated before now
     */
    forceCollectAll(): void;
    running(): boolean;
    /**
     * Starts the garbage collection loop
     */
    start(): void;
    /**
     * Stops the garbage collection loop
     */
    stop(): void;
}

/**
 * Manages loading image sources into webgl textures, a unique id is associated with all sources
 */
declare class TextureLoader {
    private _garbageCollector?;
    private static _LOGGER;
    constructor(gl: WebGL2RenderingContext, _garbageCollector?: {
        garbageCollector: GarbageCollector;
        collectionInterval: number;
    });
    dispose(): void;
    /**
     * Sets the default filtering for the Excalibur texture loader, default {@apilink ImageFiltering.Blended}
     */
    static filtering: ImageFiltering;
    static wrapping: ImageWrapConfiguration;
    private _gl;
    private _textureMap;
    private static _MAX_TEXTURE_SIZE;
    /**
     * Get the WebGL Texture from a source image
     * @param image
     */
    get(image: HTMLImageSource): WebGLTexture;
    /**
     * Returns whether a source image has been loaded as a texture
     * @param image
     */
    has(image: HTMLImageSource): boolean;
    /**
     * Loads a graphic into webgl and returns it's texture info, a webgl context must be previously registered
     * @param image Source graphic
     * @param options {ImageSourceOptions} Optionally configure the ImageFiltering and ImageWrapping mode to apply to the loaded texture
     * @param forceUpdate Optionally force a texture to be reloaded, useful if the source graphic has changed
     */
    load(image: HTMLImageSource, options?: ImageSourceOptions, forceUpdate?: boolean): WebGLTexture | null;
    delete(image: HTMLImageSource): void;
    /**
     * Takes an image and returns if it meets size criteria for hardware
     * @param image
     * @returns if the image will be supported at runtime
     */
    static checkImageSizeSupportedAndLog(image: HTMLImageSource): boolean;
    /**
     * Looks for textures that haven't been drawn in a while
     */
    private _collect;
}

/**
 * Interface that defines an Excalibur Renderer that can be called with .draw() in the {@apilink ExcaliburGraphicsContext}
 */
interface RendererPlugin {
    /**
     * Unique type name for this renderer plugin
     */
    readonly type: string;
    /**
     * Render priority tie breaker when drawings are at the same z index
     *
     * Lower number means higher priority and is drawn first. Higher number means lower priority and is drawn last.
     */
    priority: number;
    /**
     * Initialize your renderer
     * @param gl
     * @param context
     */
    initialize(gl: WebGL2RenderingContext, context: ExcaliburGraphicsContextWebGL): void;
    /**
     * Issue a draw command to draw something to the screen
     * @param args
     */
    draw(...args: any[]): void;
    /**
     * @returns if there are any pending draws in the renderer
     */
    hasPendingDraws(): boolean;
    /**
     * Flush any pending graphics draws to the screen
     */
    flush(): void;
    /**
     * Clear out any allocated memory
     */
    dispose(): void;
}

declare const pixelSnapEpsilon = 0.0001;
declare class ExcaliburGraphicsContextWebGLDebug implements DebugDraw {
    private _webglCtx;
    private _debugText;
    constructor(_webglCtx: ExcaliburGraphicsContextWebGL);
    /**
     * Draw a debugging rectangle to the context
     * @param x
     * @param y
     * @param width
     * @param height
     */
    drawRect(x: number, y: number, width: number, height: number, rectOptions?: RectGraphicsOptions): void;
    /**
     * Draw a debugging line to the context
     * @param start
     * @param end
     * @param lineOptions
     */
    drawLine(start: Vector, end: Vector, lineOptions?: LineGraphicsOptions): void;
    /**
     * Draw a debugging point to the context
     * @param point
     * @param pointOptions
     */
    drawPoint(point: Vector, pointOptions?: PointGraphicsOptions): void;
    drawText(text: string, pos: Vector): void;
}
interface WebGLGraphicsContextInfo {
    transform: TransformStack;
    state: StateStack;
    ortho: Matrix;
    context: ExcaliburGraphicsContextWebGL;
}
interface ExcaliburGraphicsContextWebGLOptions extends ExcaliburGraphicsContextOptions {
    context?: WebGL2RenderingContext;
    garbageCollector?: {
        garbageCollector: GarbageCollector;
        collectionInterval: number;
    };
    handleContextLost?: (e: Event) => void;
    handleContextRestored?: (e: Event) => void;
}
declare class ExcaliburGraphicsContextWebGL implements ExcaliburGraphicsContext {
    private _logger;
    private _renderers;
    private _lazyRenderersFactory;
    imageRenderer: 'ex.image' | 'ex.image-v2';
    private _isDrawLifecycle;
    useDrawSorting: boolean;
    private _drawCallPool;
    private _drawCallIndex;
    private _drawCalls;
    private _renderTarget;
    private _msaaTarget;
    private _postProcessTargets;
    private _screenRenderer;
    private _postprocessors;
    /**
     * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.
     * @internal
     */
    __gl: WebGL2RenderingContext;
    private _transform;
    private _state;
    private _ortho;
    /**
     * Snaps the drawing x/y coordinate to the nearest whole pixel
     */
    snapToPixel: boolean;
    /**
     * Native context smoothing
     */
    readonly smoothing: boolean;
    /**
     * Whether the pixel art sampler is enabled for smooth sub pixel anti-aliasing
     */
    readonly pixelArtSampler: boolean;
    /**
     * UV padding in pixels to use in internal image rendering to prevent texture bleed
     *
     */
    uvPadding: number;
    backgroundColor: Color;
    textureLoader: TextureLoader;
    materialScreenTexture: WebGLTexture | null;
    get z(): number;
    set z(value: number);
    get opacity(): number;
    set opacity(value: number);
    get tint(): Color | undefined | null;
    set tint(color: Color | undefined | null);
    get width(): number;
    get height(): number;
    get ortho(): Matrix;
    /**
     * Checks the underlying webgl implementation if the requested internal resolution is supported
     * @param dim
     */
    checkIfResolutionSupported(dim: Resolution): boolean;
    readonly multiSampleAntialiasing: boolean;
    readonly samples?: number;
    readonly transparency: boolean;
    private _isContextLost;
    constructor(options: ExcaliburGraphicsContextWebGLOptions);
    private _disposed;
    dispose(): void;
    private _init;
    register<T extends RendererPlugin>(renderer: T): void;
    lazyRegister<TRenderer extends RendererPlugin>(type: TRenderer['type'], renderer: () => TRenderer): void;
    get(rendererName: string): RendererPlugin | undefined;
    private _currentRenderer;
    private _isCurrentRenderer;
    beginDrawLifecycle(): void;
    endDrawLifecycle(): void;
    draw<TRenderer extends RendererPlugin>(rendererName: TRenderer['type'], ...args: Parameters<TRenderer['draw']>): void;
    resetTransform(): void;
    updateViewport(resolution: Resolution): void;
    private _imageToWidth;
    private _getImageWidth;
    private _imageToHeight;
    private _getImageHeight;
    drawImage(image: HTMLImageSource, x: number, y: number): void;
    drawImage(image: HTMLImageSource, x: number, y: number, width: number, height: number): void;
    drawImage(image: HTMLImageSource, sx: number, sy: number, swidth?: number, sheight?: number, dx?: number, dy?: number, dwidth?: number, dheight?: number): void;
    drawLine(start: Vector, end: Vector, color: Color, thickness?: number): void;
    drawRectangle(pos: Vector, width: number, height: number, color: Color, stroke?: Color, strokeThickness?: number): void;
    drawCircle(pos: Vector, radius: number, color: Color, stroke?: Color, thickness?: number): void;
    debug: ExcaliburGraphicsContextWebGLDebug;
    save(): void;
    restore(): void;
    translate(x: number, y: number): void;
    rotate(angle: number): void;
    scale(x: number, y: number): void;
    transform(matrix: AffineMatrix): void;
    getTransform(): AffineMatrix;
    multiply(m: AffineMatrix): void;
    addPostProcessor(postprocessor: PostProcessor): void;
    removePostProcessor(postprocessor: PostProcessor): void;
    clearPostProcessors(): void;
    private _totalPostProcessorTime;
    updatePostProcessors(elapsed: number): void;
    set material(material: Material | null | undefined);
    get material(): Material | null | undefined;
    /**
     * Creates and initializes the material which compiles the internal shader
     * @param options
     * @returns Material
     */
    createMaterial(options: Omit<MaterialOptions, 'graphicsContext'>): Material;
    createShader(options: Omit<ShaderOptions, 'graphicsContext'>): Shader;
    clear(): void;
    /**
     * Flushes all batched rendering to the screen
     */
    flush(): void;
}

/**
 * PostProcessors can be used to apply a shader to the entire screen. It is recommended
 * you use the {@apilink ScreenShader} to build your post processor shader.
 *
 * The screen texture comes through as this uniform
 *
 * \`uniform sampler2D u_image\`
 *
 * Post processor shaders get some default uniforms passed to them
 *
 * \`uniform float u_time_ms\` - total playback time in milliseconds
 * \`uniform float u_elapsed_ms\` - the elapsed time from the last frame in milliseconds
 * \`uniform vec2 u_resolution\` - the resolution of the canvas (in pixels)
 *
 * Custom uniforms can be updated in the {@apilink PostProcessor.onUpdate}
 */
interface PostProcessor {
    initialize(graphicsContext: ExcaliburGraphicsContextWebGL): void;
    getShader(): Shader;
    getLayout(): VertexLayout;
    /**
     * Use the onUpdate hook to update any uniforms in the postprocessors shader
     *
     * The shader has already been bound so there is no need to call shader.use();
     * @param elapsed
     */
    onUpdate?(elapsed: number): void;
    /**
     * Use the onDraw hook to upload any textures or command that need to run right before draw
     * @param elapsed
     */
    onDraw?(): void;
}

declare class ExcaliburGraphicsContext2DCanvasDebug implements DebugDraw {
    private _ex;
    private _debugText;
    constructor(_ex: ExcaliburGraphicsContext2DCanvas);
    /**
     * Draw a debug rectangle to the context
     * @param x
     * @param y
     * @param width
     * @param height
     */
    drawRect(x: number, y: number, width: number, height: number): void;
    drawLine(start: Vector, end: Vector, lineOptions?: LineGraphicsOptions): void;
    drawPoint(point: Vector, pointOptions?: PointGraphicsOptions): void;
    drawText(text: string, pos: Vector): void;
}
interface ExcaliburGraphicsContext2DOptions extends ExcaliburGraphicsContextOptions {
    context?: CanvasRenderingContext2D;
}
declare class ExcaliburGraphicsContext2DCanvas implements ExcaliburGraphicsContext {
    /**
     * Meant for internal use only. Access the internal context at your own risk and no guarantees this will exist in the future.
     * @internal
     */
    __ctx: CanvasRenderingContext2D;
    get width(): number;
    get height(): number;
    /**
     * Unused in Canvas implementation
     */
    readonly useDrawSorting: boolean;
    /**
     * Unused in Canvas implementation
     */
    z: number;
    backgroundColor: Color;
    private _state;
    get opacity(): number;
    set opacity(value: number);
    get tint(): Color | null | undefined;
    set tint(color: Color | null | undefined);
    snapToPixel: boolean;
    get smoothing(): boolean;
    set smoothing(value: boolean);
    constructor(options: ExcaliburGraphicsContext2DOptions);
    resetTransform(): void;
    updateViewport(_resolution: Resolution): void;
    /**
     * Draw an image to the Excalibur Graphics context at an x and y coordinate using the images width and height
     */
    drawImage(image: HTMLImageSource, x: number, y: number): void;
    /**
     *
     * Draw an image to the Excalibur Graphics context at an x and y coordinate with a specific width and height
     */
    drawImage(image: HTMLImageSource, x: number, y: number, width: number, height: number): void;
    /**
     *
     * Draw an image to the Excalibur Graphics context specifying the source image coordinates (sx, sy, swidth, sheight)
     * and to a specific destination on the context (dx, dy, dwidth, dheight)
     */
    drawImage(image: HTMLImageSource, sx: number, sy: number, swidth?: number, sheight?: number, dx?: number, dy?: number, dwidth?: number, dheight?: number): void;
    drawLine(start: Vector, end: Vector, color: Color, thickness?: number): void;
    drawRectangle(pos: Vector, width: number, height: number, color: Color): void;
    drawCircle(pos: Vector, radius: number, color: Color, stroke?: Color, thickness?: number): void;
    debug: ExcaliburGraphicsContext2DCanvasDebug;
    /**
     * Save the current state of the canvas to the stack (transforms and opacity)
     */
    save(): void;
    /**
     * Restore the state of the canvas from the stack
     */
    restore(): void;
    /**
     * Translate the origin of the context by an x and y
     * @param x
     * @param y
     */
    translate(x: number, y: number): void;
    /**
     * Rotate the context about the current origin
     */
    rotate(angle: number): void;
    /**
     * Scale the context by an x and y factor
     * @param x
     * @param y
     */
    scale(x: number, y: number): void;
    getTransform(): AffineMatrix;
    multiply(_m: AffineMatrix): void;
    addPostProcessor(_postprocessor: PostProcessor): void;
    removePostProcessor(_postprocessor: PostProcessor): void;
    clearPostProcessors(): void;
    updatePostProcessors(elapsed: number): void;
    beginDrawLifecycle(): void;
    endDrawLifecycle(): void;
    set material(material: Material | undefined | null);
    get material(): Material | undefined | null;
    createMaterial(options: Omit<MaterialOptions, 'graphicsContext'>): Material;
    clear(): void;
    /**
     * Flushes the batched draw calls to the screen
     */
    flush(): void;
    dispose(): void;
}

/**
 * An enum that represents the types of emitter nozzles
 */
declare enum EmitterType {
    /**
     * Constant for the circular emitter type
     */
    Circle = "circle",
    /**
     * Constant for the rectangular emitter type
     */
    Rectangle = "rectangle"
}

/**
 * @module
 * Pseudo-Random Utility
 *
 * A pseudo-random utility to add seeded random support for help in
 * generating things like terrain or reproducible randomness. Uses the
 * [Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister) algorithm.
 */
/**
 * Pseudo-random number generator following the Mersenne_Twister algorithm. Given a seed this generator will produce the same sequence
 * of numbers each time it is called.
 * See https://en.wikipedia.org/wiki/Mersenne_Twister for more details.
 * Uses the MT19937-32 (2002) implementation documented here http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/emt19937ar.html
 *
 * Api inspired by http://chancejs.com/# https://github.com/chancejs/chancejs
 */
declare class Random {
    private _lowerMask;
    private _upperMask;
    private _w;
    private _n;
    private _m;
    private _a;
    private _u;
    private _s;
    private _b;
    private _t;
    private _c;
    private _l;
    private _f;
    private _mt;
    private _index;
    private _seed;
    /**
     * If no seed is specified, the Date.now() is used
     */
    constructor(seed?: number);
    /**
     * Apply the twist
     */
    private _twist;
    /**
     * Return next 32 bit integer number in sequence
     */
    nextInt(): number;
    /**
     * Return a random floating point number between [0, 1)
     */
    next(): number;
    /**
     * Return a random floating point in range [min, max) min is included, max is not included
     */
    floating(min: number, max: number): number;
    /**
     * Return a random integer in range [min, max] min is included, max is included.
     * Implemented with rejection sampling, see https://medium.com/@betable/tifu-by-using-math-random-f1c308c4fd9d#.i13tdiu5a
     */
    integer(min: number, max: number): number;
    /**
     * Returns true or false randomly with 50/50 odds by default.
     * By default the likelihood of returning a true is .5 (50%).
     * @param likelihood takes values between [0, 1]
     */
    bool(likelihood?: number): boolean;
    /**
     * Returns one element from an array at random
     */
    pickOne<T>(array: Array<T>): T;
    /**
     * Returns a new array random picking elements from the original
     * @param array Original array to pick from
     * @param numPicks can be any positive number
     * @param allowDuplicates indicates whether the returned set is allowed duplicates (it does not mean there will always be duplicates
     * just that it is possible)
     */
    pickSet<T>(array: Array<T>, numPicks: number, allowDuplicates?: boolean): Array<T>;
    /**
     * Returns a new array randomly picking elements in the original (not reused)
     * @param array Array to pick elements out of
     * @param numPicks must be less than or equal to the number of elements in the array.
     */
    private _pickSetWithoutDuplicates;
    /**
     * Returns a new array random picking elements from the original allowing duplicates
     * @param array Array to pick elements out of
     * @param numPicks can be any positive number
     */
    private _pickSetWithDuplicates;
    /**
     * Returns a new array that has its elements shuffled. Using the Fisher/Yates method
     * https://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle
     */
    shuffle<T>(array: Array<T>): Array<T>;
    /**
     * Generate a list of random integer numbers
     * @param length the length of the final array
     * @param min the minimum integer number to generate inclusive
     * @param max the maximum integer number to generate inclusive
     */
    range(length: number, min: number, max: number): Array<number>;
    /**
     * Returns the result of a d4 dice roll
     */
    d4(): number;
    /**
     * Returns the result of a d6 dice roll
     */
    d6(): number;
    /**
     * Returns the result of a d8 dice roll
     */
    d8(): number;
    /**
     * Returns the result of a d10 dice roll
     */
    d10(): number;
    /**
     * Returns the result of a d12 dice roll
     */
    d12(): number;
    /**
     * Returns the result of a d20 dice roll
     */
    d20(): number;
    get seed(): number;
}

/**
 * Using a particle emitter is a great way to create interesting effects
 * in your game, like smoke, fire, water, explosions, etc. \`ParticleEmitter\`
 * extend {@apilink Actor} allowing you to use all of the features that come with.
 *
 * These particles are simulated on the CPU in JavaScript
 */
declare class ParticleEmitter extends Actor {
    private _particlesToEmit;
    private _particlePool;
    numParticles: number;
    /**
     * Random number generator
     */
    random: Random;
    /**
     * Gets or sets the isEmitting flag
     */
    isEmitting: boolean;
    /**
     * Gets or sets the backing deadParticle collection
     */
    deadParticles: Particle[];
    /**
     * Gets or sets the emission rate for particles (particles/sec)
     */
    emitRate: number;
    /**
     * Gets or sets the emitter type for the particle emitter
     */
    emitterType: EmitterType;
    /**
     * Gets or sets the emitter radius, only takes effect when the {@apilink emitterType} is {@apilink EmitterType.Circle}
     */
    radius: number;
    particle: ParticleConfig;
    /**
     * @param config particle emitter options bag
     */
    constructor(config: ParticleEmitterArgs);
    removeParticle(particle: Particle): void;
    private _activeParticles;
    /**
     * Causes the emitter to emit particles
     * @param particleCount  Number of particles to emit right now
     */
    emitParticles(particleCount: number): void;
    clearParticles(): void;
    private _createParticle;
    update(engine: Engine, elapsed: number): void;
}

/**
/**
 * CPU Particle is used in a {@apilink ParticleEmitter}
 */
declare class Particle extends Entity {
    static DefaultConfig: ParticleConfig;
    focus?: Vector;
    focusAccel?: number;
    beginColor: Color;
    endColor: Color;
    life: number;
    fade: boolean;
    private _rRate;
    private _gRate;
    private _bRate;
    private _aRate;
    private _currentColor;
    size: number;
    graphic?: Graphic;
    startSize?: number;
    endSize?: number;
    sizeRate: number;
    visible: boolean;
    isOffscreen: boolean;
    transform: TransformComponent;
    motion: MotionComponent;
    graphics: GraphicsComponent;
    particleTransform: ParticleTransform;
    name: string;
    constructor(options: ParticleConfig);
    private _emitter?;
    registerEmitter(emitter: ParticleEmitter): void;
    configure(options: ParticleConfig): void;
    kill(): void;
    update(engine: Engine, elapsed: number): void;
}
interface ParticleConfig {
    /**
     * Optionally set the emitted particle transform style, {@apilink ParticleTransform.Global} is the default and emits particles as if
     * they were world space objects, useful for most effects.
     *
     * If set to {@apilink ParticleTransform.Local} particles are children of the emitter and move relative to the emitter
     * as they would in a parent/child actor relationship.
     */
    transform?: ParticleTransform;
    /**
     * Starting position of the particle
     */
    pos?: Vector;
    /**
     * Starting velocity of the particle
     */
    vel?: Vector;
    /**
     * Starting acceleration of the particle
     */
    acc?: Vector;
    /**
     * Starting angular velocity of the particle
     */
    angularVelocity?: number;
    /**
     * Starting rotation of the particle
     */
    rotation?: number;
    /**
     * Optionally set the z index of the particle, default is 0
     */
    z?: number;
    /**
     * Size of the particle in pixels
     */
    size?: number;
    /**
     * Optionally set a graphic
     */
    graphic?: Graphic;
    /**
     * Totally life of the particle in milliseconds
     */
    life?: number;
    /**
     * Starting opacity of the particle
     */
    opacity?: number;
    /**
     * Should the particle fade out to fully transparent over their life
     */
    fade?: boolean;
    /**
     * Ending color of the particle over its life
     */
    endColor?: Color;
    /**
     * Beginning color of the particle over its life
     */
    beginColor?: Color;
    /**
     * Set the start size when you want to change particle size over their life
     */
    startSize?: number;
    /**
     * Set the end size when you want to change particle size over their life
     */
    endSize?: number;
    /**
     * Smallest possible starting size of the particle
     */
    minSize?: number;
    /**
     * Largest possible starting size of the particle
     */
    maxSize?: number;
    /**
     * Minimum magnitude of the particle starting speed
     */
    minSpeed?: number;
    /**
     * Maximum magnitude of the particle starting speed
     */
    maxSpeed?: number;
    /**
     * Minimum angle to use for the particles starting rotation
     */
    minAngle?: number;
    /**
     * Maximum angle to use for the particles starting rotation
     */
    maxAngle?: number;
    /**
     * Gets or sets the optional focus where all particles should accelerate towards
     *
     * If the particle transform is global the focus is in world space, otherwise it is relative to the emitter
     */
    focus?: Vector;
    /**
     * Gets or sets the optional acceleration for focusing particles if a focus has been specified
     */
    focusAccel?: number;
    /**
     * Indicates whether particles should start with a random rotation
     */
    randomRotation?: boolean;
}
declare enum ParticleTransform {
    /**
     * {@apilink ParticleTransform.Global} is the default and emits particles as if
     * they were world space objects, useful for most effects.
     */
    Global = "global",
    /**
     * {@apilink ParticleTransform.Local} particles are children of the emitter and move relative to the emitter
     * as they would in a parent/child actor relationship.
     */
    Local = "local"
}
interface ParticleEmitterArgs {
    particle?: ParticleConfig;
    x?: number;
    y?: number;
    z?: number;
    pos?: Vector;
    width?: number;
    height?: number;
    /**
     * Is emitting currently
     */
    isEmitting?: boolean;
    /**
     * Particles per second
     */
    emitRate?: number;
    focus?: Vector;
    focusAccel?: number;
    /**
     * Emitter shape
     */
    emitterType?: EmitterType;
    /**
     * Radius of the emitter if the emitter type is EmitterType.Circle
     */
    radius?: number;
    random?: Random;
}

declare class GpuParticleEmitter extends Actor {
    particle: GpuParticleConfig;
    graphics: GraphicsComponent;
    renderer: GpuParticleRenderer;
    isEmitting: boolean;
    emitRate: number;
    emitterType: EmitterType;
    radius: number;
    readonly maxParticles: number;
    random: Random;
    get pos(): Vector;
    set pos(pos: Vector);
    get z(): number;
    set z(z: number);
    constructor(config: ParticleEmitterArgs & {
        maxParticles?: number;
        particle?: GpuParticleConfig;
    });
    _initialize(engine: Engine): void;
    private _particlesToEmit;
    update(engine: Engine, elapsed: number): void;
    emitParticles(particleCount: number): void;
    clearParticles(): void;
    draw(ctx: ExcaliburGraphicsContextWebGL, elapsed: number): void;
}

interface GpuParticleConfig extends ParticleConfig {
    /**
     * Only Sprite graphics are supported in GPU particles at the moment
     */
    graphic?: Sprite;
    /**
     * Set the maximum particles to use for this emitter
     */
    maxParticles?: number;
}
/**
 * Container for the GPU Particle State contains the internal state needed for the GPU
 * to render particles and maintain state.
 */
declare class GpuParticleRenderer {
    static readonly GPU_MAX_PARTICLES: number;
    emitter: GpuParticleEmitter;
    emitRate: number;
    particle: GpuParticleConfig;
    private _initialized;
    private _vaos;
    private _buffers;
    private _random;
    private _drawIndex;
    private _currentVao;
    private _currentBuffer;
    private _numInputFloats;
    private _particleData;
    private _particleIndex;
    private _uploadIndex;
    private _wrappedLife;
    private _wrappedParticles;
    private _particleLife;
    constructor(emitter: GpuParticleEmitter, random: Random, options: GpuParticleConfig);
    get isInitialized(): boolean;
    get maxParticles(): number;
    initialize(gl: WebGL2RenderingContext, context: ExcaliburGraphicsContextWebGL): void;
    private _clearRequested;
    clearParticles(): void;
    private _emitted;
    emitParticles(particleCount: number): void;
    private _uploadEmitted;
    update(elapsed: number): void;
    draw(gl: WebGL2RenderingContext): void;
}

declare class ParticleRenderer implements RendererPlugin {
    readonly type: "ex.particle";
    priority: number;
    private _gl;
    private _context;
    private _shader;
    initialize(gl: WebGL2RenderingContext, context: ExcaliburGraphicsContextWebGL): void;
    private _getTexture;
    draw(renderer: GpuParticleRenderer, elapsed: number): void;
    hasPendingDraws(): boolean;
    flush(): void;
    dispose(): void;
}

/**
 * Internal debug text helper
 */
declare class DebugText {
    constructor();
    /**
     * base64 font
     */
    readonly fontSheet: string;
    size: number;
    private _imageSource;
    private _spriteSheet;
    private _spriteFont;
    load(): Promise<void>;
    /**
     * Writes debug text using the built in sprint font
     * @param ctx
     * @param text
     * @param pos
     */
    write(ctx: ExcaliburGraphicsContext, text: string, pos: Vector): void;
}

/**
 * Helper that defines a whole screen renderer, just provide a fragment source!
 *
 * Currently supports 1 varying
 * - vec2 a_texcoord between 0-1 which corresponds to screen position
 */
declare class ScreenShader {
    private _shader;
    private _buffer;
    private _layout;
    constructor(context: ExcaliburGraphicsContextWebGL, fragmentSource: string);
    getShader(): Shader;
    getLayout(): VertexLayout;
}

declare class ColorBlindnessPostProcessor implements PostProcessor {
    private _colorBlindnessMode;
    private _shader;
    private _simulate;
    constructor(_colorBlindnessMode: ColorBlindnessMode, simulate?: boolean);
    initialize(graphicsContext: ExcaliburGraphicsContextWebGL): void;
    getShader(): Shader;
    getLayout(): VertexLayout;
    set colorBlindnessMode(colorBlindMode: ColorBlindnessMode);
    get colorBlindnessMode(): ColorBlindnessMode;
    set simulate(value: boolean);
    get simulate(): boolean;
}

interface UniformBufferOptions {
    /**
     * WebGL2RenderingContext this layout will be attached to, these cannot be reused across contexts.
     */
    gl: WebGL2RenderingContext;
    /**
     * Size in number of floats, so [4.2, 4.0, 2.1] is size = 3
     *
     * **NOTE It is recommended you use multiples of 4's to avoid hardware implemenetation bugs, vec4's the the most supported**
     *
     * Ignored if data is passed directly
     */
    size?: number;
    /**
     * If the vertices never change switching 'static' can be more efficient on the gpu
     *
     * Default is 'dynamic'
     */
    type?: 'static' | 'dynamic';
    /**
     * Optionally pass pre-seeded data, size parameter is ignored
     */
    data?: Float32Array;
}
declare class UniformBuffer {
    private _gl;
    /**
     * Access to the webgl buffer handle
     */
    readonly buffer: WebGLBuffer;
    readonly bufferData: Float32Array;
    type: 'static' | 'dynamic';
    private _maxFloats;
    constructor(options: UniformBufferOptions);
    /**
     * Bind this uniform buffer
     */
    bind(): void;
    unbind(): void;
    upload(count?: number): void;
    dispose(): void;
}

/**
 * Helper that defines and index buffer for quad geometry
 *
 * Index buffers allow you to save space in vertex buffers when you share vertices in geometry
 * it is almost always worth it in terms of performance to use an index buffer.
 */
declare class QuadIndexBuffer {
    private _gl;
    private _logger;
    /**
     * Access to the webgl buffer handle
     */
    buffer: WebGLBuffer;
    /**
     * Access to the raw data of the index buffer
     */
    bufferData: Uint16Array | Uint32Array;
    /**
     * Depending on the browser this is either gl.UNSIGNED_SHORT or gl.UNSIGNED_INT
     */
    bufferGlType: number;
    /**
     * @param gl WebGL2RenderingContext this layout will be attached to, these cannot be reused across contexts.
     * @param numberOfQuads Specify the max number of quads you want to draw
     * @param useUint16 Optionally force a uint16 buffer
     */
    constructor(gl: WebGL2RenderingContext, numberOfQuads: number, useUint16?: boolean);
    get size(): number;
    /**
     * Upload data to the GPU
     */
    upload(): void;
    /**
     * Bind this index buffer
     */
    bind(): void;
    dispose(): void;
}

declare class Debug {
    static _drawCalls: ((ctx: ExcaliburGraphicsContext) => void)[];
    static _ctx: ExcaliburGraphicsContext;
    static z: number;
    static registerGraphicsContext(ctx: ExcaliburGraphicsContext): void;
    static draw(debugDrawCall: (ctx: ExcaliburGraphicsContext) => void): void;
    static drawPoint(point: Vector, options?: PointGraphicsOptions): void;
    static drawLine(start: Vector, end: Vector, options?: LineGraphicsOptions): void;
    static drawLines(points: Vector[], options?: LineGraphicsOptions): void;
    static drawText(text: string, pos: Vector): void;
    static drawPolygon(points: Vector[], options?: {
        color?: Color;
    }): void;
    static drawCircle(center: Vector, radius: number, options?: {
        color?: Color;
        strokeColor?: Color;
        width?: number;
    }): void;
    static drawBounds(boundingBox: BoundingBox, options?: {
        color?: Color;
    }): void;
    static drawRay(ray: Ray, options?: {
        distance?: number;
        color?: Color;
    }): void;
    static flush(ctx: ExcaliburGraphicsContext): void;
    static clear(): void;
}

/**
 * Return the size of the GlType in bytes
 * @param gl
 * @param type
 */
declare function getGlTypeSizeBytes(gl: WebGLRenderingContext, type: number): number;
/**
 * Checks if an attribute is present in vertex source
 */
declare function isAttributeInSource(source: string, variable: string): boolean;
/**
 * Attempt to discern the glType of an attribute from vertex source
 * @param gl
 * @param source
 * @param variable
 */
declare function getGLTypeFromSource(gl: WebGLRenderingContext, source: string, variable: string): 5121 | 5124 | 5125 | 5126 | 5122 | 5123 | 5120 | 35670;
/**
 * Based on the type return the number of attribute components
 *
 * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer
 * @param gl
 * @param type
 */
declare function getAttributeComponentSize(gl: WebGLRenderingContext, type: number): number;
/**
 * Based on the attribute return the corresponding supported attrib pointer type
 * https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/vertexAttribPointer
 * @param gl
 * @param type
 */
declare function getAttributePointerType(gl: WebGLRenderingContext, type: number): 5121 | 5126 | 5122 | 5123 | 5120;
/**
 *
 */
declare function getMaxShaderComplexity(gl: WebGL2RenderingContext, numIfs: number): number;

declare const webglUtil_getAttributeComponentSize: typeof getAttributeComponentSize;
declare const webglUtil_getAttributePointerType: typeof getAttributePointerType;
declare const webglUtil_getGLTypeFromSource: typeof getGLTypeFromSource;
declare const webglUtil_getGlTypeSizeBytes: typeof getGlTypeSizeBytes;
declare const webglUtil_getMaxShaderComplexity: typeof getMaxShaderComplexity;
declare const webglUtil_isAttributeInSource: typeof isAttributeInSource;
declare namespace webglUtil {
  export { webglUtil_getAttributeComponentSize as getAttributeComponentSize, webglUtil_getAttributePointerType as getAttributePointerType, webglUtil_getGLTypeFromSource as getGLTypeFromSource, webglUtil_getGlTypeSizeBytes as getGlTypeSizeBytes, webglUtil_getMaxShaderComplexity as getMaxShaderComplexity, webglUtil_isAttributeInSource as isAttributeInSource };
}

interface QuadTreeItem {
    bounds: BoundingBox;
}
interface QuadTreeOptions {
    maxDepth?: number;
    capacity: number;
    level?: number;
}
/**
 * QuadTree spatial data structure. Useful for quickly retrieving all objects that might
 * be in a specific location.
 */
declare class QuadTree<TItem extends QuadTreeItem> {
    bounds: BoundingBox;
    options?: QuadTreeOptions;
    private _defaultOptions;
    halfWidth: number;
    halfHeight: number;
    items: TItem[];
    private _isDivided;
    topLeft: QuadTree<TItem> | null;
    topRight: QuadTree<TItem> | null;
    bottomLeft: QuadTree<TItem> | null;
    bottomRight: QuadTree<TItem> | null;
    constructor(bounds: BoundingBox, options?: QuadTreeOptions);
    /**
     * Splits the quad tree one level deeper
     */
    private _split;
    private _insertIntoSubNodes;
    /**
     * Insert an item to be tracked in the QuadTree
     * @param item
     */
    insert(item: TItem): void;
    /**
     * Remove a tracked item in the QuadTree
     * @param item
     */
    remove(item: TItem): void;
    /**
     * Query the structure for all objects that intersect the bounding box
     * @param boundingBox
     * @returns items
     */
    query(boundingBox: BoundingBox): TItem[];
    clear(): void;
    getAllItems(): TItem[];
    getTreeDepth(): number;
    debug(ctx: ExcaliburGraphicsContext): void;
}

/**
 * A collision solver figures out how to position colliders such that they are no longer overlapping
 *
 * Solvers are executed in the order
 *
 * 1. preSolve
 * 2. solveVelocity
 * 3. solvePosition
 * 4. postSolve
 * @inheritdoc
 */
interface CollisionSolver {
    /**
     * Solves overlapping contact in
     *
     * Solvers are executed in the order
     * 1. preSolve
     * 2. solveVelocity
     * 3. solvePosition
     * 4. postSolve
     * @param contacts
     */
    solve(contacts: CollisionContact[]): CollisionContact[];
}

/**
 * ArcadeSolver is the default in Excalibur. It solves collisions so that there is no overlap between contacts,
 * and negates velocity along the collision normal.
 *
 * This is usually the type of collisions used for 2D games that don't need a more realistic collision simulation.
 *
 */
declare class ArcadeSolver implements CollisionSolver {
    config: DeepRequired<Pick<PhysicsConfig, 'arcade'>['arcade']>;
    directionMap: Map<string, "horizontal" | "vertical">;
    distanceMap: Map<string, number>;
    constructor(config: DeepRequired<Pick<PhysicsConfig, 'arcade'>['arcade']>);
    solve(contacts: CollisionContact[]): CollisionContact[];
    private _compositeContactsIds;
    preSolve(contacts: CollisionContact[]): void;
    postSolve(contacts: CollisionContact[]): void;
    solvePosition(contact: CollisionContact): void;
    solveVelocity(contact: CollisionContact): void;
}

/**
 * Holds information about contact points, meant to be reused over multiple frames of contact
 */
declare class ContactConstraintPoint {
    point: Vector;
    local: Vector;
    contact: CollisionContact;
    constructor(point: Vector, local: Vector, contact: CollisionContact);
    /**
     * Updates the contact information
     */
    update(): this;
    /**
     * Returns the relative velocity between bodyA and bodyB
     */
    getRelativeVelocity(): Vector;
    /**
     * Impulse accumulated over time in normal direction
     */
    normalImpulse: number;
    /**
     * Impulse accumulated over time in the tangent direction
     */
    tangentImpulse: number;
    /**
     * Effective mass seen in the normal direction
     */
    normalMass: number;
    /**
     * Effective mass seen in the tangent direction
     */
    tangentMass: number;
    /**
     * Direction from center of mass of bodyA to contact point
     */
    aToContact: Vector;
    /**
     * Direction from center of mass of bodyB to contact point
     */
    bToContact: Vector;
    /**
     * Original contact velocity combined with bounciness
     */
    originalVelocityAndRestitution: number;
}

declare class RealisticSolver implements CollisionSolver {
    config: DeepRequired<Pick<PhysicsConfig, 'realistic'>['realistic']>;
    directionMap: Map<string, "horizontal" | "vertical">;
    distanceMap: Map<string, number>;
    constructor(config: DeepRequired<Pick<PhysicsConfig, 'realistic'>['realistic']>);
    lastFrameContacts: Map<string, CollisionContact>;
    idToContactConstraint: Map<string, ContactConstraintPoint[]>;
    getContactConstraints(id: string): ContactConstraintPoint[];
    solve(contacts: CollisionContact[]): CollisionContact[];
    preSolve(contacts: CollisionContact[]): void;
    postSolve(contacts: CollisionContact[]): void;
    /**
     * Warm up body's based on previous frame contact points
     * @param contacts
     */
    warmStart(contacts: CollisionContact[]): void;
    /**
     * Iteratively solve the position overlap constraint
     * @param contacts
     */
    solvePosition(contacts: CollisionContact[]): void;
    solveVelocity(contacts: CollisionContact[]): void;
}

declare class PhysicsWorld {
    $configUpdate: Observable<Required<{
        enabled?: boolean;
        gravity?: Vector;
        solver?: SolverStrategy;
        substep?: number;
        colliders?: Required<{
            compositeStrategy?: "separate" | "together";
        }>;
        continuous?: Required<{
            checkForFastBodies?: boolean;
            disableMinimumSpeedForFastBody?: boolean;
            surfaceEpsilon?: number;
        }>;
        bodies?: Required<{
            defaultMass?: number;
            sleepEpsilon?: number;
            wakeThreshold?: number;
            sleepBias?: number;
            canSleepByDefault?: boolean;
        }>;
        spatialPartition?: SpatialPartitionStrategy;
        sparseHashGrid?: SparseHashGridConfig;
        dynamicTree?: Required<{
            boundsPadding?: number;
            velocityMultiplier?: number;
        }>;
        arcade?: Required<{
            contactSolveBias?: ContactSolveBias;
        }>;
        realistic?: Required<{
            contactSolveBias?: ContactSolveBias;
            positionIterations?: number;
            velocityIterations?: number;
            slop?: number;
            steeringFactor?: number;
            warmStart?: boolean;
        }>;
    }>>;
    private _configDirty;
    private _config;
    get config(): DeepRequired<PhysicsConfig>;
    set config(newConfig: DeepRequired<PhysicsConfig>);
    private _collisionProcessor;
    /**
     * Spatial data structure for locating potential collision pairs and ray casts
     */
    get collisionProcessor(): CollisionProcessor;
    constructor(config: DeepRequired<PhysicsConfig>);
    /**
     * Raycast into the scene's physics world
     * @param ray
     * @param options
     */
    rayCast(ray: Ray, options?: RayCastOptions): RayCastHit[];
    /**
     * Query for colliders in the scene's physics world
     * @param point
     */
    query(point: Vector): Collider[];
    query(bounds: BoundingBox): Collider[];
}

declare class CollisionSystem extends System {
    private _physics;
    static priority: -5;
    systemType: SystemType;
    query: Query<ComponentCtor<TransformComponent> | ComponentCtor<ColliderComponent>>;
    private _engine;
    private _configDirty;
    private _realisticSolver;
    private _arcadeSolver;
    private _lastFrameContacts;
    private _currentFrameContacts;
    private _motionSystem;
    private get _processor();
    private _trackCollider;
    private _untrackCollider;
    constructor(world: World, _physics: PhysicsWorld);
    initialize(world: World, scene: Scene): void;
    update(elapsed: number): void;
    postupdate(): void;
    getSolver(): CollisionSolver;
    debug(ex: ExcaliburGraphicsContext): void;
    runContactStartEnd(): void;
}

declare class MotionSystem extends System {
    world: World;
    physics: PhysicsWorld;
    static priority: -5;
    systemType: SystemType;
    private _physicsConfigDirty;
    query: Query<typeof TransformComponent | typeof MotionComponent>;
    constructor(world: World, physics: PhysicsWorld);
    update(elapsed: number): void;
    captureOldTransformWithChildren(entity: Entity): void;
}

/**
 * Enum representing the different display modes available to Excalibur.
 */
declare enum DisplayMode {
    /**
     * Default, use a specified resolution for the game. Like 800x600 pixels for example.
     */
    Fixed = "Fixed",
    /**
     * Fit the aspect ratio given by the game resolution within the container at all times will fill any gaps with canvas.
     * The displayed area outside the aspect ratio is not guaranteed to be on the screen, only the {@apilink Screen.contentArea}
     * is guaranteed to be on screen.
     */
    FitContainerAndFill = "FitContainerAndFill",
    /**
     * Fit the aspect ratio given by the game resolution the screen at all times will fill the screen.
     * This displayed area outside the aspect ratio is not guaranteed to be on the screen, only the {@apilink Screen.contentArea}
     * is guaranteed to be on screen.
     */
    FitScreenAndFill = "FitScreenAndFill",
    /**
     * Fit the viewport to the parent element maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars
     * (letterbox) that would otherwise be present in {@apilink FitContainer}.
     *
     * **warning** This will clip some drawable area from the user because of the zoom,
     * use {@apilink Screen.contentArea} to know the safe to draw area.
     */
    FitContainerAndZoom = "FitContainerAndZoom",
    /**
     * Fit the viewport to the device screen maintaining aspect ratio given by the game resolution, but zooms in to avoid the black bars
     * (letterbox) that would otherwise be present in {@apilink FitScreen}.
     *
     * **warning** This will clip some drawable area from the user because of the zoom,
     * use {@apilink Screen.contentArea} to know the safe to draw area.
     */
    FitScreenAndZoom = "FitScreenAndZoom",
    /**
     * Fit to screen using as much space as possible while maintaining aspect ratio and resolution.
     * This is not the same as {@apilink Screen.enterFullscreen} but behaves in a similar way maintaining aspect ratio.
     *
     * You may want to center your game here is an example
     * \`\`\`html
     * <!-- html -->
     * <body>
     * <main>
     *   <canvas id="game"></canvas>
     * </main>
     * </body>
     * \`\`\`
     *
     * \`\`\`css
     * // css
     * main {
     *   display: flex;
     *   align-items: center;
     *   justify-content: center;
     *   height: 100%;
     *   width: 100%;
     * }
     * \`\`\`
     */
    FitScreen = "FitScreen",
    /**
     * Fill the entire screen's css width/height for the game resolution dynamically. This means the resolution of the game will
     * change dynamically as the window is resized. This is not the same as {@apilink Screen.enterFullscreen}
     */
    FillScreen = "FillScreen",
    /**
     * Fit to parent element width/height using as much space as possible while maintaining aspect ratio and resolution.
     */
    FitContainer = "FitContainer",
    /**
     * Use the parent DOM container's css width/height for the game resolution dynamically
     */
    FillContainer = "FillContainer"
}
type ViewportUnit = 'pixel' | 'percent';
/**
 * Convenience class for quick resolutions
 * Mostly sourced from https://emulation.gametechwiki.com/index.php/Resolution
 */
declare class Resolution {
    static get SVGA(): Resolution;
    static get Standard(): Resolution;
    static get Atari2600(): Resolution;
    static get GameBoy(): Resolution;
    static get GameBoyAdvance(): Resolution;
    static get NintendoDS(): Resolution;
    static get NES(): Resolution;
    static get SNES(): Resolution;
}
interface Resolution {
    width: number;
    height: number;
}
interface ViewportDimension {
    widthUnit?: ViewportUnit;
    heightUnit?: ViewportUnit;
    width: number;
    height: number;
}
interface ScreenOptions {
    /**
     * Canvas element to build a screen on
     */
    canvas: HTMLCanvasElement;
    /**
     * Graphics context for the screen
     */
    context: ExcaliburGraphicsContext;
    /**
     * Browser abstraction
     */
    browser: BrowserEvents;
    /**
     * Optionally set antialiasing, defaults to true. If set to true, images will be smoothed
     */
    antialiasing?: boolean;
    /**
     * Optionally set the image rendering CSS hint on the canvas element, default is auto
     */
    canvasImageRendering?: 'auto' | 'pixelated';
    /**
     * Optionally override the pixel ratio to use for the screen, otherwise calculated automatically from the browser
     */
    pixelRatio?: number;
    /**
     * Optionally specify the actual pixel resolution in width/height pixels (also known as logical resolution), by default the
     * resolution will be the same as the viewport. Resolution will be overridden by {@apilink DisplayMode.FillContainer} and
     * {@apilink DisplayMode.FillScreen}.
     */
    resolution?: Resolution;
    /**
     * Visual viewport size in css pixel, if resolution is not specified it will be the same as the viewport
     */
    viewport: ViewportDimension;
    /**
     * Set the display mode of the screen, by default DisplayMode.Fixed.
     */
    displayMode?: DisplayMode;
}
/**
 * Fires when the screen resizes, useful if you have logic that needs to be aware of resolution/viewport constraints
 */
interface ScreenResizeEvent {
    /**
     * Current viewport in css pixels of the screen
     */
    viewport: ViewportDimension;
    /**
     * Current resolution in world pixels of the screen
     */
    resolution: Resolution;
}
/**
 * Fires when the pixel ratio changes, useful to know if you've moved to a hidpi screen or back
 */
interface PixelRatioChangeEvent {
    /**
     * Current pixel ratio of the screen
     */
    pixelRatio: number;
}
/**
 * Fires when the browser fullscreen api is successfully engaged or disengaged
 */
interface FullScreenChangeEvent {
    /**
     * Current fullscreen state
     */
    fullscreen: boolean;
}
/**
 * Built in events supported by all entities
 */
type ScreenEvents = {
    /**
     * Fires when the screen resizes, useful if you have logic that needs to be aware of resolution/viewport constraints
     */
    resize: ScreenResizeEvent;
    /**
     * Fires when the pixel ratio changes, useful to know if you've moved to a hidpi screen or back
     */
    pixelratio: PixelRatioChangeEvent;
    /**
     * Fires when the browser fullscreen api is successfully engaged or disengaged
     */
    fullscreen: FullScreenChangeEvent;
};
declare const ScreenEvents: {
    readonly ScreenResize: "resize";
    readonly PixelRatioChange: "pixelratio";
    readonly FullScreenChange: "fullscreen";
};
/**
 * The Screen handles all aspects of interacting with the screen for Excalibur.
 */
declare class Screen {
    graphicsContext: ExcaliburGraphicsContext;
    /**
     * Listen to screen events {@apilink ScreenEvents}
     */
    events: EventEmitter<ScreenEvents>;
    private _canvas;
    private _antialiasing;
    private _canvasImageRendering;
    private _contentResolution;
    private _browser;
    private _camera;
    private _resolution;
    private _resolutionStack;
    private _viewport;
    private _viewportStack;
    private _pixelRatioOverride;
    private _displayMode;
    private _isFullscreen;
    private _mediaQueryList;
    private _isDisposed;
    private _logger;
    private _resizeObserver;
    constructor(options: ScreenOptions);
    private _listenForPixelRatio;
    dispose(): void;
    private _fullscreenChangeHandler;
    private _pixelRatioChangeHandler;
    private _resizeHandler;
    private _calculateDevicePixelRatio;
    private _devicePixelRatio;
    /**
     * Returns the computed pixel ratio, first using any override, then the device pixel ratio
     */
    get pixelRatio(): number;
    /**
     * This calculates the ratio between excalibur pixels and the HTML pixels.
     *
     * This is useful for scaling HTML UI so that it matches your game.
     */
    get worldToPagePixelRatio(): number;
    /**
     * Get or set the pixel ratio override
     *
     * You will need to call applyResolutionAndViewport() affect change on the screen
     */
    get pixelRatioOverride(): number | undefined;
    set pixelRatioOverride(value: number | undefined);
    get isHiDpi(): boolean;
    get displayMode(): DisplayMode;
    get canvas(): HTMLCanvasElement;
    get parent(): HTMLElement | Window;
    get resolution(): Resolution;
    set resolution(resolution: Resolution);
    /**
     * Returns screen dimensions in pixels or percentage
     */
    get viewport(): ViewportDimension;
    set viewport(viewport: ViewportDimension);
    get aspectRatio(): number;
    get scaledWidth(): number;
    get scaledHeight(): number;
    setCurrentCamera(camera: Camera): void;
    pushResolutionAndViewport(): void;
    peekViewport(): ViewportDimension;
    peekResolution(): Resolution;
    popResolutionAndViewport(): void;
    applyResolutionAndViewport(): void;
    /**
     * Get or set screen antialiasing,
     *
     * If true smoothing is applied
     */
    get antialiasing(): boolean;
    /**
     * Get or set screen antialiasing
     */
    set antialiasing(isSmooth: boolean);
    /**
     * Returns true if excalibur is fullscreen using the browser fullscreen api
     * @deprecated use isFullscreen()
     */
    get isFullScreen(): boolean;
    /**
     * Returns true if excalibur is fullscreen using the browser fullscreen api
     */
    get isFullscreen(): boolean;
    /**
     * Requests to go fullscreen using the browser fullscreen api, requires user interaction to be successful.
     * For example, wire this to a user click handler.
     *
     * Optionally specify a target element id to go fullscreen, by default the game canvas is used
     * @param elementId
     * @deprecated use enterFullscreen(...)
     */
    goFullScreen(elementId?: string): Promise<void>;
    /**
     * Requests to enter fullscreen using the browser fullscreen api, requires user interaction to be successful.
     * For example, wire this to a user click handler.
     *
     * Optionally specify a target element id to go fullscreen, by default the game canvas is used
     * @param elementId
     */
    enterFullscreen(elementId?: string): Promise<void>;
    /**
     * Requests to exit fullscreen using the browser fullscreen api
     * @deprecated use exitFullscreen()
     */
    exitFullScreen(): Promise<void>;
    exitFullscreen(): Promise<void>;
    private _viewportToPixels;
    /**
     * Takes a coordinate in normal html page space, for example from a pointer move event, and translates it to
     * Excalibur screen space.
     *
     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the
     * bottom right corner (resolutionX, resolutionY). When using *AndFill suffixed display modes screen space
     * (0, 0) is the top left of the safe content area bounding box not the viewport.
     * @param point
     */
    pageToScreenCoordinates(point: Vector): Vector;
    /**
     * Takes a coordinate in Excalibur screen space, and translates it to normal html page space. For example,
     * this is where html elements might live if you want to position them relative to Excalibur.
     *
     * Excalibur screen space starts at the top left (0, 0) corner of the viewport, and extends to the
     * bottom right corner (resolutionX, resolutionY)
     * @param point
     */
    screenToPageCoordinates(point: Vector): Vector;
    /**
     * Takes a coordinate in Excalibur screen space, and translates it to Excalibur world space.
     *
     * World space is where {@apilink Entity | \`entities\`} in Excalibur live by default {@apilink CoordPlane.World}
     * and extends infinitely out relative from the {@apilink Camera}.
     * @param point  Screen coordinate to convert
     */
    screenToWorldCoordinates(point: Vector): Vector;
    /**
     * Takes a coordinate in Excalibur world space, and translates it to Excalibur screen space.
     *
     * Screen space is where {@apilink ScreenElement | \`screen elements\`} and {@apilink Entity | \`entities\`} with {@apilink CoordPlane.Screen} live.
     * @param point  World coordinate to convert
     */
    worldToScreenCoordinates(point: Vector): Vector;
    pageToWorldCoordinates(point: Vector): Vector;
    worldToPageCoordinates(point: Vector): Vector;
    /**
     * Returns a BoundingBox of the top left corner of the screen
     * and the bottom right corner of the screen.
     *
     * World bounds are in world coordinates, useful for culling objects offscreen that are in world space
     */
    getWorldBounds(): BoundingBox;
    /**
     * Returns a BoundingBox of the top left corner of the screen and the bottom right corner of the screen.
     *
     * Screen bounds are in screen coordinates, useful for culling objects offscreen that are in screen space
     */
    getScreenBounds(): BoundingBox;
    /**
     * The width of the game canvas in pixels (physical width component of the
     * resolution of the canvas element)
     */
    get canvasWidth(): number;
    /**
     * Returns half width of the game canvas in pixels (half physical width component)
     */
    get halfCanvasWidth(): number;
    /**
     * The height of the game canvas in pixels, (physical height component of
     * the resolution of the canvas element)
     */
    get canvasHeight(): number;
    /**
     * Returns half height of the game canvas in pixels (half physical height component)
     */
    get halfCanvasHeight(): number;
    /**
     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get drawWidth(): number;
    /**
     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get width(): number;
    /**
     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get halfDrawWidth(): number;
    /**
     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get drawHeight(): number;
    get height(): number;
    /**
     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get halfDrawHeight(): number;
    /**
     * Returns screen center coordinates including zoom and device pixel ratio.
     */
    get center(): Vector;
    /**
     * Returns the content area in screen space where it is safe to place content
     */
    get contentArea(): BoundingBox;
    /**
     * Returns the unsafe area in screen space, this is the full screen and some space may not be onscreen.
     */
    get unsafeArea(): BoundingBox;
    private _contentArea;
    private _unsafeArea;
    private _computeFit;
    private _computeFitScreenAndFill;
    private _computeFitContainerAndFill;
    private _computeFitAndFill;
    private _computeFitScreenAndZoom;
    private _computeFitContainerAndZoom;
    private _computeFitAndZoom;
    private _computeFitContainer;
    private _applyDisplayMode;
    /**
     * Sets the resolution and viewport based on the selected display mode.
     */
    private _setResolutionAndViewportByDisplayMode;
}

type HTMLImageSource = HTMLImageElement | HTMLCanvasElement;
interface AntialiasOptions {
    /**
     * Turns on the special pixel art sampler in excalibur's image shader for sub pixel
     * anti-aliasing
     *
     * Default false
     */
    pixelArtSampler?: boolean;
    /**
     * Configures the webgl's getContext('webgl2', {antialias: true | false}) or configures
     * Canvas2D imageSmoothing = true;
     *
     * **Note** this option is incompatible with \`multiSampleAntialiasing\`
     *
     * Default false
     */
    nativeContextAntialiasing?: boolean;
    /**
     * Configures the internal render buffer multi-sampling settings
     *
     * Default true, with max samples that the platform supports
     */
    multiSampleAntialiasing?: boolean | {
        /**
         * Optionally specify number of samples (will be clamped to the max the platform supports)
         *
         * Default most platforms are 16 samples
         */
        samples: number;
    };
    /**
     * Sets the default image filtering for excalibur
     *
     * Default {@apilink ImageFiltering.Blended}
     */
    filtering?: ImageFiltering;
    /**
     * Sets the canvas image rendering CSS style
     *
     * Default 'auto'
     */
    canvasImageRendering?: 'pixelated' | 'auto';
}
declare const DefaultAntialiasOptions: Required<AntialiasOptions>;
declare const DefaultPixelArtOptions: Required<AntialiasOptions>;
interface ExcaliburGraphicsContextOptions {
    /**
     * Target existing html canvas element
     */
    canvasElement: HTMLCanvasElement;
    /**
     * Enables antialiasing on the canvas context (smooths pixels with default canvas sampling)
     */
    antialiasing?: boolean;
    /**
     * Enable the sub pixel antialiasing pixel art sampler for nice looking pixel art
     */
    pixelArtSampler?: boolean;
    /**
     * Enable canvas transparency
     */
    enableTransparency?: boolean;
    /**
     * Enable or disable multi-sample antialiasing in the internal render buffer.
     *
     * If true the max number of samples will be used
     *
     * By default enabled
     */
    multiSampleAntialiasing?: boolean | {
        /**
         * Specify number of samples to use during the multi sample anti-alias, if not specified the max will be used.
         * Limited by the hardware (usually 16)
         */
        samples: number;
    };
    /**
     * UV padding in pixels to use in the internal image rendering
     *
     * Recommended .25 - .5 of a pixel
     */
    uvPadding?: number;
    /**
     * Hint the power preference to the graphics context
     */
    powerPreference?: 'default' | 'high-performance' | 'low-power';
    /**
     * Snaps the pixel to an integer value (floor)
     */
    snapToPixel?: boolean;
    /**
     * Current clearing color of the context
     */
    backgroundColor?: Color;
    /**
     * Feature flag that enables draw sorting will removed in v0.29
     */
    useDrawSorting?: boolean;
}
interface ExcaliburGraphicsContextState {
    opacity: number;
    z: number;
    tint: Color | null | undefined;
    material: Material | null | undefined;
}
interface LineGraphicsOptions {
    color?: Color;
}
interface RectGraphicsOptions {
    color?: Color;
}
interface PointGraphicsOptions {
    color: Color;
    size: number;
}
interface DebugDraw {
    /**
     * Draw a debugging rectangle to the screen
     * @param x
     * @param y
     * @param width
     * @param height
     * @param rectOptions
     */
    drawRect(x: number, y: number, width: number, height: number, rectOptions?: RectGraphicsOptions): void;
    /**
     * Draw a debugging line to the screen
     * @param start '
     * @param end
     * @param lineOptions
     */
    drawLine(start: Vector, end: Vector, lineOptions?: LineGraphicsOptions): void;
    /**
     * Draw a debugging point to the screen
     * @param point
     * @param pointOptions
     */
    drawPoint(point: Vector, pointOptions?: PointGraphicsOptions): void;
    /**
     * Draw debug text
     * @param text
     * @param pos
     */
    drawText(text: string, pos: Vector): void;
}
interface ExcaliburGraphicsContext {
    width: number;
    height: number;
    /**
     * Excalibur will automatically sort draw calls by z and priority for maximal draw performance,
     * this can disrupt a specific desired painter order.
     *
     * To force a specific draw call order, use {@apilink ExcaliburGraphicsContext.z}
     *
     * By default \`useDrawSorting\` is \`true\`, to opt out set this to \`false\`
     */
    useDrawSorting: boolean;
    /**
     * Set the current z context for the graphics context. Draw calls issued to the context will use this z
     * to inform their sort order.
     *
     * Note it is important to all {@apilink ExcaliburGraphicsContext.save} and {@apilink ExcaliburGraphicsContext.restore} when modifying state.
     */
    z: number;
    /**
     * Snaps all drawings to the nearest pixel truncated down, by default false
     */
    snapToPixel: boolean;
    /**
     * Enable smoothed drawing (also known as anti-aliasing), by default true
     */
    smoothing: boolean;
    /**
     * Set the background color of the graphics context, default is {@apilink Color.ExcaliburBlue}
     */
    backgroundColor: Color;
    /**
     * Sets the opacity of the current {@apilink Graphic} being drawn, default is 1
     */
    opacity: number;
    /**
     * Sets the tint color to be multiplied by any images drawn, default is black 0xFFFFFFFF
     */
    tint: Color | null | undefined;
    /**
     * Resets the current transform to the identity matrix
     */
    resetTransform(): void;
    /**
     * Gets the current transform
     */
    getTransform(): AffineMatrix;
    /**
     * Multiplies the current transform by a matrix
     * @param m
     */
    multiply(m: AffineMatrix): void;
    /**
     * Update the context with the current viewport dimensions (used in resizing)
     */
    updateViewport(resolution: Resolution): void;
    /**
     * Access the debug drawing api
     */
    debug: DebugDraw;
    /**
     * Draw an image to the Excalibur Graphics context at an x and y coordinate using the images width and height
     */
    drawImage(image: HTMLImageSource, x: number, y: number): void;
    /**
     *
     * Draw an image to the Excalibur Graphics context at an x and y coordinate with a specific width and height
     */
    drawImage(image: HTMLImageSource, x: number, y: number, width: number, height: number): void;
    /**
     *
     * Draw an image to the Excalibur Graphics context specifying the source image coordinates (sx, sy, swidth, sheight)
     * and to a specific destination on the context (dx, dy, dwidth, dheight)
     */
    drawImage(image: HTMLImageSource, sx: number, sy: number, swidth?: number, sheight?: number, dx?: number, dy?: number, dwidth?: number, dheight?: number): void;
    /**
     * Draw a solid line to the Excalibur Graphics context
     * @param start
     * @param end
     * @param color
     * @param thickness
     */
    drawLine(start: Vector, end: Vector, color: Color, thickness: number): void;
    /**
     * Draw a solid rectangle to the Excalibur Graphics context
     * @param pos
     * @param width
     * @param height
     * @param color
     */
    drawRectangle(pos: Vector, width: number, height: number, color: Color, stroke?: Color, strokeThickness?: number): void;
    /**
     * Draw a circle to the Excalibur Graphics context
     * @param pos
     * @param radius
     * @param color
     * @param stroke Optionally specify the stroke color
     * @param thickness
     */
    drawCircle(pos: Vector, radius: number, color: Color, stroke?: Color, thickness?: number): void;
    /**
     * Save the current state of the canvas to the stack (transforms and opacity)
     */
    save(): void;
    /**
     * Restore the state of the canvas from the stack
     */
    restore(): void;
    /**
     * Translate the origin of the context by an x and y
     * @param x
     * @param y
     */
    translate(x: number, y: number): void;
    /**
     * Rotate the context about the current origin
     */
    rotate(angle: number): void;
    /**
     * Scale the context by an x and y factor
     * @param x
     * @param y
     */
    scale(x: number, y: number): void;
    /**
     * Add a post processor to the graphics context
     *
     * Post processors are run in the order they were added.
     * @param postprocessor
     */
    addPostProcessor(postprocessor: PostProcessor): void;
    /**
     * Remove a specific post processor from the graphics context
     * @param postprocessor
     */
    removePostProcessor(postprocessor: PostProcessor): void;
    /**
     * Remove all post processors from the graphics context
     */
    clearPostProcessors(): void;
    /**
     * Updates all post processors in the graphics context
     *
     * Called internally by Excalibur
     * @param elapsed
     * @internal
     */
    updatePostProcessors(elapsed: number): void;
    /**
     * Gets or sets the material to be used in the current context's drawings
     *
     * This allows customs shaders to be used but draw calls are no longer batched by default.
     * @param material
     */
    material: Material | null | undefined;
    /**
     * Creates and initializes the material which compiles the internal shader
     * @param options
     * @returns
     */
    createMaterial(options: Omit<MaterialOptions, 'graphicsContext'>): Material;
    /**
     * Clears the screen with the current background color
     */
    clear(): void;
    /**
     * Flushes the batched draw calls to the screen
     */
    flush(): void;
    beginDrawLifecycle(): void;
    endDrawLifecycle(): void;
    dispose(): void;
}

interface GraphicOptions {
    /**
     * The width of the graphic
     */
    width?: number;
    /**
     * The height of the graphic
     */
    height?: number;
    /**
     * Should the graphic be flipped horizontally
     */
    flipHorizontal?: boolean;
    /**
     * Should the graphic be flipped vertically
     */
    flipVertical?: boolean;
    /**
     * The rotation of the graphic
     */
    rotation?: number;
    /**
     * The scale of the graphic
     */
    scale?: Vector;
    /**
     * The opacity of the graphic between (0 -1)
     */
    opacity?: number;
    /**
     * The tint of the graphic, this color will be multiplied by the original pixel colors
     */
    tint?: Color;
    /**
     * The origin of the drawing in pixels to use when applying transforms, by default it will be the center of the image in pixels
     */
    origin?: Vector;
}
/**
 * A Graphic is the base Excalibur primitive for something that can be drawn to the {@apilink ExcaliburGraphicsContext}.
 * {@apilink Sprite}, {@apilink Animation}, {@apilink GraphicsGroup}, {@apilink Canvas}, {@apilink Rectangle}, {@apilink Circle}, and {@apilink Polygon} all derive from the
 * {@apilink Graphic} abstract class.
 *
 * Implementors of a Graphic must override the abstract {@apilink Graphic._drawImage} method to render an image to the graphics context. Graphic
 * handles all the position, rotation, and scale transformations in {@apilink Graphic._preDraw} and {@apilink Graphic._postDraw}
 */
declare abstract class Graphic {
    private static _ID;
    readonly id: number;
    transform: AffineMatrix;
    tint?: Color;
    private _transformStale;
    isStale(): boolean;
    /**
     * Gets or sets wether to show debug information about the graphic
     */
    showDebug: boolean;
    private _flipHorizontal;
    /**
     * Gets or sets the flipHorizontal, which will flip the graphic horizontally (across the y axis)
     */
    get flipHorizontal(): boolean;
    set flipHorizontal(value: boolean);
    private _flipVertical;
    /**
     * Gets or sets the flipVertical, which will flip the graphic vertically (across the x axis)
     */
    get flipVertical(): boolean;
    set flipVertical(value: boolean);
    private _rotation;
    /**
     * Gets or sets the rotation of the graphic
     */
    get rotation(): number;
    set rotation(value: number);
    /**
     * Gets or sets the opacity of the graphic, 0 is transparent, 1 is solid (opaque).
     */
    opacity: number;
    private _scale;
    /**
     * Gets or sets the scale of the graphic, this affects the width and
     */
    get scale(): Vector;
    set scale(value: Vector);
    private _origin?;
    /**
     * Gets or sets the origin of the graphic, if not set the center of the graphic is the origin
     */
    get origin(): Vector | undefined;
    set origin(value: Vector | undefined);
    constructor(options?: GraphicOptions);
    cloneGraphicOptions(): GraphicOptions;
    private _width;
    /**
     * Gets or sets the width of the graphic (always positive)
     */
    get width(): number;
    private _height;
    /**
     * Gets or sets the height of the graphic (always positive)
     */
    get height(): number;
    set width(value: number);
    set height(value: number);
    /**
     * Gets a copy of the bounds in pixels occupied by the graphic on the the screen. This includes scale.
     */
    get localBounds(): BoundingBox;
    /**
     * Draw the whole graphic to the context including transform
     * @param ex The excalibur graphics context
     * @param x
     * @param y
     */
    draw(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    /**
     * Meant to be overridden by the graphic implementation to draw the underlying image (HTMLCanvasElement or HTMLImageElement)
     * to the graphics context without transform. Transformations like position, rotation, and scale are handled by {@apilink Graphic._preDraw}
     * and {@apilink Graphic._postDraw}
     * @param ex The excalibur graphics context
     * @param x
     * @param y
     */
    protected abstract _drawImage(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    /**
     * Apply affine transformations to the graphics context to manipulate the graphic before {@apilink Graphic._drawImage}
     * @param ex
     * @param x
     * @param y
     */
    protected _preDraw(ex: ExcaliburGraphicsContext, x: number, y: number): void;
    protected _rotate(ex: ExcaliburGraphicsContext | AffineMatrix): void;
    protected _flip(ex: ExcaliburGraphicsContext | AffineMatrix): void;
    /**
     * Apply any additional work after {@apilink Graphic._drawImage} and restore the context state.
     * @param ex
     */
    protected _postDraw(ex: ExcaliburGraphicsContext): void;
    /**
     * Returns a new instance of the graphic that has the same properties
     */
    abstract clone(): Graphic;
}

/**
 * Type guard for checking if a Graphic HasTick (used for graphics that change over time like animations)
 * @param graphic
 */
declare function hasGraphicsTick(graphic: Graphic): graphic is Graphic & HasTick;
interface GraphicsShowOptions {
    offset?: Vector;
    anchor?: Vector;
}
interface GraphicsComponentOptions {
    onPostDraw?: (ex: ExcaliburGraphicsContext, elapsed: number) => void;
    onPreDraw?: (ex: ExcaliburGraphicsContext, elapsed: number) => void;
    onPreTransformDraw?: (ex: ExcaliburGraphicsContext, elapsed: number) => void;
    onPostTransformDraw?: (ex: ExcaliburGraphicsContext, elapsed: number) => void;
    /**
     * Name of current graphic to use
     */
    current?: string;
    /**
     * Optionally set the color of the graphics component
     */
    color?: Color;
    /**
     * Optionally set a material to use on the graphic
     */
    material?: Material;
    /**
     * Optionally copy instances of graphics by calling .clone(), you may set this to false to avoid sharing graphics when added to the
     * component for performance reasons. By default graphics are not copied and are shared when added to the component.
     */
    copyGraphics?: boolean;
    /**
     * Optional visible flag, if the graphics component is not visible it will not be displayed
     */
    visible?: boolean;
    /**
     * Optional opacity
     */
    opacity?: number;
    /**
     * List of graphics and optionally the options per graphic
     */
    graphics?: {
        [graphicName: string]: Graphic | {
            graphic: Graphic;
            options?: GraphicsShowOptions | undefined;
        };
    };
    /**
     * Optional offset in absolute pixels to shift all graphics in this component from each graphic's anchor (default is top left corner)
     */
    offset?: Vector;
    /**
     * Optional anchor
     */
    anchor?: Vector;
}
/**
 * Component to manage drawings, using with the position component
 */
declare class GraphicsComponent extends Component {
    private _logger;
    private _current;
    private _graphics;
    private _options;
    material: Material | null;
    /**
     * Draws after the entity transform has been applied, but before graphics component graphics have been drawn
     */
    onPreDraw?: (ctx: ExcaliburGraphicsContext, elapsed: number) => void;
    /**
     * Draws after the entity transform has been applied, and after graphics component graphics has been drawn
     */
    onPostDraw?: (ctx: ExcaliburGraphicsContext, elapsed: number) => void;
    /**
     * Draws before the entity transform has been applied before any any graphics component drawing
     */
    onPreTransformDraw?: (ctx: ExcaliburGraphicsContext, elapsed: number) => void;
    /**
     * Draws after the entity transform has been applied, and after all graphics component drawing
     */
    onPostTransformDraw?: (ctx: ExcaliburGraphicsContext, elapsed: number) => void;
    private _color?;
    /**
     * Sets or gets wether any drawing should be visible in this component
     * @deprecated use isVisible
     */
    get visible(): boolean;
    /**
     * Sets or gets wether any drawing should be visible in this component
     * @deprecated use isVisible
     */
    set visible(val: boolean);
    /**
     * Sets or gets wether any drawing should be visible in this component
     */
    isVisible: boolean;
    /**
     * Optionally force the graphic onscreen, default false. Not recommend to use for perf reasons, only if you known what you're doing.
     */
    forceOnScreen: boolean;
    /**
     * Sets or gets wither all drawings should have an opacity applied
     */
    opacity: number;
    private _offset;
    /**
     * Offset to apply to graphics by default
     */
    get offset(): Vector;
    set offset(value: Vector);
    private _anchor;
    /**
     * Anchor to apply to graphics by default
     */
    get anchor(): Vector;
    set anchor(value: Vector);
    /**
     * Sets the color of the actor's current graphic
     */
    get color(): Color | undefined;
    set color(v: Color | undefined);
    /**
     * Flip all graphics horizontally along the y-axis
     */
    flipHorizontal: boolean;
    /**
     * Flip all graphics vertically along the x-axis
     */
    flipVertical: boolean;
    /**
     * If set to true graphics added to the component will be copied. This can effect performance, but is useful if you don't want
     * changes to a graphic to effect all the places it is used.
     */
    copyGraphics: boolean;
    constructor(options?: GraphicsComponentOptions);
    getGraphic(name: string): Graphic | undefined;
    getOptions(name: string): GraphicsShowOptions | undefined;
    /**
     * Get registered graphics names
     */
    getNames(): string[];
    /**
     * Returns the currently displayed graphic
     */
    get current(): Graphic | undefined;
    /**
     * Returns the currently displayed graphic offsets
     */
    get currentOptions(): GraphicsShowOptions | undefined;
    /**
     * Returns all graphics associated with this component
     */
    get graphics(): {
        [graphicName: string]: Graphic;
    };
    /**
     * Returns all graphics options associated with this component
     */
    get options(): {
        [graphicName: string]: GraphicsShowOptions | undefined;
    };
    /**
     * Adds a named graphic to this component, if the name is "default" or not specified, it will be shown by default without needing to call
     * @param graphic
     */
    add(graphic: Graphic, options?: GraphicsShowOptions): Graphic;
    add(name: string, graphic: Graphic, options?: GraphicsShowOptions): Graphic;
    /**
     * Removes a registered graphic, if the removed graphic is the current it will switch to the default
     * @param name
     */
    remove(name: string): void;
    /**
     * Use a graphic only, will set the default graphic. Returns the new {@apilink Graphic}
     *
     * Optionally override the stored options
     * @param nameOrGraphic
     * @param options
     */
    use<T extends Graphic = Graphic>(nameOrGraphic: string | T, options?: GraphicsShowOptions): T;
    /**
     * Hide currently shown graphic
     */
    hide(): void;
    private _localBounds?;
    set localBounds(bounds: BoundingBox);
    recalculateBounds(): void;
    /**
     * Get local bounds of graphics component
     */
    get localBounds(): BoundingBox;
    /**
     * Get world bounds of graphics component
     */
    get bounds(): BoundingBox;
    /**
     * Update underlying graphics if necessary, called internally
     * @param elapsed
     * @internal
     */
    update(elapsed: number, idempotencyToken?: number): void;
    clone(): GraphicsComponent;
}

interface PointerComponentOptions {
    useColliderShape?: boolean;
    useGraphicsBounds?: boolean;
    localBounds?: BoundingBox;
}
/**
 * Add this component to optionally configure how the pointer
 * system detects pointer events.
 *
 * By default the collider shape is used and graphics bounds is not.
 *
 * If both collider shape and graphics bounds are enabled it will fire events if either or
 * are intersecting the pointer.
 */
declare class PointerComponent extends Component {
    /**
     * Use any existing Collider component geometry for pointer events. This is useful if you want
     * user pointer events only to trigger on the same collision geometry used in the collider component
     * for collision resolution. Default is \`true\`.
     */
    useColliderShape: boolean;
    /**
     * Use any existing Graphics component bounds for pointers. This is useful if you want the axis aligned
     * bounds around the graphic to trigger pointer events. Default is \`true\`.
     */
    useGraphicsBounds: boolean;
    /**
     * Optionally use other bounds for pointer testing
     */
    localBounds?: BoundingBox;
    constructor(options?: PointerComponentOptions);
}

/**
 * Used for implementing actions for the {@apilink ActionContext | \`Action API\`}.
 */
interface Action {
    id: number;
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    reset(): void;
    stop(): void;
}
/**
 *
 */
declare function nextActionId(): number;

/**
 * Action Queues represent an ordered sequence of actions
 *
 * Action queues are part of the {@apilink ActionContext | \`Action API\`} and
 * store the list of actions to be executed for an {@apilink Actor}.
 *
 * Actors implement {@apilink Actor.actions} which can be manipulated by
 * advanced users to adjust the actions currently being executed in the
 * queue.
 */
declare class ActionQueue {
    private _entity;
    private _actions;
    private _currentAction;
    private _completedActions;
    constructor(entity: Entity);
    /**
     * Add an action to the sequence
     * @param action
     */
    add(action: Action): void;
    /**
     * Remove an action by reference from the sequence
     * @param action
     */
    remove(action: Action): void;
    /**
     * Removes all actions from this sequence
     */
    clearActions(): void;
    /**
     *
     * @returns The total list of actions in this sequence complete or not
     */
    getActions(): Action[];
    getIncompleteActions(): Action[];
    getCurrentAction(): Action | null;
    /**
     *
     * @returns \`true\` if there are more actions to process in the sequence
     */
    hasNext(): boolean;
    /**
     * @returns \`true\` if the current sequence of actions is done
     */
    isComplete(): boolean;
    /**
     * Resets the sequence of actions, this is used to restart a sequence from the beginning
     */
    reset(): void;
    /**
     * Update the queue which updates actions and handles completing actions
     * @param elapsed
     */
    update(elapsed: number): void;
}

interface MoveByOptions {
    offset: Vector;
    duration: number;
    easing?: EasingFunction;
}
/**
 *
 */
declare function isMoveByOptions(x: any): x is MoveByOptions;
declare class MoveByWithOptions implements Action {
    entity: Entity;
    id: number;
    private _start;
    private _end;
    private _durationMs;
    private _tx;
    private _started;
    private _currentMs;
    private _stopped;
    private _motion;
    private _offset;
    private _easing;
    constructor(entity: Entity, options: MoveByOptions);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    stop(): void;
    reset(): void;
}
declare class MoveBy implements Action {
    id: number;
    private _tx;
    private _motion;
    private _entity;
    x: number;
    y: number;
    private _distance;
    private _speed;
    private _start;
    private _offset;
    private _end;
    private _dir;
    private _started;
    private _stopped;
    constructor(entity: Entity, offsetX: number, offsetY: number, speed: number);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    stop(): void;
    reset(): void;
}

interface MoveToOptions {
    pos: Vector;
    duration: number;
    easing?: EasingFunction;
}
/**
 *
 */
declare function isMoveToOptions(x: any): x is MoveToOptions;
declare class MoveToWithOptions implements Action {
    entity: Entity;
    id: number;
    private _end;
    private _durationMs;
    private _tx;
    private _started;
    private _start;
    private _currentMs;
    private _stopped;
    private _motion;
    private _easing;
    constructor(entity: Entity, options: MoveToOptions);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    stop(): void;
    reset(): void;
}
declare class MoveTo implements Action {
    entity: Entity;
    id: number;
    private _tx;
    private _motion;
    x: number;
    y: number;
    private _start;
    private _end;
    private _dir;
    private _speed;
    private _distance;
    private _started;
    private _stopped;
    constructor(entity: Entity, destX: number, destY: number, speed: number);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    stop(): void;
    reset(): void;
}

interface VectorViewOptions {
    getX: () => number;
    getY: () => number;
    setX: (x: number) => void;
    setY: (y: number) => void;
}
declare class VectorView extends Vector {
    private _getX;
    private _getY;
    private _setX;
    private _setY;
    constructor(options: VectorViewOptions);
    get x(): number;
    set x(val: number);
    get y(): number;
    set y(val: number);
}

/**
 * Linear interpolation between \`a\` and \`b\`, at \`time = 0\` the value will be \`a\` at \`time = 1\` the value will be \`b\`
 * @param a
 * @param b
 * @param time
 */
declare function lerp(a: number, b: number, time: number): number;
/**
 * Linear interpolation between angles in radians
 * @param startAngle
 * @param endAngle
 * @param rotationType
 * @param time
 */
declare function lerpAngle(startAngle: number, endAngle: number, rotationType: RotationType, time: number): number;
/**
 * Linear interpolation between \`a\` and \`b\`, at \`time = 0\` the value will be \`a\` at \`time = 1\` the value will be \`b\`
 * @param a
 * @param b
 * @param time
 */
declare function lerpVector(a: Vector, b: Vector, time: number): Vector;
/**
 * Inverse of a linear interpolation, given a \`value\` in between \`a\` and \`b\` return how close to \`a\` or \`b\` the \`value\` is.
 *
 * Example: \`a=1\`, \`b=5\`, \`value=4\` will return \`.75\`
 * @param a
 * @param b
 * @param value
 */
declare function inverseLerp(a: number, b: number, value: number): number;
/**
 * Inverse of a linear interpolation, given a \`value\` in between \`a\` and \`b\` return how close to \`a\` or \`b\` the \`value\` is.
 *
 * **Warning** assumes that the \`value\` vector is co-linear with vector \`a\` and \`b\`
 *
 * Example: \`a=1\`, \`b=5\`, \`value=4\` will return \`.75\`
 * @param a
 * @param b
 * @param value
 */
declare function inverseLerpVector(a: Vector, b: Vector, value: Vector): number;
/**
 * Remaps a value from a source domain to a destination
 * @param minSource
 * @param maxSource
 * @param minDestination
 * @param maxDestination
 * @param value
 */
declare function remap(minSource: number, maxSource: number, minDestination: number, maxDestination: number, value: number): number;
/**
 * Remaps a value from a source domain to a destination
 *
 * **Warning** assumes that the \`value\` vector is co-linear with vector \`minSource\` and \`maxSource\`
 * @param minSource
 * @param maxSource
 * @param minDestination
 * @param maxDestination
 * @param value
 */
declare function remapVector(minSource: Vector, maxSource: Vector, minDestination: Vector, maxDestination: Vector, value: Vector): Vector;

interface BezierCurveOptions {
    /**
     * [start, control1, control2, end]
     */
    controlPoints: [start: Vector, control1: Vector, control2: Vector, end: Vector];
    /**
     * Quality when sampling uniform points on the curve. Samples = 4 * quality;
     *
     * For bigger 'uniform' curves you may want to increase quality
     *
     * Default 4
     */
    quality?: number;
}
/**
 * BezierCurve that supports cubic Bezier curves.
 */
declare class BezierCurve {
    private _distLookup;
    private _controlPoints;
    private _arcLength;
    readonly quality: number;
    constructor(options: BezierCurveOptions);
    get arcLength(): number;
    get controlPoints(): readonly [start: Vector, control1: Vector, control2: Vector, end: Vector];
    set controlPoints(points: [start: Vector, control1: Vector, control2: Vector, end: Vector]);
    setControlPoint(index: 0 | 1 | 2 | 3, point: Vector): void;
    private _calculateLookup;
    private _getTimeGivenDistance;
    /**
     * Get the point on the Bezier curve at a certain time
     * @param time Between 0-1
     */
    getPoint(time: number): Vector;
    /**
     * Get the tangent of the Bezier curve at a certain time
     * @param time Between 0-1
     */
    getTangent(time: number): Vector;
    /**
     * Get the tangent of the Bezier curve where the distance is uniformly distributed over time
     * @param time
     */
    getUniformTangent(time: number): Vector;
    /**
     * Get the normal of the Bezier curve at a certain time
     * @param time Between 0-1
     */
    getNormal(time: number): Vector;
    /**
     * Get the normal of the Bezier curve where the distance is uniformly distributed over time
     * @param time
     */
    getUniformNormal(time: number): Vector;
    /**
     * Points are spaced uniformly across the length of the curve over time
     * @param time
     */
    getUniformPoint(time: number): Vector;
    clone(): BezierCurve;
}

/**
 * Two PI constant
 */
declare const TwoPI: number;
/**
 * Returns the fractional part of a number
 * @param x
 */
declare function frac(x: number): number;
/**
 * Returns the sign of a number, if 0 returns 0
 */
declare function sign(val: number): number;
/**
 * Clamps a value between a min and max inclusive
 */
declare function clamp(val: number, min: number, max: number): number;
/**
 * Approximately equals
 */
declare function approximatelyEqual(val1: number, val2: number, tolerance: number): boolean;
/**
 * Convert an angle to be the equivalent in the range [0, 2PI)
 */
declare function canonicalizeAngle(angle: number): number;
/**
 * Convert radians to degrees
 */
declare function toDegrees(radians: number): number;
/**
 * Convert degrees to radians
 */
declare function toRadians(degrees: number): number;
/**
 * Generate a range of numbers
 * For example: range(0, 5) -> [0, 1, 2, 3, 4, 5]
 * @param from inclusive
 * @param to inclusive
 */
declare const range: (from: number, to: number) => number[];
/**
 * Find a random floating point number in range
 */
declare function randomInRange(min: number, max: number, random?: Random): number;
/**
 * Find a random integer in a range
 */
declare function randomIntInRange(min: number, max: number, random?: Random): number;

/**
 * A unique identifier for a graph node or edge.
 */
type G_UUID = string & {
    readonly __brand: unique symbol;
};
interface EdgeOptionsWithWeight {
    weight: number;
    useEuclidean?: false;
    /**
     * Whether the edge is directed.
     * @default false
     */
    directed?: boolean;
}
interface EdgeOptionsWeightless {
    weight?: undefined;
    useEuclidean?: false | undefined;
    /**
     * Whether the edge is directed.
     * @default false
     */
    directed?: boolean;
}
interface EdgeOptionsWithEuclidean {
    weight?: undefined;
    useEuclidean: true;
    /**
     * Whether the edge is directed.
     * @default false
     */
    directed?: boolean;
}
/**
 * Options for creating a new edge in the graph.
 */
type EdgeOptions = EdgeOptionsWithWeight | EdgeOptionsWithEuclidean | EdgeOptionsWeightless;
/**
 * A weighted graph data structure.
 * @template T The type of data stored in each node.
 */
declare class Graph<T> {
    private _nodes;
    private _edges;
    adjacencyList: Map<G_UUID, Set<G_UUID>>;
    id: G_UUID;
    /**
     * Constructs a new graph data structure.
     *
     * This constructor initializes an empty graph with no nodes or edges.
     */
    constructor();
    /**
     * Adds a new node to the graph with the given data.
     * @returns The newly created node.
     */
    addNode(data: T, position?: Vector): Node<T> | PositionNode<T>;
    /**
     * Adds multiple new nodes to the graph with the given data.
     * @returns A map of all nodes in the graph, including the newly created ones.
     */
    addNodes(nodes: T[]): Map<G_UUID, Node<T>>;
    /**
     * Deletes a node from the graph along with all its associated edges.
     * This method removes the specified node and any edges connected to it
     * from the graph. It updates the internal structures to reflect these
     * changes.
     * @param node - The node to be deleted from the graph.
     * @returns A map of all remaining nodes in the graph.
     */
    deleteNode(node: Node<T>): Map<G_UUID, Node<T>>;
    /**
     * Adds a new edge between two nodes in the graph. If the edge already exists, it does not add a duplicate.
     * The function allows specifying edge options such as weight and directionality. For undirected edges,
     * it creates a duplicate edge in the reverse direction and links both edges as partners.
     * @param from - The source node of the edge.
     * @param to - The target node of the edge.
     * @param options - Optional settings for the edge, including weight and directionality.
     * @returns An array containing the created edge(s). If the edge is directed, the array contains one edge;
     *          if undirected, it contains both the original and the duplicate edge.
     */
    addEdge(from: Node<T>, to: Node<T>, options?: EdgeOptions): Edge<T>[];
    /**
     * Deletes an edge from the graph.
     *
     * This method removes the specified edge and its partner edge (if any) from the graph.
     * It updates the internal edge set and edge list accordingly. The source and target
     * nodes of the edge are also updated to reflect the removal of the edge.
     * @param edge - The edge to be deleted from the graph.
     */
    deleteEdge(edge: Edge<T>): void;
    /**
     * The set of nodes in the graph, keyed by their UUID.
     *
     * The map returned by this property is a shallow copy of the internal map.
     * The nodes in this map are not frozen, and may be modified by the caller.
     * @returns A shallow copy of the graph's internal node map.
     */
    get nodes(): Map<G_UUID, Node<T>>;
    /**
     * Gets a node by its UUID.
     * @param id - The UUID of the node to be retrieved.
     * @returns The node with the specified UUID, or undefined if no such node exists.
     */
    getNode(id: G_UUID): Node<T>;
    /**
     * Retrieves the set of edges in the graph.
     *
     * The returned set is a shallow copy of the internal edge set.
     * Modifications to this set do not affect the graph's internal state.
     * @returns A set containing all edges in the graph.
     */
    get edges(): Set<Edge<T>>;
    /**
     * Gets the neighbors of the given node.
     *
     * The returned array contains all of the nodes that are directly connected to the given node.
     * @param node - The node whose neighbors should be retrieved.
     * @returns An array of nodes that are directly connected to the given node.
     */
    getNeighbors(node: Node<T>): Node<T>[];
    /**
     * Checks if two nodes are connected by an edge.
     * @param node1 - The first node to check.
     * @param node2 - The second node to check.
     * @returns true if the nodes are connected, false if not.
     */
    areNodesConnected(node1: Node<T>, node2: Node<T>): boolean;
    /**
     * Performs a breadth-first search (BFS) on the graph starting from the given node.
     *
     * This method explores the graph layer by layer, starting from the specified node.
     * It visits all nodes that are directly connected to the start node before moving
     * on to the nodes at the next level of the graph.
     * @param startNode - The node to start the BFS from.
     * @returns An array of UUIDs representing the nodes that were visited during the search.
     *          The order of the nodes in the array corresponds to the order in which they
     *          were visited.
     */
    bfs(startNode: Node<T>): G_UUID[];
    /**
     * Performs a depth-first search (DFS) on the graph starting from the given node.
     *
     * This method explores the graph by traversing as far as possible along each
     * branch before backtracking. It visits all nodes that are reachable from the
     * start node.
     * @param startNode - The node to start the DFS from.
     * @param [visited] - A set of node IDs that have already been visited during
     *                    the search. This parameter is optional, and defaults to an
     *                    empty set.
     * @returns An array of UUIDs representing the nodes that were visited during the
     *          search. The order of the nodes in the array corresponds to the order
     *          in which they were visited.
     */
    dfs(startNode: Node<T>, visited?: Set<string>): G_UUID[];
    /**
     * Creates a new graph from an array of nodes, and adds them all to the graph.
     * @param nodes - The array of nodes to add to the graph.
     * @returns The newly created graph.
     */
    static createGraphFromNodes<T>(nodes: T[]): Graph<T>;
    /**
     * Finds the shortest path between two nodes in the graph using Dijkstra's algorithm.
     *
     * This method calculates the shortest path from the specified start node to the
     * specified end node in the graph. It returns an object containing the path and
     * the total distance of the path.
     * @param startNode - The node from which the search for the shortest path begins.
     * @param endNode - The node where the search for the shortest path ends.
     * @returns An object containing:
     *   - \`path\`: An array of nodes representing the shortest path from startNode to endNode.
     *     If no path is found, this will be \`null\`.
     *   - \`distance\`: The total distance of the shortest path. If no path is found, this will
     *     be \`Infinity\`.
     */
    dijkstra(sourcenode: Node<T>): Array<{
        node: Node<T>;
        distance: number;
        previous: Node<T> | null;
    }>;
    /**
     * Finds the shortest path between two nodes in the graph using the Dijkstra method
     *
     * This method calculates the shortest path from the specified start node to the
     * specified end node in the graph. It returns an object containing the path and
     * the total distance of the path.
     * @param startingNode - The node from which the search for the shortest path begins.
     * @param endNode - The node where the search for the shortest path ends.
     * @returns An object containing:
     *   - \`path\`: An array of nodes representing the shortest path from startNode to endNode.
     *     If no path is found, this will be \`null\`.
     *   - \`distance\`: The total distance of the shortest path. If no path is found, this will
     *     be \`Infinity\`.
     */
    shortestPathDijkstra(startingNode: Node<T>, endNode: Node<T>): {
        path: Node<T>[];
        distance: number;
    };
    /**
     * Finds the shortest path between two nodes in the graph using the A* algorithm.
     *
     * This method calculates the shortest path from the specified start node to the
     * specified end node in the graph. It returns an object containing the path and
     * the total distance of the path.
     * @param startNode - The node from which the search for the shortest path begins.
     * @param endNode - The node where the search for the shortest path ends.
     * @returns An object containing:
     *   - \`path\`: An array of nodes representing the shortest path from startNode to endNode.
     *     If no path is found, this will be \`null\`.
     *   - \`distance\`: The total distance of the shortest path. If no path is found, this will
     *     be \`Infinity\`.
     *   - \`skippedNodes\`: A set of all nodes that were skipped during the search (because they
     *     were not \`PositionNode\`s).
     */
    aStar(startNode: PositionNode<T>, endNode: PositionNode<T>): {
        path: PositionNode<T>[] | null;
        pathSteps: number;
        distance: number;
        skippedNodes: Set<G_UUID>;
    };
    private _euclideanDistance;
}
/**
 * Represents an edge in a graph, connecting two nodes.
 * @template T The type of data stored in the nodes connected by this edge.
 */
declare class Edge<T> {
    private _id;
    private _source;
    private _target;
    private _weight;
    private _partnerEdge;
    constructor(source: Node<T>, target: Node<T>, config?: EdgeOptions);
    linkWithPartner(partnerEdge: Edge<T>): void;
    get id(): G_UUID;
    get source(): Node<T>;
    get target(): Node<T>;
    get weight(): number;
    get partnerEdge(): Edge<T>;
}
/**
 * Represents a node in a graph, with a unique identifier and optional data.
 * @template T The type of data stored in this node.
 */
declare class Node<T> {
    private _id;
    private _data;
    private _edges;
    constructor(data: T);
    get id(): G_UUID;
    get data(): T;
    get edges(): Set<Edge<T>>;
    registerNewEdge(newEdge: Edge<T>): void;
    breakEdge(edge: Edge<T>): void;
    getConnectedNodes(): Node<T>[];
}
/**
 * Represents a node in a graph with a unique identifier, optional data, and a position in space.
 * @template T The type of data stored in this node.
 * @augments {Node<T>}
 */
declare class PositionNode<T> extends Node<T> {
    pos: Vector;
    constructor(data: T, pos: Vector);
}

interface RotateToOptions {
    /**
     * Absolute angle to rotate to in radians
     */
    angle: number;
    /**
     * Duration to take in milliseconds
     */
    duration: number;
    /**
     * Optionally provide type of rotation, default is RotationType.ShortestPath
     */
    rotationType?: RotationType;
}
/**
 *
 */
declare function isRotateToOptions(x: any): x is RotateToOptions;
declare class RotateToWithOptions implements Action {
    entity: Entity;
    id: number;
    private _durationMs;
    private _tx;
    private _started;
    private _currentMs;
    private _stopped;
    private _motion;
    private _endAngle;
    private _startAngle;
    private _rotationType;
    constructor(entity: Entity, options: RotateToOptions);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    stop(): void;
    reset(): void;
}
declare class RotateTo implements Action {
    id: number;
    private _tx;
    private _motion;
    x: number;
    y: number;
    private _start;
    private _end;
    private _speed;
    private _rotationType;
    private _direction;
    private _distance;
    private _shortDistance;
    private _longDistance;
    private _shortestPathIsPositive;
    private _currentNonCannonAngle;
    private _started;
    private _stopped;
    constructor(entity: Entity, angle: number, speed: number, rotationType?: RotationType);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

interface RotateByOptions {
    /**
     * Angle in radians to offset from the current and rotate
     */
    angleRadiansOffset: number;
    /**
     * Duration to take in milliseconds
     */
    duration: number;
    /**
     * Optionally provide type of rotation, default is RotationType.ShortestPath
     */
    rotationType?: RotationType;
}
/**
 *
 */
declare function isRotateByOptions(x: any): x is RotateByOptions;
declare class RotateByWithOptions implements Action {
    entity: Entity;
    id: number;
    private _durationMs;
    private _tx;
    private _started;
    private _currentMs;
    private _stopped;
    private _motion;
    private _offset;
    private _startAngle;
    private _rotationType;
    private _endAngle;
    constructor(entity: Entity, options: RotateByOptions);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}
declare class RotateBy implements Action {
    id: number;
    private _tx;
    private _motion;
    x: number;
    y: number;
    private _start;
    private _end;
    private _speed;
    private _offset;
    private _rotationType;
    private _direction;
    private _distance;
    private _shortDistance;
    private _longDistance;
    private _shortestPathIsPositive;
    private _currentNonCannonAngle;
    private _started;
    private _stopped;
    constructor(entity: Entity, angleRadiansOffset: number, speed: number, rotationType?: RotationType);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

interface ScaleToOptions {
    /**
     * Absolute scale to change to
     */
    scale: Vector;
    /**
     * Duration to take in milliseconds
     */
    duration: number;
}
/**
 *
 */
declare function isScaleToOptions(x: any): x is ScaleToOptions;
declare class ScaleToWithOptions implements Action {
    entity: Entity;
    id: number;
    private _durationMs;
    private _tx;
    private _started;
    private _currentMs;
    private _stopped;
    private _motion;
    private _endScale;
    private _startScale;
    constructor(entity: Entity, options: ScaleToOptions);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}
declare class ScaleTo implements Action {
    id: number;
    private _tx;
    private _motion;
    x: number;
    y: number;
    private _startX;
    private _startY;
    private _endX;
    private _endY;
    private _speedX;
    private _speedY;
    private _distanceX;
    private _distanceY;
    private _started;
    private _stopped;
    constructor(entity: Entity, scaleX: number, scaleY: number, speedX: number, speedY: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

interface ScaleByOptions {
    /**
     * Absolute scale to change to
     */
    scaleOffset: Vector;
    /**
     * Duration to take in milliseconds
     */
    duration: number;
}
/**
 *
 */
declare function isScaleByOptions(x: any): x is ScaleByOptions;
declare class ScaleByWithOptions implements Action {
    entity: Entity;
    id: number;
    private _durationMs;
    private _tx;
    private _started;
    private _currentMs;
    private _stopped;
    private _motion;
    private _endScale;
    private _scaleOffset;
    private _startScale;
    constructor(entity: Entity, options: ScaleByOptions);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}
declare class ScaleBy implements Action {
    id: number;
    private _tx;
    private _motion;
    x: number;
    y: number;
    private _startScale;
    private _endScale;
    private _offset;
    private _distanceX;
    private _distanceY;
    private _directionX;
    private _directionY;
    private _started;
    private _stopped;
    private _speedX;
    private _speedY;
    constructor(entity: Entity, scaleOffsetX: number, scaleOffsetY: number, speed: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

interface CurveToOptions {
    /**
     * Bezier Curve in world coordinates to animate towards
     *
     * The start control point is assumed to be the actor's current position
     */
    controlPoints: [control1: Vector, control2: Vector, end: Vector];
    /**
     * Total duration for the action to run
     */
    duration: number;
    /**
     * Dynamic mode will speed up/slow down depending on the curve
     *
     * Uniform mode will animate at a consistent velocity across the curve
     *
     * Default: 'dynamic'
     */
    mode?: 'dynamic' | 'uniform';
    /**
     * Quality when sampling uniform points on the curve. Samples = 4 * quality;
     *
     * For bigger 'uniform' curves you may want to increase quality
     *
     * Default 4
     */
    quality?: number;
}
declare class CurveTo implements Action {
    id: number;
    private _curve;
    private _durationMs;
    private _entity;
    private _tx;
    private _currentMs;
    private _started;
    private _stopped;
    private _mode;
    constructor(entity: Entity, options: CurveToOptions);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    reset(): void;
    stop(): void;
}

interface CurveByOptions {
    /**
     * Bezier Curve relative to the current actor position to move
     */
    controlPoints: [control1: Vector, control2: Vector, end: Vector];
    /**
     * Total duration for the action to run
     */
    duration: number;
    /**
     * Dynamic mode will speed up/slow down depending on the curve
     *
     * Uniform mode will animate at a consistent velocity across the curve
     *
     * Default: 'dynamic'
     */
    mode?: 'dynamic' | 'uniform';
    /**
     * Quality when sampling uniform points on the curve. Samples = 4 * quality;
     *
     * For bigger 'uniform' curves you may want to increase quality to make the motion appear smooth
     *
     * Default 4
     */
    quality?: number;
}
declare class CurveBy implements Action {
    id: number;
    private _curve;
    private _durationMs;
    private _entity;
    private _tx;
    private _currentMs;
    private _started;
    private _stopped;
    private _mode;
    constructor(entity: Entity, options: CurveByOptions);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    reset(): void;
    stop(): void;
}

/**
 * The fluent Action API allows you to perform "actions" on
 * {@apilink Actor | \`actors\`} such as following, moving, rotating, and
 * more. You can implement your own actions by implementing
 * the {@apilink Action} interface.
 */
declare class ActionContext {
    private _entity;
    private _queue;
    constructor(entity: Entity);
    getQueue(): ActionQueue;
    update(elapsed: number): void;
    /**
     * Clears all queued actions from the Actor
     */
    clearActions(): void;
    runAction(action: Action): this;
    /**
     * Animates an actor with a specified bezier curve by an offset to the current position, the start point is assumed
     * to be the actors current position
     * @param options
     */
    curveBy(options: CurveByOptions): ActionContext;
    /**
     * Animates an actor with a specified bezier curve to an absolute world space coordinate, the start point is assumed
     * to be the actors current position
     * @param options
     */
    curveTo(options: CurveToOptions): ActionContext;
    /**
     * This method will move an actor to the specified \`x\` and \`y\` position over the
     * specified duration using a given {@apilink EasingFunctions} and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param pos       The x,y vector location to move the actor to
     * @param duration  The time it should take the actor to move to the new location in milliseconds
     * @param easingFcn Use {@apilink EasingFunction} or a custom function to use to calculate position, Default is {@apilink EasingFunctions.Linear}
     * @deprecated use new moveTo({pos: Vector, duration: number, easing: EasingFunction})
     */
    easeTo(pos: Vector, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     * This method will move an actor to the specified \`x\` and \`y\` position over the
     * specified duration using a given {@apilink EasingFunctions} and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param x         The x location to move the actor to
     * @param y         The y location to move the actor to
     * @param duration  The time it should take the actor to move to the new location in milliseconds
     * @param easingFcn Use {@apilink EasingFunction} or a custom function to use to calculate position, Default is {@apilink EasingFunctions.Linear}
     * @deprecated use new moveTo({pos: Vector, duration: number, easing: EasingFunction})
     */
    easeTo(x: number, y: number, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     * This method will move an actor by a specified vector offset relative to the current position given
     * a duration and a {@apilink EasingFunction}. This method is part of the actor 'Action' fluent API allowing action chaining.
     * @param offset Vector offset relative to the current position
     * @param duration The duration in milliseconds
     * @param easingFcn Use {@apilink EasingFunction} or a custom function to use to calculate position, Default is {@apilink EasingFunctions.Linear}
     * @deprecated use new moveBy({offset: Vector, duration: number, easing: EasingFunction})
     */
    easeBy(offset: Vector, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     * This method will move an actor by a specified x and y offset relative to the current position given
     * a duration and a {@apilink EasingFunction}. This method is part of the actor 'Action' fluent API allowing action chaining.
     * @param offset Vector offset relative to the current position
     * @param duration The duration in milliseconds
     * @param easingFcn Use {@apilink EasingFunction} or a custom function to use to calculate position, Default is {@apilink EasingFunctions.Linear}
     * @deprecated use new moveBy({offset: Vector, duration: number, easing: EasingFunction})
     */
    easeBy(offsetX: number, offsetY: number, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     * Moves an actor to a specified {@link Vector} in a given duration in milliseconds.
     * You may optionally specify an {@link EasingFunction}
     * @param options
     */
    moveTo(options: MoveToOptions): ActionContext;
    /**
     * This method will move an actor to the specified x and y position at the
     * speed specified (in pixels per second) and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param pos    The x,y vector location to move the actor to
     * @param speed  The speed in pixels per second to move
     */
    moveTo(pos: Vector, speed: number): ActionContext;
    /**
     * This method will move an actor to the specified x and y position at the
     * speed specified (in pixels per second) and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param x      The x location to move the actor to
     * @param y      The y location to move the actor to
     * @param speed  The speed in pixels per second to move
     */
    moveTo(x: number, y: number, speed: number): ActionContext;
    /**
     * Moves an actor by a specified offset {@link Vector} in a given duration in milliseconds.
     * You may optionally specify an {@link EasingFunction}
     * @param options
     */
    moveBy(options: MoveByOptions): ActionContext;
    /**
     * This method will move an actor by the specified x offset and y offset from its current position, at a certain speed.
     * This method is part of the actor 'Action' fluent API allowing action chaining.
     * @param xOffset     The x offset to apply to this actor
     * @param yOffset     The y location to move the actor to
     * @param speed  The speed in pixels per second the actor should move
     */
    moveBy(offset: Vector, speed: number): ActionContext;
    moveBy(xOffset: number, yOffset: number, speed: number): ActionContext;
    /**
     * Rotates an actor to a specified angle over a duration in milliseconds,
     * you make pick a rotation strategy {@link RotationType} to pick the direction
     * @param options
     */
    rotateTo(options: RotateToOptions): ActionContext;
    /**
     * This method will rotate an actor to the specified angle at the speed
     * specified (in radians per second) and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param angle  The angle to rotate to in radians
     * @param speed         The angular velocity of the rotation specified in radians per second
     * @param rotationType  The {@apilink RotationType} to use for this rotation
     */
    rotateTo(angle: number, speed: number, rotationType?: RotationType): ActionContext;
    /**
     * Rotates an actor by a specified offset angle over a duration in milliseconds,
     * you make pick a rotation strategy {@link RotationType} to pick the direction
     * @param options
     */
    rotateBy(options: RotateByOptions): ActionContext;
    /**
     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed
     * in radians/sec and return back the actor. This method is part
     * of the actor 'Action' fluent API allowing action chaining.
     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation
     * @param speed          The speed in radians/sec the actor should rotate at
     * @param rotationType  The {@apilink RotationType} to use for this rotation, default is shortest path
     */
    rotateBy(angleRadiansOffset: number, speed: number, rotationType?: RotationType): ActionContext;
    /**
     * Scales an actor to a specified scale {@link Vector} over a duration in milliseconds
     * @param options
     */
    scaleTo(options: ScaleToOptions): ActionContext;
    /**
     * This method will scale an actor to the specified size at the speed
     * specified (in magnitude increase per second) and return back the
     * actor. This method is part of the actor 'Action' fluent API allowing
     * action chaining.
     * @param size    The scale to adjust the actor to over time
     * @param speed   The speed of scaling specified in magnitude increase per second
     */
    scaleTo(size: Vector, speed: Vector): ActionContext;
    /**
     * This method will scale an actor to the specified size at the speed
     * specified (in magnitude increase per second) and return back the
     * actor. This method is part of the actor 'Action' fluent API allowing
     * action chaining.
     * @param sizeX   The scaling factor to apply on X axis
     * @param sizeY   The scaling factor to apply on Y axis
     * @param speedX  The speed of scaling specified in magnitude increase per second on X axis
     * @param speedY  The speed of scaling specified in magnitude increase per second on Y axis
     */
    scaleTo(sizeX: number, sizeY: number, speedX: number, speedY: number): ActionContext;
    /**
     * Scales an actor by a specified scale offset {@link Vector} over a duration in milliseconds
     * @param options
     */
    scaleBy(options: ScaleByOptions): ActionContext;
    /**
     * This method will scale an actor by an amount relative to the current scale at a certain speed in scale units/sec
     * and return back the actor. This method is part of the
     * actor 'Action' fluent API allowing action chaining.
     * @param offset   The scaling factor to apply to the actor
     * @param speed    The speed to scale at in scale units/sec
     */
    scaleBy(offset: Vector, speed: number): ActionContext;
    /**
     * This method will scale an actor by an amount relative to the current scale at a certain speed in scale units/sec
     * and return back the actor. This method is part of the
     * actor 'Action' fluent API allowing action chaining.
     * @param sizeOffsetX   The scaling factor to apply on X axis
     * @param sizeOffsetY   The scaling factor to apply on Y axis
     * @param speed    The speed to scale at in scale units/sec
     */
    scaleBy(sizeOffsetX: number, sizeOffsetY: number, speed: number): ActionContext;
    /**
     * This method will cause an actor to blink (become visible and not
     * visible). Optionally, you may specify the number of blinks. Specify the amount of time
     * the actor should be visible per blink, and the amount of time not visible.
     * This method is part of the actor 'Action' fluent API allowing action chaining.
     * @param timeVisible     The amount of time to stay visible per blink in milliseconds
     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds
     * @param numBlinks       The number of times to blink
     */
    blink(timeVisible: number, timeNotVisible: number, numBlinks?: number): ActionContext;
    /**
     * This method will cause an actor's opacity to change from its current value
     * to the provided value by a specified time (in milliseconds). This method is
     * part of the actor 'Action' fluent API allowing action chaining.
     * @param opacity  The ending opacity
     * @param duration     The time it should take to fade the actor (in milliseconds)
     */
    fade(opacity: number, duration: number): ActionContext;
    /**
     * This will cause an actor to flash a specific color for a period of time
     * @param color
     * @param duration The duration in milliseconds
     */
    flash(color: Color, duration?: number): this;
    /**
     * This method will delay the next action from executing for a certain
     * amount of time (in milliseconds). This method is part of the actor
     * 'Action' fluent API allowing action chaining.
     * @param duration  The amount of time to delay the next action in the queue from executing in milliseconds
     */
    delay(duration: number): ActionContext;
    /**
     * This method will add an action to the queue that will remove the actor from the
     * scene once it has completed its previous  Any actions on the
     * action queue after this action will not be executed.
     */
    die(): ActionContext;
    /**
     * This method allows you to call an arbitrary method as the next action in the
     * action queue. This is useful if you want to execute code in after a specific
     * action, i.e An actor arrives at a destination after traversing a path
     */
    callMethod(method: () => any): ActionContext;
    /**
     * This method will cause the actor to repeat all of the actions built in
     * the \`repeatBuilder\` callback. If the number of repeats
     * is not specified it will repeat forever. This method is part of
     * the actor 'Action' fluent API allowing action chaining
     *
     * \`\`\`typescript
     * // Move up in a zig-zag by repeated moveBy's
     * actor.actions.repeat(repeatCtx => {
     * repeatCtx.moveBy(10, 0, 10);
     * repeatCtx.moveBy(0, 10, 10);
     * }, 5);
     * \`\`\`
     * @param repeatBuilder The builder to specify the repeatable list of actions
     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions
     * will repeat forever
     */
    repeat(repeatBuilder: (repeatContext: ActionContext) => any, times?: number): ActionContext;
    /**
     * This method will cause the actor to repeat all of the actions built in
     * the \`repeatBuilder\` callback. If the number of repeats
     * is not specified it will repeat forever. This method is part of
     * the actor 'Action' fluent API allowing action chaining
     *
     * \`\`\`typescript
     * // Move up in a zig-zag by repeated moveBy's
     * actor.actions.repeat(repeatCtx => {
     * repeatCtx.moveBy(10, 0, 10);
     * repeatCtx.moveBy(0, 10, 10);
     * }, 5);
     * \`\`\`
     * @param repeatBuilder The builder to specify the repeatable list of actions
     */
    repeatForever(repeatBuilder: (repeatContext: ActionContext) => any): ActionContext;
    /**
     * This method will cause the entity to follow another at a specified distance
     * @param entity           The entity to follow
     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.
     */
    follow(entity: Entity, followDistance?: number): ActionContext;
    /**
     * This method will cause the entity to move towards another until they
     * collide "meet" at a specified speed.
     * @param entity  The entity to meet
     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor
     * @param tolerance  The tolerance in pixels to meet, if not specified it will be 1 pixel
     */
    meet(entity: Entity, speed?: number, tolerance?: number): ActionContext;
    /**
     * Returns a promise that resolves when the current action queue up to now
     * is finished.
     */
    toPromise(): Promise<void>;
}

interface Actionable {
    actions: ActionContext;
}

/**
 * Action that can represent a sequence of actions, this can be useful in conjunction with
 * {@apilink ParallelActions} to run multiple sequences in parallel.
 */
declare class ActionSequence implements Action {
    id: number;
    private _actionQueue;
    private _stopped;
    private _sequenceContext;
    private _sequenceBuilder;
    constructor(entity: Entity, actionBuilder: (actionContext: ActionContext) => any);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
    clone(entity: Entity): ActionSequence;
}

/**
 * Action that can run multiple {@apilink Action}s or {@apilink ActionSequence}s at the same time
 */
declare class ParallelActions implements Action {
    id: number;
    private _actions;
    constructor(parallelActions: Action[]);
    update(elapsed: number): void;
    isComplete(entity: Entity): boolean;
    reset(): void;
    stop(): void;
}

declare class Repeat implements Action {
    id: number;
    private _actionQueue;
    private _repeat;
    private _originalRepeat;
    private _stopped;
    private _repeatContext;
    private _repeatBuilder;
    constructor(entity: Entity, repeatBuilder: (repeatContext: ActionContext) => any, repeat: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

/**
 * RepeatForever Action implementation, it is recommended you use the fluent action
 * context API.
 *
 *
 */
declare class RepeatForever implements Action {
    id: number;
    private _actionQueue;
    private _stopped;
    private _repeatContext;
    private _repeatBuilder;
    constructor(entity: Entity, repeatBuilder: (repeatContext: ActionContext) => any);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

declare class Blink implements Action {
    id: number;
    private _graphics;
    private _timeVisible;
    private _timeNotVisible;
    private _elapsedTime;
    private _totalTime;
    private _duration;
    private _stopped;
    private _started;
    constructor(entity: Entity, timeVisible: number, timeNotVisible: number, numBlinks?: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

declare class Die implements Action {
    id: number;
    private _entity;
    private _stopped;
    constructor(entity: Entity);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

/**
 * @deprecated use moveTo({pos: Vector, duration: number, easing: EasingFunction})
 */
declare class EaseTo implements Action {
    easingFcn: (currentTime: number, startValue: number, endValue: number, duration: number) => number;
    id: number;
    private _tx;
    private _motion;
    private _currentLerpTime;
    private _lerpDuration;
    private _lerpStart;
    private _lerpEnd;
    private _initialized;
    private _stopped;
    constructor(entity: Entity, x: number, y: number, duration: number, easingFcn: (currentTime: number, startValue: number, endValue: number, duration: number) => number);
    private _initialize;
    update(elapsed: number): void;
    isComplete(): boolean;
    reset(): void;
    stop(): void;
}

/**
 * @deprecated use moveBy({offset: Vector, duration: number, easing: EasingFunction})
 */
declare class EaseBy implements Action {
    easingFcn: (currentTime: number, startValue: number, endValue: number, duration: number) => number;
    id: number;
    private _tx;
    private _motion;
    private _currentLerpTime;
    private _lerpDuration;
    private _lerpStart;
    private _lerpEnd;
    private _offset;
    private _initialized;
    private _stopped;
    constructor(entity: Entity, offsetX: number, offsetY: number, duration: number, easingFcn: (currentTime: number, startValue: number, endValue: number, duration: number) => number);
    private _initialize;
    update(elapsed: number): void;
    isComplete(): boolean;
    reset(): void;
    stop(): void;
}

declare class Fade implements Action {
    id: number;
    private _graphics;
    private _endOpacity;
    private _remainingTime;
    private _originalTime;
    private _multiplier;
    private _started;
    private _stopped;
    constructor(entity: Entity, endOpacity: number, duration: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

declare class Follow implements Action {
    id: number;
    private _tx;
    private _motion;
    private _followTx;
    private _followMotion;
    x: number;
    y: number;
    private _current;
    private _end;
    private _dir;
    private _speed;
    private _maximumDistance;
    private _distanceBetween;
    private _started;
    private _stopped;
    constructor(entity: Entity, entityToFollow: Entity, followDistance?: number);
    update(elapsed: number): void;
    stop(): void;
    isComplete(): boolean;
    reset(): void;
}

declare class Meet implements Action {
    id: number;
    private _tx;
    private _motion;
    private _meetTx;
    private _meetMotion;
    x: number;
    y: number;
    private _current;
    private _end;
    private _dir;
    private _speed;
    private _distanceBetween;
    private _started;
    private _stopped;
    private _speedWasSpecified;
    private _tolerance;
    constructor(actor: Entity, actorToMeet: Entity, speed?: number, tolerance?: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

declare class Delay implements Action {
    id: number;
    private _elapsedTime;
    private _delay;
    private _started;
    private _stopped;
    constructor(duration: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

declare class Flash implements Action {
    id: number;
    private _graphics;
    private _duration;
    private _stopped;
    private _started;
    private _entity;
    private _material;
    private _total;
    private _currentDuration;
    constructor(entity: Entity, color: Color, duration?: number);
    update(elapsed: number): void;
    isComplete(): boolean;
    stop(): void;
    reset(): void;
}

declare class ActionsSystem extends System {
    world: World;
    static priority: -5;
    systemType: SystemType;
    private _actions;
    query: Query<typeof ActionsComponent>;
    constructor(world: World);
    update(elapsed: number): void;
}

interface ActionContextMethods extends Pick<ActionContext, keyof ActionContext> {
}
declare class ActionsComponent extends Component implements ActionContextMethods {
    dependencies: (typeof TransformComponent | typeof MotionComponent)[];
    private _ctx;
    onAdd(entity: Entity): void;
    onRemove(): void;
    private _getCtx;
    /**
     * Returns the internal action queue
     * @returns action queue
     */
    getQueue(): ActionQueue;
    /**
     * Runs a specific action in the action queue
     * @param action
     */
    runAction(action: Action): ActionContext;
    /**
     * Updates the internal action context, performing action and moving through the internal queue
     * @param elapsed
     */
    update(elapsed: number): void;
    /**
     * Clears all queued actions from the Actor
     */
    clearActions(): void;
    /**
     * Animates an actor with a specified bezier curve by an offset to the current position, the start point is assumed
     * to be the actors current position
     * @param options
     */
    curveBy(options: CurveByOptions): ActionContext;
    /**
     * Animates an actor with a specified bezier curve to an absolute world space coordinate, the start point is assumed
     * to be the actors current position
     * @param options
     */
    curveTo(options: CurveToOptions): ActionContext;
    /**
     * This method will move an actor to the specified \`x\` and \`y\` position over the
     * specified duration using a given {@apilink EasingFunctions} and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param pos       The x,y vector location to move the actor to
     * @param duration  The time it should take the actor to move to the new location in milliseconds
     * @param easingFcn Use {@apilink EasingFunctions} or a custom function to use to calculate position, Default is {@apilink EasingFunctions.Linear}
     * @deprecated use new moveTo({pos: Vector, duration: number, easing: EasingFunction})
     */
    easeTo(pos: Vector, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     * This method will move an actor to the specified \`x\` and \`y\` position over the
     * specified duration using a given {@apilink EasingFunctions} and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param x         The x location to move the actor to
     * @param y         The y location to move the actor to
     * @param duration  The time it should take the actor to move to the new location in milliseconds
     * @param easingFcn Use {@apilink EasingFunctions} or a custom function to use to calculate position, Default is {@apilink EasingFunctions.Linear}
     * @deprecated use new moveTo({pos: Vector, duration: number, easing: EasingFunction})
     */
    easeTo(x: number, y: number, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     *
     * @param offset
     * @param duration
     * @param easingFcn
     * @deprecated use new moveBy({pos: Vector, duration: number, easing: EasingFunction})
     */
    easeBy(offset: Vector, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     *
     * @param offsetX
     * @param offsetY
     * @param duration
     * @param easingFcn
     * @deprecated use new moveBy({pos: Vector, duration: number, easing: EasingFunction})
     */
    easeBy(offsetX: number, offsetY: number, duration: number, easingFcn?: EasingFunction): ActionContext;
    /**
     * Moves an actor to a specified {@link Vector} in a given duration in milliseconds.
     * You may optionally specify an {@link EasingFunction}
     * @param options
     */
    moveTo(options: MoveToOptions): ActionContext;
    /**
     * This method will move an actor to the specified x and y position at the
     * speed specified (in pixels per second) and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param pos    The x,y vector location to move the actor to
     * @param speed  The speed in pixels per second to move
     */
    moveTo(pos: Vector, speed: number): ActionContext;
    /**
     * This method will move an actor to the specified x and y position at the
     * speed specified (in pixels per second) and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param x      The x location to move the actor to
     * @param y      The y location to move the actor to
     * @param speed  The speed in pixels per second to move
     */
    moveTo(x: number, y: number, speed: number): ActionContext;
    /**
     * Moves an actor by a specified offset {@link Vector} in a given duration in milliseconds.
     * You may optionally specify an {@link EasingFunction}
     * @param options
     */
    moveBy(options: MoveByOptions): ActionContext;
    /**
     * This method will move an actor by the specified x offset and y offset from its current position, at a certain speed.
     * This method is part of the actor 'Action' fluent API allowing action chaining.
     * @param offset The (x, y) offset to apply to this actor
     * @param speed  The speed in pixels per second the actor should move
     */
    moveBy(offset: Vector, speed: number): ActionContext;
    /**
     * This method will move an actor by the specified x offset and y offset from its current position, at a certain speed.
     * This method is part of the actor 'Action' fluent API allowing action chaining.
     * @param xOffset     The x offset to apply to this actor
     * @param yOffset     The y location to move the actor to
     * @param speed  The speed in pixels per second the actor should move
     */
    moveBy(xOffset: number, yOffset: number, speed: number): ActionContext;
    /**
     * Rotates an actor to a specified angle over a duration in milliseconds,
     * you make pick a rotation strategy {@link RotationType} to pick the direction
     * @param options
     */
    rotateTo(options: RotateToOptions): ActionContext;
    /**
     * This method will rotate an actor to the specified angle at the speed
     * specified (in radians per second) and return back the actor. This
     * method is part of the actor 'Action' fluent API allowing action chaining.
     * @param angle  The angle to rotate to in radians
     * @param speed         The angular velocity of the rotation specified in radians per second
     * @param rotationType  The {@apilink RotationType} to use for this rotation
     */
    rotateTo(angle: number, speed: number, rotationType?: RotationType): ActionContext;
    /**
     * Rotates an actor by a specified offset angle over a duration in milliseconds,
     * you make pick a rotation strategy {@link RotationType} to pick the direction
     * @param options
     */
    rotateBy(options: RotateByOptions): ActionContext;
    /**
     * This method will rotate an actor by the specified angle offset, from it's current rotation given a certain speed
     * in radians/sec and return back the actor. This method is part
     * of the actor 'Action' fluent API allowing action chaining.
     * @param angleRadiansOffset  The angle to rotate to in radians relative to the current rotation
     * @param speed          The speed in radians/sec the actor should rotate at
     * @param rotationType  The {@apilink RotationType} to use for this rotation, default is shortest path
     */
    rotateBy(angleRadiansOffset: number, speed: number, rotationType?: RotationType): ActionContext;
    /**
     * Scales an actor to a specified scale {@link Vector} over a duration
     * @param options
     */
    scaleTo(options: ScaleToOptions): ActionContext;
    /**
     * This method will scale an actor to the specified size at the speed
     * specified (in magnitude increase per second) and return back the
     * actor. This method is part of the actor 'Action' fluent API allowing
     * action chaining.
     * @param size    The scale to adjust the actor to over time
     * @param speed   The speed of scaling specified in magnitude increase per second
     */
    scaleTo(size: Vector, speed: Vector): ActionContext;
    /**
     * This method will scale an actor to the specified size at the speed
     * specified (in magnitude increase per second) and return back the
     * actor. This method is part of the actor 'Action' fluent API allowing
     * action chaining.
     * @param sizeX   The scaling factor to apply on X axis
     * @param sizeY   The scaling factor to apply on Y axis
     * @param speedX  The speed of scaling specified in magnitude increase per second on X axis
     * @param speedY  The speed of scaling specified in magnitude increase per second on Y axis
     */
    scaleTo(sizeX: number, sizeY: number, speedX: number, speedY: number): ActionContext;
    /**
     * Scales an actor by a specified scale offset {@link Vector} over a duration in milliseconds
     * @param options
     */
    scaleBy(options: ScaleByOptions): ActionContext;
    /**
     * This method will scale an actor by an amount relative to the current scale at a certain speed in scale units/sec
     * and return back the actor. This method is part of the
     * actor 'Action' fluent API allowing action chaining.
     * @param offset   The scaling factor to apply to the actor
     * @param speed    The speed to scale at in scale units/sec
     */
    scaleBy(offset: Vector, speed: number): ActionContext;
    /**
     * This method will scale an actor by an amount relative to the current scale at a certain speed in scale units/sec
     * and return back the actor. This method is part of the
     * actor 'Action' fluent API allowing action chaining.
     * @param sizeOffsetX   The scaling factor to apply on X axis
     * @param sizeOffsetY   The scaling factor to apply on Y axis
     * @param speed    The speed to scale at in scale units/sec
     */
    scaleBy(sizeOffsetX: number, sizeOffsetY: number, speed: number): ActionContext;
    /**
     * This method will cause an actor to blink (become visible and not
     * visible). Optionally, you may specify the number of blinks. Specify the amount of time
     * the actor should be visible per blink, and the amount of time not visible.
     * This method is part of the actor 'Action' fluent API allowing action chaining.
     * @param timeVisible     The amount of time to stay visible per blink in milliseconds
     * @param timeNotVisible  The amount of time to stay not visible per blink in milliseconds
     * @param numBlinks       The number of times to blink
     */
    blink(timeVisible: number, timeNotVisible: number, numBlinks?: number): ActionContext;
    /**
     * This method will cause an actor's opacity to change from its current value
     * to the provided value by a specified time (in milliseconds). This method is
     * part of the actor 'Action' fluent API allowing action chaining.
     * @param opacity  The ending opacity
     * @param duration     The time it should take to fade the actor (in milliseconds)
     */
    fade(opacity: number, duration: number): ActionContext;
    /**
     * This will cause an actor to flash a specific color for a period of time
     * @param color
     * @param duration The duration in milliseconds
     */
    flash(color: Color, duration?: number): ActionContext;
    /**
     * This method will delay the next action from executing for a certain
     * amount of time (in milliseconds). This method is part of the actor
     * 'Action' fluent API allowing action chaining.
     * @param duration  The amount of time to delay the next action in the queue from executing in milliseconds
     */
    delay(duration: number): ActionContext;
    /**
     * This method will add an action to the queue that will remove the actor from the
     * scene once it has completed its previous  Any actions on the
     * action queue after this action will not be executed.
     */
    die(): ActionContext;
    /**
     * This method allows you to call an arbitrary method as the next action in the
     * action queue. This is useful if you want to execute code in after a specific
     * action, i.e An actor arrives at a destination after traversing a path
     */
    callMethod(method: () => any): ActionContext;
    /**
     * This method will cause the actor to repeat all of the actions built in
     * the \`repeatBuilder\` callback. If the number of repeats
     * is not specified it will repeat forever. This method is part of
     * the actor 'Action' fluent API allowing action chaining
     *
     * \`\`\`typescript
     * // Move up in a zig-zag by repeated moveBy's
     * actor.actions.repeat(repeatCtx => {
     * repeatCtx.moveBy(10, 0, 10);
     * repeatCtx.moveBy(0, 10, 10);
     * }, 5);
     * \`\`\`
     * @param repeatBuilder The builder to specify the repeatable list of actions
     * @param times  The number of times to repeat all the previous actions in the action queue. If nothing is specified the actions
     * will repeat forever
     */
    repeat(repeatBuilder: (repeatContext: ActionContext) => any, times?: number): ActionContext;
    /**
     * This method will cause the actor to repeat all of the actions built in
     * the \`repeatBuilder\` callback. If the number of repeats
     * is not specified it will repeat forever. This method is part of
     * the actor 'Action' fluent API allowing action chaining
     *
     * \`\`\`typescript
     * // Move up in a zig-zag by repeated moveBy's
     * actor.actions.repeat(repeatCtx => {
     * repeatCtx.moveBy(10, 0, 10);
     * repeatCtx.moveBy(0, 10, 10);
     * }, 5);
     * \`\`\`
     * @param repeatBuilder The builder to specify the repeatable list of actions
     */
    repeatForever(repeatBuilder: (repeatContext: ActionContext) => any): ActionContext;
    /**
     * This method will cause the entity to follow another at a specified distance
     * @param entity           The entity to follow
     * @param followDistance  The distance to maintain when following, if not specified the actor will follow at the current distance.
     */
    follow(entity: Actor, followDistance?: number): ActionContext;
    /**
     * This method will cause the entity to move towards another until they
     * collide "meet" at a specified speed.
     * @param entity  The entity to meet
     * @param speed  The speed in pixels per second to move, if not specified it will match the speed of the other actor
     */
    meet(entity: Actor, speed?: number): ActionContext;
    /**
     * Returns a promise that resolves when the current action queue up to now
     * is finished.
     */
    toPromise(): Promise<void>;
}

/**
 * Type guard for checking if something is an Actor
 * @param x
 */
declare function isActor(x: any): x is Actor;
/**
 * Actor constructor options
 */
type ActorArgs = ColliderArgs & {
    /**
     * Optionally set the name of the actor, default is 'anonymous'
     */
    name?: string;
    /**
     * Optionally set the x position of the actor, default is 0
     */
    x?: number;
    /**
     * Optionally set the y position of the actor, default is 0
     */
    y?: number;
    /**
     * Optionally set the (x, y) position of the actor as a vector, default is (0, 0)
     */
    pos?: Vector;
    /**
     * Optionally set the coordinate plane of the actor, default is {@apilink CoordPlane.World} meaning actor is subject to camera positioning
     */
    coordPlane?: CoordPlane;
    /**
     * Optionally set the velocity of the actor in pixels/sec
     */
    vel?: Vector;
    /**
     * Optionally set the acceleration of the actor in pixels/sec^2
     */
    acc?: Vector;
    /**
     * Optionally se the rotation in radians (180 degrees = Math.PI radians)
     */
    rotation?: number;
    /**
     * Optionally set the angular velocity of the actor in radians/sec (180 degrees = Math.PI radians)
     */
    angularVelocity?: number;
    /**
     * Optionally set the scale of the actor's transform
     */
    scale?: Vector;
    /**
     * Optionally set the z index of the actor, default is 0
     */
    z?: number;
    /**
     * Optionally set the color of an actor, only used if no graphics are present
     * If a width/height or a radius was set a default graphic will be added
     */
    color?: Color;
    /**
     * Optionally set the color of an actor, only used if no graphics are present
     * If a width/height or a radius was set a default graphic will be added
     */
    opacity?: number;
    /**
     * Optionally set the visibility of the actor
     */
    visible?: boolean;
    /**
     * Optionally set the anchor for graphics in the actor
     */
    anchor?: Vector;
    /**
     * Optionally set the anchor for graphics in the actor
     */
    offset?: Vector;
    /**
     * Optionally set the collision type
     */
    collisionType?: CollisionType;
    /**
     * Optionally supply a {@apilink CollisionGroup}
     */
    collisionGroup?: CollisionGroup;
};
type ColliderArgs = // custom collider
{
    /**
     * Optionally supply a collider for an actor, if supplied ignores any supplied width/height
     *
     * No default graphigc is created in this case
     */
    collider?: Collider;
    width?: undefined;
    height?: undefined;
    radius?: undefined;
    color?: undefined;
} | {
    /**
     * Optionally set the width of a box collider for the actor
     */
    width?: number;
    /**
     * Optionally set the height of a box collider for the actor
     */
    height?: number;
    /**
     * Optionally set the color of a rectangle graphic for the actor
     */
    color?: Color;
    collider?: undefined;
    radius?: undefined;
} | {
    /**
     * Optionally set the radius of the circle collider for the actor
     */
    radius?: number;
    /**
     * Optionally set the color on a circle graphic for the actor
     */
    color?: Color;
    collider?: undefined;
    width?: undefined;
    height?: undefined;
};
type ActorEvents = EntityEvents & {
    collisionstart: CollisionStartEvent;
    collisionend: CollisionEndEvent;
    precollision: PreCollisionEvent;
    postcollision: PostCollisionEvent;
    kill: KillEvent;
    prekill: PreKillEvent;
    postkill: PostKillEvent;
    predraw: PreDrawEvent;
    postdraw: PostDrawEvent;
    pretransformdraw: PreDrawEvent;
    posttransformdraw: PostDrawEvent;
    predebugdraw: PreDebugDrawEvent;
    postdebugdraw: PostDebugDrawEvent;
    pointerup: PointerEvent;
    pointerdown: PointerEvent;
    pointerenter: PointerEvent;
    pointerleave: PointerEvent;
    pointermove: PointerEvent;
    pointercancel: PointerEvent;
    pointerwheel: WheelEvent;
    pointerdragstart: PointerEvent;
    pointerdragend: PointerEvent;
    pointerdragenter: PointerEvent;
    pointerdragleave: PointerEvent;
    pointerdragmove: PointerEvent;
    enterviewport: EnterViewPortEvent;
    exitviewport: ExitViewPortEvent;
    actionstart: ActionStartEvent;
    actioncomplete: ActionCompleteEvent;
};
declare const ActorEvents: {
    readonly CollisionStart: "collisionstart";
    readonly CollisionEnd: "collisionend";
    readonly PreCollision: "precollision";
    readonly PostCollision: "postcollision";
    readonly Kill: "kill";
    readonly PreKill: "prekill";
    readonly PostKill: "postkill";
    readonly PreDraw: "predraw";
    readonly PostDraw: "postdraw";
    readonly PreTransformDraw: "pretransformdraw";
    readonly PostTransformDraw: "posttransformdraw";
    readonly PreDebugDraw: "predebugdraw";
    readonly PostDebugDraw: "postdebugdraw";
    readonly PointerUp: "pointerup";
    readonly PointerDown: "pointerdown";
    readonly PointerEnter: "pointerenter";
    readonly PointerLeave: "pointerleave";
    readonly PointerMove: "pointermove";
    readonly PointerCancel: "pointercancel";
    readonly Wheel: "pointerwheel";
    readonly PointerDrag: "pointerdragstart";
    readonly PointerDragEnd: "pointerdragend";
    readonly PointerDragEnter: "pointerdragenter";
    readonly PointerDragLeave: "pointerdragleave";
    readonly PointerDragMove: "pointerdragmove";
    readonly EnterViewPort: "enterviewport";
    readonly ExitViewPort: "exitviewport";
    readonly ActionStart: "actionstart";
    readonly ActionComplete: "actioncomplete";
};
/**
 * The most important primitive in Excalibur is an \`Actor\`. Anything that
 * can move on the screen, collide with another \`Actor\`, respond to events,
 * or interact with the current scene, must be an actor. An \`Actor\` **must**
 * be part of a {@apilink Scene} for it to be drawn to the screen.
 */
declare class Actor extends Entity implements Eventable, PointerEvents$1, CanInitialize, CanUpdate, CanBeKilled {
    events: EventEmitter<ActorEvents>;
    /**
     * Set defaults for all Actors
     */
    static defaults: {
        anchor: Vector;
    };
    /**
     * The physics body the is associated with this actor. The body is the container for all physical properties, like position, velocity,
     * acceleration, mass, inertia, etc.
     */
    body: BodyComponent;
    /**
     * Access the Actor's built in {@apilink TransformComponent}
     */
    transform: TransformComponent;
    /**
     * Access the Actor's built in {@apilink MotionComponent}
     */
    motion: MotionComponent;
    /**
     * Access to the Actor's built in {@apilink GraphicsComponent}
     */
    graphics: GraphicsComponent;
    /**
     * Access to the Actor's built in {@apilink ColliderComponent}
     */
    collider: ColliderComponent;
    /**
     * Access to the Actor's built in {@apilink PointerComponent} config
     */
    pointer: PointerComponent;
    /**
     * Useful for quickly scripting actor behavior, like moving to a place, patrolling back and forth, blinking, etc.
     *
     *  Access to the Actor's built in {@apilink ActionsComponent} which forwards to the
     * {@apilink ActionContext | \`Action context\`} of the actor.
     */
    actions: ActionsComponent;
    /**
     * Gets the position vector of the actor in pixels
     */
    get pos(): Vector;
    /**
     * Sets the position vector of the actor in pixels
     */
    set pos(thePos: Vector);
    /**
     * Gets the position vector of the actor from the last frame
     */
    get oldPos(): Vector;
    /**
     * Gets the global position vector of the actor from the last frame
     */
    get oldGlobalPos(): Vector;
    /**
     * Sets the position vector of the actor in the last frame
     */
    set oldPos(thePos: Vector);
    /**
     * Gets the velocity vector of the actor in pixels/sec
     */
    get vel(): Vector;
    /**
     * Sets the velocity vector of the actor in pixels/sec
     */
    set vel(theVel: Vector);
    /**
     * Gets the velocity vector of the actor from the last frame
     */
    get oldVel(): Vector;
    /**
     * Sets the velocity vector of the actor from the last frame
     */
    set oldVel(theVel: Vector);
    /**
     * Gets the acceleration vector of the actor in pixels/second/second. An acceleration pointing down such as (0, 100) may be
     * useful to simulate a gravitational effect.
     */
    get acc(): Vector;
    /**
     * Sets the acceleration vector of teh actor in pixels/second/second
     */
    set acc(theAcc: Vector);
    /**
     * Sets the acceleration of the actor from the last frame. This does not include the global acc {@apilink Physics.acc}.
     */
    set oldAcc(theAcc: Vector);
    /**
     * Gets the acceleration of the actor from the last frame. This does not include the global acc {@apilink Physics.acc}.
     */
    get oldAcc(): Vector;
    /**
     * Gets the rotation of the actor in radians. 1 radian = 180/PI Degrees.
     */
    get rotation(): number;
    /**
     * Sets the rotation of the actor in radians. 1 radian = 180/PI Degrees.
     */
    set rotation(theAngle: number);
    /**
     * Gets the rotational velocity of the actor in radians/second
     */
    get angularVelocity(): number;
    /**
     * Sets the rotational velocity of the actor in radians/sec
     */
    set angularVelocity(angularVelocity: number);
    get scale(): Vector;
    set scale(scale: Vector);
    private _anchor;
    /**
     * The anchor to apply all actor related transformations like rotation,
     * translation, and scaling. By default the anchor is in the center of
     * the actor. By default it is set to the center of the actor (.5, .5)
     *
     * An anchor of (.5, .5) will ensure that drawings are centered.
     *
     * Use \`anchor.setTo\` to set the anchor to a different point using
     * values between 0 and 1. For example, anchoring to the top-left would be
     * \`Actor.anchor.setTo(0, 0)\` and top-right would be \`Actor.anchor.setTo(0, 1)\`.
     */
    get anchor(): Vector;
    set anchor(vec: Vector);
    private _handleAnchorChange;
    private _offset;
    /**
     * The offset in pixels to apply to all actor graphics
     *
     * Default offset of (0, 0)
     */
    get offset(): Vector;
    set offset(vec: Vector);
    private _handleOffsetChange;
    /**
     * Indicates whether the actor is physically in the viewport
     */
    get isOffScreen(): boolean;
    /**
     * Convenience reference to the global logger
     */
    logger: Logger;
    /**
     * Draggable helper
     */
    private _draggable;
    private _dragging;
    private _pointerDragStartHandler;
    private _pointerDragEndHandler;
    private _pointerDragMoveHandler;
    private _pointerDragLeaveHandler;
    get draggable(): boolean;
    set draggable(isDraggable: boolean);
    /**
     * Sets the color of the actor's current graphic
     */
    get color(): Color;
    set color(v: Color);
    /**
     *
     * @param config
     */
    constructor(config?: ActorArgs);
    clone(): Actor;
    /**
     * \`onInitialize\` is called before the first update of the actor. This method is meant to be
     * overridden. This is where initialization of child actors should take place.
     *
     * Synonymous with the event handler \`.on('initialize', (evt) => {...})\`
     */
    onInitialize(engine: Engine): void;
    /**
     * Initializes this actor and all it's child actors, meant to be called by the Scene before first update not by users of Excalibur.
     *
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     * @internal
     */
    _initialize(engine: Engine): void;
    emit<TEventName extends EventKey<ActorEvents>>(eventName: TEventName, event: ActorEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<ActorEvents>>(eventName: TEventName, handler: Handler<ActorEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<ActorEvents>>(eventName: TEventName, handler: Handler<ActorEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<ActorEvents>>(eventName: TEventName, handler: Handler<ActorEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _prekill handler for {@apilink onPreKill} lifecycle event
     * @internal
     */
    _prekill(scene: Scene): void;
    /**
     * Safe to override onPreKill lifecycle event handler. Synonymous with \`.on('prekill', (evt) =>{...})\`
     *
     * \`onPreKill\` is called directly before an actor is killed and removed from its current {@apilink Scene}.
     */
    onPreKill(scene: Scene): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _prekill handler for {@apilink onPostKill} lifecycle event
     * @internal
     */
    _postkill(scene: Scene): void;
    /**
     * Safe to override onPostKill lifecycle event handler. Synonymous with \`.on('postkill', (evt) => {...})\`
     *
     * \`onPostKill\` is called directly after an actor is killed and remove from its current {@apilink Scene}.
     */
    onPostKill(scene: Scene): void;
    /**
     * If the current actor is a member of the scene, this will remove
     * it from the scene graph. It will no longer be drawn or updated.
     */
    kill(): void;
    /**
     * If the current actor is killed, it will now not be killed.
     */
    unkill(): void;
    /**
     * Indicates wether the actor has been killed.
     */
    isKilled(): boolean;
    /**
     * Gets the z-index of an actor. The z-index determines the relative order an actor is drawn in.
     * Actors with a higher z-index are drawn on top of actors with a lower z-index
     */
    get z(): number;
    /**
     * Sets the z-index of an actor and updates it in the drawing list for the scene.
     * The z-index determines the relative order an actor is drawn in.
     * Actors with a higher z-index are drawn on top of actors with a lower z-index
     * @param newZ new z-index to assign
     */
    set z(newZ: number);
    /**
     * Get the center point of an actor (global position)
     */
    get center(): Vector;
    /**
     * Get the local center point of an actor
     */
    get localCenter(): Vector;
    get width(): number;
    get height(): number;
    /**
     * Gets this actor's rotation taking into account any parent relationships
     * @returns Rotation angle in radians
     * @deprecated Use {@apilink globalRotation} instead
     */
    getGlobalRotation(): number;
    /**
     * The actor's rotation (in radians) taking into account any parent relationships
     */
    get globalRotation(): number;
    /**
     * Gets an actor's world position taking into account parent relationships, scaling, rotation, and translation
     * @returns Position in world coordinates
     * @deprecated Use {@apilink globalPos} instead
     */
    getGlobalPos(): Vector;
    /**
     * The actor's world position taking into account parent relationships, scaling, rotation, and translation
     */
    get globalPos(): Vector;
    /**
     * Gets the global scale of the Actor
     * @deprecated Use {@apilink globalScale} instead
     */
    getGlobalScale(): Vector;
    /**
     * The global scale of the Actor
     */
    get globalScale(): Vector;
    /**
     * The global z-index of the actor
     */
    get globalZ(): number;
    /**
     * Tests whether the x/y specified are contained in the actor
     * @param x  X coordinate to test (in world coordinates)
     * @param y  Y coordinate to test (in world coordinates)
     * @param recurse checks whether the x/y are contained in any child actors (if they exist).
     */
    contains(x: number, y: number, recurse?: boolean): boolean;
    /**
     * Returns true if the two actor.collider's surfaces are less than or equal to the distance specified from each other
     * @param actor     Actor to test
     * @param distance  Distance in pixels to test
     */
    within(actor: Actor, distance: number): boolean;
    /**
     * Called by the Engine, updates the state of the actor
     * @internal
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     */
    update(engine: Engine, elapsed: number): void;
    /**
     * Safe to override onPreUpdate lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPreUpdate\` is called directly before an actor is updated.
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     */
    onPreUpdate(engine: Engine, elapsed: number): void;
    /**
     * Safe to override onPostUpdate lifecycle event handler. Synonymous with \`.on('postupdate', (evt) =>{...})\`
     *
     * \`onPostUpdate\` is called directly after an actor is updated.
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     */
    onPostUpdate(engine: Engine, elapsed: number): void;
    /**
     * Fires before every collision resolution for a confirmed contact
     * @param self
     * @param other
     * @param side
     * @param contact
     */
    onPreCollisionResolve(self: Collider, other: Collider, side: Side, contact: CollisionContact): void;
    /**
     * Fires after every resolution for a confirmed contact.
     * @param self
     * @param other
     * @param side
     * @param contact
     */
    onPostCollisionResolve(self: Collider, other: Collider, side: Side, contact: CollisionContact): void;
    /**
     * Fires once when 2 entities with a ColliderComponent first start colliding or touching, if the Colliders stay in contact this
     * does not continue firing until they separate and re-collide.
     * @param self
     * @param other
     * @param side
     * @param contact
     */
    onCollisionStart(self: Collider, other: Collider, side: Side, contact: CollisionContact): void;
    /**
     * Fires once when 2 entities with a ColliderComponent separate after having been in contact.
     * @param self
     * @param other
     * @param side
     * @param lastContact
     */
    onCollisionEnd(self: Collider, other: Collider, side: Side, lastContact: CollisionContact): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPreUpdate} lifecycle event
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     * @internal
     */
    _preupdate(engine: Engine, elapsed: number): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPostUpdate} lifecycle event
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     * @internal
     */
    _postupdate(engine: Engine, elapsed: number): void;
}

/**
 * Type guard to detect a screen element
 */
declare function isScreenElement(actor: Actor): actor is ScreenElement;
/**
 * Helper {@apilink Actor} primitive for drawing UI's, optimized for UI drawing. Does
 * not participate in collisions. Drawn on top of all other actors.
 */
declare class ScreenElement extends Actor {
    protected _engine: Engine;
    constructor();
    constructor(config?: ActorArgs);
    _initialize(engine: Engine): void;
    contains(x: number, y: number, useWorld?: boolean): boolean;
}

interface TimerOptions {
    /**
     * If true the timer repeats every interval infinitely
     */
    repeats?: boolean;
    /**
     * If a number is specified then it will only repeat a number of times
     */
    numberOfRepeats?: number;
    /**
     * @deprecated use action: () => void, will be removed in v1.0
     */
    fcn?: () => void;
    /**
     * Action to perform every time the timer fires
     */
    action?: () => void;
    /**
     * Interval in milliseconds for the timer to fire
     */
    interval: number;
    /**
     * Optionally specify a random range of milliseconds for the timer to fire
     */
    randomRange?: [number, number];
    /**
     * Optionally provide a random instance to use for random behavior, otherwise a new random will be created seeded from the current time.
     */
    random?: Random;
}
/**
 * The Excalibur timer hooks into the internal timer and fires callbacks,
 * after a certain interval, optionally repeating.
 */
declare class Timer {
    private _logger;
    private static _MAX_ID;
    id: number;
    private _elapsedTime;
    private _totalTimeAlive;
    private _running;
    private _numberOfTicks;
    private _callbacks;
    interval: number;
    repeats: boolean;
    maxNumberOfRepeats: number;
    randomRange: [number, number];
    random: Random;
    private _baseInterval;
    private _generateRandomInterval;
    private _complete;
    get complete(): boolean;
    scene: Scene;
    constructor(options: TimerOptions);
    /**
     * Adds a new callback to be fired after the interval is complete
     * @param action The callback to be added to the callback list, to be fired after the interval is complete.
     */
    on(action: () => void): void;
    /**
     * Removes a callback from the callback list to be fired after the interval is complete.
     * @param action The callback to be removed from the callback list, to be fired after the interval is complete.
     */
    off(action: () => void): void;
    /**
     * Updates the timer after a certain number of milliseconds have elapsed. This is used internally by the engine.
     * @param elapsed  Number of elapsed milliseconds since the last update.
     */
    update(elapsed: number): void;
    /**
     * Resets the timer so that it can be reused, and optionally reconfigure the timers interval.
     *
     * Warning** you may need to call \`timer.start()\` again if the timer had completed
     * @param newInterval If specified, sets a new non-negative interval in milliseconds to refire the callback
     * @param newNumberOfRepeats If specified, sets a new non-negative upper limit to the number of time this timer executes
     */
    reset(newInterval?: number, newNumberOfRepeats?: number): void;
    get timesRepeated(): number;
    getTimeRunning(): number;
    /**
     * @returns milliseconds until the next action callback, if complete will return 0
     */
    get timeToNextAction(): number;
    /**
     * @returns milliseconds elapsed toward the next action
     */
    get timeElapsedTowardNextAction(): number;
    get isRunning(): boolean;
    /**
     * Pauses the timer, time will no longer increment towards the next call
     */
    pause(): Timer;
    /**
     * Resumes the timer, time will now increment towards the next call.
     */
    resume(): Timer;
    /**
     * Starts the timer, if the timer was complete it will restart the timer and reset the elapsed time counter
     */
    start(): Timer;
    /**
     * Stops the timer and resets the elapsed time counter towards the next action invocation
     */
    stop(): Timer;
    /**
     * Cancels the timer, preventing any further executions.
     */
    cancel(): void;
}

declare class PointerAbstraction {
    events: EventEmitter<PointerEvents>;
    /**
     * The last position on the document this pointer was at. Can be \`null\` if pointer was never active.
     */
    lastPagePos: Vector;
    /**
     * The last position on the screen this pointer was at. Can be \`null\` if pointer was never active.
     */
    lastScreenPos: Vector;
    /**
     * The last position in the game world coordinates this pointer was at. Can be \`null\` if pointer was never active.
     */
    lastWorldPos: Vector;
    constructor();
    emit<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, event: PointerEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, handler: Handler<PointerEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, handler: Handler<PointerEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, handler: Handler<PointerEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * Called internally by excalibur to keep pointers up to date
     * @internal
     * @param engine
     */
    _updateWorldPosition(engine: Engine): void;
    private _onPointerMove;
    private _onPointerDown;
}

type NativePointerEvent = globalThis.PointerEvent;
type NativeMouseEvent = globalThis.MouseEvent;
type NativeTouchEvent = globalThis.TouchEvent;
type NativeWheelEvent = globalThis.WheelEvent;
type PointerEvents = {
    move: PointerEvent;
    down: PointerEvent;
    up: PointerEvent;
    wheel: WheelEvent;
};
declare const PointerEvents: {
    Move: string;
    Down: string;
    Up: string;
    Wheel: string;
};
interface PointerInitOptions {
    grabWindowFocus?: boolean;
}
/**
 * The PointerEventProcessor is responsible for collecting all the events from the canvas and transforming them into GlobalCoordinates
 */
declare class PointerEventReceiver {
    readonly target: GlobalEventHandlers & EventTarget;
    engine: Engine;
    events: EventEmitter<PointerEvents>;
    primary: PointerAbstraction;
    private _activeNativePointerIdsToNormalized;
    lastFramePointerCoords: Map<number, GlobalCoordinates>;
    currentFramePointerCoords: Map<number, GlobalCoordinates>;
    currentFramePointerDown: Map<number, boolean>;
    lastFramePointerDown: Map<number, boolean>;
    currentFrameDown: PointerEvent[];
    currentFrameUp: PointerEvent[];
    currentFrameMove: PointerEvent[];
    currentFrameCancel: PointerEvent[];
    currentFrameWheel: WheelEvent[];
    private _enabled;
    constructor(target: GlobalEventHandlers & EventTarget, engine: Engine);
    toggleEnabled(enabled: boolean): void;
    /**
     * Creates a new PointerEventReceiver with a new target and engine while preserving existing pointer event
     * handlers.
     * @param target
     * @param engine
     */
    recreate(target: GlobalEventHandlers & EventTarget, engine: Engine): PointerEventReceiver;
    private _pointers;
    /**
     * Locates a specific pointer by id, creates it if it doesn't exist
     * @param index
     */
    at(index: number): PointerAbstraction;
    /**
     * The number of pointers currently being tracked by excalibur
     */
    count(): number;
    /**
     * Is the specified pointer id down this frame
     * @param pointerId
     */
    isDown(pointerId: number): boolean;
    /**
     * Was the specified pointer id down last frame
     * @param pointerId
     */
    wasDown(pointerId: number): boolean;
    /**
     * Whether the Pointer is currently dragging.
     */
    isDragging(pointerId: number): boolean;
    /**
     * Whether the Pointer just started dragging.
     */
    isDragStart(pointerId: number): boolean;
    /**
     * Whether the Pointer just ended dragging.
     */
    isDragEnd(pointerId: number): boolean;
    emit<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, event: PointerEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, handler: Handler<PointerEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, handler: Handler<PointerEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<PointerEvents>>(eventName: TEventName, handler: Handler<PointerEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * Called internally by excalibur
     *
     * Updates the current frame pointer info and emits raw pointer events
     *
     * This does not emit events to entities, see PointerSystem
     * @internal
     */
    update(): void;
    /**
     * Clears the current frame event and pointer data
     */
    clear(): void;
    private _boundHandle;
    private _boundWheel;
    /**
     * Initializes the pointer event receiver so that it can start listening to native
     * browser events.
     */
    init(options?: PointerInitOptions): void;
    detach(): void;
    /**
     * Take native pointer id and map it to index in active pointers
     * @param nativePointerId
     */
    private _normalizePointerId;
    /**
     * Responsible for handling and parsing pointer events
     */
    private _handle;
    private _handleWheel;
    /**
     * Triggers an excalibur pointer event in a world space pos
     *
     * Useful for testing pointers in excalibur
     * @param type
     * @param pos
     */
    triggerEvent(type: 'down' | 'up' | 'move' | 'cancel', pos: Vector): void;
    private _nativeButtonToPointerButton;
    private _stringToPointerType;
}

/**
 * Signals that an object has nested pointer events on nested objects that are not an Entity with
 * a PointerComponent. For example TileMap Tiles
 */
interface HasNestedPointerEvents {
    _dispatchPointerEvents(receiver: PointerEventReceiver): void;
    _processPointerToObject(receiver: PointerEventReceiver): void;
}

interface TileMapOptions {
    /**
     * Optionally name the tile map
     */
    name?: string;
    /**
     * Optionally specify the position of the tile map
     */
    pos?: Vector;
    /**
     * Width of an individual tile in pixels
     */
    tileWidth: number;
    /**
     * Height of an individual tile in pixels
     */
    tileHeight: number;
    /**
     * The number of tile columns, or the number of tiles wide
     */
    columns: number;
    /**
     * The number of tile  rows, or the number of tiles high
     */
    rows: number;
    /**
     * Optionally render from the top of the graphic, by default tiles are rendered from the bottom
     */
    renderFromTopOfGraphic?: boolean;
    /**
     * Optionally configure the meshing lookbehind for Tilemap, Tilemaps combine solid tiles into optimal
     * geometry and the lookbehind configures how far back the Tilemap to look for geometry when combining. Meshing
     * is an expensive operation, so when the Tilemap geometry is invalidated it must be recalculated.
     *
     * Default is 10 slots, but if your Tilemap does not change positions or solid tiles often you can increase this to
     * Infinity.
     */
    meshingLookBehind?: number;
}
type TilePointerEvents = {
    pointerup: PointerEvent;
    pointerdown: PointerEvent;
    pointermove: PointerEvent;
    pointercancel: PointerEvent;
    pointerenter: PointerEvent;
    pointerleave: PointerEvent;
};
type TileMapEvents = EntityEvents & TilePointerEvents & {
    preupdate: PreUpdateEvent<TileMap>;
    postupdate: PostUpdateEvent<TileMap>;
    predraw: PreDrawEvent;
    postdraw: PostDrawEvent;
};
declare const TileMapEvents: {
    PreUpdate: string;
    PostUpdate: string;
    PreDraw: string;
    PostDraw: string;
    PointerUp: string;
    PointerDown: string;
    PointerMove: string;
    PointerCancel: string;
};
/**
 * The TileMap provides a mechanism for doing flat 2D tiles rendered in a grid.
 *
 * TileMaps are useful for top down or side scrolling grid oriented games.
 */
declare class TileMap extends Entity implements HasNestedPointerEvents {
    events: EventEmitter<TileMapEvents>;
    private _token;
    private _engine;
    logger: Logger;
    readonly tiles: Tile[];
    private _rows;
    private _cols;
    readonly tileWidth: number;
    readonly tileHeight: number;
    readonly rows: number;
    readonly columns: number;
    renderFromTopOfGraphic: boolean;
    meshingLookBehind: number;
    private _collidersDirty;
    private _pointerEventDispatcher;
    flagCollidersDirty(): void;
    flagTilesDirty(): void;
    pointer: PointerComponent;
    transform: TransformComponent;
    private _motion;
    private _graphics;
    collider: ColliderComponent;
    private _composite;
    get x(): number;
    set x(val: number);
    get y(): number;
    set y(val: number);
    get z(): number;
    set z(val: number);
    private _oldRotation;
    get rotation(): number;
    set rotation(val: number);
    private _oldScale;
    get scale(): Vector;
    set scale(val: Vector);
    private _oldPos;
    get pos(): Vector;
    set pos(val: Vector);
    get vel(): Vector;
    set vel(val: Vector);
    /**
     * Width of the whole tile map in pixels
     */
    get width(): number;
    /**
     * Height of the whole tilemap in pixels
     */
    get height(): number;
    emit<TEventName extends EventKey<TileMapEvents>>(eventName: TEventName, event: TileMapEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<TileMapEvents>>(eventName: TEventName, handler: Handler<TileMapEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<TileMapEvents>>(eventName: TEventName, handler: Handler<TileMapEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<TileMapEvents>>(eventName: TEventName, handler: Handler<TileMapEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * @param options
     */
    constructor(options: TileMapOptions);
    _initialize(engine: Engine): void;
    private _originalOffsets;
    private _getOrSetColliderOriginalOffset;
    /**
     * Tiles colliders based on the solid tiles in the tilemap.
     */
    private _updateColliders;
    /**
     * Returns the {@apilink Tile} by index (row major order)
     *
     * Returns null if out of bounds
     */
    getTileByIndex(index: number): Tile | null;
    /**
     * Returns the {@apilink Tile} by its x and y integer coordinates
     *
     * Returns null if out of bounds
     *
     * For example, if I want the tile in fifth column (x), and second row (y):
     * \`getTile(4, 1)\` 0 based, so 0 is the first in row/column
     */
    getTile(x: number, y: number): Tile | null;
    /**
     * Returns the {@apilink Tile} by testing a point in world coordinates,
     * returns \`null\` if no Tile was found.
     */
    getTileByPoint(point: Vector): Tile | null;
    private _getTileCoordinates;
    getRows(): readonly Tile[][];
    getColumns(): readonly Tile[][];
    /**
     * Returns the on screen tiles for a tilemap, this will overshoot by a small amount because of the internal quad tree data structure.
     *
     * Useful if you need to perform specific logic on onscreen tiles
     */
    getOnScreenTiles(): readonly Tile[];
    /**
     * @internal
     */
    _processPointerToObject(receiver: PointerEventReceiver): void;
    /**
     * @internal
     */
    _dispatchPointerEvents(receiver: PointerEventReceiver): void;
    update(engine: Engine, elapsed: number): void;
    /**
     * Draws the tile map to the screen. Called by the {@apilink Scene}.
     * @param ctx ExcaliburGraphicsContext
     * @param elapsed  The number of milliseconds since the last draw
     */
    draw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    debug(gfx: ExcaliburGraphicsContext, debugFlags: DebugConfig): void;
}
interface TileOptions {
    /**
     * Integer tile x coordinate
     */
    x: number;
    /**
     * Integer tile y coordinate
     */
    y: number;
    map: TileMap;
    solid?: boolean;
    graphics?: Graphic[];
}
/**
 * TileMap Tile
 *
 * A light-weight object that occupies a space in a collision map. Generally
 * created by a {@apilink TileMap}.
 *
 * Tiles can draw multiple sprites. Note that the order of drawing is the order
 * of the sprites in the array so the last one will be drawn on top. You can
 * use transparency to create layers this way.
 */
declare class Tile {
    private _bounds;
    private _geometry;
    private _pos;
    private _posDirty;
    events: EventEmitter<TilePointerEvents>;
    /**
     * Return the world position of the top left corner of the tile
     */
    get pos(): Vector;
    /**
     * Integer x coordinate of the tile
     */
    readonly x: number;
    /**
     * Integer y coordinate of the tile
     */
    readonly y: number;
    private _width;
    /**
     * Width of the tile in pixels
     */
    get width(): number;
    private _height;
    /**
     * Height of the tile in pixels
     */
    get height(): number;
    /**
     * Reference to the TileMap this tile is associated with
     */
    map: TileMap;
    private _solid;
    /**
     * Wether this tile should be treated as solid by the tilemap
     */
    get solid(): boolean;
    /**
     * Wether this tile should be treated as solid by the tilemap
     */
    set solid(val: boolean);
    private _graphics;
    private _offsets;
    /**
     * Current list of graphics for this tile
     */
    getGraphics(): readonly Graphic[];
    /**
     * Current list of offsets for this tile's graphics
     */
    getGraphicsOffsets(): readonly Vector[];
    /**
     * Add another {@apilink Graphic} to this TileMap tile
     * @param graphic
     */
    addGraphic(graphic: Graphic, options?: {
        offset?: Vector;
    }): void;
    /**
     * Remove an instance of a {@apilink Graphic} from this tile
     */
    removeGraphic(graphic: Graphic): void;
    /**
     * Clear all graphics from this tile
     */
    clearGraphics(): void;
    /**
     * Current list of colliders for this tile
     */
    private _colliders;
    /**
     * Returns the list of colliders
     */
    getColliders(): readonly Collider[];
    /**
     * Adds a custom collider to the {@apilink Tile} to use instead of it's bounds
     *
     * If no collider is set but {@apilink Tile.solid} is set, the tile bounds are used as a collider.
     *
     * **Note!** the {@apilink Tile.solid} must be set to true for it to act as a "fixed" collider
     * @param collider
     */
    addCollider(collider: Collider): void;
    /**
     * Removes a collider from the {@apilink Tile}
     * @param collider
     */
    removeCollider(collider: Collider): void;
    /**
     * Clears all colliders from the {@apilink Tile}
     */
    clearColliders(): void;
    /**
     * Arbitrary data storage per tile, useful for any game specific data
     */
    data: Map<string, any>;
    constructor(options: TileOptions);
    flagDirty(): void;
    private _recalculate;
    /**
     * Tile bounds in world space
     */
    get bounds(): BoundingBox;
    get defaultGeometry(): BoundingBox;
    /**
     * Tile position in world space
     */
    get center(): Vector;
    emit<TEventName extends EventKey<TilePointerEvents>>(eventName: TEventName, event: TilePointerEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<TilePointerEvents>>(eventName: TEventName, handler: Handler<TilePointerEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<TilePointerEvents>>(eventName: TEventName, handler: Handler<TilePointerEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<TilePointerEvents>>(eventName: TEventName, handler: Handler<TilePointerEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
}

type IsometricTilePointerEvents = {
    pointerup: PointerEvent;
    pointerdown: PointerEvent;
    pointermove: PointerEvent;
    pointercancel: PointerEvent;
    pointerenter: PointerEvent;
    pointerleave: PointerEvent;
};
declare class IsometricTile extends Entity {
    /**
     * Indicates whether this tile is solid
     */
    solid: boolean;
    events: EventEmitter<EntityEvents & IsometricTilePointerEvents>;
    private _gfx;
    private _tileBounds;
    private _graphics;
    getGraphics(): readonly Graphic[];
    /**
     * Tile graphics
     */
    addGraphic(graphic: Graphic, options?: {
        offset?: Vector;
    }): void;
    private _recalculateBounds;
    removeGraphic(graphic: Graphic): void;
    clearGraphics(): void;
    /**
     * Tile colliders
     */
    private _colliders;
    getColliders(): readonly Collider[];
    /**
     * Adds a collider to the IsometricTile
     *
     * **Note!** the {@apilink Tile.solid} must be set to true for it to act as a "fixed" collider
     * @param collider
     */
    addCollider(collider: Collider): void;
    /**
     * Removes a collider from the IsometricTile
     * @param collider
     */
    removeCollider(collider: Collider): void;
    /**
     * Clears all colliders from the IsometricTile
     */
    clearColliders(): void;
    /**
     * Integer tile x coordinate
     */
    readonly x: number;
    /**
     * Integer tile y coordinate
     */
    readonly y: number;
    /**
     * Reference to the {@apilink IsometricMap} this tile is part of
     */
    readonly map: IsometricMap;
    private _transform;
    private _isometricEntityComponent;
    /**
     * Returns the top left corner of the {@apilink IsometricTile} in world space
     */
    get pos(): Vector;
    /**
     * Returns the center of the {@apilink IsometricTile}
     */
    get center(): Vector;
    /**
     * Arbitrary data storage per tile, useful for any game specific data
     */
    data: Map<string, any>;
    /**
     * Construct a new IsometricTile
     * @param x tile coordinate in x (not world position)
     * @param y tile coordinate in y (not world position)
     * @param graphicsOffset offset that tile should be shifted by (default (0, 0))
     * @param map reference to owning IsometricMap
     */
    constructor(x: number, y: number, graphicsOffset: Vector | null, map: IsometricMap);
    draw(gfx: ExcaliburGraphicsContext, _elapsed: number): void;
}
interface IsometricMapOptions {
    /**
     * Optionally name the isometric tile map
     */
    name?: string;
    /**
     * Optionally specify the position of the isometric tile map
     */
    pos?: Vector;
    /**
     * Optionally render from the top of the graphic, by default tiles are rendered from the bottom
     */
    renderFromTopOfGraphic?: boolean;
    /**
     * Optionally present a graphics offset, this can be useful depending on your tile graphics
     */
    graphicsOffset?: Vector;
    /**
     * Width of an individual tile in pixels, this should be the width of the parallelogram of the base of the tile art asset.
     */
    tileWidth: number;
    /**
     * Height of an individual tile in pixels, this should be the height of the parallelogram of the base of the tile art asset.
     */
    tileHeight: number;
    /**
     * The number of tile columns, or the number of tiles wide
     */
    columns: number;
    /**
     * The number of tile  rows, or the number of tiles high
     */
    rows: number;
    elevation?: number;
}
/**
 * The IsometricMap is a special tile map that provides isometric rendering support to Excalibur
 *
 * The tileWidth and tileHeight should be the height and width in pixels of the parallelogram of the base of the tile art asset.
 * The tileWidth and tileHeight is not necessarily the same as your graphic pixel width and height.
 *
 * Please refer to the docs https://excaliburjs.com for more details calculating what your tile width and height should be given
 * your art assets.
 */
declare class IsometricMap extends Entity implements HasNestedPointerEvents {
    readonly elevation: number;
    /**
     * Width of individual tile in pixels
     */
    readonly tileWidth: number;
    /**
     * Height of individual tile in pixels
     */
    readonly tileHeight: number;
    /**
     * Number of tiles wide
     */
    readonly columns: number;
    /**
     * Number of tiles high
     */
    readonly rows: number;
    /**
     * List containing all of the tiles in IsometricMap
     */
    readonly tiles: IsometricTile[];
    /**
     * Whether tiles should be visible
     * @deprecated use isVisible
     */
    get visible(): boolean;
    /**
     * Whether tiles should be visible
     * @deprecated use isVisible
     */
    set visible(val: boolean);
    /**
     * Whether tiles should be visible
     */
    isVisible: boolean;
    /**
     * Opacity of tiles
     */
    opacity: number;
    /**
     * Render the tile graphic from the top instead of the bottom
     *
     * default is \`false\` meaning rendering from the bottom
     */
    renderFromTopOfGraphic: boolean;
    graphicsOffset: Vector;
    /**
     * Isometric map {@apilink TransformComponent}
     */
    transform: TransformComponent;
    /**
     * Isometric map {@apilink ColliderComponent}
     */
    collider: ColliderComponent;
    pointer: PointerComponent;
    private _composite;
    private _pointerEventDispatcher;
    constructor(options: IsometricMapOptions);
    /**
     * @internal
     */
    _processPointerToObject(receiver: PointerEventReceiver): void;
    /**
     * @internal
     */
    _dispatchPointerEvents(receiver: PointerEventReceiver): void;
    update(): void;
    private _collidersDirty;
    flagCollidersDirty(): void;
    private _originalOffsets;
    private _getOrSetColliderOriginalOffset;
    updateColliders(): void;
    /**
     * Convert world space coordinates to the tile x, y coordinate
     * @param worldCoordinate
     */
    worldToTile(worldCoordinate: Vector): Vector;
    /**
     * Given a tile coordinate, return the top left corner in world space
     * @param tileCoordinate
     */
    tileToWorld(tileCoordinate: Vector): Vector;
    /**
     * Returns the {@apilink IsometricTile} by its x and y coordinates
     */
    getTile(x: number, y: number): IsometricTile | null;
    /**
     * Returns the {@apilink IsometricTile} by testing a point in world coordinates,
     * returns \`null\` if no Tile was found.
     */
    getTileByPoint(point: Vector): IsometricTile | null;
    private _getMaxZIndex;
    /**
     * Debug draw for IsometricMap, called internally by excalibur when debug mode is toggled on
     * @param gfx
     */
    debug(gfx: ExcaliburGraphicsContext, debugFlags: DebugConfig): void;
}

interface IsometricEntityComponentOptions {
    columns: number;
    rows: number;
    tileWidth: number;
    tileHeight: number;
}
declare class IsometricEntityComponent extends Component {
    /**
     * Vertical "height" in the isometric world
     */
    elevation: number;
    readonly columns: number;
    readonly rows: number;
    readonly tileWidth: number;
    readonly tileHeight: number;
    /**
     * Specify the isometric map to use to position this entity's z-index
     * @param mapOrOptions
     */
    constructor(mapOrOptions: IsometricMap | IsometricEntityComponentOptions);
}

declare class IsometricEntitySystem extends System {
    world: World;
    static priority: number;
    readonly systemType = SystemType.Update;
    query: Query<typeof TransformComponent | typeof IsometricEntityComponent>;
    constructor(world: World);
    update(): void;
}

type TriggerEvents = ActorEvents & {
    exit: ExitTriggerEvent;
    enter: EnterTriggerEvent;
};
declare const TriggerEvents: {
    ExitTrigger: string;
    EnterTrigger: string;
};
/**
 * TriggerOptions
 */
interface TriggerOptions {
    pos?: Vector;
    width?: number;
    height?: number;
    visible?: boolean;
    action?: (entity: Entity) => void;
    target?: Entity;
    filter?: (entity: Entity) => boolean;
    repeat?: number;
}
/**
 * Triggers are a method of firing arbitrary code on collision. These are useful
 * as 'buttons', 'switches', or to trigger effects in a game. By default triggers
 * are invisible, and can only be seen when {@apilink Trigger.visible} is set to \`true\`.
 */
declare class Trigger extends Actor {
    events: EventEmitter<EntityEvents & {
        collisionstart: CollisionStartEvent;
        collisionend: CollisionEndEvent;
        precollision: PreCollisionEvent;
        postcollision: PostCollisionEvent;
        kill: KillEvent;
        prekill: PreKillEvent;
        postkill: PostKillEvent;
        predraw: PreDrawEvent;
        postdraw: PostDrawEvent;
        pretransformdraw: PreDrawEvent;
        posttransformdraw: PostDrawEvent;
        predebugdraw: PreDebugDrawEvent;
        postdebugdraw: PostDebugDrawEvent;
        pointerup: PointerEvent;
        pointerdown: PointerEvent;
        pointerenter: PointerEvent;
        pointerleave: PointerEvent;
        pointermove: PointerEvent;
        pointercancel: PointerEvent;
        pointerwheel: WheelEvent;
        pointerdragstart: PointerEvent;
        pointerdragend: PointerEvent;
        pointerdragenter: PointerEvent;
        pointerdragleave: PointerEvent;
        pointerdragmove: PointerEvent;
        enterviewport: EnterViewPortEvent;
        exitviewport: ExitViewPortEvent;
        actionstart: ActionStartEvent;
        actioncomplete: ActionCompleteEvent;
    } & {
        exit: ExitTriggerEvent;
        enter: EnterTriggerEvent;
    }>;
    target?: Entity;
    /**
     * Action to fire when triggered by collision
     */
    action: (entity: Entity) => void;
    /**
     * Filter to add additional granularity to action dispatch, if a filter is specified the action will only fire when
     * filter return true for the collided entity.
     */
    filter: (entity: Entity) => boolean;
    /**
     * Number of times to repeat before killing the trigger,
     */
    repeat: number;
    /**
     * @param options Trigger options
     */
    constructor(options: TriggerOptions & ActorArgs);
    private _matchesTarget;
    private _dispatchAction;
}

interface DefaultLoaderOptions {
    /**
     * List of loadables
     */
    loadables?: Loadable<any>[];
}
type LoaderEvents = {
    beforeload: void;
    afterload: void;
    useraction: void;
    loadresourcestart: Loadable<any>;
    loadresourceend: Loadable<any>;
};
declare const LoaderEvents: {
    BeforeLoad: string;
    AfterLoad: string;
    UserAction: string;
    LoadResourceStart: string;
    LoadResourceEnd: string;
};
type LoaderConstructor = new (...args: any[]) => DefaultLoader;
/**
 * Returns true if the constructor is for an Excalibur Loader
 */
declare function isLoaderConstructor(x: any): x is LoaderConstructor;
declare class DefaultLoader implements Loadable<Loadable<any>[]> {
    data: Loadable<any>[];
    events: EventEmitter<LoaderEvents>;
    canvas: Canvas;
    private _resources;
    get resources(): readonly Loadable<any>[];
    private _numLoaded;
    engine: Engine;
    /**
     * @param options Optionally provide the list of resources you want to load at constructor time
     */
    constructor(options?: DefaultLoaderOptions);
    /**
     * Called by the engine before loading
     * @param engine
     */
    onInitialize(engine: Engine): void;
    /**
     * Return a promise that resolves when the user interacts with the loading screen in some way, usually a click.
     *
     * It's important to implement this in order to unlock the audio context in the browser. Browsers automatically prevent
     * audio from playing until the user performs an action.
     *
     */
    onUserAction(): Promise<void>;
    /**
     * Overridable lifecycle method, called directly before loading starts
     */
    onBeforeLoad(): Promise<void>;
    /**
     * Overridable lifecycle method, called after loading has completed
     */
    onAfterLoad(): Promise<void>;
    /**
     * Add a resource to the loader to load
     * @param loadable  Resource to add
     */
    addResource(loadable: Loadable<any>): void;
    /**
     * Add a list of resources to the loader to load
     * @param loadables  The list of resources to load
     */
    addResources(loadables: Loadable<any>[]): void;
    markResourceComplete(): void;
    /**
     * Returns the progress of the loader as a number between [0, 1] inclusive.
     */
    get progress(): number;
    /**
     * Returns true if the loader has completely loaded all resources
     */
    isLoaded(): boolean;
    private _totalTimeMs;
    /**
     * Optionally override the onUpdate
     * @param engine
     * @param elapsed
     */
    onUpdate(engine: Engine, elapsed: number): void;
    /**
     * Optionally override the onDraw
     */
    onDraw(ctx: CanvasRenderingContext2D): void;
    private _loadingFuture;
    areResourcesLoaded(): Promise<void>;
    /**
     * Not meant to be overridden
     *
     * Begin loading all of the supplied resources, returning a promise
     * that resolves when loading of all is complete AND the user has interacted with the loading screen
     */
    load(): Promise<Loadable<any>[]>;
    emit<TEventName extends EventKey<LoaderEvents>>(eventName: TEventName, event: LoaderEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<LoaderEvents>>(eventName: TEventName, handler: Handler<LoaderEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<LoaderEvents>>(eventName: TEventName, handler: Handler<LoaderEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<LoaderEvents>>(eventName: TEventName, handler: Handler<LoaderEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
}

type CoroutineGenerator = () => Generator<any | number | Promise<any> | undefined, void, number>;
interface CoroutineOptions {
    /**
     * Coroutines run preframe in the clock by default.
     */
    timing?: ScheduledCallbackTiming;
    /**
     * Coroutines auto start by default, set to false to require play();
     */
    autostart?: boolean;
}
type Thenable = PromiseLike<void>['then'];
interface CoroutineInstance extends PromiseLike<void> {
    isRunning(): boolean;
    isComplete(): boolean;
    done: Promise<void>;
    generator: Generator<CoroutineInstance | number | Promise<any> | undefined, void, number>;
    start: () => CoroutineInstance;
    cancel: () => void;
    then: Thenable;
    [Symbol.iterator]: () => Generator<CoroutineInstance | number | Promise<any> | undefined, void, number>;
}
/**
 * Excalibur coroutine helper, returns a [[CoroutineInstance]] which is promise-like when complete. Coroutines run before frame update by default.
 *
 * Each coroutine yield is 1 excalibur frame. Coroutines get passed the elapsed time our of yield. Coroutines
 * run internally on the excalibur clock.
 *
 * If you yield a promise it will be awaited before resumed
 * If you yield a number it will wait that many ms before resumed
 * @param thisArg set the "this" context of the generator, by default is globalThis
 * @param engine pass a specific engine to use for running the coroutine
 * @param coroutineGenerator coroutine generator function
 * @param {CoroutineOptions} options optionally schedule coroutine pre/post update
 */
declare function coroutine(thisArg: any, engine: Engine, coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): CoroutineInstance;
/**
 * Excalibur coroutine helper, returns a promise when complete. Coroutines run before frame update.
 *
 * Each coroutine yield is 1 excalibur frame. Coroutines get passed the elapsed time our of yield. Coroutines
 * run internally on the excalibur clock.
 *
 * If you yield a promise it will be awaited before resumed
 * If you yield a number it will wait that many ms before resumed
 * @param engine pass a specific engine to use for running the coroutine
 * @param coroutineGenerator coroutine generator function
 * @param {CoroutineOptions} options optionally schedule coroutine pre/post update
 */
declare function coroutine(engine: Engine, coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): CoroutineInstance;
/**
 * Excalibur coroutine helper, returns a promise when complete. Coroutines run before frame update.
 *
 * Each coroutine yield is 1 excalibur frame. Coroutines get passed the elapsed time our of yield. Coroutines
 * run internally on the excalibur clock.
 *
 * If you yield a promise it will be awaited before resumed
 * If you yield a number it will wait that many ms before resumed
 * @param coroutineGenerator coroutine generator function
 * @param {CoroutineOptions} options optionally schedule coroutine pre/post update
 */
declare function coroutine(coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): CoroutineInstance;
/**
 * Excalibur coroutine helper, returns a promise when complete. Coroutines run before frame update.
 *
 * Each coroutine yield is 1 excalibur frame. Coroutines get passed the elapsed time our of yield. Coroutines
 * run internally on the excalibur clock.
 *
 * If you yield a promise it will be awaited before resumed
 * If you yield a number it will wait that many ms before resumed
 * @param thisArg set the "this" context of the generator, by default is globalThis
 * @param coroutineGenerator coroutine generator function
 * @param {CoroutineOptions} options optionally schedule coroutine pre/post update
 */
declare function coroutine(thisArg: any, coroutineGenerator: CoroutineGenerator, options?: CoroutineOptions): CoroutineInstance;

interface TransitionOptions {
    /**
     * Transition duration in milliseconds
     */
    duration: number;
    /**
     * Optionally hides the loader during the transition
     *
     * If either the out or in transition have this set to true, then the loader will be hidden.
     *
     * Default false
     */
    hideLoader?: boolean;
    /**
     * Optionally blocks user input during a transition
     *
     * Default false
     */
    blockInput?: boolean;
    /**
     * Optionally specify a easing function, by default linear
     */
    easing?: EasingFunction;
    /**
     * Optionally specify a transition direction, by default 'out'
     *
     * * For 'in' direction transitions start at 1 and complete is at 0
     * * For 'out' direction transitions start at 0 and complete is at 1
     */
    direction?: 'out' | 'in';
}
/**
 * Base Transition that can be extended to provide custom scene transitions in Excalibur.
 */
declare class Transition extends Entity {
    private _logger;
    transform: TransformComponent;
    graphics: GraphicsComponent;
    readonly hideLoader: boolean;
    readonly blockInput: boolean;
    readonly duration: number;
    readonly easing: EasingFunction;
    readonly direction: 'out' | 'in';
    private _completeFuture;
    protected _engine?: Engine;
    private _co?;
    started: boolean;
    private _currentDistance;
    private _currentProgress;
    done: Promise<void>;
    /**
     * Returns a number between [0, 1] indicating what state the transition is in.
     *
     * * For 'out' direction transitions start at 0 and end at 1
     * * For 'in' direction transitions start at 1 and end at 0
     */
    get progress(): number;
    get complete(): boolean;
    constructor(options: TransitionOptions);
    /**
     * Overridable lifecycle method, called before each update.
     *
     * **WARNING BE SURE** to call \`super.updateTransition()\` if overriding in your own custom implementation
     * @param engine
     * @param elapsed
     */
    updateTransition(engine: Engine, elapsed: number): void;
    /**
     * Overridable lifecycle method, called right before the previous scene has deactivated.
     *
     * This gives incoming transition a chance to grab info from previous scene if desired
     * @param scene
     */
    onPreviousSceneDeactivate(scene: Scene): Promise<void>;
    /**
     * Overridable lifecycle method, called once at the beginning of the transition
     *
     * \`progress\` is given between 0 and 1
     * @param progress
     */
    onStart(progress: number): void;
    /**
     * Overridable lifecycle method, called every frame of the transition
     *
     * \`progress\` is given between 0 and 1
     * @param progress
     */
    onUpdate(progress: number): void;
    /**
     * Overridable lifecycle method, called at the end of the transition,
     *
     * \`progress\` is given between 0 and 1
     * @param progress
     */
    onEnd(progress: number): void;
    /**
     * Overridable lifecycle method, called when the transition is reset
     *
     * Use this to override and provide your own reset logic for internal state in custom transition implementations
     */
    onReset(): void;
    /**
     * reset() is called by the engine to reset transitions
     */
    reset(): void;
    /**
     * @internal
     */
    _addToTargetScene(engine: Engine, targetScene: Scene): CoroutineInstance;
    /**
     * Called internally by excalibur to swap scenes with transition
     * @internal
     */
    _play(): Promise<void>;
    /**
     * execute() is called by the engine every frame to update the Transition lifecycle onStart/onUpdate/onEnd
     * @internal
     */
    _execute(): void;
}

interface FadeOptions {
    duration?: number;
    color?: Color;
}
declare class FadeInOut extends Transition {
    screenCover: Rectangle;
    color: Color;
    constructor(options: FadeOptions & TransitionOptions);
    onInitialize(engine: Engine): void;
    onReset(): void;
    onStart(progress: number): void;
    onEnd(progress: number): void;
    onUpdate(progress: number): void;
}

interface CrossFadeOptions {
    duration: number;
}
/**
 * CrossFades between the previous scene and the destination scene
 *
 * Note: CrossFade only works as an "in" transition
 */
declare class CrossFade extends Transition {
    engine: Engine;
    image: HTMLImageElement;
    screenCover: Sprite;
    constructor(options: TransitionOptions & CrossFadeOptions);
    onPreviousSceneDeactivate(scene: Scene<unknown>): Promise<void>;
    onInitialize(engine: Engine): void;
    onStart(_progress: number): void;
    onReset(): void;
    onEnd(progress: number): void;
    onUpdate(progress: number): void;
}

interface SlideOptions {
    /**
     * Duration of the transition in milliseconds
     */
    duration: number;
    /**
     * Slide direction for the previous scene to move: up, down, left, right
     */
    slideDirection: 'up' | 'down' | 'left' | 'right';
    /**
     * Optionally select an easing function, by default linear (aka lerp)
     */
    easingFunction?: EasingFunction;
}
/**
 * Slide\`s between the previous scene and the destination scene
 *
 * Note: Slide\` only works as an "in" transition
 */
declare class Slide extends Transition {
    private _image;
    private _screenCover;
    private _easing;
    private _vectorEasing;
    readonly slideDirection: 'up' | 'down' | 'left' | 'right';
    constructor(options: TransitionOptions & SlideOptions);
    onPreviousSceneDeactivate(scene: Scene<unknown>): Promise<void>;
    private _destinationCameraPosition;
    private _startCameraPosition;
    private _camera;
    private _directionOffset;
    onInitialize(engine: Engine): void;
    onUpdate(progress: number): void;
}

interface DirectorNavigationEvent {
    sourceName: string;
    sourceScene: Scene;
    destinationName: string;
    destinationScene: Scene;
}
type DirectorEvents = {
    navigationstart: DirectorNavigationEvent;
    navigation: DirectorNavigationEvent;
    navigationend: DirectorNavigationEvent;
};
declare const DirectorEvents: {
    readonly NavigationStart: "navigationstart";
    readonly Navigation: "navigation";
    readonly NavigationEnd: "navigationend";
};
interface SceneWithOptions {
    /**
     * Scene associated with this route
     *
     * If a constructor is provided it will not be constructed until navigation is requested
     */
    scene: Scene | SceneConstructor;
    /**
     * Specify scene transitions
     */
    transitions?: {
        /**
         * Optionally specify a transition when going "in" to this scene
         */
        in?: Transition;
        /**
         * Optionally specify a transition when going "out" of this scene
         */
        out?: Transition;
    };
    /**
     * Optionally specify a loader for the scene
     */
    loader?: DefaultLoader | LoaderConstructor;
}
type WithRoot<TScenes> = TScenes | 'root';
type SceneMap<TKnownScenes extends string = any> = Record<TKnownScenes, Scene | SceneConstructor | SceneWithOptions>;
interface StartOptions {
    /**
     * Optionally provide first transition from the game start screen
     */
    inTransition?: Transition;
    /**
     * Optionally provide a main loader to run before the game starts
     */
    loader?: DefaultLoader | LoaderConstructor;
}
/**
 * Provide scene activation data and override any existing configured route transitions or loaders
 */
interface GoToOptions<TActivationData = any> {
    /**
     * Optionally supply scene activation data passed to Scene.onActivate
     */
    sceneActivationData?: TActivationData;
    /**
     * Optionally supply destination scene "in" transition, this will override any previously defined transition
     */
    destinationIn?: Transition;
    /**
     * Optionally supply source scene "out" transition, this will override any previously defined transition
     */
    sourceOut?: Transition;
    /**
     * Optionally supply a different loader for the destination scene, this will override any previously defined loader
     */
    loader?: DefaultLoader;
}
/**
 * The Director is responsible for managing scenes and changing scenes in Excalibur.
 *
 * It deals with transitions, scene loaders, switching scenes
 *
 * This is used internally by Excalibur, generally not mean to
 * be instantiated end users directly.
 */
declare class Director<TKnownScenes extends string = any> {
    private _engine;
    events: EventEmitter<DirectorEvents>;
    private _logger;
    private _deferredGoto?;
    private _deferredTransition?;
    private _initialized;
    /**
     * Current scene's name
     */
    currentSceneName: string;
    /**
     * Current scene playing in excalibur
     */
    currentScene: Scene;
    /**
     * Current transition if any
     */
    currentTransition?: Transition;
    /**
     * All registered scenes in Excalibur
     */
    readonly scenes: SceneMap<WithRoot<TKnownScenes>>;
    /**
     * Holds all instantiated scenes
     */
    private _sceneToInstance;
    startScene?: string;
    mainLoader?: DefaultLoader;
    /**
     * The default {@apilink Scene} of the game, use {@apilink Engine.goToScene} to transition to different scenes.
     */
    readonly rootScene: Scene;
    private _sceneToLoader;
    private _sceneToTransition;
    /**
     * Used to keep track of scenes that have already been loaded so we don't load multiple times
     */
    private _loadedScenes;
    private _isTransitioning;
    /**
     * Gets whether the director currently transitioning between scenes
     *
     * Useful if you need to block behavior during transition
     */
    get isTransitioning(): boolean;
    constructor(_engine: Engine, scenes: SceneMap<TKnownScenes>);
    /**
     * Initialize the director's internal state
     */
    onInitialize(): Promise<void>;
    get isInitialized(): boolean;
    /**
     * Configures the start scene, and optionally the transition & loader for the director
     *
     * Typically this is called at the beginning of the game to the start scene and transition and never again.
     * @param startScene
     * @param options
     */
    configureStart(startScene: WithRoot<TKnownScenes>, options?: StartOptions): void;
    private _getLoader;
    private _getInTransition;
    private _getOutTransition;
    getDeferredScene(): Scene<unknown> | SceneConstructor;
    /**
     * Returns a scene by name if it exists, might be the constructor and not the instance of a scene
     * @param name
     */
    getSceneDefinition(name?: string): Scene | SceneConstructor | undefined;
    /**
     * Returns the name of the registered scene, null if none can be found
     * @param scene
     */
    getSceneName(scene: Scene): string | null;
    /**
     * Returns the same Director, but asserts a scene DOES exist to the type system
     * @param name
     */
    assertAdded<TScene extends string>(name: TScene): Director<TKnownScenes | TScene>;
    /**
     * Returns the same Director, but asserts a scene DOES NOT exist to the type system
     * @param name
     */
    assertRemoved<TScene extends string>(name: TScene): Director<Exclude<TKnownScenes, TScene>>;
    /**
     * Adds additional Scenes to the game!
     * @param name
     * @param sceneOrRoute
     */
    add<TScene extends string>(name: TScene, sceneOrRoute: Scene | SceneConstructor | SceneWithOptions): Director<TKnownScenes | TScene>;
    remove(scene: Scene): void;
    remove(sceneCtor: SceneConstructor): void;
    remove(name: WithRoot<TKnownScenes>): void;
    /**
     * Go to a specific scene, and optionally override loaders and transitions
     * @param destinationScene
     * @param options
     */
    goToScene(destinationScene: TKnownScenes | string, options?: GoToOptions): Promise<void>;
    /**
     * Retrieves a scene instance by key if it's registered.
     *
     * This will call any constructors that were given as a definition
     * @param scene
     */
    getSceneInstance(scene: string): Scene | undefined;
    /**
     * Triggers scene loading if has not already been loaded
     * @param scene
     * @param hideLoader
     */
    maybeLoadScene(scene: string, hideLoader?: boolean): Promise<void>;
    /**
     * Plays a transition in the current scene and does book keeping for input.
     * @param transition
     */
    playTransition(transition: Transition, targetScene: Scene): Promise<void>;
    /**
     * Swaps the current and destination scene after performing required lifecycle events
     *
     * Note: swap scene will wait for any pending loader on the destination scene
     * @param destinationScene
     * @param data
     */
    swapScene<TData = undefined>(destinationScene: string, data?: TData): Promise<void>;
    private _emitEvent;
}

/**
 * Future is a wrapper around a native browser Promise to allow resolving/rejecting at any time
 */
declare class Future<T> {
    private _resolver;
    private _rejecter;
    private _isCompleted;
    constructor();
    readonly promise: Promise<T>;
    get isCompleted(): boolean;
    resolve(value: T): void;
    reject(error: Error): void;
}

interface LoaderOptions extends DefaultLoaderOptions {
    /**
     * Go fullscreen after loading and clicking play
     */
    fullscreenAfterLoad?: boolean;
    /**
     * Fullscreen container element or id
     */
    fullscreenContainer?: HTMLElement | string;
}
/**
 * Pre-loading assets
 *
 * The loader provides a mechanism to preload multiple resources at
 * one time. The loader must be passed to the engine in order to
 * trigger the loading progress bar.
 *
 * The {@apilink Loader} itself implements {@apilink Loadable} so you can load loaders.
 *
 * ## Example: Pre-loading resources for a game
 *
 * \`\`\`js
 * // create a loader
 * var loader = new ex.Loader();
 *
 * // create a resource dictionary (best practice is to keep a separate file)
 * var resources = {
 *   TextureGround: new ex.Texture("/images/textures/ground.png"),
 *   SoundDeath: new ex.Sound("/sound/death.wav", "/sound/death.mp3")
 * };
 *
 * // loop through dictionary and add to loader
 * for (var loadable in resources) {
 *   if (resources.hasOwnProperty(loadable)) {
 *     loader.addResource(resources[loadable]);
 *   }
 * }
 *
 * // start game
 * game.start(loader).then(function () {
 *   console.log("Game started!");
 * });
 * \`\`\`
 *
 * ## Customize the Loader
 *
 * The loader can be customized to show different, text, logo, background color, and button.
 *
 * \`\`\`typescript
 * const loader = new ex.Loader([playerTexture]);
 *
 * // The loaders button text can simply modified using this
 * loader.playButtonText = 'Start the best game ever';
 *
 * // The logo can be changed by inserting a base64 image string here
 *
 * loader.logo = 'data:image/png;base64,iVBORw...';
 * loader.logoWidth = 15;
 * loader.logoHeight = 14;
 *
 * // The background color can be changed like so by supplying a valid CSS color string
 *
 * loader.backgroundColor = 'red'
 * loader.backgroundColor = '#176BAA'
 *
 * // To build a completely new button
 * loader.startButtonFactory = () => {
 *     let myButton = document.createElement('button');
 *     myButton.textContent = 'The best button';
 *     return myButton;
 * };
 *
 * engine.start(loader).then(() => {});
 * \`\`\`
 */
declare class Loader extends DefaultLoader {
    private _logger;
    private static _DEFAULT_LOADER_OPTIONS;
    private _originalOptions;
    events: EventEmitter<any>;
    screen: Screen;
    private _playButtonShown;
    logo: string;
    logoWidth: number;
    logoHeight: number;
    /**
     * Positions the top left corner of the logo image
     * If not set, the loader automatically positions the logo
     */
    logoPosition: Vector | null;
    /**
     * Positions the top left corner of the play button.
     * If not set, the loader automatically positions the play button
     */
    playButtonPosition: Vector | null;
    /**
     * Positions the top left corner of the loading bar
     * If not set, the loader automatically positions the loading bar
     */
    loadingBarPosition: Vector | null;
    /**
     * Gets or sets the color of the loading bar, default is {@apilink Color.White}
     */
    loadingBarColor: Color;
    /**
     * Gets or sets the background color of the loader as a hex string
     */
    backgroundColor: string;
    protected _imageElement: HTMLImageElement;
    protected _imageLoaded: Future<void>;
    protected get _image(): HTMLImageElement;
    suppressPlayButton: boolean;
    get playButtonRootElement(): HTMLElement | null;
    get playButtonElement(): HTMLButtonElement | null;
    protected _playButtonRootElement: HTMLElement;
    protected _playButtonElement: HTMLButtonElement;
    protected _styleBlock: HTMLStyleElement;
    /** Loads the css from Loader.css */
    protected _playButtonStyles: string;
    protected get _playButton(): HTMLButtonElement;
    /**
     * Get/set play button text
     */
    playButtonText: string;
    /**
     * Return a html button element for excalibur to use as a play button
     */
    startButtonFactory: () => HTMLButtonElement;
    /**
     * @param options Optionally provide options to loader
     */
    constructor(options?: LoaderOptions);
    /**
     * @param loadables  Optionally provide the list of resources you want to load at constructor time
     */
    constructor(loadables?: Loadable<any>[]);
    onInitialize(engine: Engine): void;
    /**
     * Shows the play button and returns a promise that resolves when clicked
     */
    showPlayButton(): Promise<void>;
    hidePlayButton(): void;
    /**
     * Clean up generated elements for the loader
     */
    dispose(): void;
    data: Loadable<any>[];
    onUserAction(): Promise<void>;
    onBeforeLoad(): Promise<void>;
    onAfterLoad(): Promise<void>;
    private _positionPlayButton;
    /**
     * Loader draw function. Draws the default Excalibur loading screen.
     * Override \`logo\`, \`logoWidth\`, \`logoHeight\` and \`backgroundColor\` properties
     * to customize the drawing, or just override entire method.
     */
    onDraw(ctx: CanvasRenderingContext2D): void;
}

type GamepadEvents = {
    connect: GamepadConnectEvent;
    disconnect: GamepadDisconnectEvent;
    button: GamepadButtonEvent;
    axis: GamepadAxisEvent;
};
declare const GamepadEvents: {
    GamepadConnect: string;
    GamepadDisconnect: string;
    GamepadButton: string;
    GamepadAxis: string;
};
/**
 * Excalibur leverages the HTML5 Gamepad API [where it is supported](http://caniuse.com/#feat=gamepad)
 * to provide controller support for your games.
 */
declare class Gamepads {
    events: EventEmitter<GamepadEvents>;
    /**
     * Whether or not to poll for Gamepad input (default: \`false\`)
     */
    enabled: boolean;
    /**
     * Whether or not Gamepad API is supported
     */
    supported: boolean;
    /**
     * The minimum value an axis has to move before considering it a change
     */
    static MinAxisMoveThreshold: number;
    private _gamePadTimeStamps;
    private _oldPads;
    private _pads;
    private _initSuccess;
    private _navigator;
    private _minimumConfiguration;
    private _enabled;
    init(): void;
    toggleEnabled(enabled: boolean): void;
    /**
     * Sets the minimum gamepad configuration, for example {axis: 4, buttons: 4} means
     * this game requires at minimum 4 axis inputs and 4 buttons, this is not restrictive
     * all other controllers with more axis or buttons are valid as well. If no minimum
     * configuration is set all pads are valid.
     */
    setMinimumGamepadConfiguration(config: GamepadConfiguration): void;
    /**
     * When implicitly enabled, set the enabled flag and run an update so information is updated
     */
    private _enableAndUpdate;
    /**
     * Checks a navigator gamepad against the minimum configuration if present.
     */
    private _isGamepadValid;
    emit<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, event: GamepadEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, handler: Handler<GamepadEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, handler: Handler<GamepadEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, handler: Handler<GamepadEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * Updates Gamepad state and publishes Gamepad events
     */
    update(): void;
    /**
     * Safely retrieves a Gamepad at a specific index and creates one if it doesn't yet exist
     */
    at(index: number): Gamepad;
    /**
     * Returns a list of all valid gamepads that meet the minimum configuration requirement.
     */
    getValidGamepads(): Gamepad[];
    /**
     * Gets the number of connected gamepads
     */
    count(): number;
    private _clonePads;
    /**
     * Fastest way to clone a known object is to do it yourself
     */
    private _clonePad;
}
/**
 * Gamepad holds state information for a connected controller. See {@apilink Gamepads}
 * for more information on handling controller input.
 */
declare class Gamepad {
    events: EventEmitter<GamepadEvents>;
    connected: boolean;
    navigatorGamepad: NavigatorGamepad;
    private _axes;
    private _buttons;
    private _buttonsUp;
    private _buttonsDown;
    constructor();
    update(): void;
    /**
     * Whether or not the given button is pressed
     * @deprecated will be removed in v0.28.0. Use isButtonHeld instead
     * @param button     The button to query
     * @param threshold  The threshold over which the button is considered to be pressed
     */
    isButtonPressed(button: Buttons | number, threshold?: number): boolean;
    /**
     * Tests if a certain button is held down. This is persisted between frames.
     * @param button     The button to query
     * @param threshold  The threshold over which the button is considered to be pressed
     */
    isButtonHeld(button: Buttons | number, threshold?: number): boolean;
    /**
     * Tests if a certain button was just pressed this frame. This is cleared at the end of the update frame.
     * @param button Test whether a button was just pressed
     * @param threshold  The threshold over which the button is considered to be pressed
     */
    wasButtonPressed(button: Buttons | number, threshold?: number): boolean;
    /**
     * Tests if a certain button was just released this frame. This is cleared at the end of the update frame.
     * @param button  Test whether a button was just released
     */
    wasButtonReleased(button: Buttons | number): boolean;
    /**
     * Gets the given button value between 0 and 1
     */
    getButton(button: Buttons | number): number;
    /**
     * Gets the given axis value between -1 and 1. Values below
     * {@apilink MinAxisMoveThreshold} are considered 0.
     */
    getAxes(axes: Axes | number): number;
    updateButton(buttonIndex: number, value: number): void;
    updateAxes(axesIndex: number, value: number): void;
    emit<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, event: GamepadEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, handler: Handler<GamepadEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, handler: Handler<GamepadEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<GamepadEvents>>(eventName: TEventName, handler: Handler<GamepadEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
}
/**
 * Gamepad Buttons enumeration
 */
declare enum Buttons {
    /**
     * Any button that isn't explicity known by excalibur
     */
    Unknown = -1,
    /**
     * Face 1 button (e.g. A)
     */
    Face1 = 0,
    /**
     * Face 2 button (e.g. B)
     */
    Face2 = 1,
    /**
     * Face 3 button (e.g. X)
     */
    Face3 = 2,
    /**
     * Face 4 button (e.g. Y)
     */
    Face4 = 3,
    /**
     * Left bumper button
     */
    LeftBumper = 4,
    /**
     * Right bumper button
     */
    RightBumper = 5,
    /**
     * Left trigger button
     */
    LeftTrigger = 6,
    /**
     * Right trigger button
     */
    RightTrigger = 7,
    /**
     * Select button
     */
    Select = 8,
    /**
     * Start button
     */
    Start = 9,
    /**
     * Left analog stick press (e.g. L3)
     */
    LeftStick = 10,
    /**
     * Right analog stick press (e.g. R3)
     */
    RightStick = 11,
    /**
     * D-pad up
     */
    DpadUp = 12,
    /**
     * D-pad down
     */
    DpadDown = 13,
    /**
     * D-pad left
     */
    DpadLeft = 14,
    /**
     * D-pad right
     */
    DpadRight = 15,
    /**
     * Center button (e.g. the Nintendo Home Button)
     */
    CenterButton = 16,
    /**
     * Misc button 1 (e.g. Xbox Series X share button, PS5 microphone button, Nintendo Switch Pro capture button, Amazon Luna microphone button)
     * defacto standard not listed on the w3c spec for a standard gamepad https://w3c.github.io/gamepad/#dfn-standard-gamepad
     */
    MiscButton1 = 17
}
/**
 * Gamepad Axes enumeration
 */
declare enum Axes {
    /**
     * Left analogue stick X direction
     */
    LeftStickX = 0,
    /**
     * Left analogue stick Y direction
     */
    LeftStickY = 1,
    /**
     * Right analogue stick X direction
     */
    RightStickX = 2,
    /**
     * Right analogue stick Y direction
     */
    RightStickY = 3
}
/**
 * @internal
 */
interface NavigatorGamepads {
    getGamepads(): (NavigatorGamepad | undefined)[];
}
/**
 * @internal
 */
interface NavigatorGamepad {
    axes: number[];
    buttons: NavigatorGamepadButton[];
    connected: boolean;
    id: string;
    index: number;
    mapping: string;
    timestamp: number;
}
/**
 * @internal
 */
interface NavigatorGamepadButton {
    pressed: boolean;
    value: number;
}
/**
 * @internal
 */
interface NavigatorGamepadEvent {
    gamepad: NavigatorGamepad;
}
/**
 * @internal
 */
interface GamepadConfiguration {
    axis: number;
    buttons: number;
}

/**
 * Enum representing physical input key codes
 *
 * Spec: https://w3c.github.io/uievents-code/#key-alphanumeric-section
 */
declare enum Keys {
    Backquote = "Backquote",
    Backslash = "Backslash",
    BracketLeft = "BracketLeft",
    BracketRight = "BracketRight",
    Comma = "Comma",
    Key0 = "Digit0",
    Key1 = "Digit1",
    Key2 = "Digit2",
    Key3 = "Digit3",
    Key4 = "Digit4",
    Key5 = "Digit5",
    Key6 = "Digit6",
    Key7 = "Digit7",
    Key8 = "Digit8",
    Key9 = "Digit9",
    Digit0 = "Digit0",
    Digit1 = "Digit1",
    Digit2 = "Digit2",
    Digit3 = "Digit3",
    Digit4 = "Digit4",
    Digit5 = "Digit5",
    Digit6 = "Digit6",
    Digit7 = "Digit7",
    Digit8 = "Digit8",
    Digit9 = "Digit9",
    Equal = "Equal",
    IntlBackslash = "IntlBackslash",
    IntlRo = "IntlRo",
    IntlYen = "IntlYen",
    A = "KeyA",
    B = "KeyB",
    C = "KeyC",
    D = "KeyD",
    E = "KeyE",
    F = "KeyF",
    G = "KeyG",
    H = "KeyH",
    I = "KeyI",
    J = "KeyJ",
    K = "KeyK",
    L = "KeyL",
    M = "KeyM",
    N = "KeyN",
    O = "KeyO",
    P = "KeyP",
    Q = "KeyQ",
    R = "KeyR",
    S = "KeyS",
    T = "KeyT",
    U = "KeyU",
    V = "KeyV",
    W = "KeyW",
    X = "KeyX",
    Y = "KeyY",
    Z = "KeyZ",
    KeyA = "KeyA",
    KeyB = "KeyB",
    KeyC = "KeyC",
    KeyD = "KeyD",
    KeyE = "KeyE",
    KeyF = "KeyF",
    KeyG = "KeyG",
    KeyH = "KeyH",
    KeyI = "KeyI",
    KeyJ = "KeyJ",
    KeyK = "KeyK",
    KeyL = "KeyL",
    KeyM = "KeyM",
    KeyN = "KeyN",
    KeyO = "KeyO",
    KeyP = "KeyP",
    KeyQ = "KeyQ",
    KeyR = "KeyR",
    KeyS = "KeyS",
    KeyT = "KeyT",
    KeyU = "KeyU",
    KeyV = "KeyV",
    KeyW = "KeyW",
    KeyX = "KeyX",
    KeyY = "KeyY",
    KeyZ = "KeyZ",
    Minus = "Minus",
    Period = "Period",
    Quote = "Quote",
    Semicolon = "Semicolon",
    Slash = "Slash",
    AltLeft = "AltLeft",
    AltRight = "AltRight",
    Alt = "Alt",
    AltGraph = "AltGraph",
    Backspace = "Backspace",
    CapsLock = "CapsLock",
    ContextMenu = "ContextMenu",
    ControlLeft = "ControlLeft",
    ControlRight = "ControlRight",
    Enter = "Enter",
    MetaLeft = "MetaLeft",
    MetaRight = "MetaRight",
    ShiftLeft = "ShiftLeft",
    ShiftRight = "ShiftRight",
    Space = "Space",
    Tab = "Tab",
    Convert = "Convert",
    KanaMode = "KanaMode",
    NonConvert = "NonConvert",
    Delete = "Delete",
    End = "End",
    Help = "Help",
    Home = "Home",
    Insert = "Insert",
    PageDown = "PageDown",
    PageUp = "PageUp",
    Up = "ArrowUp",
    Down = "ArrowDown",
    Left = "ArrowLeft",
    Right = "ArrowRight",
    ArrowUp = "ArrowUp",
    ArrowDown = "ArrowDown",
    ArrowLeft = "ArrowLeft",
    ArrowRight = "ArrowRight",
    NumLock = "NumLock",
    Numpad0 = "Numpad0",
    Numpad1 = "Numpad1",
    Numpad2 = "Numpad2",
    Numpad3 = "Numpad3",
    Numpad4 = "Numpad4",
    Numpad5 = "Numpad5",
    Numpad6 = "Numpad6",
    Numpad7 = "Numpad7",
    Numpad8 = "Numpad8",
    Numpad9 = "Numpad9",
    Num0 = "Numpad0",
    Num1 = "Numpad1",
    Num2 = "Numpad2",
    Num3 = "Numpad3",
    Num4 = "Numpad4",
    Num5 = "Numpad5",
    Num6 = "Numpad6",
    Num7 = "Numpad7",
    Num8 = "Numpad8",
    Num9 = "Numpad9",
    NumAdd = "NumpadAdd",
    NumpadAdd = "NumpadAdd",
    NumDecimal = "NumpadDecimal",
    NumpadDecimal = "NumpadDecimal",
    NumDivide = "NumpadDivide",
    NumpadDivide = "NumpadDivide",
    NumEnter = "NumpadEnter",
    NumpadEnter = "NumpadEnter",
    NumMultiply = "NumpadMultiply",
    NumpadMultiply = "NumpadMultiply",
    NumSubtract = "NumpadSubtract",
    NumpadSubtract = "NumpadSubtract",
    Esc = "Escape",
    Escape = "Escape",
    F1 = "F1",
    F2 = "F2",
    F3 = "F3",
    F4 = "F4",
    F5 = "F5",
    F6 = "F6",
    F7 = "F7",
    F8 = "F8",
    F9 = "F9",
    F10 = "F10",
    F11 = "F11",
    F12 = "F12",
    F13 = "F13",
    F14 = "F14",
    F15 = "F15",
    F16 = "F16",
    F17 = "F17",
    F18 = "F18",
    F19 = "F19",
    F20 = "F20",
    PrintScreen = "PrintScreen",
    ScrollLock = "ScrollLock",
    Pause = "Pause",
    Unidentified = "Unidentified"
}
/**
 * Event thrown on a game object for a key event
 */
declare class KeyEvent extends GameEvent<any> {
    key: Keys;
    value?: string;
    originalEvent?: KeyboardEvent;
    /**
     * @param key  The key responsible for throwing the event
     * @param value The key's typed value the browser detected
     * @param originalEvent The original keyboard event that Excalibur handled
     */
    constructor(key: Keys, value?: string, originalEvent?: KeyboardEvent);
}
interface KeyboardInitOptions {
    global: GlobalEventHandlers | (() => GlobalEventHandlers);
    grabWindowFocus?: boolean;
}
type KeyEvents = {
    press: KeyEvent;
    hold: KeyEvent;
    release: KeyEvent;
};
declare const KeyEvents: {
    Press: string;
    Hold: string;
    Release: string;
};
/**
 * Provides keyboard support for Excalibur.
 */
declare class Keyboard {
    events: EventEmitter<KeyEvents>;
    private _enabled;
    /**
     * Keys that are currently held down
     */
    private _keys;
    /**
     * Keys up in the current frame
     */
    private _keysUp;
    /**
     * Keys down in the current frame
     */
    private _keysDown;
    emit<TEventName extends EventKey<KeyEvents>>(eventName: TEventName, event: KeyEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<KeyEvents>>(eventName: TEventName, handler: Handler<KeyEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<KeyEvents>>(eventName: TEventName, handler: Handler<KeyEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<KeyEvents>>(eventName: TEventName, handler: Handler<KeyEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * Initialize Keyboard event listeners
     */
    init(keyboardOptions?: KeyboardInitOptions): void;
    toggleEnabled(enabled: boolean): void;
    private _releaseAllKeys;
    clear(): void;
    private _handleKeyDown;
    private _handleKeyUp;
    update(): void;
    /**
     * Gets list of keys being pressed down
     */
    getKeys(): Keys[];
    /**
     * Tests if a certain key was just pressed this frame. This is cleared at the end of the update frame.
     * @param key Test whether a key was just pressed
     */
    wasPressed(key: Keys): boolean;
    /**
     * Tests if a certain key is held down. This is persisted between frames.
     * @param key  Test whether a key is held down
     */
    isHeld(key: Keys): boolean;
    /**
     * Tests if a certain key was just released this frame. This is cleared at the end of the update frame.
     * @param key  Test whether a key was just released
     */
    wasReleased(key: Keys): boolean;
    /**
     * Trigger a manual key event
     * @param type
     * @param key
     * @param character
     */
    triggerEvent(type: 'down' | 'up', key: Keys, character?: string): void;
}

interface InputsOptions {
    keyboard: Keyboard;
    gamepads: Gamepads;
    pointers: PointerEventReceiver;
}
/**
 * This allows you to map multiple inputs to specific commands! This is especially useful when
 * you need to allow multiple input sources to control a specific action.
 */
declare class InputMapper {
    inputs: InputsOptions;
    private _handlers;
    constructor(inputs: InputsOptions);
    /**
     * Executes the input map, called internally by Excalibur
     */
    execute(): void;
    /**
     * This allows you to map multiple inputs to specific commands! This is useful
     *
     * The inputHandler should return a truthy value if you wish the commandHandler to fire.
     *
     * Example:
     * \`\`\`typescript
     * const moveRight = (amount: number) => { actor.vel.x = 100 * amount }
     * const moveLeft = (amount: number) => { actor.vel.x = -100 * amount }
     * const moveUp = (amount: number) => { actor.vel.y = -100 * amount }
     * const moveDown = (amount: number) => { actor.vel.y = 100 * amount }
     *
     * engine.inputMapper.on(({keyboard}) => keyboard.isHeld(ex.Keys.ArrowRight) ? 1 : 0, moveRight);
     * engine.inputMapper.on(({gamepads}) => gamepads.at(0).isButtonPressed(ex.Buttons.DpadRight) ? 1 : 0, moveRight);
     * engine.inputMapper.on(({gamepads}) => gamepads.at(0).getAxes(ex.Axes.LeftStickX) > 0 ?
     *  gamepads.at(0).getAxes(ex.Axes.LeftStickX) : 0, moveRight);
     * \`\`\`
     * @param inputHandler
     * @param commandHandler
     */
    on<TInputHandlerData>(inputHandler: (inputs: InputsOptions) => TInputHandlerData | false, commandHandler: (data: TInputHandlerData) => any): void;
}

interface InputHostOptions {
    pointerTarget: Document | HTMLCanvasElement;
    grabWindowFocus: boolean;
    global?: GlobalEventHandlers | (() => GlobalEventHandlers);
    engine: Engine;
}
declare class InputHost {
    private _enabled;
    keyboard: Keyboard;
    pointers: PointerEventReceiver;
    gamepads: Gamepads;
    inputMapper: InputMapper;
    constructor(options: InputHostOptions);
    get enabled(): boolean;
    toggleEnabled(enabled: boolean): void;
    update(): void;
    clear(): void;
}

declare class PreLoadEvent {
    loader: DefaultLoader;
}
type SceneEvents = {
    initialize: InitializeEvent<Scene>;
    activate: ActivateEvent;
    deactivate: DeactivateEvent;
    preupdate: PreUpdateEvent;
    postupdate: PostUpdateEvent;
    predraw: PreDrawEvent;
    postdraw: PostDrawEvent;
    predebugdraw: PreDebugDrawEvent;
    postdebugdraw: PostDebugDrawEvent;
    preload: PreLoadEvent;
    transitionstart: Transition;
    transitionend: Transition;
};
declare const SceneEvents: {
    readonly Initialize: "initialize";
    readonly Activate: "activate";
    readonly Deactivate: "deactivate";
    readonly PreUpdate: "preupdate";
    readonly PostUpdate: "postupdate";
    readonly PreDraw: "predraw";
    readonly PostDraw: "postdraw";
    readonly PreDebugDraw: "predebugdraw";
    readonly PostDebugDraw: "postdebugdraw";
    readonly PreLoad: "preload";
    readonly TransitionStart: "transitionstart";
    readonly TransitionEnd: "transitionend";
};
type SceneConstructor = new (...args: any[]) => Scene;
/**
 *
 */
declare function isSceneConstructor(x: any): x is SceneConstructor;
/**
 * {@apilink Actor | \`Actors\`} are composed together into groupings called Scenes in
 * Excalibur. The metaphor models the same idea behind real world
 * actors in a scene. Only actors in scenes will be updated and drawn.
 *
 * Typical usages of a scene include: levels, menus, loading screens, etc.
 *
 * Scenes go through the following lifecycle
 * 1. onPreLoad - called once
 * 2. onInitialize - called once
 * 3. onActivate - called the first frame the scene is current
 * 4. onPreUpdate - called every update
 * 5. onPostUpdate - called every update
 * 6. onPreDraw - called every draw
 * 7. onPostDraw - called every draw
 * 8. onDeactivate - called teh first frame thescene is no longer current
 *
 */
declare class Scene<TActivationData = unknown> implements CanInitialize, CanActivate<TActivationData>, CanDeactivate, CanUpdate, CanDraw {
    private _logger;
    events: EventEmitter<SceneEvents>;
    /**
     * Gets or sets the current camera for the scene
     */
    camera: Camera;
    /**
     * Scene specific background color
     */
    backgroundColor?: Color;
    /**
     * The ECS world for the scene
     */
    world: World;
    /**
     * The Excalibur physics world for the scene. Used to interact
     * with colliders included in the scene.
     *
     * Can be used to perform scene ray casts, track colliders, broadphase, and narrowphase.
     */
    physics: PhysicsWorld;
    /**
     * The actors in the current scene
     */
    get actors(): readonly Actor[];
    /**
     * The entities in the current scene
     */
    get entities(): readonly Entity[];
    /**
     * The triggers in the current scene
     */
    get triggers(): readonly Trigger[];
    /**
     * The {@apilink TileMap}s in the scene, if any
     */
    get tileMaps(): readonly TileMap[];
    /**
     * Access to the Excalibur engine
     */
    engine: Engine;
    /**
     * Access scene specific input, handlers on this only fire when this scene is active.
     */
    input: InputHost;
    private _isInitialized;
    private _timers;
    get timers(): readonly Timer[];
    private _cancelQueue;
    constructor();
    emit<TEventName extends EventKey<SceneEvents>>(eventName: TEventName, event: SceneEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<SceneEvents>>(eventName: TEventName, handler: Handler<SceneEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<SceneEvents>>(eventName: TEventName, handler: Handler<SceneEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<SceneEvents>>(eventName: TEventName, handler: Handler<SceneEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * Event hook to provide Scenes a way of loading scene specific resources.
     *
     * This is called before the Scene.onInitialize during scene transition. It will only ever fire once for a scene.
     * @param loader
     */
    onPreLoad(loader: DefaultLoader): void;
    /**
     * Event hook fired directly before transition, either "in" or "out" of the scene
     *
     * This overrides the Engine scene definition. However transitions specified in goToScene take highest precedence
     *
     * \`\`\`typescript
     * // Overrides all
     * Engine.goToScene('scene', { destinationIn: ..., sourceOut: ... });
     * \`\`\`
     *
     * This can be used to configure custom transitions for a scene dynamically
     */
    onTransition(direction: 'in' | 'out'): Transition | undefined;
    /**
     * This is called before the first update of the {@apilink Scene}. Initializes scene members like the camera. This method is meant to be
     * overridden. This is where initialization of child actors should take place.
     */
    onInitialize(engine: Engine): void;
    /**
     * This is called when the scene is made active and started. It is meant to be overridden,
     * this is where you should setup any DOM UI or event handlers needed for the scene.
     */
    onActivate(context: SceneActivationContext<TActivationData>): void;
    /**
     * This is called when the scene is made transitioned away from and stopped. It is meant to be overridden,
     * this is where you should cleanup any DOM UI or event handlers needed for the scene.
     * @returns Either data to pass to the next scene activation context as \`previousSceneData\` or nothing
     */
    onDeactivate(context: SceneActivationContext): any | void;
    /**
     * Safe to override onPreUpdate lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPreUpdate\` is called directly before a scene is updated.
     * @param engine reference to the engine
     * @param elapsed  Number of milliseconds elapsed since the last draw.
     */
    onPreUpdate(engine: Engine, elapsed: number): void;
    /**
     * Safe to override onPostUpdate lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPostUpdate\` is called directly after a scene is updated.
     * @param engine reference to the engine
     * @param elapsed  Number of milliseconds elapsed since the last draw.
     */
    onPostUpdate(engine: Engine, elapsed: number): void;
    /**
     * Safe to override onPreDraw lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPreDraw\` is called directly before a scene is drawn.
     *
     */
    onPreDraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Safe to override onPostDraw lifecycle event handler. Synonymous with \`.on('preupdate', (evt) =>{...})\`
     *
     * \`onPostDraw\` is called directly after a scene is drawn.
     *
     */
    onPostDraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Initializes actors in the scene
     */
    private _initializeChildren;
    /**
     * Gets whether or not the {@apilink Scene} has been initialized
     */
    get isInitialized(): boolean;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Initializes the scene before the first update, meant to be called by engine not by users of
     * Excalibur
     * @internal
     */
    _initialize(engine: Engine): Promise<void>;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Activates the scene with the base behavior, then calls the overridable \`onActivate\` implementation.
     * @internal
     */
    _activate(context: SceneActivationContext<TActivationData>): Promise<void>;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Deactivates the scene with the base behavior, then calls the overridable \`onDeactivate\` implementation.
     * @internal
     */
    _deactivate(context: SceneActivationContext<never>): Promise<any>;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPreUpdate} lifecycle event
     * @internal
     */
    _preupdate(engine: Engine, elapsed: number): void;
    /**
     *  It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _preupdate handler for {@apilink onPostUpdate} lifecycle event
     * @internal
     */
    _postupdate(engine: Engine, elapsed: number): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _predraw handler for {@apilink onPreDraw} lifecycle event
     * @internal
     */
    _predraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * It is not recommended that internal excalibur methods be overridden, do so at your own risk.
     *
     * Internal _postdraw handler for {@apilink onPostDraw} lifecycle event
     * @internal
     */
    _postdraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Updates all the actors and timers in the scene. Called by the {@apilink Engine}.
     * @param engine  Reference to the current Engine
     * @param elapsed   The number of milliseconds since the last update
     */
    update(engine: Engine, elapsed: number): void;
    /**
     * Draws all the actors in the Scene. Called by the {@apilink Engine}.
     * @param ctx    The current rendering context
     * @param elapsed  The number of milliseconds since the last draw
     */
    draw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Draws all the actors' debug information in the Scene. Called by the {@apilink Engine}.
     * @param ctx  The current rendering context
     */
    debugDraw(ctx: ExcaliburGraphicsContext): void;
    /**
     * Checks whether an actor is contained in this scene or not
     */
    contains(actor: Actor): boolean;
    /**
     * Adds a {@apilink Timer} to the current {@apilink Scene}.
     * @param timer  The timer to add to the current {@apilink Scene}.
     */
    add(timer: Timer): void;
    /**
     * Adds a {@apilink TileMap} to the {@apilink Scene}, once this is done the {@apilink TileMap} will be drawn and updated.
     */
    add(tileMap: TileMap): void;
    /**
     * Adds a {@apilink Trigger} to the {@apilink Scene}, once this is done the {@apilink Trigger} will listen for interactions with other actors.
     * @param trigger
     */
    add(trigger: Trigger): void;
    /**
     * Adds an actor to the scene, once this is done the {@apilink Actor} will be drawn and updated.
     * @param actor  The actor to add to the current scene
     */
    add(actor: Actor): void;
    /**
     * Adds an {@apilink Entity} to the scene, once this is done the {@apilink Actor} will be drawn and updated.
     * @param entity The entity to add to the current scene
     */
    add(entity: Entity): void;
    /**
     * Adds a {@apilink ScreenElement} to the scene.
     * @param screenElement  The ScreenElement to add to the current scene
     */
    add(screenElement: ScreenElement): void;
    /**
     * Removes a {@apilink Timer} from it's current scene
     * and adds it to this scene.
     *
     * Useful if you want to have an object be present in only 1 scene at a time.
     * @param timer The Timer to transfer to the current scene
     */
    transfer(timer: Timer): void;
    /**
     * Removes a {@apilink TileMap} from it's current scene
     * and adds it to this scene.
     *
     * Useful if you want to have an object be present in only 1 scene at a time.
     * @param tileMap The TileMap to transfer to the current scene
     */
    transfer(tileMap: TileMap): void;
    /**
     * Removes a {@apilink Trigger} from it's current scene
     * and adds it to this scene.
     *
     * Useful if you want to have an object be present in only 1 scene at a time.
     * @param trigger The Trigger to transfer to the current scene
     */
    transfer(trigger: Trigger): void;
    /**
     * Removes an {@apilink Actor} from it's current scene
     * and adds it to this scene.
     *
     * Useful if you want to have an object be present in only 1 scene at a time.
     * @param actor The Actor to transfer to the current scene
     */
    transfer(actor: Actor): void;
    /**
     * Removes an {@apilink Entity} from it's current scene
     * and adds it to this scene.
     *
     * Useful if you want to have an object be present in only 1 scene at a time.
     * @param entity The Entity to transfer to the current scene
     */
    transfer(entity: Entity): void;
    /**
     * Removes a {@apilink ScreenElement} from it's current scene
     * and adds it to this scene.
     *
     * Useful if you want to have an object be present in only 1 scene at a time.
     * @param screenElement The ScreenElement to transfer to the current scene
     */
    transfer(screenElement: ScreenElement): void;
    /**
     * Removes a {@apilink Timer} from the current scene, it will no longer be updated.
     * @param timer  The timer to remove to the current scene.
     */
    remove(timer: Timer): void;
    /**
     * Removes a {@apilink TileMap} from the scene, it will no longer be drawn or updated.
     * @param tileMap {TileMap}
     */
    remove(tileMap: TileMap): void;
    /**
     * Removes an actor from the scene, it will no longer be drawn or updated.
     * @param actor  The actor to remove from the current scene.
     */
    remove(actor: Actor): void;
    remove(entity: Entity): void;
    /**
     * Removes a {@apilink ScreenElement} to the scene, it will no longer be drawn or updated
     * @param screenElement  The ScreenElement to remove from the current scene
     */
    remove(screenElement: ScreenElement): void;
    /**
     * Removes all entities and timers from the scene, optionally indicate whether deferred should or shouldn't be used.
     *
     * By default entities use deferred removal
     * @param deferred
     */
    clear(deferred?: boolean): void;
    /**
     * Adds a {@apilink Timer} to the scene
     * @param timer  The timer to add
     */
    addTimer(timer: Timer): Timer;
    /**
     * Removes a {@apilink Timer} from the scene.
     * @warning Can be dangerous, use {@apilink cancelTimer} instead
     * @param timer  The timer to remove
     */
    removeTimer(timer: Timer): Timer;
    /**
     * Cancels a {@apilink Timer}, removing it from the scene nicely
     * @param timer  The timer to cancel
     */
    cancelTimer(timer: Timer): Timer;
    /**
     * Tests whether a {@apilink Timer} is active in the scene
     */
    isTimerActive(timer: Timer): boolean;
    isCurrentScene(): boolean;
    private _collectActorStats;
}

declare enum EventTypes {
    Kill = "kill",
    PreKill = "prekill",
    PostKill = "postkill",
    PreDraw = "predraw",
    PostDraw = "postdraw",
    PreDebugDraw = "predebugdraw",
    PostDebugDraw = "postdebugdraw",
    PreUpdate = "preupdate",
    PostUpdate = "postupdate",
    PreFrame = "preframe",
    PostFrame = "postframe",
    PreCollision = "precollision",
    CollisionStart = "collisionstart",
    CollisionEnd = "collisionend",
    PostCollision = "postcollision",
    Initialize = "initialize",
    Activate = "activate",
    Deactivate = "deactivate",
    ExitViewport = "exitviewport",
    EnterViewport = "enterviewport",
    ExitTrigger = "exit",
    EnterTrigger = "enter",
    Connect = "connect",
    Disconnect = "disconnect",
    Button = "button",
    Axis = "axis",
    Visible = "visible",
    Hidden = "hidden",
    Start = "start",
    Stop = "stop",
    PointerUp = "pointerup",
    PointerDown = "pointerdown",
    PointerMove = "pointermove",
    PointerEnter = "pointerenter",
    PointerLeave = "pointerleave",
    PointerCancel = "pointercancel",
    PointerWheel = "pointerwheel",
    Up = "up",
    Down = "down",
    Move = "move",
    Enter = "enter",
    Leave = "leave",
    Cancel = "cancel",
    Wheel = "wheel",
    Press = "press",
    Release = "release",
    Hold = "hold",
    PointerDragStart = "pointerdragstart",
    PointerDragEnd = "pointerdragend",
    PointerDragEnter = "pointerdragenter",
    PointerDragLeave = "pointerdragleave",
    PointerDragMove = "pointerdragmove",
    ActionStart = "actionstart",
    ActionComplete = "actioncomplete",
    Add = "add",
    Remove = "remove"
}
type kill = 'kill';
type prekill = 'prekill';
type postkill = 'postkill';
type predraw = 'predraw';
type postdraw = 'postdraw';
type predebugdraw = 'predebugdraw';
type postdebugdraw = 'postdebugdraw';
type preupdate = 'preupdate';
type postupdate = 'postupdate';
type preframe = 'preframe';
type postframe = 'postframe';
type precollision = 'precollision';
type collisionstart = 'collisionstart';
type collisionend = 'collisionend';
type postcollision = 'postcollision';
type initialize = 'initialize';
type activate = 'activate';
type deactivate = 'deactivate';
type exitviewport = 'exitviewport';
type enterviewport = 'enterviewport';
type exittrigger = 'exit';
type entertrigger = 'enter';
type connect = 'connect';
type disconnect = 'disconnect';
type button = 'button';
type axis = 'axis';
type subscribe = 'subscribe';
type unsubscribe = 'unsubscribe';
type visible = 'visible';
type hidden = 'hidden';
type start = 'start';
type stop = 'stop';
type pointerup = 'pointerup';
type pointerdown = 'pointerdown';
type pointermove = 'pointermove';
type pointerenter = 'pointerenter';
type pointerleave = 'pointerleave';
type pointercancel = 'pointercancel';
type pointerwheel = 'pointerwheel';
type up = 'up';
type down = 'down';
type move = 'move';
type enter = 'enter';
type leave = 'leave';
type cancel = 'cancel';
type wheel = 'wheel';
type press = 'press';
type release = 'release';
type hold = 'hold';
type pointerdragstart = 'pointerdragstart';
type pointerdragend = 'pointerdragend';
type pointerdragenter = 'pointerdragenter';
type pointerdragleave = 'pointerdragleave';
type pointerdragmove = 'pointerdragmove';
type add = 'add';
type remove = 'remove';
/**
 * Base event type in Excalibur that all other event types derive from. Not all event types are thrown on all Excalibur game objects,
 * some events are unique to a type, others are not.
 *
 */
declare class GameEvent<T, U = T> {
    /**
     * Target object for this event.
     */
    target: T;
    /**
     * Other target object for this event
     */
    other: U | null;
    /**
     * If set to false, prevents event from propagating to other actors. If true it will be propagated
     * to all actors that apply.
     */
    get bubbles(): boolean;
    set bubbles(value: boolean);
    private _bubbles;
    /**
     * Prevents event from bubbling
     */
    stopPropagation(): void;
}
/**
 * The 'kill' event is emitted on actors when it is killed. The target is the actor that was killed.
 */
declare class KillEvent extends GameEvent<Entity> {
    self: Entity;
    constructor(self: Entity);
}
/**
 * The 'prekill' event is emitted directly before an actor is killed.
 */
declare class PreKillEvent extends GameEvent<Actor> {
    self: Actor;
    constructor(self: Actor);
}
/**
 * The 'postkill' event is emitted directly after the actor is killed.
 */
declare class PostKillEvent extends GameEvent<Actor> {
    self: Actor;
    constructor(self: Actor);
}
/**
 * The 'start' event is emitted on engine when has started and is ready for interaction.
 */
declare class GameStartEvent extends GameEvent<Engine> {
    self: Engine;
    constructor(self: Engine);
}
/**
 * The 'stop' event is emitted on engine when has been stopped and will no longer take input, update or draw.
 */
declare class GameStopEvent extends GameEvent<Engine> {
    self: Engine;
    constructor(self: Engine);
}
/**
 * The 'predraw' event is emitted on actors, scenes, and engine before drawing starts. Actors' predraw happens inside their graphics
 * transform so that all drawing takes place with the actor as the origin.
 *
 */
declare class PreDrawEvent extends GameEvent<Entity | Scene | Engine | TileMap> {
    ctx: ExcaliburGraphicsContext;
    elapsed: number;
    self: Entity | Scene | Engine | TileMap;
    constructor(ctx: ExcaliburGraphicsContext, elapsed: number, self: Entity | Scene | Engine | TileMap);
}
/**
 * The 'postdraw' event is emitted on actors, scenes, and engine after drawing finishes. Actors' postdraw happens inside their graphics
 * transform so that all drawing takes place with the actor as the origin.
 *
 */
declare class PostDrawEvent extends GameEvent<Entity | Scene | Engine | TileMap> {
    ctx: ExcaliburGraphicsContext;
    elapsed: number;
    self: Entity | Scene | Engine | TileMap;
    constructor(ctx: ExcaliburGraphicsContext, elapsed: number, self: Entity | Scene | Engine | TileMap);
}
/**
 * The 'pretransformdraw' event is emitted on actors/entities before any graphics transforms have taken place.
 * Useful if you need to completely customize the draw or modify the transform before drawing in the draw step (for example needing
 * latest camera positions)
 *
 */
declare class PreTransformDrawEvent extends GameEvent<Entity> {
    ctx: ExcaliburGraphicsContext;
    elapsed: number;
    self: Entity;
    constructor(ctx: ExcaliburGraphicsContext, elapsed: number, self: Entity);
}
/**
 * The 'posttransformdraw' event is emitted on actors/entities after all graphics have been draw and transforms reset.
 * Useful if you need to completely custom the draw after everything is done.
 *
 */
declare class PostTransformDrawEvent extends GameEvent<Entity> {
    ctx: ExcaliburGraphicsContext;
    elapsed: number;
    self: Entity;
    constructor(ctx: ExcaliburGraphicsContext, elapsed: number, self: Entity);
}
/**
 * The 'predebugdraw' event is emitted on actors, scenes, and engine before debug drawing starts.
 */
declare class PreDebugDrawEvent extends GameEvent<Entity | Actor | Scene | Engine> {
    ctx: ExcaliburGraphicsContext;
    self: Entity | Actor | Scene | Engine;
    constructor(ctx: ExcaliburGraphicsContext, self: Entity | Actor | Scene | Engine);
}
/**
 * The 'postdebugdraw' event is emitted on actors, scenes, and engine after debug drawing starts.
 */
declare class PostDebugDrawEvent extends GameEvent<Entity | Actor | Scene | Engine> {
    ctx: ExcaliburGraphicsContext;
    self: Entity | Actor | Scene | Engine;
    constructor(ctx: ExcaliburGraphicsContext, self: Entity | Actor | Scene | Engine);
}
/**
 * The 'preupdate' event is emitted on actors, scenes, camera, and engine before the update starts.
 */
declare class PreUpdateEvent<T extends OnPreUpdate = Entity> extends GameEvent<T> {
    engine: Engine;
    elapsed: number;
    self: T;
    constructor(engine: Engine, elapsed: number, self: T);
}
/**
 * The 'postupdate' event is emitted on actors, scenes, camera, and engine after the update ends.
 */
declare class PostUpdateEvent<T extends OnPostUpdate = Entity> extends GameEvent<T> {
    engine: Engine;
    elapsed: number;
    self: T;
    constructor(engine: Engine, elapsed: number, self: T);
}
/**
 * The 'preframe' event is emitted on the engine, before the frame begins.
 */
declare class PreFrameEvent extends GameEvent<Engine> {
    engine: Engine;
    prevStats: FrameStats;
    constructor(engine: Engine, prevStats: FrameStats);
}
/**
 * The 'postframe' event is emitted on the engine, after a frame ends.
 */
declare class PostFrameEvent extends GameEvent<Engine> {
    engine: Engine;
    stats: FrameStats;
    constructor(engine: Engine, stats: FrameStats);
}
/**
 * Event received when a gamepad is connected to Excalibur. {@apilink Gamepads} receives this event.
 */
declare class GamepadConnectEvent extends GameEvent<Gamepad> {
    index: number;
    gamepad: Gamepad;
    constructor(index: number, gamepad: Gamepad);
}
/**
 * Event received when a gamepad is disconnected from Excalibur. {@apilink Gamepads} receives this event.
 */
declare class GamepadDisconnectEvent extends GameEvent<Gamepad> {
    index: number;
    gamepad: Gamepad;
    constructor(index: number, gamepad: Gamepad);
}
/**
 * Gamepad button event. See {@apilink Gamepads} for information on responding to controller input. {@apilink Gamepad} instances receive this event;
 */
declare class GamepadButtonEvent extends GameEvent<Gamepad> {
    /**
     * The Gamepad {@apilink Buttons} if not known by excalibur {@apilink Buttons.Unknown} is returned, use index to disambiguate.
     */
    button: Buttons;
    /**
     * The canonical index of the gamepad button from the system
     */
    index: number;
    /**
     * A numeric value between 0 and 1
     */
    value: number;
    /**
     * Reference to the gamepad
     */
    self: Gamepad;
    /**
     * @param button  The Gamepad {@apilink Buttons} if not known by excalibur {@apilink Buttons.Unknown} is returned, use index to disambiguate.
     * @param index   The canonical index of the gamepad button from the system
     * @param value   A numeric value between 0 and 1
     * @param self    Reference to the gamepad
     */
    constructor(
    /**
     * The Gamepad {@apilink Buttons} if not known by excalibur {@apilink Buttons.Unknown} is returned, use index to disambiguate.
     */
    button: Buttons, 
    /**
     * The canonical index of the gamepad button from the system
     */
    index: number, 
    /**
     * A numeric value between 0 and 1
     */
    value: number, 
    /**
     * Reference to the gamepad
     */
    self: Gamepad);
}
/**
 * Gamepad axis event. See {@apilink Gamepads} for information on responding to controller input. {@apilink Gamepad} instances receive this event;
 */
declare class GamepadAxisEvent extends GameEvent<Gamepad> {
    /**
     * The Gamepad {@apilink Axis}
     */
    axis: Axes;
    /**
     * A numeric value between -1 and 1, 0 is the neutral axis position.
     */
    value: number;
    /**
     * Reference to the gamepad
     */
    self: Gamepad;
    /**
     * @param axis  The Gamepad axis
     * @param value A numeric value between -1 and 1
     * @param self Reference to the gamepad
     */
    constructor(
    /**
     * The Gamepad {@apilink Axis}
     */
    axis: Axes, 
    /**
     * A numeric value between -1 and 1, 0 is the neutral axis position.
     */
    value: number, 
    /**
     * Reference to the gamepad
     */
    self: Gamepad);
}
/**
 * Event received by the {@apilink Engine} when the browser window is visible on a screen.
 */
declare class VisibleEvent extends GameEvent<Engine> {
    self: Engine;
    constructor(self: Engine);
}
/**
 * Event received by the {@apilink Engine} when the browser window is hidden from all screens.
 */
declare class HiddenEvent extends GameEvent<Engine> {
    self: Engine;
    constructor(self: Engine);
}
/**
 * Event thrown on an {@apilink Actor | \`actor\`} when a collision will occur this frame if it resolves
 */
declare class PreCollisionEvent<T extends Collider = Collider> extends GameEvent<T> {
    self: T;
    other: T;
    side: Side;
    intersection: Vector;
    contact: CollisionContact;
    /**
     * @param self          The actor the event was thrown on
     * @param other         The actor that will collided with the current actor
     * @param side          The side that will be collided with the current actor
     * @param intersection  Intersection vector
     */
    constructor(self: T, other: T, side: Side, intersection: Vector, contact: CollisionContact);
}
/**
 * Event thrown on an {@apilink Actor | \`actor\`} when a collision has been resolved (body reacted) this frame
 */
declare class PostCollisionEvent<T extends Collider = Collider> extends GameEvent<T> {
    self: T;
    other: T;
    side: Side;
    intersection: Vector;
    contact: CollisionContact;
    /**
     * @param self          The actor the event was thrown on
     * @param other         The actor that did collide with the current actor
     * @param side          The side that did collide with the current actor
     * @param intersection  Intersection vector
     */
    constructor(self: T, other: T, side: Side, intersection: Vector, contact: CollisionContact);
}
declare class ContactStartEvent<T extends Collider = Collider> {
    self: T;
    other: T;
    side: Side;
    contact: CollisionContact;
    constructor(self: T, other: T, side: Side, contact: CollisionContact);
}
declare class ContactEndEvent<T extends Collider = Collider> {
    self: T;
    other: T;
    side: Side;
    lastContact: CollisionContact;
    constructor(self: T, other: T, side: Side, lastContact: CollisionContact);
}
declare class CollisionPreSolveEvent<T extends Collider = Collider> {
    self: T;
    other: T;
    side: Side;
    intersection: Vector;
    contact: CollisionContact;
    constructor(self: T, other: T, side: Side, intersection: Vector, contact: CollisionContact);
}
declare class CollisionPostSolveEvent<T extends Collider = Collider> {
    self: T;
    other: T;
    side: Side;
    intersection: Vector;
    contact: CollisionContact;
    constructor(self: T, other: T, side: Side, intersection: Vector, contact: CollisionContact);
}
/**
 * Event thrown the first time an {@apilink Actor | \`actor\`} collides with another, after an actor is in contact normal collision events are fired.
 */
declare class CollisionStartEvent<T extends Collider = Collider> extends GameEvent<T> {
    self: T;
    other: T;
    side: Side;
    contact: CollisionContact;
    /**
     *
     * @param self
     * @param other
     * @param side
     * @param contact
     */
    constructor(self: T, other: T, side: Side, contact: CollisionContact);
}
/**
 * Event thrown when the {@apilink Actor | \`actor\`} is no longer colliding with another
 */
declare class CollisionEndEvent<T extends Collider = Collider> extends GameEvent<T> {
    self: T;
    other: T;
    side: Side;
    lastContact: CollisionContact;
    /**
     *
     */
    constructor(self: T, other: T, side: Side, lastContact: CollisionContact);
}
/**
 * Event thrown on an {@apilink Actor}, {@apilink Scene}, and {@apilink Engine} only once before the first update call
 */
declare class InitializeEvent<T extends OnInitialize = Entity> extends GameEvent<T> {
    engine: Engine;
    self: T;
    /**
     * @param engine  The reference to the current engine
     */
    constructor(engine: Engine, self: T);
}
/**
 * Event thrown on a {@apilink Scene} on activation
 */
declare class ActivateEvent<TData = undefined> extends GameEvent<Scene> {
    context: SceneActivationContext<TData>;
    self: Scene;
    /**
     * @param context  The context for the scene activation
     */
    constructor(context: SceneActivationContext<TData>, self: Scene);
}
/**
 * Event thrown on a {@apilink Scene} on deactivation
 */
declare class DeactivateEvent extends GameEvent<Scene> {
    context: SceneActivationContext<never>;
    self: Scene;
    /**
     * @param context  The context for the scene deactivation
     */
    constructor(context: SceneActivationContext<never>, self: Scene);
}
/**
 * Event thrown on an {@apilink Actor} when the graphics bounds completely leaves the screen.
 */
declare class ExitViewPortEvent extends GameEvent<Entity> {
    self: Entity;
    constructor(self: Entity);
}
/**
 * Event thrown on an {@apilink Actor} when any part of the graphics bounds are on screen.
 */
declare class EnterViewPortEvent extends GameEvent<Entity> {
    self: Entity;
    constructor(self: Entity);
}
declare class EnterTriggerEvent extends GameEvent<Trigger> {
    self: Trigger;
    entity: Entity;
    constructor(self: Trigger, entity: Entity);
}
declare class ExitTriggerEvent extends GameEvent<Trigger> {
    self: Trigger;
    entity: Entity;
    constructor(self: Trigger, entity: Entity);
}
/**
 * Event thrown on an {@apilink Actor} when an action starts.
 */
declare class ActionStartEvent extends GameEvent<Entity> {
    action: Action;
    self: Entity;
    constructor(action: Action, self: Entity);
}
/**
 * Event thrown on an {@apilink Actor} when an action completes.
 */
declare class ActionCompleteEvent extends GameEvent<Entity> {
    action: Action;
    self: Entity;
    constructor(action: Action, self: Entity);
}
/**
 * Event thrown on an [[Actor]] when an Actor added to scene.
 */
declare class AddEvent<T extends OnAdd> extends GameEvent<T> {
    engine: Engine;
    self: T;
    constructor(engine: Engine, self: T);
}
/**
 * Event thrown on an [[Actor]] when an Actor removed from scene.
 */
declare class RemoveEvent<T extends OnRemove> extends GameEvent<T> {
    engine: Engine;
    self: T;
    constructor(engine: Engine, self: T);
}

type Events_ActionCompleteEvent = ActionCompleteEvent;
declare const Events_ActionCompleteEvent: typeof ActionCompleteEvent;
type Events_ActionStartEvent = ActionStartEvent;
declare const Events_ActionStartEvent: typeof ActionStartEvent;
type Events_ActivateEvent<TData = undefined> = ActivateEvent<TData>;
declare const Events_ActivateEvent: typeof ActivateEvent;
type Events_AddEvent<T extends OnAdd> = AddEvent<T>;
declare const Events_AddEvent: typeof AddEvent;
type Events_CollisionEndEvent<T extends Collider = Collider> = CollisionEndEvent<T>;
declare const Events_CollisionEndEvent: typeof CollisionEndEvent;
type Events_CollisionPostSolveEvent<T extends Collider = Collider> = CollisionPostSolveEvent<T>;
declare const Events_CollisionPostSolveEvent: typeof CollisionPostSolveEvent;
type Events_CollisionPreSolveEvent<T extends Collider = Collider> = CollisionPreSolveEvent<T>;
declare const Events_CollisionPreSolveEvent: typeof CollisionPreSolveEvent;
type Events_CollisionStartEvent<T extends Collider = Collider> = CollisionStartEvent<T>;
declare const Events_CollisionStartEvent: typeof CollisionStartEvent;
type Events_ContactEndEvent<T extends Collider = Collider> = ContactEndEvent<T>;
declare const Events_ContactEndEvent: typeof ContactEndEvent;
type Events_ContactStartEvent<T extends Collider = Collider> = ContactStartEvent<T>;
declare const Events_ContactStartEvent: typeof ContactStartEvent;
type Events_DeactivateEvent = DeactivateEvent;
declare const Events_DeactivateEvent: typeof DeactivateEvent;
type Events_EnterTriggerEvent = EnterTriggerEvent;
declare const Events_EnterTriggerEvent: typeof EnterTriggerEvent;
type Events_EnterViewPortEvent = EnterViewPortEvent;
declare const Events_EnterViewPortEvent: typeof EnterViewPortEvent;
type Events_EventTypes = EventTypes;
declare const Events_EventTypes: typeof EventTypes;
type Events_ExitTriggerEvent = ExitTriggerEvent;
declare const Events_ExitTriggerEvent: typeof ExitTriggerEvent;
type Events_ExitViewPortEvent = ExitViewPortEvent;
declare const Events_ExitViewPortEvent: typeof ExitViewPortEvent;
type Events_GameEvent<T, U = T> = GameEvent<T, U>;
declare const Events_GameEvent: typeof GameEvent;
type Events_GameStartEvent = GameStartEvent;
declare const Events_GameStartEvent: typeof GameStartEvent;
type Events_GameStopEvent = GameStopEvent;
declare const Events_GameStopEvent: typeof GameStopEvent;
type Events_GamepadAxisEvent = GamepadAxisEvent;
declare const Events_GamepadAxisEvent: typeof GamepadAxisEvent;
type Events_GamepadButtonEvent = GamepadButtonEvent;
declare const Events_GamepadButtonEvent: typeof GamepadButtonEvent;
type Events_GamepadConnectEvent = GamepadConnectEvent;
declare const Events_GamepadConnectEvent: typeof GamepadConnectEvent;
type Events_GamepadDisconnectEvent = GamepadDisconnectEvent;
declare const Events_GamepadDisconnectEvent: typeof GamepadDisconnectEvent;
type Events_HiddenEvent = HiddenEvent;
declare const Events_HiddenEvent: typeof HiddenEvent;
type Events_InitializeEvent<T extends OnInitialize = Entity> = InitializeEvent<T>;
declare const Events_InitializeEvent: typeof InitializeEvent;
type Events_KillEvent = KillEvent;
declare const Events_KillEvent: typeof KillEvent;
type Events_PostCollisionEvent<T extends Collider = Collider> = PostCollisionEvent<T>;
declare const Events_PostCollisionEvent: typeof PostCollisionEvent;
type Events_PostDebugDrawEvent = PostDebugDrawEvent;
declare const Events_PostDebugDrawEvent: typeof PostDebugDrawEvent;
type Events_PostDrawEvent = PostDrawEvent;
declare const Events_PostDrawEvent: typeof PostDrawEvent;
type Events_PostFrameEvent = PostFrameEvent;
declare const Events_PostFrameEvent: typeof PostFrameEvent;
type Events_PostKillEvent = PostKillEvent;
declare const Events_PostKillEvent: typeof PostKillEvent;
type Events_PostTransformDrawEvent = PostTransformDrawEvent;
declare const Events_PostTransformDrawEvent: typeof PostTransformDrawEvent;
type Events_PostUpdateEvent<T extends OnPostUpdate = Entity> = PostUpdateEvent<T>;
declare const Events_PostUpdateEvent: typeof PostUpdateEvent;
type Events_PreCollisionEvent<T extends Collider = Collider> = PreCollisionEvent<T>;
declare const Events_PreCollisionEvent: typeof PreCollisionEvent;
type Events_PreDebugDrawEvent = PreDebugDrawEvent;
declare const Events_PreDebugDrawEvent: typeof PreDebugDrawEvent;
type Events_PreDrawEvent = PreDrawEvent;
declare const Events_PreDrawEvent: typeof PreDrawEvent;
type Events_PreFrameEvent = PreFrameEvent;
declare const Events_PreFrameEvent: typeof PreFrameEvent;
type Events_PreKillEvent = PreKillEvent;
declare const Events_PreKillEvent: typeof PreKillEvent;
type Events_PreTransformDrawEvent = PreTransformDrawEvent;
declare const Events_PreTransformDrawEvent: typeof PreTransformDrawEvent;
type Events_PreUpdateEvent<T extends OnPreUpdate = Entity> = PreUpdateEvent<T>;
declare const Events_PreUpdateEvent: typeof PreUpdateEvent;
type Events_RemoveEvent<T extends OnRemove> = RemoveEvent<T>;
declare const Events_RemoveEvent: typeof RemoveEvent;
type Events_VisibleEvent = VisibleEvent;
declare const Events_VisibleEvent: typeof VisibleEvent;
type Events_activate = activate;
type Events_add = add;
type Events_axis = axis;
type Events_button = button;
type Events_cancel = cancel;
type Events_collisionend = collisionend;
type Events_collisionstart = collisionstart;
type Events_connect = connect;
type Events_deactivate = deactivate;
type Events_disconnect = disconnect;
type Events_down = down;
type Events_enter = enter;
type Events_entertrigger = entertrigger;
type Events_enterviewport = enterviewport;
type Events_exittrigger = exittrigger;
type Events_exitviewport = exitviewport;
type Events_hidden = hidden;
type Events_hold = hold;
type Events_initialize = initialize;
type Events_kill = kill;
type Events_leave = leave;
type Events_move = move;
type Events_pointercancel = pointercancel;
type Events_pointerdown = pointerdown;
type Events_pointerdragend = pointerdragend;
type Events_pointerdragenter = pointerdragenter;
type Events_pointerdragleave = pointerdragleave;
type Events_pointerdragmove = pointerdragmove;
type Events_pointerdragstart = pointerdragstart;
type Events_pointerenter = pointerenter;
type Events_pointerleave = pointerleave;
type Events_pointermove = pointermove;
type Events_pointerup = pointerup;
type Events_pointerwheel = pointerwheel;
type Events_postcollision = postcollision;
type Events_postdebugdraw = postdebugdraw;
type Events_postdraw = postdraw;
type Events_postframe = postframe;
type Events_postkill = postkill;
type Events_postupdate = postupdate;
type Events_precollision = precollision;
type Events_predebugdraw = predebugdraw;
type Events_predraw = predraw;
type Events_preframe = preframe;
type Events_prekill = prekill;
type Events_press = press;
type Events_preupdate = preupdate;
type Events_release = release;
type Events_remove = remove;
type Events_start = start;
type Events_stop = stop;
type Events_subscribe = subscribe;
type Events_unsubscribe = unsubscribe;
type Events_up = up;
type Events_visible = visible;
type Events_wheel = wheel;
declare namespace Events {
  export { Events_ActionCompleteEvent as ActionCompleteEvent, Events_ActionStartEvent as ActionStartEvent, Events_ActivateEvent as ActivateEvent, Events_AddEvent as AddEvent, Events_CollisionEndEvent as CollisionEndEvent, Events_CollisionPostSolveEvent as CollisionPostSolveEvent, Events_CollisionPreSolveEvent as CollisionPreSolveEvent, Events_CollisionStartEvent as CollisionStartEvent, Events_ContactEndEvent as ContactEndEvent, Events_ContactStartEvent as ContactStartEvent, Events_DeactivateEvent as DeactivateEvent, Events_EnterTriggerEvent as EnterTriggerEvent, Events_EnterViewPortEvent as EnterViewPortEvent, Events_EventTypes as EventTypes, Events_ExitTriggerEvent as ExitTriggerEvent, Events_ExitViewPortEvent as ExitViewPortEvent, Events_GameEvent as GameEvent, Events_GameStartEvent as GameStartEvent, Events_GameStopEvent as GameStopEvent, Events_GamepadAxisEvent as GamepadAxisEvent, Events_GamepadButtonEvent as GamepadButtonEvent, Events_GamepadConnectEvent as GamepadConnectEvent, Events_GamepadDisconnectEvent as GamepadDisconnectEvent, Events_HiddenEvent as HiddenEvent, Events_InitializeEvent as InitializeEvent, Events_KillEvent as KillEvent, Events_PostCollisionEvent as PostCollisionEvent, Events_PostDebugDrawEvent as PostDebugDrawEvent, Events_PostDrawEvent as PostDrawEvent, Events_PostFrameEvent as PostFrameEvent, Events_PostKillEvent as PostKillEvent, Events_PostTransformDrawEvent as PostTransformDrawEvent, Events_PostUpdateEvent as PostUpdateEvent, Events_PreCollisionEvent as PreCollisionEvent, Events_PreDebugDrawEvent as PreDebugDrawEvent, Events_PreDrawEvent as PreDrawEvent, Events_PreFrameEvent as PreFrameEvent, Events_PreKillEvent as PreKillEvent, Events_PreTransformDrawEvent as PreTransformDrawEvent, Events_PreUpdateEvent as PreUpdateEvent, Events_RemoveEvent as RemoveEvent, Events_VisibleEvent as VisibleEvent, type Events_activate as activate, type Events_add as add, type Events_axis as axis, type Events_button as button, type Events_cancel as cancel, type Events_collisionend as collisionend, type Events_collisionstart as collisionstart, type Events_connect as connect, type Events_deactivate as deactivate, type Events_disconnect as disconnect, type Events_down as down, type Events_enter as enter, type Events_entertrigger as entertrigger, type Events_enterviewport as enterviewport, type Events_exittrigger as exittrigger, type Events_exitviewport as exitviewport, type Events_hidden as hidden, type Events_hold as hold, type Events_initialize as initialize, type Events_kill as kill, type Events_leave as leave, type Events_move as move, type Events_pointercancel as pointercancel, type Events_pointerdown as pointerdown, type Events_pointerdragend as pointerdragend, type Events_pointerdragenter as pointerdragenter, type Events_pointerdragleave as pointerdragleave, type Events_pointerdragmove as pointerdragmove, type Events_pointerdragstart as pointerdragstart, type Events_pointerenter as pointerenter, type Events_pointerleave as pointerleave, type Events_pointermove as pointermove, type Events_pointerup as pointerup, type Events_pointerwheel as pointerwheel, type Events_postcollision as postcollision, type Events_postdebugdraw as postdebugdraw, type Events_postdraw as postdraw, type Events_postframe as postframe, type Events_postkill as postkill, type Events_postupdate as postupdate, type Events_precollision as precollision, type Events_predebugdraw as predebugdraw, type Events_predraw as predraw, type Events_preframe as preframe, type Events_prekill as prekill, type Events_press as press, type Events_preupdate as preupdate, type Events_release as release, type Events_remove as remove, type Events_start as start, type Events_stop as stop, type Events_subscribe as subscribe, type Events_unsubscribe as unsubscribe, type Events_up as up, type Events_visible as visible, type Events_wheel as wheel };
}

interface _initialize {
    _initialize(engine: Engine): void;
}
interface _add {
    onAdd(scene: Scene): void;
}
interface _remove {
    onRemove(engine: Engine): void;
}
/**
 * Type guard checking for internal initialize method
 * @internal
 * @param a
 */
declare function has_initialize(a: any): a is _initialize;
/**
 *
 */
declare function has_add(a: any): a is _add;
/**
 *
 */
declare function has_remove(a: any): a is _remove;
interface OnInitialize {
    onInitialize(engine: Engine): void;
}
/**
 *
 */
declare function hasOnInitialize(a: any): a is OnInitialize;
interface _preupdate {
    _preupdate(engine: Engine, elapsed: number): void;
}
/**
 *
 */
declare function has_preupdate(a: any): a is _preupdate;
interface OnPreUpdate {
    onPreUpdate(engine: Engine, elapsed: number): void;
}
/**
 *
 */
declare function hasOnPreUpdate(a: any): a is OnPreUpdate;
interface _postupdate {
    _postupdate(engine: Engine, elapsed: number): void;
}
/**
 *
 */
declare function has_postupdate(a: any): a is _postupdate;
interface OnPostUpdate {
    onPostUpdate(engine: Engine, elapsed: number): void;
}
/**
 *
 */
declare function hasOnPostUpdate(a: any): a is OnPostUpdate;
interface CanInitialize {
    /**
     * Overridable implementation
     */
    onInitialize(engine: Engine): void;
    /**
     * Event signatures
     */
    on(eventName: initialize, handler: (event: InitializeEvent<any>) => void): void;
    once(eventName: initialize, handler: (event: InitializeEvent<any>) => void): void;
    off(eventName: initialize, handler?: (event: InitializeEvent<any>) => void): void;
}
interface OnAdd {
    onAdd(engine: Engine): void;
}
/**
 *
 */
declare function hasOnAdd(a: any): a is OnAdd;
interface CanAdd {
    onAdd(engine: Engine): void;
    on(eventName: add, handler: (event: AddEvent<any>) => void): void;
    once(eventName: add, handler: (event: AddEvent<any>) => void): void;
    off(eventName: add, handler?: (event: AddEvent<any>) => void): void;
}
interface OnRemove {
    onRemove(engine: Engine): void;
}
/**
 *
 */
declare function hasOnRemove(a: any): a is OnRemove;
interface CanRemove {
    onRemove(engine: Engine): void;
    on(eventName: remove, handler: (event: RemoveEvent<any>) => void): void;
    once(eventName: remove, handler: (event: RemoveEvent<any>) => void): void;
    off(eventName: remove, handler?: (event: RemoveEvent<any>) => void): void;
}
interface SceneActivationContext<TData = undefined, TPreviousSceneData = undefined> {
    data?: TData;
    previousScene: Scene;
    previousSceneData?: TPreviousSceneData;
    nextScene: Scene;
    engine: Engine;
}
interface CanActivate<TData = undefined> {
    /**
     * Overridable implementation
     */
    onActivate(context: SceneActivationContext<TData>): void;
    /**
     * Event signatures
     */
    on(eventName: activate, handler: (event: ActivateEvent) => void): void;
    once(eventName: activate, handler: (event: ActivateEvent) => void): void;
    off(eventName: activate, handler?: (event: ActivateEvent) => void): void;
}
interface CanDeactivate {
    /**
     * Overridable implementation
     */
    onDeactivate(context: SceneActivationContext<never>): void;
    /**
     * Event signature
     */
    on(eventName: deactivate, handler: (event: DeactivateEvent) => void): void;
    once(eventName: deactivate, handler: (event: DeactivateEvent) => void): void;
    off(eventName: deactivate, handler?: (event: DeactivateEvent) => void): void;
}
interface CanUpdate {
    /**
     * Overridable implementation
     */
    onPreUpdate(engine: Engine, elapsed: number): void;
    /**
     * Event signature
     */
    on(eventName: preupdate, handler: (event: PreUpdateEvent<any>) => void): void;
    once(eventName: preupdate, handler: (event: PreUpdateEvent<any>) => void): void;
    off(eventName: preupdate, handler?: (event: PreUpdateEvent<any>) => void): void;
    /**
     * Overridable implementation
     */
    onPostUpdate(engine: Engine, elapsed: number): void;
    /**
     * Event signatures
     */
    on(eventName: postupdate, handler: (event: PostUpdateEvent<any>) => void): void;
    once(eventName: postupdate, handler: (event: PostUpdateEvent<any>) => void): void;
    off(eventName: postupdate, handler?: (event: PostUpdateEvent<any>) => void): void;
}
interface OnPreDraw {
    /**
     * Overridable implementation
     */
    onPreDraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Event signatures
     */
    on(eventName: predraw, handler: (event: PreDrawEvent) => void): void;
    once(eventName: predraw, handler: (event: PreDrawEvent) => void): void;
    off(eventName: predraw, handler?: (event: PreDrawEvent) => void): void;
}
interface OnPostDraw {
    /**
     * Overridable implementation
     */
    onPostDraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Event signatures
     */
    on(eventName: postdraw, handler: (event: PostDrawEvent) => void): void;
    once(eventName: postdraw, handler: (event: PostDrawEvent) => void): void;
    off(eventName: postdraw, handler?: (event: PostDrawEvent) => void): void;
}
interface CanDraw extends OnPreDraw, OnPostDraw {
    on(eventName: predraw, handler: (event: PreDrawEvent) => void): void;
    on(eventName: postdraw, handler: (event: PostDrawEvent) => void): void;
    once(eventName: predraw, handler: (event: PreDrawEvent) => void): void;
    once(eventName: postdraw, handler: (event: PostDrawEvent) => void): void;
    off(eventName: predraw, handler?: (event: PreDrawEvent) => void): void;
    off(eventName: postdraw, handler?: (event: PostDrawEvent) => void): void;
}
/**
 *
 */
declare function hasPreDraw(a: any): a is OnPreDraw;
/**
 *
 */
declare function hasPostDraw(a: any): a is OnPostDraw;
interface CanBeKilled {
    /**
     * Overridable implementation
     */
    onPreKill(_scene: Scene): void;
    /**
     * Event signatures
     */
    on(eventName: prekill, handler: (event: PreKillEvent) => void): void;
    once(eventName: prekill, handler: (event: PreKillEvent) => void): void;
    off(eventName: prekill, handler: (event: PreKillEvent) => void): void;
    /**
     * Overridable implementation
     */
    onPostKill(_scene: Scene): void;
    /**
     * Event signatures
     */
    on(eventName: postkill, handler: (event: PostKillEvent) => void): void;
    once(eventName: postkill, handler: (event: PostKillEvent) => void): void;
    off(eventName: postkill, handler: (event: PostKillEvent) => void): void;
}

interface Context<TValue> {
    /**
     * Run the callback before popping the context value
     * @param value
     * @param cb
     */
    scope: <TReturn>(value: TValue, cb: () => TReturn) => TReturn;
    value: TValue;
}

type EngineEvents = DirectorEvents & {
    fallbackgraphicscontext: ExcaliburGraphicsContext2DCanvas;
    initialize: InitializeEvent<Engine>;
    visible: VisibleEvent;
    hidden: HiddenEvent;
    start: GameStartEvent;
    stop: GameStopEvent;
    preupdate: PreUpdateEvent<Engine>;
    postupdate: PostUpdateEvent<Engine>;
    preframe: PreFrameEvent;
    postframe: PostFrameEvent;
    predraw: PreDrawEvent;
    postdraw: PostDrawEvent;
};
declare const EngineEvents: {
    readonly NavigationStart: "navigationstart";
    readonly Navigation: "navigation";
    readonly NavigationEnd: "navigationend";
    readonly FallbackGraphicsContext: "fallbackgraphicscontext";
    readonly Initialize: "initialize";
    readonly Visible: "visible";
    readonly Hidden: "hidden";
    readonly Start: "start";
    readonly Stop: "stop";
    readonly PreUpdate: "preupdate";
    readonly PostUpdate: "postupdate";
    readonly PreFrame: "preframe";
    readonly PostFrame: "postframe";
    readonly PreDraw: "predraw";
    readonly PostDraw: "postdraw";
};
/**
 * Enum representing the different mousewheel event bubble prevention
 */
declare enum ScrollPreventionMode {
    /**
     * Do not prevent any page scrolling
     */
    None = 0,
    /**
     * Prevent page scroll if mouse is over the game canvas
     */
    Canvas = 1,
    /**
     * Prevent all page scrolling via mouse wheel
     */
    All = 2
}
/**
 * Defines the available options to configure the Excalibur engine at constructor time.
 */
interface EngineOptions<TKnownScenes extends string = any> {
    /**
     * Optionally configure the width of the viewport in css pixels
     */
    width?: number;
    /**
     * Optionally configure the height of the viewport in css pixels
     */
    height?: number;
    /**
     * Optionally configure the width & height of the viewport in css pixels.
     * Use \`viewport\` instead of {@apilink EngineOptions.width} and {@apilink EngineOptions.height}, or vice versa.
     */
    viewport?: ViewportDimension;
    /**
     * Optionally specify the size the logical pixel resolution, if not specified it will be width x height.
     * See {@apilink Resolution} for common presets.
     */
    resolution?: Resolution;
    /**
     * Optionally specify antialiasing (smoothing), by default true (smooth pixels)
     *
     *  * \`true\` - useful for high resolution art work you would like smoothed, this also hints excalibur to load images
     * with default blending {@apilink ImageFiltering.Blended}
     *
     *  * \`false\` - useful for pixel art style art work you would like sharp, this also hints excalibur to load images
     * with default blending {@apilink ImageFiltering.Pixel}
     *
     * * {@apilink AntialiasOptions} Optionally deeply configure the different antialiasing settings, **WARNING** thar be dragons here.
     * It is recommended you stick to \`true\` or \`false\` unless you understand what you're doing and need to control rendering to
     * a high degree.
     */
    antialiasing?: boolean | AntialiasOptions;
    /**
     * Optionally specify excalibur garbage collection, by default true.
     *
     * * \`true\` - garbage collection defaults are enabled (default)
     *
     * * \`false\` - garbage collection is completely disabled (not recommended)
     *
     * * {@apilink GarbageCollectionOptions} Optionally deeply configure garbage collection settings, **WARNING** thar be dragons here.
     * It is recommended you stick to \`true\` or \`false\` unless you understand what you're doing, it is possible to get into a downward
     * spiral if collection timings are set too low where you are stuck in repeated collection.
     */
    garbageCollection?: boolean | GarbageCollectionOptions;
    /**
     * Quick convenience property to configure Excalibur to use special settings for "pretty" anti-aliased pixel art
     *
     * 1. Turns on special shader condition to blend for pixel art and enables various antialiasing settings,
     *  notice blending is ON for this special mode.
     *
     * Equivalent to:
     * \`\`\`javascript
     * antialiasing: {
     *  pixelArtSampler: true,
     *  canvasImageRendering: 'auto',
     *  filtering: ImageFiltering.Blended,
     *  webglAntialiasing: true
     * }
     * \`\`\`
     */
    pixelArt?: boolean;
    /**
     * Specify any UV padding you want use in pixels, this brings sampling into the texture if you're using
     * a sprite sheet in one image to prevent sampling bleed.
     *
     * Defaults:
     * * \`antialiasing: false\` or \`filtering: ImageFiltering.Pixel\` - 0.0;
     * * \`pixelArt: true\` - 0.25
     * * All else 0.01
     */
    uvPadding?: number;
    /**
     * Optionally hint the graphics context into a specific power profile
     *
     * Default "high-performance"
     */
    powerPreference?: 'default' | 'high-performance' | 'low-power';
    /**
     * Optionally upscale the number of pixels in the canvas. Normally only useful if you need a smoother look to your assets, especially
     * {@apilink Text} or Pixel Art assets.
     *
     * **WARNING** It is recommended you try using \`antialiasing: true\` before adjusting pixel ratio. Pixel ratio will consume more memory
     * and on mobile may break if the internal size of the canvas exceeds 4k pixels in width or height.
     *
     * Default is based the display's pixel ratio, for example a HiDPI screen might have the value 2;
     */
    pixelRatio?: number;
    /**
     * Optionally configure the native canvas transparent backdrop
     */
    enableCanvasTransparency?: boolean;
    /**
     * Optionally specify the target canvas DOM element to render the game in
     */
    canvasElementId?: string;
    /**
     * Optionally specify the target canvas DOM element directly
     */
    canvasElement?: HTMLCanvasElement;
    /**
     * Optionally enable the right click context menu on the canvas
     *
     * Default if unset is false
     */
    enableCanvasContextMenu?: boolean;
    /**
     * Optionally snap graphics to nearest pixel, default is false
     */
    snapToPixel?: boolean;
    /**
     * The {@apilink DisplayMode} of the game, by default {@apilink DisplayMode.FitScreen} with aspect ratio 4:3 (800x600).
     * Depending on this value, {@apilink width} and {@apilink height} may be ignored.
     */
    displayMode?: DisplayMode;
    /**
     * Optionally configure the global, or a factory to produce it to listen to for browser events for Excalibur to listen to
     */
    global?: GlobalEventHandlers | (() => GlobalEventHandlers);
    /**
     * Configures the pointer scope. Pointers scoped to the 'Canvas' can only fire events within the canvas viewport; whereas, 'Document'
     * (default) scoped will fire anywhere on the page.
     */
    pointerScope?: PointerScope;
    /**
     * Suppress boot up console message, which contains the "powered by Excalibur message"
     */
    suppressConsoleBootMessage?: boolean;
    /**
     * Suppress minimum browser feature detection, it is not recommended users of excalibur switch this off. This feature ensures that
     * the currently running browser meets the minimum requirements for running excalibur. This can be useful if running on non-standard
     * browsers or if there is a bug in excalibur preventing execution.
     */
    suppressMinimumBrowserFeatureDetection?: boolean;
    /**
     * Suppress HiDPI auto detection and scaling, it is not recommended users of excalibur switch off this feature. This feature detects
     * and scales the drawing canvas appropriately to accommodate HiDPI screens.
     */
    suppressHiDPIScaling?: boolean;
    /**
     * Suppress play button, it is not recommended users of excalibur switch this feature. Some browsers require a user gesture (like a click)
     * for certain browser features to work like web audio.
     */
    suppressPlayButton?: boolean;
    /**
     * Sets the focus of the window, this is needed when hosting excalibur in a cross-origin/same-origin iframe in order for certain events
     * (like keyboard) to work. You can use
     * For example: itch.io or codesandbox.io
     *
     * By default set to true,
     */
    grabWindowFocus?: boolean;
    /**
     * Scroll prevention method.
     */
    scrollPreventionMode?: ScrollPreventionMode;
    /**
     * Optionally set the background color
     */
    backgroundColor?: Color;
    /**
     * Optionally set the maximum fps if not set Excalibur will go as fast as the device allows.
     *
     * You may want to constrain max fps if your game cannot maintain fps consistently, it can look and feel better to have a 30fps game than
     * one that bounces between 30fps and 60fps
     */
    maxFps?: number;
    /**
     * Optionally configure a fixed update timestep in milliseconds, this can be desirable if you need the physics simulation to be very stable. When
     * set the update step and physics will use the same elapsed time for each tick even if the graphical framerate drops. In order for the
     * simulation to be correct, excalibur will run multiple updates in a row (at the configured update elapsed) to catch up, for example
     * there could be X updates and 1 draw each clock step.
     *
     * **NOTE:** This does come at a potential perf cost because each catch-up update will need to be run if the fixed rate is greater than
     * the current instantaneous framerate, or perf gain if the fixed rate is less than the current framerate.
     *
     * By default is unset and updates will use the current instantaneous framerate with 1 update and 1 draw each clock step.
     *
     * **WARN:** \`fixedUpdateTimestep\` takes precedence over \`fixedUpdateFps\` use whichever is most convenient.
     */
    fixedUpdateTimestep?: number;
    /**
     * Optionally configure a fixed update fps, this can be desirable if you need the physics simulation to be very stable. When set
     * the update step and physics will use the same elapsed time for each tick even if the graphical framerate drops. In order for the
     * simulation to be correct, excalibur will run multiple updates in a row (at the configured update elapsed) to catch up, for example
     * there could be X updates and 1 draw each clock step.
     *
     * **NOTE:** This does come at a potential perf cost because each catch-up update will need to be run if the fixed rate is greater than
     * the current instantaneous framerate, or perf gain if the fixed rate is less than the current framerate.
     *
     * By default is unset and updates will use the current instantaneous framerate with 1 update and 1 draw each clock step.
     *
     * **WARN:** \`fixedUpdateTimestep\` takes precedence over \`fixedUpdateFps\` use whichever is most convenient.
     */
    fixedUpdateFps?: number;
    /**
     * Default \`true\`, optionally configure excalibur to use optimal draw call sorting, to opt out set this to \`false\`.
     *
     * Excalibur will automatically sort draw calls by z and priority into renderer batches for maximal draw performance,
     * this can disrupt a specific desired painter order.
     *
     */
    useDrawSorting?: boolean;
    /**
     * Optionally provide a custom handler for the webgl context lost event
     */
    handleContextLost?: (e: Event) => void;
    /**
     * Optionally provide a custom handler for the webgl context restored event
     */
    handleContextRestored?: (e: Event) => void;
    /**
     * Optionally configure how excalibur handles poor performance on a player's browser
     */
    configurePerformanceCanvas2DFallback?: {
        /**
         * By default \`false\`, this will switch the internal graphics context to Canvas2D which can improve performance on non hardware
         * accelerated browsers.
         */
        allow: boolean;
        /**
         * By default \`false\`, if set to \`true\` a dialogue will be presented to the player about their browser and how to potentially
         * address any issues.
         */
        showPlayerMessage?: boolean;
        /**
         * Default \`{ numberOfFrames: 100, fps: 20 }\`, optionally configure excalibur to fallback to the 2D Canvas renderer
         * if bad performance is detected.
         *
         * In this example of the default if excalibur is running at 20fps or less for 100 frames it will trigger the fallback to the 2D
         * Canvas renderer.
         */
        threshold?: {
            numberOfFrames: number;
            fps: number;
        };
    };
    /**
     * Optionally configure the physics simulation in excalibur
     *
     * If false, Excalibur will not produce a physics simulation.
     *
     * Default is configured to use {@apilink SolverStrategy.Arcade} physics simulation
     */
    physics?: boolean | PhysicsConfig;
    /**
     * Optionally specify scenes with their transitions and loaders to excalibur's scene {@apilink Director}
     *
     * Scene transitions can can overridden dynamically by the \`Scene\` or by the call to \`.goToScene\`
     */
    scenes?: SceneMap<TKnownScenes>;
}
/**
 * The Excalibur Engine
 *
 * The {@apilink Engine} is the main driver for a game. It is responsible for
 * starting/stopping the game, maintaining state, transmitting events,
 * loading resources, and managing the scene.
 */
declare class Engine<TKnownScenes extends string = any> implements CanInitialize, CanUpdate, CanDraw {
    static Context: Context<Engine | null>;
    static useEngine(): Engine;
    static InstanceCount: number;
    /**
     * Anything run under scope can use \`useEngine()\` to inject the current engine
     * @param cb
     */
    scope: <TReturn>(cb: () => TReturn) => TReturn;
    global: GlobalEventHandlers;
    private _garbageCollector;
    readonly garbageCollectorConfig: GarbageCollectionOptions | null;
    /**
     * Current Excalibur version string
     *
     * Useful for plugins or other tools that need to know what features are available
     */
    readonly version: string;
    /**
     * Listen to and emit events on the Engine
     */
    events: EventEmitter<EngineEvents>;
    /**
     * Excalibur browser events abstraction used for wiring to native browser events safely
     */
    browser: BrowserEvents;
    /**
     * Screen abstraction
     */
    screen: Screen;
    /**
     * Scene director, manages all scenes, scene transitions, and loaders in excalibur
     */
    director: Director<TKnownScenes>;
    /**
     * Direct access to the engine's canvas element
     */
    canvas: HTMLCanvasElement;
    /**
     * Direct access to the ExcaliburGraphicsContext used for drawing things to the screen
     */
    graphicsContext: ExcaliburGraphicsContext;
    /**
     * Direct access to the canvas element ID, if an ID exists
     */
    canvasElementId: string;
    /**
     * Direct access to the physics configuration for excalibur
     */
    physics: DeepRequired<PhysicsConfig>;
    /**
     * Optionally set the maximum fps if not set Excalibur will go as fast as the device allows.
     *
     * You may want to constrain max fps if your game cannot maintain fps consistently, it can look and feel better to have a 30fps game than
     * one that bounces between 30fps and 60fps
     */
    maxFps: number;
    /**
     * Optionally configure a fixed update fps, this can be desirable if you need the physics simulation to be very stable. When set
     * the update step and physics will use the same elapsed time for each tick even if the graphical framerate drops. In order for the
     * simulation to be correct, excalibur will run multiple updates in a row (at the configured update elapsed) to catch up, for example
     * there could be X updates and 1 draw each clock step.
     *
     * **NOTE:** This does come at a potential perf cost because each catch-up update will need to be run if the fixed rate is greater than
     * the current instantaneous framerate, or perf gain if the fixed rate is less than the current framerate.
     *
     * By default is unset and updates will use the current instantaneous framerate with 1 update and 1 draw each clock step.
     *
     * **WARN:** \`fixedUpdateTimestep\` takes precedence over \`fixedUpdateFps\` use whichever is most convenient.
     */
    readonly fixedUpdateFps?: number;
    /**
     * Optionally configure a fixed update timestep in milliseconds, this can be desirable if you need the physics simulation to be very stable. When
     * set the update step and physics will use the same elapsed time for each tick even if the graphical framerate drops. In order for the
     * simulation to be correct, excalibur will run multiple updates in a row (at the configured update elapsed) to catch up, for example
     * there could be X updates and 1 draw each clock step.
     *
     * **NOTE:** This does come at a potential perf cost because each catch-up update will need to be run if the fixed rate is greater than
     * the current instantaneous framerate, or perf gain if the fixed rate is less than the current framerate.
     *
     * By default is unset and updates will use the current instantaneous framerate with 1 update and 1 draw each clock step.
     *
     * **WARN:** \`fixedUpdateTimestep\` takes precedence over \`fixedUpdateFps\` use whichever is most convenient.
     */
    readonly fixedUpdateTimestep?: number;
    /**
     * Direct access to the excalibur clock
     */
    clock: Clock;
    readonly pointerScope: PointerScope;
    readonly grabWindowFocus: boolean;
    /**
     * The width of the game canvas in pixels (physical width component of the
     * resolution of the canvas element)
     */
    get canvasWidth(): number;
    /**
     * Returns half width of the game canvas in pixels (half physical width component)
     */
    get halfCanvasWidth(): number;
    /**
     * The height of the game canvas in pixels, (physical height component of
     * the resolution of the canvas element)
     */
    get canvasHeight(): number;
    /**
     * Returns half height of the game canvas in pixels (half physical height component)
     */
    get halfCanvasHeight(): number;
    /**
     * Returns the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get drawWidth(): number;
    /**
     * Returns half the width of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get halfDrawWidth(): number;
    /**
     * Returns the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get drawHeight(): number;
    /**
     * Returns half the height of the engine's visible drawing surface in pixels including zoom and device pixel ratio.
     */
    get halfDrawHeight(): number;
    /**
     * Returns whether excalibur detects the current screen to be HiDPI
     */
    get isHiDpi(): boolean;
    /**
     * Access engine input like pointer, keyboard, or gamepad
     */
    input: InputHost;
    /**
     * Map multiple input sources to specific game actions actions
     */
    inputMapper: InputMapper;
    private _inputEnabled;
    /**
     * Access Excalibur debugging functionality.
     *
     * Useful when you want to debug different aspects of built in engine features like
     *   * Transform
     *   * Graphics
     *   * Colliders
     */
    debug: DebugConfig;
    /**
     * Access {@apilink stats} that holds frame statistics.
     */
    get stats(): DebugStats;
    /**
     * The current {@apilink Scene} being drawn and updated on screen
     */
    get currentScene(): Scene;
    /**
     * The current {@apilink Scene} being drawn and updated on screen
     */
    get currentSceneName(): string;
    /**
     * The default {@apilink Scene} of the game, use {@apilink Engine.goToScene} to transition to different scenes.
     */
    get rootScene(): Scene;
    /**
     * Contains all the scenes currently registered with Excalibur
     */
    get scenes(): {
        [key: string]: Scene | SceneConstructor | SceneWithOptions;
    };
    /**
     * Indicates whether the engine is set to fullscreen or not
     */
    get isFullscreen(): boolean;
    /**
     * Indicates the current {@apilink DisplayMode} of the engine.
     */
    get displayMode(): DisplayMode;
    private _suppressPlayButton;
    /**
     * Returns the calculated pixel ration for use in rendering
     */
    get pixelRatio(): number;
    /**
     * Indicates whether audio should be paused when the game is no longer visible.
     */
    pauseAudioWhenHidden: boolean;
    /**
     * Indicates whether the engine should draw with debug information
     */
    private _isDebug;
    get isDebug(): boolean;
    /**
     * Sets the background color for the engine.
     */
    backgroundColor: Color;
    /**
     * Sets the Transparency for the engine.
     */
    enableCanvasTransparency: boolean;
    /**
     * Hints the graphics context to truncate fractional world space coordinates
     */
    get snapToPixel(): boolean;
    set snapToPixel(shouldSnapToPixel: boolean);
    /**
     * The action to take when a fatal exception is thrown
     */
    onFatalException: (e: any) => void;
    /**
     * The mouse wheel scroll prevention mode
     */
    pageScrollPreventionMode: ScrollPreventionMode;
    private _logger;
    private _toaster;
    private _compatible;
    private _timescale;
    private _loader;
    private _isInitialized;
    private _hasCreatedCanvas;
    emit<TEventName extends EventKey<EngineEvents>>(eventName: TEventName, event: EngineEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<EngineEvents>>(eventName: TEventName, handler: Handler<EngineEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<EngineEvents>>(eventName: TEventName, handler: Handler<EngineEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<EngineEvents>>(eventName: TEventName, handler: Handler<EngineEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
    /**
     * Default {@apilink EngineOptions}
     */
    private static _DEFAULT_ENGINE_OPTIONS;
    private _originalOptions;
    readonly _originalDisplayMode: DisplayMode;
    /**
     * Creates a new game using the given {@apilink EngineOptions}. By default, if no options are provided,
     * the game will be rendered full screen (taking up all available browser window space).
     * You can customize the game rendering through {@apilink EngineOptions}.
     *
     * Example:
     *
     * \`\`\`js
     * var game = new ex.Engine({
     *   width: 0, // the width of the canvas
     *   height: 0, // the height of the canvas
     *   enableCanvasTransparency: true, // the transparencySection of the canvas
     *   canvasElementId: '', // the DOM canvas element ID, if you are providing your own
     *   displayMode: ex.DisplayMode.FullScreen, // the display mode
     *   pointerScope: ex.PointerScope.Document, // the scope of capturing pointer (mouse/touch) events
     *   backgroundColor: ex.Color.fromHex('#2185d0') // background color of the engine
     * });
     *
     * // call game.start, which is a Promise
     * game.start().then(function () {
     *   // ready, set, go!
     * });
     * \`\`\`
     */
    constructor(options?: EngineOptions<TKnownScenes>);
    private _handleWebGLContextLost;
    private _performanceThresholdTriggered;
    private _fpsSamples;
    private _monitorPerformanceThresholdAndTriggerFallback;
    /**
     * Switches the engine's graphics context to the 2D Canvas.
     * @warning Some features of Excalibur will not work in this mode.
     */
    useCanvas2DFallback(): void;
    private _disposed;
    /**
     * Attempts to completely clean up excalibur resources, including removing the canvas from the dom.
     *
     * To start again you will need to new up an Engine.
     */
    dispose(): void;
    isDisposed(): boolean;
    /**
     * Returns a BoundingBox of the top left corner of the screen
     * and the bottom right corner of the screen.
     */
    getWorldBounds(): BoundingBox;
    /**
     * Gets the current engine timescale factor (default is 1.0 which is 1:1 time)
     */
    get timescale(): number;
    /**
     * Sets the current engine timescale factor. Useful for creating slow-motion effects or fast-forward effects
     * when using time-based movement.
     */
    set timescale(value: number);
    /**
     * Adds a {@apilink Timer} to the {@apilink currentScene}.
     * @param timer  The timer to add to the {@apilink currentScene}.
     */
    addTimer(timer: Timer): Timer;
    /**
     * Removes a {@apilink Timer} from the {@apilink currentScene}.
     * @param timer  The timer to remove to the {@apilink currentScene}.
     */
    removeTimer(timer: Timer): Timer;
    /**
     * Adds a {@apilink Scene} to the engine, think of scenes in Excalibur as you
     * would levels or menus.
     * @param key  The name of the scene, must be unique
     * @param scene The scene to add to the engine
     */
    addScene<TScene extends string>(key: TScene, scene: Scene | SceneConstructor | SceneWithOptions): Engine<TKnownScenes | TScene>;
    /**
     * Removes a {@apilink Scene} instance from the engine
     * @param scene  The scene to remove
     */
    removeScene(scene: Scene | SceneConstructor): void;
    /**
     * Removes a scene from the engine by key
     * @param key  The scene key to remove
     */
    removeScene(key: string): void;
    /**
     * Adds a {@apilink Scene} to the engine, think of scenes in Excalibur as you
     * would levels or menus.
     * @param sceneKey  The key of the scene, must be unique
     * @param scene     The scene to add to the engine
     */
    add(sceneKey: string, scene: Scene | SceneConstructor | SceneWithOptions): void;
    /**
     * Adds a {@apilink Timer} to the {@apilink currentScene}.
     * @param timer  The timer to add to the {@apilink currentScene}.
     */
    add(timer: Timer): void;
    /**
     * Adds a {@apilink TileMap} to the {@apilink currentScene}, once this is done the TileMap
     * will be drawn and updated.
     */
    add(tileMap: TileMap): void;
    /**
     * Adds an actor to the {@apilink currentScene} of the game. This is synonymous
     * to calling \`engine.currentScene.add(actor)\`.
     *
     * Actors can only be drawn if they are a member of a scene, and only
     * the {@apilink currentScene} may be drawn or updated.
     * @param actor  The actor to add to the {@apilink currentScene}
     */
    add(actor: Actor): void;
    add(entity: Entity): void;
    /**
     * Adds a {@apilink ScreenElement} to the {@apilink currentScene} of the game,
     * ScreenElements do not participate in collisions, instead the
     * remain in the same place on the screen.
     * @param screenElement  The ScreenElement to add to the {@apilink currentScene}
     */
    add(screenElement: ScreenElement): void;
    /**
     * Removes a scene instance from the engine
     * @param scene  The scene to remove
     */
    remove(scene: Scene | SceneConstructor): void;
    /**
     * Removes a scene from the engine by key
     * @param sceneKey  The scene to remove
     */
    remove(sceneKey: string): void;
    /**
     * Removes a {@apilink Timer} from the {@apilink currentScene}.
     * @param timer  The timer to remove to the {@apilink currentScene}.
     */
    remove(timer: Timer): void;
    /**
     * Removes a {@apilink TileMap} from the {@apilink currentScene}, it will no longer be drawn or updated.
     */
    remove(tileMap: TileMap): void;
    /**
     * Removes an actor from the {@apilink currentScene} of the game. This is synonymous
     * to calling \`engine.currentScene.removeChild(actor)\`.
     * Actors that are removed from a scene will no longer be drawn or updated.
     * @param actor  The actor to remove from the {@apilink currentScene}.
     */
    remove(actor: Actor): void;
    /**
     * Removes a {@apilink ScreenElement} to the scene, it will no longer be drawn or updated
     * @param screenElement  The ScreenElement to remove from the {@apilink currentScene}
     */
    remove(screenElement: ScreenElement): void;
    /**
     * Changes the current scene with optionally supplied:
     * * Activation data
     * * Transitions
     * * Loaders
     *
     * Example:
     * \`\`\`typescript
     * game.goToScene('myScene', {
     *   sceneActivationData: {any: 'thing at all'},
     *   destinationIn: new FadeInOut({duration: 1000, direction: 'in'}),
     *   sourceOut: new FadeInOut({duration: 1000, direction: 'out'}),
     *   loader: MyLoader
     * });
     * \`\`\`
     *
     * Scenes are defined in the Engine constructor
     * \`\`\`typescript
     * const engine = new ex.Engine({
        scenes: {...}
      });
     * \`\`\`
     * Or by adding dynamically
     *
     * \`\`\`typescript
     * engine.addScene('myScene', new ex.Scene());
     * \`\`\`
     * @param destinationScene
     * @param options
     */
    goToScene<TData = undefined>(destinationScene: WithRoot<TKnownScenes>, options?: GoToOptions<TData>): Promise<void>;
    /**
     * Transforms the current x, y from screen coordinates to world coordinates
     * @param point  Screen coordinate to convert
     */
    screenToWorldCoordinates(point: Vector): Vector;
    /**
     * Transforms a world coordinate, to a screen coordinate
     * @param point  World coordinate to convert
     */
    worldToScreenCoordinates(point: Vector): Vector;
    /**
     * Initializes the internal canvas, rendering context, display mode, and native event listeners
     */
    private _initialize;
    toggleInputEnabled(enabled: boolean): void;
    onInitialize(engine: Engine): void;
    /**
     * Gets whether the actor is Initialized
     */
    get isInitialized(): boolean;
    private _overrideInitialize;
    /**
     * Updates the entire state of the game
     * @param elapsed  Number of milliseconds elapsed since the last update.
     */
    private _update;
    /**
     * @internal
     */
    _preupdate(elapsed: number): void;
    /**
     * Safe to override method
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     */
    onPreUpdate(engine: Engine, elapsed: number): void;
    /**
     * @internal
     */
    _postupdate(elapsed: number): void;
    /**
     * Safe to override method
     * @param engine The reference to the current game engine
     * @param elapsed  The time elapsed since the last update in milliseconds
     */
    onPostUpdate(engine: Engine, elapsed: number): void;
    /**
     * Draws the entire game
     * @param elapsed  Number of milliseconds elapsed since the last draw.
     */
    private _draw;
    /**
     * @internal
     */
    _predraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Safe to override method to hook into pre draw
     * @param ctx {@link ExcaliburGraphicsContext} for drawing
     * @param elapsed  Number of milliseconds elapsed since the last draw.
     */
    onPreDraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * @internal
     */
    _postdraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Safe to override method to hook into pre draw
     * @param ctx {@link ExcaliburGraphicsContext} for drawing
     * @param elapsed  Number of milliseconds elapsed since the last draw.
     */
    onPostDraw(ctx: ExcaliburGraphicsContext, elapsed: number): void;
    /**
     * Enable or disable Excalibur debugging functionality.
     * @param toggle a value that debug drawing will be changed to
     */
    showDebug(toggle: boolean): void;
    /**
     * Toggle Excalibur debugging functionality.
     */
    toggleDebug(): boolean;
    /**
     * Returns true when loading is totally complete and the player has clicked start
     */
    get loadingComplete(): boolean;
    private _isLoading;
    private _hideLoader;
    private _isReadyFuture;
    get ready(): boolean;
    isReady(): Promise<void>;
    /**
     * Starts the internal game loop for Excalibur after loading
     * any provided assets.
     * @param loader  Optional {@apilink Loader} to use to load resources. The default loader is {@apilink Loader},
     * override to provide your own custom loader.
     *
     * Note: start() only resolves AFTER the user has clicked the play button
     */
    start(loader?: DefaultLoader): Promise<void>;
    /**
     * Starts the internal game loop for Excalibur after configuring any routes, loaders, or transitions
     * @param startOptions Optional {@apilink StartOptions} to configure the routes for scenes in Excalibur
     *
     * Note: start() only resolves AFTER the user has clicked the play button
     */
    start(sceneName: WithRoot<TKnownScenes>, options?: StartOptions): Promise<void>;
    /**
     * Starts the internal game loop after any loader is finished
     * @param loader
     */
    start(loader?: DefaultLoader): Promise<void>;
    /**
     * Returns the current frames elapsed milliseconds
     */
    currentFrameElapsedMs: number;
    /**
     * Returns the current frame lag when in fixed update mode
     */
    currentFrameLagMs: number;
    private _lagMs;
    private _mainloop;
    /**
     * Stops Excalibur's main loop, useful for pausing the game.
     */
    stop(): void;
    /**
     * Returns the Engine's running status, Useful for checking whether engine is running or paused.
     */
    isRunning(): boolean;
    private _screenShotRequests;
    /**
     * Takes a screen shot of the current viewport and returns it as an
     * HTML Image Element.
     * @param preserveHiDPIResolution in the case of HiDPI return the full scaled backing image, by default false
     */
    screenshot(preserveHiDPIResolution?: boolean): Promise<HTMLImageElement>;
    private _checkForScreenShots;
    /**
     * Another option available to you to load resources into the game.
     * Immediately after calling this the game will pause and the loading screen
     * will appear.
     * @param loader  Some {@apilink Loadable} such as a {@apilink Loader} collection, {@apilink Sound}, or {@apilink Texture}.
     */
    load(loader: DefaultLoader, hideLoader?: boolean): Promise<void>;
}

type SoundEvents = {
    volumechange: NativeSoundEvent;
    processed: NativeSoundProcessedEvent;
    pause: NativeSoundEvent;
    stop: NativeSoundEvent;
    playbackend: NativeSoundEvent;
    resume: NativeSoundEvent;
    playbackstart: NativeSoundEvent;
};
declare const SoundEvents: {
    VolumeChange: string;
    Processed: string;
    Pause: string;
    Stop: string;
    PlaybackEnd: string;
    Resume: string;
    PlaybackStart: string;
};
interface SoundOptions {
    /**
     * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.
     */
    paths: string[];
    /**
     * Optionally bust the cache on load
     *
     * Default is false
     */
    bustCache?: boolean;
    /**
     * [0-1] 0% to 100%
     *
     * By default 1 (100%)
     */
    volume?: number;
    /**
     * Loop infinitely
     */
    loop?: boolean;
    /**
     * Multiplyer
     *
     * By default 1
     */
    playbackRate?: number;
    /**
     * Seconds?
     *
     * By default unset, will play the natural length of the clip
     */
    duration?: number;
    /**
     * Advance to a position in the audio clip
     */
    position?: number;
}
/**
 * The {@apilink Sound} object allows games built in Excalibur to load audio
 * components, from soundtracks to sound effects. {@apilink Sound} is an {@apilink Loadable}
 * which means it can be passed to a {@apilink Loader} to pre-load before a game or level.
 */
declare class Sound implements Audio, Loadable<AudioBuffer> {
    events: EventEmitter<SoundEvents>;
    logger: Logger;
    data: AudioBuffer;
    private _resource;
    position: number | undefined;
    /**
     * Indicates whether the clip should loop when complete
     * @param value  Set the looping flag
     */
    set loop(value: boolean);
    get loop(): boolean;
    set volume(value: number);
    get volume(): number;
    private _duration;
    /**
     * Get the duration that this audio should play. If unset the total natural playback duration will be used.
     */
    get duration(): number | undefined;
    /**
     * Set the duration that this audio should play. If unset the total natural playback duration will be used.
     *
     * Note: if you seek to a specific point the duration will start from that point, for example
     *
     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.
     */
    set duration(duration: number | undefined);
    /**
     * Return array of Current AudioInstances playing or being paused
     */
    get instances(): Audio[];
    get path(): string;
    set path(val: string);
    /**
     * Should excalibur add a cache busting querystring? By default false.
     * Must be set before loading
     */
    get bustCache(): boolean;
    set bustCache(val: boolean);
    private _loop;
    private _volume;
    private _isStopped;
    private _tracks;
    private _engine?;
    private _wasPlayingOnHidden;
    private _playbackRate;
    private _audioContext;
    /**
     * @param paths A list of audio sources (clip.wav, clip.mp3, clip.ogg) for this audio clip. This is done for browser compatibility.
     */
    constructor(options: SoundOptions);
    constructor(...paths: string[]);
    isLoaded(): boolean;
    load(): Promise<AudioBuffer>;
    decodeAudio(data: ArrayBuffer): Promise<AudioBuffer>;
    wireEngine(engine: Engine): void;
    /**
     * Returns how many instances of the sound are currently playing
     */
    instanceCount(): number;
    /**
     * Whether or not the sound is playing right now
     */
    isPlaying(): boolean;
    isPaused(): boolean;
    isStopped(): boolean;
    /**
     * Play the sound, returns a promise that resolves when the sound is done playing
     * An optional volume argument can be passed in to play the sound. Max volume is 1.0
     */
    play(volume?: number): Promise<boolean>;
    /**
     * Stop the sound, and do not rewind
     */
    pause(): void;
    /**
     * Stop the sound if it is currently playing and rewind the track. If the sound is not playing, rewinds the track.
     */
    stop(): void;
    get playbackRate(): number;
    set playbackRate(playbackRate: number);
    seek(position: number, trackId?: number): void;
    getTotalPlaybackDuration(): number;
    /**
     * Return the current playback time of the playing track in seconds from the start.
     *
     * Optionally specify the track to query if multiple are playing at once.
     * @param trackId
     */
    getPlaybackPosition(trackId?: number): number;
    /**
     * Get Id of provided AudioInstance in current trackList
     * @param track {@apilink Audio} which Id is to be given
     */
    getTrackId(track: Audio): number;
    private _resumePlayback;
    /**
     * Starts playback, returns a promise that resolves when playback is complete
     */
    private _startPlayback;
    private _getTrackInstance;
    emit<TEventName extends EventKey<SoundEvents>>(eventName: TEventName, event: SoundEvents[TEventName]): void;
    emit(eventName: string, event?: any): void;
    on<TEventName extends EventKey<SoundEvents>>(eventName: TEventName, handler: Handler<SoundEvents[TEventName]>): Subscription;
    on(eventName: string, handler: Handler<unknown>): Subscription;
    once<TEventName extends EventKey<SoundEvents>>(eventName: TEventName, handler: Handler<SoundEvents[TEventName]>): Subscription;
    once(eventName: string, handler: Handler<unknown>): Subscription;
    off<TEventName extends EventKey<SoundEvents>>(eventName: TEventName, handler: Handler<SoundEvents[TEventName]>): void;
    off(eventName: string, handler: Handler<unknown>): void;
    off(eventName: string): void;
}

/**
 * Internal class representing a Web Audio AudioBufferSourceNode instance
 * @see https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API
 */
declare class WebAudioInstance implements Audio {
    private _src;
    private _instance;
    private _audioContext;
    private _volumeNode;
    private _playingFuture;
    private _stateMachine;
    private _createNewBufferSource;
    private _handleEnd;
    private _volume;
    private _loop;
    private _playStarted;
    set loop(value: boolean);
    get loop(): boolean;
    set volume(value: number);
    get volume(): number;
    private _duration;
    /**
     * Returns the set duration to play, otherwise returns the total duration if unset
     */
    get duration(): number;
    /**
     * Set the duration that this audio should play.
     *
     * Note: if you seek to a specific point the duration will start from that point, for example
     *
     * If you have a 10 second clip, seek to 5 seconds, then set the duration to 2, it will play the clip from 5-7 seconds.
     */
    set duration(duration: number);
    constructor(_src: AudioBuffer);
    isPlaying(): boolean;
    isPaused(): boolean;
    isStopped(): boolean;
    play(playStarted?: () => any): Promise<boolean>;
    pause(): void;
    stop(): void;
    seek(position: number): void;
    getTotalPlaybackDuration(): number;
    getPlaybackPosition(): number;
    private _playbackRate;
    set playbackRate(playbackRate: number);
    get playbackRate(): number;
}

declare class MediaEvent extends GameEvent<Sound> {
    target: Sound;
    protected _name: string;
    /**
     * Media event cannot bubble
     */
    set bubbles(_value: boolean);
    /**
     * Media event cannot bubble
     */
    get bubbles(): boolean;
    /**
     * Media event cannot bubble, so they have no path
     */
    protected get _path(): Actor[];
    /**
     * Media event cannot bubble, so they have no path
     */
    protected set _path(_val: Actor[]);
    constructor(target: Sound, _name?: string);
    /**
     * Prevents event from bubbling
     */
    stopPropagation(): void;
    /**
     * Action, that calls when event happens
     */
    action(): void;
    /**
     * Propagate event further through event path
     */
    propagate(): void;
    layPath(_actor: Actor): void;
}
declare class NativeSoundEvent extends MediaEvent {
    track?: WebAudioInstance;
    constructor(target: Sound, track?: WebAudioInstance);
}
declare class NativeSoundProcessedEvent extends MediaEvent {
    private _processedData;
    data: string | AudioBuffer;
    constructor(target: Sound, _processedData: string | AudioBuffer);
}

/**
 * Option for creating a label
 */
interface LabelOptions {
    /**
     * Specify the label text
     */
    text?: string;
    /**
     * Specify a max width for the text in pixels, if specified the text will wrap.
     *
     * **Not supported in SpriteFont**
     */
    maxWidth?: number;
    /**
     * Specify the color of the text (does not apply to SpriteFonts)
     */
    color?: Color;
    x?: number;
    y?: number;
    pos?: Vector;
    /**
     * Optionally specify a sprite font, will take precedence over any other {@apilink Font}
     */
    spriteFont?: SpriteFont;
    /**
     * Specify a custom font
     */
    font?: Font;
}
/**
 * Labels are the way to draw small amounts of text to the screen. They are
 * actors and inherit all of the benefits and capabilities.
 */
declare class Label extends Actor {
    private _font;
    private _text;
    set maxWidth(width: number | undefined);
    get maxWidth(): number | undefined;
    get font(): Font;
    set font(newFont: Font);
    /**
     * The text to draw.
     */
    get text(): string;
    set text(text: string);
    get color(): Color;
    set color(color: Color);
    get opacity(): number;
    set opacity(opacity: number);
    private _spriteFont;
    /**
     * The {@apilink SpriteFont} to use, if any. Overrides {@apilink Font | \`font\`} if present.
     */
    get spriteFont(): SpriteFont;
    set spriteFont(sf: SpriteFont);
    /**
     * Build a new label
     * @param options
     */
    constructor(options?: LabelOptions & ActorArgs);
    _initialize(engine: Engine): void;
    /**
     * Returns the width of the text in the label (in pixels);
     */
    getTextWidth(): number;
}

type ResourceEvents = {
    complete: any;
    load: ProgressEvent<XMLHttpRequestEventTarget>;
    loadstart: ProgressEvent<XMLHttpRequestEventTarget>;
    progress: ProgressEvent<XMLHttpRequestEventTarget>;
    error: ProgressEvent<XMLHttpRequestEventTarget>;
};
declare const ResourceEvents: {
    Complete: string;
    Load: string;
    LoadStart: string;
    Progress: string;
    Error: string;
};
/**
 * The {@apilink Resource} type allows games built in Excalibur to load generic resources.
 * For any type of remote resource it is recommended to use {@apilink Resource} for preloading.
 */
declare class Resource<T> implements Loadable<T> {
    path: string;
    responseType: '' | 'arraybuffer' | 'blob' | 'document' | 'json' | 'text';
    bustCache: boolean;
    data: T;
    logger: Logger;
    events: EventEmitter<any>;
    /**
     * @param path          Path to the remote resource
     * @param responseType  The type to expect as a response: "" | "arraybuffer" | "blob" | "document" | "json" | "text";
     * @param bustCache     Whether or not to cache-bust requests
     */
    constructor(path: string, responseType: '' | 'arraybuffer' | 'blob' | 'document' | 'json' | 'text', bustCache?: boolean);
    /**
     * Returns true if the Resource is completely loaded and is ready
     * to be drawn.
     */
    isLoaded(): boolean;
    private _cacheBust;
    /**
     * Begin loading the resource and returns a promise to be resolved on completion
     */
    load(): Promise<T>;
}

type AnyString = {} & string;
interface ChannelSoundsConfiguration {
    sounds: Sound[];
}
interface SoundConfig<Channel extends string = string> {
    sound: Sound;
    /**
     * Maximum volume for the sound manager to use, all soundManager.play(.5) calls will
     */
    volume?: number;
    /**
     *
     * You may also add a list of string \`channels\` to do group operations to sounds at once. For example mute all 'background' sounds.
     */
    channels?: Channel[];
}
interface SoundManagerOptions<Channel extends string = string, SoundName extends string = string> {
    /**
     * Optionally specify the possible channels to avoid typo's
     */
    channels?: readonly Channel[];
    /**
     * Optionally set the default maximum volume for all sounds
     *
     * Default is 1 (100%)
     */
    volume?: number;
    /**
     * Optionally set the max \`volume\` for a \`sound\` to be when played. All other volume operations will be a fraction of the mix.
     *
     * You may also add a list of string \`channels\` to do group operations to sounds at once. For example mute all 'background' sounds.
     *
     */
    sounds: Record<SoundName, Sound | SoundConfig<NoInfer<Channel>>>;
}
type PossibleChannels<TSoundManagerOptions> = TSoundManagerOptions extends SoundManagerOptions<infer Channels> ? Channels : never;
type PossibleSounds<TSoundMangerOptions> = TSoundMangerOptions extends SoundManagerOptions ? Extract<keyof TSoundMangerOptions['sounds'], string> : never;
interface SoundManagerApi {
    setVolume(name: string, volume?: number): void;
    play(name: string, volume?: number): Promise<void>;
    stop(name?: string): void;
    mute(name?: string): void;
    unmute(name?: string): void;
    toggle(name?: string): void;
}
declare class ChannelCollection<Channel extends string> implements SoundManagerApi {
    soundManager: SoundManager<Channel, string>;
    constructor(options: SoundManagerOptions<Channel, string>, soundManager: SoundManager<Channel, string>);
    stop(name: string): void;
    setVolume(name: Channel, volume?: number): void;
    play(name: Channel, volume?: number): Promise<void>;
    mute(name: Channel): void;
    unmute(name: Channel): void;
    toggle(name: Channel): void;
}
/**
 * Manage Sound volume levels without mutating the original Sound objects
 */
declare class SoundManager<Channel extends string, SoundName extends string> implements SoundManagerApi {
    private _channelToConfig;
    private _nameToConfig;
    private _mix;
    _muted: Set<Sound>;
    private _all;
    private _defaultVolume;
    set defaultVolume(volume: number);
    get defaultVolume(): number;
    channel: ChannelCollection<Channel>;
    constructor(options: SoundManagerOptions<Channel, SoundName>);
    getSounds(): readonly Sound[];
    getSoundsForChannel(channel: Channel | AnyString): readonly Sound[];
    _isMuted(sound: Sound): boolean;
    _getEffectiveVolume(sound: Sound): number;
    play(soundName: SoundName, volume?: number): Promise<void>;
    getSound(soundName: SoundName | AnyString): Sound | undefined;
    setVolume(soundname: SoundName, volume?: number): void;
    /**
     * Gets the volumn for a sound
     */
    getVolume(soundName: SoundName): number;
    /**
     * Set the maximum volume a sound, if not set assumed to be 1.0 (100% of the source volume)
     */
    private _setMix;
    track(name: SoundName | AnyString, soundOrConfig: Sound | SoundConfig): void;
    /**
     * Remove the maximum volume for a sound, will be 100% of the source volume
     *
     * Untracks the Sound in the sound manager
     */
    untrack(soundName: SoundName): void;
    stop(name?: SoundName): void;
    mute(name?: SoundName): void;
    unmute(name?: SoundName): void;
    toggle(name?: SoundName): void;
    /**
     * Apply a list of channels to a sound instance
     */
    addChannel(soundName: SoundName | AnyString, channels: Channel[] | AnyString[]): void;
    removeChannel(soundName: SoundName | AnyString, channels: Channel[] | AnyString[]): void;
}

/**
 * Internal class used to build instances of AudioContext
 */
declare class AudioContextFactory {
    private static _INSTANCE?;
    static create(): AudioContext;
}

/**
 * The {@apilink Texture} object allows games built in Excalibur to load image resources.
 * {@apilink Texture} is an {@apilink Loadable} which means it can be passed to a {@apilink Loader}
 * to pre-load before starting a level or game.
 */
declare class Gif implements Loadable<ImageSource[]> {
    path: string;
    private _resource;
    /**
     * The width of the texture in pixels
     */
    width: number;
    /**
     * The height of the texture in pixels
     */
    height: number;
    private _stream?;
    private _gif?;
    private _images;
    private _animation?;
    data: ImageSource[];
    private _sprites;
    /**
     * @param path       Path to the image resource
     * @param bustCache  Optionally load texture with cache busting
     */
    constructor(path: string, bustCache?: boolean);
    /**
     * Should excalibur add a cache busting querystring? By default false.
     * Must be set before loading
     */
    get bustCache(): boolean;
    set bustCache(val: boolean);
    /**
     * Begins loading the texture and returns a promise to be resolved on completion
     */
    load(): Promise<ImageSource[]>;
    isLoaded(): boolean;
    /**
     * Return a frame of the gif as a sprite by id
     * @param id
     */
    toSprite(id?: number): Sprite | null;
    /**
     * Return the gif as a spritesheet
     */
    toSpriteSheet(): SpriteSheet | null;
    /**
     * Transform the GIF into an animation with duration per frame
     * @param durationPerFrame Optionally override duration per frame
     */
    toAnimation(durationPerFrame?: number): Animation | null;
    get readCheckBytes(): number[];
}
interface GifFrame {
    sentinel: number;
    type: string;
    leftPos: number;
    topPos: number;
    width: number;
    height: number;
    lctFlag: boolean;
    lctBytes: [number, number, number][];
    interlaced: boolean;
    sorted: boolean;
    reserved: boolean[];
    lctSize: number;
    lzwMinCodeSize: number;
    pixels: number[];
    delayTime: number;
    delayMs: number;
}
declare class Stream {
    data: Uint8Array;
    len: number;
    position: number;
    constructor(dataArray: ArrayBuffer);
    readByte: () => number;
    readBytes: (n: number) => any[];
    read: (n: number) => string;
    readUnsigned: () => any;
}
interface GifBlock {
    sentinel: number;
    type: string;
}
interface GCExtBlock extends GifBlock {
    type: 'ext';
    label: number;
    extType: string;
    reserved: boolean[];
    disposalMethod: number;
    userInputFlag: boolean;
    transparentColorFlag: boolean;
    delayTime: number;
    transparentColorIndex: number;
    terminator: number;
}
/**
 * GifParser for binary format
 *
 * Roughly based on the documentation https://giflib.sourceforge.net/whatsinagif/index.html
 */
declare class GifParser {
    private _st;
    private _handler;
    frames: GifFrame[];
    images: HTMLImageElement[];
    private _currentFrameCanvas;
    private _currentFrameContext;
    globalColorTableBytes: [number, number, number][];
    checkBytes: number[];
    private _gce?;
    private _hdr?;
    constructor(stream: Stream);
    parseColorTableBytes: (entries: number) => [number, number, number][];
    readSubBlocks: () => any;
    parseHeader: () => void;
    parseExt: (block: GCExtBlock) => void;
    parseImg: (img: GifFrame) => void;
    parseBlocks: () => void;
    arrayToImage: (frame: GifFrame, colorTable: [number, number, number][]) => void;
}

interface FontSourceOptions extends Omit<FontOptions, 'family'>, GraphicOptions, RasterOptions {
    /**
     * Whether or not to cache-bust requests
     */
    bustCache?: boolean;
}
declare class FontSource implements Loadable<FontFace> {
    /**
     * Path to the font resource relative from the HTML document hosting the game, or absolute
     */
    readonly path: string;
    /**
     * The font family name
     */
    readonly family: string;
    private _resource;
    private _isLoaded;
    private _options;
    data: FontFace;
    constructor(
    /**
     * Path to the font resource relative from the HTML document hosting the game, or absolute
     */
    path: string, 
    /**
     * The font family name
     */
    family: string, { bustCache, ...options }?: FontSourceOptions);
    load(): Promise<FontFace>;
    isLoaded(): boolean;
    /**
     * Build a font from this FontSource.
     * @param options {FontOptions} Override the font options
     */
    toFont(options?: FontOptions & GraphicOptions & RasterOptions): Font;
}

/**
 * Native browser button enumeration
 */
declare enum NativePointerButton {
    NoButton = -1,
    Left = 0,
    Middle = 1,
    Right = 2,
    Unknown = 3
}

/**
 * Turn on move and drag events for an {@apilink Actor}
 */
interface CapturePointerConfig {
    /**
     * Capture PointerMove events (may be expensive!)
     */
    captureMoveEvents: boolean;
    /**
     * Capture PointerDrag events (may be expensive!)
     */
    captureDragEvents: boolean;
}

/**
 * The PointerSystem is responsible for dispatching pointer events to entities
 * that need them.
 *
 * The PointerSystem can be optionally configured by the {@apilink PointerComponent}, by default Entities use
 * the {@apilink Collider}'s shape for pointer events.
 */
declare class PointerSystem extends System {
    world: World;
    static priority: -5;
    readonly systemType = SystemType.Update;
    private _engine;
    private _receivers;
    private _engineReceiver;
    private _graphicsHashGrid;
    private _graphics;
    private _entityToPointer;
    private _pointerEventDispatcher;
    query: Query<typeof TransformComponent | typeof PointerComponent>;
    constructor(world: World);
    /**
     * Optionally override component configuration for all entities
     */
    overrideUseColliderShape: boolean;
    /**
     * Optionally override component configuration for all entities
     */
    overrideUseGraphicsBounds: boolean;
    private _scene;
    initialize(world: World, scene: Scene): void;
    private _sortedTransforms;
    private _sortedEntities;
    private _zHasChanged;
    private _zIndexUpdate;
    preupdate(): void;
    update(): void;
}

/**
 *
 */
declare function getMinIndex(array: number[]): number;
/**
 * Find the screen position of an HTML element
 */
declare function getPosition(el: HTMLElement): Vector;
/**
 * Add an item to an array list if it doesn't already exist. Returns true if added, false if not and already exists in the array.
 * @deprecated Will be removed in v0.26.0
 */
declare function addItemToArray<T>(item: T, array: T[]): boolean;
/**
 * Remove an item from an list
 * @deprecated Will be removed in v0.26.0
 */
declare function removeItemFromArray<T>(item: T, array: T[]): boolean;
/**
 * See if an array contains something
 */
declare function contains(array: Array<any>, obj: any): boolean;
/**
 * Used for exhaustive checks at compile time
 */
declare function fail(message: never): never;
/**
 * Create a promise that resolves after a certain number of milliseconds
 *
 * It is strongly recommended you pass the excalibur clock so delays are bound to the
 * excalibur clock which would be unaffected by stop/pause.
 * @param milliseconds
 * @param clock
 */
declare function delay(milliseconds: number, clock?: Clock): Promise<void>;
/**
 * Remove keys from object literals
 * @param object
 * @param keys
 */
declare function omit<TObject extends Object, Keys extends keyof TObject>(object: TObject, keys: Keys[]): Omit<TObject, Keys>;
/**
 * Simple object check.
 * @param item
 */
declare function isObject(item: any): item is object;
/**
 * Deep merge two objects.
 * @param target
 * @param sources
 */
declare function mergeDeep<T extends object>(target: T, ...sources: T[]): T;

/**
 * A canvas linecap style. "butt" is the default flush style, "round" is a semi-circle cap with a radius half the width of
 * the line, and "square" is a rectangle that is an equal width and half height cap.
 */
type LineCapStyle = 'butt' | 'round' | 'square';
/**
 * Draw a line on canvas context
 * @param ctx The canvas context
 * @param color The color of the line
 * @param x1 The start x coordinate
 * @param y1 The start y coordinate
 * @param x2 The ending x coordinate
 * @param y2 The ending y coordinate
 * @param thickness The line thickness
 * @param cap The {@apilink LineCapStyle} (butt, round, or square)
 */
declare function line(ctx: CanvasRenderingContext2D, color: Color, x1: number, y1: number, x2: number, y2: number, thickness?: number, cap?: LineCapStyle): void;
/**
 * Draw the vector as a point onto the canvas.
 */
declare function point(ctx: CanvasRenderingContext2D, color: Color, point: Vector): void;
/**
 * Draw the vector as a line onto the canvas starting a origin point.
 */
/**
 *
 */
declare function vector(ctx: CanvasRenderingContext2D, color: Color, origin: Vector, vector: Vector, scale?: number): void;
/**
 * Represents border radius values
 */
interface BorderRadius {
    /**
     * Top-left
     */
    tl: number;
    /**
     * Top-right
     */
    tr: number;
    /**
     * Bottom-right
     */
    br: number;
    /**
     * Bottom-left
     */
    bl: number;
}
/**
 * Draw a round rectangle on a canvas context
 * @param ctx The canvas context
 * @param x The top-left x coordinate
 * @param y The top-left y coordinate
 * @param width The width of the rectangle
 * @param height The height of the rectangle
 * @param radius The border radius of the rectangle
 * @param stroke The {@apilink Color} to stroke rectangle with
 * @param fill The {@apilink Color} to fill rectangle with
 */
declare function roundRect(ctx: CanvasRenderingContext2D, x: number, y: number, width: number, height: number, radius?: number | BorderRadius, stroke?: Color | null, fill?: Color | null): void;
/**
 *
 */
declare function circle(ctx: CanvasRenderingContext2D, x: number, y: number, radius: number, stroke?: Color, fill?: Color): void;

type DrawUtil_BorderRadius = BorderRadius;
type DrawUtil_LineCapStyle = LineCapStyle;
declare const DrawUtil_circle: typeof circle;
declare const DrawUtil_line: typeof line;
declare const DrawUtil_point: typeof point;
declare const DrawUtil_roundRect: typeof roundRect;
declare const DrawUtil_vector: typeof vector;
declare namespace DrawUtil {
  export { type DrawUtil_BorderRadius as BorderRadius, type DrawUtil_LineCapStyle as LineCapStyle, DrawUtil_circle as circle, DrawUtil_line as line, DrawUtil_point as point, DrawUtil_roundRect as roundRect, DrawUtil_vector as vector };
}

type Index_Appender = Appender;
type Index_ConsoleAppender = ConsoleAppender;
declare const Index_ConsoleAppender: typeof ConsoleAppender;
declare const Index_DrawUtil: typeof DrawUtil;
type Index_EasingFunction<TValueToEase = number> = EasingFunction<TValueToEase>;
type Index_EasingFunctions = EasingFunctions;
declare const Index_EasingFunctions: typeof EasingFunctions;
type Index_LogLevel = LogLevel;
declare const Index_LogLevel: typeof LogLevel;
type Index_Logger = Logger;
declare const Index_Logger: typeof Logger;
type Index_MaybeObserver<T> = MaybeObserver<T>;
type Index_Message<T> = Message<T>;
type Index_Observable<T> = Observable<T>;
declare const Index_Observable: typeof Observable;
type Index_Observer<T> = Observer<T>;
type Index_ScreenAppender = ScreenAppender;
declare const Index_ScreenAppender: typeof ScreenAppender;
type Index_ScreenAppenderOptions = ScreenAppenderOptions;
declare const Index_addItemToArray: typeof addItemToArray;
declare const Index_contains: typeof contains;
declare const Index_delay: typeof delay;
declare const Index_fail: typeof fail;
declare const Index_getMinIndex: typeof getMinIndex;
declare const Index_getPosition: typeof getPosition;
declare const Index_isObject: typeof isObject;
declare const Index_mergeDeep: typeof mergeDeep;
declare const Index_omit: typeof omit;
declare const Index_removeItemFromArray: typeof removeItemFromArray;
declare namespace Index {
  export { type Index_Appender as Appender, Index_ConsoleAppender as ConsoleAppender, Index_DrawUtil as DrawUtil, type Index_EasingFunction as EasingFunction, Index_EasingFunctions as EasingFunctions, Index_LogLevel as LogLevel, Index_Logger as Logger, type Index_MaybeObserver as MaybeObserver, type Index_Message as Message, Index_Observable as Observable, type Index_Observer as Observer, Index_ScreenAppender as ScreenAppender, type Index_ScreenAppenderOptions as ScreenAppenderOptions, Index_addItemToArray as addItemToArray, Index_contains as contains, Index_delay as delay, Index_fail as fail, Index_getMinIndex as getMinIndex, Index_getPosition as getPosition, Index_isObject as isObject, Index_mergeDeep as mergeDeep, Index_omit as omit, Index_removeItemFromArray as removeItemFromArray };
}

/**
 * Obsolete decorator options
 */
interface ObsoleteOptions {
    message?: string;
    alternateMethod?: string;
    showStackTrace?: boolean;
}
declare const maxMessages = 5;
declare const resetObsoleteCounter: () => void;
/**
 * Obsolete decorator for marking Excalibur methods obsolete, you can optionally specify a custom message and/or alternate replacement
 * method do the deprecated one. Inspired by https://github.com/jayphelps/core-decorators.js
 */
declare function obsolete(options?: ObsoleteOptions): any;

/**
 * Interface for detected browser features matrix
 */
interface DetectedFeatures {
    readonly canvas: boolean;
    readonly arraybuffer: boolean;
    readonly dataurl: boolean;
    readonly objecturl: boolean;
    readonly rgba: boolean;
    readonly webaudio: boolean;
    readonly webgl: boolean;
    readonly gamepadapi: boolean;
}
/**
 * Excalibur internal feature detection helper class
 */
declare class Detector {
    private _features;
    failedTests: string[];
    constructor();
    /**
     * Returns a map of currently supported browser features. This method
     * treats the features as a singleton and will only calculate feature
     * support if it has not previously been done.
     */
    getBrowserFeatures(): DetectedFeatures;
    /**
     * Report on non-critical browser support for debugging purposes.
     * Use native browser console colors for visibility.
     */
    logBrowserFeatures(): void;
    /**
     * Executes several IIFE's to get a constant reference to supported
     * features within the current execution context.
     */
    private _loadBrowserFeatures;
    private _criticalTests;
    private _warningTest;
    test(): boolean;
}

interface LegacyWebAudioSource {
    playbackState: string;
    PLAYING_STATE: 'playing';
    FINISHED_STATE: 'finished';
}
declare class WebAudio {
    private static _UNLOCKED;
    /**
     * Play an empty sound to unlock Safari WebAudio context. Call this function
     * right after a user interaction event.
     * @source https://paulbakaus.com/tutorials/html5/web-audio-on-ios/
     */
    static unlock(): Promise<boolean>;
    static isUnlocked(): boolean;
}

/**
 * The Toaster is only meant to be called from inside Excalibur to display messages to players
 */
declare class Toaster {
    private _styleBlock;
    private _container;
    private _toasterCss;
    private _isInitialized;
    private _initialize;
    dispose(): void;
    private _createFragment;
    /**
     * Display a toast message to a player
     * @param message Text of the message, messages may have a single "[LINK]" to influence placement
     * @param linkTarget Optionally specify a link location
     * @param linkName Optionally specify a name for that link location
     */
    toast(message: string, linkTarget?: string, linkName?: string): void;
}

interface State<TData> {
    name?: string;
    transitions: string[];
    onEnter?: (context: {
        from: string;
        eventData?: any;
        data: TData;
    }) => boolean | void;
    onState?: () => any;
    onExit?: (context: {
        to: string;
        data: TData;
    }) => boolean | void;
    onUpdate?: (data: TData, elapsed: number) => any;
}
interface StateMachineDescription<TData = any> {
    start: string;
    states: {
        [name: string]: State<TData>;
    };
}
type PossibleStates<TMachine> = TMachine extends StateMachineDescription ? Extract<keyof TMachine['states'], string> : never;
interface StateMachineState<TData> {
    data: TData;
    currentState: string;
}
declare class StateMachine<TPossibleStates extends string, TData> {
    startState: State<TData>;
    private _currentState;
    get currentState(): State<TData>;
    set currentState(state: State<TData>);
    states: Map<string, State<TData>>;
    data: TData;
    static create<TMachine extends StateMachineDescription<TData>, TData>(machineDescription: TMachine, data?: TData): StateMachine<PossibleStates<TMachine>, TData>;
    in(state: TPossibleStates): boolean;
    go(stateName: TPossibleStates, eventData?: any): boolean;
    update(elapsed: number): void;
    save(saveKey: string): void;
    restore(saveKey: string): void;
}

/**
 * Semaphore allows you to limit the amount of async calls happening between \`enter()\` and \`exit()\`
 *
 * This can be useful when limiting the number of http calls, browser api calls, etc either for performance or to work
 * around browser limitations like max Image.decode() calls in chromium being 256.
 */
declare class Semaphore {
    private _count;
    private _waitQueue;
    constructor(_count: number);
    get count(): number;
    get waiting(): number;
    enter(): Promise<unknown>;
    exit(count?: number): void;
}

/**
 * Asserts will throw in \`process.env.NODE_ENV === 'development'\` builds if the expression evaluates false
 */
declare function assert(message: string, expression: () => boolean): void;

declare class RentalPool<T> {
    builder: () => T;
    cleaner: (used: T) => T;
    private _pool;
    private _size;
    constructor(builder: () => T, cleaner: (used: T) => T, preAllocate?: number);
    /**
     * Grow the pool size by an amount
     * @param amount
     */
    grow(amount: number): void;
    /**
     * Rent an object from the pool, optionally clean it. If not cleaned previous state may be set.
     *
     * The pool will automatically double if depleted
     * @param clean
     */
    rent(clean?: boolean): T;
    /**
     * Return an object to the pool
     * @param object
     */
    return(object: T): void;
}

/**
 * The current Excalibur version string
 * @description \`process.env.__EX_VERSION\` gets replaced by Webpack on build
 */
declare const EX_VERSION: string;

export { type Action, ActionCompleteEvent, ActionContext, type ActionContextMethods, ActionQueue, ActionSequence, ActionStartEvent, type Actionable, ActionsComponent, ActionsSystem, ActivateEvent, Actor, type ActorArgs, ActorEvents, AddEvent, AddedComponent, AffineMatrix, Animation, AnimationDirection, AnimationEvents, type AnimationOptions, AnimationStrategy, type AntialiasOptions, type AnyString, type Appender, ArcadeSolver, type Audio, AudioContextFactory, type AudioImplementation, Axes, Axis, BaseAlign, BezierCurve, type BezierCurveOptions, Blink, BodyComponent, type BodyComponentOptions, BoundingBox, type BoundingBoxOptions, BrowserComponent, BrowserEvents, Buttons, Camera, CameraEvents, type CameraStrategy, type CanActivate, type CanAdd, type CanBeKilled, type CanDeactivate, type CanDraw, type CanInitialize, type CanRemove, type CanUpdate, Canvas, type CanvasOptions, type CapturePointerConfig, ChannelCollection, type ChannelSoundsConfiguration, Circle, CircleCollider, type CircleColliderOptions, type CircleOptions, Clock, type ClockOptions, type Clonable, ClosestLineJumpTable, Collider, ColliderComponent, type ColliderProxy, CollisionContact, CollisionEndEvent, CollisionGroup, CollisionGroupManager, CollisionJumpTable, CollisionPostSolveEvent, CollisionPreSolveEvent, type CollisionProcessor, type CollisionSolver, CollisionStartEvent, CollisionSystem, CollisionType, Color, ColorBlindFlags, ColorBlindnessMode, ColorBlindnessPostProcessor, Component, type ComponentCtor, type ComponentInstance, CompositeCollider, ConsoleAppender, type ContactBias, ContactConstraintPoint, ContactEndEvent, ContactSolveBias, ContactStartEvent, CoordPlane, type CoroutineGenerator, type CoroutineInstance, type CoroutineOptions, CrossFade, type CrossFadeOptions, CurveBy, type CurveByOptions, CurveTo, type CurveToOptions, DeactivateEvent, Debug, DebugConfig, type DebugDraw, DebugGraphicsComponent, type DebugStats, DebugSystem, DebugText, DefaultAntialiasOptions, DefaultGarbageCollectionOptions, DefaultLoader, type DefaultLoaderOptions, DefaultPixelArtOptions, DegreeOfFreedom, Delay, type DestinationSize, type DetectedFeatures, Detector, Die, Direction, Director, DirectorEvents, type DirectorNavigationEvent, DisplayMode, type DistributeEntity, DynamicTree, DynamicTreeCollisionProcessor, type DynamicTreeConfig, EX_VERSION, EaseBy, EaseTo, type EasingFunction, EasingFunctions, Edge, EdgeCollider, type EdgeColliderOptions, ElasticToActorStrategy, EmitterType, Engine, EngineEvents, type EngineOptions, EnterTriggerEvent, EnterViewPortEvent, Entity, type EntityComponent, EntityEvents, EntityManager, type EntityOptions, EventEmitter, type EventKey, type EventMap, EventTypes, type Eventable, Events, ExResponse, type ExResponseType, type ExResponseTypesLookup, type ExcaliburGraphicsContext, ExcaliburGraphicsContext2DCanvas, type ExcaliburGraphicsContext2DOptions, type ExcaliburGraphicsContextOptions, type ExcaliburGraphicsContextState, ExcaliburGraphicsContextWebGL, type ExcaliburGraphicsContextWebGLOptions, ExitTriggerEvent, ExitViewPortEvent, Fade, FadeInOut, type FadeOptions, Flags, Flash, Follow, Font, FontCache, type FontOptions, type FontRenderer, FontSource, type FontSourceOptions, FontStyle, FontUnit, FpsSampler, type FpsSamplerOptions, type Frame, type FrameActorStats, type FrameDurationStats, type FrameEvent, type FrameStatistics, FrameStats, type FromSpriteSheetOptions, type FullScreenChangeEvent, Future, type G_UUID, GameEvent, GameStartEvent, GameStopEvent, Gamepad, GamepadAxisEvent, GamepadButtonEvent, type GamepadConfiguration, GamepadConnectEvent, GamepadDisconnectEvent, Gamepads, type GarbageCollectionOptions, GarbageCollector, type GarbageCollectorOptions, type GetSpriteOptions, Gif, type GifFrame, GifParser, GlobalCoordinates, type GoToOptions, type GpuParticleConfig, GpuParticleEmitter, GpuParticleRenderer, Graph, Graphic, type GraphicOptions, GraphicsComponent, type GraphicsComponentOptions, GraphicsGroup, type GraphicsGrouping, type GraphicsGroupingOptions, type GraphicsShowOptions, type GraphicsStatistics, GraphicsSystem, type HTMLImageSource, type Handler, type HasTick, HashColliderProxy, HashGridCell, HashGridProxy, HiddenEvent, HorizontalFirst, type Id, ImageFiltering, ImageSource, ImageSourceAttributeConstants, type ImageSourceOptions, type ImageWrapConfiguration, ImageWrapping, InitializeEvent, InputHost, type InputHostOptions, InputMapper, type InputsOptions, IsometricEntityComponent, type IsometricEntityComponentOptions, IsometricEntitySystem, IsometricMap, type IsometricMapOptions, IsometricTile, type IsometricTilePointerEvents, KeyEvent, Keyboard, type KeyboardInitOptions, Keys, KillEvent, Label, type LabelOptions, type LegacyWebAudioSource, LimitCameraBoundsStrategy, Line, type LineGraphicsOptions, type LineOptions, LineSegment, type Loadable, Loader, type LoaderConstructor, LoaderEvents, type LoaderOptions, LockCameraToActorAxisStrategy, LockCameraToActorStrategy, LogLevel, Logger, Material, type MaterialImageOptions, type MaterialOptions, Matrix, MatrixLocations, type MaybeKnownComponent, type MaybeObserver, MediaEvent, Meet, type Message, type Motion, MotionComponent, MotionSystem, MoveBy, type MoveByOptions, MoveByWithOptions, MoveTo, type MoveToOptions, MoveToWithOptions, type NativeEventable, type NativeMouseEvent, NativePointerButton, type NativePointerEvent, NativeSoundEvent, NativeSoundProcessedEvent, type NativeTouchEvent, type NativeWheelEvent, type NavigatorGamepad, type NavigatorGamepadButton, type NavigatorGamepadEvent, type NavigatorGamepads, NineSlice, type NineSliceConfig, NineSliceStretch, Node, None, Observable, type Observer, type ObsoleteOptions, OffscreenSystem, type OnAdd, type OnInitialize, type OnPostDraw, type OnPostUpdate, type OnPreDraw, type OnPreUpdate, type OnRemove, Pair, ParallaxComponent, ParallelActions, Particle, type ParticleConfig, ParticleEmitter, type ParticleEmitterArgs, ParticleRenderer, ParticleTransform, type PhysicsConfig, type PhysicsStatistics, PhysicsStats, PhysicsWorld, type PixelRatioChangeEvent, type PointGraphicsOptions, PointerAbstraction, PointerButton, PointerComponent, PointerEvent, PointerEventReceiver, type PointerEvents$1 as PointerEvents, type PointerInitOptions, PointerScope, PointerSystem, PointerType, Polygon, PolygonCollider, type PolygonColliderOptions, type PolygonOptions, Pool, PositionNode, type PossibleChannels, type PossibleSounds, type PossibleStates, PostCollisionEvent, PostDebugDrawEvent, PostDrawEvent, PostFrameEvent, PostKillEvent, type PostProcessor, PostTransformDrawEvent, PostUpdateEvent, PreCollisionEvent, PreDebugDrawEvent, PreDrawEvent, PreFrameEvent, PreKillEvent, PreLoadEvent, PreTransformDrawEvent, PreUpdateEvent, Projection, QuadIndexBuffer, QuadTree, type QuadTreeItem, type QuadTreeOptions, Query, type QueryEntity, QueryManager, type QueryParams, RadiusAroundActorStrategy, Random, Raster, type RasterOptions, Ray, type RayCastHit, type RayCastOptions, RealisticSolver, type RectGraphicsOptions, Rectangle, type RectangleOptions, RemoveEvent, RemovedComponent, type RendererPlugin, RentalPool, Repeat, RepeatForever, Resolution, Resource, ResourceEvents, RotateBy, type RotateByOptions, RotateByWithOptions, RotateTo, type RotateToOptions, RotateToWithOptions, RotationType, ScaleBy, type ScaleByOptions, ScaleByWithOptions, ScaleTo, type ScaleToOptions, ScaleToWithOptions, Scene, type SceneActivationContext, type SceneConstructor, SceneEvents, type SceneMap, type SceneWithOptions, type ScheduleId, type ScheduledCallbackTiming, Screen, ScreenAppender, type ScreenAppenderOptions, ScreenElement, ScreenEvents, type ScreenOptions, type ScreenResizeEvent, ScreenShader, ScrollPreventionMode, Semaphore, SeparatingAxis, SeparationInfo, Shader, type ShaderOptions, Shape, Side, Slide, type SlideOptions, SolverStrategy, Sound, type SoundConfig, SoundEvents, SoundManager, type SoundManagerApi, type SoundManagerOptions, type SoundOptions, type SourceView, SparseHashGrid, SparseHashGridCollisionProcessor, type SparseHashGridConfig, SpatialPartitionStrategy, Sprite, SpriteFont, type SpriteFontOptions, type SpriteOptions, SpriteSheet, type SpriteSheetGridOptions, type SpriteSheetOptions, type SpriteSheetSpacingDimensions, type SpriteSheetSparseOptions, StandardClock, type StartOptions, type State, StateMachine, type StateMachineDescription, type StateMachineState, StrategyContainer, Stream, type Subscription, System, type SystemCtor, SystemManager, SystemPriority, SystemType, TagQuery, TestClock, type TestClockOptions, Text, TextAlign, type TextOptions, TextureLoader, Tile, TileMap, TileMapEvents, type TileMapOptions, type TileOptions, type TilePointerEvents, TiledAnimation, type TiledAnimationOptions, TiledSprite, type TiledSpriteOptions, Timer, type TimerOptions, Toaster, Transform, TransformComponent, Transition, type TransitionOptions, TreeNode, Trigger, TriggerEvents, type TriggerOptions, TwoPI, UniformBuffer, type UniformBufferOptions, type UniformDefinition, type UniformDictionary, type UniformTypeNames, Index as Util, Vector, VectorView, type VectorViewOptions, type VertexAttributeDefinition, VertexBuffer, type VertexBufferOptions, VertexLayout, type VertexLayoutOptions, VerticalFirst, type ViewportDimension, type ViewportUnit, VisibleEvent, WebAudio, WebAudioInstance, type WebGLGraphicsContextInfo, WheelDeltaMode, WheelEvent, type WithRoot, World, type _add, type _initialize, type _postupdate, type _preupdate, type _remove, type activate, type add, approximatelyEqual, assert, type axis, type button, type cancel, canonicalizeAngle, clamp, type collisionend, type collisionstart, type connect, coroutine, createId, type deactivate, type disconnect, type down, type enter, type entertrigger, type enterviewport, type exittrigger, type exitviewport, frac, getDefaultPhysicsConfig, glTypeToUniformTypeName, hasGraphicsTick, hasOnAdd, hasOnInitialize, hasOnPostUpdate, hasOnPreUpdate, hasOnRemove, hasPostDraw, hasPreDraw, has_add, has_initialize, has_postupdate, has_preupdate, has_remove, type hidden, type hold, type initialize, inverseLerp, inverseLerpVector, isActor, isAddedComponent, isComponentCtor, isLoaderConstructor, isMoveByOptions, isMoveToOptions, isRemovedComponent, isRotateByOptions, isRotateToOptions, isScaleByOptions, isScaleToOptions, isSceneConstructor, isScreenElement, isSystemConstructor, type kill, type leave, lerp, lerpAngle, lerpVector, maxMessages, type move, nextActionId, obsolete, parseImageFiltering, parseImageWrapping, pixelSnapEpsilon, type pointercancel, type pointerdown, type pointerdragend, type pointerdragenter, type pointerdragleave, type pointerdragmove, type pointerdragstart, type pointerenter, type pointerleave, type pointermove, type pointerup, type pointerwheel, type postcollision, type postdebugdraw, type postdraw, type postframe, type postkill, type postupdate, type precollision, type predebugdraw, type predraw, type preframe, type prekill, type press, type preupdate, randomInRange, randomIntInRange, range, type release, remap, remapVector, type remove, resetObsoleteCounter, sign, type start, type stop, type subscribe, toDegrees, toRadians, type unsubscribe, type up, vec, type visible, webglUtil as webgl, type wheel };
`,GIe=o=>o[0],$Ie=window.matchMedia("(prefers-color-scheme: light)").matches,KIe=new URLSearchParams(document.location.search),wY=KIe.get("embed")==="true";document.body.classList.toggle("embedded",wY);const jIe=GIe`
import * as ex from 'excalibur';
console.log('hello world');

const game = new ex.Engine({
    canvasElementId: 'preview-canvas',
    displayMode: ex.DisplayMode.FitContainer,
    width: 600,
    height: 400
});

const a = new ex.Actor({
	pos: ex.vec(100, 100),
	width: 100,
	height: 100,
	color: ex.Color.Red
});

game.add(a);
game.start();`,qIe=()=>{const o=window.location.search,t=new URLSearchParams(o).get("code");return console.log(t?"has shared code":"no shared code"),t?yY.decompressFromEncodedURIComponent(t):jIe};window.MonacoEnvironment={getWorker:(o,e)=>{switch(e){case"typescript":case"javascript":return new V6;default:return new V6}}};qw.typescript.typescriptDefaults.addExtraLib(UIe,"file:///index.d.ts");const t3=qw.typescript.typescriptDefaults;qw.typescript.typescriptDefaults.setCompilerOptions({...t3.getCompilerOptions(),paths:{excalibur:["file:///index.d.ts"]}});console.log("Compiler Options:",t3.getCompilerOptions());console.log("Diagnostics Options:",t3.getDiagnosticsOptions());const ZIe=document.getElementById("container"),YIe=document.getElementById("auto-save"),i3=kj.create(ZIe,{value:qIe(),language:"typescript",automaticLayout:!0,theme:$Ie?"vs-light":"vs-dark",minimap:{enabled:!wY}});function XIe(o,e){let t;return function(...i){clearTimeout(t),t=setTimeout(()=>{o.apply(this,i)},e)}}const QIe=XIe(o=>{YIe.checked&&(p4(!1),console.log("Auto-save triggered!")),o.ctrlKey&&o.keyCode===Lj.KeyS&&(o.preventDefault(),p4(!1),console.log("Save triggered!"))},500);i3.onKeyDown(QIe);function JIe(o,...e){let t=o.raw[0];for(let i=0;i<e.length;i++)t+=e[i]+o.raw[i+1];return"data:text/javascript;base64,"+btoa(t)}const SY=document.getElementById("build"),eNe=document.getElementById("debug"),tNe=document.getElementById("share"),H6=document.getElementsByClassName("loading")[0],xY=async()=>{H6.style.display="block";const o=i3.getModel(),n=(await(await(await qw.typescript.getTypeScriptWorker())()).getEmitOutput(o.uri.toString(),!1,!1)).outputFiles.find(s=>s.name.endsWith(".js"));if(n)try{await import(JIe`${n.text}`)}finally{H6.style.display="none"}},LY=()=>{globalThis.___EXCALIBUR_DEVTOOL.toggleDebug()},p4=o=>{const e=i3.getModel().getValue(),t=`code=${yY.compressToEncodedURIComponent(e)}`,i=`${window.location}?${t}`;console.log(e),console.log(i),o&&navigator.clipboard.writeText(i),window.history.pushState({},"","?"+t)};tNe.addEventListener("click",()=>p4(!0));eNe.addEventListener("click",LY);SY.addEventListener("click",xY);window.addEventListener("keydown",o=>o.code==="Escape"?(o.preventDefault(),SY.focus(),!1):(o.ctrlKey||o.metaKey)&&o.code==="KeyS"?(o.preventDefault(),xY(),!1):(o.ctrlKey||o.metaKey)&&o.code==="KeyD"?(o.preventDefault(),LY(),!1):!0);export{Zw as m,Gj as t};
